var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_plus_start"),(self["suiteux_shell_webpackJsonp_suiteux-main"]=self["suiteux_shell_webpackJsonp_suiteux-main"]||[]).push([["plus"],{51054:function(e,t,n){(t=e.exports=n(15048)(!1)).push([e.id,'.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\={display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;border:1px solid hsla(0,0%,100%,0);box-shadow:0 1px 2px 0 rgba(0,0,0,.1);box-sizing:border-box;width:276px;padding-left:0;align-items:flex-start;margin:0 0 17px 16px}html[dir=rtl] .o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\={margin-left:0;margin-right:16px}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=:hover{-webkit-box-shadow:0 8px 16px 0 rgba(0,0,0,.1);box-shadow:0 8px 16px 0 rgba(0,0,0,.1)}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>button{min-width:30px;width:30px;height:36px;padding-left:10px;padding-right:10px;background-color:transparent;border:none;align-items:flex-start}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-ms-clear{display:none}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-cancel-button,.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-decoration,.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-results-button,.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-results-decoration{-webkit-appearance:none;display:none}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\= .j6BvNpCF90XiKxu0F7sZzw\\=\\={width:250px;height:32px;background:transparent;align-items:flex-start;border:none;display:block;font:13px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;text-overflow:ellipsis;padding-left:5px;outline:none;margin:.1em}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\= .j6BvNpCF90XiKxu0F7sZzw\\=\\=:-internal-autofill-selected{background-color:transparent!important}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=:focus{cursor:text}.o365cs-base .nHk7LESAfIWtWyD9f7IM9g\\=\\={margin:0 0 5px 16px}',""]),t.locals={SearchControl:"oxbF2LyKwVB/a5+4gTMkFg==",inputBox:"j6BvNpCF90XiKxu0F7sZzw==",SearchControlZoomMargin:"nHk7LESAfIWtWyD9f7IM9g=="}},1794:function(e,t,n){(t=e.exports=n(15048)(!1)).push([e.id,'.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\={position:absolute}.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= ._1ZqUEbZKjUMrjQWoZseg6g\\=\\={font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:10px;position:absolute;width:16px;height:16px;line-height:15px;border-radius:1em;box-sizing:border-box;text-align:center;left:0}@media(-ms-high-contrast:active),(forced-colors:active){.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= ._1ZqUEbZKjUMrjQWoZseg6g\\=\\={-ms-high-contrast-adjust:none;forced-color-adjust:none;background-color:Highlight!important;color:highlightText!important}}.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= ._56EuyMD2soE1\\/gKXBY0q9g\\=\\={top:7px;width:8px;height:8px;border:1px solid #fff;border-radius:4px}.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= .\\+OLPNIF6B5kKoA97J3vVpw\\=\\={border-color:#000}',""]),t.locals={unseenitems:"TlAdlUrWd0Z6/TteKJSQig==",unseenCount:"_1ZqUEbZKjUMrjQWoZseg6g==",emptyBadge:"_56EuyMD2soE1/gKXBY0q9g==",emptyBadgeDarkMode:"+OLPNIF6B5kKoA97J3vVpw=="}},62399:function(e,t,n){(t=e.exports=n(15048)(!1)).push([e.id,'.NszUgtzDfx0t1PQrucmvnA\\=\\={display:block}.c6QE6q0imyqZPiHyLPm9YA\\=\\={font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.uGAx4CbRh\\+jEaMdf4Etv7w\\=\\={font-family:SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-weight:600}.vmO5rYvtVrmsybm3QJFJUw\\=\\={font-family:SegoeUI-Light-final,Segoe UI Light,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.Q8qHkqThZ3HCwPmk\\+m2bFQ\\=\\={font-family:SegoeUI-SemiLight-final,Segoe UI Semilight,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.iDm2WTqpMgwzbBSSRlbuog\\=\\={font-family:Arial,SegoeUI-Regular-final,Segoe UI,Segoe,Tahoma,Helvetica,sans-serif}',""]),t.locals={displayBlock:"NszUgtzDfx0t1PQrucmvnA==",segoeRegular:"c6QE6q0imyqZPiHyLPm9YA==",segoeSemibold:"uGAx4CbRh+jEaMdf4Etv7w==",segoeLight:"vmO5rYvtVrmsybm3QJFJUw==",segoeSemiLight:"Q8qHkqThZ3HCwPmk+m2bFQ==",arialRegular:"iDm2WTqpMgwzbBSSRlbuog=="}},22225:function(e,t,n){(t=e.exports=n(15048)(!1)).push([e.id,".LOH65mHND5UuJ9b5MOPIyg\\=\\={height:calc(100vh - 115px)}.EjkBtpEVGYQK1q\\/td6mhdg\\=\\={height:calc(100vh - 113px)}.sbU\\+9csU7o21SILr6MJmgw\\=\\={height:calc(100vh - 73px)}",""]),t.locals={flexPaneContentContainer:"LOH65mHND5UuJ9b5MOPIyg==",flexPaneContentContainerForThinHeader:"EjkBtpEVGYQK1q/td6mhdg==",flexPaneContentContainerForShyHeader:"sbU+9csU7o21SILr6MJmgw=="}},73105:function(e,t,n){(t=e.exports=n(15048)(!1)).push([e.id,'.TaSuqlyJ5MSqTQbXTeS3tQ\\=\\={font-family:ShellFabricMDL2IconsLite,ShellFabricMDL2Icons;line-height:1}.TaSuqlyJ5MSqTQbXTeS3tQ\\=\\= .o365cs-base [class*=" ms-Icon--"]:before,.TaSuqlyJ5MSqTQbXTeS3tQ\\=\\= .o365cs-base [class^=ms-Icon--]:before{font-family:inherit}.HKHsnwPD9asgCY\\/1RHVuQw\\=\\=,.I4nj8afMLjWpJ2UOud88zg\\=\\={height:100%}',""]),t.locals={customHeaderButton:"TaSuqlyJ5MSqTQbXTeS3tQ==",customHeaderButtonsContainer:"HKHsnwPD9asgCY/1RHVuQw==",customHeaderButtonWrapper:"I4nj8afMLjWpJ2UOud88zg=="}},3484:function(e,t,n){(t=e.exports=n(15048)(!1)).push([e.id,".\\/FzkYcX7qvnoEMaUtV922A\\=\\=,.hNRvTvwVOsDErxAdwaiZGQ\\=\\={-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-timing-function:cubic-bezier(.1,.9,.2,1)}.MqP9cttxW\\/k6fP9KBfvJXw\\=\\=,.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\={width:100%;height:8px;visibility:hidden;display:none}.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\={background:transparent;cursor:pointer}.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\=:hover{opacity:.4;background:#404040}.mYrlHvrSR57f9RgjZDapRg\\=\\={position:absolute;left:47.81%;right:47.81%;border-radius:6px;width:14px;height:2px;align-self:center;pointer-events:none}.DJNRezt7dApXIOSDqmGElw\\=\\={-webkit-animation-name:headerSlideInFrames;animation-name:headerSlideInFrames}.QU0CdgILUm0YoP\\+SCe437g\\=\\={-webkit-animation-name:headerSlideOutFrames;animation-name:headerSlideOutFrames}.ICSgbPvcuYIMYmjWDVZjyQ\\=\\={-webkit-animation-name:workloadDivSlideInFrames;animation-name:workloadDivSlideInFrames;animation-fill-mode:forwards}.psEYMGfctmMkbBQaQqGwDg\\=\\={-webkit-animation-name:workloadDivSlideOutFrames;animation-name:workloadDivSlideOutFrames;animation-fill-mode:forwards}@-webkit-keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@-webkit-keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@-webkit-keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@-webkit-keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}@keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}",""]),t.locals={headerAnimations:"/FzkYcX7qvnoEMaUtV922A==",workloadDivAnimations:"hNRvTvwVOsDErxAdwaiZGQ==",shyHeader:"MqP9cttxW/k6fP9KBfvJXw==",shyHeaderOverlay:"tqq1tl3OHof+9xOfBWUR4Q==",shyHeaderGripper:"mYrlHvrSR57f9RgjZDapRg==",headerSlideIn:"DJNRezt7dApXIOSDqmGElw==",headerSlideOut:"QU0CdgILUm0YoP+SCe437g==",workloadDivSlideIn:"ICSgbPvcuYIMYmjWDVZjyQ==",workloadDivSlideOut:"psEYMGfctmMkbBQaQqGwDg=="}},52857:function(e,t,n){var a=n(51054);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},14821:function(e,t,n){var a=n(1794);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},36604:function(e,t,n){var a=n(62399);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},56668:function(e,t,n){var a=n(22225);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},57386:function(e,t,n){var a=n(73105);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},49715:function(e,t,n){var a=n(3484);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(79128)(a,i);a.locals&&(e.exports=a.locals)},74107:function(e,t,n){"use strict";var a;n.d(t,{J:function(){return a}}),function(e){e[e.OWA=1]="OWA",e[e.TokenFactory=3]="TokenFactory"}(a||(a={}))},917:function(e,t,n){"use strict";function a(e){let t=null;try{null!=sessionStorage&&(t=sessionStorage.getItem(e))}catch(e){}return t}n.d(t,{T:function(){return y}});var i=n(16968),r=n(87948),s=n(94190),o=n(74107),l=n(83251),c=n(66873),u=n(88514),d=n(23653),p=n(27501),h=n(9522),g=n(7668),m=n(68105),f=n(83834),S=n(48314);class y{get appWebProxyUrl(){return h.buildUrl(this.url,this.iFrameSourceUrl)}get canExecuteNow(){return null!==document.body||y.sWindowLoadCalled}constructor(e,t,n,a=!1){if(h.validateField(t,"url",h.StringTypeString,!0),h.isNullOrEmptyString(t))throw h.createInvalidParameterException("url");if(t.indexOf("?")>=0)throw h.createInvalidParameterException("url");"/"===t.charAt(0)&&(t=h.buildUrl(h.getCurrentWindowLocation(),t)),h.validateFullUrl(t,"url"),t.charCodeAt(t.length-1)==="/".charCodeAt(0)&&(t=t.substr(0,t.length-1)),t=t.toLowerCase(),this.url=t,h.getUrlDomainPart(t,!0)!==h.getUrlDomainPart(h.getCurrentWindowLocation(),!0)&&!a||window.IsO365ShellTestPage?this.mode=1:this.mode=0,this.formDigestHandlingEnabled=!1,this.iFrameSourceUrl=n,y.sIFrameInstanceCode[this.appWebProxyUrl]=e,window.addEventListener("unload",y.resetMessageListenerAttachedFlag)}executeAsync(e){return this.validateRequest(e,!1),this.executeValidatedRequestInternal(e)}executeCrossDomainRequestAsync(e,t=!1){return this.validateRequest(e,!0),this.executeValidatedRequestInternal(e,t)}ping(){return null!=y.sFramePinged&&y.sFramePinged[this.appWebProxyUrl]}registerOpxHost(e){this.executeOrQueueCrossDomainRequest(S.k.RegisterOpxHost,e)}executeOpxRequest(e){const t={requestObject:e};this.executeOrQueueCrossDomainRequest(S.k.OutgoingOpxMessage,t)}executeStorageRequest(e){if(1===this.mode)this.executeOrQueueCrossDomainRequest(S.k.Storage,e);else if(0===this.mode)try{const t=e.requestObject,n=t=>{const n={responseObject:t};y.fireDataWatchSentCallback(e),null!=e.success&&e.success(n),y.fireDataWatchReceivedCallbackGivenResponseInfo(e,n,0,"")};1===t.RequestType?(0,i.tZ)().tag("RequestExecutor_SuiteDataSharingDeprecated",6,-1018,p.pc):f.A.processRequest(t,n)}catch(t){null!=e.error&&e.error({},0,t.message),y.fireDataWatchReceivedCallbackGivenResponseInfo(e,{},t.errorCode||0,t.message)}}executeIdentityProviderRequest(e){1===this.mode&&this.executeOrQueueCrossDomainRequest(S.k.UserState,e)}executeSignalRRequest(e){this.validateRequest(e,!1),e.timeout=0,this.executeOrQueueCrossDomainRequest(S.k.SignalR,e)}setBeforeSendRequestAction(e){this.beforeSendRequest=e}prefetchOAuthAccessToken(e){c.p.Instance.configuration.EnableTokenDictionary?u.E.getToken(e).catch((t=>{1===t.responseType&&this.executeOrQueueCrossDomainRequest(S.k.TokenPrefetch,e)})):this.executeOrQueueCrossDomainRequest(S.k.TokenPrefetch,e)}getOwaUserConfiguration(e){this.executeOrQueueCrossDomainRequest(S.k.OwaUserConfig,e)}static internalProcessIFrameRequestTimeoutCallback(e){if(null===y.sPostMessageIdToRequestInfoMap)return;const t=y.sPostMessageIdToRequestInfoMap[e];null!=t&&(y.isCurrentSiteInTrustOrLocalZone()&&(0,i.tZ)().tag("RequestExecutor_IFrameLoadError",4,-1007,p.Ep),y.sPostMessageIdToRequestInfoMap[e]=null,delete y.sPostMessageIdToRequestInfoMap[e],h.reportSimpleError(t.requestInfo,-1001,p.Pr,"IFrameRequest"),(0,i.tZ)().serverRequest(t.command,t.requestInfo.method,y.sIFrameInstanceCode[t.appWebProxyUrl].toString(),t.requestInfo.url,-1001),y.fireDataWatchReceivedCallbackGivenResponseInfo(t.requestInfo,null,-1001,p.Pr))}validateRequest(e,t){if(h.validateRequestInfo(e),h.isFullUrl(e.url)){if(!t&&h.getUrlDomainPart(e.url,!0).toLowerCase()!==h.getUrlDomainPart(this.url,!0))throw h.createInvalidParameterException("requestInfo.url")}else e.url=h.buildUrl(this.url,e.url);(e.binaryStringRequestBody||e.binaryStringResponseBody)&&h.checkBrowserBinaryDataSupport()}executeValidatedRequestInternal(e,t=!1){return t?this.executeQueryDirect(e):1===this.mode?this.executeOrQueueCrossDomainRequest(S.k.Query,e):this.executeQueryDirect(e),e.postMessageId}executeQueryDirect(e){let t=h.buildUrl(this.url,"_api/contextinfo");t=h.encodeUrlForXmlHttpRequest(t),y.ensureFormDigest(this.url,t,this.formDigestHandlingEnabled,e,((e,t)=>this.executeQueryUsingXMLHttpRequest(e,t)))}static ensureFormDigest(e,t,n,a,s){e=e.toLowerCase();const o=new Date;if(!n||"GET"===a.method.toUpperCase()||null!=y.sFormDigestExpirationCache[e]&&y.sFormDigestExpirationCache[e]>o.getTime())s(y.sFormDigestValueCache[e],a);else{const n=h.getXMLHttpRequest();n.open("POST",t),n.setRequestHeader("accept","application/json;odata=verbose");const o=Date.now();let l=0;a.timeout>0&&(l=window.setTimeout((()=>{n.onreadystatechange=()=>{};try{n.abort()}catch(e){}h.reportSimpleError(a,-1001,p.Pr,"ensureFormDigest"),(0,i.tZ)().serverRequest(S.k.Query,a.method,null,a.url,-1001,a.isTokenGeneratedFromWorkload)}),a.timeout)),n.onreadystatechange=()=>{if(4===n.readyState){const t=Date.now()-o;if(0!==l&&window.clearTimeout(l),n.onreadystatechange=()=>{},200!==n.status||null===n.getResponseHeader("content-type")||n.getResponseHeader("content-type").toLowerCase().indexOf("application/json")<0){const e=(0,r.JT)(p.Xs,n.status.toString(),n.getResponseHeader("content-type"));h.reportSimpleError(a,-1002,e),(0,i.tZ)().tag("RequestExecutor_UnexpectedResponse",6,-1002,n.status.toString(),n.getResponseHeader("content-type")),(0,i.tZ)().serverRequest(S.k.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,t,h.getXMLHttpResponseLength(n))}else{const r=JSON.parse(n.responseText);if(null!=r){const o=r.d.GetContextWebInformation.FormDigestValue,l=r.d.GetContextWebInformation.FormDigestTimeoutSeconds,c=(new Date).getTime()+750*l;y.sFormDigestValueCache[e]=o,y.sFormDigestExpirationCache[e]=c,s(o,a),(0,i.tZ)().serverRequest(S.k.Query,a.method,null,a.url,n.status,a.isTokenGeneratedFromWorkload,t,h.getXMLHttpResponseLength(n))}else h.reportSimpleError(a,-1002,p.s5),(0,i.tZ)().tag("RequestExecutor_UnableToParseJson",6,-1002,p.s5,n.status.toString(),n.responseText),(0,i.tZ)().serverRequest(S.k.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,t,h.getXMLHttpResponseLength(n))}}},n.send("")}}executeOrQueueCrossDomainRequest(e,t){s.isBrowserIE()&&y.sIFrameInstanceCode[this.appWebProxyUrl]===o.J.TokenFactory||(y.sMessageListenerAttached=!!y.sMessageListenerAttached||h.ensureAttachMessageListener(y.internalOnMessage),y.fireDataWatchSentCallback(t),t.postMessageId=y.getPostMessageId(),this.canExecuteNow?this.executeCommandByIFrame(e,this.appWebProxyUrl,t):y.addToRequestExecutorQueue(this,t))}executeCommandByIFrame(e,t,n){const a={command:e,postMessageId:n.postMessageId,appWebProxyUrl:t,requestInfo:n,timeoutId:null};let i=y.sPendingRequestInfo[t];null==i&&(i=[],y.sPendingRequestInfo[t]=i),y.sPostMessageIdToRequestInfoMap[a.postMessageId]=a,a.requestInfo.timeout>0&&(a.timeoutId=window.setTimeout((()=>y.internalProcessIFrameRequestTimeoutCallback(a.postMessageId)),a.requestInfo.timeout));let r=h.getFrameElement(y.sIFrameInstanceCode[t]);null!=r?y.sFrameLoaded[t]&&y.sFramePinged[t]?y.sendPostMessage(a):i.push(a):(i.push(a),r=y.createIFrame(t))}static createIFrame(e){const t=y.sIFrameInstanceCode[e],n=h.getFrameID(t);switch(t){case o.J.OWA:(0,i.tZ)().perfMarker("OwaIframeLoadStarted");break;case o.J.TokenFactory:(0,i.tZ)().perfMarker("TokenFactoryIframeLoadStarted")}const a=document.createElement("iframe");a.src=e,a.id=n,a.name=n,a.style.display="none",a.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms");a.addEventListener("load",(()=>{y.internalProcessIFrameOnload(e)})),document.body.appendChild(a);const r=window.setTimeout((()=>{delete y.sFrameLoadTimeoutId[e],y.processPingTimeoutOrIFrameLoadTimeout(e)}),this.IFrameLoadTimeout);return y.sFrameLoadTimeoutId[e]=r,a}executeQueryUsingXMLHttpRequest(e,t){const n=h.getXMLHttpRequest(),a=h.encodeUrlForXmlHttpRequest(t.url);n.open(t.method,a);let r=!1;if(null!=t.headers)for(const e of Object.keys(t.headers))null!=e&&(n.setRequestHeader(e,t.headers[e]),"x-requestdigest"===e.toLowerCase()&&(r=!0));r||null==e||n.setRequestHeader("X-RequestDigest",e),t.binaryStringResponseBody&&(n.responseType="arraybuffer");let s=0;t.timeout>0&&(s=window.setTimeout((()=>y.internalProcessXMLHttpRequestTimeoutCallback(n,t)),t.timeout)),n.onreadystatechange=()=>y.internalProcessXMLHttpRequestOnreadystatechange(n,t,s);let o=t.body;if(t.binaryStringRequestBody&&(o=h.convertBinaryStringToXmlHttpRequestBody(t.body)),null!=this.beforeSendRequest&&this.beforeSendRequest(n,null,null),!m.B.isAllowedApi(a)&&!c.p.Instance.configuration.EnableTokenDictionary)return h.reportSimpleError(t,-1009,p.iZ),void(0,i.tZ)().serverRequest(S.k.Query,t.method,null,a,-1009);y.fireDataWatchSentCallback(t),t.requestSentTime=Date.now(),n.send(o)}static sendPostMessage(e){h.validateField(e.postMessageId,"requestInfo.postMessageId",h.StringTypeString,!0),h.validateField(e.appWebProxyUrl,"requestInfo.appWebProxyUrl",h.StringTypeString,!0);const t=h.getFrameElement(y.sIFrameInstanceCode[e.appWebProxyUrl]);if(null==t)throw(0,i.tZ)().tag("RequestExecutor_IFrameNull",6,-2002,p.fo,e.appWebProxyUrl),new d.K(p.fo,-2002);null==y.sPostMessageIdToRequestInfoMap&&(y.sPostMessageIdToRequestInfoMap={}),y.sPostMessageIdToRequestInfoMap[e.postMessageId]=e;const n={command:e.command,url:e.requestInfo.url,resource:e.requestInfo.resource,method:e.requestInfo.method,body:e.requestInfo.body,headers:e.requestInfo.headers,postMessageId:e.postMessageId,timeout:e.requestInfo.timeout,binaryStringRequestBody:e.requestInfo.binaryStringRequestBody,binaryStringResponseBody:e.requestInfo.binaryStringResponseBody,requestObject:e.requestInfo.requestObject,getPerformanceTrace:e.requestInfo.getPerformanceTrace},a=JSON.stringify(n),r=e.appWebProxyUrl;e.requestInfo.requestSentTime=Date.now(),c.p.isUnitTestMode||t.contentWindow.postMessage(a,r)}static getPostMessageId(){return y.sPostMessageIdCount++,h.PostMessageIdPrefix+y.sPostMessageIdCount.toString()}static internalProcessWindowLoad(){y.sWindowLoadCalled=!0;const e=y.sRequestExecutorQueue;y.sRequestExecutorQueue=null;const t=y.sRequestExecutorParameterQueue;if(y.sRequestExecutorParameterQueue=null,null!==e)for(let n=0;n<e.length;n++)e[n].executeAsync(t[n])}static resetMessageListenerAttachedFlag(){y.sMessageListenerAttached=!1}static internalProcessIFrameOnload(e){y.sFrameLoaded[e]=!0,null!=y.sFrameLoadTimeoutId[e]&&(window.clearTimeout(y.sFrameLoadTimeoutId[e]),delete y.sFrameLoadTimeoutId[e]),h.ensureAttachMessageListener(y.internalOnMessage),null!=y.sFramePingTimeoutId[e]&&(window.clearTimeout(y.sFramePingTimeoutId[e]),delete y.sFramePingTimeoutId[e]);const t={requestObject:{upn:c.p.Instance.configuration.CurrentUserUpn,puid:c.p.Instance.configuration.CurrentUserPuid,shellConfig:{enableOpx:c.p.Instance.configuration.OpxEnabled}}},n=a("shellver");n&&window.O365ShellBootInfo&&(t.requestObject.overrideRequest=h.buildIframeResourceData(n,window.O365ShellBootInfo));const i={command:S.k.Ping,postMessageId:y.getPostMessageId(),appWebProxyUrl:e,timeoutId:-1,requestInfo:t};y.sPostMessageIdToRequestInfoMap[i.postMessageId]=i;const r=window.setTimeout((()=>{delete y.sFrameLoadTimeoutId[e],y.processPingTimeout(i.postMessageId,e)}),y.IFramePingTimeout);i.timeoutId=r,c.p.isUnitTestMode||(y.sFramePingTimeoutId[e]=r),y.sendPostMessage(i)}static internalOnMessage(e){if(null==e)return;const t=e.origin,n=e.data;if(null!=t&&""!==t&&null!=n&&""!==n)try{const e=JSON.parse(n);y.isPostMessageResponseInfo(e)&&y.onResponseMessageReceived(t,e)}catch(e){}}static isPostMessageResponseInfo(e){const t=e;return null!=t.postMessageId&&null!=t.command}static onResponseMessageReceived(e,t){const n=Date.now();if(null==y.sPostMessageIdToRequestInfoMap)return;if(null==t.postMessageId)return;const a=y.sPostMessageIdToRequestInfoMap[t.postMessageId];if(null==a)return;const r=h.getUrlDomainPart(e,!0),s=h.getUrlDomainPart(a.appWebProxyUrl,!0);if(r.toLowerCase()!==s.toLowerCase())return;const o=t.postMessageId,l=n-a.requestInfo.requestSentTime,c=t.command===S.k.Query&&0===t.errorCode&&3===t.readyState,u=t.command===S.k.Notification&&null==t.errorMessage;if(c||u||(delete y.sPostMessageIdToRequestInfoMap[o],null!=a.timeoutId&&(window.clearTimeout(a.timeoutId),a.timeoutId=0,delete a.timeoutId)),t.command===S.k.Ping)y.processPingMessage(a.appWebProxyUrl,t),y.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(a.requestInfo,t),(0,i.tZ)().serverRequest(a.command,a.requestInfo.method,y.sIFrameInstanceCode[a.appWebProxyUrl].toString(),h.getUrlDomainPart(a.appWebProxyUrl),0===t.errorCode?200:t.errorCode,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0);else if(t.command===S.k.Query){const e={responseAvailable:t.responseAvailable,body:t.responseText||"",statusCode:t.statusCode,statusText:t.statusText,contentType:t.contentType,state:a.requestInfo.state,allResponseHeaders:t.allResponseHeaders,headers:h.parseResponseHeaders(t.allResponseHeaders),binaryStringResponseBody:t.binaryStringResponseBody};let n=0,r=null;0!==t.errorCode?(n=t.errorCode,r=t.errorMessage):t.statusCode>=200&&t.statusCode<300||1223===t.statusCode||(n=-1003,r=t.statusCode),0===n?4===t.readyState?(e.performanceTrace=t.performanceTrace,null!=a.requestInfo.success&&a.requestInfo.success(e),y.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,0,null),(0,i.tZ)().serverRequest(a.command,a.requestInfo.method,y.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,t.statusCode,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0)):3===t.readyState&&null!=a.requestInfo.loading&&a.requestInfo.loading(e):4!==t.readyState&&0!==t.readyState&&null!=t.readyState||(e.performanceTrace=t.performanceTrace,null!=a.requestInfo.error&&a.requestInfo.error(e,n,r),(0,i.tZ)().tag("RequestExecutor_IFrameError",4,n,r),y.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,n,r),(0,i.tZ)().serverRequest(a.command,a.requestInfo.method,y.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,n,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0))}else if(t.command===S.k.Storage||t.command===S.k.TokenPrefetch||t.command===S.k.OwaUserConfig){const e={responseObject:t.responseObject},n=t.errorCode,r=t.errorMessage;0===n&&h.isNullOrEmptyString(r)?(null!=a.requestInfo.success&&a.requestInfo.success(e),y.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,0,null)):(null!=a.requestInfo.error&&a.requestInfo.error(e,n,r),y.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,n,r)),(0,i.tZ)().serverRequest(a.command,a.requestInfo.method,y.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,0!==n?n:200,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0)}else t.command===S.k.Notification?(0!==t.errorCode&&null!=a.requestInfo.error&&a.requestInfo.error({responseObject:t.responseObject},t.errorCode,t.errorMessage),y.NotificationCallback(JSON.stringify(t.responseObject)),y.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(a.requestInfo,t)):t.command===S.k.RegisterOpxHost&&null!=a.requestInfo.success&&a.requestInfo.success(null)}static internalProcessXMLHttpRequestTimeoutCallback(e,t){e.onreadystatechange=()=>{};try{e.abort()}catch(e){}h.reportSimpleError(t,-1001,p.Pr,"XMLHttpRequest"),(0,i.tZ)().serverRequest(S.k.Query,t.method,null,t.url,-1001),y.fireDataWatchReceivedCallbackGivenResponseInfo(t,null,-1001,p.Pr)}static internalProcessXMLHttpRequestOnreadystatechange(e,t,n){if(4===e.readyState){const a=Date.now();0!==n&&window.clearTimeout(n),e.onreadystatechange=()=>{};const r={state:t.state,responseAvailable:!0,body:t.binaryStringResponseBody?h.convertArrayBufferToBinaryString(e.response):e.responseText,statusCode:e.status,statusText:e.statusText,contentType:e.getResponseHeader("content-type"),allResponseHeaders:e.getAllResponseHeaders(),headers:h.parseResponseHeaders(e.getAllResponseHeaders()),performanceTrace:null},s=a-t.requestSentTime;if(t.getPerformanceTrace){const e=performance.getEntriesByName(t.url);null!=e&&e.length>0&&(r.performanceTrace=e[0])}e.status>=200&&e.status<300||1223===e.status?(null!=t.success&&t.success(r),y.fireDataWatchReceivedCallbackGivenResponseInfo(t,r,0,null),(0,i.tZ)().serverRequest(S.k.Query,t.method,null,t.url,r.statusCode,t.isTokenGeneratedFromWorkload,s,h.getXMLHttpResponseLength(e))):(null!=t.error&&t.error(r,-1003,e.statusText),y.fireDataWatchReceivedCallbackGivenResponseInfo(t,r,-1003,e.statusText),(0,i.tZ)().serverRequest(S.k.Query,t.method,null,t.url,e.status,t.isTokenGeneratedFromWorkload,s,h.getXMLHttpResponseLength(e)))}}static isCurrentSiteInTrustOrLocalZone(){if(!y.isTrustedSiteEvaluated){if(s.isBrowserIE()){const e=window.status,t=window.status+(new Date).getTime();window.status=t,y.isTrustedSite=window.status===t,window.status=e}y.isTrustedSiteEvaluated=!0}return y.isTrustedSite}static processPingTimeout(e,t){null!=y.sPostMessageIdToRequestInfoMap[e]&&(y.sFramePinged[t]||((0,i.tZ)().tag("PingTimeout",0,y.sIFrameInstanceCode[t].toString()),y.sPostMessageIdToRequestInfoMap[e]=null,delete y.sPostMessageIdToRequestInfoMap[e],y.processPingTimeoutOrIFrameLoadTimeout(t)))}static processPingTimeoutOrIFrameLoadTimeout(e){switch(y.sIFrameInstanceCode[e]){case o.J.OWA:(0,i.tZ)().perfMarker("OwaIframeLoadFailed");break;case o.J.TokenFactory:(0,i.tZ)().perfMarker("TokenFactoryIframeLoadFailed")}const t=h.getUrlDomainPart(e,!0);if(t.toLowerCase()===h.getUrlDomainPart(c.p.Instance.configuration.SuiteServiceUrl,!0)){const e=y.isCurrentSiteInTrustOrLocalZone()?g.I.SecurityZoneMismatched:g.I.IframeLoadError;l.k.Instance.blockSuiteServiceCalls(e,t)}const n=(0,r.JT)(p.D8,t);y.reportFrameLoadError(e,n)}static reportFrameLoadError(e,t,n=-1007){y.sFrameLoadError[e]=!0;const a=y.sPendingRequestInfo[e];y.sPendingRequestInfo[e]=[];let r=!1;if(r=y.isTrustedSiteEvaluated?y.isTrustedSite:y.isCurrentSiteInTrustOrLocalZone(),(0,i.tZ)().tag("RequestExecutor_IFrameLoadError",4,n,t,"isTrustedSite: "+r),null!=y.sFrameLoadTimeoutId[e]&&(window.clearTimeout(y.sFrameLoadTimeoutId[e]),delete y.sFrameLoadTimeoutId[e]),y.removeIFrame(e),null!=a)for(const r of a){const a=r.postMessageId;null!=y.sPostMessageIdToRequestInfoMap[a]&&(y.sPostMessageIdToRequestInfoMap[a]=null,delete y.sPostMessageIdToRequestInfoMap[a],null!=r.timeoutId&&window.clearTimeout(r.timeoutId),h.reportSimpleError(r.requestInfo,n,t),(0,i.tZ)().serverRequest(r.command,r.requestInfo.method,y.sIFrameInstanceCode[e].toString(),r.requestInfo.url,-1007))}}static removeIFrame(e){const t=h.getFrameElement(y.sIFrameInstanceCode[e]);null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t),null!=y.sPendingRequestInfo&&delete y.sPendingRequestInfo[e],null!=y.sFrameLoadTimeoutId&&delete y.sFrameLoadTimeoutId[e],null!=y.sFrameLoaded&&delete y.sFrameLoaded[e],null!=y.sFramePinged&&delete y.sFramePinged[e],null!=y.sFramePingTimeoutId&&delete y.sFramePingTimeoutId[e],null!=y.sFrameLoadError&&delete y.sFrameLoadError[e]}static processPingMessage(e,t){switch(y.sIFrameInstanceCode[e]){case o.J.OWA:(0,i.tZ)().perfMarker("OwaIframeLoadCompleted");break;case o.J.TokenFactory:(0,i.tZ)().perfMarker("TokenFactoryIframeLoadCompleted")}if(t.errorCode&&0!==t.errorCode)return void y.reportFrameLoadError(e,t.errorMessage,t.errorCode);y.sFramePinged[e]=!0;const n=y.sPendingRequestInfo[e];if(null!=n){y.sPendingRequestInfo[e]=[];for(const e of n)null!=y.sPostMessageIdToRequestInfoMap[e.postMessageId]&&y.sendPostMessage(e)}}static addToRequestExecutorQueue(e,t){null===y.sRequestExecutorQueue&&(y.sRequestExecutorQueue=[]),null===y.sRequestExecutorParameterQueue&&(y.sRequestExecutorParameterQueue=[]),y.sRequestExecutorQueue.push(e),y.sRequestExecutorParameterQueue.push(t)}static fireDataWatchSentCallback(e){null!==y.DataWatchSentCallback&&(y.DataWatchRequestId++,e.dataRequestId=y.DataWatchRequestId,y.DataWatchSentCallback(y.DataWatchRequestId,e))}static fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(e,t){if(null==y.DataWatchReceivedCallback)return;const n={body:t.responseText,responseAvailable:t.responseAvailable,statusCode:t.statusCode,statusText:t.statusText,contentType:t.contentType,allResponseHeaders:t.allResponseHeaders,headers:h.parseResponseHeaders(t.allResponseHeaders),binaryStringResponseBody:t.binaryStringResponseBody,responseObject:t.responseObject,state:e.state,performanceTrace:t.performanceTrace};y.fireDataWatchReceivedCallbackGivenResponseInfo(e,n,t.errorCode,t.errorMessage)}static fireDataWatchReceivedCallbackGivenResponseInfo(e,t,n,a){null!==y.DataWatchReceivedCallback&&null!=e.dataRequestId&&y.DataWatchReceivedCallback(e.dataRequestId,t,n,a)}}y.DefaultTimeout=6e4,y.IFrameLoadTimeout=15e3,y.IFramePingTimeout=1e4,y.sPendingRequestInfo={},y.sFrameLoaded={},y.sFramePinged={},y.sFramePingTimeoutId={},y.sFrameLoadTimeoutId={},y.sFrameLoadError={},y.sPostMessageIdToRequestInfoMap={},y.sIFrameInstanceCode={},y.sFormDigestValueCache={},y.sFormDigestExpirationCache={},y.sPostMessageIdCount=0,y.sWindowLoadCalled=!1,y.sRequestExecutorQueue=[],y.sRequestExecutorParameterQueue=[],y.DataWatchSentCallback=null,y.DataWatchRequestId=0,y.DataWatchReceivedCallback=null},37171:function(e,t,n){"use strict";n.d(t,{b6:function(){return c}});var a=n(87948),i=n(68105),r=n(74107),s=n(917),o=n(66873);const l="SuiteServiceProxy.aspx";class c{static get OwaInstance(){return null==c.suiteSvcInstance?c.createOwaRequestExecutor():c.suiteSvcInstance}static get OauthTokenFactoryInstance(){return null==c.tokenFactoryInstance?c.createOauthTokenFactoryRequestExecutor():c.tokenFactoryInstance}static setOauthTokenFactoryInstanceForTesting(e){o.p.isUnitTestMode&&(c.tokenFactoryInstance=e)}static resetAllInstancesForTesting(){c.tokenFactoryInstance=null,c.suiteSvcInstance=null}static createOauthTokenFactoryRequestExecutor(){if(o.p.assertInitialized(),null!=o.p.Instance.configuration.TokenFactoryIframeOrigin){let e=(0,a.JT)("{0}//{1}",window.location.protocol,window.location.host),t=(0,a.JT)(c.TokenFactoryIframePath,encodeURIComponent(e),encodeURIComponent(o.p.Instance.configuration.ShellSID),encodeURIComponent(c.TokenFactoryIframeApiVersion),encodeURIComponent(o.p.Instance.configuration.ClientShellVersion));t+=`&upn=${encodeURIComponent(o.p.Instance.configuration.CurrentUserUpn)}`;let n="https://consumer.suite.office.com"===o.p.Instance.configuration.TokenFactoryIframeOrigin;c.tokenFactoryInstance=new s.T(r.J.TokenFactory,o.p.Instance.configuration.TokenFactoryIframeOrigin,t,n)}return c.tokenFactoryInstance}static createOwaRequestExecutor(){if(o.p.assertInitialized(),null!=o.p.Instance.suiteServiceHostPageBaseUrl&&o.p.Instance.configuration.UserHasExchangeLicense){let e;e=o.p.Instance.configuration.HintUserName?(0,a.JT)("{0}?suiteServiceUserName={1}&{2}={3}&{4}",l,encodeURIComponent(o.p.Instance.configuration.CurrentUserUpn),c.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),c.SuiteServiceProxyIframeApiVersion):(0,a.JT)("{0}?{1}={2}&{3}",l,c.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),c.SuiteServiceProxyIframeApiVersion),c.suiteSvcInstance=new s.T(r.J.OWA,o.p.Instance.suiteServiceHostPageBaseUrl,e),c.suiteSvcInstance.setBeforeSendRequestAction(i.B.onBeforeSendRequestSuiteService)}return c.suiteSvcInstance}}c.TokenFactoryIframePath="/iframe/TokenFactoryIframe?origin={0}&shsid={1}&apiver={2}&cshver={3}",c.TokenFactoryIframeApiVersion="oneshell",c.SuiteServiceProxyIframeApiVersion="apiver=1",c.SuiteServiceReturnUrlParam="suiteServiceReturnUrl"},83251:function(e,t,n){"use strict";n.d(t,{k:function(){return y}});var a=n(16968),i=n(87894),r=n(87948),s=n(66873),o=n(23653),l=n(7668),c=n(3709);class u{constructor(e){this.service=e,this.NumMinutesToADReplication=2}setTargetServerReceivedTime(e){if(!s.p.isUnitTestMode)throw new o.W("Operation not allowed if it is not a unit test",-2002);this.targetServerReceivedTime=e}beforeSuiteServiceCall(e){if(null!=this.targetServer){(new Date).getTime()-this.targetServerReceivedTime.getTime()<=60*this.NumMinutesToADReplication*1e3&&(e[u.TargetServerHeader]=this.targetServer)}}afterSuiteServiceSuccess(e){null==this.targetServer&&null!=e[u.TargetServerHeader]&&(this.targetServer=e[u.TargetServerHeader],this.targetServerReceivedTime=new Date)}afterSuiteServiceError(e,t){null!=e[y.XSuiteError]&&e[y.XSuiteError]===u.ShardNotFoundException?(this.service.blockSuiteServiceCalls(l.I.ShardNotDetected),t(c.convertErrorToException(null,-1010,l.I.ShardNotDetected.toString()))):t(e)}}u.TargetServerHeader="X-TARGETSERVER",u.ShardNotFoundException="InvalidOrUnavailableMailboxException";var d=n(9522);class p{constructor(){this.handleMessage=e=>{let t=!1;if(null!=e)for(let n=0;!t&&n<this.handlers.length;n++)if(e&&e.data&&e.origin){let a=this.handlers[n];if(a.validateOrigin(e.origin)){let n=e.data;a.validateMessage(n)&&(t=a.handleMessage(n))}}},this.handlers=[],(0,d.ensureAttachMessageListener)(this.handleMessage)}registerHandler(e){this.handlers.push(e)}}var h=n(917),g=n(37171),m=n(88514),f=n(44954);class S{constructor(e,t,n){this.RequestExecutor=e,this.RequestInfo=t,this.ErrorCallback=n}}class y{constructor(){this.firstDataRequestSent=!1,this.startupCallbacks=[],this.owsStartupActionCompleted=!1,this.queuedCalls=[],this.messageDispatcher=new p}static get Instance(){return this.instance}get ConnectionEstablished(){return this.owsStartupActionCompleted}get AreSuiteServiceCallsBlocked(){return null!=this.suiteServiceCallsBlockedReason}get ShouldQueueOwsCalls(){return!this.owsStartupActionCompleted&&!s.p.Instance.configuration.IsOwa}registerPostMessageHandler(e){this.messageDispatcher.registerHandler(e)}setStartupActionCompleted(){this.owsStartupActionCompleted=!0;for(const e of this.queuedCalls)try{e.RequestExecutor.executeAsync(e.RequestInfo)}catch(e){}this.queuedCalls=[],this.callStartupCallbacks()}static setInstanceForTesting(e){s.p.isUnitTestMode&&(this.instance=e)}callOwaIframeAction(e,t,n=!0){return this.callOwaIframeActionWithAdditionalHeaders(e,t,null,n)}callOwaIframeResourceUrl(e,t,n){return new Promise(((a,r)=>{i.throwOnNullOrEmpty(e,"resourceUrl"),i.throwOnUndefined(n,"method"),null!==this.owaCallsInterceptor||s.p.Instance.configuration.UserHasExchangeLicense||(this.owaCallsInterceptor=new u(this)),n===f.o.PUT&&i.throwOnUndefined(t,"data");const o={};null!==s.p.Instance.configuration.CurrentUserUpn&&(o[y.UPNAnchorMailboxHeaderKey]=s.p.Instance.configuration.CurrentUserUpn);const l=s.p.Instance.configuration.SuiteServiceUrl.replace(d.OwsRelativePath,e);null!=this.owaCallsInterceptor&&this.owaCallsInterceptor.beforeSuiteServiceCall(o);let c=r;null!=this.owaCallsInterceptor&&(c=e=>{this.owaCallsInterceptor.afterSuiteServiceError(e,r)}),this.callOwaIframeWithOrWithoutRetry(l,o,t,n).then((e=>a(""!==e?JSON.parse(e):""))).catch(c)}))}callOwaIframeActionWithAdditionalHeaders(e,t,n,a=!0){return new Promise(((o,l)=>{i.throwOnNullOrEmpty(e,"action"),i.throwOnUndefined(t,"data");const c=s.p.Instance.configuration.SuiteServiceUrl,u="suiteservice.svc",d=-1!==c.toLowerCase().indexOf(u,c.length-16)?"{0}/?action={1}":"{0}?action={1}",p=this.isUserInitiatedCall(e)?e:e+"&UA=0",h=(0,r.JT)(d,c,p);null===n&&(n={}),n[y.ActionHeaderKey]=e,this.callOwaIframeWithOrWithoutRetry(h,n,t,f.o.POST,a).then((e=>o(""!==e?JSON.parse(e):""))).catch(l)}))}prefetchAccessToken(e,t=null){const n={url:e,resource:t};return new Promise(((e,t)=>{n.error=(e,n,a)=>{t(c.convertErrorToException(e,n,a))},n.success=t=>e(t);const a=g.b6.OauthTokenFactoryInstance;null!=a&&a.prefetchOAuthAccessToken(n)}))}registerOpxHost(e,t,n=h.T.DefaultTimeout){return new Promise(((a,i)=>{const r={resource:e,url:t,error:(e,t,n)=>{i(c.convertErrorToException(e,t,n))},success:e=>{a()},timeout:n},s=g.b6.OauthTokenFactoryInstance;null==s?i(new o.W("OauthTokenFactoryIframe",-1011)):s.registerOpxHost(r)}))}callOpxIframe(e){const t=g.b6.OauthTokenFactoryInstance;if(null==t)throw new o.W("OauthTokenFactoryIframe",-1011);t.executeOpxRequest(e)}callEndpointWithOauthToken(e,t){return new Promise(((n,a)=>{null==e.body&&(e.body=""),null==e.method&&(e.method="GET"),null==e.headers&&(e.headers={}),e.resource===s.p.Instance.configuration.TokenFactoryIframeOrigin&&(e.headers["x-o365suiteuxshell-workloadid"]=s.p.Instance.configuration.WorkloadId),e.success=e=>{try{let a;a=null!=e.contentType&&e.contentType.indexOf("application/json")>-1?t?e:JSON.parse(e.body):t?e:e.body,n(a)}catch(e){return void a(new o.W("Invalid response format."))}},e.error=(e,t,n)=>{a(c.convertErrorToException(e,t,n))};const i=g.b6.OauthTokenFactoryInstance;null!=i?s.p.Instance.configuration.EnableTokenDictionary||0===i.mode?m.E.getToken(e).then((t=>{0===t.responseType&&(e.headers.Authorization="Bearer "+t.token,null!=s.p.Instance.configuration.ServiceWorkerCacheId&&null!=s.p.Instance.configuration.ServiceWorkerCacheId&&(e.headers["X-SW-OHP-UserCacheId"]=s.p.Instance.configuration.ServiceWorkerCacheId,e.headers["X-SW-OHP-FetchStrategy"]=s.p.Instance.configuration.ServiceWorkerFetchStrategy),e.isTokenGeneratedFromWorkload=!0,delete e.headers["x-o365suiteuxshell-workloadid"],i.executeCrossDomainRequestAsync(e,!0))})).catch((t=>{1===t.responseType&&i.executeCrossDomainRequestAsync(e)})):i.executeCrossDomainRequestAsync(e):a(new o.W("OauthTokenFactoryIframe",-1011))}))}callWebClientShellServiceFunction(e,t,n,a){const i=(0,r.JT)("{0}/{1}",s.p.Instance.configuration.TokenFactoryIframeOrigin,"/"===e.charAt(0)?e.substr(1):e);null==n&&(n={}),"Content-Type"in n||(n["Content-Type"]="application/json;charset=UTF-8"),"Accept"in n||(n.Accept="application/json");const o={method:t,url:i,resource:s.p.Instance.configuration.TokenFactoryIframeOrigin,body:JSON.stringify(a),headers:n};return this.callEndpointWithOauthToken(o)}owaSessionStorageRequest(e){return new Promise(((t,n)=>{if(i.throwOnUndefined(e,"data"),this.shouldBlockCall(4))return void n(new o.W("SuiteService",-1011));const a={url:s.p.Instance.suiteServiceHostPageBaseUrl,requestObject:e,timeout:3e4,success:e=>t(e.responseObject),error:(e,t,a)=>n(new o.W(a,-2002))},r=g.b6.OwaInstance;null==r?n(new o.W("SuiteService",-1011)):r.executeStorageRequest(a)}))}callOwaIframeWithOrWithoutRetry(e,t,n,a,i=!0){const r={};if(null!=t)for(const e of Object.keys(t))r[e]=t[e];r.Accept="application/json",r["Content-Type"]="application/json; charset=utf-8";const l=s.p.Instance.MailboxGuid,u=s.p.Instance.configuration.ShellSID,d=l||u;let p=c.generateCorrelationId(d);r["X-OWA-CorrelationId"]=p;const h=JSON.stringify(n);return new Promise(((n,s)=>{if(null!=this.suiteServiceCallsBlockedReason){const e=new o.W(this.suiteServiceCallsBlockedReason,-1010);return s(e)}const l=g.b6.OwaInstance;if(null===l)return void this.executeErrorCallback(t,s,c.convertErrorToException(null,-1011,"OwaIframe"));let u=!1;this.firstDataRequestSent||(u=!0,this.firstDataRequestSent=!0);const m=e=>{null!=this.owaCallsInterceptor&&this.owaCallsInterceptor.afterSuiteServiceSuccess(e.headers),n(e.body)};this.owaHttpRequest(l,e,h,r,a).then(m).catch(i?n=>{449===n.HttpStatus?this.owaHttpRequest(l,e,h,r,a).then(m).catch((e=>this.executeErrorCallback(t,s,e))):null!=n[y.XSuiteError]&&n[y.XSuiteError]===y.WrongServerException?(p=c.generateCorrelationId(d),r["X-OWA-CorrelationId"]=p,this.owaHttpRequest(l,e,h,r,a).then((e=>{m(e)})).catch((e=>{this.executeErrorCallback(t,s,e)}))):s(n)}:()=>{s()})}))}owaHttpRequest(e,t,n,r,s){return new Promise(((o,u)=>{if(i.throwOnNullOrUndefined(t,"url"),this.shouldBlockCall(this.getExchangeServiceToCall(t)))return u(c.convertErrorToException(null,-1010,this.suiteServiceCallsBlockedReason));let d=null;const p={headers:r,url:t,method:s.toString(),body:s!==f.o.GET?n:void 0,success:e=>{const t=c.getOwaError(e.headers);if(null!=t)return this.checkAndHandleBlockingOwaErrors(t),void u(c.convertErrorToException(e,e.statusCode,t));try{o(e)}catch(e){}null!=d&&d()},error:(e,t,n)=>{const i=c.getOwaError(e.headers);null!=i&&this.checkAndHandleBlockingOwaErrors(i),e.statusCode!==y.HttpStatusCodeTokenExpired&&e.statusCode!==y.HttpStatusCodeUnauthorized||(this.blockSuiteServiceCalls(l.I.TokenExpired,t,n),(0,a.NP)().invoke("AuthenticationExpired")),u(c.convertErrorToException(e,t,n))}};if(this.ShouldQueueOwsCalls)if(this.isStartupAction(r))d=()=>{this.setStartupActionCompleted(),d=null};else if(2===this.getExchangeServiceToCall(p.url))return void this.queuedCalls.push(new S(e,p,u));e.executeAsync(p)}))}registerAuthenticationExpiredCallback(e){(0,a.NP)().subscribe("AuthenticationExpired",e,!0)}registerCultureNotSetCallback(e){(0,a.NP)().subscribe("CultureNotSet",e,!0)}guaranteeConnectionEstablished(e){this.ConnectionEstablished||s.p.Instance.configuration.IsOwa?e():this.startupCallbacks.push(e)}blockSuiteServiceCalls(e,...t){
// the more important blocking reasons are evaluated first e.g. NoExoLicense etc
null!=this.suiteServiceCallsBlockedReason&&e!==l.I.ShardNotDetected||(this.suiteServiceCallsBlockedReason=e.toString(),(0,a.tZ)().tag("RequestExecuter_SuiteServiceCallsBlocked",4,l.I[e],t))}stopBlockingCalls(){this.suiteServiceCallsBlockedReason=null}callStartupCallbacks(){for(const e of this.startupCallbacks)null!=e&&e();this.startupCallbacks=[]}checkAndHandleBlockingOwaErrors(e){e.indexOf("OwaInvalidUserLanguageException")>-1?(this.blockSuiteServiceCalls(l.I.LanguageNotSet,e),(0,a.NP)().invoke("CultureNotSet")):"InvalidMailbox"===e?this.blockSuiteServiceCalls(l.I.InvalidMailbox,e):"ShardMailbox"===e&&this.blockSuiteServiceCalls(l.I.ShardMailbox,e)}getExchangeServiceToCall(e){const t=null!=e?d.getUrlPath(e):null;if(t){const e=(e,t)=>e.substr(0,t.length)===t;if(e(t,d.SuiteServiceApiRelativePath))return 3;if(e(t,d.OwsRelativePath))return 2;if(e(t,d.DevFabricOwsRelativePath))return 2}const n=new Error("Cannot Acquire Exchange Service to Call");throw(0,a.tZ)().exception("Service_ExchangeServiceAcquireFail",6,n,t),n}shouldBlockCall(e){return null!=this.suiteServiceCallsBlockedReason&&!(2!==e&&y.callBlockingReasonsSpecificToOws.indexOf(this.suiteServiceCallsBlockedReason))}executeErrorCallback(e,t,n){try{t(n)}catch(e){}if(!this.owsStartupActionCompleted&&this.isStartupAction(e)){const e=n.errorCode||0,t=-1005===e?l.I.CallerOriginNotAllowed:l.I.InitFailed;this.blockSuiteServiceCalls(t,e,n.message);const a=c.convertErrorToException(null,-1010,"App initialization failed, call canceled",e,n.message);for(const e of this.queuedCalls)try{e.ErrorCallback(a)}catch(e){}this.queuedCalls=[]}}isUserInitiatedCall(e){return y.userInitiatedCalls.indexOf(e.toLowerCase())>=0}isStartupAction(e){const t=s.p.Instance.configuration.StartupActionName;return null!=t&&t===e[y.ActionHeaderKey]}}y.ActionHeaderKey="Action",y.UPNAnchorMailboxHeaderKey="X-UpnAnchorMailbox",y.XSuiteError=c.XSuiteError,y.HttpStatusCodeUnauthorized=401,y.HttpStatusCodeTokenExpired=440,y.WrongServerException="WrongServerException",y.instance=new y,y.callBlockingReasonsSpecificToOws=[l.I.LanguageNotSet.toString(),l.I.InitFailed.toString(),l.I.InvalidMailbox.toString(),l.I.ShardMailbox.toString()],y.userInitiatedCalls=["getowauserconfiguration"]},66873:function(e,t,n){"use strict";n.d(t,{p:function(){return a}});class a{constructor(e){this.suiteServiceHostPageBaseUrl=e.SuiteServiceUrl.substring(0,e.SuiteServiceUrl.lastIndexOf("/")),this.configuration=e}static Initialize(e){this.instance=new a(e)}static get Instance(){return this.instance}static assertInitialized(){if(null===a.Instance)throw new Error("SessionData not initialized.")}}a.isUnitTestMode=!1},88514:function(e,t,n){"use strict";n.d(t,{E:function(){return r}});var a=n(16968),i=n(66873);class r{static getToken(e){return new Promise(((t,n)=>{if(i.p.Instance.configuration.GetTokenRequestDictionary){let r=i.p.Instance.configuration.GetTokenRequestDictionary(),s=e=>{e?t({token:e,responseType:0}):((0,a.tZ)().tag("GetAccessToken_Empty",6),n({responseType:2}))},o=e=>{(0,a.tZ)().exception("GetAccessToken_Failed",6,e),n({responseType:2,exception:e})};if(r[e.resource]){let t=r[e.resource];"function"==typeof t?t().then((e=>{s(e)})).catch((e=>{o(e)})):t.then((e=>{s(e)})).catch((e=>{o(e)}))}else n({responseType:1})}else n({responseType:1})}))}}},77441:function(e,t,n){"use strict";n.d(t,{V:function(){return c}});var a=n(530),i=n(87948),r=n(9522);const s='{ "kty": "oct", "k": "{0}", "extractable": true }';let o;const l=void 0!==typeof btoa;class c{static loadCryptoModule(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return new Promise((e=>{void 0!==o?e():null!=window.crypto?(o=window.crypto,e()):n.e("msrcrypto").then(n.t.bind(n,67246,23)).then((t=>{o=t,e()}))}))}))}static computeSHA256(e){return(0,a.__awaiter)(this,arguments,void 0,(function*(e,t=!0){return yield this.loadCryptoModule(),new Promise(((n,a)=>{try{let i=c.textToUInt8Array(e,t),r={name:"SHA-256"},s=o.subtle.digest(r,i);const l=e=>{if(c.verifyResult(e,a)){let t=Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("");n(c.toBase64(t))}},u=e=>{c.verifyResult(e,a)&&a(e.toString())};s.then(l,u)}catch(e){a(e.toString())}}))}))}static encryptAES(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return yield this.loadCryptoModule(),new Promise(((a,r)=>{try{let l=(0,i.JT)(s,c.base64ToBase64Url(e)),u={name:"AES-CBC"},d=o.subtle.importKey("jwk",JSON.parse(l),u,!0,["encrypt","decrypt"]);const p=e=>{try{let i=e,s=c.textToUInt8Array(c.base64ToString(t),!1),l=c.textToUInt8Array(n,!0),u={name:"AES-CBC",iv:s},d=o.subtle.encrypt(u,i,l);const p=e=>{try{c.verifyResult(e,r)&&a(c.toBase64(c.bytesToText(e,!1)))}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e.toString())};d.then(p,h)}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e)};d.then(p,h)}catch(e){r(e.toString())}}))}))}static decryptAES(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return yield this.loadCryptoModule(),new Promise(((a,r)=>{try{let l=(0,i.JT)(s,c.base64ToBase64Url(e)),u={name:"AES-CBC"},d=o.subtle.importKey("jwk",JSON.parse(l),u,!0,["encrypt","decrypt"]);const p=e=>{try{let i=e,s=c.textToUInt8Array(c.base64ToString(t),!1),l=c.textToUInt8Array(c.base64ToString(n),!1),u={name:"AES-CBC",iv:s},d=o.subtle.decrypt(u,i,l);const p=e=>{try{c.verifyResult(e,r)&&a(c.bytesToText(e,!0))}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e.toString())};d.then(p,h)}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e.toString())};d.then(p,h)}catch(e){r(e.toString())}}))}))}static textToUInt8Array(e,t){e=t?encodeURI(e):e;let n=[];for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return new Uint8Array(n)}static bytesToText(e,t){let n=(0,r.convertArrayBufferToBinaryString)(e);return t?decodeURI(n):n}static base64ToBase64Url(e){return e.replace(new RegExp("\\+","g"),"-").replace(new RegExp("/","g"),"_").replace(new RegExp("=","g"),"")}static verifyResult(e,t){return null!=e||(t("result undefined"),!1)}static base64ToString(e){if(!l)return o.base64ToString(e);for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4!=0;)e+="=";return atob(e)}static toBase64(e,t){if(!l)return o.toBase64(e);let n="";return t||(t=!1),n=btoa(e),t?n.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):n}}},23653:function(e,t,n){"use strict";n.d(t,{K:function(){return i},W:function(){return a}});class a{constructor(e="",t,n){if(this.message=e,this.errorCode=t,this.errorInfo=n,this.name="ShellException",null!=n)for(let e of Object.keys(n))this[e]=n[e]}}class i extends a{constructor(e="",t,n){super(e,t,n),this.message=e,this.errorCode=t,this.errorInfo=n,this.name="RequestExecutorException"}}},44954:function(e,t,n){"use strict";n.d(t,{o:function(){return a}});class a{}a.GET="GET",a.POST="POST",a.PUT="PUT",a.PATCH="PATCH",a.DELETE="DELETE"},27501:function(e,t,n){"use strict";n.d(t,{D8:function(){return s},Ep:function(){return h},Kb:function(){return m},Kl:function(){return r},Kx:function(){return c},P8:function(){return o},Pr:function(){return a},Xs:function(){return d},fo:function(){return g},iZ:function(){return p},pc:function(){return l},s5:function(){return u},wI:function(){return i}});const a="Request was aborted or timed out",i="Browser not supported",r="Invalid field or parameter {0}",s="Cannot access {0}",o="Binary data not supported",l="Invalid operation",c="Session storage error",u="Unable to parse json",d="Status:{0}, Content-type:{1}",p="Access denied",h="Timeout due to trusted sites",g="Could not find IFrame element.",m="Message listener is not attached."},9522:function(e,t,n){"use strict";n.r(t),n.d(t,{BooleanTypeString:function(){return d},DevFabricOwsRelativePath:function(){return y},FunctionTypeString:function(){return p},NumberTypeString:function(){return h},OwaIFrameID:function(){return g},OwsRelativePath:function(){return S},PostMessageIdPrefix:function(){return C},StringTypeString:function(){return u},SuiteServiceApiRelativePath:function(){return f},TokenFactoryIFrameID:function(){return m},buildIframeResourceData:function(){return R},buildUrl:function(){return A},checkBrowserBinaryDataSupport:function(){return W},convertArrayBufferToBinaryString:function(){return N},convertBinaryStringToXmlHttpRequestBody:function(){return U},createInvalidParameterException:function(){return w},encodeUrlForXmlHttpRequest:function(){return _},endsWith:function(){return H},ensureAttachMessageListener:function(){return Z},getCurrentWindowLocation:function(){return v},getFrameElement:function(){return $},getFrameID:function(){return ee},getUrlAuthorityPart:function(){return L},getUrlDomainPart:function(){return x},getUrlPath:function(){return k},getXMLHttpRequest:function(){return P},getXMLHttpResponseLength:function(){return te},isFullUrl:function(){return I},isNullOrEmptyString:function(){return O},parseQueryString:function(){return F},parseResponseHeaders:function(){return M},reportSimpleError:function(){return j},startsWith:function(){return B},urlEncodeCore:function(){return Y},validateField:function(){return T},validateFullUrl:function(){return D},validateRequestInfo:function(){return E}});var a=n(16968),i=n(87948),r=n(45011),s=n(74107),o=n(917),l=n(23653),c=n(27501);const u="string",d="boolean",p="function",h="number",g="o365shellowaframe",m="o365shellwcssframe",f="O365SuiteService/api/",S="owa/service.svc",y="SuiteService.svc",C="SP.RequestExecutor",b="https://";function T(e,t,n,a){if(a){if(null==e||typeof e!==n)throw new l.K((0,i.JT)(c.Kl,t),-2001)}else if(null!=e&&typeof e!==n)throw new l.K((0,i.JT)(c.Kl,t),-2001)}function I(e){return e.substr(0,b.length).toLowerCase()===b}function D(e,t){if(!I(e))throw w(t)}function v(){return window.location.href}function w(e){return new l.K((0,i.JT)(c.Kl,e),-2001)}function O(e){return""===e||null==e}function A(e,t){if(D(e,"baseUrl"),I(t))return t;if("/"===t.charAt(0)){let n=e.indexOf("://");return n=e.indexOf("/",n+3),n>0&&(e=e.substr(0,n)),e+t}return"/"!==e.charAt(e.length-1)&&(e+="/"),e+t}function x(e,t=!1){t&&D(e,"url");let n=e.indexOf("://");return n=e.indexOf("/",n+3),n>0&&(e=e.substr(0,n)),e.substr(0,b.length).toLowerCase()===b&&":443"===e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),e}function k(e){let t="",n=x(e);const a=e.indexOf("?");return t=a>n.length+1?e.substring(n.length+1,a):e.substring(n.length+1,e.length),t}function L(e){return(e=x(e)).substr(0,b.length).toLowerCase()===b&&(e=e.substr(b.length)),e.toLowerCase()}function R(e,t){const n=(0,r.ZR)(t.ShellResources.crossdomainproxyiframe),a=(0,r.ZR)(t.ShellResources.msaltokenfactoryiframe);return{version:e,crossdomainproxyJsHash:n.hash,msaltokenfactoryJsHash:a.hash,resourceCatalogHostUrl:t.ResourceCatalogHostUrl}}function P(){if(!("XMLHttpRequest"in window))throw new l.K(c.wI,-2003);return new XMLHttpRequest}function E(e){if(null==e)throw w("requestInfo");if(T(e.url,"requestInfo.url",u,!0),T(e.body,"requestInfo.body",u,!1),T(e.success,"requestInfo.success",p,!1),T(e.error,"requestInfo.error",p,!1),T(e.timeout,"requestInfo.timeout",h,!1),T(e.method,"requestInfo.method",u,!1),T(e.binaryStringRequestBody,"requestInfo.BinaryRequestBody",d,!1),T(e.binaryStringResponseBody,"requestInfo.BinaryResponseBody",d,!1),O(e.method)?e.method="GET":e.method=e.method.toUpperCase(),null==e.timeout&&(e.timeout=o.T.DefaultTimeout),e.timeout<0)throw w("requestInfo.timeout");if(O(e.url))throw w("requestInfo.url")}function N(e){let t="";const n=new Uint8Array(e);for(let e=0;e<n.length;e++)t+=String.fromCharCode(n[e]);return t}function U(e){let t=null;if(typeof e===u){let n=new ArrayBuffer(e.length),a=new Uint8Array(n);for(let t=0;t<e.length;t++)a[t]=255&e.charCodeAt(t);let i=new Blob([n]);t=i||n}return t}function F(e){let t="";const n=e.indexOf("?");return n>0&&(t=e.substr(n+1,e.length)),t}function M(e){let t={};if(null!=e){let n=new RegExp("\r?\n"),a=e.split(n);for(let e of a)if(null!=e){let n=e.indexOf(":");if(n>0){let a=e.substr(0,n),i=e.substr(n+1);a=q(a),i=q(i),t[a.toUpperCase()]=i}}}return t}function q(e){return e.replace(/^\s+|\s+$/g,"")}function B(e,t){return 0===e.lastIndexOf(t,0)}function H(e,t){let n=e.lastIndexOf(t);return-1!==n&&n===e.length-t.length}function W(){if(!("ArrayBuffer"in window))throw(0,a.tZ)().tag("RequestExecutor_ArrayBufferNotSupported",6,-2003,c.P8),new l.K(c.P8,-2003);if(!("Uint8Array"in window))throw(0,a.tZ)().tag("RequestExecutor_Uint8ArrayNotSupported",6,-2003,c.P8),new l.K(c.P8,-2003);if(!("BlobBuilder"in window)&&!("MozBlobBuilder"in window)&&!("Blob"in window))throw(0,a.tZ)().tag("RequestExecutor_BlobBuilderNotSupported",6,-2003,c.P8),new l.K(c.P8,-2003)}function Z(e){if(window.addEventListener)return window.addEventListener("message",e,!1),!0;throw new l.K(c.Kb,-2002)}function j(e,t,n,i){if(null!=e.error){let a={state:e.state,body:""};i&&(n=`${n} target: ${i}`),e.error(a,t,n)}else(0,a.tZ)().tag("RequestExecutor_NoErrorCallback",6,t.toString(),n)}function _(e){return Y(e,!0,!0)}const G=224,z=192,V=240,J=128,K=55296,Q=64512,X=65536;function Y(e,t,n){let a,i="";if(O(e)||void 0===e||0===e.length)return"";for(let r=0;r<e.length;r++){let s=e.charCodeAt(r),o=e.charAt(r);if(t&&("#"===o||"?"===o)){i+=e.substr(r);break}if(s<=127)n||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s>=32&&s<=95&&" \"%<>'&".indexOf(o)<0?i+=o:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase());else if(s<=2047)a=z|s>>6,i+="%"+a.toString(16).toUpperCase(),a=J|63&s,i+="%"+a.toString(16).toUpperCase();else if((s&Q)!==K)a=G|s>>12,i+="%"+a.toString(16).toUpperCase(),a=J|(4032&s)>>6,i+="%"+a.toString(16).toUpperCase(),a=J|63&s,i+="%"+a.toString(16).toUpperCase();else if(r<e.length-1){s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),s+=X,a=V|s>>18,i+="%"+a.toString(16).toUpperCase(),a=J|(258048&s)>>12,i+="%"+a.toString(16).toUpperCase(),a=J|(4032&s)>>6,i+="%"+a.toString(16).toUpperCase(),a=J|63&s,i+="%"+a.toString(16).toUpperCase()}}return i}function $(e){return document.getElementById(ee(e))}function ee(e){switch(e){case s.J.OWA:return g;case s.J.TokenFactory:return m;default:return(0,a.tZ)().tag("RequestExecutor_UnsupportedFrameCodeSpecified",6),""}}function te(e){return"arraybuffer"===e.responseType?e.response?e.response.byteLength:0:e.responseText?e.responseText.length:0}},7668:function(e,t,n){"use strict";var a;n.d(t,{I:function(){return a}}),function(e){e[e.NoExoLicense=1]="NoExoLicense",e[e.Brs=2]="Brs",e[e.TokenExpired=3]="TokenExpired",e[e.LanguageNotSet=4]="LanguageNotSet",e[e.InitFailed=5]="InitFailed",e[e.SecurityZoneMismatched=6]="SecurityZoneMismatched",e[e.IframeLoadError=7]="IframeLoadError",e[e.CallerOriginNotAllowed=8]="CallerOriginNotAllowed",e[e.InvalidMailbox=9]="InvalidMailbox",e[e.ShardMailbox=10]="ShardMailbox",e[e.ShardNotDetected=11]="ShardNotDetected",e[e.Pwa=12]="Pwa"}(a||(a={}))},68105:function(e,t,n){"use strict";n.d(t,{B:function(){return r}});var a=n(73637),i=n(9522);n(48314);class r{static onBeforeSendRequestSuiteService(e,t,n){if(null!=n&&null!=n.userMailboxType&&null!=t&&-1!==i.parseQueryString(t.url.toLowerCase()).indexOf("getowauserconfiguration"))try{JSON.parse(n.userMailboxType)}catch(e){}{let t="X-OWA-CANARY",n="X-OWA-CANARY-DEBUG",i=(0,a.R)(t),r=(0,a.R)(n);return null!=i&&e.setRequestHeader(t,i),null!=r&&e.setRequestHeader(n,r),null}}static validateOriginWithAllowedEndpoints(e,t){let n=[];for(let e=0;e<t.length;e++)n[e]=t[e].host;return r.validateOrigin(i.getUrlAuthorityPart(e),n)}static validateOrigin(e,t){if(null==t||e.length>253)return!1;let n,a=!1;for(let i=0;i<t.length;i++)if(""!==t[i]&&(n=new RegExp(t[i],"i"),n.test(e))){a=!0;break}return a}static validatePathWithAllowedEndpoints(e,t){if(i.isNullOrEmptyString(e))return!1;let n,a=!1;const r=i.getUrlAuthorityPart(e),s=i.getUrlPath(e);for(let e of t)if(n=new RegExp(e.host,"i"),n.test(r)){if(null==e.paths)return!1;for(let t of e.paths)if(n=new RegExp(t,"i"),n.test(s)){a=!0;break}break}return a}static validatePathWithAllowedResources(e,t,n){if(null==e||i.isNullOrEmptyString(t)||null==n)return!1;let a,r=!1;const s=i.getUrlAuthorityPart(e),o=i.getUrlAuthorityPart(t);for(let e of n){let t=!1;if("^"===e.resource.charAt(0))a=new RegExp(e.resource,"i"),t=a.test(s);else{t=i.getUrlAuthorityPart(e.resource)===s}if(t){if(null==e.hosts)return!1;for(let t of e.hosts){let e=!1;if("^"===t.charAt(0))a=new RegExp(t,"i"),e=a.test(o);else{e=i.getUrlAuthorityPart(t)===o}if(e){r=!0;break}}break}}return r}static isAllowedApi(e){if(null==e)return!1;let t=i.getUrlPath(e);if(t in r.allowedPath){if(!r.allowedPath[t])return!0;if(i.parseQueryString(e).replace("&UA=0","")in r.allowedListOfApi)return!0}else if(i.startsWith(t,i.SuiteServiceApiRelativePath))return!0;return("owa/ev.owa2"===t||"ev.owa2"===t)&&r.checkAllowedPgmParameters(e)}static checkAllowedPgmParameters(e){if(i.isNullOrEmptyString(e)||""===e.trim())return!1;let t=e.split("?");if(2===t.length){let e=t[1];if(i.isNullOrEmptyString(e)||""===e.trim())return!1;let n=e.split("&");for(let e of n){let t=e.split("=");if(2!==t.length)return!1;if(!(t[0]in r.AllowedPgmQueryStringParametersList))return!1}return!0}return!1}static createAllowedPgmParamters(){return{ecnsq:!0,brwnm:!0,cid:!0,syncFnshRq:!0,ns:!0,ev:!0,Fn:!0,UA:!0,"UX-E4E-CANARY":!0,"X-OWA-CANARY":!0,"X-OWA-CANARY-DEBUG":!0,"X-E4E-CANARY-DEBUG":!0}}static createAllowedApiList(){return{"action=GetReminders":!0,"action=GetOwaUserConfiguration":!0,"action=SetNotificationSettings":!0,"action=FindItem":!0,"action=GetUserAvailabilityInternal":!0,"action=GetCalendarFolders":!0,"action=ProcessSuiteStorage":!0,"action=SubscribeToNotification":!0,"action=PerformReminderAction":!0,"action=GetOwaUserOofSettings":!0,"action=SetUserTheme":!0,"action=SetUserLocale":!0,"action=UnsubscribeToNotification":!0,"action=GetDaysUntilPasswordExpiration":!0,"action=GetModernGroups":!0,"action=GetModernGroup":!0,"action=GetModernGroupUnseenItems":!0,"action=GetCalendarFolderConfiguration":!0,"action=SubscribeToGroupUnseenNotification":!0,"action=SubscribeToGroupNotification":!0,"action=GetSocialActivityNotifications":!0,"action=GetSocialActivityNotifications2":!0,"action=MarkSocialActivityNotificationsAsSeen":!0,"action=MarkSocialActivityNotificationsAsSeen2":!0,"action=GetBingHelpSearchResults":!0,"action=GetMailboxRegionalConfiguration":!0,"action=SetMailboxRegionalConfiguration":!0,"format=json":!0,"api-version=1":!0,"action=TestAddReminders":!0,"action=TestDeleteAllReminders":!0,"action=TestAddItems":!0,"action=TestDeleteAllItems":!0,"action=TestAddCalendarFolders":!0,"action=TestAddCalendarGroups":!0,"action=TestDeleteAllCalendarFolders":!0,"action=TestDeleteAllCalendarGroups":!0,"action=TestAddUserAvailability":!0,"action=TestDeleteAllUserAvailability":!0,"action=TestAddOwaUserOofSettings":!0,"action=TestDeleteNotifications":!0,"action=TestAddNotifications":!0,"action=TestGetSettings":!0}}static createAllowedPath(){return{[i.OwsRelativePath]:!0,"SuiteService.svc/":!0,"SuiteService.svc":!0,"owa/ev.owa2":!0,"ev.owa2":!0,"Microsoft.Online.BOX.Admin.UI.SystemAlert.GetAlerts.model":!0,"Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetPrePinnedAppTiles.model":!0,"Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetAllAppTilesForAllCollectors.model":!0,"api/myapps/GetAllApps":!1,"api/myapps/GetAppDetails":!1,"api/myapps/GetCompleteAppData":!1,"api/myapps/ExecuteAppCustomAction":!1,"api/myapps/ActivatePendingProvisioningApps":!1,"owa/service.svc/s/GetPersonaPhoto":!1,"api/settings/cards":!1,"api/settings/cards/data":!1,"api/settings/theme":!1,"api/settings/darkmode":!1,"api/settings/language":!1,"api/settings/contactPreferences":!1,"api/NotificationsSettings/User":!1,"api/settings/SPO/MySiteUrl":!1,"api/settings/regiontimezone":!1,"api/profile/photo":!1,"v1.0/me/photo/$value":!1,"api/storage/CustomerContent/Tenant/CustomSupportData":!0}}}r.allowedPath=r.createAllowedPath(),r.allowedListOfApi=r.createAllowedApiList(),r.AllowedPgmQueryStringParametersList=r.createAllowedPgmParamters()},3709:function(e,t,n){"use strict";n.r(t),n.d(t,{XSuiteError:function(){return p},convertErrorToException:function(){return C},generateCorrelationId:function(){return m},genericServiceExceptionLog:function(){return T},genericServiceRejection:function(){return I},getOwaError:function(){return S},getOwaServerName:function(){return f},isCallsBlockedException:function(){return b}});var a=n(16968),i=n(87948),r=n(66873),s=n(23653);class o{constructor(e){this.value=e}static newSuid(){const e=(new Date).getTime();return o.disambiguationIndex=99===o.disambiguationIndex?0:o.disambiguationIndex+1,new o(100*e+o.disambiguationIndex)}}o.disambiguationIndex=-1;const l="X-OWA-ERROR",c="X-OWA-CORRELATIONID",u="X-FESERVER",d="X-BESERVER",p="X-SUITE-ERROR",h="FE_{0}_BE_{1}",g=[c,u,d,l,p];function m(e){return e+"_"+o.newSuid().value.toString()}function f(){return(0,i.JT)(h,r.p.Instance.OwaFrontEndServerName,r.p.Instance.OwaBackEndServerName)}function S(e){return null==e?null:(null!=e[u]&&(r.p.Instance.OwaFrontEndServerName=e[u]),null!=e[d]&&(r.p.Instance.OwaBackEndServerName=e[d]),e[l])}const y="errorCode";function C(e,t,n,...a){let i=function(e){let t={};if(null!=e&&(t.HttpStatus=e.statusCode,null!=e.headers))for(let n of g)null!=e.headers[n]&&(t[n]=e.headers[n]);return t}(e);i[y]=t;let r=0;for(let e of a)i["arg"+r]=e,r++;return new s.W(n,t,i)}function b(e){return-1010===e.errorCode||-1007===e.errorCode}function T(e,t,n){if(n){const r=n.errorCode||"",s=n.errorInfo&&n.errorInfo.HttpStatus?n.errorInfo.HttpStatus:"",o=n[l]||n[p]||"",g=null!=n[u]&&null!=n[d]?(0,i.JT)(h,n[u],n[d]):"",m=n[c]||"";(0,a.tZ)().exception(e,t,n,r,s,o,g,m)}else(0,a.tZ)().exception(e,t,n)}function I(e,t,n,a){b(n)&&T(e,t,n),a(n)}},83834:function(e,t,n){"use strict";n.d(t,{A:function(){return c}});var a=n(73637),i=n(77441),r=n(23653),s=n(27501),o=n(9522);const l="$";class c{static processRequest(e,t){let n={},l=(0,a.R)("SuiteServiceProxyKey"),u=null,d=null;if(o.isNullOrEmptyString(l)){if(l=(0,a.R)("ClientStorageCookie"),o.isNullOrEmptyString(l))throw new r.W(s.Kx,-2007);l=decodeURIComponent(l)}const p=l.split("&");if(2!==p.length)throw new r.W(s.Kx,-2007);if(u=p[0],d=p[1],o.isNullOrEmptyString(e.UserId))throw new r.W(s.Kx,-2004);let h=window.sessionStorage;if(null==h)throw new r.W(s.Kx,-2005);try{let a=e.UserId;const o=a=>{h.setItem("CurrentUserId",a),c.doClearAll(e,n,h),c.doDeletes(e,n,h),c.doWritesAndReads(e,u,d,h,n,t)},l=e=>{const a=null==e?s.Kx:e;n.ResetError=new r.W(a,-2008),t(n)};i.V.computeSHA256(a).then(o).catch(l)}catch(e){n.ResetError=e,t(n)}}static doClearAll(e,t,n){try{if(!0===e.ClearAll){const e=Object.keys(n);c.doDeletes({Deletes:e},t,n)}}catch(e){t.ClearError=e}}static doDeletes(e,t,n){try{if(null!=e.Deletes)for(let t of e.Deletes)n.removeItem(t)}catch(e){t.DeleteError=e}}static doWritesAndReads(e,t,n,a,i,r){try{null!=e.Writes?c.encryptWrites(t,n,e.Writes,0,a,(()=>{c.doReads(e,t,n,a,i,r)}),(s=>{i.WriteError=s,c.doReads(e,t,n,a,i,r)})):c.doReads(e,t,n,a,i,r)}catch(s){i.WriteError=s,c.doReads(e,t,n,a,i,r)}}static doReads(e,t,n,a,i,r){try{if(null!=e.Reads){let s={};c.decryptReads(t,n,e.Reads,0,s,a,(e=>{i.Reads=e,r(i)}),(e=>{i.ReadError=e,r(i)}))}}catch(e){i.ReadError=e,r(i)}}static encryptWrites(e,t,n,a,o,u,d){null!=n&&a<n.length?null==e?(o.setItem(n[a].Key,n[a].Value),c.encryptWrites(e,t,n,a+1,o,u,d)):i.V.encryptAES(e,t,l+n[a].Value+l).then((i=>{o.setItem(n[a].Key,i),c.encryptWrites(e,t,n,a+1,o,u,d)})).catch((e=>{let t=null==e?s.Kx:e;d(new r.W(t,-2009))})):u()}static decryptReads(e,t,n,a,s,u,d,p){if(null!=n&&a<n.length){let h=n[a],g=u.getItem(h);null===g?c.decryptReads(e,t,n,a+1,s,u,d,p):(null===e&&(s[h]=g,c.decryptReads(e,t,n,a+1,s,u,d,p)),i.V.decryptAES(e,t,g).then((i=>{null==i||!o.startsWith(i,l)||!o.endsWith(i,l)||i.length<2?c.doClearAll({ClearAll:!0},{},u):s[h]=i.substr(1,i.length-2),c.decryptReads(e,t,n,a+1,s,u,d,p)})).catch((i=>{"OperationError"===i?(c.doClearAll({ClearAll:!0},{},u),c.decryptReads(e,t,n,a+1,s,u,d,p)):p(new r.W(i))})))}else d(s)}}},24126:function(e,t,n){"use strict";n.d(t,{WJ:function(){return o.W},oZ:function(){return l.o},kN:function(){return g.k},b6:function(){return i.b6},OY:function(){return d},kl:function(){return r.k},IY:function(){return c.I},F2:function(){return h},pf:function(){return s.p},YM:function(){return p},xZ:function(){return S}});var a=n(917),i=n(37171),r=n(83251),s=n(66873),o=(n(77441),n(23653)),l=n(44954),c=n(7668),u=(n(68105),n(27501)),d=n(9522);class p{static checkScope(e,t){if(null!=e&&!(0,d.startsWith)(e,t+p.DictionaryStringPartsSeparator))throw new o.W(u.iZ,-2010)}}p.SuiteScope="O365S",p.DictionaryStringPartsSeparator="//";n(83834);var h=n(3709),g=n(48314);class m{}m.MSA="msa",m.AAD="aad",m.MSAFed="msaFed";let f=null;try{window.MSA&&window.MSA.MeControl&&(f=window.MSA.MeControl.UserStateModel)}catch(e){}function S(){"complete"===document.readyState?a.T.internalProcessWindowLoad():window.onload=a.T.internalProcessWindowLoad}},75511:function(e,t,n){"use strict";var a,i;n.d(t,{$:function(){return i},C:function(){return a}}),function(e){e.LifeCycle="LifeCycle",e.DataProviderResponseNotification="DataProviderResponseNotification",e.ChallengeToken="ChallengeToken"}(a||(a={})),function(e){e.GetConfig="GetConfig",e.RefreshToken="RefreshToken",e.PageReady="PageReady",e.Closed="Closed",e.FatalError="FatalError"}(i||(i={}))},48314:function(e,t,n){"use strict";var a;n.d(t,{k:function(){return a}}),function(e){e.Ping="Ping",e.Query="Query",e.OwaUserConfig="OwaUserConfig",e.TokenPrefetch="TokenPrefetch",e.Storage="Storage",e.Notification="Notification",e.UserState="UserState",e.SignalR="SignalR",e.IncomingOpxMessage="IncomingOpxMessage",e.OutgoingOpxMessage="OutgoingOpxMessage",e.RegisterOpxHost="RegisterOpxHost"}(a||(a={}))},47710:function(e,t,n){"use strict";n.d(t,{TR:function(){return a}});const a="cdn-url#oneshell"},50003:function(e,t,n){"use strict";n.d(t,{CR:function(){return o},Cg:function(){return c},O_:function(){return u},Rt:function(){return d},g2:function(){return p},vi:function(){return h}});var a=n(16968),i=n(99542),r=n(88128),s=n(68425);const o={IsVirtual:!0,ParallelView:!0,Style:"o365shell",CanCollapse:!0,SuppressBackgroundRinging:!0};let l;function c(e,t){!t&&swc&&(e?swc.API.triggerEvent(r.$D.ApiRecentsShown):swc.API.triggerEvent(r.$D.ApiRecentsHidden))}function u(e,t){!t&&swc&&swc.SDK.Recents.refreshDOM(e)}function d(e,t,n){!n&&swc?(swc.API.registerEvent(r.$D.ApiRecentsReady,t),swc.create(r.nR.Recents,{},e)):n&&(l=e)}function p(e,t){TeamsClient&&TeamsClient.client&&TeamsClient.client.conversations.get().then((n=>{n.render(l).then(e),n.subscribe((e=>{e.type===s.G.ConversationOpened&&t(!1,i.YZ)}))}))}function h(e,t){swc&&swc.getPresence().then((t=>{t.setMyStatus(e.key)})).catch((e=>{(0,a.tZ)().exception("UserPresence_SetMyStatus_Exception",6,e),t()}))}},88128:function(e,t,n){"use strict";var a,i,r;n.d(t,{$D:function(){return a},DP:function(){return i},nR:function(){return r}}),function(e){e.ChatCoreReady="swc:core:ready",e.ChatAPIReady="swc:ready",e.ApiRecentsReady="recentsReady",e.ApiRecentsShown="recentsShown",e.ApiRecentsHidden="recentsHidden",e.ApiUnreadConversationUpdate="unreadConversationsUpdate",e.ApiStartChat="startChat",e.ApiOnCallStart="onCallStart",e.ApiRecentItemsLoaded="recentItemsLoaded",e.ApiOnRecentItemSelected="onRecentItemSelected"}(a||(a={})),function(e){e.ChatRecents="skype-recents",e.ChatWrapper="chat-wrapper"}(i||(i={})),function(e){e.Calling="calling",e.Messaging="chat",e.Recents="recents"}(r||(r={}))},68425:function(e,t,n){"use strict";var a,i;n.d(t,{G:function(){return i},_:function(){return a}}),function(e){e[e.UnreadCounterUpdate=0]="UnreadCounterUpdate"}(a||(a={})),function(e){e.TeamsChatAPIReady="ms-teams-sdk-loaded",e.TeamsChatAuthFailed="ms-teams-sdk-auth-failed",e.ConversationOpened="conversationOpened",e.KeyPressed="keyPressed"}(i||(i={}))},29081:function(e,t,n){"use strict";n.d(t,{$6:function(){return o},FQ:function(){return r},I2:function(){return i},Kx:function(){return l},ij:function(){return c},q4:function(){return s},wW:function(){return a}});const a="suiteux-chat.UPDATE_IS_CHAT_RECENTS_INITIALIZED",i="suiteux-chat.UPDATE_IS_CHAT_API_INITIALIZED",r="suiteux-chat.UPDATE_IS_CHAT_API_PREAUTH_COMPLETED",s="suiteux-chat.UPDATE_UNREAD_CONVERSATION_COUNT",o="suiteux-chat.UPDATE_IS_TEAMS_CHAT_ACTIVATED",l="suiteux-chat.UPDATE_IS_TEAMS_CHAT_AUTH_FAILED",c="suiteux-chat.UPDATE_INIT_CHAT_IN_FIRST_CLICK"},95144:function(e,t,n){"use strict";n.d(t,{bS:function(){return I.bS},tz:function(){return i.t},kt:function(){return r.k},Bx:function(){return a.B},rP:function(){return g.r},z6:function(){return s.z},zD:function(){return o.z},l5:function(){return I.l5},zM:function(){return I.zM},qz:function(){return h},BE:function(){return I.BE},QR:function(){return I.QR},ui:function(){return I.ui},xw:function(){return y},B3:function(){return M},lQ:function(){return E.lQ},wk:function(){return F.wk},Rz:function(){return w},P3:function(){return O},AH:function(){return L.A},Fg:function(){return T.Fg},Wq:function(){return F.Wq},Oi:function(){return R},nQ:function(){return P},Jg:function(){return A},mD:function(){return N.mD},K$:function(){return k},_R:function(){return C},JT:function(){return f.JT},OU:function(){return x.O},YZ:function(){return f.YZ},vQ:function(){return f.vQ},BW:function(){return b},X7:function(){return v},Wg:function(){return E.Wg},lN:function(){return E.lN},j$:function(){return E.j$},h5:function(){return D.h},x_:function(){return U},qd:function(){return T.qd},ad:function(){return T.ad}});var a=n(18435),i=n(39038),r=n(79649),s=(n(10806),n(93884)),o=n(83694),l=n(90872),c=n(61304),u=n(40141),d=n(49152),p=n(52857);class h extends l.Component{constructor(e){super(e),this.setRef=e=>this.searchControl=e,this.SearchBarKey=e=>{let t=e.currentTarget.value;this.setState((()=>({currentSearchText:t,showDismissButton:!0}))),this.props.onSearch(t)},this.DismissDefaultText=()=>{this.state.clearTextOnFocus?this.setState((()=>({currentSearchText:"",showDismissButton:!1}))):this.setState((()=>({showDismissButton:!0,clearTextOnFocus:!0})))},this.DefaultSearchText=()=>{""===this.state.currentSearchText?this.setState((()=>({currentSearchText:this.props.defaultText,showDismissButton:!1}))):this.setState((()=>({clearTextOnFocus:!1})))},this.ButtonClearText=()=>{this.searchControl.focus(),this.searchControl.placeholder="",this.setState((()=>({currentSearchText:"",showDismissButton:!1}))),this.props.onSearch("")},this.moveCursor=()=>{this.searchControl.focus()},this.props.currentSearchText?this.state={currentSearchText:this.props.currentSearchText,showDismissButton:!0,clearTextOnFocus:!1}:this.state={currentSearchText:this.props.defaultText,showDismissButton:!1,clearTextOnFocus:!0}}getSearchResultAriaLabel(){return(0,f.vQ)(this.state.currentSearchText)?"":(0,f.JT)(c.D.SearchBoxResultAriaLabel,`${this.props.searchResultCount}`)}render(){let e=(0,u.e)(),t=(0,d.g)();return l.createElement("div",{className:(0,L.A)(p.SearchControl,t?p.SearchControlZoomMargin:null,e.neutral.foregroundAlt.background)},l.createElement("div",{"aria-live":"polite",style:{position:"absolute",left:"-999em",top:"0em"}},this.getSearchResultAriaLabel()),this.state.showDismissButton?l.createElement("button",{onClick:this.ButtonClearText,"aria-label":c.D.SearchBoxClearButtonText,title:c.D.SearchBoxClearButtonText},l.createElement(g.r,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--ChromeClose",fontSize:"12"})):l.createElement("button",{onClick:this.moveCursor,tabIndex:-1,"aria-hidden":!0},l.createElement(g.r,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--Search",fontSize:"12"})),l.createElement("input",{className:(0,L.A)(p.inputBox,e.neutral.dark.font),type:"text",onFocus:this.DismissDefaultText,value:this.state.currentSearchText,onChange:this.SearchBarKey,onBlur:this.DefaultSearchText,ref:this.setRef,placeholder:this.props.defaultText,id:"appLauncherSearch",autoComplete:"off","aria-label":this.props.ariaLabel||this.props.defaultText}))}}var g=n(46340),m=n(16968),f=n(87948),S=n(14821);class y extends l.Component{render(){var e,t,n,a,i;let r=(0,u.e)();if(null!=this.props.unseenItemCount&&0!==this.props.unseenItemCount){const s=null!==(e=this.props.badgeCharacter)&&void 0!==e?e:(0,f.d1)(this.props.unseenItemCount);let o=(0,L.A)(S.unseenCount,r.accent.border,{[r.badge]:!this.props.isParentHovered},{[S.emptyBadge]:""===this.props.badgeCharacter},{[S.emptyBadgeDarkMode]:""===this.props.badgeCharacter&&this.props.isDarkMode}),c={};return(null===(t=this.props.badgeColors)||void 0===t?void 0:t.badgeColor)&&(c.backgroundColor=this.props.badgeColors.badgeColor),(null===(n=this.props.badgeColors)||void 0===n?void 0:n.badgeFontColor)&&(c.color=this.props.badgeColors.badgeFontColor),this.props.isParentHovered&&(c.boxSizing="border-box",c.border="1px solid",(null===(a=this.props.badgeColors)||void 0===a?void 0:a.badgeHoverColor)?c.backgroundColor=this.props.badgeColors.badgeHoverColor:c.backgroundColor=(0,m.Vz)().getThemeData().AccentHover||"white",(null===(i=this.props.badgeColors)||void 0===i?void 0:i.badgeFontHoverColor)?c.color=this.props.badgeColors.badgeFontHoverColor:c.color="#106EBE"),l.createElement("div",{className:(0,L.A)(S.unseenitems,this.props.badgeStyles)},l.createElement("span",{style:c,className:o},s,this.props.children))}return null}}var C=n(36604),b=n(68063),T=n(93814),I=n(7102),D=n(25793);let v={notificationsEnabled:!1,toastsMuted:!1,bellHeaderButtonInLayout:!0,isSubscriptionReady:!1,systemNotificationsDisabled:!0,notifications:[]};n(84862);let w={timestamp:null,appsUpdateTimeSpan:null,appDataCache:null,moreAppDataAvailable:null,doNotCallGetAllAppsUntil:null};const O={isChatAPIInitialized:null,isChatRecentsPaneInitialized:!1,isChatAPIPreAuthCompleted:!1,unreadBadgeValue:0,chatEnabled:!1,chatWebLink:null,webChatSDKUrl:null,isTeamsChatActivated:!1,isTeamsChatAuthFailed:!1,chatButtonRenderedCallback:null,isConsumerShell:!1};let A={activeButtonId:"",customFlexPanes:{},customFlexPaneHash:void 0,customHeaderButtonFlexPaneTriggers:{},customHeaderButtons:[],badgeValues:{},badgeColors:{},badgeLabels:{},badgeCharacters:{},customFlexpaneWidth:void 0};n(82366),n(6062);var x=n(92667);n(31418);function k(e,t,n=0){let a=-1;for(let i=n;i<e.length;i++)if(t(e[i])){a=i;break}return a}var L=n(22461),R=n(90241),P=n(87894),E=n(33680),N=n(94361);function U(e,t,n=","){return e=e?e.toLowerCase().trim():"",(t?t.toLowerCase().split(n):[]).some((t=>t.trim()===e))}var F=n(50286),M=n(94190)},87894:function(e,t,n){"use strict";function a(e,t){if(null===e)throw new Error(`Error: ${t} is null.`)}function i(e,t){if(void 0===e)throw new Error(`Error: ${t} is undefined.`)}function r(e,t){a(e,t),i(e,t)}function s(e,t){if(r(e,t),0===e.length)throw new Error(`Error: ${t} is an empty string.`)}function o(e,t){if(r(e,t),0===e.length)throw new Error(`Error: ${t} is a null or empty array.`)}n.r(t),n.d(t,{throwOnNull:function(){return a},throwOnNullOrEmpty:function(){return s},throwOnNullOrEmptyArray:function(){return o},throwOnNullOrUndefined:function(){return r},throwOnUndefined:function(){return i}})},20748:function(e,t,n){"use strict";n.d(t,{f:function(){return i}});var a=n(16968);function i(){return new Promise(((e,t)=>{(0,a.NP)().subscribe("SuiteAPILoaded",(n=>{let a=n.WebShellStorage.createWebShellStorageRequest();a.requestClearAll(),n.WebShellStorage.removeSessionStorage(a).then(e).catch(t)}),!0)}))}},44966:function(e,t,n){"use strict";n.d(t,{Tu:function(){return l},mf:function(){return r},nq:function(){return o},u0:function(){return s},zd:function(){return i}});var a=n(16968);const i="OPX",r="https://outlook.office.com",s=[r,"https://to-do.office.com","https://outlook-sdf.office.com"];function o(e){return{themeDarker:e.Darker,themeDark:e.Dark,themeDarkAlt:e.DarkAlt,themePrimary:e.Primary,themeSecondary:e.Secondary,themeTertiary:e.Tertiary,themeLight:e.Light,themeLighter:e.Lighter,themeLighterAlt:e.LighterAlt}}function l(){const e="hiddenOpxContainer";let t=document.getElementById(e);if(!t){let n=(0,a.GJ)();if(n){let a=document.getElementById(n.top);a&&(t=document.createElement("div"),t.id=e,t.style.display="none",a.appendChild(t))}}return t}},6936:function(e,t,n){"use strict";n.d(t,{Gj:function(){return r},I9:function(){return a},Q:function(){return i}});const a=6e4,i=60*a,r=24*i},50286:function(e,t,n){"use strict";n.d(t,{FY:function(){return s},Wq:function(){return r},wk:function(){return i}});var a=n(16968);function i(e,t,n){let a="?";return e.indexOf(a)>-1&&(a="&"),e+a+t+"="+n}function r(e){if(!e)return"";return encodeURI(e).replace(/#/g,"%23")}function s(e,t){if(null==e)return!0;if((e=(e=e.toLowerCase()).trim()).startsWith("https://")||!0===e.startsWith("http://"))return!0;{let n=e.indexOf("://"),i=null;return-1!==n&&(i=e.substring(0,n)),(0,a.tZ)().tag("Unsafe URL: "+{beforeColonUrl:i},6),!t}}},66639:function(e,t,n){"use strict";n.d(t,{k:function(){return i}});var a=n(59609);function i(e){return{type:a.l,dttProps:e}}},59609:function(e,t,n){"use strict";n.d(t,{l:function(){return a}});const a="suiteux-dtt.UPDATE_PROPS"},84107:function(e,t,n){"use strict";function a(e){return null!=e&&0!==e.length&&e.some((e=>i(e)))}function i(e){return!(null==e||r(e.Id)||r(e.Text)||r(e.Url)&&null==e.Action)}function r(e){return""===e||null==e}n.d(t,{l:function(){return i},v:function(){return a}})},64386:function(e,t,n){"use strict";var a;n.d(t,{c:function(){return a}}),function(e){e[e.SystemAlert=0]="SystemAlert",e[e.ReminderNotification=1]="ReminderNotification"}(a||(a={}))},37636:function(e,t,n){"use strict";n.r(t);var a=n(24126),i=n(16968),r=n(87948),s=n(66164);let o=!1;class l{Init(e,t,n,a,r){o||(o=!0,this.Timeout=e,this.SigninState=t,this.Controls=n,this.SessionId=a,this.DisableTrackEvents=r,(0,i.NP)().subscribe("ShellDataUpdated",c,!0))}}function c(e,t){t.PUID?(t.AuthAbtEnabled&&(o=!0,window.LoadAbtPromptJs={Download:u},n.e("abt").then(n.bind(n,58428)).then((n=>{let a=null==n?void 0:n.Environment.WorldWide;(0,r.d5)(t.Environment.toLowerCase(),"tbprod")?a=null==n?void 0:n.Environment.Trailblazer:(0,r.d5)(t.Environment.toLowerCase(),"pfprod")&&(a=null==n?void 0:n.Environment.Pathfinder),null==n||n.AbtMainOperations.initializeAbt({market:e.CultureName||"en-US",workloadName:(0,s.ic)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),environment:a,userId:t.PUID,authType:t.IsConsumerShell?null==n?void 0:n.AuthType.Msa:null==n?void 0:n.AuthType.Aad,timeout:window.O365Shell.Abt.Timeout,trackEvents:!window.O365Shell.Abt.DisableTrackEvents,enableLogging:!0,sessionId:window.O365Shell.Abt.SessionId,tenantId:t.TID,signInState:window.O365Shell.Abt.SigninState,controls:window.O365Shell.Abt.Controls,allowedCookieFailureTimes:2})}))),(0,i.NP)().unsubscribe("ShellDataUpdated",c)):(0,i.tZ)().tag("ABT_NoPUIDFound",4,null,null)}function u(e){n.e("abtprompt").then(n.t.bind(n,76958,23)).then((t=>{e&&e()}))}var d=n(90872),p=n(9028),h=n(17194),g=n(95144),m=n(22331),f=n(93814),S=n(3709),y=n(79627),C=n(7667),b=n(89682),T=n(61304),I=n(55797),D=n(65599);function v(e){return new Promise(((t,n)=>{let r=(0,g.JT)("/api/myapps/GetIcon?appDataJson={0}",encodeURIComponent(JSON.stringify({Id:e.Id,CollectorId:e.CollectorId,Properties:e.Properties})));I.F.Instance.Service.callWebClientShellServiceFunction(r,"GET",null,null).then((e=>{t(e)})).catch((e=>{a.F2.isCallsBlockedException(e)||(0,i.tZ)().exception("AppsManager_GetAppIcon_Failed",6,e),n(e)}))}))}const w="AppsPinnedData",O=["FirstParty","SharePoint","Graph","LineOfBusiness","Dynamics"];class A extends d.Component{constructor(){super(...arguments),this.lastAppsPinnedDataWriteTimestampKey=new D.Zg("User","Suite","LastAppsPinnedDataWriteTimestamp"),this.cachedAppsDataKey=new D.Zg("User","Suite","CachedAppsData")}componentDidMount(){window.O365Shell.OnSuiteAPILoaded((()=>{this.initializeInternal()}))}componentDidUpdate(e){if(this.props.appsPinnedData&&e.appsPinnedData&&this.props.appsPinnedData!==e.appsPinnedData&&(!this.props.appsPinnedData.timestamp||!e.appsPinnedData.timestamp||this.props.appsPinnedData.timestamp>=e.appsPinnedData.timestamp)){this.hasAppsPinnedDataChanged(e.appsPinnedData)&&this.saveCustomization()}}render(){return null}initializeInternal(){const{appsPinnedData:e}=this.props;this.props.disableSessionStorageCache?this.updateAppsFromStorage():null!=e?Date.now()-this.props.timestamp<6e4?this.readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync().then((t=>{t&&e.timestamp<t?this.readAppsPinnedData(1):this.updateApps(e,!0)})).catch((()=>{this.readAppsPinnedData(3)})):this.readAppsPinnedData(2):this.readAppsPinnedData(0);const t=(0,i.NP)();t.subscribe("AppIconRequested",(e=>{v(e).then((t=>{this.props.onSetImageDataUrl(e.CollectorId,e.Id,`data:${t.MimeType};base64,${t.Base64EncodedImage}`)})).catch((()=>{}))})),t.subscribe("AppDataDetailsRequested",(e=>{e.Id===b.Rh?this.props.onSetAppDataDetails({CollectorId:"none",Details:T.D.M365AppTileDetails,EulaUrl:null,HomepageUrl:null,PrivacyUrl:null,SupportUrl:null,Publisher:null,Permissions:null,Id:b.Rh}):this.getAppDataDetailsAsync(e).then((t=>{t.CollectorId=e.CollectorId,this.props.onSetAppDataDetails(t)})).catch((()=>{}))}),!0),t.subscribe("AppsReset",(()=>{this.props.onSetAppsPinnedData({apps:[]})})),t.subscribe("AppsUpdate",(()=>{this.updateAppsFromCollectors()}))}readAppsPinnedData(e){this.readAppsPinnedDataFromStorageAsync().then((e=>{this.updateApps(e,!0)})).catch((()=>{this.updateApps(this.props.appsPinnedData,!1),(0,i.tZ)().tag("AppsManager_ReadAppsPinnedDataFromStorageReason",1,e)}))}updateApps(e,t){e&&e!==this.props.appsPinnedData&&void 0!==e.apps&&this.props.onSetAppsPinnedData(e),t&&this.props.onEnableCustomization(),this.readCachedAppsFromSessionStorageAsync().then((e=>{if(e){if(Date.now()-e.timestamp>this.props.appsUpdateTimeSpan||e.cultureName!==this.props.cultureName)this.updateAppsFromStorage();else{let t=!0;this.props.appDataCache&&!this.props.moreAppDataAvailable&&this.props.timestamp>=e.timestamp&&(t=!1),t&&this.updateMyApps(e.apps,1)}}else this.updateAppsFromStorage()})).catch((()=>{this.updateAppsFromStorage()}))}updateAppsFromStorage(){this.props.appDataCache&&!this.props.moreAppDataAvailable?this.updateAppsFromCollectors():this.readAppDataCacheFromStorageAsync().then((e=>{this.onReadAppDataCacheSucceeded(e)})).catch((()=>{this.updateAppsFromCollectors()}))}onReadAppDataCacheSucceeded(e){const t={};for(const n of O){const a=e[n];if(a&&a.Apps)t[n]=a.Apps;else{const e=this.props.appsData.filter((e=>e.CollectorId===n));e.length>0&&(t[n]=e)}}this.onAppDataDictionaryFetched(t,2),this.updateAppsFromCollectors()}updateAppsFromCollectors(){this.props.doNotCallGetAllAppsUntil&&this.props.doNotCallGetAllAppsUntil>Date.now()||this.getAllAppsFromCollectorsAsync().then((e=>{this.onGetAllAppsSucceeded(e)})).catch((()=>{this.invokeAppsUpdatedEvent(null,0,3)}))}onGetAllAppsSucceeded(e){if(0!==Object.keys(e).length){for(const t of O){if(!e[t]){const n=this.props.appsData.filter((e=>e.CollectorId===t));n.length>0&&(e[t]=n)}}this.onAppDataDictionaryFetched(e,3)}}onAppDataDictionaryFetched(e,t){e.FirstParty&&(e.FirstParty=this.getFirstPartyAppsFromAppsData(this.props.appsData,e.FirstParty)),this.updateMyApps(e,t),this.writeCachedAppsToSessionStorageAsync({timestamp:Date.now(),apps:e,cultureName:this.props.cultureName}).catch((()=>{}))}getFirstPartyAppsFromAppsData(e,t){const n=[];for(const a of e.filter((e=>"FirstParty"===e.CollectorId))){const e=(0,y.J0)(t,"FirstParty",a.Id);null!=e&&(a.AlternateNames=e.AlternateNames,a.DateInstalled=e.DateInstalled),n.push(a)}if(!n.some((e=>"Partner"===e.Id))){const e=(0,y.J0)(t,"FirstParty","Partner");null!=e&&n.push(e)}return n}updateMyApps(e,t){const n=this.aggregateAppDatas(e);this.props.onSetAppsData(n,t)}invokeAppsUpdatedEvent(e,t,n){const a={Apps:e,DataSource:t,FailureReason:n},r=null!=e?"AppsRetrievalSucceeded":"AppsRetrievalFailed";(0,i.NP)().invoke(r,a)}hasAppsPinnedDataChanged(e){if(void 0===this.props.appsPinnedData.apps)return!1;const t=this.props.appsPinnedData.apps,n=e.apps;if(t.length!==n.length)return!0;for(let e=0;e<t.length;e++)if(t[e].CollectorId!==n[e].CollectorId||t[e].Id!==n[e].Id)return!0;return!1}saveCustomization(){const e=this.props.appsPinnedData.apps.map((e=>e.Id));(0,i.tZ)().tag("AppsManager_SavingAppsCustomizationData",1,e.join());const t=Date.now();if("number"==typeof t)this.props.appsPinnedData.timestamp=t,this.props.appsPinnedData.cultureName=this.props.cultureName,this.writeAppsPinnedDataToStorageAsync(this.props.appsPinnedData).then((()=>{this.writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync(this.props.appsPinnedData.timestamp).catch((()=>{}))})).catch((()=>{}));else{let e=null;try{e=Date.now.toString()}catch(e){}(0,i.tZ)().tag("AppsManager_InvalidDateNowFunction",6,t,e)}}aggregateAppDatas(e){const t=[];for(const n of Object.keys(e))e[n]&&t.push(...e[n]);return t}readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync(){return new Promise(((e,t)=>{const n=I.F.Instance.WebShellStorage.createWebShellStorageRequest();n.requestRead(this.lastAppsPinnedDataWriteTimestampKey),I.F.Instance.WebShellStorage.readSessionStorage(n).then((t=>{t.hasValue(this.lastAppsPinnedDataWriteTimestampKey)?e(t.getValue(this.lastAppsPinnedDataWriteTimestampKey)):e(null)})).catch((e=>{(0,i.tZ)().exception("AppsManager_ReadLastAppsPinnedDataWriteTimestamp_Failed",6,e),t(e)}))}))}writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync(e){return new Promise(((t,n)=>{const a=I.F.Instance.WebShellStorage.createWebShellStorageRequest();a.requestWrite(e,this.lastAppsPinnedDataWriteTimestampKey),I.F.Instance.WebShellStorage.writeSessionStorage(a).then((()=>{t(void 0)})).catch((e=>{(0,S.genericServiceRejection)("AppsManager_WriteLastAppsPinnedDataWriteTimestamp_Failed",6,e,n)}))}))}readAppsPinnedDataFromStorageAsync(){return new Promise(((e,t)=>{I.F.Instance.WebShellStorage.readStorage(D.ir.User,D.bQ.SystemMetadata,w).then((t=>{const n=t.value;n&&"string"==typeof n.timestamp&&(n.timestamp=(0,C._)(n.timestamp).getTime()),e(n)})).catch((e=>{(0,S.genericServiceRejection)("AppsManager_ReadPinnedAppsData_Failed",6,e,t)}))}))}writeAppsPinnedDataToStorageAsync(e){if(e&&e.apps){const t=e.apps.length;e.apps=(0,y.Wb)(e.apps),t>e.apps.length&&(0,i.tZ)().tag("AppsManager_WriteAppsPinnedData_Deduped",4,t,e.apps.length)}return new Promise(((t,n)=>{I.F.Instance.WebShellStorage.writeStorage(D.ir.User,D.bQ.SystemMetadata,w,e).then((()=>{t(void 0)})).catch((e=>{(0,S.isCallsBlockedException)(e)||(0,i.tZ)().exception("AppsManager_WriteAppsPinnedData_Failed",6,e),n(e)}))}))}readAppDataCacheFromStorageAsync(){return new Promise(((e,t)=>{const n=(0,r.JT)("/api/myapps/GetAppDataCache?hasMailboxInCloud={0}&culture={1}",this.props.hasMailboxInCloud.toString(),this.props.cultureName);I.F.Instance.Service.callWebClientShellServiceFunction(n,"GET",null,null).then((t=>{e(t)})).catch((e=>{(0,S.isCallsBlockedException)(e)||(0,i.tZ)().exception("AppsManager_ReadAppDataCacheFromWCSS_Failed",6,e),t(e)}))}))}getAllAppsFromCollectorsAsync(){return new Promise(((e,t)=>{const n=(0,r.JT)("/api/myapps/GetAllApps?culture={0}",this.props.cultureName);I.F.Instance.Service.callWebClientShellServiceFunction(n,"GET",null,null).then((t=>{e(t)})).catch((e=>{(0,S.isCallsBlockedException)(e)||(0,i.tZ)().exception("AppsManager_AppCollectorFetch_Failed",6,e),t(e)}))}))}readCachedAppsFromSessionStorageAsync(){return new Promise(((e,t)=>{const n=I.F.Instance.WebShellStorage.createWebShellStorageRequest();n.requestRead(this.cachedAppsDataKey),I.F.Instance.WebShellStorage.readSessionStorage(n).then((t=>{t.hasValue(this.cachedAppsDataKey)?e(t.getValue(this.cachedAppsDataKey)):e(void 0)})).catch((e=>{(0,S.isCallsBlockedException)(e)||(0,i.tZ)().exception("AppsManager_ReadCacheAppsData_Failed",6,e,e.errorCode),t(e)}))}))}writeCachedAppsToSessionStorageAsync(e){return new Promise(((t,n)=>{const a=I.F.Instance.WebShellStorage.createWebShellStorageRequest();a.requestWrite(e,this.cachedAppsDataKey),I.F.Instance.WebShellStorage.writeSessionStorage(a).then((()=>{t(void 0)})).catch((e=>{(0,S.genericServiceRejection)("AppsManager_WriteCacheAppsData_Failed",6,e,n)}))}))}getAppDataDetailsAsync(e){return new Promise(((t,n)=>{const a=(0,r.JT)("/api/myapps/GetAppDetails?culture={0}",this.props.cultureName),s={CollectorId:e.CollectorId,Id:e.Id,Title:e.Title,Properties:e.Properties};I.F.Instance.Service.callWebClientShellServiceFunction(a,"POST",null,s).then((e=>{t(e)})).catch((e=>{(0,S.isCallsBlockedException)(e)||(0,i.tZ)().exception("Apps_FetchDetailsForCollector_Failed",6,e),n(e)}))}))}}const x=(0,h.connect)((e=>({appsData:e.appsDataState.apps,appsPinnedData:e.appLauncherState.appsPinnedData,cultureName:e.userState.cultureName,timestamp:e.appsManagerState.timestamp,appsUpdateTimeSpan:e.appsManagerState.appsUpdateTimeSpan,hasMailboxInCloud:e.userState.hasMailboxInCloud,appDataCache:e.appsManagerState.appDataCache,moreAppDataAvailable:e.appsManagerState.moreAppDataAvailable,doNotCallGetAllAppsUntil:e.appsManagerState.doNotCallGetAllAppsUntil,disableSessionStorageCache:(0,s.bi)(e.shellInitDataState.clientData.WorkloadId,e.shellInitDataState.navBarData.CurrentMainLinkElementID)})),(e=>({onSetAppsData:(t,n)=>{e((0,f.Zd)(t,n))},onSetAppsPinnedData:t=>{e((0,m.J8)(t))},onEnableCustomization:()=>{e((0,m.J9)())},onSetImageDataUrl:(t,n,a)=>{e((0,f.Rm)(t,n,a))},onSetAppDataDetails:t=>{e((0,m.ic)(t))}})))(A);function k(e,t){return t?Object.assign(Object.assign({},e),{appsUpdateTimeSpan:t.AppsUpdateTimeSpan,timestamp:t.Timestamp,appDataCache:t.AppDataCache,moreAppDataAvailable:t.MoreAppDataAvailable,doNotCallGetAllAppsUntil:t.DoNotCallGetAllAppsUntil}):e}let L={appsManagerState:function(e,t){if(!e){let n=t.shellInitData.shellInitDataState;e=k(g.Rz,n.clientData)}if(t.type===g.l5){return k(e,t.shellClientData)}return e}};var R=n(26335),P=n(54888);let E=(0,g.OU)();class N{constructor(){this.callbackPairings=[]}IsCustomizationEnabled(){return E.getState().appLauncherState.isCustomizable}IsPinned(e,t){return null!=P.Ro(E.getState().appLauncherState.pinnedAppTiles,e,t)}Pin(e,t){let n;"string"==typeof e?n=y.J0(E.getState().appsDataState.apps,e,t):((0,i.tZ)().tag("AppLauncher_PinnedCalledWithAppData",1),n=y.J0(E.getState().appsDataState.apps,e.CollectorId,e.Id)),n&&E.dispatch((0,R.L4)(n))}Unpin(e,t){E.dispatch((0,R.Ud)(e,t))}Reset(){(0,i.NP)().invoke("AppsReset")}Update(){(0,i.NP)().invoke("AppsUpdate")}OnAppsUpdated(e){let t=t=>{e(this.deepCloneAppsUpdatedEventArgs(t))},n=(0,i.NP)(),a=n.subscribe("AppsRetrievalSucceeded",t,!0),r=n.subscribe("AppsRetrievalFailed",t,!0);return this.callbackPairings.push({successCallbackToken:a,failureCallbackToken:r}),a}RemoveOnAppsUpdated(e){let t=0,n=(0,i.NP)();for(let a of this.callbackPairings){if(a.successCallbackToken===e){n.unsubscribe("AppsRetrievalSucceeded",a.successCallbackToken),n.unsubscribe("AppsRetrievalFailed",a.failureCallbackToken);break}t++}t<this.callbackPairings.length&&this.callbackPairings.splice(t,1)}GetAuthenticatedAppIcon(e,t){null==e.FontIconCss&&null==e.IconAnonymousUrl?v(e).then(t).catch((()=>{t(null)})):t(null)}deepCloneAppsUpdatedEventArgs(e){let t=JSON.parse(JSON.stringify(e));if(t.Apps)for(let e of t.Apps)"FirstParty"===e.CollectorId&&(e.Id=y.w(e.Id,"add"));return t}}function U(e,t){if(e.IsAuthenticated&&t.Timestamp>0){(0,i.NP)().unsubscribe("ShellDataUpdated",U);let e=(0,g.OU)();p.render(d.createElement(h.Provider,{store:e},d.createElement(x,null)),document.createElement("div"))}}var F=n(99542),M=n(89959),q=n(50003),B=n(29081);function H(e,t,n){return Object.assign(Object.assign({},e),{webChatSDKUrl:t.WebChatSDKUrl||null,chatWebLink:t.ChatWebLink||null,chatEnabled:!!t.ChatEnabled&&!g.B3.isMobileClient(),isConsumerShell:t.IsConsumerShell,chatButtonRenderedCallback:n.chatButtonRenderedCallback})}const W={chatState:function(e,t){if(!e){const n=t.shellInitData.shellInitDataState;e=H(g.P3,n.clientData||{},n.renderSettings||{})}switch(t.type){case g.l5:const n=t;return H(e,n.shellClientData,n.renderSettings);case g.ui:return function(e,t){const n=t;e.isConsumerShell&&(0,q.Cg)(n.isRecentsOpen,e.isTeamsChatActivated);return Object.assign(Object.assign({},e),{isChatRecentsPaneOpen:n.isRecentsOpen})}(e,t);case B.wW:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isChatRecentsPaneInitialized:n.isRecentsInitialized})}(e,t);case B.I2:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isChatAPIInitialized:n.isChatAPIInitialized})}(e,t);case B.q4:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{unreadBadgeValue:n.unreadBadgeValue})}(e,t);case B.$6:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isTeamsChatActivated:n.isTeamsChatActivated})}(e,t);case B.ij:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{initChatOnFirstClick:n.initChatOnFirstClick})}(e,t);case B.Kx:return function(e,t){return Object.assign(Object.assign({},e),{isTeamsChatAuthFailed:!0})}(e);case B.FQ:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isChatAPIPreAuthCompleted:n.isChatAPIPreAuthCompleted})}(e,t);default:return e}}};let Z=!1;function j(e,t){if(t.ChatEnabled&&!Z){Z=!0;let e=(0,g.OU)(),t=(0,i.GJ)()&&(0,i.GJ)().layout;if(t)t.centerCustomizationRegion&&(0,g.mD)("ChatIcon",t.centerCustomizationRegion.children)&&n.e("chat").then(n.bind(n,3924)).then((e=>{const t=e.ChatHeaderButtonConnector;(0,i.NP)().invoke("LazyComponentLoaded",M.Y,t),e.initializeChatComponent()}));else{let t=document.getElementById(F.dK);t&&n.e("chat").then(n.bind(n,3924)).then((n=>{n.initializeChatComponent();const a=n.ChatIconConnector;p.render(d.createElement(h.Provider,{store:e},d.createElement(a,null)),t)}))}}}var _=n(66639),G=n(28569);const z="LazyDocumentTitleComponentName";(0,G.E)(z);let V=!1;class J{SetProps(e){(V?Promise.resolve():n.e("dtt").then(n.bind(n,59030)).then((e=>{V=!0,(0,i.NP)().invoke("LazyComponentLoaded",z,e.DocumentTitleConnector)}))).then((()=>(0,g.OU)().dispatch((0,_.k)(e))))}}var K=n(28370),Q=n(70238),X=n(56668);class Y extends K.qs{constructor(e){super(e),this.preventEscPropagation=e=>{27===e.keyCode&&e.stopPropagation()},this.state={isShyHeaderActive:!1},(0,i.NP)().subscribe("ShyHeaderActivated",(e=>{this.setState({isShyHeaderActive:e})}),!0)}onComponentVisible(){super.onComponentVisible(),(0,i.tZ)().impression("CustomFlexPane","FlexPane",0,void 0,"Loaded"),this.props.onFlexPaneOpen&&this.props.onFlexPaneOpen(),this.customRenderContainer&&this.props.render&&this.props.render(this.customRenderContainer)}onComponentHide(){super.onComponentHide(),this.props.onFlexPaneClose&&this.props.onFlexPaneClose()}componentWillUnmount(){this.customRenderContainer&&p.unmountComponentAtNode(this.customRenderContainer),super.componentWillUnmount()}render(){return d.createElement(K.eb,{isActive:this.props.isActive,title:this.props.flexPaneTitle(),customTitle:this.props.customTitle,flexPaneProviderID:this.props.flexPaneProviderID,className:this.props.className},d.createElement("div",{id:`CustomFlexPane_${this.props.flexPaneProviderID}`,role:"region",className:(0,g.AH)(X.flexPaneContentContainer,X.flexPaneContentContainerForThinHeader,{[X.flexPaneContentContainerForShyHeader]:this.state.isShyHeaderActive}),onKeyDown:this.props.customEscapeKeyHandling&&this.preventEscPropagation,ref:e=>this.customRenderContainer=e}))}}const $=(0,h.connect)(((e,t)=>{let n=e.extensibilityState.customFlexPanes[t.flexPaneProviderID];return n?Object.assign(Object.assign({},t),{className:n.containerClassName,flexPaneTitle:()=>"function"==typeof n.flexPaneTitle?n.flexPaneTitle():n.flexPaneTitle,customTitle:n.customTitle,render:n.render,customEscapeKeyHandling:n.customEscapeKeyHandling,onFlexPaneOpen:n.onFlexPaneOpen,onFlexPaneClose:n.onFlexPaneClose,triggerControlID:n.triggerControlID}):((0,i.tZ)().tag("UnrecognizedCustomFlexPane",6,t.flexPaneProviderID),null)}))(Y);var ee=n(47275),te=n(72270),ne=n.n(te),ae=n(57530),ie=n(97380),re=n.n(ie);function se(e){return!!e&&"iconFontName"in e}const oe="ShellFabricMDL2IconsLite,ShellFabricMDL2Icons";class le extends d.Component{constructor(e){super(e),this.setClickableElement=e=>{this.headerButtonElement=e},this.onClick=e=>{this.props.isStateless&&this.props.onShow&&this.props.onShow(e.currentTarget.getBoundingClientRect()),this.props.onClick&&this.props.onClick(e)},this.state={isHovered:!1}}componentDidUpdate(e,t){this.props.isActive&&!e.isActive&&null!=this.headerButtonElement?this.props.onShow&&this.props.onShow(this.headerButtonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide&&this.props.onHide()}getArialLabel(){var e,t;const n="function"==typeof this.props.ariaLabel?this.props.ariaLabel():this.props.ariaLabel;if(void 0!==this.props.badgeValue&&0!==this.props.badgeValue){if(!this.props.badgeLabel||this.props.badgeLabel.includes("{1}"))return(0,g.JT)(null!==(e=this.props.badgeLabel)&&void 0!==e?e:T.D.UnreadBadge_Count,`${n}`,`${this.props.badgeValue}`);if(null===(t=this.props.badgeLabel)||void 0===t?void 0:t.includes("{0}"))return(0,g.JT)(this.props.badgeLabel,`${this.props.badgeValue}`)}return n}render(){const e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:this.getArialLabel(),affordanceMenuItemText:"function"==typeof this.props.affordanceMenuItemText?this.props.affordanceMenuItemText():this.props.affordanceMenuItemText,iconData:this.props.iconData?se(this.props.iconData)?{iconFontName:this.props.iconData.iconFontName,iconFontFamily:this.props.iconData.iconFontFamily||oe,iconFontSize:ae.LV.toString()}:this.props.iconData:{iconFontName:this.props.iconFontName,iconFontFamily:this.props.iconFontFamily||oe,iconFontSize:ae.LV.toString()},isActive:this.props.isActive,isDarkModeEnabled:!!this.props.isDarkMode,onClick:this.onClick,onHoverStateChanged:e=>{this.setState({isHovered:e})},onDimensionsChanged:this.props.controlDimensionsChanged,setClickableElement:this.setClickableElement,buttonText:this.props.buttonText,responsiveStep:this.props.responsiveStep,hideButton:this.props.hideButton,isNoninteractive:this.props.isNoninteractive,badgeLabel:this.props.badgeLabel};return 0===this.props.renderContext?d.createElement(ee.hp,Object.assign({},e),d.createElement(g.xw,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:re().headerButtonBadgePosition,badgeColors:this.props.badgeColors,badgeCharacter:this.props.badgeCharacter,isDarkMode:!!this.props.isDarkMode})):d.createElement(ee.vO,Object.assign({},e),d.createElement(g.xw,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:ne().affordanceContextMenuItemBadgePosition,badgeColors:this.props.badgeColors,badgeCharacter:this.props.badgeCharacter,isDarkMode:!!this.props.isDarkMode}))}}const ce=(0,h.connect)(((e,t)=>Object.assign(Object.assign({},t),{badgeValue:e.extensibilityState.badgeValues[t.id],badgeColors:e.extensibilityState.badgeColors[t.id],isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId,flexPaneProviderID:e.extensibilityState.customHeaderButtonFlexPaneTriggers[t.id],badgeLabel:e.extensibilityState.badgeLabels[t.id],isDarkMode:e.themeState.IsDarkMode,badgeCharacter:e.extensibilityState.badgeCharacters[t.id]})),((e,t)=>({onClickDispatch:(n,a)=>{a.stopPropagation(),t.onClick&&t.onClick(a),t.isStateless||e((0,g.ad)(a.currentTarget&&a.currentTarget.id)),n&&e((0,K.IZ)(n))}})),((e,t)=>Object.assign(Object.assign(Object.assign({},e),t),{onClick:n=>{t.onClickDispatch(e.flexPaneProviderID,n)}})))(le);var ue=n(7102),de=n(6806);const pe="suiteux-extensibility.SET_BADGE_VALUE",he="suiteux-extensibility.SET_BADGE_COLOR",ge="suiteux-extensibility.SET_BADGE_LABEL",me="suiteux-extensibility.SET_BADGE_CHARACTER";function fe(e,t,n,a){let i=Object.assign({},e);t&&t.flexPaneCollection&&t.flexPaneCollection.forEach((e=>{let t=e;t.render&&(i.customFlexPanes[t.flexPaneID]=t)})),n&&(i.customFlexPanes[n.flexPaneID]=n),a&&(i.customFlexpaneWidth=a);let r=Object.keys(i.customFlexPanes).sort();return i.customFlexPaneHash=(0,g.YZ)(JSON.stringify(r)),i}let Se={extensibilityState:function(e,t){if(!e){let n=t.shellInitData.shellInitDataState;e=fe(g.Jg,n.layout)}switch(t.type){case g.QR:return function(e,t){let n=t.buttonId;e.activeButtonId===n&&(n="");return Object.assign(Object.assign({},e),{activeButtonId:n})}(e,t);case g.zM:return fe(e,t.shellLayout);case"suiteux-extensibility.UPDATE_CUSTOMHEADERBUTTON":return function(e,t){let n=Object.assign({},e);for(let a=0;a<t.buttonData.length;a++){const i=t.buttonData[a];let r=(0,g.K$)(e.customHeaderButtons,(e=>e.id===i.id));r>=0?n.customHeaderButtons=[...e.customHeaderButtons.slice(0,r),i,...e.customHeaderButtons.slice(r+1)]:(n.customHeaderButtons=[...e.customHeaderButtons],n.customHeaderButtons.unshift(i))}return n}(e,t);case ue.j4:let n=t;return fe(e,null,n.customFlexpane,n.customFlexpaneWidth);case ue.GY:return function(e,t){let n=Object.assign({},e);delete n.customFlexPanes[t];let a=Object.keys(n.customFlexPanes).sort();return n.customFlexPaneHash=(0,g.YZ)(JSON.stringify(a)),n}(e,t.customFlexpaneID);case de.vG:return function(e,t){let n=e;t.newProvider.shellControlID&&e.customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]!==t.newProvider.key&&(n=Object.assign(Object.assign({},e),{customHeaderButtonFlexPaneTriggers:Object.assign({},e.customHeaderButtonFlexPaneTriggers)}),n.customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]=t.newProvider.key);return n}(e,t);case pe:return function(e,t){let n=e;e.badgeValues[t.buttonID]!==t.badgeValue&&(n=Object.assign(Object.assign({},e),{badgeValues:Object.assign({},e.badgeValues)}),n.badgeValues[t.buttonID]=t.badgeValue);return n}(e,t);case ge:return function(e,t){let n=Object.assign({},e);e.badgeLabels[t.buttonID]!==t.badgeLabel&&(n.badgeLabels[t.buttonID]=t.badgeLabel);return n}(e,t);case he:return function(e,t){let n=e;e.badgeColors[t.buttonID]!==t.badgeColors&&(n=Object.assign(Object.assign({},e),{badgeColors:Object.assign({},e.badgeColors)}),n.badgeColors[t.buttonID]=t.badgeColors);return n}(e,t);case me:return function(e,t){let n=e;e.badgeCharacters[t.buttonID]!==t.badgeCharacter&&(n=Object.assign(Object.assign({},e),{badgeCharacters:Object.assign({},e.badgeCharacters)}),n.badgeCharacters[t.buttonID]=t.badgeCharacter);return n}(e,t);default:return e}}};var ye=n(95422),Ce=n(40141),be=n(10806),Te=n(57386);class Ie extends d.Component{constructor(e){super(e),this.onEntryPointClick=()=>{this.props.isStateless?this.props.onShow(this.buttonElement.getBoundingClientRect()):this.props.onToggleButtonState(this.props.id)}}componentDidUpdate(e,t){this.props.isActive&&!e.isActive&&this.buttonElement?this.props.onShow(this.buttonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide()}render(){let e=(0,Ce.e)(),t=(0,g.AH)(this.props.isNoninteractive?re().nonInteractiveButton:re().button,Te.customHeaderButton,this.props.isNoninteractive?e.nonInteractiveButton:e.headerButton,{[e.activeHeaderButton]:this.props.isActive});const{iconData:n}=this.props;return this.props.isNoninteractive?d.createElement(be.e,{controlID:this.props.id,isActive:this.props.isActive,controlElement:this.buttonElement},d.createElement("div",{className:Te.customHeaderButtonWrapper},d.createElement("span",{className:(0,g.AH)(t),role:"presentation",id:`CustomHeader_${this.props.id}`,ref:e=>this.buttonElement=e,onClick:null,"aria-label":this.props.ariaLabel,style:se(n)?{fontFamily:n.iconFontFamily}:void 0,title:this.props.ariaLabel,"aria-expanded":this.props.isActive},se(n)?d.createElement(g.rP,{fontSize:"16",fontValue:n.iconFontName}):n.element))):d.createElement(be.e,{controlID:this.props.id,isActive:this.props.isActive,controlElement:this.buttonElement},d.createElement("div",{className:Te.customHeaderButtonWrapper},d.createElement("button",{className:(0,g.AH)(t),type:"button",role:"button",id:`CustomHeader_${this.props.id}`,ref:e=>this.buttonElement=e,onClick:this.onEntryPointClick,"aria-label":this.props.ariaLabel,style:se(n)?{fontFamily:n.iconFontFamily}:void 0,title:this.props.ariaLabel,"aria-expanded":this.props.isActive},se(n)?d.createElement(g.rP,{fontSize:"16",fontValue:n.iconFontName}):n.element)))}}const De=(0,h.connect)(((e,t)=>Object.assign(Object.assign({},t),{isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId})),(e=>({onToggleButtonState:t=>{e((0,g.ad)(t))}})))(Ie);let ve=[];let we=(0,g.OU)();class Oe{AddOrUpdateCustomHeaderButton(...e){for(let t=0;t<e.length;t++){const n=e[t];(0,i.tZ)().tag("AddOrUpdateCustomHeaderButton",1,n.id,n.iconData?se(n.iconData)?n.iconData.iconFontName:"SVG element":n.iconFontName)}!function(...e){const t=(0,g.OU)();for(let t=0;t<e.length;t++){const n=e[t];if("object"!=typeof n||Array.isArray(n))continue;const a=(0,g.K$)(ve,(e=>e.id===n.id));a>=0?ve=[...ve.slice(0,a),n,...ve.slice(a+1)]:ve.push(n)}if(t.getState().shellInitDataState.layout){let e=(0,i.YF)();e.DefaultLayoutState.CustomHeaderButtons=ve,(0,i.NP)().invoke("ShellLayoutUpdated",e.GetDefaultLayout())}else{const e=[...ve].reverse().map((e=>{var t;return d.createElement(De,{key:e.id,id:e.id,iconData:null!==(t=e.iconData)&&void 0!==t?t:{iconFontName:e.iconFontName,iconFontFamily:e.iconFontFamily},onHide:e.onHide,onShow:e.onShow,isStateless:e.isStateless,ariaLabel:"function"==typeof e.ariaLabel?e.ariaLabel():e.ariaLabel})})),n=document.getElementById("O365_CustomHeaderButtonsContainer");n.style.height="48px",p.render(d.createElement(h.Provider,{store:t},d.createElement("div",{className:Te.customHeaderButtonsContainer},e)),n)}}(...e)}AddOrUpdateCustomFlexpane(e,t){let n=(0,g.OU)();n.dispatch((0,ye.Ig)(e.flexPaneID)),null!=n.getState().extensibilityState.customFlexPanes[e.flexPaneID]&&n.dispatch((0,f.rv)(e.flexPaneID)),n.dispatch((0,f.mA)(e,t))}UpdateButtonState(e,t){const n=(0,g.OU)(),a=n.getState().extensibilityState;a.activeButtonId!==e||t?a.activeButtonId!==e&&t&&n.dispatch((0,g.ad)(e)):n.dispatch((0,g.ad)(""))}SetCustomHeaderButtonBadgeValue(e,t){we.dispatch(function(e,t){return{type:pe,buttonID:e,badgeValue:t}}(e,t))}SetCustomHeaderButtonBadgeColor(e,t){we.dispatch(function(e,t){return{type:he,buttonID:e,badgeColors:t}}(e,t))}SetCustomHeaderButtonBadgeLabel(e,t){we.dispatch({type:ge,buttonID:e,badgeLabel:t})}SetCustomHeaderButtonBadgeCharacter(e,t){we.dispatch(function(e,t){return{type:me,buttonID:e,badgeCharacter:t}}(e,t))}}var Ae=n(53512),xe=n(71936);class ke extends d.Component{render(){let e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:T.D.FeatureFlags_Title,affordanceMenuItemText:T.D.FeatureFlags_Title,iconID:"FeatureFlagsLogo",iconFontSize:ae.LV.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?d.createElement(ee.hp,Object.assign({},e)):d.createElement(ee.vO,Object.assign({},e))}}const Le=(0,h.connect)(((e,t)=>({id:t&&t.id,isAvailable:!0,isActive:e.flexPaneState&&"FeatureFlags"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged})),(e=>({onClick:(t,n)=>{t.stopPropagation(),n.onClick&&n.onClick(t),e((0,g.ad)(t.currentTarget&&t.currentTarget.id)),e((0,K.IZ)("FeatureFlags"))}})),((e,t,n)=>{let a=Object.assign(Object.assign({},n),e);return Object.assign(Object.assign(Object.assign({},a),t),{onClick:e=>t.onClick(e,a),onDimensionsChanged:()=>t.onDimensionsChanged(a)})}))(ke),Re="suiteux-mecontrol.UPDATE_WORKLOAD_FEATURE_FLAG_LIST";let Pe={featureFlagsState:function(e,t){return e||(e={enabled:!1,workloadFeatureFlagList:{}}),t.type===Re?function(e,t){let n=t;return Object.assign(Object.assign({},e),{workloadFeatureFlagList:n.workloadFeatureFlagList})}(e,t):e}};class Ee{AddFeatureFlags(e){e?(0,g.OU)().dispatch(function(e){return{type:Re,workloadFeatureFlagList:e}}(e)):(0,i.tZ)().tag("FeatureFlags_Shim_FeatureFlags_Param_Invalid",6)}SubscribeToFeatureFlagStatusChange(e){return(0,i.NP)().subscribe("FeatureFlagChanged",e,!1)}}function Ne(e,t){if(t.FeatureFlagsEnabled){const e=(0,Ae._)((()=>n.e("featureflags").then(n.bind(n,72848)).then((e=>e.FeatureFlagsFlexPanePanelConnector))));let t=(0,i.GJ)().layout,a={component:e,key:"FeatureFlags",width:K.xk};if(t){(0,i.NP)().invoke("LazyComponentLoaded",xe.p,Le),a.nativeControlID="FeatureFlags"}else a.btnId=F.DP;(0,g.OU)().dispatch((0,K.ZM)(a))}}var Ue=n(47710);let Fe=!1;function Me(e,t){if(!Fe&&t&&t.FootprintTelemetryEnabled){if(Fe=!0,!g.B3.isMobileClient()&&!(0,g.x_)(t.WorkloadId,t.FootprintWorkloadExcludeList)){let a="https://r4.res.office365.com/footprint/v3.2/scripts/fp-min.js";window.O365ShellContext.TrustedResources.add(a),(n=a,new Promise(((e,t)=>{let a=encodeURI(n),i=document.createElement("script");i.src=window.O365ShellContext.TrustedTypesPolicies[Ue.TR].createScriptURL(a),i.type="text/javascript",i.crossOrigin="anonymous",i.onerror=e=>{t({ResourceName:n,Details:e.message})},i.onload=()=>{e(null)},document.body.appendChild(i)}))).then((()=>{var n;let a="";const o=(0,s.ic)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),l="gallatin",c=(0,r.d5)((null===(n=t.Environment)||void 0===n?void 0:n.toLowerCase())||"",l)?l:"";t.IsConsumerShell?a="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa":t.TID&&(a=t.TID);try{const e=[`config.fp.measure.office.com/conf/v2/o365se${c}/fpconfig.min.json`,"r4.res.office365.com/footprint/v3.2/scripts/fpconfig.json"];Footprint.start("O365se"+c,e,1e4,JSON.stringify([{TenantId:a,AppId:o}]))}catch(e){(0,i.tZ)().tag("Footprint_StartFailed",6,e||"")}})).catch((e=>{(0,i.tZ)().tag("Footprint_LoadFailed",4,e.ResourceName,e.Details)}))}(0,i.NP)().unsubscribe("ShellDataUpdated",Me)}var n}var qe=n(20748);let Be,He;class We{UpdateAccount(e,t,n){if(window.MastInteraction)try{window.MastInteraction.UpdateAccount(e,t,n)}catch(e){(0,i.tZ)().exception("MAST_UpdateAccount_Failed",6,e)}}SetActiveAccount(e){if(window.MastInteraction)try{window.MastInteraction.SetActiveAccount(e)}catch(e){(0,i.tZ)().exception("MAST_SetActiveAccount_Failed",6,e)}}UpdateMastConfiguration(e){if(window.MastInteraction)try{window.MastInteraction.UpdateConfiguration(e)}catch(e){(0,i.tZ)().exception("MAST_UpdateConfiguration_Failed",6,e)}}Init(){(0,i.NP)().subscribe("ShellDataUpdated",Ze,!0)}}function Ze(e,t){var a;let r=(0,i.GJ)();if(!t.DisableAccountSwitchingGlobally&&t.AccountSwitchingEnabled&&r.shellAuthProviderConfig){Be=null===(a=null==e?void 0:e.SignOutLink)||void 0===a?void 0:a.Url;let s,o=r.shellAuthProviderConfig.login_Hint,l={authenticatedState:1,upn:o||t.UPN,idp:t.IsConsumerShell?"msa":"aad"},c={isMSAAccount:t.IsConsumerShell,puid:t.PUID,upn:t.UPN},u=Je(t.AppHeaderLinkText);void 0===u.postAccountSwitchRedirectUri&&(s={modifySwitchAccountRedirectUriFunction:Ge}),void 0===u.postLogoutRedirectUri&&(s=Object.assign(Object.assign({},s),{modifySignoutRedirectUriFunction:ze})),s=Object.assign(Object.assign({},s),{afterSwitchAccountPromptCallbackFunction:je,afterSignOutPromptCallbackFunction:_e}),window.LoadMastPromptJs={Download:Ve},n.e("mast").then(n.bind(n,39384)).then((n=>{new n.MultiAccountSessionTracker(u,s),He.UpdateAccount(t.PUID,l,!0),window.addEventListener("message",Ke.bind(self,c,e.SignOutLink),!1),(0,i.NP)().subscribe("AppNameChanged",Qe,!0)})).catch((e=>(0,i.tZ)().exception("MASTPackage_DownLoad_Failed",6,e))),(0,i.NP)().unsubscribe("ShellDataUpdated",Ze)}}function je(){(0,i.tZ)().click("SwitchPopup","Mast"),(0,qe.f)().catch((e=>{(0,i.tZ)().exception("MAST_Switch_ClearSessionStorage_Failed",6,e)}))}function _e(){(0,i.tZ)().click("SignOutPopup","Mast"),(0,qe.f)().catch((e=>{(0,i.tZ)().exception("MAST_Signout_ClearSessionStorage_Failed",6,e)}))}function Ge(e,t,n){let a=(0,i.GJ)().shellAuthProviderConfig;if(a&&a.appSwitchToUrl&&"function"==typeof a.appSwitchToUrl){let n={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0},nextAccount:{type:"msa"===t.idp?"msa":"aad",login_hint:t.upn,memberName:t.upn,authenticatedState:"signedIn",cid:void 0}};return a.appSwitchToUrl(n)}return n||void 0}function ze(e,t){let n=(0,i.GJ)().shellAuthProviderConfig;if(n&&"function"==typeof n.appSignOutUrl){let t={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0}};return n.appSignOutUrl(t)}}function Ve(e){n.e("mastprompt").then(n.t.bind(n,30258,23)).then((()=>{e&&e()})).catch((e=>(0,i.tZ)().exception("MASTPromptPackage_DownLoad_Failed",6,e)))}function Je(e){let t,n=(0,i.GJ)(),a=!0,r=n.shellAuthProviderConfig,s=r.appSwitchToUrl||r.appSignInUrl;s&&"string"==typeof s?t=s:a=!1;let o=r.appSignOutUrl;return{appFriendlyName:e,enablePageRedirect:!0,postLogoutRedirectUri:o&&"string"==typeof o?o:Be,postAccountSwitchRedirectUri:t,mastPromptLocalizedStrings:{appFriendlyName:e,switchAccountTitle:T.D.SwitchAccountTitle,switchAccountDescriptionWithUpn:T.D.SwitchAccountDescriptionWithUpn,switchAccountDescriptionWithoutUpn:T.D.SwitchAccountDescriptionWithoutUpn,switchAccountSubDescription:"",switchAccountButtonText:T.D.SwitchAccountButtonText,signOutTitle:T.D.SignOutTitle,signOutDescriptionWithUpn:T.D.SignOutDescriptionWithUpn,signOutDescriptionWithoutUpn:T.D.SignOutDescriptionWithoutUpn,signOutSubDescription:"",signOutButtonText:T.D.SignOutButtonText},appendLoginHint:a,enableConsoleLogging:!1,enableAutomaticPopup:!n.shellDataOverrides.DisableMASTPopup}}function Ke(e,t,n){var a,r,s,o;if("SwitchAccountRedirect"===(null===(a=null==n?void 0:n.data)||void 0===a?void 0:a.request))(null===(r=null==n?void 0:n.data)||void 0===r?void 0:r.url)?((0,i.tZ)().click("Switch","Mast"),window.removeEventListener("message",Ke.bind(n,e,t),!1),(0,i.NP)().invoke("AccountSwitchInitiated",e)):(0,i.tZ)().tag("MAST_MissingSwitchUrl",4);else if("SignOutBackToLanding"===(null===(s=null==n?void 0:n.data)||void 0===s?void 0:s.request))if(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.url){(0,i.tZ)().click("SignOut","Mast"),window.removeEventListener("message",Ke.bind(n,e,t),!1),null!=t.Action&&t.Action();let a={triggerEvent:n};(0,i.NP)().invoke("SignOut",a)}else(0,i.tZ)().tag("MAST_MissingSignOutUrl",4)}function Qe(e){let t=Je(e);He.UpdateMastConfiguration(t)}var Xe=n(92667),Ye=n(94361),$e=n(8428),et=n(98052),tt=n(85348),nt=n(83496);class at extends d.Component{componentDidMount(){this.props.isAvailable&&(0,i.tZ)().perfMarker("MyDayTimeToInteractive")}render(){let e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:T.D.MyDay,affordanceMenuItemText:T.D.MyDay,iconID:"EventToDoLogo",iconFontSize:ae.LV.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?d.createElement(nt.h,Object.assign({},e)):d.createElement(tt.v,Object.assign({},e))}}const it=(0,h.connect)(((e,t)=>{var n;return{isAvailable:e.shellInitDataState.clientData.OpxEnabled&&e.shellInitDataState.clientData.MyDayOpxEnabled,id:null==t?void 0:t.id,isActive:"MyDay"===(null===(n=e.flexPaneState)||void 0===n?void 0:n.activeProviderKey),controlDimensionsChanged:t.controlDimensionsChanged}}),(e=>({onClick:(t,n)=>{var a;t.stopPropagation(),(0,i.tZ)().click("MyDay","NavBar",null,null,`Active state: ${n.isActive}, Render context: ${n.renderContext}`),e((0,g.ad)(null===(a=t.currentTarget)||void 0===a?void 0:a.id)),e((0,ye.IZ)("MyDay")),n.onClick&&n.onClick(t)}})),((e,t,n)=>{let a=Object.assign(Object.assign({},n),e);return Object.assign(Object.assign(Object.assign({},a),t),{onClick:e=>t.onClick(e,a),onDimensionsChanged:()=>t.onDimensionsChanged(a)})}))(at);function rt(e,t){if(t.OpxEnabled&&t.MyDayOpxEnabled&&!(0,s.bi)(t.WorkloadId,e.CurrentMainLinkElementID)){(0,i.NP)().unsubscribe("ShellDataUpdated",rt);const e=()=>n.e("myday").then(n.bind(n,74386));let t={component:(0,Ae._)((()=>e().then((e=>e.MyDayFlexPaneConnector)))),key:"MyDay",width:$e.x};(0,i.NP)().invoke("LazyComponentLoaded",et.q,it),t.nativeControlID="MyDay",(0,Xe.O)().dispatch((0,ye.ZM)(t))}}var st=n(36558);class ot extends d.Component{componentDidMount(){this.props.isAvailable&&(0,i.tZ)().perfMarker("HelpTimeToInteractive")}render(){let e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:T.D.Help_Title,affordanceMenuItemText:T.D.Help,iconID:this.props.flipHelpIcon?"HelpMirrored":"Help",iconFontSize:ae.LV.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?d.createElement(ee.hp,Object.assign({},e)):d.createElement(ee.vO,Object.assign({},e))}}const lt=(0,h.connect)(((e,t)=>{var n,a;return{isAvailable:!(null===(a=null===(n=e.shellInitDataState)||void 0===n?void 0:n.clientData)||void 0===a?void 0:a.HelpPaneDisabled),id:t&&t.id,isActive:e.flexPaneState&&"Help"===e.flexPaneState.activeProviderKey,flipHelpIcon:e.headerState&&e.headerState.flipHelpIcon,controlDimensionsChanged:t.controlDimensionsChanged}}),(e=>({onClick:(t,n)=>{t.stopPropagation(),(0,i.tZ)().click("Help","NavBar",null,null,`Active state: ${n.isActive}, Render context: ${n.renderContext}`),e((0,g.ad)(t&&t.currentTarget&&t.currentTarget.id));let a=(0,i.GJ)();!a||null!=a.OnHelpButtonClick&&a.OnHelpButtonClick()||e((0,K.IZ)("Help")),n.onClick&&n.onClick(t)}})),((e,t,n)=>{let a=Object.assign(Object.assign({},n),e);return Object.assign(Object.assign(Object.assign({},a),t),{onClick:e=>t.onClick(e,a),onDimensionsChanged:()=>t.onDimensionsChanged(a)})}))(ot);let ct=null;function ut(e,t){let n;n=t.EnableVNextFeedback?(0,Ae._)((()=>ct().then((e=>e.FeedbackButtonPanelConnector)))):(0,Ae._)((()=>ct().then((e=>e.FeedbackFlexPaneConnector)))),(0,g.OU)().dispatch((0,K.ZM)({component:n,key:"Feedback",width:K.xk}))}n(64386);let dt;var pt=n(58059);function ht(e,t){const a=()=>n.e("otellogging").then(n.bind(n,90476));t.AriaTelemetryEnabled&&(!t.IsConsumerShell&&t.PUID?(0,pt.n)(t)&&t.TID&&a().then((n=>{n.initializeLogging(e,t),(0,i.NP)().unsubscribe("ShellDataUpdated",ht)})):a().then((n=>{n.initializeLogging(e,t),(0,i.NP)().unsubscribe("ShellDataUpdated",ht)})))}var gt=n(21226);class mt extends d.Component{componentDidMount(){this.props.isAvailable&&(0,i.tZ)().perfMarker("SettingsTimeToInteractive")}render(){let e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:T.D.Settings,affordanceMenuItemText:T.D.Settings,iconID:"Settings",iconFontSize:ae.LV.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?d.createElement(ee.hp,Object.assign({},e)):d.createElement(ee.vO,Object.assign({},e))}}var ft=n(92720);const St=(0,h.connect)(((e,t)=>{let n=!1;if(e.shellInitDataState.layout)if(e.shellInitDataState.clientData.SettingsPaneEnabled){n=(0,ft.S)(Object.assign(Object.assign({},e.shellInitDataState.clientData),{CurrentMainLinkElementID:e.shellInitDataState.navBarData.CurrentMainLinkElementID}),null,e.settingsFlexPaneState.workloadSettingLinks).length>0}else n=!1;return{isAvailable:n,id:t&&t.id,isActive:e.flexPaneState&&"Settings"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged}}),(e=>({onClick:(t,n)=>{t.stopPropagation(),(0,i.tZ)().click("Settings","NavBar",null,null,`Active state: ${n.isActive}, Render context: ${n.renderContext}`),n.onClick&&n.onClick(t),e((0,g.ad)(t.currentTarget&&t.currentTarget.id)),e((0,K.IZ)("Settings"))}})),((e,t,n)=>{let a=Object.assign(Object.assign({},n),e);return Object.assign(Object.assign(Object.assign({},a),t),{onClick:e=>t.onClick(e,a),onDimensionsChanged:()=>t.onDimensionsChanged(a)})}))(mt);var yt=n(84107),Ct=n(5795),bt=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,Tt=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,It=/[^-+\dA-Z]/g;function Dt(e,t,n,a){if(1!==arguments.length||"string"!=typeof e||/\d/.test(e)||(t=e,e=void 0),(e=e||0===e?e:new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var i=(t=String(vt[t]||t||vt.default)).slice(0,4);"UTC:"!==i&&"GMT:"!==i||(t=t.slice(4),n=!0,"GMT:"===i&&(a=!0));var r=function(){return n?"getUTC":"get"},s=function(){return e[r()+"Date"]()},o=function(){return e[r()+"Day"]()},l=function(){return e[r()+"Month"]()},c=function(){return e[r()+"FullYear"]()},u=function(){return e[r()+"Hours"]()},d=function(){return e[r()+"Minutes"]()},p=function(){return e[r()+"Seconds"]()},h=function(){return e[r()+"Milliseconds"]()},g=function(){return n?0:e.getTimezoneOffset()},m=function(){return xt(e)},f={d:function(){return s()},dd:function(){return Ot(s())},ddd:function(){return wt.dayNames[o()]},DDD:function(){return At({y:c(),m:l(),d:s(),_:r(),dayName:wt.dayNames[o()],short:!0})},dddd:function(){return wt.dayNames[o()+7]},DDDD:function(){return At({y:c(),m:l(),d:s(),_:r(),dayName:wt.dayNames[o()+7]})},m:function(){return l()+1},mm:function(){return Ot(l()+1)},mmm:function(){return wt.monthNames[l()]},mmmm:function(){return wt.monthNames[l()+12]},yy:function(){return String(c()).slice(2)},yyyy:function(){return Ot(c(),4)},h:function(){return u()%12||12},hh:function(){return Ot(u()%12||12)},H:function(){return u()},HH:function(){return Ot(u())},M:function(){return d()},MM:function(){return Ot(d())},s:function(){return p()},ss:function(){return Ot(p())},l:function(){return Ot(h(),3)},L:function(){return Ot(Math.floor(h()/10))},t:function(){return u()<12?wt.timeNames[0]:wt.timeNames[1]},tt:function(){return u()<12?wt.timeNames[2]:wt.timeNames[3]},T:function(){return u()<12?wt.timeNames[4]:wt.timeNames[5]},TT:function(){return u()<12?wt.timeNames[6]:wt.timeNames[7]},Z:function(){return a?"GMT":n?"UTC":Lt(e)},o:function(){return(g()>0?"-":"+")+Ot(100*Math.floor(Math.abs(g())/60)+Math.abs(g())%60,4)},p:function(){return(g()>0?"-":"+")+Ot(Math.floor(Math.abs(g())/60),2)+":"+Ot(Math.floor(Math.abs(g())%60),2)},S:function(){return["th","st","nd","rd"][s()%10>3?0:(s()%100-s()%10!=10)*s()%10]},W:function(){return m()},WW:function(){return Ot(m())},N:function(){return kt(e)}};return t.replace(bt,(function(e){return e in f?f[e]():e.slice(1,e.length-1)}))}var vt={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},wt={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},Ot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(e).padStart(t,"0")},At=function(e){var t=e.y,n=e.m,a=e.d,i=e._,r=e.dayName,s=e.short,o=void 0!==s&&s,l=new Date,c=new Date;c.setDate(c[i+"Date"]()-1);var u=new Date;u.setDate(u[i+"Date"]()+1);return l[i+"FullYear"]()===t&&l[i+"Month"]()===n&&l[i+"Date"]()===a?o?"Tdy":"Today":c[i+"FullYear"]()===t&&c[i+"Month"]()===n&&c[i+"Date"]()===a?o?"Ysd":"Yesterday":u[i+"FullYear"]()===t&&u[i+"Month"]()===n&&u[i+"Date"]()===a?o?"Tmw":"Tomorrow":r},xt=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var a=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-a);var i=(t-n)/6048e5;return 1+Math.floor(i)},kt=function(e){var t=e.getDay();return 0===t&&(t=7),t},Lt=function(e){return(String(e).match(Tt)||[""]).pop().replace(It,"").replace(/GMT\+0000/g,"UTC")},Rt=n(87894),Pt=n(6936);const Et="UTC",Nt="tzone://Microsoft/Utc";class Ut{constructor(){this.timeZones=null,this.timeZoneOffsets=[]}get isInitialized(){return null!=this.timeZones&&this.timeZoneOffsets.length>0}initializeTimeZoneConverter(e){this.timeZoneOffsets=e,this.timeZones={}}convert(e,t,n){if(null===this.timeZones)throw Error("LoadTimeZoneOffsets must be called before convert.");if(e===Nt&&(e=Et),t===Nt&&(t=Et),null==n||e===t)return n;let a=Bt.parseISO8601DateTime(n),i=0;e===Et?(i=this.findOffsetInUTC(t,a),a=a.addMinutes(i)):t===Et?(i=this.findOffsetInLocal(e,a),a=a.addMinutes(0-i)):(i=this.findOffsetInLocal(e,a),a=a.addMinutes(0-i),i=this.findOffsetInUTC(t,a),a=a.addMinutes(i));let r=-1===n.indexOf(".")?Bt.generateISO8601DateTimeString(a):Bt.generateISO8601DateTimeMsString(a);if(t===Et)r+="Z";else{let e=Math.abs(i),t=Math.floor(e/60),n=e%60;r+=(i<0?"-":"+")+(t<10?"0"+t:t.toString())+":"+(n<10?"0"+n:n.toString())}return r}findOffsetInLocal(e,t){let n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(let e of n)if(t.compare(e.localStart)>=0&&t.compare(e.localEnd)<0)return e.offset;throw new Error("Could not find an offset for this time stamp")}findOffsetInUTC(e,t){let n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(let e of n)if(t.compare(e.utcStart)>=0&&t.compare(e.utcEnd)<0)return e.offset;throw new Error("Could not find an offset for this time stamp")}ConvertDateTimeMembersTimeZone(e,t,n,a,i,r){throw new Error("Unimplemented.")}getTimeZoneRanges(e){let t=this.timeZones[e];return null==t&&(this.loadOffsetsForTimezone(e),t=this.timeZones[e]),t}loadOffsetsForTimezone(e){let t;for(let n of this.timeZoneOffsets)if(e===n.TimeZoneId){t=n.OffsetRanges;break}if(!t||0===t.length)return void(0,i.tZ)().tag("TimeZoneConverter_NoIncomingOffsetRanges",6,e);let n=t.map((e=>({utcStart:Bt.parseISO8601DateTime(e.UtcTime),offset:e.Offset})));n.forEach(((e,t)=>{if(0===t?(e.utcStart=Bt.MinValue,e.localStart=Bt.MinValue):e.localStart=e.utcStart.addMinutes(e.offset),t+1===n.length)e.utcEnd=Bt.MaxValue,e.localEnd=Bt.MaxValue;else{let a=n[t+1];e.utcEnd=a.utcStart,e.localEnd=e.utcEnd.addMinutes(Math.max(e.offset,a.offset))}})),this.timeZones[e]=n}}const Ft={TimeFormat:"hh:mm tt",DateFormat:"MM/dd/yyyy",TimeZone:"Pacific Standard Time",UserCulture:"default",WeekStartDay:0,FirstWeekOfYear:0,get TimeZoneOffsets(){return[{TimeZoneId:this.TimeZone,OffsetRanges:[{UtcTime:"1970-01-01T00:00:00Z",Offset:-180}]}]}};class Mt{constructor(e){let t=e.UserOptions||{},n=t.MailboxTimeZoneOffset;this.timeFormat=t.TimeFormat||Ft.TimeFormat,this.dateFormat=t.DateFormat||Ft.DateFormat,this.timeZone=t.TimeZone||Ft.TimeZone,this.userCulture=null!=e.SessionSettings?e.SessionSettings.UserCulture:Ft.UserCulture,this.weekStartDay=null!=t.WeekStartDay?t.WeekStartDay:Ft.WeekStartDay,this.firstWeekOfYear=null!=t.FirstWeekOfYear?t.FirstWeekOfYear:Ft.FirstWeekOfYear,this.timeZoneConverter=new Ut,this.timeZoneConverter.initializeTimeZoneConverter(null!=n?n:Ft.TimeZoneOffsets)}static get Instance(){return null==Mt.instance&&(Mt.instance=new Mt({})),Mt.instance}static populate(e){Mt.instance=new Mt(e)}}const qt=864e13;class Bt{constructor(e,t,n,a=0,i=0,r=0,s=0,o=0){if(t<0||t>11||n<0||n>31||a<0||a>23||i<0||i>59||r<0||r>59||s<0||s>999)throw new Error("Date part out of range.");this.localTime=new Date(Date.UTC(e,t,n,a,i,r,s)),this.utcOffsetInMinutes=null==o?Bt.timeZoneConverter.findOffsetInLocal(Bt.timeZone,Bt.fromNativeDateTime(this.localTime)):o,Bt.throwIfDateOutOfRange(this)}get date(){return this.localTime.getUTCDate()}get month(){return this.localTime.getUTCMonth()}get year(){return this.localTime.getUTCFullYear()}get hour(){return this.localTime.getUTCHours()}get second(){return this.localTime.getUTCSeconds()}get minute(){return this.localTime.getUTCMinutes()}get millisecond(){return this.localTime.getUTCMilliseconds()}static get timeZone(){return Mt.Instance.timeZone}static get Now(){let e=Bt.timeZoneConverter.convert(Et,Bt.timeZone,Bt.generateISO8601DateTimeMsStringWithOffset(Bt.UTCNow));return Bt.parseISO8601DateTime(e)}static get timeZoneConverter(){return Mt.Instance.timeZoneConverter}static get UTCNow(){return Bt.fromNativeDateTime(new Date).toUTC()}static get now(){let e=Bt.timeZoneConverter.convert(Et,Bt.timeZone,Bt.generateISO8601DateTimeMsStringWithOffset(Bt.UTCNow));return Bt.parseISO8601DateTime(e)}static fromNativeDateTime(e){return new Bt(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds(),-e.getTimezoneOffset())}format(e){return Dt(this.localTime,Bt.getDateFormatMask(e),!0)}static parseISO8601DateTime(e=""){let t=Bt.isoRegex.exec(e);if(null==t||15!==t.length)throw new Error((0,r.JT)("Unexpected datetime format (value: {0}).",e));let n=parseInt(t[1],10),a=parseInt(t[2],10),i=parseInt(t[3],10),s=0,o=0,l=0,c=0,u=0;return null!=t[5]&&null!=t[6]&&null!=t[7]&&(s=parseInt(t[5],10),o=parseInt(t[6],10),l=parseInt(t[7],10),null!=t[9]&&(c=parseInt(t[9],10))),null!=t[10]&&"Z"!==t[10].toUpperCase()&&(u+=60*parseInt(t[13],10),u+=parseInt(t[14],10),"-"===t[12]&&(u=-u)),new Bt(n,a-1,i,s,o,l,c,u)}static generateISO8601DateTimeString(e){return Bt.generateISO8601DateTimeMsString(e,!1)}static generateISO8601DateTimeMsString(e,t=!0){const n="yyyy-MM-dd'T'HH:mm:ss"+(t?".l":"");return e.format(n)}static generateISO8601DateTimeMsStringWithOffset(e){return Bt.generateISO8601DateTimeMsString(e)+e.getUtcOffsetDisplayString()}getUtcOffsetDisplayString(){if(0===this.utcOffsetInMinutes)return"Z";const e=Math.floor(Math.abs(this.utcOffsetInMinutes)/60),t=Math.abs(this.utcOffsetInMinutes)%60,n=this.utcOffsetInMinutes<0?"-":"+";return(0,r.JT)("{0}{1}:{2}",n,Ht(e,2),Ht(t,2))}static areDatePartsEqual(e,t){return null===e&&null===t||null!==e&&null!=t&&0===e.compareDatePart(t)}compare(e){return Rt.throwOnNullOrUndefined(e,"other"),this.localTime.getTime()-e.localTime.getTime()}clone(){let e=new Bt(0,0,0,0,0,0,0,0);return e.localTime.setTime(this.localTime.getTime()),e.utcOffsetInMinutes=this.utcOffsetInMinutes,e}addMilliseconds(e){Bt.throwIfNotNumber(e);let t=this.clone();const n=t.localTime.getTime()+e;return t.localTime.setTime(n),Bt.throwIfDateOutOfRange(t),t}Subtract(e){return Rt.throwOnNullOrUndefined(e,"value"),this.localTime.getTime()-e.localTime.getTime()}addSeconds(e){return Bt.throwIfNotNumber(e),this.addMilliseconds(1e3*e)}addMinutes(e){return Bt.throwIfNotNumber(e),this.addMilliseconds(e*Pt.I9)}addHours(e){return Bt.throwIfNotNumber(e),this.addMilliseconds(e*Pt.Q)}addDays(e){return Bt.throwIfNotNumber(e),this.addMilliseconds(e*Pt.Gj)}toUTC(){if(0===this.utcOffsetInMinutes)return this;let e=this.addMinutes(-this.utcOffsetInMinutes);return e.utcOffsetInMinutes=0,e}getNativeDateTime(){return new Date(this.toUTC().getUTCMilliseconds())}getUTCMilliseconds(){return this.toUTC().localTime.getTime()}GetMilliseconds(){return this.localTime.getTime()}compareDatePart(e){return Bt.getDatePartHashValue(this)-Bt.getDatePartHashValue(e)}static throwIfNotNumber(e){if("number"!=typeof e)throw Error("Argument must be of type number, but is type "+typeof e)}static throwIfDateOutOfRange(e){if(!Bt.isValidDate(e))throw new Error("The resulting DateTime is less than MinValue or greater than MaxValue")}static isValidDate(e){return null!=e&&!isNaN(e.localTime.getTime())&&e.localTime.getTime()>=-864e13&&e.localTime.getTime()<=qt}static getDatePartHashValue(e){return e.date+(e.month<<5)+(e.year<<9)}static getDateFormatMask(e){let t=!1;return e.replace(/[mMtT']/g,(e=>{if(t)return t="'"!==e,e;switch(e){case"'":return t=!0,e;case"m":return"M";case"M":return"m";case"t":return"T";case"T":return"t";default:return e}}))}}function Ht(e,t){let n=e.toString();for(;n.length<t;)n="0"+n;return n}Bt.isoRegex=/^(\d{4})-(\d{2})-(\d{2})(T(\d{2}):(\d{2}):(\d{2})([,\.](\d{3})\d*){0,1}){0,1}(Z|(([-\+])(\d{2}):?(\d{2}))){0,1}$/,Bt.MaxValue=new Bt(275760,8,13,0,0,0,0,0),Bt.MinValue=new Bt(-271821,3,20,0,0,0,0,0);var Wt=n(67172),Zt=n(42970);function jt(e,t,n,a){return e?Object.assign(Object.assign({},e),{workloadData:n,workloadSettingLinksTitle:e.workloadSettingLinksTitle||a&&a.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:[...t.CurrentWorkloadSettingsSubLinks||[],...a&&a.workloadSettingsSubLinks||[]]}):Object.assign(Object.assign({},e),{themeCardState:{selectedThemeId:(0,i.Vz)().getCurrentThemeId(),themeData:[],preferOfficeTheme:(0,i.Vz)().getThemeState().preferOfficeTheme,fullBleedThemesEnabled:n&&n.EduThemingEnabled&&(n.ActiveExperiences||"").split(",").some((e=>"edu"===e.toLowerCase())),showMonarchColorThemes:n&&n.ShowMonarchColorThemes},languageAndRegionCardState:{selectedLanguage:"",selectedDateFormat:"",selectedTimeFormat:"",selectedTimeZone:"",languageChoices:[],timeZoneChoices:[],dateFormatChoices:[],timeFormatChoices:[],savedLanguage:"",savedDateFormat:"",savedTimeFormat:"",savedTimeZone:""},aboutCardState:{correlationID:a&&a.correlationID?a.correlationID:T.D.NotAvailable,sessionID:a&&a.sessionID?a.sessionID:T.D.NotAvailable,version:a.version?a.version:T.D.NotAvailable},workloadData:n,workloadId:n&&n.WorkloadId?n.WorkloadId:"",expandO365Settings:!1,workloadSettingLinksTitle:a&&a.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:[...t.CurrentWorkloadSettingsSubLinks||[],...a&&a.workloadSettingsSubLinks||[]],cards:[]})}function _t(e){const t=-1!==e.indexOf("HH");return new Bt(2018,8,1,t?21:9,5).format(e).replace("Sep",T.D.SeptemberAbbrev).replace("September",T.D.September)}const Gt={settingsFlexPaneState:function(e,t){if(!e){const n=t.shellInitData.shellInitDataState;e=jt(null,n.navBarData,n.clientData,n.renderSettings)}switch(t.type){case g.l5:const n=t;return jt(e,n.navBarData,n.shellClientData,n.renderSettings);case Zt.cj:return function(e,t){const n=t,a=(0,g.K$)(e.workloadSettingLinks,(e=>e.Id===n.newWorkloadSettingLink.Id));if(!(0,yt.l)(n.newWorkloadSettingLink))return e;const i=a>=0?Object.assign(Object.assign({},e),{workloadSettingLinks:[...e.workloadSettingLinks.slice(0,a),n.newWorkloadSettingLink,...e.workloadSettingLinks.slice(a+1)]}):Object.assign(Object.assign({},e),{workloadSettingLinks:e.workloadSettingLinks.concat(n.newWorkloadSettingLink)});return i}(e,t);case Zt.XL:return function(e,t){const n=t,a=(0,g.K$)(e.workloadSettingLinks,(e=>e.Id===n.settingLinkID));if(a>=0)return Object.assign(Object.assign({},e),{workloadSettingLinks:[...e.workloadSettingLinks.slice(0,a),...e.workloadSettingLinks.slice(a+1)]});return e}(e,t);case Zt.Rq:return function(e,t){const n=t,a=n.newWorkloadSettingsLinks.filter((e=>(0,yt.l)(e)));if(0===a.length)return e;return Object.assign(Object.assign({},e),{workloadSettingLinks:a})}(e,t);case Zt._f:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{cards:n.cardData})}(e,t);case g.BE:return function(e,t){const n=t,a=(0,i.Vz)().getUserPersonalizationAllowed(),r=(0,Wt.cv)(n.themeData||[],e.themeCardState.selectedThemeId,e.themeCardState.preferOfficeTheme,a);return Object.assign(Object.assign({},e),{themeCardState:Object.assign(Object.assign({},e.themeCardState),{themeData:r})})}(e,t);case g.bS:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{themeCardState:Object.assign(Object.assign({},e.themeCardState),{selectedThemeId:n.themeInfo.ThemeId||Ct.ux,preferOfficeTheme:n.themeInfo.PreferOfficeTheme})})}(e,t);case Zt.Eh:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage,savedLanguage:n.selectedLanguage})})}(e,t);case Zt.T9:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{languageChoices:n.languageChoices.map((e=>({id:e.Locale,text:e.DisplayName,language:e.Locale})))})})}(e,t);case Zt.nf:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage})})}(e,t);case Zt.wS:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedTimeZone:n.timeZoneChoice,selectedDateFormat:n.dateFormatChoice,selectedTimeFormat:n.timeFormatChoice,savedTimeZone:n.timeZoneChoice,savedDateFormat:n.dateFormatChoice,savedTimeFormat:n.timeFormatChoice})})}(e,t);case Zt.Kt:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{timeZoneChoices:n.timeZoneChoices.map((e=>({id:e.alias,text:e.displayName})))})})}(e,t);case Zt.u4:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedTimeZone:n.selectedTimeZone})})}(e,t);case Zt.uT:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{dateFormatChoices:n.dateFormatChoices.map((e=>({id:e,text:_t(e)})))})})}(e,t);case Zt.Ul:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedDateFormat:n.selectedDateFormat})})}(e,t);case Zt.jj:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{timeFormatChoices:n.timeFormatChoices.map((e=>({id:e,text:_t(e)})))})})}(e,t);case Zt.nt:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedTimeFormat:n.selectedTimeFormat})})}(e,t);case Zt.ar:return function(e){const t=e.languageAndRegionCardState;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},t),{savedLanguage:t.selectedLanguage,savedTimeZone:t.selectedTimeZone,savedDateFormat:t.selectedDateFormat,savedTimeFormat:t.selectedTimeFormat})})}(e);case Zt.Xu:return function(e){const t=e.languageAndRegionCardState;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},t),{selectedLanguage:t.savedLanguage,selectedTimeZone:t.savedTimeZone,selectedDateFormat:t.savedDateFormat,selectedTimeFormat:t.savedTimeFormat})})}(e);case Zt.dE:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{parentCardId:n.cardId})}(e,t);case Zt.oc:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{expandO365Settings:n.isExpanded})}(e,t);default:return e}}};var zt=n(33106);class Vt{AddOrUpdateWorkloadSettingLink(e){(0,g.OU)().dispatch((0,zt.Xm)(e))}RemoveWorkloadSettingLink(e){(0,g.OU)().dispatch((0,zt.G4)(e))}SetWorkloadSettingsLinks(e){(0,g.OU)().dispatch((0,zt.S)(e))}}function Jt(e,t){let n=(0,i.GJ)().layout;const a=(0,g.OU)().getState().settingsFlexPaneState.workloadSettingLinks;if(!n){let n=t.SettingsPaneEnabled&&(0,ft.S)(Object.assign(Object.assign({},t),{CurrentMainLinkElementID:e.CurrentMainLinkElementID}),null,a).length>0,i=document.getElementById(F.Xf);i&&n&&(i.style.display="block")}}var Kt=n(49152),Qt=n(18435);function Xt(){(0,i.NP)().invoke("FlexPane400ZoomActivated",(0,Kt.g)())}var Yt=n(71173),$t=n(49715);const en="O365_ShyHeader",tn=2e3;let nn,an,rn,sn,on,ln,cn,un,dn,pn,hn,gn,mn,fn;function Sn(e,t,n){nn=(0,i.NP)(),an=window.matchMedia(`(max-height: ${t}px)`),un=0,dn=0,mn=n,pn=e,window.addEventListener(Qt.B.RESIZE,yn),pn.addEventListener(Qt.B.MOUSEENTER,In),pn.addEventListener(Qt.B.MOUSELEAVE,Dn),pn.addEventListener(Qt.B.FOCUS,vn,!0),pn.addEventListener(Qt.B.BLUR,wn,!0),nn.subscribe("ContextMenuPopup",On),nn.subscribe("ShyHeaderActivated",An,!0),yn()}function yn(){xn()?(0!==un&&window.clearTimeout(un),un=window.setTimeout((()=>{xn()&&null!=pn&&null!=mn&&(fn||function(){if(null!=mn&&null!=pn){let e=(0,Ce.e)();hn=(0,ae.Ux)(`${$t.shyHeader} o365cs-base ${e.navbar}`,en),hn.setAttribute("tabindex","0"),gn=(0,ae.Ux)($t.shyHeaderOverlay);let t=(0,ae.Ux)(`${$t.shyHeaderGripper} ${e.shyHeader}`);hn.appendChild(gn),hn.appendChild(t),mn.appendChild(hn),hn.addEventListener(Qt.B.MOUSEDOWN,bn),hn.addEventListener(Qt.B.FOCUS,Tn),(0,ae.YV)(pn,$t.headerAnimations),(0,ae.YV)(mn,$t.workloadDivAnimations),fn=!0}}(),(0,ae.Lu)(pn,$t.headerSlideIn),(0,ae.Lu)(mn,$t.workloadDivSlideIn),(0,ae.YV)(pn,$t.headerSlideOut),(0,ae.YV)(mn,$t.workloadDivSlideOut),pn.onanimationend=e=>{"headerSlideOutFrames"===e.animationName&&(nn.invoke("ShyHeaderActivated",!0),rn=!0)})}),tn)):an.matches&&!cn||Cn()}function Cn(e){rn&&null!=hn&&null!=pn&&null!=mn&&(hn.style.visibility="hidden",hn.style.display="none",gn.style.visibility="hidden",gn.style.display="none",pn.style.display="flex",(0,ae.Lu)(pn,$t.headerSlideOut),(0,ae.Lu)(mn,$t.workloadDivSlideOut),(0,ae.YV)(pn,$t.headerSlideIn),(0,ae.YV)(mn,$t.workloadDivSlideIn),pn.onanimationend=t=>{"headerSlideInFrames"===t.animationName&&(nn.invoke("ShyHeaderActivated",!1),rn=!1,e&&document.getElementById(Yt.ng).focus())})}function bn(e){on=!0}function Tn(e){Cn(!on),on=!1}function In(e){sn=!0}function Dn(e){sn=!1,yn()}function vn(e){ln=!0}function wn(e){ln=!1,0!==dn&&window.clearTimeout(dn),dn=window.setTimeout((()=>{ln||yn()}),50)}function On(e){cn=e,e||yn()}function An(e){e&&null!=hn&&null!=pn&&(hn.style.visibility="visible",hn.style.display="flex",gn.style.visibility="visible",gn.style.display="flex",pn.style.display="none")}function xn(){return an.matches&&!rn&&!sn&&!ln&&!cn}let kn=!1,Ln=!1;function Rn(e,t){if(!kn){let e=(0,i.GJ)();if(e&&e.supportShyHeaderMode){let t=document.getElementById(e.top);Sn(document.getElementById(F.yG),e.shyHeaderActivationHeight?e.shyHeaderActivationHeight:Kt.C,t),kn=!0}}Ln||(window.addEventListener(Qt.B.RESIZE,Xt),Ln=!0)}!function(){let e=(0,g.OU)().getState();e.userState.isConsumer||g.h5.register(L),function(){let e=new N,t=window.O365Shell.Apps;window.O365Shell.Apps=e,t.applyCalls(e)}(),e.userState.isConsumer||(0,i.NP)().subscribe("ShellDataUpdated",U,!0)}(),dt=(0,i.NP)().subscribe("ShellDataUpdated",((e,t)=>{if(t.NotificationsEnabled){(0,i.NP)().unsubscribe("ShellDataUpdated",dt);const e=()=>n.e("notifications").then(n.bind(n,12033)).catch((e=>(0,i.tZ)().exception("NotificationsPackage_LoadFail",6,e)));let t=(0,i.GJ)();t&&t.layout?t.layout.centerCustomizationRegion&&(0,Ye.mD)("NotificationBellIcon",t.layout.centerCustomizationRegion.children)&&e():e()}}),!0),function(){ct=()=>n.e("extraflexpane").then(n.bind(n,43020));let e=window.O365Shell.NFD;e.registerShimCallback&&e.registerShimCallback((()=>{ct()}),["OpenHelp","OpenFeedback"]);const t=(0,Ae._)((()=>ct().then((e=>e.HelpFlexPanePanelConnector))));let a=(0,i.GJ)(),r={component:t,key:"Help",width:K.xk,overrideOnClick:a.OnHelpButtonClick};if(a.layout){(0,i.NP)().invoke("LazyComponentLoaded",st.V,lt),r.nativeControlID="HelpIcon"}else r.btnId=F.hl;(0,g.OU)().dispatch((0,K.ZM)(r)),(0,i.NP)().subscribe("ShellDataUpdated",ut,!0)}(),(0,i.NP)().subscribe("ShellDataUpdated",ht,!0),(0,i.NP)().subscribe("ShellDataUpdated",Me,!0),function(){g.h5.register(Gt),function(){let e=new Vt,t=window.O365Shell.Settings;window.O365Shell.Settings=e,t.applyCalls(e)}();const e=(0,Ae._)((()=>n.e("extraflexpane").then(n.bind(n,17414)).then((e=>e.SettingsFlexPanePanelConnector))));(0,i.NP)().subscribe("ShellDataUpdated",Jt,!0);let t=(0,i.GJ)().layout,a={component:e,key:"Settings",width:K.xk};if(t){(0,i.NP)().invoke("LazyComponentLoaded",gt.$,St),a.nativeControlID="SettingsIcon"}else a.btnId=F.Xf;(0,g.OU)().dispatch((0,K.ZM)(a))}(),g.h5.register(W),(0,i.NP)().subscribe("ShellDataUpdated",j,!0),function(){g.h5.register(Se),function(){let e=new Oe,t=window.O365Shell.Extensibility;window.O365Shell.Extensibility=e,t.applyCalls(e)}();let e,t=(0,g.OU)();function n(){let n=t.getState();if(e!==n.extensibilityState.customFlexPaneHash){Object.keys(n.extensibilityState.customFlexPanes).forEach((e=>{if(!n.flexPaneState.registeredProviders.some((t=>t.key===e))){const a=n.extensibilityState.customFlexPanes[e],i=n.extensibilityState.customFlexpaneWidth?n.extensibilityState.customFlexpaneWidth:K.xk;t.dispatch((0,K.ZM)({component:$,btnId:a.triggerControlID,shellControlID:a.triggerControlID,key:e,width:i}))}}))}e=n.extensibilityState.customFlexPaneHash}n(),(0,i.NP)().invoke("LazyComponentLoaded",Q.J,ce),t.subscribe(n)}(),(0,a.xZ)(),function(){const e=()=>n.e("diagnostics").then(n.bind(n,90406));let t=window.O365Shell.Diagnostics;t.registerShimCallback&&t.registerShimCallback((()=>{e()}),["GetServiceDiagnostics","GetClientDiagnostics"]),window.O365ShellContext.DiagnosticsEnabled&&e()}(),function(){const e=new l,t=window.O365Shell.Abt;window.O365Shell.Abt=e,t.applyCalls(e);const n=(0,i.GJ)();n.abtTimeout&&window.O365Shell.Abt.Init(n.abtTimeout,n.abtSigninState,n.abtControls,n.abtSessionId,n.abtDisableTrackEvents)}(),g.h5.register(Pe),function(){let e=new Ee,t=window.O365Shell.FeatureFlags;window.O365Shell.FeatureFlags=e,t.applyCalls(e)}(),(0,i.NP)().subscribe("ShellDataUpdated",Ne,!0),(0,i.NP)().subscribe("ShellDataUpdated",Rn,!0),function(){let e=(0,i.GJ)();e&&e.layout&&e.layout.centerCustomizationRegion&&(0,Ye.mD)("MyDay",e.layout.centerCustomizationRegion.children)&&(0,i.NP)().subscribe("ShellDataUpdated",rt,!0)}(),function(){let e=new J,t=window.O365Shell.DTT;window.O365Shell.DTT=e,t&&t.applyCalls(e)}(),(0,i.GJ)().shellAuthProviderConfig&&(He=new We,He.Init()),(0,i.NP)().invoke("PlusLoaded"),(0,i.tZ)().perfMarker("shell_plus_executioncomplete")},13780:function(e,t,n){"use strict";var a;n.d(t,{c:function(){return a}}),function(e){e.Theme="theme",e.LanguageAndRegion="languageandregion",e.NavBarDataLinks="navbardatalinks",e.ChangePassword="changepassword",e.ContactPreferences="contactpreferences",e.AboutBase="aboutbase",e.About="about",e.DarkMode="darkmode",e.CPNIPin="cpnipin"}(a||(a={}))},33106:function(e,t,n){"use strict";n.d(t,{EU:function(){return f},G4:function(){return r},Gf:function(){return h},H5:function(){return b},Jy:function(){return m},M9:function(){return c},MQ:function(){return T},S:function(){return s},Xm:function(){return i},bs:function(){return y},hK:function(){return u},ii:function(){return S},l4:function(){return g},ty:function(){return o},vJ:function(){return p},vo:function(){return l},wb:function(){return C},zH:function(){return d}});var a=n(42970);function i(e){return{type:a.cj,newWorkloadSettingLink:e}}function r(e){return{type:a.XL,settingLinkID:e}}function s(e){return{type:a.Rq,newWorkloadSettingsLinks:e}}function o(e){return{type:a._f,cardData:e}}function l(e){return{type:a.Eh,selectedLanguage:e}}function c(e){return{type:a.T9,languageChoices:e}}function u(e){return{type:a.u4,selectedTimeZone:e}}function d(e,t,n){return{type:a.wS,timeZoneChoice:e,dateFormatChoice:t,timeFormatChoice:n}}function p(e){return{type:a.Kt,timeZoneChoices:e}}function h(e){return{type:a.nf,selectedLanguage:e}}function g(e){return{type:a.Ul,selectedDateFormat:e}}function m(e){return{type:a.uT,dateFormatChoices:e}}function f(e){return{type:a.nt,selectedTimeFormat:e}}function S(e){return{type:a.jj,timeFormatChoices:e}}function y(){return{type:a.ar}}function C(){return{type:a.Xu}}function b(e){return{type:a.dE,cardId:e}}function T(e){return{type:a.oc,isExpanded:e}}},42970:function(e,t,n){"use strict";n.d(t,{Eh:function(){return c},Kt:function(){return h},Rq:function(){return o},T9:function(){return u},Ul:function(){return m},XL:function(){return s},Xu:function(){return i},_f:function(){return l},ar:function(){return a},cj:function(){return r},dE:function(){return C},jj:function(){return y},nf:function(){return g},nt:function(){return S},oc:function(){return b},u4:function(){return d},uT:function(){return f},wS:function(){return p}});const a="suiteux-settings.SAVE_SELECTIONS",i="suiteux-settings.CANCEL_SELECTIONS",r="suiteux-settings.ADDORUPDATE_WORKLOADSETTINGLINK",s="suiteux-settings.REMOVE_WORKLOADSETTINGLINK",o="suiteux-settings.SET_WORKLOADSETTINGSLINKS",l="suiteux-settings.INITIALCARDS_AVAILABLE",c="suiteux-settings.LANGUAGECHOICE_AVAILABLE",u="suiteux-settings.LANGUAGECHOICES_AVAILABLE",d="suiteux-settings.SELECTEDTIMEZONE_CHANGED",p="suiteux-settings.TIMEZONEANDFORMATSCHOICE_AVAILABLE",h="suiteux-settings.TIMEZONECHOICES_AVAILABLE",g="suiteux-settings.SELECTEDLANGUAGE_CHANGED",m="suiteux-settings.SELECTEDDATEFORMAT_CHANGED",f="suiteux-settings.DATEFORMATCHOICES_AVAILABLE",S="suiteux-settings.SELECTEDTIMEFORMAT_CHANGED",y="suiteux-settings.TIMEFORMATCHOICES_AVAILABLE",C="suiteux-settings.NAVIGATE_TO_CARD",b="suiteux-settings.O365_SETTINGS_EXPANDED"},92720:function(e,t,n){"use strict";n.d(t,{S:function(){return S}});var a=n(13780);const i=[a.c.LanguageAndRegion,a.c.ChangePassword,a.c.ContactPreferences,a.c.NavBarDataLinks],r=[a.c.NavBarDataLinks,a.c.Theme,a.c.LanguageAndRegion,a.c.ChangePassword,a.c.ContactPreferences],s={default:[a.c.NavBarDataLinks,a.c.Theme,a.c.LanguageAndRegion,a.c.DarkMode,a.c.ChangePassword,a.c.ContactPreferences],iwapp:[a.c.NavBarDataLinks,a.c.Theme,a.c.LanguageAndRegion,a.c.DarkMode,a.c.ChangePassword,a.c.ContactPreferences],exchange:[],exchangeadmin:r,officepwa:[a.c.Theme,a.c.DarkMode,a.c.AboutBase,a.c.NavBarDataLinks],botdesigner:[a.c.NavBarDataLinks,a.c.Theme,a.c.ChangePassword,a.c.ContactPreferences],dynamics365:r,dynamics365ci:[a.c.NavBarDataLinks,a.c.Theme,a.c.ChangePassword,a.c.ContactPreferences],dynamics365fraudprotection:[a.c.NavBarDataLinks,a.c.Theme,a.c.ChangePassword,a.c.ContactPreferences],dynamics365powerplatform:[a.c.NavBarDataLinks,a.c.Theme,a.c.ChangePassword,a.c.ContactPreferences],dynamics365productinsights:[a.c.NavBarDataLinks,a.c.ChangePassword,a.c.ContactPreferences],adminportal:[a.c.NavBarDataLinks,a.c.Theme,a.c.LanguageAndRegion,a.c.ChangePassword,a.c.ContactPreferences],flow:[a.c.NavBarDataLinks,a.c.Theme,a.c.ChangePassword,a.c.ContactPreferences],teamsappstudio:[a.c.NavBarDataLinks,a.c.LanguageAndRegion,a.c.ChangePassword,a.c.ContactPreferences],microsoftstream:[a.c.NavBarDataLinks,a.c.LanguageAndRegion,a.c.DarkMode,a.c.ChangePassword,a.c.ContactPreferences],todo:[a.c.NavBarDataLinks,a.c.LanguageAndRegion,a.c.DarkMode,a.c.ChangePassword,a.c.ContactPreferences],microsoftclipchamp:[a.c.NavBarDataLinks,a.c.LanguageAndRegion,a.c.ChangePassword,a.c.ContactPreferences],powerappsportal:[a.c.NavBarDataLinks,a.c.Theme,a.c.ChangePassword,a.c.ContactPreferences],vivagoals:[],promptlibbie:[],vivaglint:[a.c.NavBarDataLinks,a.c.Theme,a.c.DarkMode,a.c.ChangePassword,a.c.ContactPreferences],vivalearning:[a.c.NavBarDataLinks,a.c.Theme,a.c.DarkMode],protectioncenter:r,wordonline:i,powerpointonline:i,excelonline:i,visioonline:i,onenoteonline:i,wac:i};var o=n(61304);let l={[a.c.NavBarDataLinks]:{EnableConsumer:!0},[a.c.Theme]:{Title:o.D.Themes,EnableConsumer:!0},[a.c.ChangePassword]:{Title:o.D.Password,Description:o.D.PasswordDescription,EnableConsumer:!1,ChangePasswordCardData:[{WorkloadId:"dynamics365businesscentral",QueryStringData:[{Key:"ru",Value:"https://businesscentral.dynamics.com?redirectedfromsignup=1"}]}]},[a.c.ContactPreferences]:{Title:o.D.ContactPreferences,Description:o.D.ContactPreferencesDescription,EnableConsumer:!1},[a.c.LanguageAndRegion]:{Title:o.D.LanguageAndTimeZone,Description:o.D.LanguageAndTimeZoneDescription,EnableConsumer:!1},[a.c.AboutBase]:{Title:o.D.About,EnableConsumer:!0,ChildCardIds:[a.c.About]},[a.c.About]:{Title:o.D.About,EnableConsumer:!0},[a.c.DarkMode]:{Title:o.D.DarkThemeTitle,EnableConsumer:!1},[a.c.CPNIPin]:{Title:o.D.CPNIPinCardTitle,EnableConsumer:!1}};var c=n(16968),u=n(66164),d=n(84107);function p(e){return!e.UseSimplifiedLanguageCard&&!(1&~e.UserType||(0,u.Uc)(e.WorkloadId))}function h(e){return!e.ShowContactPreferencesCard}function g(e){return!(0,d.v)(e)}function m(e){const t=(0,c.Vz)().getThemeState().disableTheming;return e.IsConsumerShell?!(e.CSSExperiencesEnabled&&e.ConsumerThemingEnabled):!!t}const f="default";function S(e,t,n){const i={[a.c.LanguageAndRegion]:p(e),[a.c.NavBarDataLinks]:g(n),[a.c.Theme]:m(e),[a.c.ContactPreferences]:h(e)};let r;r=e.CurrentMainLinkElementID&&"shellofficedotcom"===e.CurrentMainLinkElementID.toLowerCase()?"iwapp":e.CurrentMainLinkElementID&&"shellofficepwa"===e.CurrentMainLinkElementID.toLowerCase()?"officepwa":e.CurrentMainLinkElementID&&"shellstream"===e.CurrentMainLinkElementID.toLowerCase()?"microsoftstream":e.CurrentMainLinkElementID&&"clipchamp"===e.CurrentMainLinkElementID.toLowerCase()?"microsoftclipchamp":e.WorkloadId.toLowerCase();let o=null!=t?l[t].ChildCardIds:s[r]?s[r]:s[f],c=e.IsConsumerShell;return o?o.filter((t=>!e.IsGuestMode||t===a.c.NavBarDataLinks)).filter((e=>!c||l[e].EnableConsumer)).filter((e=>!i[e])).map((e=>Object.assign({Id:e},l[e]))):[]}},18440:function(e,t,n){"use strict";n.d(t,{F:function(){return M}});var a=n(24126),i=n(16968),r=n(87894),s=n(95144),o=n(30086);class l extends o.y{initializeComponent(){}getMruDocuments(e,t){return new Promise(((n,r)=>{let o=(0,s.JT)("{0}?rs={1}&show={2}&sort=date",this.SuiteApi.Configuration.MruOauthEndpointUrl,this.SuiteApi.Configuration.CultureName,e.toString());null!=t&&(o+="&apps="+t);const l={method:a.oZ.GET,resource:this.SuiteApi.Configuration.MruOauthResourceUrl,url:o};this.SuiteApi.Service.callEndpointWithOauthToken(l).then((e=>{(0,i.tZ)().perfMarker("shell_mru_fetch_complete"),n(e)})).catch((e=>{a.F2.genericServiceRejection("Documents_GetMRUDocuments_Failed",6,e,r)}))}))}prefetchMruAccessToken(){null!=this.SuiteApi.Configuration.MruOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.MruOauthEndpointUrl,this.SuiteApi.Configuration.MruOauthResourceUrl)}initializeGraphApi(){null!=this.SuiteApi.Configuration.GraphOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.GraphOauthEndpointUrl,this.SuiteApi.Configuration.GraphOauthResourceUrl)}createNewDocument(e){const t={name:e,file:{},"@microsoft.graph.conflictBehavior":"rename"},n={method:a.oZ.POST,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthEndpointUrl,headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(t)};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(n).then(e).catch((e=>{a.F2.genericServiceRejection("Documents_CreateNewDocument_Failed",4,e,t)}))}))}getDocumentUrl(e,t){let n;return new Promise(((a,i)=>{null!=e?this.createNewDocument(e).then((e=>{null!=e&&null!=e.webUrl?(n=e.webUrl.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew"),-1===n.lastIndexOf("action=editnew")&&(n=(0,s.wk)(n,"action","editnew"))):n=t,a(n)})).catch((e=>i(e))):(n=t,a(n))}))}}var c,u=n(9522),d=n(75511);!function(e){e.UpdateConfig="UpdateConfig",e.UpdateToken="UpdateToken",e.ChangeTheme="ChangeTheme",e.UpdateData="UpdateData"}(c||(c={}));var p=n(44966),h=n(62853);class g extends o.y{constructor(){super(),this.opxFrameToComponentMap={},this.opxComponentData={},this.opxTimers={},this.opxOutstandingOpxQueries={},this.currentOpxQueryID=0,this.OpxInitializationTimeout=15e3,this.handleIncomingOpxMessage=e=>{var t;let n=!1;const a=this.opxFrameToComponentMap[e.instanceId];if(null!=a)switch(e.notificationType){case d.C.LifeCycle:switch(e.asyncContext){case d.$.GetConfig:const i=null===(t=this.opxComponentData[a])||void 0===t?void 0:t.opxComponentConfiguration;null!=i&&(n=this.onGetConfigRequest(e.instanceId,i));break;case d.$.RefreshToken:n=this.onRefreshTokenRequest(e.instanceId);break;case d.$.Closed:n=this.onOpxClosedRequest(a);break;case d.$.PageReady:case d.$.FatalError:n=this.onReadyOrError(a,e)}break;case d.C.ChallengeToken:n=this.onRefreshTokenRequest(e.instanceId);break;case d.C.DataProviderResponseNotification:const i=e.asyncContext;if(i.success){const t=this.opxOutstandingOpxQueries[e.instanceId];if(t){Object.keys(t).filter((e=>t[e].queryType===i.type)).forEach((e=>{t[e].onQueryComplete(i.response)}))}}}return n},this.validateIncomingOpxMessage=e=>e.apiName===p.zd,this.validateIncomingOpxMessageOrigin=e=>e.toLowerCase()===this.SuiteApi.Configuration.TokenFactoryIframeOrigin,this.onGetConfigRequest=(e,t)=>(this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:e,message:{eventType:c.UpdateConfig,asyncResult:t}}),!0),this.onRefreshTokenRequest=e=>(this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:e,message:{eventType:c.UpdateToken,asyncResult:null}}),!0),this.onOpxClosedRequest=e=>{let t=null;if(e===h.G.MyDay)t="MyDay";return null!=t&&window.O365Shell.FlexPane.CloseFlexPaneForProvider(t),!0},this.onReadyOrError=(e,t)=>{const n=this.opxComponentData[e];if(!n)throw new Error("Message received for an OPX component that no longer exists.");if(n.initCompleteCallback&&!n.initializationResult){const e=t.asyncContext===d.$.PageReady?0:5;n.initCompleteCallback(e)}else n.messageListener&&n.messageListener(t);return!0}}initializeComponent(){this.opxHostUrl=this.SuiteApi.Configuration.OpxHostUrl,this.opxResourceUrl=this.SuiteApi.Configuration.OpxResourceUrl,this.upn=this.SuiteApi.Configuration.CurrentUserUpn,this.opxSystemConfigurationPromise=this.initializeOpxOrchestrator()}prefetchOpxAccessToken(e){this.opxSystemConfigurationPromise.then((t=>{null==this.opxSystemConfiguration&&(this.opxSystemConfiguration=t);const n=this.opxSystemConfiguration.OpxEndpoints[e];void 0!==n&&this.SuiteApi.Service.prefetchAccessToken(n.OpxOAuthResourceUrl,n.OpxOAuthResourceUrl)})).catch((e=>{(0,i.tZ)().tag("OwaPoweredExperiences_PrefetchAccessTokenFailed",1,e)}))}initializeOpx(e,t,n,a){let r=document.getElementById(t);if(!r)return Promise.resolve(2);this.prefetchOpxAccessToken(h.G.MyDay);const s=new Promise((s=>{this.opxSystemConfigurationPromise.then((o=>{null==this.opxSystemConfiguration&&(this.opxSystemConfiguration=o),this.opxFrameToComponentMap[t]=e,this.opxComponentData[e]={frameID:t,opxComponentConfiguration:n,initCompleteCallback:t=>{switch(t){case 0:case 5:this.opxComponentData[e].initializationResult=t}s(t)},messageListener:a},r.onerror=(e,t,n,a,r)=>{const o=JSON.stringify(null!=e?e:"Script error");(0,i.tZ)().exception(o,6,r,t,n,a),s(3)},r.src=this.createOpxFrameUrl(e,t)})).catch((()=>{s(1)}))}));return Promise.race([new Promise((t=>{s.then((n=>{clearTimeout(this.opxTimers[e]),t(n)}))})),new Promise((t=>{clearTimeout(this.opxTimers[e]),this.opxTimers[e]=window.setTimeout((()=>{clearTimeout(this.opxTimers[e]),t(4)}),this.OpxInitializationTimeout)}))])}changeTheme(e,t,n){const a=this.opxComponentData[e];if(0!==a.initializationResult)throw new Error("Theme cannot be changed before OPX is in the operational state.");const i=a.frameID,r={UseDarkMode:n};n?r.DarkPalette=t:r.LightPalette=t,this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:i,message:{eventType:c.ChangeTheme,asyncResult:r}})}updateData(e,t,n){const a=this.opxComponentData[e];if(!a||0!==a.initializationResult)return Promise.reject(new Error("UpdateData cannot be called before OPX is in the operational state."));const i={type:t,request:n};return this.queryOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:a.frameID,message:{eventType:c.UpdateData,asyncResult:i}})}createOpxFrameUrl(e,t){if(null==this.opxSystemConfiguration||null==this.opxSystemConfiguration.OpxRootUrlLowerCase||null==this.opxSystemConfiguration.OpxEndpoints[e]||null==this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl)throw new Error("OPX system configuration incomplete.");return`${this.opxSystemConfiguration.OpxRootUrlLowerCase}${this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl}?hostApp=o365shell&frameName=${u.TokenFactoryIFrameID}&opxInstanceId=${t}&OpxHostOrigin=${this.SuiteApi.Configuration.TokenFactoryIframeOrigin}`}initializeOpxOrchestrator(){return new Promise(((e,t)=>{this.fetchSystemConfiguration().then((n=>{this.SuiteApi.Service.registerOpxHost(this.opxResourceUrl,this.opxHostUrl,this.OpxInitializationTimeout).then((()=>{this.registerOpxMessageListener(),e(n)})).catch((e=>{(0,i.tZ)().exception("OPX_RegisterOpxHost_Failure",6,e),t(e)}))})).catch((e=>{(0,i.tZ)().exception("OPX_FetchSystemConfiguration_Failure",6,e),t(e)}))}))}fetchSystemConfiguration(){return Promise.resolve({OpxEndpoints:{MyDay:{OpxEndpointUrl:this.upn?`/opx/${this.upn}/myday`:"/opx/myday",OpxOAuthResourceUrl:this.opxResourceUrl},ExchangeData:{OpxEndpointUrl:this.upn?`/opx/${this.upn}/dataprovider`:"/opx/dataprovider",OpxOAuthResourceUrl:this.opxResourceUrl}},OpxRootUrlLowerCase:this.opxHostUrl.toLowerCase(),OpxSupported:!0})}registerOpxMessageListener(){this.SuiteApi.Service.registerPostMessageHandler({handleMessage:this.handleIncomingOpxMessage,validateMessage:this.validateIncomingOpxMessage,validateOrigin:this.validateIncomingOpxMessageOrigin})}queryOpxIframe(e,t=5e3){const n=e.message.asyncResult;return new Promise(((a,i)=>{this.SuiteApi.Service.callOpxIframe(e),null==this.opxOutstandingOpxQueries[e.targetOpxInstance]&&(this.opxOutstandingOpxQueries[e.targetOpxInstance]={});const r=this.currentOpxQueryID++,s=this.opxOutstandingOpxQueries[e.targetOpxInstance],o=setTimeout((()=>{delete s[r],i(new Error("Query timeout."))}),t);s[r]={id:r,opxFrameID:e.targetOpxInstance,queryType:n.type,onQueryComplete:e=>{clearTimeout(o),delete s[r],a(e)}}}))}}var m=n(530);function f(e){return(0,m.__assign)({__type:"JsonRequestHeaders:#Exchange"},e)}function S(e){return(0,m.__assign)({__type:"TimeZoneContext:#Exchange"},e)}var y={baseUrl:"/owa",isFeatureEnabled:function(){return!1},prefetchTaskQueue:new(function(){function e(e){void 0===e&&(e={maxParallelTasks:1,taskQuanta:0}),this.config=e,this.taskList={},this.numberOfTasksRunning=0}return e.prototype.add=function(e,t){var n=this;return void 0===t&&(t=0),this.taskList[t]||(this.taskList[t]=[]),new Promise((function(a,i){n.taskList[t].unshift({func:e,resolve:a,reject:i}),n.scheduleTask()}))},e.prototype.clear=function(){this.taskList={}},e.prototype.scheduleTask=function(){var e=this;this.config.taskQuanta<0?this.tryRunTask():setTimeout((function(){e.tryRunTask()}),this.config.taskQuanta||0)},e.prototype.tryRunTask=function(){var e=this,t=Object.keys(this.taskList);if(this.numberOfTasksRunning<(this.config.maxParallelTasks||1)&&t.length>0){var n=Math.min.apply(null,t.map((function(e){return parseInt(e)}))),a=this.taskList[n].pop();this.taskList[n]&&0!=this.taskList[n].length||delete this.taskList[n],this.numberOfTasksRunning++,a.func().then((function(t){a.resolve(t),e.onTaskComplete()})).catch((function(t){a.reject(t),e.onTaskComplete()})),this.scheduleTask()}},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e}())({taskQuanta:-1}),timeoutMS:9e4,disableAllRequests:!1},C=y;function b(e){return e||(e=C.timezone),f(e?{RequestServerVersion:"V2018_01_08",TimeZoneContext:S({TimeZoneDefinition:(t={Id:e},(0,m.__assign)({__type:"TimeZoneDefinitionType:#Exchange"},t))})}:{RequestServerVersion:"V2018_01_08"});var t}var T=n(53464);let I=n(47562),D=null;const v=a.OY.SuiteServiceApiRelativePath+"LanguageTimezone";let w=null,O=null;class A extends o.y{initializeComponent(){D=this.SuiteApi.Configuration.GraphOauthResourceUrl,null!=D&&(D=(0,s.JT)("{0}/{1}",D,"v1.0/me"),w=(0,s.JT)("{0}/{1}",D,"outlook/supportedLanguages"),O=(0,s.JT)("{0}/{1}",D,"outlook/supportedTimeZones"))}getLanguageAndTimeZone(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageAndTimeZone():this.getSuiteLanguage()}getLanguageChoices(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageChoices():this.getSuiteLanguageChoices()}getTimeZoneChoices(){return new Promise(((e,t)=>{let n={url:O,method:a.oZ.GET};this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{e(t.value)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetTimeZoneChoices_Failed",6,e,t)}))}))}getDateTimeFormats(e){return new Promise(((t,n)=>{const i={url:(0,s.JT)("{0}/api/settings/datetimeformats?cultureName={1}",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.oZ.GET,headers:T.n};this.SuiteApi.Service.callEndpointWithOauthToken(i).then(t).catch((e=>{a.F2.genericServiceRejection("Settings_GetDateTimeFormats_Failed",6,e,n)}))}))}setLanguageAndTimeZone(e){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.setOwaLanguageAndTimeZone(e):this.setSuiteLanguage(e.CurrentCultureName)}setSuiteLanguage(e){return new Promise(((t,n)=>{let i={url:D,method:a.oZ.PATCH,headers:T.w,body:JSON.stringify({preferredLanguage:e})};this.SuiteApi.Service.callEndpointWithOauthToken(i).then((e=>{t()})).catch((e=>{a.F2.genericServiceRejection("Settings_SetSuiteLanguage_Failed",6,e,n)}))}))}setOwaLanguageAndTimeZone(e){return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise(((t,n)=>{e.CurrentCultureLcid=null;let i={Language:e.CurrentCultureName,TimeZone:e.CurrentTimeZone,DateFormat:e.CurrentDateFormat,TimeFormat:e.CurrentTimeFormat},r=(s={Header:b(),Options:i},(0,m.__assign)({__type:"SetMailboxRegionalConfigurationRequest:#Exchange"},s));var s;this.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("SetMailboxRegionalConfiguration",r,null).then((n=>{this.setSuiteLanguage(e.CurrentCultureName),t()})).catch((e=>{a.F2.genericServiceRejection("Settings_SetOwsOwaLanguageAndTimeZone_Failed",6,e,n)}))})):new Promise(((t,n)=>{e.CurrentCultureLcid=null,this.SuiteApi.Service.callOwaIframeResourceUrl(v,e,a.oZ.PUT).then(t).catch((e=>{a.F2.genericServiceRejection("Settings_SetLanguageAndTimeZoneViaOwa_Failed",6,e,n)}))}))}getSuiteLanguageChoices(){return new Promise(((e,t)=>{I?e(I):t(new Error("Supported languages not found"))}))}getOwaLanguageChoices(){return new Promise(((e,t)=>{let n={url:w,method:a.oZ.GET};this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{let n=t.value.map((e=>({Locale:e.locale,DisplayName:e.displayName})));e(n)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetOwaLanguageChoices_Failed",6,e,t)}))}))}getSuiteLanguage(){return new Promise(((e,t)=>{let n={url:D,method:a.oZ.GET};this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{let n={CurrentCultureName:t.preferredLanguage};e(n)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetSuiteLanguage_Failed",6,e,t)}))}))}getOwaLanguageAndTimeZone(){return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise(((e,t)=>{let n=(i={Header:b(),VerifyDefaultFolderNameLanguage:!1},(0,m.__assign)({__type:"GetMailboxRegionalConfigurationRequest:#Exchange"},i));var i;this.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("GetMailboxRegionalConfiguration",n,null).then((t=>{let n=t.Options,a={CurrentCultureLcid:0,CurrentCultureName:n.Language,CurrentTimeZone:n.TimeZone,CurrentDateFormat:n.DateFormat,CurrentTimeFormat:n.TimeFormat};e(a)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetOwsOwaLanguageAndTimeZone_Failed",6,e,t)}))})):new Promise(((e,t)=>{this.SuiteApi.Service.callOwaIframeResourceUrl(v,null,a.oZ.GET).then((t=>{let n=t.Body.Configuration;e(n)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetOwaLanguageAndTimeZone_Failed",6,e,t)}))}))}}var x=n(88242),k=n(87948),L=n(5795);class R{constructor(e){this.userTheme=e}GetUserThemeId(){return(0,i.Vz)().getCurrentThemeId()}ChangeTheme(e){}SaveTheme(e,t){return new Promise(((n,a)=>{this.userTheme.setUserTheme(e,t).then((e=>{e.O365Success||e.OwaSuccess?n():a(new Error("SaveThemeFailure"))})).catch(a)}))}SaveDarkTheme(e){return new Promise(((t,n)=>{this.userTheme.setUserThemeSettingsInWCSS(e).then((e=>{e.O365Success||e.OwaSuccess?t():n(new Error("SaveThemeFailure"))})).catch(n)}))}GetModeLogo(e){return new Promise(((t,n)=>{this.userTheme.getModeLogo(e).then((e=>{if(e){let n="";e.HasTenantLogo&&(e.LogoUrl?n=e.LogoUrl:e.LogoData&&(n=e.LogoData));const a={isLogoVisible:!0,logoUrl:n,logoNavigationUrl:e.HomePageUrl?e.HomePageUrl:""};return t(a)}return n(new Error("GetModeLogoFailure"))})).catch(n)}))}SetUserThemesData(e){(0,s.OU)().dispatch((0,s.qd)(e))}}class P extends o.y{initializeComponent(){(0,i.Vz)().setUserThemesHandler(new R(this))}loadUserThemeChoices(){return this.checkInitialized(),(0,i.Vz)().loadAllThemeJson()}setUserTheme(e,t){this.checkInitialized(),this.clearUserThemeCache();let n,a=e=e.replace(/^\w/,(e=>e.toUpperCase()));return e.toLowerCase()===L.ux&&t&&(a=L.Fx),n=x.L((()=>this.setUserThemeInWCSS(e,e.toLowerCase()===L.ux&&t)),2),this.SuiteApi.Configuration.IsPwa?n:n.then((()=>x.L((()=>this.setUserThemeInExchange(a,!0)),2)))}setUserThemeInWCSS(e,t){return new Promise(((n,r)=>{const s={url:(0,k.JT)("{0}/api/settings/theme",this.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.oZ.PUT,headers:T.n,body:JSON.stringify({ThemeID:e,PreferOfficeTheme:t})};(0,i.tZ)().tag("SetUserThemeStart",1,"WCSS",e),this.SuiteApi.Service.callEndpointWithOauthToken(s).then((t=>{(0,i.tZ)().tag("SetUserThemeSuccess",1,"WCSS",e),n({OwaSuccess:void 0,O365Success:!0})})).catch((e=>{a.F2.genericServiceRejection("Settings_SetUserThemeInWCSS_Failed",6,e,r)}))}))}setUserThemeSettingsInWCSS(e){return new Promise(((t,n)=>{const r={url:(0,k.JT)("{0}/api/settings/darkmode",this.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.oZ.PUT,headers:T.n,body:JSON.stringify({IsDarkmode:e})};this.SuiteApi.Service.callEndpointWithOauthToken(r).then((n=>{(0,i.tZ)().tag("SetUserThemeSettingsSuccess",1,e.toString()),t({O365Success:!0})})).catch((e=>{a.F2.genericServiceRejection("Settings_SetUserThemeSettingsInWCSS_Failed",6,e,n)}))}))}getModeLogo(e){return new Promise(((t,n)=>{const i={url:(0,k.JT)(`{0}/api/theme/tenant?useDarkMode=${e}`,this.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.oZ.GET,headers:T.n};this.SuiteApi.Service.callEndpointWithOauthToken(i).then((e=>{t(e)})).catch((e=>{a.F2.genericServiceRejection("Settings_GetModeLogoFromWCSS_Failed",6,e,n)}))}))}setUserThemeInExchange(e,t){return new Promise(((n,r)=>{(0,i.Vz)().getUserThemeByID(e).then((i=>{let s;s=this.SuiteApi.Configuration.OpxEnabled&&this.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!this.SuiteApi.Configuration.IsOwa?this.setUserThemeViaOpx(e,t):this.setUserThemeViaSuiteServiceProxy(e,t,i),s.then((e=>{n({OwaSuccess:e.OwaSuccess,O365Success:e.O365Success||t})})).catch((e=>{a.F2.genericServiceRejection("Settings_SetUserThemeInExchange_Failed",6,e,r)}))}))}))}setUserThemeViaOpx(e,t){return n.e("exchangedata").then(n.bind(n,49861)).then((n=>n.setUserTheme(e,t)))}setUserThemeViaSuiteServiceProxy(e,t,n){const a={ThemeId:e,SkipO365Call:t};n&&e!==L.Fx&&(a.UserThemeJson=JSON.stringify(n));var i;const r={request:(i=a,(0,m.__assign)({__type:"SetUserThemeRequest:#Exchange"},i))};return new Promise(((e,t)=>{this.SuiteApi.User.getOwaUserConfiguration().then((t=>{let n=this.SuiteApi.Service.callOwaIframeAction("SetUserTheme",r);e(n)})).catch((e=>{t(e)}))}))}clearUserThemeCache(){this.SuiteApi.Configuration.ClearThemeCacheData&&0!==this.SuiteApi.Configuration.ClearThemeCacheData.length&&this.SuiteApi.Configuration.ClearThemeCacheData.map((e=>{if(null!=e.WorkloadUrl&&e.WorkloadUrl.length>0&&(!e.NoRequestInSameWorkload||this.SuiteApi.Configuration.WorkloadId.toLowerCase()!==e.WorkloadId.toLowerCase())&&null!=e.RequestType&&e.RequestType.length>0&&("img"===e.RequestType.toLowerCase()||"iframe"===e.RequestType.toLowerCase())){let t=document.createElement(e.RequestType);t.setAttribute("src",e.WorkloadUrl),t.setAttribute("style","display:none"),"iframe"===e.RequestType.toLowerCase()&&(t.addEventListener("load",(()=>document.body.removeChild(t))),document.body.appendChild(t))}}))}}class E extends o.y{initializeComponent(){this.userTheme=null==this.SuiteApi.Configuration.IUserThemeOverride?new P:this.SuiteApi.Configuration.IUserThemeOverride,this.languageAndTimeZone=null==this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride?new A:this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride,this.userTheme.initialize(this.SuiteApi),this.languageAndTimeZone.initialize(this.SuiteApi)}loadUserThemeChoices(){return this.userTheme.loadUserThemeChoices()}setUserTheme(e,t){return this.userTheme.setUserTheme(e,t)}getLanguageAndTimeZone(){return this.languageAndTimeZone.getLanguageAndTimeZone()}getLanguageChoices(){return this.languageAndTimeZone.getLanguageChoices()}getTimeZoneChoices(){return this.languageAndTimeZone.getTimeZoneChoices()}getDateTimeFormats(e){return this.languageAndTimeZone.getDateTimeFormats(e)}setLanguageAndTimeZone(e){return this.languageAndTimeZone.setLanguageAndTimeZone(e)}}var N=n(65599);const U="/v1.0/me/photo/$value";class F extends o.y{initializeComponent(){}get OwaUserConfig(){return this.userConfig}getOwaUserConfiguration(){null==this.userConfigPromise&&(this.SuiteApi.Configuration.OpxEnabled&&this.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!this.SuiteApi.Configuration.IsOwa?this.userConfigPromise=this.getOwaUserConfigurationViaOpx():this.userConfigPromise=this.getOwaUserConfigurationViaSuiteServiceProxy());const e=window.setTimeout((()=>(0,i.tZ)().tag("User_GetOwaUserConfiguration_MessageTimeout",6)),15e3);return this.userConfigPromise.then((()=>window.clearTimeout(e))).catch((()=>window.clearTimeout(e))),this.userConfigPromise}getOwaUserConfigurationViaOpx(){return n.e("exchangedata").then(n.bind(n,49861)).then((e=>e.getOwaUserConfig())).catch((e=>{throw(0,i.tZ)().exception("User_GetOwaUserConfigurationViaOpx_Failed",4,e),e}))}getOwaUserConfigurationViaSuiteServiceProxy(){return new Promise(((e,t)=>{let n={command:a.kN.OwaUserConfig,timeout:1e4};const r=()=>{this.SuiteApi.Service.callOwaIframeAction("GetOwaUserConfiguration",{}).then((n=>{if(this.userConfig=n,null!=this.userConfig&&""!==this.userConfig)this.onOwaUserConfigSucceeded(e);else{const e=new a.WJ("null OwaUserConfiguration received from server");(0,i.tZ)().exception("User_GetOwaUserConfiguration_NullConfig",4,e),t(e)}})).catch((e=>{a.F2.genericServiceRejection("User_GetOwaUserConfiguration_Failed",4,e,t)}))};if(this.SuiteApi.Configuration.IsOwa)r();else{n.success=t=>{this.userConfig=t.responseObject,"GetOwaUserConfiguration"===a.pf.Instance.configuration.StartupActionName&&this.SuiteApi.Service.setStartupActionCompleted(),this.onOwaUserConfigSucceeded(e)},n.error=(e,t,n)=>{(0,i.tZ)().exception("GetOwaUserConfiguration_ContextUnavailable",4,new a.WJ(n,t)),r()};let s=a.b6.OwaInstance;null==s?t(new a.WJ("OwaIframe",-1011)):s.getOwaUserConfiguration(n)}}))}getPhotoFromGraph(e){let t=(0,k.vQ)(e)?U:(0,k.JT)("/v1.0/users/{0}/photo/$value",e),n={method:a.oZ.GET,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+t,binaryStringResponseBody:!0};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{e(window.btoa(t))})).catch((n=>{404===n.errorInfo.HttpStatus?e(""):a.F2.genericServiceRejection("User_GetPhotoFromGraph_Failed",4,n,t)}))}))}prefetchGraphToken(){return new Promise(((e,t)=>{null!=this.SuiteApi.Configuration.GraphOauthResourceUrl?this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.GraphOauthResourceUrl+U,this.SuiteApi.Configuration.GraphOauthResourceUrl).then(e).catch(t):t()}))}uploadPhotoToGraph(e){let t=e.split(","),n=t[0].split(":")[1].split(";")[0],i=t[1],r={method:a.oZ.PUT,headers:{"Content-Type":n},timeout:7e3,body:window.atob(i),resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+U,binaryStringRequestBody:!0};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(r).then(e).catch((e=>{a.F2.genericServiceRejection("User_UploadPhotoToGraph_Failed",6,e,t)}))}))}onOwaUserConfigSucceeded(e){null!=this.userConfig.SessionSettings?a.pf.Instance.MailboxGuid=this.userConfig.SessionSettings.MailboxGuid:(0,i.tZ)().tag("User_GetOwaUserConfiguration_SessionSettingsNull",4),e(this.userConfig)}getOCPSUserPolicies(e,t){let n=this.SuiteApi.Configuration.OcpsOauthResourceUrl,i=e?n+"?PoliciesHash="+e:n,r={body:"",method:a.oZ.GET,headers:{Accept:"application/json","x-Cid":t},resource:i,url:this.SuiteApi.Configuration.OcpsOauthEndpointUrl};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(r,!0).then((t=>{e(t)})).catch((e=>{a.F2.genericServiceRejection("getOCPSPolicies_Failed",6,e,t)}))}))}}class M{constructor(e){this.configuration=e,this.StartupActionName="GetOwaUserConfiguration",this.validateConfiguration(e),this.owaUrlSpecialHandling(e),a.pf.Initialize(Object.assign(Object.assign({},e),{StartupActionName:this.StartupActionName})),this.service=a.kl.Instance,this.storage=null==e.IStorageOverride?new N.wc:e.IStorageOverride,this.webShellStorage=null==e.IWebShellStorageOverride?new N._H:e.IWebShellStorageOverride,this.user=null==e.IUserOverride?new F:e.IUserOverride,this.settings=null==e.ISettingsOverride?new E:e.ISettingsOverride,this.documentsModule=null==e.IDocumentsOverride?new l:e.IDocumentsOverride,this.owaPoweredExperiences=null==e.IOwaPoweredExperiencesOverride?new g:e.IOwaPoweredExperiencesOverride,this.service=a.kl.Instance,e.UserHasExchangeLicense?e.SuiteServiceCallsDisabled?this.service.blockSuiteServiceCalls(a.IY.Brs):e.IsPwa&&this.service.blockSuiteServiceCalls(a.IY.Pwa):this.service.blockSuiteServiceCalls(a.IY.NoExoLicense),this.storage.initialize(this),this.webShellStorage.initialize(this),this.user.initialize(this),this.documentsModule.initialize(this),this.settings.initialize(this),e.OpxEnabled&&this.owaPoweredExperiences.initialize(this)}get Configuration(){return this.configuration}get Service(){return this.service}get User(){return this.user}get Storage(){return this.storage}get WebShellStorage(){return this.webShellStorage}get DocumentsModule(){return this.documentsModule}get OwaPoweredExperiences(){return this.owaPoweredExperiences}get Settings(){return this.settings}static CreateInstance(e){if(null!=this.instance){const e=new Error("Instance already exists.");throw(0,i.tZ)().exception("SuiteApi_InstanceAlreadyExists",6,e),e}return this.instance=new M(e),this.instance}static isInitialized(){return null!=this.instance}static get Instance(){if(null==M.instance)throw new Error("Instance not yet created.");return M.instance}static clearInstanceForTesting(){a.pf.isUnitTestMode&&(M.instance=null,a.b6.resetAllInstancesForTesting())}validateConfiguration(e){r.throwOnNullOrUndefined(e,"configuration"),r.throwOnNullOrUndefined(e.SuiteServiceUrl,"SuiteApiConfiguration.SuiteServiceUrl")}owaUrlSpecialHandling(e){if(e.IsOwa){const t=e.SuiteServiceUrl.toLowerCase(),n=a.OY.getUrlDomainPart(t),i=a.OY.getUrlDomainPart(window.location.href).toLowerCase();n!==i&&(e.SuiteServiceUrl=t.replace(n,i))}}}},30086:function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var a=n(24126),i=n(87894);class r{constructor(){this.isInitialized=!1}get SuiteApi(){return this.suiteApi}get IsInitialized(){return this.isInitialized}initialize(e){i.throwOnNullOrUndefined(e,"suiteApi"),this.IsInitialized||(this.suiteApi=e,this.initializeComponent(),this.isInitialized=!0)}checkInitialized(){if(!this.isInitialized)throw new a.WJ("SuiteApiComponent_InvalidInitializationCheck",-2002)}}},53464:function(e,t,n){"use strict";n.d(t,{n:function(){return a},w:function(){return i}});const a={Accept:"application/json","Content-Type":"application/json; charset=utf-8"},i={Accept:"application/json","Content-Type":"application/json; charset=utf-8"}},68392:function(e,t,n){"use strict";n.d(t,{E:function(){return r},h:function(){return i}});var a=n(24126);function i(e){return new a.WJ(`Argument Exception: ${e}`,-2001)}function r(e){return new a.WJ(`Invalid Operation: ${e}`,-2002)}},55797:function(e,t,n){"use strict";n.d(t,{F:function(){return s.F}});var a=n(16968),i=n(44966),r=n(66164),s=n(18440);n(68392);function o(e,t){var n,a;let r=null!==(n=t.OpxDefaultHostUrl)&&void 0!==n?n:i.mf;const s=null!==(a=t.OpxAlternateHostUrls)&&void 0!==a?a:i.u0;return null!=e.opxHostUrlOverride&&s.indexOf(e.opxHostUrlOverride)>=0&&(r=e.opxHostUrlOverride),r}(0,a.NP)().subscribe("ShellDataUpdated",(function e(t,n){var l;if(n.SuiteServiceUrl&&(n.IsConsumerShell||n.TokenFactoryIframeOrigin)&&!s.F.isInitialized()){const c=(0,a.GJ)(),u={SuiteServiceUrl:n.SuiteServiceUrl,AdminServiceUrl:n.PortalUrl,CurrentUserUpn:n.UPN,CurrentUserPuid:n.PUID,UserHasExchangeLicense:n.HasEXOLicense,SuiteServiceCallsDisabled:n.SuiteServiceCallsDisabled,TokenFactoryIframeOrigin:n.TokenFactoryIframeOrigin,IsOwa:(0,r.Uc)(n.WorkloadId),ShellSID:n.SHSID,HintUserName:null!=n.EnableUsernameHinting&&n.EnableUsernameHinting,CultureName:t.CultureName,MruOauthEndpointUrl:n.MruOauthEndpointUrl,MruOauthResourceUrl:n.MruOauthResourceUrl,GraphOauthEndpointUrl:n.GraphOauthEndpointUrl,GraphOauthResourceUrl:n.GraphOauthResourceUrl,OcpsOauthEndpointUrl:n.OcpsOauthEndpointUrl,OcpsOauthResourceUrl:n.OcpsOauthResourceUrl,NotificationsEnabled:n.NotificationsEnabled&&n.HasEXOLicense,WorkloadId:n.WorkloadId,ClientShellVersion:window.O365ShellVerStr,IsPwa:(0,r.bi)(n.WorkloadId,t.CurrentMainLinkElementID),IsOwsLanguageTimezoneCallEnabled:n.OwsLanguageTimezoneCallEnabled,GetTokenRequestDictionary:c.GetTokenRequestDictionary,ServiceWorkerCacheId:c.serviceWorkerCacheId,ServiceWorkerFetchStrategy:c.serviceWorkerFetchStrategy,ClearThemeCacheData:null!=n.ClearUserThemeCacheUrls&&n.ClearUserThemeCacheUrls.length>0?JSON.parse(n.ClearUserThemeCacheUrls):[],EnableTokenDictionary:n.EnableTokenDictionary,IsConsumer:n.IsConsumerShell,CSSExperiencesEnabled:n.CSSExperiencesEnabled,OpxEnabled:n.OpxEnabled&&!(0,r.bi)(n.WorkloadId,t.CurrentMainLinkElementID),OpxHostUrl:o(c,n),OpxResourceUrl:null!==(l=n.OpxDefaultHostUrl)&&void 0!==l?l:i.mf,ExchangeDataOpxEnabled:n.ExchangeDataOpxEnabled};s.F.CreateInstance(u);const d=(0,a.NP)();d.invoke("SuiteAPILoaded",s.F.Instance),d.unsubscribe("ShellDataUpdated",e)}}),!0)},62853:function(e,t,n){"use strict";var a;n.d(t,{G:function(){return a}}),function(e){e.MyDay="MyDay",e.ExchangeData="ExchangeData"}(a||(a={}))},14274:function(e,t,n){"use strict";var a,i;n.d(t,{b:function(){return a},i:function(){return i}}),function(e){e.SystemMetadata="SystemMetadata",e.CustomerContent="CustomerContent"}(a||(a={})),function(e){e.User="User",e.Tenant="Tenant"}(i||(i={}))},65599:function(e,t,n){"use strict";n.d(t,{wc:function(){return S},bQ:function(){return y.b},Zg:function(){return u},_H:function(){return v},ir:function(){return y.i}});var a=n(24126),i=n(16968),r=n(30086),s=n(68392);const o=a.OY.SuiteServiceApiRelativePath+"NotificationsSettings/User";class l{constructor(e){this.suiteApi=e}readNotificationSettings(){return new Promise(((e,t)=>{this.suiteApi.Service.callOwaIframeResourceUrl(o,null,a.oZ.GET).then((t=>{e(t)})).catch((e=>{a.F2.genericServiceRejection("ReadNotificationSettings",6,e,t)}))}))}writeNotificationSettings(e){return new Promise(((t,n)=>{if(null==e)throw(0,s.h)("settingValue");this.suiteApi.Service.callOwaIframeResourceUrl(o,e,a.oZ.PUT).then((()=>{t()})).catch((e=>{a.F2.genericServiceRejection("WriteNotificationSettings",6,e,n)}))}))}}var c=n(87894);class u{constructor(e,t,n){this.Scope=e,this.Namespace=t,this.Name=n,(0,c.throwOnNullOrEmpty)(e,"keyScope"),(0,c.throwOnNullOrEmpty)(t,"keyNamespace"),(0,c.throwOnNullOrEmpty)(n,"keyName")}toString(){return this.Scope+a.YM.DictionaryStringPartsSeparator+this.Namespace+a.YM.DictionaryStringPartsSeparator+this.Name}static fromDictionaryKey(e){(0,c.throwOnNullOrEmpty)(e,"keyString");const t=e.split(a.YM.DictionaryStringPartsSeparator);if(t.length<3)throw(0,s.E)("Malformed keyString: Expected format <Scope>//<Namespace>//<Name>");return new u(t[0],t[1],t[2])}}class d{constructor(e,t){this.Key=e,this.Value=t,(0,c.throwOnNull)(e,"key"),(0,c.throwOnNull)(t,"value")}}class p{constructor(e){this.Header=e}}class h extends p{constructor(e,t){super(e),this.Header=e,this.Body=t}}const g="Cannot remove a key needed for read or write.";class m{constructor(e=!1,t=[],n={},a=[]){this.clearAll=e,this.writes=n,this.reads={},this.removes={},t.forEach((e=>this.reads[e.toString()]=e)),a.forEach((e=>this.removes[e.toString()]=e))}getReadStorageKeys(){return Object.keys(this.reads).map((e=>this.reads[e]))}getWriteStorageKeyValues(){return Object.keys(this.writes).map((e=>this.writes[e]))}getRemoveStorageKeys(){return Object.keys(this.removes).map((e=>this.removes[e]))}requestRead(...e){(0,c.throwOnNullOrEmptyArray)(e,"keys");for(let t of e){if((0,c.throwOnNull)(t,"key"),this.isRemoveRequested(t))throw new a.WJ(g,-2002);this.reads[t.toString()]=t}}requestWrite(e,...t){(0,c.throwOnUndefined)(e,"value"),(0,c.throwOnNullOrEmptyArray)(t,"keys");for(let n of t){if((0,c.throwOnNull)(n,"key"),this.isRemoveRequested(n))throw new a.WJ(g,-2002);this.writes[n.toString()]=new d(n,e)}}requestRemove(...e){(0,c.throwOnNullOrEmptyArray)(e,"keys");for(let t of e){if((0,c.throwOnNull)(t,"key"),t.toString()in this.reads||t.toString()in this.writes)throw new a.WJ(g,-2002);this.removes[t.toString()]=t}}requestClearAll(){this.clearAll=!0}combine(...e){(0,c.throwOnNullOrEmptyArray)(e,"requests");let t=new m(this.clearAll);for(let n of e.concat(this)){n.getReadStorageKeys().length&&t.requestRead(...n.getReadStorageKeys());for(let e of Object.keys(n.writes))t.requestWrite(n.writes[e].Value,n.writes[e].Key);n.getRemoveStorageKeys().length&&t.requestRemove(...n.getRemoveStorageKeys())}return t}valueToBeWritten(e){(0,c.throwOnNullOrUndefined)(e,"key");const t=this.writes[e.toString()];if(null==t)throw new a.WJ("Cannot read key without value.",-2002);return t.Value}isRemoveRequested(e){return(0,c.throwOnNullOrUndefined)(e,"key"),e.toString()in this.removes}isClearAllRequested(){return this.clearAll}toStorageServerJsonRequest(){const e={ReadSettings:this.getReadStorageKeys().slice(),WriteSettings:this.getWriteStorageKeyValues().map((e=>new d(e.Key,JSON.stringify(e.Value))))};return new h({},e)}toStorageDataRequest(e){return{UserId:e,ClearAll:this.clearAll,Reads:this.getReadStorageKeys().map((e=>e.toString())),Writes:this.getWriteStorageKeyValues().map((e=>({Key:e.Key.toString(),Value:JSON.stringify(e.Value)}))),Deletes:this.getRemoveStorageKeys().map((e=>e.toString())),RequestType:0}}}class f{constructor(e={}){this.values=e}static fromStorageSessionResponseData(e){c.throwOnNullOrUndefined(e,"data");let t=new f({});for(let n of Object.keys(e.Reads)){const a=new d(u.fromDictionaryKey(n),JSON.parse(e.Reads[n]));t.values[a.Key.toString()]=a.Value}return t}static fromStorageServerResponseData(e){c.throwOnNullOrUndefined(e,"data");let t=new f({});for(let n of e.Settings){const e=new d(n.Key,JSON.parse(n.Value));t.values[e.Key.toString()]=e.Value}return t}hasKey(e){return c.throwOnNullOrUndefined(e,"key"),e.toString()in this.values}value(e){if(c.throwOnNullOrUndefined(e,"key"),!(e.toString()in this.values))throw new a.WJ("Key value missing.",-2002);return this.values[e.toString()]}getStorageKeyValues(){return Object.keys(this.values).map((e=>this.values[e]))}}class S extends r.y{initializeComponent(){this.NotificationsStorage=new l(this.SuiteApi)}createStorageRequest(){return this.checkInitialized(),new m}submitStorageRequestToOwaSessionStorage(e,t){return this.checkInitialized(),new Promise(((n,r)=>{if(null==e)return r(s.h("request"));this.SuiteApi.Service.owaSessionStorageRequest(e.toStorageDataRequest(this.SuiteApi.Configuration.CurrentUserUpn)).then((e=>{this.checkStorageResponseErrors(e,r)||n(f.fromStorageSessionResponseData(e))})).catch((e=>{a.F2.isCallsBlockedException(e)||(0,i.tZ)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,e.errorCode),r(e)})),null!=t&&window.setTimeout((()=>{const e=new Error("Session Storage Request Timeout");(0,i.tZ)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,-1001),r(e)}),t)}))}isServerStorageEnabled(e){return a.pf.Instance.configuration.UserHasExchangeLicense||e}readNotificationSettings(){return this.checkInitialized(),this.NotificationsStorage.readNotificationSettings()}writeNotificationSettings(e){return this.checkInitialized(),this.NotificationsStorage.writeNotificationSettings(e)}checkStorageResponseErrors(e,t){let n=e;return n.ClearError,n.WriteError,n.ReadError,null!=n.ResetError&&(t(n.ResetError),!0)}}var y=n(14274),C=n(95144),b=n(45011),T=n(53464);class I{constructor(e=new m){this.storageRequest=e}requestRead(...e){this.storageRequest.requestRead(...e)}requestWrite(e,...t){this.storageRequest.requestWrite(e,...t)}toStorageDataRequest(e){return this.storageRequest.toStorageDataRequest(e)}requestClearAll(){this.storageRequest.requestClearAll()}}class D{constructor(e=void 0){this.value=e}fromStorageSessionResponseData(e){this.storageResponse=f.fromStorageSessionResponseData(e)}hasValue(e){return C.nQ.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.hasKey(e)&&null!=this.storageResponse.value(e)}getValue(e){return C.nQ.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.value(e)}}class v extends r.y{initializeComponent(){}createWebShellStorageRequest(){return this.checkInitialized(),new I}readStorage(e,t,n){this.checkInitialized();const i=this.createTokenFactoryRequest(t,e,n,a.oZ.GET);return this.useStorage(i)}batchReadStorage(e,t,n){this.checkInitialized();const i=this.createTokenFactoryBatchRequest(t,e,n,a.oZ.GET);return this.useStorage(i)}writeStorage(e,t,n,i){this.checkInitialized();const r=this.createTokenFactoryRequest(t,e,n,a.oZ.PUT);return r.body=JSON.stringify(i),this.useStorage(r)}removeStorage(e,t,n){this.checkInitialized();const i=this.createTokenFactoryRequest(t,e,n,a.oZ.DELETE);return this.useStorage(i)}readSessionStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}writeSessionStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}removeSessionStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}readLocalStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}writeLocalStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}removeLocalStorage(e){return Promise.reject(new Error("not implemented"))}createTokenFactoryRequest(e,t,n,a){C.nQ.throwOnNullOrEmpty(n,"keyName");const i=(0,C.JT)("{0}/api/storage/{1}/{2}/{3}?api-version={4}&shellType=OneShell",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,t,encodeURIComponent(n),v.ApiVersion);return this.createTokenFactoryRequestHelper(i,a)}createTokenFactoryBatchRequest(e,t,n,a){C.nQ.throwOnNullOrEmptyArray(n,"keyNames");const i=(0,C.JT)("{0}/api/storage/{1}/{2}/{3}?api-version={4}",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,t,encodeURIComponent(n.join(",")),v.ApiVersion);return this.createTokenFactoryRequestHelper(i,a)}createTokenFactoryRequestHelper(e,t){return{url:e,resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:t,headers:T.n}}useStorage(e){return new Promise(((t,n)=>{this.SuiteApi.Service.callEndpointWithOauthToken(e).then((e=>{t(new D(e))})).catch(n)}))}useBrowserStorage(e){return new Promise(((t,n)=>{C.nQ.throwOnNull(e,"StorageRequest");let r=!1,o=e.toStorageDataRequest(this.SuiteApi.Configuration.CurrentUserUpn),l={url:a.pf.Instance.configuration.TokenFactoryIframeOrigin,requestObject:o,timeout:3e4,success:e=>{r=!0;let a=e.responseObject;if(!this.checkStorageResponseErrors(a,n)){let e=new D;e.fromStorageSessionResponseData(a),t(e)}},error:(e,t,a)=>{r=!0;let o=b.Ru(a);(0,i.tZ)().tag("StorageApi_RequestError",6,t,o),n((0,s.E)(o))}},c=null;this.SuiteApi.Service.AreSuiteServiceCallsBlocked||(c=a.b6.OauthTokenFactoryInstance),null!=c?(setTimeout((()=>{if(!r){r=!0;const e=new Error("StorageTimeout");(0,i.tZ)().exception("StorageApi_TimeoutError",6,e),n(e)}}),l.timeout),c.executeStorageRequest(l)):n(new a.WJ("OauthTokenFactoryIframe",-1011))}))}checkStorageResponseErrors(e,t){let n=e;if(!n){let e=new Error("Empty response received.");(0,i.tZ)().exception("StorageApi_NoResponse",6,e),t(e)}if(null!=n.ClearError)t(n.ClearError);else if(null!=n.WriteError)t(n.WriteError);else if(null!=n.ReadError)t(n.ReadError);else{if(null==n.ResetError)return!1;t(n.ResetError)}return!0}}v.ApiVersion="1"},47562:function(e){"use strict";e.exports=JSON.parse('[{"Locale":"af-NA","DisplayName":"Afrikaans (Namibië)‎"},{"Locale":"af-ZA","DisplayName":"Afrikaans (Suid-Afrika)‎"},{"Locale":"am-ET","DisplayName":"አማርኛ (ኢትዮጵያ)‎"},{"Locale":"ar-AE","DisplayName":"العربية (الإمارات العربية المتحدة)‏"},{"Locale":"ar-BH","DisplayName":"العربية (البحرين)‏"},{"Locale":"ar-DJ","DisplayName":"العربية (جيبوتي)‏"},{"Locale":"ar-DZ","DisplayName":"العربية (الجزائر)‏"},{"Locale":"ar-EG","DisplayName":"العربية (مصر)‏"},{"Locale":"ar-ER","DisplayName":"العربية (إريتريا)‏"},{"Locale":"ar-IL","DisplayName":"العربية (إسرائيل)‏"},{"Locale":"ar-IQ","DisplayName":"العربية (العراق)‏"},{"Locale":"ar-JO","DisplayName":"العربية (الأردن)‏"},{"Locale":"ar-KM","DisplayName":"العربية (جزر القمر)‏"},{"Locale":"ar-KW","DisplayName":"العربية (الكويت)‏"},{"Locale":"ar-LB","DisplayName":"العربية (لبنان)‏"},{"Locale":"ar-LY","DisplayName":"العربية (ليبيا)‏"},{"Locale":"ar-MA","DisplayName":"العربية (المملكة المغربية)‏"},{"Locale":"ar-MR","DisplayName":"العربية (موريتانيا)‏"},{"Locale":"ar-OM","DisplayName":"العربية (عمان)‏"},{"Locale":"ar-PS","DisplayName":"العربية (السلطة الفلسطينية)‏"},{"Locale":"ar-QA","DisplayName":"العربية (قطر)‏"},{"Locale":"ar-SA","DisplayName":"العربية (المملكة العربية السعودية)‏"},{"Locale":"ar-SO","DisplayName":"العربية (الصومال)‏"},{"Locale":"ar-SS","DisplayName":"العربية (جنوب السودان)‏"},{"Locale":"ar-TD","DisplayName":"العربية (تشاد)‏"},{"Locale":"ar-TN","DisplayName":"العربية (تونس)‏"},{"Locale":"as-IN","DisplayName":"অসমীয়া (ভাৰত)‎"},{"Locale":"az-Latn-AZ","DisplayName":"azərbaycan (Azərbaycan)‎"},{"Locale":"be-BY","DisplayName":"Беларуская (Беларусь)‎"},{"Locale":"bg-BG","DisplayName":"български (България)‎"},{"Locale":"bn-BD","DisplayName":"বাংলা (বাংলাদেশ)‎"},{"Locale":"bn-IN","DisplayName":"বাংলা (ভারত)‎"},{"Locale":"bs-Latn-BA","DisplayName":"bosanski (Bosna i Hercegovina)‎"},{"Locale":"ca-AD","DisplayName":"català (Andorra)‎"},{"Locale":"ca-ES","DisplayName":"català (català)‎"},{"Locale":"ca-FR","DisplayName":"català (França)‎"},{"Locale":"ca-IT","DisplayName":"català (Itàlia)‎"},{"Locale":"cs-CZ","DisplayName":"čeština (Česko)‎"},{"Locale":"cy-GB","DisplayName":"Cymraeg (Y Deyrnas Unedig)‎"},{"Locale":"da-DK","DisplayName":"dansk (Danmark)‎"},{"Locale":"da-GL","DisplayName":"dansk (Grønland)‎"},{"Locale":"de-AT","DisplayName":"Deutsch (Österreich)‎"},{"Locale":"de-BE","DisplayName":"Deutsch (Belgien)‎"},{"Locale":"de-CH","DisplayName":"Deutsch (Schweiz)‎"},{"Locale":"de-DE","DisplayName":"Deutsch (Deutschland)‎"},{"Locale":"de-IT","DisplayName":"Deutsch (Italien)‎"},{"Locale":"de-LI","DisplayName":"Deutsch (Liechtenstein)‎"},{"Locale":"de-LU","DisplayName":"Deutsch (Luxemburg)‎"},{"Locale":"el-CY","DisplayName":"Ελληνικά (Κύπρος)‎"},{"Locale":"el-GR","DisplayName":"Ελληνικά (Ελλάδα)‎"},{"Locale":"en-GB","DisplayName":"English (United Kingdom)‎"},{"Locale":"es-AR","DisplayName":"español (Argentina)‎"},{"Locale":"es-BO","DisplayName":"español (Bolivia)‎"},{"Locale":"es-BR","DisplayName":"español (Brasil)‎"},{"Locale":"es-BZ","DisplayName":"español (Belice)‎"},{"Locale":"es-CL","DisplayName":"español (Chile)‎"},{"Locale":"es-CO","DisplayName":"español (Colombia)‎"},{"Locale":"es-CR","DisplayName":"español (Costa Rica)‎"},{"Locale":"es-CU","DisplayName":"español (Cuba)‎"},{"Locale":"es-DO","DisplayName":"español (República Dominicana)‎"},{"Locale":"es-EC","DisplayName":"español (Ecuador)‎"},{"Locale":"es-ES","DisplayName":"español (España, alfabetización internacional)‎"},{"Locale":"es-GQ","DisplayName":"español (Guinea Ecuatorial)‎"},{"Locale":"es-GT","DisplayName":"español (Guatemala)‎"},{"Locale":"es-HN","DisplayName":"español (Honduras)‎"},{"Locale":"es-MX","DisplayName":"español (México)‎"},{"Locale":"es-NI","DisplayName":"español (Nicaragua)‎"},{"Locale":"es-PA","DisplayName":"español (Panamá)‎"},{"Locale":"es-PE","DisplayName":"español (Perú)‎"},{"Locale":"es-PH","DisplayName":"español (Filipinas)‎"},{"Locale":"es-PR","DisplayName":"español (Puerto Rico)‎"},{"Locale":"es-PY","DisplayName":"español (Paraguay)‎"},{"Locale":"es-SV","DisplayName":"español (El Salvador)‎"},{"Locale":"es-US","DisplayName":"español (Estados Unidos)‎"},{"Locale":"es-UY","DisplayName":"español (Uruguay)‎"},{"Locale":"es-VE","DisplayName":"español (Venezuela)‎"},{"Locale":"et-EE","DisplayName":"eesti (Eesti)‎"},{"Locale":"eu-ES","DisplayName":"euskara (euskara)‎"},{"Locale":"fa-IR","DisplayName":"فارسی (ایران)‏"},{"Locale":"fi-FI","DisplayName":"suomi (Suomi)‎"},{"Locale":"fil-PH","DisplayName":"Filipino (Pilipinas)‎"},{"Locale":"fr-BE","DisplayName":"français (Belgique)‎"},{"Locale":"fr-BF","DisplayName":"français (Burkina Faso)‎"},{"Locale":"fr-BI","DisplayName":"français (Burundi)‎"},{"Locale":"fr-BJ","DisplayName":"français (Bénin)‎"},{"Locale":"fr-BL","DisplayName":"français (Saint-Barthélemy)‎"},{"Locale":"fr-CA","DisplayName":"français (Canada)‎"},{"Locale":"fr-CF","DisplayName":"français (République centrafricaine)‎"},{"Locale":"fr-CG","DisplayName":"français (Congo)‎"},{"Locale":"fr-CH","DisplayName":"français (Suisse)‎"},{"Locale":"fr-CI","DisplayName":"français (Côte d’Ivoire)‎"},{"Locale":"fr-CM","DisplayName":"français (Cameroun)‎"},{"Locale":"fr-DJ","DisplayName":"français (Djibouti)‎"},{"Locale":"fr-DZ","DisplayName":"français (Algérie)‎"},{"Locale":"fr-FR","DisplayName":"français (France)‎"},{"Locale":"fr-GA","DisplayName":"français (Gabon)‎"},{"Locale":"fr-GF","DisplayName":"français (Guyane française)‎"},{"Locale":"fr-GN","DisplayName":"français (Guinée)‎"},{"Locale":"fr-GP","DisplayName":"français (Guadeloupe)‎"},{"Locale":"fr-GQ","DisplayName":"français (Guinée équatoriale)‎"},{"Locale":"fr-HT","DisplayName":"français (Haïti)‎"},{"Locale":"fr-KM","DisplayName":"français (Comores)‎"},{"Locale":"fr-LU","DisplayName":"français (Luxembourg)‎"},{"Locale":"fr-MA","DisplayName":"français (Maroc)‎"},{"Locale":"fr-MC","DisplayName":"français (Monaco)‎"},{"Locale":"fr-MF","DisplayName":"français (Saint-Martin)‎"},{"Locale":"fr-MG","DisplayName":"français (Madagascar)‎"},{"Locale":"fr-ML","DisplayName":"français (Mali)‎"},{"Locale":"fr-MQ","DisplayName":"français (Martinique)‎"},{"Locale":"fr-MR","DisplayName":"français (Mauritanie)‎"},{"Locale":"fr-MU","DisplayName":"français (Maurice)‎"},{"Locale":"fr-NC","DisplayName":"français (Nouvelle-Calédonie)‎"},{"Locale":"fr-NE","DisplayName":"français (Niger)‎"},{"Locale":"fr-PF","DisplayName":"français (Polynésie française)‎"},{"Locale":"fr-PM","DisplayName":"français (Saint-Pierre-et-Miquelon)‎"},{"Locale":"fr-RE","DisplayName":"français (La Réunion)‎"},{"Locale":"fr-RW","DisplayName":"français (Rwanda)‎"},{"Locale":"fr-SC","DisplayName":"français (Seychelles)‎"},{"Locale":"fr-SN","DisplayName":"français (Sénégal)‎"},{"Locale":"fr-TD","DisplayName":"français (Tchad)‎"},{"Locale":"fr-TG","DisplayName":"français (Togo)‎"},{"Locale":"fr-TN","DisplayName":"français (Tunisie)‎"},{"Locale":"fr-VU","DisplayName":"français (Vanuatu)‎"},{"Locale":"fr-WF","DisplayName":"français (Wallis-et-Futuna)‎"},{"Locale":"fr-YT","DisplayName":"français (Mayotte)‎"},{"Locale":"ga-IE","DisplayName":"Gaeilge (Éire)‎"},{"Locale":"gd-GB","DisplayName":"Gàidhlig (An Rìoghachd Aonaichte)‎"},{"Locale":"gl-ES","DisplayName":"galego (galego)‎"},{"Locale":"gu-IN","DisplayName":"ગુજરાતી (ભારત)‎"},{"Locale":"ha-Latn-NG","DisplayName":"Hausa (Najeriya)‎"},{"Locale":"he-IL","DisplayName":"עברית (ישראל)‏"},{"Locale":"hi-IN","DisplayName":"हिन्दी (भारत)‎"},{"Locale":"hr-BA","DisplayName":"hrvatski (Bosna i Hercegovina)‎"},{"Locale":"hr-HR","DisplayName":"hrvatski (Hrvatska)‎"},{"Locale":"hu-HU","DisplayName":"magyar (Magyarország)‎"},{"Locale":"hy-AM","DisplayName":"Հայերեն (Հայաստան)‎"},{"Locale":"id-ID","DisplayName":"Indonesia (Indonesia)‎"},{"Locale":"is-IS","DisplayName":"íslenska (Ísland)‎"},{"Locale":"it-CH","DisplayName":"italiano (Svizzera)‎"},{"Locale":"it-IT","DisplayName":"italiano (Italia)‎"},{"Locale":"it-SM","DisplayName":"italiano (San Marino)‎"},{"Locale":"it-VA","DisplayName":"italiano (Città del Vaticano)‎"},{"Locale":"ja-JP","DisplayName":"日本語 (日本)‎"},{"Locale":"ka-GE","DisplayName":"ქართული (საქართველო)‎"},{"Locale":"kk-KZ","DisplayName":"қазақ тілі (Қазақстан)‎"},{"Locale":"km-KH","DisplayName":"ភាសាខ្មែរ (កម្ពុជា)‎"},{"Locale":"kn-IN","DisplayName":"ಕನ್ನಡ (ಭಾರತ)‎"},{"Locale":"ko-KR","DisplayName":"한국어(대한민국)‎"},{"Locale":"kok-IN","DisplayName":"कोंकणी (भारत)‎"},{"Locale":"ky-KG","DisplayName":"Кыргыз (Кыргызстан)‎"},{"Locale":"lb-LU","DisplayName":"Lëtzebuergesch (Lëtzebuerg)‎"},{"Locale":"lo-LA","DisplayName":"ລາວ (ລາວ)‎"},{"Locale":"lt-LT","DisplayName":"lietuvių (Lietuva)‎"},{"Locale":"lv-LV","DisplayName":"latviešu (Latvija)‎"},{"Locale":"mi-NZ","DisplayName":"te reo Māori (Aotearoa)‎"},{"Locale":"mk-MK","DisplayName":"македонски (Северна Македонија)‎"},{"Locale":"ml-IN","DisplayName":"മലയാളം (ഇന്ത്യ)‎"},{"Locale":"mn-MN","DisplayName":"монгол (Монгол)‎"},{"Locale":"mr-IN","DisplayName":"मराठी (भारत)‎"},{"Locale":"ms-BN","DisplayName":"Melayu (Brunei)‎"},{"Locale":"ms-MY","DisplayName":"Melayu (Malaysia)‎"},{"Locale":"ms-SG","DisplayName":"Melayu (Singapura)‎"},{"Locale":"mt-MT","DisplayName":"Malti (Malta)‎"},{"Locale":"nb-NO","DisplayName":"norsk bokmål (Norge)‎"},{"Locale":"nb-SJ","DisplayName":"norsk bokmål (Svalbard og Jan Mayen)‎"},{"Locale":"ne-NP","DisplayName":"नेपाली (नेपाल)‎"},{"Locale":"nl-AW","DisplayName":"Nederlands (Aruba)‎"},{"Locale":"nl-BE","DisplayName":"Nederlands (België)‎"},{"Locale":"nl-BQ","DisplayName":"Nederlands (Bonaire, Sint Eustatius en Saba)‎"},{"Locale":"nl-CW","DisplayName":"Nederlands (Curaçao)‎"},{"Locale":"nl-NL","DisplayName":"Nederlands (Nederland)‎"},{"Locale":"nl-SR","DisplayName":"Nederlands (Suriname)‎"},{"Locale":"nl-SX","DisplayName":"Nederlands (Sint-Maarten)‎"},{"Locale":"or-IN","DisplayName":"ଓଡ଼ିଆ (ଭାରତ)‎"},{"Locale":"pa-IN","DisplayName":"ਪੰਜਾਬੀ (ਭਾਰਤ)‎"},{"Locale":"pl-PL","DisplayName":"polski (Polska)‎"},{"Locale":"prs-AF","DisplayName":"درى (افغانستان)‏"},{"Locale":"pt-AO","DisplayName":"português (Angola)‎"},{"Locale":"pt-BR","DisplayName":"português (Brasil)‎"},{"Locale":"pt-CH","DisplayName":"português (Suíça)‎"},{"Locale":"pt-CV","DisplayName":"português (Cabo Verde)‎"},{"Locale":"pt-GQ","DisplayName":"português (Guiné Equatorial)‎"},{"Locale":"pt-GW","DisplayName":"português (Guiné-Bissau)‎"},{"Locale":"pt-LU","DisplayName":"português (Luxemburgo)‎"},{"Locale":"pt-MO","DisplayName":"português (RAE de Macau)‎"},{"Locale":"pt-MZ","DisplayName":"português (Moçambique)‎"},{"Locale":"pt-PT","DisplayName":"português (Portugal)‎"},{"Locale":"pt-ST","DisplayName":"português (São Tomé e Príncipe)‎"},{"Locale":"pt-TL","DisplayName":"português (Timor-Leste)‎"},{"Locale":"quz-PE","DisplayName":"Runasimi (Perú)‎"},{"Locale":"ro-MD","DisplayName":"română (Republica Moldova)‎"},{"Locale":"ro-RO","DisplayName":"română (România)‎"},{"Locale":"ru-BY","DisplayName":"русский (Беларусь)‎"},{"Locale":"ru-KG","DisplayName":"русский (Киргизия)‎"},{"Locale":"ru-KZ","DisplayName":"русский (Казахстан)‎"},{"Locale":"ru-MD","DisplayName":"русский (Молдова)‎"},{"Locale":"ru-RU","DisplayName":"русский (Россия)‎"},{"Locale":"ru-UA","DisplayName":"русский (Украина)‎"},{"Locale":"sd-Arab-PK","DisplayName":"سنڌي (پاکستان)‏"},{"Locale":"si-LK","DisplayName":"සිංහල (ශ්‍රී ලංකාව)‎"},{"Locale":"sk-SK","DisplayName":"slovenčina (Slovensko)‎"},{"Locale":"sl-SI","DisplayName":"slovenščina (Slovenija)‎"},{"Locale":"sq-AL","DisplayName":"shqip (Shqipëri)‎"},{"Locale":"sq-MK","DisplayName":"shqip (Maqedonia e Veriut)‎"},{"Locale":"sq-XK","DisplayName":"shqip (Kosovë)‎"},{"Locale":"sr-Cyrl-BA","DisplayName":"српски (Босна и Херцеговина)‎"},{"Locale":"sr-Cyrl-ME","DisplayName":"српски (Црна Гора)‎"},{"Locale":"sr-Cyrl-RS","DisplayName":"српски (Србија)‎"},{"Locale":"sr-Cyrl-XK","DisplayName":"српски (Косово)‎"},{"Locale":"sr-Latn-BA","DisplayName":"srpski (Bosna i Hercegovina)‎"},{"Locale":"sr-Latn-ME","DisplayName":"srpski (Crna Gora)‎"},{"Locale":"sr-Latn-RS","DisplayName":"srpski (Srbija)‎"},{"Locale":"sr-Latn-XK","DisplayName":"srpski (Kosovo)‎"},{"Locale":"sv-AX","DisplayName":"svenska (Åland)‎"},{"Locale":"sv-FI","DisplayName":"svenska (Finland)‎"},{"Locale":"sv-SE","DisplayName":"svenska (Sverige)‎"},{"Locale":"sw-KE","DisplayName":"Kiswahili (Kenya)‎"},{"Locale":"sw-TZ","DisplayName":"Kiswahili (Tanzania)‎"},{"Locale":"sw-UG","DisplayName":"Kiswahili (Uganda)‎"},{"Locale":"ta-IN","DisplayName":"தமிழ் (இந்தியா)‎"},{"Locale":"ta-LK","DisplayName":"தமிழ் (இலங்கை)‎"},{"Locale":"ta-MY","DisplayName":"தமிழ் (மலேசியா)‎"},{"Locale":"ta-SG","DisplayName":"தமிழ் (சிங்கப்பூர்)‎"},{"Locale":"te-IN","DisplayName":"తెలుగు (భారత దేశం)‎"},{"Locale":"th-TH","DisplayName":"ไทย (ไทย)‎"},{"Locale":"tk-TM","DisplayName":"Türkmen dili (Türkmenistan)‎"},{"Locale":"tr-CY","DisplayName":"Türkçe (Kıbrıs)‎"},{"Locale":"tr-TR","DisplayName":"Türkçe (Türkiye)‎"},{"Locale":"tt-RU","DisplayName":"Татар (Россия)‎"},{"Locale":"ug-CN","DisplayName":"ئۇيغۇرچە (جۇڭخۇا خەلق جۇمھۇرىيىتى)‏"},{"Locale":"uk-UA","DisplayName":"українська (Україна)‎"},{"Locale":"ur-IN","DisplayName":"اردو (بھارت)‏"},{"Locale":"ur-PK","DisplayName":"اُردو (پاکستان)‏"},{"Locale":"uz-Arab-AF","DisplayName":"اوزبیک (افغانستان)‎"},{"Locale":"uz-Cyrl-UZ","DisplayName":"ўзбекча (Ўзбекистон)‎"},{"Locale":"uz-Latn-UZ","DisplayName":"o‘zbek (Oʻzbekiston)‎"},{"Locale":"vi-VN","DisplayName":"Tiếng Việt (Việt Nam)‎"},{"Locale":"zh-CN","DisplayName":"中文(中国)‎"},{"Locale":"zh-Hans-HK","DisplayName":"中文 (香港特别行政区)‎"},{"Locale":"zh-Hans-MO","DisplayName":"中文 (澳门特别行政区)‎"},{"Locale":"zh-HK","DisplayName":"中文(香港特別行政區)‎"},{"Locale":"zh-MO","DisplayName":"中文(澳門特別行政區)‎"},{"Locale":"zh-SG","DisplayName":"中文(新加坡)‎"},{"Locale":"zh-TW","DisplayName":"中文(台灣)‎"}]')}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_plus_end"),shellPerformance.measure("shell_plus","shell_plus_start","shell_plus_end"));