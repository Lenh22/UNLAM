var WacAnimation={};function WacCurve(ID,type,x1,y1,x2,y2){this.ID=ID,this.type=type,this.x1=x1,this.y1=y1,this.x2=x2,this.y2=y2}var WacCurveType={Instant:0,Hold:1,Linear:2,CubicBezier:3},WacCurveID={Instant:0,Hold:1,Linear:2,ShotgunToPillowLanding:3,ReverseShotgunToPillowLanding:4,ShotgunToLinear:5,EaseIn:6,EaseOut:7,EaseInOut:8,Exponential:9,ShotgunToPillowLanding_VisualRefresh:10,Cxe_ShowHintBar:11,Cxe_HideHintBar:12,Cxe_ColorWheel:13,Cxe_SpinnerDot1:14,Cxe_SpinnerDot2:15,Cxe_SpinnerDot4:16,Cxe_SpinnerDot5:17,Cxe_SpinnerDot7:18,InOutSine:19,PresenceUI_Standard:20,Fluent_Standard:21},g_AnimationCurves=new Array(22);function WacIntWrapper(value,contextId){this.value=value,this.contextId=contextId}function WacKeyFrame(type,curveID,startTime,endTime,startVal,endVal,relativeTo,operationType){this.type=type,this.curveID=curveID,this.startTime=null==startTime||null==startTime.value?new WacIntWrapper(startTime,null):startTime,this.endTime=null==endTime||null==endTime.value?new WacIntWrapper(endTime,null):endTime,this.startValue=null==startVal||null==startVal.value?new WacIntWrapper(startVal,null):startVal,this.endValue=null==endVal||null==endVal.value?new WacIntWrapper(endVal,null):endVal,this.relativeTo=relativeTo,this.operationType=operationType}g_AnimationCurves[WacCurveID.Instant]=new WacCurve(WacCurveID.Instant,WacCurveType.Instant,0,0,0,0),g_AnimationCurves[WacCurveID.Hold]=new WacCurve(WacCurveID.Hold,WacCurveType.Hold,0,0,0,0),g_AnimationCurves[WacCurveID.Linear]=new WacCurve(WacCurveID.Linear,WacCurveType.Linear,0,0,0,0),g_AnimationCurves[WacCurveID.ShotgunToPillowLanding]=new WacCurve(WacCurveID.ShotgunToPillowLanding,WacCurveType.CubicBezier,0,0,0,1),g_AnimationCurves[WacCurveID.ReverseShotgunToPillowLanding]=new WacCurve(WacCurveID.ReverseShotgunToPillowLanding,WacCurveType.CubicBezier,1,0,1,1),g_AnimationCurves[WacCurveID.ShotgunToLinear]=new WacCurve(WacCurveID.ShotgunToLinear,WacCurveType.CubicBezier,0,0,.42,1),g_AnimationCurves[WacCurveID.EaseIn]=new WacCurve(WacCurveID.EaseIn,WacCurveType.CubicBezier,.83,0,1,1),g_AnimationCurves[WacCurveID.EaseOut]=new WacCurve(WacCurveID.EaseOut,WacCurveType.CubicBezier,0,0,.58,1),g_AnimationCurves[WacCurveID.EaseInOut]=new WacCurve(WacCurveID.EaseInOut,WacCurveType.CubicBezier,.42,0,.58,1),g_AnimationCurves[WacCurveID.Exponential]=new WacCurve(WacCurveID.Exponential,WacCurveType.CubicBezier,.1,.25,.75,.9),g_AnimationCurves[WacCurveID.ShotgunToPillowLanding_VisualRefresh]=new WacCurve(WacCurveID.ShotgunToPillowLanding_VisualRefresh,WacCurveType.CubicBezier,.1,.9,.2,1),g_AnimationCurves[WacCurveID.Cxe_ShowHintBar]=new WacCurve(WacCurveID.Cxe_ShowHintBar,WacCurveType.CubicBezier,.1,.9,.2,1),g_AnimationCurves[WacCurveID.Cxe_HideHintBar]=new WacCurve(WacCurveID.Cxe_HideHintBar,WacCurveType.CubicBezier,.9,.1,.2,1),g_AnimationCurves[WacCurveID.Cxe_ColorWheel]=new WacCurve(WacCurveID.Cxe_ColorWheel,WacCurveType.CubicBezier,.4,0,0,1),g_AnimationCurves[WacCurveID.Cxe_SpinnerDot1]=new WacCurve(WacCurveID.Cxe_SpinnerDot1,WacCurveType.CubicBezier,.13,.21,.1,.7),g_AnimationCurves[WacCurveID.Cxe_SpinnerDot2]=new WacCurve(WacCurveID.Cxe_SpinnerDot2,WacCurveType.CubicBezier,.02,.33,.38,.77),g_AnimationCurves[WacCurveID.Cxe_SpinnerDot4]=new WacCurve(WacCurveID.Cxe_SpinnerDot4,WacCurveType.CubicBezier,.57,.17,.95,.75),g_AnimationCurves[WacCurveID.Cxe_SpinnerDot5]=new WacCurve(WacCurveID.Cxe_SpinnerDot5,WacCurveType.CubicBezier,0,.19,.07,.72),g_AnimationCurves[WacCurveID.Cxe_SpinnerDot7]=new WacCurve(WacCurveID.Cxe_SpinnerDot7,WacCurveType.CubicBezier,0,0,.95,.37),g_AnimationCurves[WacCurveID.InOutSine]=new WacCurve(WacCurveID.InOutSine,WacCurveType.CubicBezier,.66,0,.34,1),g_AnimationCurves[WacCurveID.PresenceUI_Standard]=new WacCurve(WacCurveID.PresenceUI_Standard,WacCurveType.CubicBezier,.8,0,.2,1),g_AnimationCurves[WacCurveID.Fluent_Standard]=new WacCurve(WacCurveID.Fluent_Standard,WacCurveType.CubicBezier,.8,0,.2,1),WacKeyFrame.prototype={type:0,curveID:0,startTime:new WacIntWrapper(0,null),endTime:new WacIntWrapper(0,null),startValue:new WacIntWrapper(0,null),endValue:new WacIntWrapper(0,null),relativeTo:0,operationType:0};var g_numAnimationAttributes=8;WacAnimation.Attribute={PositionX:1,PositionY:2,Height:3,Width:4,Opacity:5,ScrollTop:6,ScrollLeft:7,RotateZ:8};var AnimRelativeTo={Initial:0,Final:1,Absolute:2},WacKeyframeType={Mult:0,Add:1};WacAnimation.ContextID={AUTOSCROLLDURATION:0};var g_AnimationContextVariables=new Array(1);function WacAnimation_ContextVariableManager(){}function WacAnim(animationID,keyFrames){this.ID=animationID,this.keyFrames=keyFrames}g_AnimationContextVariables[WacAnimation.ContextID.AUTOSCROLLDURATION]=new WacIntWrapper(0,WacAnimation.ContextID.AUTOSCROLLDURATION),WacAnimation.ContextVariableManager=WacAnimation_ContextVariableManager,WacAnimation_ContextVariableManager.prototype={},WacAnimation_ContextVariableManager.prototype.SetContextVariable=function(variableName,variableValue){var variableId=WacAnimation.ContextID[variableName];g_AnimationContextVariables[variableId].value=variableValue},WacAnimation.ID={BASIC_INSTANTFADE:0,BASIC_QUICKESTSHOW:1,BASIC_QUICKMOVE:2,BASIC_QUICKSIZE:3,BASIC_QUICKSHOW:4,BASIC_QUICKHIDE:5,BASIC_QUICKERMOVE:6,BASIC_QUICKERSIZE:7,BASIC_QUICKERFADE:8,BASIC_QUICKERSHOW:9,BASIC_QUICKERHIDE:10,BASIC_MOVE:11,BASIC_SIZE:12,BASIC_FADE:13,BASIC_SHOW:14,BASIC_HIDE:15,BASIC_SCROLL:16,BASIC_SLOWMOVE:17,BASIC_SLOWSIZE:18,BASIC_SLOWFADE:19,BASIC_SLOWSHOW:20,BASIC_SLOWERSCROLL:21,ONENOTEBASIC_MOVE:22,ONENOTEBASIC_SIZE:23,ONENOTEBASIC_FADE:24,ONENOTEBASIC_SHOW:25,ONENOTEBASIC_HIDE:26,POWERPOINT_AUTOSCROLL_SCROLL:27,SHARED_QUICKHIDE:28,TAB_MOVE:29,TAB_SLIDEINFADEINBOTTOM:30,TAB_SLIDEINBOTTOMVISUALREFRESH:31,TAB_SLIDEOUTBOTTOMVISUALREFRESH:32,SHARED_INSERTSHOW:33,BASIC_MOVEVISUALREFRESH:34,BASIC_SIZEVISUALREFRESH:35,MSOHELP_FOLLOWTHEDOTMOVE:36,DELAY_SHOW:37,DELAY_MOVE:38,WAC_RIBBONMOVE:39,WAC_RIBBONSHOW:40,WAC_RIBBONHIDE:41};var g_WacAnimations=new Array(42);g_WacAnimations[WacAnimation.ID.BASIC_INSTANTFADE]=new WacAnim(WacAnimation.ID.BASIC_INSTANTFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,0,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKESTSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKESTSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKMOVE]=new WacAnim(WacAnimation.ID.BASIC_QUICKMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKSIZE]=new WacAnim(WacAnimation.ID.BASIC_QUICKSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,167,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKHIDE]=new WacAnim(WacAnimation.ID.BASIC_QUICKHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKERMOVE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKERSIZE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKERFADE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKERSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKERSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_QUICKERHIDE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_MOVE]=new WacAnim(WacAnimation.ID.BASIC_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_SIZE]=new WacAnim(WacAnimation.ID.BASIC_SIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_FADE]=new WacAnim(WacAnimation.ID.BASIC_FADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_SHOW]=new WacAnim(WacAnimation.ID.BASIC_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_HIDE]=new WacAnim(WacAnimation.ID.BASIC_HIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_SCROLL]=new WacAnim(WacAnimation.ID.BASIC_SCROLL,[new WacKeyFrame(WacAnimation.Attribute.ScrollTop,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.ScrollLeft,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_SLOWMOVE]=new WacAnim(WacAnimation.ID.BASIC_SLOWMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_SLOWSIZE]=new WacAnim(WacAnimation.ID.BASIC_SLOWSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_SLOWFADE]=new WacAnim(WacAnimation.ID.BASIC_SLOWFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,750,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_SLOWSHOW]=new WacAnim(WacAnimation.ID.BASIC_SLOWSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,750,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_SLOWERSCROLL]=new WacAnim(WacAnimation.ID.BASIC_SLOWERSCROLL,[new WacKeyFrame(WacAnimation.Attribute.ScrollTop,WacCurveID.ShotgunToPillowLanding,0,1e3,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.ScrollLeft,WacCurveID.ShotgunToPillowLanding,0,1e3,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_MOVE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_SIZE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_SIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_FADE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_FADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,367,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_SHOW]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,367,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_HIDE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_HIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.POWERPOINT_AUTOSCROLL_SCROLL]=new WacAnim(WacAnimation.ID.POWERPOINT_AUTOSCROLL_SCROLL,[new WacKeyFrame(WacAnimation.Attribute.ScrollTop,WacCurveID.Linear,0,g_AnimationContextVariables[WacAnimation.ContextID.AUTOSCROLLDURATION],null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.ScrollLeft,WacCurveID.Linear,0,g_AnimationContextVariables[WacAnimation.ContextID.AUTOSCROLLDURATION],null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.SHARED_QUICKHIDE]=new WacAnim(WacAnimation.ID.SHARED_QUICKHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.TAB_MOVE]=new WacAnim(WacAnimation.ID.TAB_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,433,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,433,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.TAB_SLIDEINFADEINBOTTOM]=new WacAnim(WacAnimation.ID.TAB_SLIDEINFADEINBOTTOM,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,0,null,40,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.TAB_SLIDEINBOTTOMVISUALREFRESH]=new WacAnim(WacAnimation.ID.TAB_SLIDEINBOTTOMVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Instant,0,0,null,32,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Instant,0,100,null,32,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,101,350,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.Instant,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.Instant,0,100,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,101,350,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.TAB_SLIDEOUTBOTTOMVISUALREFRESH]=new WacAnim(WacAnimation.ID.TAB_SLIDEOUTBOTTOMVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,32,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,1,AnimRelativeTo.Initial,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.SHARED_INSERTSHOW]=new WacAnim(WacAnimation.ID.SHARED_INSERTSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,101,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.BASIC_MOVEVISUALREFRESH]=new WacAnim(WacAnimation.ID.BASIC_MOVEVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.BASIC_SIZEVISUALREFRESH]=new WacAnim(WacAnimation.ID.BASIC_SIZEVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.MSOHELP_FOLLOWTHEDOTMOVE]=new WacAnim(WacAnimation.ID.MSOHELP_FOLLOWTHEDOTMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.EaseInOut,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.EaseInOut,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.DELAY_SHOW]=new WacAnim(WacAnimation.ID.DELAY_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.ShotgunToPillowLanding,201,500,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.DELAY_MOVE]=new WacAnim(WacAnimation.ID.DELAY_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,201,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,201,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.WAC_RIBBONMOVE]=new WacAnim(WacAnimation.ID.WAC_RIBBONMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]),g_WacAnimations[WacAnimation.ID.WAC_RIBBONSHOW]=new WacAnim(WacAnimation.ID.WAC_RIBBONSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]),g_WacAnimations[WacAnimation.ID.WAC_RIBBONHIDE]=new WacAnim(WacAnimation.ID.WAC_RIBBONHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);var g_WacAnimationEngine=null,g_WacAnimationLogging=-1!=window.location.search.indexOf("AnimationLogging=1"),g_WacAnimationThrottleFPS=0,g_WacAnimationThrottleNumInstance=3;function WacAnimationEngine(){this.AnimationQueue=new Array(0),this.sharedTimer=null,this.sharedCancelTimer=null,this.resetInterval=5e3,this.sharedTimerRefs=0,this.conflictTable=new Array(0),this.currentAnimationIndex=-1,this.temporaryIDGenerator=0}window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,16)},WacAnimation.State=WacAnimation_State,WacAnimation.Object=WacAnimation_Object,WacAnimationEngine.prototype={AnimationQueue:new Array(0),sharedTimer:null,sharedCancelTimer:null,resetInterval:5e3,sharedTimerRefs:0,conflictTable:new Array(0),currentAnimationIndex:-1,temporaryIDGenerator:0},WacAnimationEngine.prototype.LocalStepper=function(){g_WacAnimationEngine.StepAllAnimations()},WacAnimationEngine.prototype.LocalStopper=function(){g_WacAnimationEngine.StepAllAnimations(),g_WacAnimationEngine.StopEngine()},WacAnimationEngine.prototype.StartEngine=function(){null==this.sharedTimer&&null==this.sharedCancelTimer&&0==this.sharedTimerRefs&&(this.sharedTimer=window.requestAnimationFrame(WacAnimationEngine.prototype.LocalStepper),g_WacAnimationEngine.StartCancelTimer(),this.sharedTimerRefs=0,g_WacAnimationTelemetry.Start())},WacAnimationEngine.prototype.StopEngine=function(){g_WacAnimationTelemetry.Stop(),g_WacAnimationEngine.StopCancelTimer(),null!=this.sharedTimer&&(this.sharedTimer=null),this.sharedTimerRefs=0,this.conflictTable=new Array(0),this.AnimationQueue=new Array(0)},WacAnimationEngine.prototype.StartAnimation=function(a){this.AnimationQueue[this.sharedTimerRefs++]=a},WacAnimationEngine.prototype.StopAnimation=function(a){for(var i=0;i<this.AnimationQueue.length;i++)this.AnimationQueue[i]==a&&(this.RemoveTemporaryIds(a),this.AnimationQueue[i]=null)},WacAnimationEngine.prototype.StepAllAnimations=function(){var found=!1,lastFrameTime=null;g_WacAnimationEngine.StopCancelTimer();for(var i=0;i<this.AnimationQueue.length;i++)null!=this.AnimationQueue[i]&&(IsNullOrUndef(lastFrameTime)&&(lastFrameTime=this.AnimationQueue[i].currentTime),this.currentAnimationIndex=i,this.AnimationQueue[i].StepAnimation(),found=!0);this.currentAnimationIndex=-1,found&&!IsNullOrUndef(lastFrameTime)&&g_WacAnimationTelemetry.AddPerfData(new Date-lastFrameTime),found?(g_WacAnimationEngine.StartCancelTimer(),window.requestAnimationFrame(WacAnimationEngine.prototype.LocalStepper)):this.StopEngine()},WacAnimationEngine.prototype.CheckForConflictingAnimations=function(element,attribute){if(null==element.id||""==element.id){var tempID="tempAnimID_"+String(this.temporaryIDGenerator);this.temporaryIDGenerator++,element.id=tempID}var key=element.id+"_"+String(attribute),idxAnimUnit=this.conflictTable[key];if(IsNullOrUndef(idxAnimUnit)||idxAnimUnit==this.currentAnimationIndex||null==this.AnimationQueue[idxAnimUnit])this.conflictTable[key]=this.currentAnimationIndex;else{var confictingAnimUnit=this.AnimationQueue[idxAnimUnit];if(confictingAnimUnit.curveID.SetAttribute(attribute,null),null!=confictingAnimUnit.finishFunc){var currentAnimUnit=this.AnimationQueue[this.currentAnimationIndex],finishFunc1=confictingAnimUnit.finishFunc,extraData1=confictingAnimUnit.extraData,finishFunc2=currentAnimUnit.finishFunc,extraData2=currentAnimUnit.extraData;currentAnimUnit.finishFunc=null==finishFunc2?function(){finishFunc1(extraData1)}:function(){finishFunc1(extraData1),finishFunc2(extraData2)},currentAnimUnit.extraData=null,confictingAnimUnit.finishFunc=null}}},WacAnimationEngine.prototype.RemoveTemporaryIds=function(animUnit){var thisElement;if(IsArrayCheck(animUnit.element))for(var len=animUnit.element.length,elIndex=0;elIndex<len;elIndex++)0==(thisElement=animUnit.element[elIndex]).id.indexOf("tempAnimID_")&&thisElement.id;else 0==(thisElement=animUnit.element).id.indexOf("tempAnimID_")&&thisElement.id},WacAnimationEngine.prototype.StopCancelTimer=function(){null!=this.sharedCancelTimer&&(window.clearTimeout(this.sharedCancelTimer),this.sharedCancelTimer=null)},WacAnimationEngine.prototype.StartCancelTimer=function(){this.sharedCancelTimer=window.setTimeout(WacAnimationEngine.prototype.LocalStopper,this.resetInterval)};var g_WacRadix=10;function WacAnimation_State(){this.Index=0,this.Data=new Array(0),this.AnimateRight=!1}function WacAnimation_Object(animationID,delay,element,finalState,finishFunc,extraData){this.Initialize(animationID,delay,element,finalState,finishFunc,extraData)}function WacAnimationUnit(element,delay,duration,finishFunc,extraData,animateRight){this.Initialize(element,delay,duration,finishFunc,extraData,animateRight)}function WacAnimationTelemetry(){this.perfData=new Array(0),this.logData=new Array(0),this.animationStats=[],this.animationStatsIndex=0,this.perfDataIndex=0,this.logDataIndex=0,this.animationIndex=0,this.startTime=null,this.duration=null,this.numUnits=0,this.elementIds={},this.avgSessionFps=-1,this.countSessionFps=0,this.minSessionFps=-1,this.maxSessionFps=-1}WacAnimation_State.prototype={Index:0,Data:new Array(0),AnimateRight:!1},WacAnimation_State.prototype.SetAttribute=function(attributeID,value){var idx=this.GetDataIndex(attributeID);if(-1==idx){var n=this.Data.length;this.Index+=attributeID*Math.pow(g_WacRadix,n),this.Data[n]=value}else this.Data[idx]=value},WacAnimation_State.prototype.GetAttribute=function(attributeID){var idx=this.GetDataIndex(attributeID);return-1==idx?null:this.Data[idx]},WacAnimation_State.prototype.GetDataIndex=function(attributeID){for(var count=0,d=this.Index;0!=d;){if(d%g_WacRadix==attributeID)return count;d=Math.floor(d/g_WacRadix),count++}return-1},WacAnimation_State.prototype.SetAnimateRight=function(rightBool){this.AnimateRight=rightBool},WacAnimation_Object.prototype={animationID:-1,delay:0,element:null,finalState:null,finishFunc:null,extraData:null,arrAnimationUnits:null,idxAnimUnit:0,cachedContextVariables:null},WacAnimation_Object.prototype.Initialize=function(animationID,delay,element,finalState,finishFunc,extraData){if(IsNullOrUndef(element))throw"Argument Error: element cannot be null.";if(IsArrayCheck(element)&&!IsArrayCheck(finalState)||!IsArrayCheck(element)&&IsArrayCheck(finalState))throw"Argument Error: element and finalState counts do not match";this.animationID=animationID,this.delay=delay,this.element=element,this.finalState=finalState,this.finishFunc=finishFunc,this.extraData=extraData,this.arrAnimationUnits=new Array(0),this.idxAnimUnit=0,this.cachedContextVariables=g_AnimationContextVariables},WacAnimation_Object.prototype.GetIntWrapperValue=function(wacIntWrapper){return null==wacIntWrapper.contextId?wacIntWrapper.value:this.cachedContextVariables[wacIntWrapper.contextId].value},WacAnimation_Object.prototype.RunAnimation=function(){if(-1!=this.animationID&&null!=this.element){this.GenerateAnimationUnits();for(var len=this.arrAnimationUnits.length,i=0;i<len;i++)this.arrAnimationUnits[i].StartAnimation()}},WacAnimation_Object.prototype.AdvanceToFinalState=function(elIndex,animation){for(var finalValue=new WacAnimation_State,kfLen=animation.keyFrames.length,i=0;i<kfLen;i++){var keyframe=animation.keyFrames[i];finalValue.SetAttribute(keyframe.type,this.GetFinalValue(keyframe,elIndex))}for(var numAttrib=g_numAnimationAttributes,element=IsArrayCheck(this.element)?this.element[elIndex]:this.element,attrib=1;attrib<=numAttrib;attrib++){var value=finalValue.GetAttribute(attrib);if(null!=value)new WacAnimationUnit(element,0,0,null,null,this.finalState.AnimateRight).SetStyle(attrib,element,value)}},WacAnimation_Object.prototype.GenerateAnimationUnits=function(){for(var animation=g_WacAnimations[this.animationID],lastUnit=null,kfLen=animation.keyFrames.length,finalValue=null,i=0;i<kfLen;i++){var elIndex,len,keyframe=animation.keyFrames[i],match=this.FindMatchingAnimationUnit(keyframe);if(null!=match)if(match.startValue.SetAttribute(keyframe.type,this.GetIntWrapperValue(keyframe.startValue)),match.curveID.SetAttribute(keyframe.type,keyframe.curveID),IsArrayCheck(this.element))for(len=this.element.length,elIndex=0;elIndex<len;elIndex++){if(IsNullOrUndef(finalValue=this.GetFinalValue(keyframe,elIndex))){match.curveID.SetAttribute(keyframe.type,null);break}match.targetValue[elIndex].SetAttribute(keyframe.type,finalValue)}else IsNullOrUndef(finalValue=this.GetFinalValue(keyframe,-1))?match.curveID.SetAttribute(keyframe.type,null):match.targetValue.SetAttribute(keyframe.type,finalValue);else{var newUnit=new WacAnimationUnit(this.element,this.GetIntWrapperValue(keyframe.startTime)+this.delay,this.GetIntWrapperValue(keyframe.endTime)-this.GetIntWrapperValue(keyframe.startTime),null,null,this.finalState.AnimateRight);if(newUnit.startValue.SetAttribute(keyframe.type,this.GetIntWrapperValue(keyframe.startValue)),newUnit.curveID.SetAttribute(keyframe.type,keyframe.curveID),IsArrayCheck(this.element))for(len=this.element.length,elIndex=0;elIndex<len;elIndex++){if(null==newUnit.targetValue&&(newUnit.targetValue=new Array(this.element.length)),null==newUnit.targetValue[elIndex]&&(newUnit.targetValue[elIndex]=new WacAnimation_State),IsNullOrUndef(finalValue=this.GetFinalValue(keyframe,elIndex))){newUnit.curveID.SetAttribute(keyframe.type,null);break}newUnit.targetValue[elIndex].SetAttribute(keyframe.type,finalValue)}else null==newUnit.targetValue&&(newUnit.targetValue=new WacAnimation_State),IsNullOrUndef(finalValue=this.GetFinalValue(keyframe,-1))?newUnit.curveID.SetAttribute(keyframe.type,null):newUnit.targetValue.SetAttribute(keyframe.type,finalValue);(null==lastUnit||lastUnit.delay+lastUnit.duration<=newUnit.delay+newUnit.duration)&&(lastUnit=newUnit),this.arrAnimationUnits[this.idxAnimUnit++]=newUnit}}null!=lastUnit&&(lastUnit.finishFunc=this.finishFunc,lastUnit.extraData=this.extraData)},WacAnimation_Object.prototype.FindMatchingAnimationUnit=function(keyframe){for(var len=this.arrAnimationUnits.length,i=0;i<len;i++){var animUnit=this.arrAnimationUnits[i];if(animUnit.delay==this.GetIntWrapperValue(keyframe.startTime)+this.delay&&animUnit.duration==this.GetIntWrapperValue(keyframe.endTime)-this.GetIntWrapperValue(keyframe.startTime))return animUnit}return null},WacAnimation_Object.prototype.GetFinalValue=function(keyframe,iElement){var value=null;if(!IsNullOrUndef(this.GetIntWrapperValue(keyframe.endValue)))switch(keyframe.relativeTo){case 0:var element=IsArrayCheck(this.element)?this.element[iElement]:this.element,initialValue=null==this.GetIntWrapperValue(keyframe.startValue)?GetCurrentAttributeCssValue(element,keyframe.type,this.finalState.AnimateRight):this.GetIntWrapperValue(keyframe.startValue);value=0==keyframe.operationType?this.GetIntWrapperValue(keyframe.endValue)*initialValue:this.GetIntWrapperValue(keyframe.endValue)+initialValue;break;case 1:var finalValue=(IsArrayCheck(this.element)?this.finalState[iElement]:this.finalState).GetAttribute(keyframe.type);IsNullOrUndef(finalValue)||(value=0==keyframe.operationType?this.GetIntWrapperValue(keyframe.endValue)*finalValue:this.GetIntWrapperValue(keyframe.endValue)+finalValue);break;case 2:value=this.GetIntWrapperValue(keyframe.endValue)}return value},WacAnimationUnit.prototype={element:null,delay:0,duration:0,startValue:null,perElementStartValue:null,targetValue:null,curveID:null,finishFunc:null,extraData:null,startTime:null,fIsExecuting:!1,animateRight:!1,relativePosition:!1},WacAnimationUnit.prototype.Initialize=function(element,delay,duration,finishFunc,extraData,animateRight){this.element=element,this.delay=delay,this.duration=duration,this.finishFunc=finishFunc,this.extraData=extraData,this.startValue=new WacAnimation_State,this.perElementStartValue=null,this.targetValue=null,this.curveID=new WacAnimation_State,this.startTime=null,this.fIsExecuting=!1,this.animateRight=animateRight,this.relativePosition=!1},WacAnimationUnit.prototype.StartAnimation=function(){null==g_WacAnimationEngine&&(g_WacAnimationEngine=new WacAnimationEngine),null==g_WacAnimationEngine.sharedTimer&&g_WacAnimationEngine.StartEngine(),"relative"==this.element.style.position&&(this.relativePosition=!0),this.startTime=new Date,this.currentTime=new Date,g_WacAnimationEngine.StartAnimation(this)},WacAnimationUnit.prototype.StopAnimation=function(){g_WacAnimationEngine.StopAnimation(this)},WacAnimationUnit.prototype.StepAnimation=function(){this.currentTime=new Date;var elapsedTime=Number(this.currentTime)-Number(this.startTime);if(!(elapsedTime<this.delay)){elapsedTime-=this.delay;for(var done=!0,fFirstFrame=!this.fIsExecuting,numAttrib=g_numAnimationAttributes,attrib=1;attrib<=numAttrib;attrib++){var curveID=this.curveID.GetAttribute(attrib);if(!IsNullOrUndef(curveID)){var startVal,targetVal,newValue,thisElement,position=this.PositionFunction(elapsedTime,this.duration,curveID);if(IsArrayCheck(this.element))for(var len=this.element.length,elIndex=0;elIndex<len;elIndex++)thisElement=this.element[elIndex],startVal=this.startValue.GetAttribute(attrib),targetVal=this.targetValue[elIndex].GetAttribute(attrib),IsNullOrUndef(startVal)&&(null==this.perElementStartValue&&(this.perElementStartValue=new Array(this.element.length)),IsNullOrUndef(this.perElementStartValue[elIndex])&&(this.perElementStartValue[elIndex]=new WacAnimation_State),IsNullOrUndef(startVal=this.perElementStartValue[elIndex].GetAttribute(attrib))&&(startVal=GetCurrentAttributeCssValue(thisElement,attrib,this.animateRight,this.relativePosition),this.perElementStartValue[elIndex].SetAttribute(attrib,startVal))),newValue=startVal+position*(targetVal-startVal),elapsedTime>=this.duration||position>1?newValue=targetVal:done=!1,fFirstFrame&&g_WacAnimationEngine.CheckForConflictingAnimations(thisElement,attrib),this.SetStyle(attrib,thisElement,newValue);else thisElement=this.element,startVal=this.startValue.GetAttribute(attrib),targetVal=this.targetValue.GetAttribute(attrib),IsNullOrUndef(startVal)&&(startVal=GetCurrentAttributeCssValue(this.element,attrib,this.animateRight,this.relativePosition),this.startValue.SetAttribute(attrib,startVal)),newValue=startVal+position*(targetVal-startVal),elapsedTime>=this.duration||position>1?newValue=targetVal:done=!1,fFirstFrame&&g_WacAnimationEngine.CheckForConflictingAnimations(this.element,attrib),this.SetStyle(attrib,this.element,newValue)}}this.fIsExecuting=!0,done&&(this.StopAnimation(),null!=this.finishFunc&&(g_WacAnimationTelemetry.LogData("calling fnishfunc"),this.finishFunc(this.extraData)))}},WacAnimationUnit.prototype.PositionFunction=function(position,range,curveID){var retValue=0,curve=g_AnimationCurves[curveID];switch(curve.type){case 0:retValue=1;break;case 1:retValue=position<range?0:1;break;case 2:retValue=position/range;break;case 3:retValue=CalculateBezier(curve.x1,curve.y1,curve.x2,curve.y2,position/range)}return retValue},WacAnimationUnit.prototype.SetStyle=function(attribute,element,newValue){switch(g_WacAnimationTelemetry.elementIds[element.id]=!0,attribute){case 1:this.StyleLeftSetter(element,newValue);break;case 2:this.StyleTopSetter(element,newValue);break;case 3:this.StyleHeightSetter(element,newValue);break;case 4:this.StyleWidthSetter(element,newValue);break;case 5:this.StyleOpacitySetter(element,newValue);break;case 6:this.StyleScrollTopSetter(element,newValue);break;case 7:this.StyleScrollLeftSetter(element,newValue);break;case 8:this.StyleRotateZSetter(element,newValue)}},WacAnimationUnit.prototype.StyleLeftSetter=function(element,newValue){this.animateRight?this.relativePosition?element.style.marginRight=String(newValue)+"px":element.style.right=String(newValue)+"px":this.relativePosition?element.style.marginLeft=String(newValue)+"px":element.style.left=String(newValue)+"px",g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+element.id+", "+(this.animateRight?"right":"left")+": "+String(newValue)+", timestamp: "+String(Number(new Date)))},WacAnimationUnit.prototype.StyleTopSetter=function(element,newValue){this.relativePosition?element.style.marginTop=String(newValue)+"px":element.style.top=String(newValue)+"px",g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+element.id+", top: "+String(element.style.top)+", timestamp: "+String(Number(new Date)))},WacAnimationUnit.prototype.StyleHeightSetter=function(element,newValue){element.style.height=String(newValue)+"px",g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+element.id+", height: "+String(element.style.height)+", timestamp: "+String(Number(new Date)))},WacAnimationUnit.prototype.StyleWidthSetter=function(element,newValue){element.style.width=String(newValue)+"px",g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+element.id+", width: "+String(element.style.width)+", timestamp: "+String(Number(new Date)))},WacAnimationUnit.prototype.StyleOpacitySetter=function(element,newValue){SetCssOpacity(element,newValue),g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+element.id+", opacity: "+String(newValue)+", timestamp: "+String(Number(new Date)))},WacAnimationUnit.prototype.StyleScrollTopSetter=function(element,newValue){element.scrollTop=newValue,g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+element.id+", scrollTop: "+newValue+", timestamp: "+String(Number(new Date)))},WacAnimationUnit.prototype.StyleScrollLeftSetter=function(element,newValue){element.scrollLeft=newValue,g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+element.id+", scrollLeft: "+newValue+", timestamp: "+String(Number(new Date)))},WacAnimationUnit.prototype.StyleRotateZSetter=function(element,newValue){SetCssRotation(element,newValue),g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+element.id+", rotateZ: "+newValue+", timestamp: "+String(Number(new Date)))},WacAnimationTelemetry.prototype={perfData:null,logData:null,animationStatsLength:5,animationStats:null,animationStatsIndex:0,perfDataIndex:0,logDataIndex:0,animationIndex:0,startTime:null,duration:null,numUnits:0,elementIds:null,avgSessionFps:-1,countSessionFps:0,minSessionFps:-1,maxSessionFps:-1},WacAnimationTelemetry.prototype.Start=function(){this.startTime=new Date,this.perfDataIndex=0,this.logDataIndex=0,this.elementIds={}},WacAnimationTelemetry.prototype.Stop=function(){this.duration=Number(new Date)-Number(this.startTime),this.numUnits=g_WacAnimationEngine.sharedTimerRefs,this.CalculateAndShowStatistics(),this.perfDataIndex=0,this.logDataIndex=0},WacAnimationTelemetry.prototype.AddPerfData=function(time){this.perfData[this.perfDataIndex++]=time},WacAnimationTelemetry.prototype.LogData=function(data){this.logData[this.logDataIndex++]=data},WacAnimationTelemetry.prototype.CalculateStatistics=function(){var fps=0,min=Number.MAX_VALUE,max=Number.MIN_VALUE,avg=0,stddev=0,log="",all="",endTime=new Date,idStrings="",duration=this.duration;if(IsNullOrUndef(duration)&&(duration=Number(endTime)-Number(this.startTime)),g_WacAnimationLogging&&this.logDataIndex>0)for(var logIndex=this.logDataIndex,i=0;i<logIndex;i++)0!=i&&(log+="<br/>"),log+=this.logData[i];if(this.perfDataIndex>0){var perfIndex=this.perfDataIndex;for(i=0;i<perfIndex;i++)this.perfData[i]<min&&(min=this.perfData[i]),this.perfData[i]>max&&(max=this.perfData[i]),avg+=this.perfData[i],0!=i&&(all+=", "),all+=this.perfData[i];for(perfIndex>1&&(avg/=perfIndex-1),avg=Math.round(100*avg)/100,i=0;i<perfIndex;i++){var temp=this.perfData[i]-avg;stddev+=temp*=temp}perfIndex>1&&(stddev/=perfIndex-1),stddev=Math.sqrt(stddev),stddev=Math.round(100*stddev)/100,fps=this.perfDataIndex/duration*1e3,fps=Math.round(fps)}for(var id in this.elementIds)idStrings+=id,idStrings+=",";if((-1==this.minSessionFps||fps<this.minSessionFps)&&(this.minSessionFps=fps),(-1==this.maxSessionFps||fps>this.maxSessionFps)&&(this.maxSessionFps=fps),0==this.countSessionFps)this.countSessionFps++,this.avgSessionFps=fps;else{var totalFps=this.avgSessionFps*this.countSessionFps;totalFps+=fps,this.countSessionFps++,this.avgSessionFps=totalFps/this.countSessionFps}var stats=new Array(12);return stats[0]=duration,stats[1]=fps,stats[2]=min,stats[3]=max,stats[4]=avg,stats[5]=stddev,stats[6]=all,stats[7]=log,stats[8]=this.numUnits,stats[9]=Number(this.startTime),stats[10]=Number(endTime),stats[11]=idStrings,stats},WacAnimationTelemetry.prototype.CalculateAndShowStatistics=function(){var stats=this.CalculateStatistics();g_LastAnimationData=stats,this.StoreAnimationStats(stats)},WacAnimationTelemetry.prototype.StoreAnimationStats=function(stats){this.animationStats[this.animationStatsIndex]=stats,this.animationStatsIndex++,this.animationStatsIndex=this.animationStatsIndex%this.animationStatsLength},WacAnimationTelemetry.prototype.GetRecentAnimationStats=function(){for(var statArray=[],statArrayIndex=0,iStatsFirstPart=g_WacAnimationTelemetry.animationStatsIndex;iStatsFirstPart<g_WacAnimationTelemetry.animationStatsLength;iStatsFirstPart++)null!=g_WacAnimationTelemetry.animationStats[iStatsFirstPart]&&(statArray[statArrayIndex]=g_WacAnimationTelemetry.animationStats[iStatsFirstPart],statArrayIndex++);for(var iStatsSecondPart=0;iStatsSecondPart<g_WacAnimationTelemetry.animationStatsIndex;iStatsSecondPart++)null!=g_WacAnimationTelemetry.animationStats[iStatsSecondPart]&&(statArray[statArrayIndex]=g_WacAnimationTelemetry.animationStats[iStatsSecondPart],statArrayIndex++);return statArray},WacAnimationTelemetry.prototype.GetAnimationSqmStats=function(){var animationStats=[];return g_WacAnimationTelemetry.avgSessionFps<0?animationStats[0]=0:animationStats[0]=g_WacAnimationTelemetry.avgSessionFps,g_WacAnimationTelemetry.minSessionFps<0?animationStats[1]=0:animationStats[1]=g_WacAnimationTelemetry.minSessionFps,g_WacAnimationTelemetry.maxSessionFps<0?animationStats[2]=0:animationStats[2]=g_WacAnimationTelemetry.maxSessionFps,animationStats};var g_WacAnimationTelemetry=new WacAnimationTelemetry,g_LastAnimationData=null;function GetCurrentAttributeCssValue(element,attribute,animateRight,relativePosition){IsNullOrUndef(relativePosition)&&(relativePosition="relative"==element.style.position);var currentValue=0;switch(attribute){case 1:currentValue=animateRight?parseInt(relativePosition?element.style.marginRight.replace("px",""):element.style.right.replace("px","")):parseInt(relativePosition?element.style.marginLeft.replace("px",""):element.style.left.replace("px",""));break;case 2:currentValue=parseInt(relativePosition?element.style.marginTop.replace("px",""):element.style.top.replace("px",""));break;case 3:currentValue=parseInt(element.style.height.replace("px",""));break;case 4:currentValue=parseInt(element.style.width.replace("px",""));break;case 5:currentValue=GetCssOpacity(element);break;case 6:currentValue=parseInt(element.scrollTop);break;case 7:currentValue=parseInt(element.scrollLeft);break;case 8:currentValue=GetCssRotation(element)}return currentValue}function Bezier1(t){return t*t*t}function Bezier2(t){return 3*t*t*(1-t)}function Bezier3(t){return 3*t*(1-t)*(1-t)}function Bezier4(t){return(1-t)*(1-t)*(1-t)}function CalculateBezier(x1,y1,x2,y2,t){return 0*Bezier4(t)+y1*Bezier3(t)+y2*Bezier2(t)+1*Bezier1(t)}function IsArrayCheck(input){return"object"==typeof input&&input instanceof Array}function IsNullOrUndef(value){return null==value||null==value}function SetCssOpacity(element,value){null!=document.body.style.opacity?element.style.opacity=value:element.style.filter=1==value?"":"alpha(opacity="+String(100*value)+")"}function GetCssOpacity(element){if(null!=document.body.style.opacity){var o=element.style.opacity;return null!=o&&""!=o?parseFloat(o):1}var f=element.style.filter;return null!=f&&""!=f?parseInt(f.replace("alpha(opacity=","").replace(")",""))/100:1}function SetCssRotation(element,value){var transformValue="rotate("+value+"deg)";null!=document.body.style.msTransform?element.style.msTransform=transformValue:null!=document.body.style.webkitTransform?element.style.webkitTransform=transformValue:null!=document.body.style.mozTransform?element.style.mozTransform=transformValue:null!=document.body.style.oTransform?element.style.oTransform=transformValue:null!=document.body.style.transform&&(element.style.transform=transformValue)}function GetCssRotation(element){var rotation;return null!=document.body.style.msTransform?rotation=element.style.msTransform:null!=document.body.style.webkitTransform?rotation=element.style.webkitTransform:null!=document.body.style.mozTransform?rotation=element.style.mozTransform:null!=document.body.style.oTransform?rotation=element.style.oTransform:null!=document.body.style.transform&&(rotation=element.style.transform),rotation?(rotation=(rotation=rotation.replace("rotate(","")).replace("deg)",""),parseFloat(rotation)):0}WacAnimation.Telemetry=g_WacAnimationTelemetry;