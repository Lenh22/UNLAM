var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_consappdata_start"),(self["suiteux_shell_webpackJsonp_suiteux-bootstrapper"]=self["suiteux_shell_webpackJsonp_suiteux-bootstrapper"]||[]).push([["consappdata"],{9227:function(e,o,t){t.r(o),t.d(o,{loadConsumerAppData:function(){return O}});var l=t(6968),n=t(8982);const s="auth=1";function r(e,o,t,l,r,i,c){const h=encodeURIComponent(o),u=r?encodeURIComponent(r):"",m=r?"login_hint="+u:void 0,p="https://www.microsoft365.com",d="https://outlook.com";let f=m?d+"?"+m:d;const S="https://outlook.live.com/calendar/";let g=m?S+"?"+m:S;const w="https://onedrive.live.com";let C=m?w+"?"+m:w;const _=p+"/launch/word?"+["username="+h,s].join("&");let O=m?_+"&"+m:_;const P=p+"/launch/excel?"+["username="+h,s].join("&");let E=m?P+"&"+m:P;const y=p+"/launch/powerpoint?"+["username="+h,s].join("&");let v=m?y+"&"+m:y;let L="https://www.onenote.com/notebooks?"+s,D="https://to-do.microsoft.com/tasks/?auth=1";let I="https://web.skype.com/?source=owa";const F="https://teams.live.com/?utm_source=OfficeWeb",N="https://app.clipchamp.com/signup/microsoft?utm_source=m365&utm_medium=office&utm_campaign=appswaffle",U="https://designer.microsoft.com/",k="https://copilot.microsoft.com/&form=applnr";if({NODE_ENV:"production",__DEV__:!1,BUILD_BUILDNUMBER:"1.20250418.3.0"}.STANDALONE_APP_LAUNCHER&&"EdgeNewsNTP"===l&&(t?(O=p+"/launch/word?"+s,E=p+"/launch/excel?"+s,v=p+"/launch/powerpoint?"+s):(f="https://www.microsoft.com/microsoft-365/outlook/email-and-calendar-software-microsoft-outlook",C="https://www.microsoft.com/microsoft-365/onedrive/online-cloud-storage",O="https://www.microsoft.com/microsoft-365/word",E="https://www.microsoft.com/microsoft-365/excel",v="https://www.microsoft.com/microsoft-365/powerpoint",L="https://www.microsoft.com/microsoft-365/onenote/digital-note-taking-app",D="https://www.microsoft.com/microsoft-365/microsoft-to-do-list-app",g="https://www.microsoft.com/microsoft-365/outlook/email-and-calendar-software-microsoft-outlook",I="https://www.skype.com/")),null==i?void 0:i.NewWXPHomePagesEnabled){const{wordOnlineUrl:e,excelOnlineUrl:o,powerPointOnlineUrl:t}=(0,n.eD)(l,c,r,null==i?void 0:i.LoginHintEnabledForNewWXPHomePages);O=e,E=o,v=t}let A;return A=(null==i?void 0:i.UpdatedConsumerAppList)?[...(null==i?void 0:i.CopilotEnabledForConsumer)?[a("ShellCopilotBusinessChat",e.Copilot,k)]:[],a("ShellMail",e.Outlook,f),a("ShellDocuments",e.OneDrive,C),a("ShellClipchamp",e.Clipchamp,N),a("ShellDesigner",e.Designer,U),a("ShellWordOnline",e.WordOnline,O),a("ShellExcelOnline",e.ExcelOnline,E),a("ShellPowerPointOnline",e.PowerPointOnline,v),a("ShellOneNoteOnline",e.OneNoteOnline,L),a("ShellOfficeForms",e.Forms,"https://forms.office.com/Pages/DesignPageV2.aspx"),a("ShellCalendar",e.Calendar,g),a("ShellToDo",e.ToDo,D),a("ShellTeams",e.Teams,F),...(null==i?void 0:i.SkypeConsumerAppWaffleDisabled)?[]:[a("ShellSkype",e.Skype,I)]].filter((e=>null!=e)):[...(null==i?void 0:i.CopilotEnabledForConsumer)?[a("ShellCopilotBusinessChat",e.Copilot,k)]:[],a("ShellMail",e.Outlook,f),a("ShellDocuments",e.OneDrive,C),a("ShellTeams",e.Teams,F),a("ShellWordOnline",e.WordOnline,O),a("ShellExcelOnline",e.ExcelOnline,E),a("ShellPowerPointOnline",e.PowerPointOnline,v),a("ShellOneNoteOnline",e.OneNoteOnline,L),a("ShellToDo",e.ToDo,D),a("ShellFamilySafety",e.FamilySafety,"https://account.microsoft.com/family"),a("ShellCalendar",e.Calendar,g),a("ShellClipchamp",e.Clipchamp,N),a("ShellDesigner",e.Designer,U),...(null==i?void 0:i.SkypeConsumerAppWaffleDisabled)?[]:[a("ShellSkype",e.Skype,I)]].filter((e=>null!=e)),A}function i(e,o,t,l,n,s){const r=encodeURIComponent(o),i=n?encodeURIComponent(n):"",c=n?"login_hint="+i:void 0,h="https://www.microsoft365.com",u=h+"?auth=1&from=ShellNav";let m=c?u+"&"+c:u,p="https://outlook.live.com/people/",d=o?"https://sway.office.com/?auth_pvr=WindowsLiveId&auth_upn="+r:"https://sway.com",f="https://flow.microsoft.com/manage/?auth_upn="+r+"&utm_source=consumer_office&utm_medium=%7Bmedium%7D&utm_campaign=consumer_referrals",S="https://forms.office.com/Pages/DesignPageV2.aspx";({NODE_ENV:"production",__DEV__:!1,BUILD_BUILDNUMBER:"1.20250418.3.0"}).STANDALONE_APP_LAUNCHER&&"EdgeNewsNTP"===l&&(t?(d="https://sway.office.com/?auth_pvr=WindowsLiveId",f="https://flow.microsoft.com/manage/?utm_source=consumer_office&utm_medium=%7Bmedium%7D&utm_campaign=consumer_referrals",S="https://forms.office.com/Pages/DesignPageV2.aspx"):(m=h+"/?auth=1&from=ShellNav",p="https://www.microsoft.com/microsoft-365/outlook/email-and-calendar-software-microsoft-outlook",d="https://sway.office.com",f="https://flow.microsoft.com",S="https://forms.office.com/Pages/DesignPageV2.aspx"));const g=[a("ShellPeople",e.People,p),a("ShellSway",e.Sway,d),a("ShellLogicFlows",e.Flow,f),a("ShellLists",e.Lists,"https://lists.live.com/?ocid=cmmovh5r9x5"),a("ShellLoop",e.Loop,"https://loop.microsoft.com/")];return(null==s?void 0:s.UpdatedConsumerAppList)||g.push(a("ShellOfficeForms",e.Forms,S)),g}function c(e,o){const t=[h("ShellBing",e.Bing,"https://www.bing.com/?FORM=MO0027",!0,e.Microsoft,"MoreFirstParty"),h("ShellMSN",e.MSN,"https://www.msn.com/?OCID=cmmgltaajc1",!0,e.Microsoft,"MoreFirstParty"),h("ShellPrivacy",e.Privacy,"https://account.microsoft.com/privacy/",!0,e.Microsoft,"MoreFirstParty"),h("ShellRewards",e.Rewards,"https://rewards.bing.com/",!0,e.Microsoft,"MoreFirstParty")];return(null==o?void 0:o.UpdatedConsumerAppList)&&t.push(h("ShellFamilySafety",e.FamilySafety,"https://account.microsoft.com/family",!0,e.Microsoft,"MoreFirstParty")),t}function a(e,o,t,l){return{Id:e,Text:o,Title:o,Url:t,FontIconCss:u(e),BackgroundColor:m(e),TargetWindow:l||"_blank"}}function h(e,o,t,l,n,s="FirstParty"){return{CollectorId:s,Id:0===e.indexOf("Shell")?e.substr(5):e,Title:o,AriaLabel:o,Publisher:n,FontIconCss:u(e),BackgroundColor:m(e),LaunchFullUrl:t,IsAutoPinnedDisabled:l,CustomActions:[{ActionVerb:1},{ActionVerb:2}]}}function u(e){return"ms-Icon--"+function(e){switch(e){case"ShellMail":return"OutlookLogo";case"ShellCalendar":return"Calendar";case"ShellPeople":return"People";case"ShellDocuments":return"OneDrive";case"ShellToDo":return"ToDoLogoInverse";case"ShellWordOnline":return"WordLogo";case"ShellExcelOnline":return"ExcelLogo";case"ShellPowerPointOnline":return"PowerPointLogo";case"ShellOneNoteOnline":return"OneNoteLogo";case"ShellSway":return"SwayLogo32";case"ShellBing":return"BingLogo";case"ShellMSN":return"MSNLogo";case"ShellSkype":return"SkypeLogo";case"ShellLogicFlows":return"MicrosoftFlowLogo";case"ShellOfficeForms":return"OfficeFormsLogo";case"ShellPrivacy":return"PrivacyLogo";case"ShellRewards":return"RewardsLogo";case"ShellFamilySafety":return"FamilySafetyLogo";case"ShellTeams":return"TeamsLogo";case"ShellClipchamp":return"ClipchampLogo";case"ShellLists":return"ListsLogo";case"ShellDesigner":return"DesignerLogo";case"ShellLoop":return"LoopLogo";case"ShellCopilotBusinessChat":return"CopilotLogo";default:return"CircleFill"}}(e)}function m(e){switch(e){case"ShellDocuments":return"#094ab2";case"ShellWordOnline":return"#2b579a";case"ShellExcelOnline":return"#217346";case"ShellPowerPointOnline":return"#d24726";case"ShellOneNoteOnline":return"#80397b";case"ShellSway":case"ShellOfficeForms":return"#008272";case"ShellBing":return"#0C8484";case"ShellMSN":return"#1e1e1e";case"ShellSkype":return"#00AFF0";case"ShellLogicFlows":return"#0077FF";case"ShellFamilySafety":case"ShellClipchamp":return"#0C9D8C";case"ShellTeams":return"#6264A7";case"ShellLists":return"#974B8B";case"ShellDesigner":return"#972ADB";case"ShellLoop":return"#8230FF";default:return"#0072c6"}}function p(e){const o=[];for(let t=0;t<e.length;++t){const l=("00"+e[t].toString(16)).slice(-2);o.push(l)}return o.join("")}function d(e){const o=function(e){const o=new Uint16Array(e.length);for(let t=0;t<e.length;t++)o[t]=e.charCodeAt(t);return new Uint8Array(o)}(JSON.stringify(e));try{return crypto.subtle.digest("sha-256",o).then((e=>p(new Uint8Array(e))))}catch(e){return Promise.resolve(p(o))}}class f{constructor(e){this.localStorageKey=e}readCache(){return JSON.parse(localStorage.getItem(this.localStorageKey)||"{}")}writeCache(e){localStorage.setItem(this.localStorageKey,JSON.stringify(e))}getValue(e){return new Promise(((o,t)=>{d(e).then((e=>{const l=this.readCache(),n=l[e];n?n.expiryTime<Date.now()?(delete l[e],this.writeCache(l),t("Expired")):o(n.value):t("EntryNotFound")}))}))}setValue(e,o,t){return new Promise(((l,n)=>{d(e).then((e=>{try{const l=Date.now()+t,n=this.readCache();n[e]={expiryTime:l,value:o},this.writeCache(n)}catch(e){e instanceof DOMException?n("WriteFailedQuotaExceeded"):n("WriteFailedOther")}})).then((()=>l(o)))}))}}const S="OneShellECSClient";class g{constructor(){this.CONFIG_CACHE_KEY="O365Shell_ECS_config",this.CONFIG_TIME_TO_LIVE=864e5,this.ECS_PROJECT="OneShell",this.ECS_BASE_URI=`https://ecs.office.com/config/v1/${this.ECS_PROJECT}/1.0.0.0`,this.getConfigCalled=!1,this.cache=new f(this.CONFIG_CACHE_KEY)}getUri(){const e="?agents="+encodeURIComponent(`${this.ECS_PROJECT}`);return this.ECS_BASE_URI+e+Object.keys(this.model).reduce(((e,o)=>`${e}&${encodeURIComponent(o)}=${encodeURIComponent(this.model[o])}`),"")}fetchConfig(){(0,l.tZ)().perfMarker("shell_ecs_fetch_start");return new Promise(((e,o)=>{fetch(this.getUri()).then((e=>((0,l.tZ)().perfMarker("shell_ecs_fetch_end"),e.json()))).then((t=>{t.OneShell?(this.cacheConfig(t),e(t)):o("Invalid ECS config received")})).catch((e=>{(0,l.tZ)().exception("ECS_GetECSConfig_Failed",6,e)}))}))}cacheConfig(e){this.cache.setValue(this.model,e,this.CONFIG_TIME_TO_LIVE)}getCachedConfig(){return this.cache.getValue(this.model).catch((()=>this.config))}logConfigIds(e){var o;const t=null===(o=null==e?void 0:e.ConfigIDs)||void 0===o?void 0:o[this.ECS_PROJECT];(0,l.tZ)().tag("ECS_ConfigIds",1,t),(0,l.tZ)().registerContextParam("Context_ECS_FlightIds",t,0)}setModel(e){this.model=e,this.config=this.fetchConfig()}getConfig(e=2e3){if(!this.model)return(0,l.tZ)().tag("ECS_No_User_Model",1),Promise.resolve({});const o=new Promise(((o,t)=>{setTimeout((()=>{t(new Error(`ECS getConfig timedout after ${e}`))}),e)}));return Promise.race([this.getCachedConfig(),this.config,o]).then((e=>(this.getConfigCalled||(this.getConfigCalled=!0,this.logConfigIds(e)),e.OneShell))).catch((e=>((0,l.tZ)().exception("ECS_GetECSConfig_Failed",6,e),Promise.resolve({}))))}}const w=()=>(window[S]||(()=>{if(!localStorage)return void(0,l.tZ)().exception("ECS_InitECS_Failed",4,new Error("Localstorage is not available"));const e=(o,t)=>{const{TID:n,UPN:s,IsConsumerShell:r,WorkloadId:i,UID:c}=t;if(t.EnableClientECSFetch||r){const e={IsConsumer:r,WorkloadId:i,TenantId:n,UserId:r?s:c,UPN:s};window[S].setModel(e)}(0,l.NP)().unsubscribe("ShellDataUpdated",e)};window[S]=new g,(0,l.NP)().subscribe("ShellDataUpdated",e,!0)})(),window[S]);let C,_;function O(e,o,t,n){const s="https://www.microsoft365.com";if(void 0===C)try{w().getConfig().then((l=>{l&&l.UpdatedConsumerAppList?(C=!0,_=l,O(e,o,t,n)):l&&!0===o.ShowUpdatedConsumerAppList?(l.UpdatedConsumerAppList=!0,a(e,o,t,l)):a(e,o,t,_)})).catch((()=>{a(e,o,t,_)}))}catch(l){a(e,o,t,_)}else a(e,o,t,_);function a(e,o,t,a){var h,u;const m=Object.assign(Object.assign({},e),{WorkloadLinks:r(n,o.UPN,o.PUID,o.WorkloadId,null===(h=null==t?void 0:t.shellAuthProviderConfig)||void 0===h?void 0:h.login_Hint,a,e.CurrentMainLinkElementID),AppsLinks:i(n,o.UPN,o.PUID,o.WorkloadId,null===(u=null==t?void 0:t.shellAuthProviderConfig)||void 0===u?void 0:u.login_Hint,a),LogoNavigationUrl:s+"?auth=1&from=ShellNav"}),p=Object.assign(Object.assign({},o),{AppDataCache:c(n,a),AppGalleryUrl:s+"/apps?auth=1&home=1"});return(0,l.NP)().invoke("ShellDataUpdated",m,p,t),p}}t.nc=window.oneShellUxNonce}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_consappdata_end"),shellPerformance.measure("shell_consappdata","shell_consappdata_start","shell_consappdata_end"));