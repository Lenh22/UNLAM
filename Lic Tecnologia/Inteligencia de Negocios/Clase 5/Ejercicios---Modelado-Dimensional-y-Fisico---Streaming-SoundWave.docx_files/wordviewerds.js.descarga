try{var _globalThis,_dullscriptWebpackJsonp;(_globalThis=globalThis)[_dullscriptWebpackJsonp="dullscriptWebpackJsonp"]||(_globalThis[_dullscriptWebpackJsonp]=[]),globalThis.qwtManifest_WordViewerDS={...globalThis.qwtManifest_WordViewerDS,0:"WordViewerDS.js",1:"WordViewerDS.dialog.js",2:"WordViewerDS.dll1.js",3:"WordViewerDS.immersive-reader-sdk.js",4:"WordViewerDS.inProductMessagingActor.js",5:"WordViewerDS.objectmodel.js",6:"WordViewerDS.prefetch.js"},globalThis.dullscriptWebpackJsonp.push=function(e){return function(...t){const n=e.apply(this,t),a=t[0]?.[0]?.[0],i=a&&globalThis.qwtManifest_WordViewerDS[a];return i&&window.dispatchEvent(new CustomEvent("qwt_onChunkLoaded",{detail:{fileName:i}})),n}}(globalThis.dullscriptWebpackJsonp.push)}catch(e){console.error("QuietWindowTrackingPlugin injection failed:",e)}(function(){var __webpack_modules__={9457:function(e,t,n){"use strict";function a(e,t,n){return s(e,1,t,n)}function i(e,t,n){return s(e,2,t,n)}function o(e,t,n){return s(e,3,t,n)}function r(e,t,n){return s(e,0,t,n)}function s(e,t,n,a){return{name:e,dataType:t,value:n,classification:a||4}}n.d(t,{a:function(){return a},b:function(){return o},c:function(){return i},d:function(){return r}})},4607:function(e,t,n){"use strict";n.d(t,{a:function(){return s},b:function(){return r},c:function(){return o}});var a,i=(a=[],{fireEvent:function(e){a.forEach((function(t){return t(e)}))},addListener:function(e){e&&a.push(e)}});function o(){return i}function r(e,t,n){i.fireEvent({level:e,category:t,message:n})}function s(e,t,n){r(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}},8542:function(e,t,n){"use strict";var a;n.d(t,{a:function(){return a}}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(a||(a={}))},83:function(e,t){"use strict";t.byteLength=function(e){var t=s(e),n=t[0],a=t[1];return 3*(n+a)/4-a},t.toByteArray=function(e){var t,n,o=s(e),r=o[0],l=o[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,r,l)),d=0,u=l>0?r-4:r;for(n=0;n<u;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;2===l&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,c[d++]=255&t);1===l&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t);return c},t.fromByteArray=function(e){for(var t,a=e.length,i=a%3,o=[],r=16383,s=0,c=a-i;s<c;s+=r)o.push(l(e,s,s+r>c?c:s+r));1===i?(t=e[a-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[a-2]<<8)+e[a-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],a=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0;r<64;++r)n[r]=o[r],a[o.charCodeAt(r)]=r;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,a){for(var i,o,r=[],s=t;s<a;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),r.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return r.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},7726:function(e,t,n){"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const a=n(83),i=n(6942),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.a=l,t.b=50;const r=2147483647;function s(e){if(e>r)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|m(e,t);let a=s(n);const i=a.write(e,t);i!==n&&(a=a.slice(0,i));return a}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Z(e,Uint8Array)){const t=new Uint8Array(e);return g(t.buffer,t.byteOffset,t.byteLength)}return p(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Z(e,ArrayBuffer)||e&&Z(e.buffer,ArrayBuffer))return g(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(Z(e,SharedArrayBuffer)||e&&Z(e.buffer,SharedArrayBuffer)))return g(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const a=e.valueOf&&e.valueOf();if(null!=a&&a!==e)return l.from(a,t,n);const i=function(e){if(l.isBuffer(e)){const t=0|h(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||X(e.length)?s(0):p(e);if("Buffer"===e.type&&Array.isArray(e.data))return p(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return d(e),s(e<0?0:0|h(e))}function p(e){const t=e.length<0?0:0|h(e.length),n=s(t);for(let a=0;a<t;a+=1)n[a]=255&e[a];return n}function g(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let a;return a=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(a,l.prototype),a}function h(e){if(e>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return 0|e}function m(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Z(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(i)return a?-1:K(e).length;t=(""+t).toLowerCase(),i=!0}}function _(e,t,n){let a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,n);case"utf8":case"utf-8":return F(this,t,n);case"ascii":return E(this,t,n);case"latin1":case"binary":return M(this,t,n);case"base64":return w(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function S(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function f(e,t,n,a,i){if(0===e.length)return-1;if("string"==typeof n?(a=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),X(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,a)),l.isBuffer(t))return 0===t.length?-1:C(e,t,n,a,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):C(e,[t],n,a,i);throw new TypeError("val must be string, number or Buffer")}function C(e,t,n,a,i){let o,r=1,s=e.length,l=t.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||t.length<2)return-1;r=2,s/=2,l/=2,n/=2}function c(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}if(i){let a=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===l)return a*r}else-1!==a&&(o-=o-a),a=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){let n=!0;for(let a=0;a<l;a++)if(c(e,o+a)!==c(t,a)){n=!1;break}if(n)return o}return-1}function y(e,t,n,a){n=Number(n)||0;const i=e.length-n;a?(a=Number(a))>i&&(a=i):a=i;const o=t.length;let r;for(a>o/2&&(a=o/2),r=0;r<a;++r){const a=parseInt(t.substr(2*r,2),16);if(X(a))return r;e[n+r]=a}return r}function A(e,t,n,a){return j(K(t,e.length-n),e,n,a)}function b(e,t,n,a){return j(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,a)}function T(e,t,n,a){return j(z(t),e,n,a)}function v(e,t,n,a){return j(function(e,t){let n,a,i;const o=[];for(let r=0;r<e.length&&!((t-=2)<0);++r)n=e.charCodeAt(r),a=n>>8,i=n%256,o.push(i),o.push(a);return o}(t,e.length-n),e,n,a)}function w(e,t,n){return 0===t&&n===e.length?a.fromByteArray(e):a.fromByteArray(e.slice(t,n))}function F(e,t,n){n=Math.min(e.length,n);const a=[];let i=t;for(;i<n;){const t=e[i];let o=null,r=t>239?4:t>223?3:t>191?2:1;if(i+r<=n){let n,a,s,l;switch(r){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(o=l));break;case 3:n=e[i+1],a=e[i+2],128==(192&n)&&128==(192&a)&&(l=(15&t)<<12|(63&n)<<6|63&a,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:n=e[i+1],a=e[i+2],s=e[i+3],128==(192&n)&&128==(192&a)&&128==(192&s)&&(l=(15&t)<<18|(63&n)<<12|(63&a)<<6|63&s,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,r=1):o>65535&&(o-=65536,a.push(o>>>10&1023|55296),o=56320|1023&o),a.push(o),i+=r}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let n="",a=0;for(;a<t;)n+=String.fromCharCode.apply(String,e.slice(a,a+=I));return n}(a)}l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return d(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},l.allocUnsafe=function(e){return u(e)},l.allocUnsafeSlow=function(e){return u(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(Z(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),Z(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,a=t.length;for(let i=0,o=Math.min(n,a);i<o;++i)if(e[i]!==t[i]){n=e[i],a=t[i];break}return n<a?-1:a<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const a=l.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(Z(t,Uint8Array))i+t.length>a.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(a,i)):Uint8Array.prototype.set.call(a,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(a,i)}i+=t.length}return a},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)S(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?F(this,0,e):_.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.b;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,n,a,i){if(Z(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===a&&(a=0),void 0===i&&(i=this.length),t<0||n>e.length||a<0||i>this.length)throw new RangeError("out of range index");if(a>=i&&t>=n)return 0;if(a>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(a>>>=0),r=(n>>>=0)-(t>>>=0);const s=Math.min(o,r),c=this.slice(a,i),d=e.slice(t,n);for(let e=0;e<s;++e)if(c[e]!==d[e]){o=c[e],r=d[e];break}return o<r?-1:r<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return f(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return f(this,e,t,n,!1)},l.prototype.write=function(e,t,n,a){if(void 0===t)a="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)a=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===a&&(a="utf8")):(a=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");let o=!1;for(;;)switch(a){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return A(this,e,t,n);case"ascii":case"latin1":case"binary":return b(this,e,t,n);case"base64":return T(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function E(e,t,n){let a="";n=Math.min(e.length,n);for(let i=t;i<n;++i)a+=String.fromCharCode(127&e[i]);return a}function M(e,t,n){let a="";n=Math.min(e.length,n);for(let i=t;i<n;++i)a+=String.fromCharCode(e[i]);return a}function k(e,t,n){const a=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>a)&&(n=a);let i="";for(let a=t;a<n;++a)i+=J[e[a]];return i}function P(e,t,n){const a=e.slice(t,n);let i="";for(let e=0;e<a.length-1;e+=2)i+=String.fromCharCode(a[e]+256*a[e+1]);return i}function D(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,a,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+a>e.length)throw new RangeError("Index out of range")}function x(e,t,n,a,i){V(t,a,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let r=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=r,r>>=8,e[n++]=r,r>>=8,e[n++]=r,r>>=8,e[n++]=r,n}function L(e,t,n,a,i){V(t,a,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let r=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=r,r>>=8,e[n+2]=r,r>>=8,e[n+1]=r,r>>=8,e[n]=r,n+8}function U(e,t,n,a,i,o){if(n+a>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(e,t,n,a,o){return t=+t,n>>>=0,o||U(e,0,n,4),i.write(e,t,n,a,23,4),n+4}function B(e,t,n,a,o){return t=+t,n>>>=0,o||U(e,0,n,8),i.write(e,t,n,a,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const a=this.subarray(e,t);return Object.setPrototypeOf(a,l.prototype),a},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let a=this[e],i=1,o=0;for(;++o<t&&(i*=256);)a+=this[e+o]*i;return a},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let a=this[e+--t],i=1;for(;t>0&&(i*=256);)a+=this[e+--t]*i;return a},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=Y((function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Q(e,this.length-8);const a=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(a)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=Y((function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Q(e,this.length-8);const a=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(a)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let a=this[e],i=1,o=0;for(;++o<t&&(i*=256);)a+=this[e+o]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let a=t,i=1,o=this[e+--a];for(;a>0&&(i*=256);)o+=this[e+--a]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=Y((function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Q(e,this.length-8);const a=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(a)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=Y((function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Q(e,this.length-8);const a=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(a)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,a){if(e=+e,t>>>=0,n>>>=0,!a){R(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,a){if(e=+e,t>>>=0,n>>>=0,!a){R(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=Y((function(e,t=0){return x(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=Y((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,a){if(e=+e,t>>>=0,!a){const a=Math.pow(2,8*n-1);R(this,e,t,n,a-1,-a)}let i=0,o=1,r=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===r&&0!==this[t+i-1]&&(r=1),this[t+i]=(e/o>>0)-r&255;return t+n},l.prototype.writeIntBE=function(e,t,n,a){if(e=+e,t>>>=0,!a){const a=Math.pow(2,8*n-1);R(this,e,t,n,a-1,-a)}let i=n-1,o=1,r=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===r&&0!==this[t+i+1]&&(r=1),this[t+i]=(e/o>>0)-r&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=Y((function(e,t=0){return x(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=Y((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return O(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return O(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,a){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),a>0&&a<n&&(a=n),a===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-n&&(a=e.length-t+n);const i=a-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,a):Uint8Array.prototype.set.call(e,this.subarray(n,a),t),i},l.prototype.fill=function(e,t,n,a){if("string"==typeof e){if("string"==typeof t?(a=t,t=0,n=this.length):"string"==typeof n&&(a=n,n=this.length),void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!l.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(1===e.length){const t=e.charCodeAt(0);("utf8"===a&&t<128||"latin1"===a)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=l.isBuffer(e)?e:l.from(e,a),r=o.length;if(0===r)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%r]}return this};const N={};function W(e,t,n){N[e]=class extends n{get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}}}function H(e){let t="",n=e.length;const a="-"===e[0]?1:0;for(;n>=a+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function V(e,t,n,a,i,o){if(e>n||e<t){const a="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${a} and < 2${a} ** ${8*(o+1)}${a}`:`>= -(2${a} ** ${8*(o+1)-1}${a}) and < 2 ** ${8*(o+1)-1}${a}`:`>= ${t}${a} and <= ${n}${a}`,new N.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){G(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||Q(t,e.length-(n+1))}(a,i,o)}function G(e,t){if("number"!=typeof e)throw new N.ERR_INVALID_ARG_TYPE(t,"number",e)}function Q(e,t,n){if(Math.floor(e)!==e)throw G(e,n),new N.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new N.ERR_BUFFER_OUT_OF_BOUNDS;throw new N.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}W("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),W("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),W("ERR_OUT_OF_RANGE",(function(e,t,n){let a=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=H(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=H(i)),i+="n"),a+=` It must be ${t}. Received ${i}`,a}),RangeError);const q=/[^+/0-9A-Za-z-_]/g;function K(e,t){let n;t=t||1/0;const a=e.length;let i=null;const o=[];for(let r=0;r<a;++r){if(n=e.charCodeAt(r),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(r+1===a){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(e){return a.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,n,a){let i;for(i=0;i<a&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Z(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function X(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const a=16*n;for(let i=0;i<16;++i)t[a+i]=e[n]+e[i]}return t}();function Y(e){return"undefined"==typeof BigInt?$:e}function $(){throw new Error("BigInt not supported")}},9502:function(e){/*! @license DOMPurify 2.5.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.7/LICENSE */e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,n){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,n)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function a(e,i,o){return a=n()?Reflect.construct:function(e,n,a){var i=[null];i.push.apply(i,n);var o=new(Function.bind.apply(e,i));return a&&t(o,a.prototype),o},a.apply(null,arguments)}function i(e){return o(e)||r(e)||s(e)||c()}function o(e){if(Array.isArray(e))return l(e)}function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function s(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d=Object.hasOwnProperty,u=Object.setPrototypeOf,p=Object.isFrozen,g=Object.getPrototypeOf,h=Object.getOwnPropertyDescriptor,m=Object.freeze,_=Object.seal,S=Object.create,f="undefined"!=typeof Reflect&&Reflect,C=f.apply,y=f.construct;C||(C=function(e,t,n){return e.apply(t,n)}),m||(m=function(e){return e}),_||(_=function(e){return e}),y||(y=function(e,t){return a(e,i(t))});var A=D(Array.prototype.forEach),b=D(Array.prototype.pop),T=D(Array.prototype.push),v=D(String.prototype.toLowerCase),w=D(String.prototype.toString),F=D(String.prototype.match),I=D(String.prototype.replace),E=D(String.prototype.indexOf),M=D(String.prototype.trim),k=D(RegExp.prototype.test),P=R(TypeError);function D(e){return function(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return C(e,t,a)}}function R(e){return function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return y(e,n)}}function x(e,t,n){var a;n=null!==(a=n)&&void 0!==a?a:v,u&&u(e,null);for(var i=t.length;i--;){var o=t[i];if("string"==typeof o){var r=n(o);r!==o&&(p(t)||(t[i]=r),o=r)}e[o]=!0}return e}function L(e){var t,n=S(null);for(t in e)!0===C(d,e,[t])&&(n[t]=e[t]);return n}function U(e,t){for(;null!==e;){var n=h(e,t);if(n){if(n.get)return D(n.get);if("function"==typeof n.value)return D(n.value)}e=g(e)}function a(e){return console.warn("fallback value for",e),null}return a}var O=m(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),B=m(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),N=m(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),W=m(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),H=m(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),V=m(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),G=m(["#text"]),Q=m(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),q=m(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),K=m(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),z=m(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),j=_(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Z=_(/<%[\w\W]*|[\w\W]*%>/gm),X=_(/\${[\w\W]*}/gm),J=_(/^data-[\-\w.\u00B7-\uFFFF]/),Y=_(/^aria-[\-\w]+$/),$=_(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ee=_(/^(?:\w+script|data):/i),te=_(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ne=_(/^html$/i),ae=_(/^[a-z][.\w]*(-[.\w]+)+$/i),ie=function(){return"undefined"==typeof window?null:window},oe=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var a=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(a=n.currentScript.getAttribute(i));var o="dompurify"+(a?"#"+a:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function re(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie(),n=function(e){return re(e)};if(n.version="2.5.7",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var a=t.document,o=t.document,r=t.DocumentFragment,s=t.HTMLTemplateElement,l=t.Node,c=t.Element,d=t.NodeFilter,u=t.NamedNodeMap,p=void 0===u?t.NamedNodeMap||t.MozNamedAttrMap:u,g=t.HTMLFormElement,h=t.DOMParser,_=t.trustedTypes,S=c.prototype,f=U(S,"cloneNode"),C=U(S,"nextSibling"),y=U(S,"childNodes"),D=U(S,"parentNode");if("function"==typeof s){var R=o.createElement("template");R.content&&R.content.ownerDocument&&(o=R.content.ownerDocument)}var se=oe(_,a),le=se?se.createHTML(""):"",ce=o,de=ce.implementation,ue=ce.createNodeIterator,pe=ce.createDocumentFragment,ge=ce.getElementsByTagName,he=a.importNode,me={};try{me=L(o).documentMode?o.documentMode:{}}catch(e){}var _e={};n.isSupported="function"==typeof D&&de&&void 0!==de.createHTMLDocument&&9!==me;var Se,fe,Ce=j,ye=Z,Ae=X,be=J,Te=Y,ve=ee,we=te,Fe=ae,Ie=$,Ee=null,Me=x({},[].concat(i(O),i(B),i(N),i(H),i(G))),ke=null,Pe=x({},[].concat(i(Q),i(q),i(K),i(z))),De=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Re=null,xe=null,Le=!0,Ue=!0,Oe=!1,Be=!0,Ne=!1,We=!0,He=!1,Ve=!1,Ge=!1,Qe=!1,qe=!1,Ke=!1,ze=!0,je=!1,Ze="user-content-",Xe=!0,Je=!1,Ye={},$e=null,et=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tt=null,nt=x({},["audio","video","img","source","image","track"]),at=null,it=x({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ot="http://www.w3.org/1998/Math/MathML",rt="http://www.w3.org/2000/svg",st="http://www.w3.org/1999/xhtml",lt=st,ct=!1,dt=null,ut=x({},[ot,rt,st],w),pt=["application/xhtml+xml","text/html"],gt="text/html",ht=null,mt=o.createElement("form"),_t=function(e){return e instanceof RegExp||e instanceof Function},St=function(t){ht&&ht===t||(t&&"object"===e(t)||(t={}),t=L(t),Se=Se=-1===pt.indexOf(t.PARSER_MEDIA_TYPE)?gt:t.PARSER_MEDIA_TYPE,fe="application/xhtml+xml"===Se?w:v,Ee="ALLOWED_TAGS"in t?x({},t.ALLOWED_TAGS,fe):Me,ke="ALLOWED_ATTR"in t?x({},t.ALLOWED_ATTR,fe):Pe,dt="ALLOWED_NAMESPACES"in t?x({},t.ALLOWED_NAMESPACES,w):ut,at="ADD_URI_SAFE_ATTR"in t?x(L(it),t.ADD_URI_SAFE_ATTR,fe):it,tt="ADD_DATA_URI_TAGS"in t?x(L(nt),t.ADD_DATA_URI_TAGS,fe):nt,$e="FORBID_CONTENTS"in t?x({},t.FORBID_CONTENTS,fe):et,Re="FORBID_TAGS"in t?x({},t.FORBID_TAGS,fe):{},xe="FORBID_ATTR"in t?x({},t.FORBID_ATTR,fe):{},Ye="USE_PROFILES"in t&&t.USE_PROFILES,Le=!1!==t.ALLOW_ARIA_ATTR,Ue=!1!==t.ALLOW_DATA_ATTR,Oe=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Be=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Ne=t.SAFE_FOR_TEMPLATES||!1,We=!1!==t.SAFE_FOR_XML,He=t.WHOLE_DOCUMENT||!1,Qe=t.RETURN_DOM||!1,qe=t.RETURN_DOM_FRAGMENT||!1,Ke=t.RETURN_TRUSTED_TYPE||!1,Ge=t.FORCE_BODY||!1,ze=!1!==t.SANITIZE_DOM,je=t.SANITIZE_NAMED_PROPS||!1,Xe=!1!==t.KEEP_CONTENT,Je=t.IN_PLACE||!1,Ie=t.ALLOWED_URI_REGEXP||Ie,lt=t.NAMESPACE||st,De=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&_t(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(De.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&_t(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(De.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(De.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ne&&(Ue=!1),qe&&(Qe=!0),Ye&&(Ee=x({},i(G)),ke=[],!0===Ye.html&&(x(Ee,O),x(ke,Q)),!0===Ye.svg&&(x(Ee,B),x(ke,q),x(ke,z)),!0===Ye.svgFilters&&(x(Ee,N),x(ke,q),x(ke,z)),!0===Ye.mathMl&&(x(Ee,H),x(ke,K),x(ke,z))),t.ADD_TAGS&&(Ee===Me&&(Ee=L(Ee)),x(Ee,t.ADD_TAGS,fe)),t.ADD_ATTR&&(ke===Pe&&(ke=L(ke)),x(ke,t.ADD_ATTR,fe)),t.ADD_URI_SAFE_ATTR&&x(at,t.ADD_URI_SAFE_ATTR,fe),t.FORBID_CONTENTS&&($e===et&&($e=L($e)),x($e,t.FORBID_CONTENTS,fe)),Xe&&(Ee["#text"]=!0),He&&x(Ee,["html","head","body"]),Ee.table&&(x(Ee,["tbody"]),delete Re.tbody),m&&m(t),ht=t)},ft=x({},["mi","mo","mn","ms","mtext"]),Ct=x({},["annotation-xml"]),yt=x({},["title","style","font","a","script"]),At=x({},B);x(At,N),x(At,W);var bt=x({},H);x(bt,V);var Tt=function(e){var t=D(e);t&&t.tagName||(t={namespaceURI:lt,tagName:"template"});var n=v(e.tagName),a=v(t.tagName);return!!dt[e.namespaceURI]&&(e.namespaceURI===rt?t.namespaceURI===st?"svg"===n:t.namespaceURI===ot?"svg"===n&&("annotation-xml"===a||ft[a]):Boolean(At[n]):e.namespaceURI===ot?t.namespaceURI===st?"math"===n:t.namespaceURI===rt?"math"===n&&Ct[a]:Boolean(bt[n]):e.namespaceURI===st?!(t.namespaceURI===rt&&!Ct[a])&&!(t.namespaceURI===ot&&!ft[a])&&!bt[n]&&(yt[n]||!At[n]):!("application/xhtml+xml"!==Se||!dt[e.namespaceURI]))},vt=function(e){T(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=le}catch(t){e.remove()}}},wt=function(e,t){try{T(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){T(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!ke[e])if(Qe||qe)try{vt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Ft=function(e){var t,n;if(Ge)e="<remove></remove>"+e;else{var a=F(e,/^[\r\n\t ]+/);n=a&&a[0]}"application/xhtml+xml"===Se&&lt===st&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=se?se.createHTML(e):e;if(lt===st)try{t=(new h).parseFromString(i,Se)}catch(e){}if(!t||!t.documentElement){t=de.createDocument(lt,"template",null);try{t.documentElement.innerHTML=ct?le:i}catch(e){}}var r=t.body||t.documentElement;return e&&n&&r.insertBefore(o.createTextNode(n),r.childNodes[0]||null),lt===st?ge.call(t,He?"html":"body")[0]:He?t.documentElement:r},It=function(e){return ue.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null,!1)},Et=function(e){return e instanceof g&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof p)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Mt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},kt=function(e,t,a){_e[e]&&A(_e[e],(function(e){e.call(n,t,a,ht)}))},Pt=function(e){var t;if(kt("beforeSanitizeElements",e,null),Et(e))return vt(e),!0;if(k(/[\u0080-\uFFFF]/,e.nodeName))return vt(e),!0;var a=fe(e.nodeName);if(kt("uponSanitizeElement",e,{tagName:a,allowedTags:Ee}),e.hasChildNodes()&&!Mt(e.firstElementChild)&&(!Mt(e.content)||!Mt(e.content.firstElementChild))&&k(/<[/\w]/g,e.innerHTML)&&k(/<[/\w]/g,e.textContent))return vt(e),!0;if("select"===a&&k(/<template/i,e.innerHTML))return vt(e),!0;if(7===e.nodeType)return vt(e),!0;if(We&&8===e.nodeType&&k(/<[/\w]/g,e.data))return vt(e),!0;if(!Ee[a]||Re[a]){if(!Re[a]&&Rt(a)){if(De.tagNameCheck instanceof RegExp&&k(De.tagNameCheck,a))return!1;if(De.tagNameCheck instanceof Function&&De.tagNameCheck(a))return!1}if(Xe&&!$e[a]){var i=D(e)||e.parentNode,o=y(e)||e.childNodes;if(o&&i)for(var r=o.length-1;r>=0;--r){var s=f(o[r],!0);s.__removalCount=(e.__removalCount||0)+1,i.insertBefore(s,C(e))}}return vt(e),!0}return e instanceof c&&!Tt(e)?(vt(e),!0):"noscript"!==a&&"noembed"!==a&&"noframes"!==a||!k(/<\/no(script|embed|frames)/i,e.innerHTML)?(Ne&&3===e.nodeType&&(t=e.textContent,t=I(t,Ce," "),t=I(t,ye," "),t=I(t,Ae," "),e.textContent!==t&&(T(n.removed,{element:e.cloneNode()}),e.textContent=t)),kt("afterSanitizeElements",e,null),!1):(vt(e),!0)},Dt=function(e,t,n){if(ze&&("id"===t||"name"===t)&&(n in o||n in mt))return!1;if(Ue&&!xe[t]&&k(be,t));else if(Le&&k(Te,t));else if(!ke[t]||xe[t]){if(!(Rt(e)&&(De.tagNameCheck instanceof RegExp&&k(De.tagNameCheck,e)||De.tagNameCheck instanceof Function&&De.tagNameCheck(e))&&(De.attributeNameCheck instanceof RegExp&&k(De.attributeNameCheck,t)||De.attributeNameCheck instanceof Function&&De.attributeNameCheck(t))||"is"===t&&De.allowCustomizedBuiltInElements&&(De.tagNameCheck instanceof RegExp&&k(De.tagNameCheck,n)||De.tagNameCheck instanceof Function&&De.tagNameCheck(n))))return!1}else if(at[t]);else if(k(Ie,I(n,we,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==E(n,"data:")||!tt[e])if(Oe&&!k(ve,I(n,we,"")));else if(n)return!1;return!0},Rt=function(e){return"annotation-xml"!==e&&F(e,Fe)},xt=function(t){var a,i,o,r;kt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ke};for(r=s.length;r--;){var c=a=s[r],d=c.name,u=c.namespaceURI;if(i="value"===d?a.value:M(a.value),o=fe(d),l.attrName=o,l.attrValue=i,l.keepAttr=!0,l.forceKeepAttr=void 0,kt("uponSanitizeAttribute",t,l),i=l.attrValue,!l.forceKeepAttr&&(wt(d,t),l.keepAttr))if(Be||!k(/\/>/i,i)){Ne&&(i=I(i,Ce," "),i=I(i,ye," "),i=I(i,Ae," "));var p=fe(t.nodeName);if(Dt(p,o,i))if(!je||"id"!==o&&"name"!==o||(wt(d,t),i=Ze+i),We&&k(/((--!?|])>)|<\/(style|title)/i,i))wt(d,t);else{if(se&&"object"===e(_)&&"function"==typeof _.getAttributeType)if(u);else switch(_.getAttributeType(p,o)){case"TrustedHTML":i=se.createHTML(i);break;case"TrustedScriptURL":i=se.createScriptURL(i)}try{u?t.setAttributeNS(u,d,i):t.setAttribute(d,i),Et(t)?vt(t):b(n.removed)}catch(e){}}}else wt(d,t)}kt("afterSanitizeAttributes",t,null)}},Lt=function e(t){var n,a=It(t);for(kt("beforeSanitizeShadowDOM",t,null);n=a.nextNode();)kt("uponSanitizeShadowNode",n,null),Pt(n)||(n.content instanceof r&&e(n.content),xt(n));kt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(i){var o,s,c,d,u,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((ct=!i)&&(i="\x3c!--\x3e"),"string"!=typeof i&&!Mt(i)){if("function"!=typeof i.toString)throw P("toString is not a function");if("string"!=typeof(i=i.toString()))throw P("dirty is not a string, aborting")}if(!n.isSupported){if("object"===e(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof i)return t.toStaticHTML(i);if(Mt(i))return t.toStaticHTML(i.outerHTML)}return i}if(Ve||St(p),n.removed=[],"string"==typeof i&&(Je=!1),Je){if(i.nodeName){var g=fe(i.nodeName);if(!Ee[g]||Re[g])throw P("root node is forbidden and cannot be sanitized in-place")}}else if(i instanceof l)1===(s=(o=Ft("\x3c!----\x3e")).ownerDocument.importNode(i,!0)).nodeType&&"BODY"===s.nodeName||"HTML"===s.nodeName?o=s:o.appendChild(s);else{if(!Qe&&!Ne&&!He&&-1===i.indexOf("<"))return se&&Ke?se.createHTML(i):i;if(!(o=Ft(i)))return Qe?null:Ke?le:""}o&&Ge&&vt(o.firstChild);for(var h=It(Je?i:o);c=h.nextNode();)3===c.nodeType&&c===d||Pt(c)||(c.content instanceof r&&Lt(c.content),xt(c),d=c);if(d=null,Je)return i;if(Qe){if(qe)for(u=pe.call(o.ownerDocument);o.firstChild;)u.appendChild(o.firstChild);else u=o;return(ke.shadowroot||ke.shadowrootmod)&&(u=he.call(a,u,!0)),u}var m=He?o.outerHTML:o.innerHTML;return He&&Ee["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&k(ne,o.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+m),Ne&&(m=I(m,Ce," "),m=I(m,ye," "),m=I(m,Ae," ")),se&&Ke?se.createHTML(m):m},n.setConfig=function(e){St(e),Ve=!0},n.clearConfig=function(){ht=null,Ve=!1},n.isValidAttribute=function(e,t,n){ht||St({});var a=fe(e),i=fe(t);return Dt(a,i,n)},n.addHook=function(e,t){"function"==typeof t&&(_e[e]=_e[e]||[],T(_e[e],t))},n.removeHook=function(e){if(_e[e])return b(_e[e])},n.removeHooks=function(e){_e[e]&&(_e[e]=[])},n.removeAllHooks=function(){_e={}},n}return re()}()},6942:function(e,t){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */t.read=function(e,t,n,a,i){var o,r,s=8*i-a-1,l=(1<<s)-1,c=l>>1,d=-7,u=n?i-1:0,p=n?-1:1,g=e[t+u];for(u+=p,o=g&(1<<-d)-1,g>>=-d,d+=s;d>0;o=256*o+e[t+u],u+=p,d-=8);for(r=o&(1<<-d)-1,o>>=-d,d+=a;d>0;r=256*r+e[t+u],u+=p,d-=8);if(0===o)o=1-c;else{if(o===l)return r?NaN:1/0*(g?-1:1);r+=Math.pow(2,a),o-=c}return(g?-1:1)*r*Math.pow(2,o-a)},t.write=function(e,t,n,a,i,o){var r,s,l,c=8*o-i-1,d=(1<<c)-1,u=d>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,g=a?0:o-1,h=a?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,r=d):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+u>=1?p/l:p*Math.pow(2,1-u))*l>=2&&(r++,l/=2),r+u>=d?(s=0,r=d):r+u>=1?(s=(t*l-1)*Math.pow(2,i),r+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,i),r=0));i>=8;e[n+g]=255&s,g+=h,s/=256,i-=8);for(r=r<<i|s,c+=i;c>0;e[n+g]=255&r,g+=h,r/=256,c-=8);e[n+g-h]|=128*m}},3908:function(e){function t(e,t){var n=e.length,a=new Array(n),i={},o=n,r=function(e){for(var t=new Map,n=0,a=e.length;n<a;n++){var i=e[n];t.has(i[0])||t.set(i[0],new Set),t.has(i[1])||t.set(i[1],new Set),t.get(i[0]).add(i[1])}return t}(t),s=function(e){for(var t=new Map,n=0,a=e.length;n<a;n++)t.set(e[n],n);return t}(e);for(t.forEach((function(e){if(!s.has(e[0])||!s.has(e[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")}));o--;)i[o]||l(e[o],o,new Set);return a;function l(e,t,o){if(o.has(e)){var c;try{c=", node was:"+JSON.stringify(e)}catch(e){c=""}throw new Error("Cyclic dependency"+c)}if(!s.has(e))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(e));if(!i[t]){i[t]=!0;var d=r.get(e)||new Set;if(t=(d=Array.from(d)).length){o.add(e);do{var u=d[--t];l(u,s.get(u),o)}while(t);o.delete(e)}a[--n]=e}}}e.exports=function(e){return t(function(e){for(var t=new Set,n=0,a=e.length;n<a;n++){var i=e[n];t.add(i[0]),t.add(i[1])}return Array.from(t)}(e),e)},e.exports.array=t},6363:function(e,t,n){"use strict";n.d(t,{a:function(){return a},b:function(){return i}});var a=function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};Object.create;function i(e,t,n){if(n||2===arguments.length)for(var a,i=0,o=t.length;i<o;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}Object.create},9856:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicScriptLoader=void 0;const a=n(9451),i=n(3306),o=n(7411);t.DynamicScriptLoader=class{getConfig(){return this.config}getSriHashFromScriptIdentifier(e){const t=this.knownScriptMap.get(e)||{identifier:e};return this.config.resolveSriHash?this.config.resolveSriHash(t):""}getUrlFromScriptIdentifier(e){const t=this.knownScriptMap.get(e)||{identifier:e};return this.config.resolveScript(t)}constructor(e){this.config=e,this.requestedScripts=new Map,this.knownScriptMap=new Map,this.retryScriptsMap=new Map,this.loadScript=e=>{const{crossOriginAttributeValue:t,loadScriptHandler:n,loadScriptWithRetryHandler:o}=this.config,r=(0,a.getOrderedScriptAndDependencies)(e,this.knownScriptMap),s=r.map((e=>{let a=this.requestedScripts.get(e);return a||(a=(o||n||i.loadScript)(e,this.getUrlFromScriptIdentifier(e),t,void 0,void 0,this.getSriHashFromScriptIdentifier(e),this.config.trustedTypesPolicy),this.requestedScripts.set(e,a)),a}));return this.config.isRetryEnabled?Promise.all(s).then((()=>e),(()=>{const a=e=>(o||n||i.loadScript)(e,this.getUrlFromScriptIdentifier(e),t,5,!0,this.getSriHashFromScriptIdentifier(e),this.config.trustedTypesPolicy);return r.reduce(((e,t)=>e.then((()=>{const e=this.retryScriptsMap.get(t);if(e)return e;const n=a(t);return this.retryScriptsMap.set(t,n),n}))),Promise.resolve()).then((()=>e))})):Promise.all(s).then((()=>e))},this.preloadScript=e=>{const t=document.createDocumentFragment(),n=(0,a.getOrderedScriptAndDependencies)(e,this.knownScriptMap);this.config.isPreloadOptimizedEnabled?.()?(n.map((e=>(0,o.generatePreloadLinks)(this.getUrlFromScriptIdentifier(e),this.config.crossOriginAttributeValue))).forEach((e=>{t.appendChild(e)})),document.head.appendChild(t)):n.forEach((e=>(0,o.preloadScript)(this.getUrlFromScriptIdentifier(e),this.config.crossOriginAttributeValue)))},e.knownScripts&&e.knownScripts.forEach((e=>{const t=e.identifier.toLowerCase();if(this.knownScriptMap.has(t))throw new Error(`The knownScripts passed into the DynamicScriptLoader config contains multiple entries for the script with identifier: ${t}`);this.knownScriptMap.set(t,e)}))}}},7681:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(e,t,a){i=e,o=a,n.p=t;s=!0},t.loadStaticChunk=function(e,t){const n=i(e,t);return(0,a.loadScript)(e,n,"anonymous",5,void 0,void 0,r)},t.setTrustedTypesPolicy=function(e){r=e},t.createLoadChunkFunction=function(e,t){return function n(a){if(!s)throw new Error("appResourceLoader not initialized");if(l.has(a))return l.get(a);const i=Date.now();let r=-1;const c=[];if(e[a]&&e[a].dependencies)for(const t of e[a].dependencies)c.push(n(t));let d;return d=0===c.length?t(a):Promise.all(c).then((()=>(r=Date.now()-i,t(a)))),d=d.then((e=>{if(o){let e=`Chunk ${a} loaded in ${Date.now()-i} ms`;-1!==r&&(e+=` (${r} ms for extra ${c.length} deps)`),o(512235483,306,50,e)}return e})).catch((e=>{throw o&&o(512235482,306,10,e),e})),l.set(a,d),d}};const a=n(3306);let i,o,r,s=!1;const l=new Map},9451:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrderedScriptAndDependencies=function(e,t){const n=new Set,i=[e.toLowerCase()],o=[];for(;i.length>0;){const e=i.shift();n.add(e);const a=t.get(e);a&&a.dependencies&&a.dependencies.forEach((t=>{const a=t.toLowerCase();n.has(a)||i.push(a),o.push([a,e])}))}const r=[];return n.forEach((e=>r.push(e))),a.array(r,o)};const a=n(3908)},8113:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,i)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(9856),t),i(n(3306),t),i(n(7411),t),i(n(7681),t)},3306:function(e,t){"use strict";function n(e,t,a,i,o,r,s,l){return new Promise(((c,d)=>{const u=document.createElement("script");if(u.async=!1,r)try{u.src=r.createScriptURL(t)}catch(e){u.src=t}else u.src=t;let p=u.src;const g=window.g_wscdt;if(void 0!==g&&!p.match("[?&]wscdt=")){const e=p.indexOf("?");p+=(e>-1?"&":"?")+"wscdt="+g,u.src=p}void 0!==a&&(u.crossOrigin=a),o&&""!==o&&(u.setAttribute("integrity",`sha256-${o}`),a||(u.crossOrigin="anonymous")),u.onload=()=>{s?s(e):c(e)},u.onerror=()=>{if(i&&i>0)document.head.removeChild(u),n(e,t,a,i-1,o,r,s||c,l||d);else{const n=new Error(`Failed to download the script with identifier: ${e} at url: ${t}`);l?l(n):d(n)}},document.head.appendChild(u)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.loadScript=function(e,t,a,i,o,r,s){return n(e,t+(o?"?cache-bust=true":""),a,i,r,s)}},7411:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.preloadScript=function(e,t){const n=document.createElement("link");n.rel="preload",n.href=e,n.setAttribute("as","script"),void 0!==t&&(n.crossOrigin=t);document.head.appendChild(n)},t.generatePreloadLinks=function(e,t){const n=document.createElement("link");n.rel="preload",n.href=e,n.setAttribute("as","script"),void 0!==t&&(n.crossOrigin=t);return n}},2657:function(e,t,n){"use strict";n.d(t,{a:function(){return u},b:function(){return A},c:function(){return T},d:function(){return p},e:function(){return d},f:function(){return c},g:function(){return I},h:function(){return w},i:function(){return h},j:function(){return _},k:function(){return m},l:function(){return M},m:function(){return f},n:function(){return C},o:function(){return S},p:function(){return g},q:function(){return y},r:function(){return b},s:function(){return v},t:function(){return F}});let a,i,o=!1,r=[],s=0;const l=2e4;function c(e,t,n,a,i,o,r){y({name:null,actionName:e,commandSurface:i,parentName:n,triggerMethod:a,durationMs:o,succeeded:t,dataFields:r})}function d(e,t=!0,n=0,a=[]){h({name:e,succeeded:t,durationMs:n,dataFields:a})}var u;function p(e,t,n=u.Count,a=!0,i=0,o=[],r=!1){if(null==e||""===e)return;let s=t;if(null==t){if(n!==u.Count)return;s=1}o.push({name:"WAC_Experiment",string:n.toString()}),o.push({name:"WAC_Experiment_Value",double:s}),o.push({name:"WAC_Experiment_EventName",string:"WAC_Exp_"+e+"_"+n.toString()}),o.push({name:"WAC_Experiment_AggregateOnlySucceeded",bool:r}),h({name:e,succeeded:a,durationMs:i,dataFields:o})}function g(e){E({kind:"event",event:e,timestamp:(new Date).getTime()})}function h(e){E({kind:"activity",event:e,timestamp:(new Date).getTime()})}function m(e){E({kind:"dnm",event:e,timestamp:(new Date).getTime()})}function _(e){E({kind:"cc",event:e,timestamp:(new Date).getTime()})}function S(e){E({kind:"otel",event:e})}function f(e){E({kind:"otelcc",event:e})}function C(e){E({kind:"oteldnm",event:e})}function y(e){E({kind:"action",event:e,timestamp:(new Date).getTime()})}function A(e,t){E({kind:"addNamespaceMapping",namespace:e,ariaTenantToken:t})}function b(e,t){E({kind:"setDNMToken",namespace:e,ariaTenantToken:t})}function T(){E({kind:"flush"})}function v(e){o=e,o||(r=[])}function w(e){i=e}function F(){return i&&i(),E({kind:"shutdown"}),r.length+s}function I(e){a=e,r.forEach((e=>E(e))),r=[]}function E(e){o&&(a?a(e):r.length<=l?r.push(e):s+=1)}function M(e){a&&a(e)}!function(e){e.Count="Count",e.Avg="Avg",e.Sum="Sum"}(u||(u={}))},4564:function(e,t,n){"use strict";n.d(t,{a:function(){return a},b:function(){return i}});const a=[{namespace:"Office.Online",ariaTenant:"79b56d2f6f2444f1a3d7f7c7f12bcc0c-f47f5fe6-ed89-42f6-8a43-cea0f5930b17-7407"},{namespace:"Office.Word.Online.Data",ariaTenant:"7e7959aac92e41d6892c69a87259ed58-de5c63ef-10f5-45e1-bef2-d23e9cac2fab-6830"},{namespace:"Office.Excel.Online.Data",ariaTenant:"011776870b754a649aedc9456ac07a97-6bd8247c-11d3-4599-b599-ec9ef6d401f6-6722"},{namespace:"Office.PowerPoint.Online.Data",ariaTenant:"35612b11d234460da5c673d7b172fd93-f8762c6b-96cb-4e60-87fa-015aac0c2ff1-7212"},{namespace:"Office.OneNote.Online.Data",ariaTenant:"86258c80efed47d9b34bf77fc663b381-af82a060-b49f-448b-baf0-956ba7709592-7634"},{namespace:"Office.Visio.Online.Data",ariaTenant:"77fd25a525d24b7f9b924307de0cc70f-5f2b6ec0-f1d2-40dd-b875-e6bd2849e1eb-7539"},{namespace:"Office.Shared.Online.Data",ariaTenant:"4ad8b2b2029e481fb82edb7aac29de59-94494dd8-b684-4f92-ab7f-6b414eb77798-7917"},{namespace:"Office.PowerPoint",ariaTenant:"e97859101370486fbcb67f5a023da3fc-29b89831-2d28-4841-8fa6-338080fae3a4-7206"},{namespace:"Office.Word.Online",ariaTenant:"ff7e2f12a4be407096fc01eeb760eda3-eeeb63cf-35d9-4734-ab45-66a873412359-7045"},{namespace:"Office.Excel.Online",ariaTenant:"fad3bd1d8e4b4c06894bd7bac80e4f02-67df67b4-f1fd-4ecd-9d55-4d41540b1757-7724"},{namespace:"Office.Excel.Client",ariaTenant:"19eb5e37de684ce38ce5cf3d5842d3f7-e8722941-bde5-4b98-9cd5-2775ec51482c-6873"},{namespace:"Office.PowerPoint.Online",ariaTenant:"b664cab4b3f24a739be75b93b026749e-65c206a3-a985-48b4-8b50-36c56c3ce309-7201"},{namespace:"Office.OneNote.Online",ariaTenant:"1705ef36a51840648341da866d62baf8-ddbcd60b-4ce4-48da-96be-ad5f28b48954-8035"},{namespace:"Office.Visio.Online",ariaTenant:"a9b6cb604fe942a89c8671aab85364f6-af0f81b1-c5ce-419a-82d5-af38c33ebea3-7250"},{namespace:"Office.Shared.Online",ariaTenant:"d034371e26194a76a187c7108b3837ca-731725e8-1dc7-4eca-a754-b09c9d2b8dd5-6502"},{namespace:"Office.Telemetry",ariaTenant:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405"},{namespace:"Office.System",ariaTenant:"cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521"},{namespace:"Office.TellMe",ariaTenant:"31d9dd3e4c7046a696537586281d7ed1-06d11dd6-a946-4281-8ac3-a7c2ab4776f5-7063"},{namespace:"Office.Voice",ariaTenant:"9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162"},{namespace:"Office.Insights",ariaTenant:"250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487"},{namespace:"Office.Graphics",ariaTenant:"cfcfdb91c68c4329bb8b7cb7babb3cf7-e082c2f2-ef1d-427a-ac4d-b0b700afe7a7-7655"},{namespace:"Office.AugLoop",ariaTenant:"3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770"},{namespace:"Office.FileIO",ariaTenant:"d2b065c5ae634beb9cec4813140e22da-eda42ada-ffd9-4e26-92a1-e3b440eaf8bf-7717"},{namespace:"Office.Sandbox",ariaTenant:"1cd66059dc1d41f1887e3770ea8ba967-f1d0108c-8535-4cf9-bf23-ec8227f6afa7-6999"},{namespace:"Office.UX",ariaTenant:"c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879"},{namespace:"Office.Extensibility",ariaTenant:"db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439"}],i=[{namespace:"Office.DNM.Word.Online",ariaTenant:"541f81cf685f4bccb9e5395b0add4d41-2c1afbab-72ae-471a-a985-efea62ea9e83-7130"},{namespace:"Office.DNM.Visio.Online",ariaTenant:"feba3d98f7c0481c8b63754573a80618-7311e9e0-365d-4a1b-b0fb-a238e0bc7528-6955"},{namespace:"Office.DNM.Sandbox",ariaTenant:"b0aae8a3009047b9bf4d3b17439319b6-e96e56cc-5657-463a-a2f2-dc8c0fb9d41b-7136"},{namespace:"Office.DNM.Excel",ariaTenant:"58fd209df5254081ba538f7f4bc34ef5-7b3b52dc-fdf5-4d95-917e-a356694c1ebc-7071"}]},6009:function(e,t,n){"use strict";n.d(t,{a:function(){return F},b:function(){return w},c:function(){return v},d:function(){return T},e:function(){return E},f:function(){return I},g:function(){return k}});var a=n(5901),i=n(8542),o=n(9457);function r(e,t){return e?e+"."+t:t}function s(e,t,n,a,i){void 0===i&&(i=4),a&&e.push((0,o.d)("".concat(r(t,n)),a,i))}function l(e,t,n,a){"boolean"==typeof a&&e.push((0,o.a)("".concat(r(t,n)),a))}function c(e,t,n,a){"number"==typeof a&&e.push((0,o.c)("".concat(r(t,n)),a))}var d,u=function(e){var t="Activity.Result",n=[];return c(n,t,"Code",e.code),s(n,t,"Type",e.type),c(n,t,"Tag",e.tag),l(n,t,"IsExpected",e.isExpected),n.push((0,o.d)("zC.Activity.Result","Office.System.Result")),n},p={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return s(n,t,"CV",e.cV),c(n,t,"Duration",e.duration),c(n,t,"Count",e.count),c(n,t,"AggMode",e.aggMode),l(n,t,"Success",e.success),e.result&&n.push.apply(n,u(e.result)),n.push((0,o.d)("zC.Activity",this.contractName)),n}},g={getFields:function(e){var t="UserAction",n=[];return c(n,t,"Id",e.id),s(n,t,"Name",e.name),s(n,t,"CommandSurface",e.commandSurface),s(n,t,"ParentName",e.parentName),s(n,t,"TriggerMethod",e.triggerMethod),c(n,t,"TimeOffsetMs",e.timeOffsetMs),n}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(d||(d={}));var h;!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(h||(h={}));var m,_;!function(e){var t="Copilot";!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(e.EntryPoint||(e.EntryPoint={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(e.Verb||(e.Verb={})),e.getFields=function(e){var n=[];return s(n,t,"FeatureActionType",e.featureActionType),l(n,t,"IsUserInitiated",e.isUserInitiated),s(n,t,"FeatureName",e.featureName),s(n,t,"SubFeatureName",e.subFeatureName),s(n,t,"Capability",e.capability),l(n,t,"IsThumbsUp",e.isThumbsUp),s(n,t,"EntryPoint",e.entryPoint),s(n,t,"Verb",e.verb),s(n,t,"InteractionId",e.interactionId),s(n,t,"ConversationId",e.conversationId),n.push((0,o.d)("zC.".concat(t),"Office.System.Copilot")),n}}(m||(m={})),function(e){var t="Asha";!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var n=[];return s(n,t,"EventType",e.eventType),s(n,t,"Pillar",e.pillar),s(n,t,"Scenario",e.scenario),s(n,t,"Veto",e.veto),s(n,t,"Error",e.error),l(n,t,"InStaging",e.inStaging),l(n,t,"IsSessionEndingError",e.isSessionEndingError),l(n,t,"IsIntentional",e.isIntentional),l(n,t,"IsInternal",e.isInternal),n.push((0,o.d)("zC.".concat(t),"Office.System.Asha")),n}}(_||(_={}));class S{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const f=new class{setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,n,a){this.externalLogger.sendTraceTag(e,t,n,a)}debugAssertTag(e,t,n,a){this.externalLogger.debugAssertTag(e,t,n,a)}shipAssertTag(e,t,n,a){this.externalLogger.shipAssertTag(e,t,n,a)}constructor(){this.externalLogger=new S}};var C,y,A;!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_Wac_UniversalPrint=3068]="msoulscat_Wac_UniversalPrint",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",e[e.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",e[e.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",e[e.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",e[e.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",e[e.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",e[e.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",e[e.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",e[e.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",e[e.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",e[e.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",e[e.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",e[e.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint",e[e.msoulscat_AIHub_CreateModuleUI_Artifacts=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",e[e.msoulscat_AIHub_CreateModuleUI_BrandKit=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",e[e.msoulscat_AIHub_CreateModuleUI_Forms=4102]="msoulscat_AIHub_CreateModuleUI_Forms",e[e.msoulscat_AIHub_CreateModuleUI_Homepage=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",e[e.msoulscat_AIHub_CreateModuleUI_Text=4104]="msoulscat_AIHub_CreateModuleUI_Text",e[e.msoulscat_AIHub_CreateModuleUI_Video=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(C||(C={})),(A=y||(y={}))[A.Error=10]="Error",A[A.Warning=15]="Warning",A[A.Important=20]="Important",A[A.Info=50]="Info",A[A.Verbose=100]="Verbose",A[A.Spam=200]="Spam";var b=n(5140);function T(e){if(!e.name)throw new Error("Event is missing a name");const t=E(e.dataFields),n={eventName:e.name,dataFields:t,eventFlags:{}};return e.samplingPolicy===a.e.Sampled&&(n.eventFlags={samplingPolicy:i.a.SamplingPolicy.Measure}),n}function v(e){if(!e.name)throw new Error("Event is missing a name");const t=E(e.dataFields),n={eventName:e.name,dataFields:t,eventFlags:{},telemetryProperties:{dnmInterval:e.dnmInterval,dnmAllowedPartA:[]}};return e.dnmAllowedPartA&&e.dnmAllowedPartA.forEach((e=>{if(e){const t=e;t&&n.telemetryProperties.dnmAllowedPartA.push(t)}})),n}function w(e){if(!e.name)throw new Error("Event is missing a name");const t=E(e.dataFields),n={eventName:e.name,dataFields:t,eventFlags:{},telemetryProperties:{customerContentVersion:e.customerContentVersion,customerContentType:e.customerContentType}};return e.samplingPolicy===a.e.Sampled&&(n.eventFlags={samplingPolicy:i.a.SamplingPolicy.Measure}),n}function F(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0),(null==e.count||isNaN(e.count))&&(e.count=1),null==e.aggMode&&(e.aggMode=a.a.None);const t=Math.floor(1e3*e.durationMs),n=E(e.dataFields),i=p.getFields({cV:e.CV||void 0,duration:t,count:e.count,aggMode:e.aggMode,success:e.succeeded});return{eventName:e.name,eventContract:{name:p.contractName,dataFields:i},dataFields:n,eventFlags:{}}}function I(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0);const t=Math.floor(1e3*e.durationMs);null==e.dataFields&&(e.dataFields=[]);const n=E(e.dataFields),a=g.getFields({id:(0,b.d)(e.actionId),name:(0,b.d)(e.actionName),commandSurface:(0,b.d)(e.commandSurface),parentName:(0,b.d)(e.parentName),triggerMethod:(0,b.d)(e.triggerMethod),timeOffsetMs:(0,b.d)(e.timeOffsetMs)});n.push(...a);const i=p.getFields({duration:t,count:1,aggMode:0,success:e.succeeded});return{eventName:e.name,eventContract:{name:p.contractName,dataFields:i},dataFields:n,eventFlags:{}}}function E(e){const t=[];if(e)for(let n=0;n<e.length;n+=1)t.push(...M(e[n]));return t}function M(e,t){if(!e){const e=Error().stack;return f.sendTraceTag(508904220,C.msoulscat_Wac_Telemetry,y.Warning,`Data field is null, namespace: ${t}, stackTrace: ${e}`),[]}e.name||(e.name="DataFieldNameIsMissing");const n=function(e){if(null!=e.string)return a.g.String;if(null!=e.bool)return a.g.Boolean;if(null!=e.int64&&!isNaN(e.int64))return a.g.Int64;if(null!=e.double&&!isNaN(e.double))return a.g.Double;if(null!=e.contract)return a.g.Contract;if(null!=e.date&&!isNaN(e.date))return a.g.Date;return a.g.Unspecified}(e),i=t?t+"."+e.name:e.name;switch(n){case a.g.Unspecified:return[];case a.g.Boolean:return[o.a(i,e.bool)];case a.g.String:return[o.d(i,e.string)];case a.g.Int64:return[o.c(i,Math.floor(e.int64))];case a.g.Double:return[o.b(i,e.double)];case a.g.Date:return[o.d(i,new Date(e.date).toISOString())];case a.g.Contract:return function(e,t){const n=[];if(t.dataFields)for(let a=0;a<t.dataFields.length;a+=1)n.push(...M(t.dataFields[a],e));return n}(i,e.contract);default:throw new Error(n)}}function k(e){const t=e.otelEvent;if(!t||!t.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){const n=E(e.additionalDataFields);t.dataFields.push(...n)}return t}},5901:function(e,t,n){"use strict";n.d(t,{a:function(){return i},b:function(){return r},c:function(){return s},d:function(){return o},e:function(){return a},f:function(){return d},g:function(){return l}});var a,i,o,r,s,l,c=n(7938);!function(e){e[e.Unspecified=0]="Unspecified",e[e.Sampled=1]="Sampled",e[e.Complete=2]="Complete"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Always=1]="Always",e[e.OnSuccess=2]="OnSuccess"}(i||(i={})),function(e){e[e.Hourly=1]="Hourly",e[e.Daily=2]="Daily"}(o||(o={})),function(e){e[e.ReleaseAudienceGroup=1]="ReleaseAudienceGroup",e[e.WacRing=2]="WacRing",e[e.AppName=3]="AppName",e[e.AppPlatform=4]="AppPlatform",e[e.AppVersion=5]="AppVersion"}(r||(r={})),function(e){e[e.None=0]="None",e[e.MocaAddin=1]="MocaAddin"}(s||(s={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Boolean=1]="Boolean",e[e.String=2]="String",e[e.Int64=3]="Int64",e[e.Double=4]="Double",e[e.Date=5]="Date",e[e.Contract=6]="Contract"}(l||(l={}));const d=new c.a},5208:function(e,t,n){"use strict";n.d(t,{a:function(){return Ve},b:function(){return ke},c:function(){return Ue},d:function(){return Ge},e:function(){return Be},f:function(){return Ne}});var a=n(6009),i=n(4607),o=n(6363),r={};function s(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?r[e]?(t.ariaTenantToken&&(r[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(r[e].dnmToken=t.dnmToken)):r[e]=t:(0,i.b)(0,0,(function(){return"Namespace: ".concat(e)}))}function l(e,t){for(var n=e.length;n>0;){var a=e.substr(0,n);if(r[a]){var i=r[a];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var c=9007199254740991,d=-c,u=98,p=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,g=/^[a-zA-Z0-9_\.]{1,95}$/;function h(e){if(!function(e){if(!e||e.length>u)return!1;return p.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!m(t.name))throw new Error("Invalid eventContract");_(t.dataFields)}_(e.dataFields)}function m(e){return g.test(e)}function _(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!m(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<d||e>c)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var S=n(9457);function f(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,o.a)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var C=function(){function e(e,t,n){var a,i,r;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(a=this.persistentDataFields).push.apply(a,e.persistentDataFields),this.config=(0,o.a)((0,o.a)({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(r=this.persistentDataFields).push.apply(r,t)}return e.prototype.addEventContentType=function(e,t){e.push((0,S.c)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=f(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var a=n.ariaTenantToken;if(!a&&(!l(t.eventName,n)&&!a))return void(0,i.b)(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendNonStandardEvent=function(e,t){var n=f(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=f(e),n=t.telemetryProperties,a=n.customerContentVersion;return(!a||a>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=f(e),n=t.telemetryProperties;if(!n.dnmToken&&(!l(t.eventName,n)&&!n.dnmToken))return void(0,i.b)(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):(0,i.b)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void(0,i.a)(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else(0,i.b)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,a,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift((0,S.d)("OTelJS.Version","4.20.30")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(a=o.dataFields).push.apply(a,this.partAFields),e.eventContract=o}this.config.disableValidation||h(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a[0],o=a[1];this.sendTelemetryEventInternal(i,o)}},e.prototype.setTenantToken=function(e,t,n){s(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){s(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return f(e)},e.prototype.getConfig=function(){return this.config},e}(),y=n(8542),A=function(e){return"number"==typeof e},b=function(){return Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"function"==typeof window.performance.now&&(b=function(){return window.performance.now()});var T=65536,v=4194304,w="dt",F="Data",I="Event",E=".",M="OTelJS",k=M+"Min",P="POST",D="\n";function R(e){return"object"==typeof e}function x(e,t,n){for(var a="",i="",o=0,r=e;o<r.length;o++){var s=r[o],l=a+i+JSON.stringify(s);if(l.length>t)break;a=l,n.sp+=1,i=D}return a}function L(e,t,n,a){U([I,"Source"],M,0,e,t),U([I,"Name"],n,0,e,t),U([I,"Time"],a,w,e,t),U(["baseData","properties","version"],k+"=4.19.5",0,e,t)}function U(e,t,n,a,i){var r,s=t,l=0;if(void 0!==s&&""!==s){switch(A(t)&&(l=6),n){case 3:l=6;break;case 2:l=4;break;case 4:l=8;break;case w:l=9;break;case 0:s="string"==typeof s?s.substr(0,25e3):s}if(i){for(var c=a.data,d=a.ext.metadata,u=0;u<e.length-1;){var p=e[u];if(!p)return;if(c[p]){if(!R(c))return}else c[p]={};if(c=c[p],l){var g=d.f||{};g[p]||(g[p]={}),d.f=g,d=g[p]}u++}var h=e[u];R(c)&&!R(c[h])&&(c[h]=s,l&&(d.f=(0,o.a)((0,o.a)({},d.f),((r={})[h]={t:l},r))))}else{var m=e.join(E);a.data[m]=t,l&&(a.ext.metadata.f[m]={t:l})}}}function O(e,t,n,a){if(0!==e.length&&0!==t.length){var i=n+"?cors=true&w=2&content-type=application/x-json-stream&apikey="+t.join();a.useSendBeacon?function(e,t,n){var a=t.length;if(Boolean(null===navigator||void 0===navigator?void 0:navigator.sendBeacon)){var i=function(e,t){return navigator.sendBeacon(e,t)};if(i(e,x(t,T,n)))n.ss=n.ss+n.sp;else{for(var o=0;o<a&&i(e,JSON.stringify(t[o]));)o++;n.ss+=o,n.sd=n.sp-o}}else n.sd+=a}(i,e,a.stats):function(e,t,n){var a=x(t,v,n),i=new XMLHttpRequest;i.onload=function(){var e=i.responseText;if(e){var t=JSON.parse(e);t.acc&&(n.ss+=parseInt(t.acc,10)),t.rej&&(n.sd+=parseInt(t.rej,10))}},i.onerror=function(){n.sd=n.sp},i.open(P,e),i.send(a)}(i,e,a.stats)}}var B=function(){var e,t,n,a=[];function i(t,n,a){t&&t.forEach((function(t){var i=t.classification;if(4===i||1===i){var o=t.name.split(E);"zC"!==o[0]&&(n&&o.unshift(F),U(o,t.value,t.dataType,a,e))}}))}this.init=function(a,i){var o,r;e=!0===(null===(r=null===(o=i.extensionConfig)||void 0===o?void 0:o.PostChannel)||void 0===r?void 0:r.enableCompoundKey),t=i,n=a},this.enqueue=function(e){return 1===e.t&&(a.push(e),!0)},this.processQueue=function(){var o=[],r={},s=n.uuid(),l=n.stats.pw+1;a.forEach((function(n){var a=n.event.telemetryProperties.ariaTenantToken,c=function(n,a,o,r){var s=n.event,l=s.timestamp,c=(l?new Date(l):new Date).toISOString(),d=s.eventFlags.diagnosticLevel;if(t.enableOptionalEvents||10===d||110===d||120===d){var u=s.eventName,p={name:u,time:c,ver:"4.0",iKey:"o:"+a.substr(0,32),ext:{sdk:{seq:o},metadata:{f:{}}},data:{}};L(p,e,u,c),i(t.persistentDataFields,!1,p),U([I,"Sequence"],o,2,p,e),U([I,"Id"],r+E+o,0,p,e);var g="custom",h=s.eventContract;if(h){var m=h.name;U([I,"Contract"],m,0,p,e),g+=E+m.toLowerCase().replace(/\./g,"_"),i(h.dataFields,!1,p)}return p.data.baseType=g,i(s.dataFields,!0,p),p}}(n,a,l,s);c&&(o.push(c),r[a]=!0,l+=1)})),O(o,Object.keys(r),t.endpointUrl,n)}},N="OTelJSMin:",W=!1;var H="WebSink";function V(e){G(1,e)}function G(e,t){(0,i.b)(e,1,(function(){return H+":"+t}))}var Q,q=function(){function e(e){this.preprocessors=[],this.stats=function(){var e;return(e={}).md=0,e.mm=0,e.mn=0,e.q=0,e.po={},e.pw=0,e.wa=0,e.wp=0,e.wd=0,e.wr={},e.ws=0,e.pm=0,e.sp=0,e.ss=0,e.sd=0,e.wh=0,e.pd={},e.d=0,e.b=0,e.s=0,e}(),this._batchInterval=1e3,this._initialQueueSize=500,this._batchSize=100,this._queue=[],this.enabled=!0,e&&e.queueSize&&(this._initialQueueSize=e.queueSize)}return e.prototype.init=function(e,t){return e.endpointUrl&&t.uuid&&t.getWorker?(e.uploadFrequency&&(this._batchInterval=e.uploadFrequency),e.batchSize&&(this._batchSize=e.batchSize),this._props=e,this._utils=t,!0):(this.enabled=!1,G(0,2),!1)},e.prototype.isInitialized=function(){if(this.enabled){if(this._props)return!0;V(1)}return!1},e.prototype.mergeStats=function(e){var t=this;Object.keys(e).forEach((function(n){A(t.stats[n])?A(e[n])?t.stats[n]+=e[n]:t.stats[n]=e[n]:"wr"===n?Object.keys(e.wr).forEach((function(n){t.stats.wr[n]=t.stats.wr[n]+e.wr||e.wr[n]})):"pd"===n&&Object.keys(e.pd).forEach((function(n){t.stats.pd[n]=t.stats.pd[n]||0+e.pd[n]}))}))},e.prototype.startWorker=function(){var e=this;if(this.isInitialized()){this.stats.s=1;try{this._worker=this._utils.getWorker(),this._worker.addEventListener("message",(function(t){var n=t.data;switch(n.t){case 1:e.handleLoadedMessage();break;case 4:e.mergeStats(n.d);break;case 5:V(n.d);break;default:V(14)}})),this._worker.addEventListener("error",(function(t){V(12),1===e.stats.s&&e.failToStartWorker()})),this._worker.addEventListener("errormessage",(function(e){V(13)}))}catch(e){V(10),this.failToStartWorker()}}},e.prototype.handleLoadedMessage=function(){if(this.isInitialized()){this.stats.s=2,(0,i.b)(2,1,(function(){return H+":Loaded"}));var e={t:2,d:this._props};this._worker.postMessage(e),this.flushQueue()}},e.prototype.failToStartWorker=function(){this.stats.s=4;this.shutdown(!1)},e.prototype.flushQueue=function(){var e=b(),t=this.stats,n=this._queue.slice(0,this._batchSize),a=n.length;this._queue=this._queue.slice(this._batchSize);try{if(a){t.pw+=a;var i={t:3,d:n};this._worker.postMessage(i)}}catch(e){V(11)}finally{var o=b()-e;t.md+=o,o>=t.mm&&(t.mm=o,t.mn=a),this._queueTimeout&&clearTimeout(this._queueTimeout),this._queueTimeout=setTimeout(this.flushQueue.bind(this),this._batchInterval)}},e.prototype.preprocessAndQueueEvent=function(e,t){if(this.enabled){var n=f(e);n.timestamp=n.timestamp||(new Date).getTime();for(var a=0;a<this.preprocessors.length;a++){var i=this.preprocessors[a],o=i.name,r=!1;if(3!==t||"EventThrottler"===o){var s=b();try{r=i.processEvent(n)}catch(e){}var l=b()-s;if(this.stats.pd[o]=this.stats.pd[o]+l||l,!r)return void(this.stats.po[o]=this.stats.po[o]+1||1)}}if(n.dataFields.push((0,S.d)("OTelJS.Sink",H)),2===this.stats.s||this._queue.length<this._initialQueueSize)this.stats.q+=1,this._queue.push({event:n,t});else{V(3),this.stats.s=3;this.shutdown(!1)}}},e.prototype.sendTelemetryEvent=function(e){this.preprocessAndQueueEvent(e,1)},e.prototype.sendCustomerContent=function(e){this.preprocessAndQueueEvent(e,2)},e.prototype.sendNonStandardEvent=function(e,t){this.preprocessAndQueueEvent(e,t)},e.prototype.shutdown=function(e){if(this.isInitialized())try{this.stats.pm=this._queue.length,function(e,t,n){if(W)(0,i.b)(0,1,(function(){return N+20}));else{var a=e.minSinkLimit;a=A(a)?a:500;var o=n.slice(0,a),r=t.minSinkHandlers||[];r.unshift(new B),r.forEach((function(n){n.init(t,e)}));var s=0;try{o.forEach((function(e){var t=!1;r.forEach((function(n){n.enqueue(e)&&(t=!0)})),t||s++})),t.stats.sd+=s,r.forEach((function(e){e.processQueue()})),W=!0}catch(e){(0,i.b)(0,1,(function(){return N+22}))}}}(this._props,{uuid:this._utils.uuid,useSendBeacon:e,minSinkHandlers:this._utils.minSinkHandlers,stats:this.stats},this._queue),this._queue=[]}catch(e){V(30)}this.enabled=!1,this._queueTimeout&&clearTimeout(this._queueTimeout)},e}();function K(e){var t=function(e){return e.timestamp?new Date(e.timestamp):new Date}(e);return t.setMilliseconds(0),t.setSeconds(0),t.setMinutes(0),2===e.telemetryProperties.dnmInterval&&t.setHours(0),t}var z=((Q={})[3]="App.Name",Q[4]="App.Platform",Q[5]="App.Version",Q[2]="WAC.Ring",Q[1]="Release.AudienceGroup",Q),j=function(e){var t,n,a,i=[];function o(e,n,a){var i=!0;if(e)for(var o=0,r=e;o<r.length;o++){var s=r[o],l=s.classification,c=s.dataType,d=s.name;if(l&&4!==l&&1!==l&&2048!==l){i=!1;break}if(n&&3!==c&&1!==c&&2!==c&&"OTelJS.Version"!==d&&"OTelJS.Sink"!==d){i=!1;break}var u=s.name.split(E);"zC"!==u[0]&&(n&&u.unshift(F),U(u,s.value,s.dataType,a,t))}return i}function r(e,a){var i,r=e.event,s=K(e.event).toISOString(),l=r.eventFlags.diagnosticLevel;if(n.enableOptionalEvents||10===l||110===l||120===l){var c,d,u,p=r.eventName,g={name:p,time:s,ver:"4.0",iKey:"o:"+a.substr(0,32),ext:{sdk:{seq:0},metadata:{f:{}},utc:{eventFlags:2097152}},data:{}};if(L(g,t,p,s),o((c=n.persistentDataFields,d=null===(i=r.telemetryProperties)||void 0===i?void 0:i.dnmAllowedPartA,u=[],d&&d.forEach((function(e){var t=z[e];c.forEach((function(e){t===e.name&&u.push(e)}))})),u),!1,g),g.data.baseType="custom",o(r.dataFields,!0,g))return g}}this.init=function(e,i){var o,r;t=!0===(null===(r=null===(o=i.extensionConfig)||void 0===o?void 0:o.PostChannel)||void 0===r?void 0:r.enableCompoundKey),n=i,a=e},this.enqueue=function(e){return 3===e.t&&(i.push(e),!0)},this.processQueue=function(){var t=[],n={};i.forEach((function(e){var a=e.event.telemetryProperties.dnmToken;n[a]=!0;var i=r(e,a);i&&t.push(i)})),O(t,Object.keys(n),e.endpointUrl,a)}},Z=n(4564);function X(e){return{name:"App",contract:{name:"App",dataFields:[re("Name",e.name),re("Platform",e.platform),re("Version",e.version)]}}}function J(e){return{name:"Session",contract:{name:"Session",dataFields:[re("Id",e.sessionId),re("EcsETag",e.flightsImpressionId)]}}}function Y(e){return{name:"Release",contract:{name:"Release",dataFields:[re("AudienceGroup",e.audienceGroup)]}}}function $(e){return{name:"Browser",contract:{name:"Browser",dataFields:[re("Name",e.browserName),re("Version",e.browserVersion)]}}}function ee(e){return{name:"Culture",contract:{name:"Culture",dataFields:[re("UiLanguage",e.appLanguage)]}}}function te(e){return{name:"User",contract:{name:"User",dataFields:[re("PrimaryIdentityHash",e.loggableUserId),re("PrimaryIdentitySpace",e.loggableUserIdSpace),re("TenantId",e.omsTenantId),se("IsAnonymous",e.isAnonymousUser)]}}}function ne(e){return{name:"WAC",contract:{name:"WAC",dataFields:[re("Host",e.host),re("ServerDocId",e.serverDocId),re("Datacenter",e.datacenter),se("IsSynthetic",e.isSynthetic),se("IsBusinessUser",e.isBusinessUser),se("IsEdu",e.isEduUser),re("ApplicationMode",e.applicationMode),re("ApplicationModeExtended",e.applicationModeExtended),re("BrowserLanguage",e.browserLanguage),re("ContentLanguage",e.contentLanguage),re("OsVersion",e.osVersion),re("Ring",e.ring),re("UiHost",e.uiHost),re("SessionOrigin",e.sessionOrigin),re("UiHostIntegrationType",e.uiHostIntegrationType),ce("NetworkDownlink",e.networkDownlink),ce("NetworkDownlinkMax",e.networkDownlinkMax),re("NetworkEffectiveType",e.networkEffectiveType),le("NetworkRTT",e.networkRTT),se("NetworkSaveData",e.networkSaveData),re("NetworkType",e.networkType)]}}}const ae="",ie=!1,oe=0;function re(e,t){return null==t?{name:e,string:ae}:{name:e,string:t}}function se(e,t){return null==t?{name:e,bool:ie}:{name:e,bool:t}}function le(e,t){return null==t?{name:e,int64:oe}:{name:e,int64:t}}function ce(e,t){return null==t?{name:e,double:oe}:{name:e,double:t}}var de,ue,pe=n(5140);!function(e){e[e.msoulscat_MSOSP_OTelJSInWebWoker=226]="msoulscat_MSOSP_OTelJSInWebWoker"}(de||(de={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose"}(ue||(ue={}));var ge=n(2657),he="Office.Telemetry.OTelJS.EventThrottled";function me(e){return"number"==typeof e}var _e=function(){function e(e,t){this._sinkName=e,this._telemetrySink=t,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=e.eventName;if(t===he)return!0;var n=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t]=this._singleEventInLastInterval[t]+1||1,t in this._maxNamedEventsPerSecond?n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxNamedEventsPerSecond[t],"MaxNamedEventsPerSecond",t):me(this._maxSingleEventPerSecond)&&(n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t)),me(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,n&&(n=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t))),n},e.prototype.applyThrottle=function(e,t,n,a){return!(e>t)||(e===t+1&&this._telemetrySink&&!this._eventThrottleReported[a]&&(this._eventThrottleReported[a]=!0,this._telemetrySink.sendTelemetryEvent({eventName:he,telemetryProperties:{ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[(0,S.d)("SinkName",this._sinkName||""),(0,S.d)("ThrottledEvent.Name",a),(0,S.c)(n,t)]})),(0,i.b)(2,1,(function(){return"1DS Sink Event Throttle: Exceeded ".concat(t," ").concat(n,": ").concat(a)})),!1)},e}(),Se=1e3;var fe,Ce,ye=function(){function e(){this.name="Sampler",this.sampleRate=.02}return e.prototype.enableWithIdentifier=function(e,t){return!("string"!=typeof t||t.length<4)&&(this.samplingValue=function(e){var t=function(e){for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}(e);return t%Se/Se}(t),this.samplingKey=e,!0)},e.prototype.enableWithSamplingValue=function(e,t){return!(isNaN(t)||t<0||t>=1)&&(this.samplingValue=t,this.samplingKey=e,!0)},e.prototype.enableWithRandomValue=function(){var e=new Uint32Array(1);return!("object"!=typeof window||!window.crypto)&&(window.crypto.getRandomValues(e),this.samplingValue=e[0]%Se/Se,this.samplingKey="Random",!0)},e.prototype.setSampleRate=function(e){return e>=0&&e<=1&&(this.sampleRate=e,!0)},e.prototype.getSamplingValue=function(){return this.samplingValue},e.prototype.isMeasuresEnabled=function(){return void 0===this.samplingValue||this.samplingValue<this.sampleRate},e.prototype.processEvent=function(e){var t=e.eventFlags.samplingPolicy;return void 0===this.samplingValue||void 0===t||(1===t?!!this.isMeasuresEnabled()&&(this.addSampleRateField(e,this.sampleRate,this.samplingValue),!0):2!==t&&(this.addSampleRateField(e,1,this.samplingValue),!0))},e.prototype.addSampleRateField=function(e,t,n){e.eventContract||(e.eventContract={name:"",dataFields:[]});var a=e.eventContract.dataFields;a.push((0,S.b)("Event.SampleRate",t)),a.push((0,S.b)("Session.SamplingValue",n)),this.samplingKey&&a.push((0,S.d)("Session.SamplingKey",this.samplingKey)),a.push((0,S.a)("Session.MeasuresEnabled",this.isMeasuresEnabled()))},e}();function Ae(e){let t;const n=e.alwaysOnMetadata;if(!n)return t;const a=n.loggableUserId,i=n.sessionId,o=e.sampleRate;return"number"==typeof o&&(t=new ye,t.setSampleRate(o),a&&t.enableWithIdentifier("PrimaryIdentityHash",a)||i&&t.enableWithIdentifier("SessionId",i))?t:void 0}function be(e,t){return t(526513555,de.msoulscat_MSOSP_OTelJSInWebWoker,ue.Warning,"Failed to initialize worker because "+e),{succeeded:!1,failureReason:e}}!function(e){e.WebSinkStat={Bytes:"b",WebWorkerProcessingDuration:"d",MessagingDuration:"md",MaxMessagingDuration:"mm",MaxMessagingDurationNumEvents:"mn",PreprocessingDuration:"pd",PassedToMinSink:"pm",PreprocessedOut:"po",PassedToWebWorker:"pw",Queued:"q",WebWorkerStatus:"s",MinSinkDropped:"sd",MinSinkProcessed:"sp",MinSinkSent:"ss",WebWorkerAccepted:"wa",WebWorkerDropped:"wd",WebWorkerHandlingDuration:"wh",WebWorkerProcessed:"wp",WebWorkerDroppedReason:"wr",WebWorkerSent:"ws"},e.WebWorkerStatus={Uninitialized:0,Initializing:1,Initialized:2,QueueFull:3,Error:4},e.WebSinkError={Uninitialized:1,Initialization:2,QueueFull:3,WorkerInitialization:10,WorkerPostTelemetryEvent:11,WorkerError:12,WorkerErrorMessage:13,WorkerUnhandledMessage:14,WorkerUninitialized:15,MinSinkReused:20,EndpointUrl:21,MinSinkThrows:22,Shutdown:30},e.WebWorkerMessageType={Loaded:1,Initialize:2,TelemetryEvents:3,Stats:4,Error:5}}(fe||(fe={})),function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(Ce||(Ce={}));var Te=n(2764);let ve,we,Fe,Ie=!1,Ee=!1,Me=!0;function ke(){Me=!1}const Pe={processed:0,conversionDurationMs:0,logDurationMs:0,webSinkBatchSize:0};let De,Re="Office.Online.UserAction",xe="Office.Online.Data.Activity";const Le=new Promise((e=>{De=e}));function Ue(){return Boolean(ve)}function Oe(){if(!Ie||!we)return{succeeded:!1,failureReason:"NotEnabled"};(0,ge.h)((()=>{}));const e=we();if(!e)return{succeeded:!1,failureReason:"NoSettings"};if(!e.ulsLoggingMethods||!e.ulsLoggingMethods.sendTraceTag)return{succeeded:!1,failureReason:"ULSLoggingMethods"};const t=e.ulsLoggingMethods.sendTraceTag;if(Ue())return be("WebSinkAlreadyInitialized",t);const n=e.workerUrl;if(!n)return be("WorkerUrl",t);const o=e.telemetryLoggerSettings;if(!o)return be("TelemetrySettings",t);const r=o.ariaEndpointUrl;if(!o.ariaEndpointUrl)return be("AriaUrl",t);const s=o.alwaysOnMetadata;if(!s)return be("AlwaysOnMetadata",t);if(!e.uuid)return be("Uuid",t);e.batchSize&&(Pe.webSinkBatchSize=e.batchSize),(0,i.c)().addListener(He),o.enableCustomerContent&&(Ee=!0),function(e,t){e.name?(Re=`Office.${e.name}.Online.UserAction.`,xe=`Office.${e.name}.Online.Data.Activity.`):t(541411084,de.msoulscat_MSOSP_OTelJSInWebWoker,ue.Verbose,"Cannot determine the App for UserActionEvent, using generic UserAction event name.")}(s,t);const l=(0,a.e)(function(e){return e?[X,J,Y,$,ee,ne,te].map((t=>t(e))):[]}(s)),c=new C(void 0,void 0,{disableValidation:!0});for(const e of Z.a)c.setTenantToken(e.namespace,e.ariaTenant);for(const e of Z.b)c.setDNMToken(e.namespace,e.ariaTenant);let d="",u="";e.pgContext?.userName&&(d=e.pgContext?.userName),e.pgContext?.userAlias&&(u=e.pgContext?.userAlias);const p={context:{UserName:d,UserAlias:u},notificationEventName:pe.b,iKey:pe.a},g=new q;return g.init({endpointUrl:r,persistentDataFields:l,enableOptionalEvents:!0,extensionConfig:{PostChannel:{enableCompoundKey:!0},PrivacyGuardPlugin:p},minSinkLimit:e.minSinkLimit,batchSize:(0,pe.d)(e.batchSize),uploadFrequency:(0,pe.d)(e.batchFrequencyMs),custom:{enableDNM:(0,pe.d)(o.enableDNM),enableCustomerContent:(0,pe.d)(o.enableCustomerContent),enablePG:(0,pe.d)(o.enablePG)}},{uuid:e.uuid,getWorker:()=>{const t=new Blob([`try{importScripts('${encodeURI(n)}');}catch(e){self.postMessage("Error loading Worker script")}`],{type:"application/javascript"});if(!e.TrustedTypesPolicy)return new Worker(URL.createObjectURL(t));try{return new Worker(Te.b.createScriptURL(URL.createObjectURL(t)))}catch{return new Worker(URL.createObjectURL(t))}},minSinkHandlers:(0,pe.d)(e.enableMinSinkDNM)?[new j({endpointUrl:Ce.PUBLIC})]:[]}),o.samplingIsEnabled&&(function(e,t){const n=Ae(t);return n&&e.preprocessors.push(n),n}(g,o)||t(541411083,de.msoulscat_MSOSP_OTelJSInWebWoker,ue.Warning,"Could not enable sampler")),c.addSink(g),De(c),ve={getLogger:()=>c,getWebSink:()=>g,getSettings:()=>e,sendTraceTag:t},(0,ge.g)((e=>{!function(e){if(!Ue())return;ve.sendTraceTag(541411082,de.msoulscat_MSOSP_OTelJSInWebWoker,ue.Info,"SendToWorkerApi with "+e.kind);const t=(0,pe.c)();let n;const i=ve.getLogger();let o=i.sendTelemetryEvent.bind(i);switch(e.kind){case"addNamespaceMapping":return void i.setTenantToken(e.namespace,e.ariaTenantToken);case"setDNMToken":return void i.setDNMToken(e.namespace,e.ariaTenantToken);case"flush":return;case"shutdown":return void function(){const e=ve.getWebSink().stats;Me&&function(e,t,n){const a={eventName:"Office.Online.Telemetry.OTelJS.WebSink.Session.Stats",dataFields:[(0,S.c)("Queued",e[fe.WebSinkStat.Queued]),(0,S.c)("PassedToWebWorker",e[fe.WebSinkStat.PassedToWebWorker]),(0,S.c)("WebWorkerAccepted",e[fe.WebSinkStat.WebWorkerAccepted]),(0,S.c)("WebWorkerProcessed",e[fe.WebSinkStat.WebWorkerProcessed]),(0,S.c)("WebWorkerDropped",e[fe.WebSinkStat.WebWorkerDropped]),(0,S.c)("WebWorkerSent",e[fe.WebSinkStat.WebWorkerSent]),(0,S.b)("MessagingDurationMs",e[fe.WebSinkStat.MessagingDuration]),(0,S.b)("MaxMessagingDurationMs",e[fe.WebSinkStat.MaxMessagingDuration]),(0,S.c)("MaxMessagingDurationNumEvents",e[fe.WebSinkStat.MaxMessagingDurationNumEvents]),(0,S.c)("WebSinkBatchSize",t.webSinkBatchSize),(0,S.b)("WebWorkerProcessingDurationMs",e[fe.WebSinkStat.WebWorkerProcessingDuration]),(0,S.b)("WebWorkerHandlingDurationMs",e[fe.WebSinkStat.WebWorkerHandlingDuration]),(0,S.b)("ConversionDurationMs",t.conversionDurationMs),(0,S.b)("LogDurationMs",t.logDurationMs),(0,S.c)("Bytes",e[fe.WebSinkStat.Bytes]),(0,S.c)("WebWorkerStatus",e[fe.WebSinkStat.WebWorkerStatus])],eventFlags:{samplingPolicy:y.a.SamplingPolicy.CriticalBusinessImpact,diagnosticLevel:y.a.DiagnosticLevel.RequiredServiceData}};if(e[fe.WebSinkStat.PreprocessedOut])for(const t in e[fe.WebSinkStat.PreprocessedOut])"EventThrottler"!==t&&"Sampler"!==t&&"DiagnosticLevel"!==t||a.dataFields.push((0,S.c)("PreprocessedOut."+t,e[fe.WebSinkStat.PreprocessedOut][t]));n.sendTelemetryEvent(a)}(e,Pe,ve.getLogger());ve.getWebSink().shutdown(!0),Me&&function(e,t,n){const a=JSON.stringify({...t,...e});n(526513554,de.msoulscat_MSOSP_OTelJSInWebWoker,ue.Info,a)}(e,Pe,ve.sendTraceTag)}();case"event":n=We((0,a.d)(e.event),e);break;case"dnm":n=We((0,a.c)(e.event),e),o=i.sendDirectNumericEvent.bind(i);break;case"cc":n=We((0,a.b)(e.event),e),o=i.sendCustomerContent.bind(i);break;case"action":n=We(function(e){null==e.name&&(e.name=Re,null!=e.actionName&&(e.name+=e.actionName));return(0,a.f)(e)}(e.event),e);break;case"activity":n=We(function(e){null!=e&&null!=e.name&&(e.name.indexOf("Office.")>=0||(e.name=xe+e.name));return(0,a.a)(e)}(e.event),e);break;case"otel":n=(0,a.g)(e.event);break;case"otelcc":Ee&&(n=(0,a.g)(e.event),o=i.sendCustomerContent.bind(i));break;case"oteldnm":n=(0,a.g)(e.event),o=i.sendDirectNumericEvent.bind(i);break;default:}if(n){const e=(0,pe.c)()-t,a=(0,pe.c)();o(n);const i=(0,pe.c)()-a;Pe.conversionDurationMs+=e,Pe.logDurationMs+=i,Pe.processed+=1}}(e)})),{succeeded:!0}}function Be(e,t){e&&t?(Ie=!0,we=t,(0,ge.h)((()=>Oe()))):(Ie=!1,we=void 0)}function Ne(){const e=Oe();if(!e.succeeded)return e;const t=ve.getWebSink();t.startWorker();return function(e,t){if(t.wacAriaThrottlingIsEnabled){const n=new _e("WebSink",e);n.setSingleEventThrottle((0,pe.d)(t.wacAriaSingleEventThrottlePerSec)),n.setTotalEventThrottle((0,pe.d)(t.wacAriaTotalEventsThrottlePerSec));const a=t.otelEventNamesToBeSuppressedCommaSeparated;a&&a.split(",").forEach((e=>{n.setNamedEventThrottle(e,0)})),e.preprocessors.push(n)}}(t,ve.getSettings().telemetryLoggerSettings),e}function We(e,t){return e.timestamp=t.timestamp,e}function He(e){if(!Ue())return;const t=e.message();let n=ue.Info;const a=e.level;a===y.a.LogLevel.Error?n=ue.Error:a===y.a.LogLevel.Warning&&(n=ue.Warning),e.category===y.a.Category.Sink&&"WebSink"===t.substring(0,7)&&ve.sendTraceTag(540657436,de.msoulscat_MSOSP_OTelJSInWebWoker,n,t)}function Ve(e){e&&Le.then((t=>{t.addSink(e)}))}function Ge(){if(Fe)return Fe.isMeasuresEnabled();if(!Ie||!we)return!1;const e=we();if(!e)return!1;const t=e.telemetryLoggerSettings;return!!t&&(!t.samplingIsEnabled||(Fe=Ae(t),!!Fe&&Fe.isMeasuresEnabled()))}},7938:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(2657),i=n(5208),o=n(5140);class r{sendTelemetryEvent(e){e&&(0,a.p)(e)}sendDirectNumericEvent(e){e&&(0,a.k)(e)}sendCustomerContentEvent(e){e&&(0,a.j)(e)}sendActivityEvent(e){e&&(0,a.i)(e)}sendUserActionEvent(e){e&&(0,a.q)(e)}addNamespaceMapping(e,t){e&&t&&(0,a.b)(e,t)}setDNMToken(e,t){e&&t&&(0,a.r)(e,t)}sendOtelEvent(e){e&&(0,a.o)(e)}sendOtelCustomerContent(e){e&&(0,a.m)(e)}sendOtelDirectNumeric(e){e&&(0,a.n)(e)}setEnabledState(e){(0,a.s)(e)}registerEventHandler(e){e&&(0,a.g)(e)}shutdown(){return(0,a.t)()}setOtelWorkerEnabledState(e,t){return(0,i.e)(e,(0,o.d)(t))}startOtelWorker(){return(0,i.f)()}addSink(e){(0,i.a)((0,o.d)(e))}hasValidLogger(){return(0,i.c)()}isMeasuresEnabled(){return(0,i.d)()}}class s{createInstance(){return new r}}},5140:function(e,t,n){"use strict";n.d(t,{a:function(){return i},b:function(){return a},c:function(){return o},d:function(){return r}});const a="Office.System.PrivacyConcern",i="cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521";function o(){return"undefined"==typeof performance||void 0===performance.now?0:performance.now()}function r(e){if(null!==e)return e}},7449:function(e,t,n){"use strict";n.d(t,{a:function(){return l},b:function(){return s}});var a=n(9461);class i{isEventBlocked(e,t){const n=this.blockedEvents.get(e);return!!n&&(Date.now()>=n?(this.unblockEvent(e),!1):(this.aggregateEventCount(e),t&&(this.eventCallbacks.set(e,t),this.scheduleAndFlushCallbacks()),!0))}scheduleAndFlushCallbacks(){void 0===this.batchTimerId&&this.eventCallbacks.size>0&&(this.batchTimerId=window.setTimeout((()=>{const e=Date.now(),t=[];this.eventCallbacks.forEach(((n,a)=>{const i=this.blockedEvents.get(a);i&&e>=i&&(n(),t.push(a))}));for(const e of t)this.blockedEvents.delete(e),this.eventCallbacks.delete(e);this.batchTimerId=void 0,this.scheduleAndFlushCallbacks()}),1e4))}blockEvent(e,t){const n=Date.now()+t;this.blockedEvents.set(e,n),this.updateEventHitCount(e,0),this.eventDurations.delete(e),this.eventDurationsTotal.delete(e)}unblockEvent(e){this.blockedEvents.delete(e)}getEventHitCount(e){return this.eventHitCounts.get(e)}updateEventHitCount(e,t){this.eventHitCounts.set(e,t)}aggregateEventCount(e){let t=this.getEventHitCount(e);"number"==typeof t&&this.updateEventHitCount(e,++t)}getEventDurations(e){return this.eventDurations.get(e)}aggregateEventDuration(e,t){const n=(this.getEventHitCount(e)??0)+1,a=this.eventDurationsTotal.get(e),i=this.eventDurations.get(e);if(void 0!==i){const o=[...i];let r;i[0]>t&&(o[0]=t),i[1]<t&&(o[1]=t),void 0!==a&&a.length<10?(a.push(t),r=a.reduce(((e,t)=>e+t),0)/n):(r=i[2]+(t-i[2])/n,this.eventDurationsTotal.delete(e)),o[2]=r,this.eventDurations.set(e,o)}else this.eventDurations.set(e,[t,t,t]),this.eventDurationsTotal.set(e,[t])}constructor(){this.blockedEvents=new Map,this.eventCallbacks=new Map,this.eventHitCounts=new Map,this.eventDurations=new Map,this.eventDurationsTotal=new Map,this.batchTimerId=void 0}}class o{logKpiUsage(e,t,n,a){const i=this.getKpiKey(e+o.USAGE_KPI,n?.extendedProperties),r=()=>this.recordKpiUsage(e,t,n,i);if(this.kpiUsageEventBlocker.isEventBlocked(i,r))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(n),r(),0!==a){const e=a??3e5;this.kpiUsageEventBlocker.blockEvent(i,e)}return!0}logKpiFailure(e,t,n,a,i){const r=this.getKpiKey(e+o.FAILURE_KPI+t,n?.additionalValues?.extendedProperties);"number"==typeof n?.additionalValues?.durationMs&&this.kpiFailureEventBlocker.aggregateEventDuration(r,n.additionalValues.durationMs);const s=()=>this.recordKpiFailure(e,t,n,r);if(this.kpiFailureEventBlocker.isEventBlocked(r,s))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),s(),a&&this.recordQosError(a.errorNameOverride??t,a.name,a),0!==i){const e=i??3e5;this.kpiFailureEventBlocker.blockEvent(r,e)}return!0}logKpiSuccess(e,t,n){const a=this.getKpiKey(e+o.SUCCESS_KPI,t?.additionalValues?.extendedProperties);"number"==typeof t?.additionalValues?.durationMs&&this.kpiSuccessEventBlocker.aggregateEventDuration(a,t.additionalValues.durationMs);const i=()=>this.recordKpiSuccess(e,t,a);if(this.kpiSuccessEventBlocker.isEventBlocked(a,i))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),i(),0!==n){const e=n??3e5;this.kpiSuccessEventBlocker.blockEvent(a,e)}return!0}ensureFeatureDenominatorLoggedAndVetoPillarRegistered(e){const t=this.featureConfig.topLevelKpiName,n=this.getKpiKey(this.featureConfig.topLevelKpiName,e?.extendedProperties);if(this.kpiUsageEventBlocker.isEventBlocked(n??""))return;this.recordKpiUsage(t,s.FailureBased,e);const a=this.featureConfig.vetoPillar??this.featureConfig.areaName;a&&o.QOS_PILLARS_LIST.includes(a)&&this.healthLogger.addQosPillar(a),this.kpiUsageEventBlocker.blockEvent(n??"",864e5)}recordKpiUsage(e,t,n={},a){const{extendedProperties:i,isForAlertableKpi:o}=n||{},r=this.createExtendedPropertiesWithMoreFields(i,a);o?this.healthLogger.recordKpiUsageForAlertableKpi(e,this.featureConfig.crewAlias,r):this.healthLogger.recordKpiUsage(e,t,this.featureConfig.crewAlias,r)}getKpiKey(e,t){const n=this.getKpiAreaName(t),a=this.getKpiFeatureName(t),i=this.getKpiPivot(t);return`${n}.${a}.${e??""}${i&&0!==i.length?"."+i:""}`}getKpiAreaName(e){return e?.get(o.AREA_NAME_COLUMN_KEY)??this.featureConfig.areaName??this.featureConfig.vetoPillar??""}getKpiFeatureName(e){return e?.get(o.FEATURE_NAME_COLUMN_KEY)??this.featureConfig.featureName??""}getKpiPivot(e){const t=e?.get(o.PIVOT_TYPE_COLUMN_KEY),n=e?.get(o.PIVOT_VALUE_COLUMN_KEY);return t&&0!==t.length&&n&&0!==n.length?`${t}=${n}`:""}recordKpiFailure(e,t,n={},a){const{isIntentional:i,isInternal:o,additionalValues:r,hasImpliedUsage:s}=n||{},l=this.createAdditionalValuesWithMoreFields(r,a);!1===s?this.healthLogger.recordKpiFailure(e,t,i,o,l):this.healthLogger.recordKpiImpliedFailure(e,t,i,o,this.featureConfig.crewAlias,l)}recordKpiSuccess(e,t={},n){const{additionalValues:a,hasImpliedUsage:i}=t||{},o=this.createAdditionalValuesWithMoreFields(a,n);!1===i?this.healthLogger.recordKpiSuccess(e,o):this.healthLogger.recordKpiImpliedSuccess(e,this.featureConfig.crewAlias,o)}recordQosError(e,t,n={}){const{isIntentional:a,isInternal:i,alertOnPillar:o,isSessionEndingError:r,additionalValues:s}=n,l=this.createAdditionalValuesWithMoreFields(s);this.healthLogger.recordQosError(e,[t],a,i,o,r,l)}createExtendedPropertiesWithMoreFields(e,t){const n=new Map(e||new Map);if(n.get(o.FEATURE_NAME_COLUMN_KEY)||n.set(o.FEATURE_NAME_COLUMN_KEY,this.getKpiFeatureName(e)),n.set(o.AREA_NAME_COLUMN_KEY,this.getKpiAreaName(n)),n.has(o.SKIP_ARIA_COLUMN_KEY)||n.has("skipAria")||n.set(o.SKIP_ARIA_COLUMN_KEY,"true"),!this.featureConfig.doNotEmitAggregatedCount&&t){const e=this.getEventBlocker(t);if(e){const a=e.getEventHitCount(t);if(a){n.set(o.AGGREGATED_COUNT_COLUMN_KEY,a.toString());const i=e.getEventDurations(t);a>1&&i&&n.set(o.AGGREGATED_DURATION_COLUMN_KEY,i.map((e=>Math.round(100*e)/100)).toString())}}}return n}createAdditionalValuesWithMoreFields(e,t){let n={};return n={...e},n.extendedProperties=this.createExtendedPropertiesWithMoreFields(e?.extendedProperties,t),n}getEventBlocker(e){return e.includes(o.USAGE_KPI)?this.kpiUsageEventBlocker:e.includes(o.FAILURE_KPI)?this.kpiFailureEventBlocker:e.includes(o.SUCCESS_KPI)?this.kpiSuccessEventBlocker:void 0}constructor(e,t,n,a,i){this.healthLogger=e,this.featureConfig=t,this.kpiUsageEventBlocker=n,this.kpiFailureEventBlocker=a,this.kpiSuccessEventBlocker=i}}o.FEATURE_NAME_COLUMN_KEY="FeatureName",o.AREA_NAME_COLUMN_KEY="AreaName",o.AGGREGATED_COUNT_COLUMN_KEY="AggCount",o.AGGREGATED_DURATION_COLUMN_KEY="AggMs",o.SKIP_ARIA_COLUMN_KEY="SkipAria",o.PIVOT_TYPE_COLUMN_KEY="PivotType",o.PIVOT_VALUE_COLUMN_KEY="PivotValue",o.QOS_PILLARS_LIST=["Interruptions","Open","NotebookNavigation","Fidelity","AsyncCollab","Present","ContentConsumption","bSqmCompatibility","Boot"],o.USAGE_KPI=".Usage",o.SUCCESS_KPI=".Success",o.FAILURE_KPI=".Failure.";class r{static getInstance(e,t,n,a,i){return new r(e,t,n,a,i)}logKpiUsage(e){return!(!e||!e.kpiName)&&this.featureUsageAndHealthLogger.logKpiUsage(e.kpiName,e.kpiType??s.FailureBased,e.optionalProperties,e.blockFutureEmissionDurationInMs)}logKpiFailure(e){return!!(e&&e.kpiName&&e.errorName)&&this.featureUsageAndHealthLogger.logKpiFailure(e.kpiName,e.errorName,e.optionalProperties,e.optionalVeto,e.blockFutureEmissionDurationInMs)}logKpiSuccess(e){return!(!e||!e.kpiName)&&this.featureUsageAndHealthLogger.logKpiSuccess(e.kpiName,e.optionalProperties,e.blockFutureEmissionDurationInMs)}ensureFeatureDenominatorLoggedAndVetoPillarRegistered(e){this.featureUsageAndHealthLogger.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(e)}constructor(e,t,n,a,i){this.healthLogger=e,this.featureConfig=t,this.kpiUsageEventBlocker=n,this.kpiFailureEventBlocker=a,this.kpiSuccessEventBlocker=i,this.featureUsageAndHealthLogger=new o(this.healthLogger,this.featureConfig,this.kpiUsageEventBlocker??r.kpiUsageBlocker,this.kpiSuccessEventBlocker??r.kpiFailureBlocker,this.kpiFailureEventBlocker??r.kpiSuccessBlocker),this.executeCallbackWithLogging=(e,t)=>{const n=e=>"VetoFailureLoggingParams".includes(e);let a,i;t?.kpiUsageLoggingParams?(a="Usage",i=t?.kpiUsageLoggingParams):t?.kpiSuccessLoggingParams?(a="UsageWithSuccess",i=t?.kpiSuccessLoggingParams):t?.kpiFailureLoggingParams?(a="UsageWithFailure",i=t?.kpiFailureLoggingParams):(a="UsageWithVetoFailure",i=t?.vetoFailureLoggingParams);const o=i?.usageName,r=i?.usageKpiType;this.logKpiUsage({kpiName:o,kpiType:r??s.FailureBased});try{e?.(),"UsageWithSuccess"===a&&"KpiSuccessLoggingParams".includes(i)&&this.logKpiSuccess({kpiName:o,optionalProperties:i.successOptionalProperties})}catch(e){if("UsageWithFailure"===a&&(e=>"KpiFailureLoggingParams".includes(e))(i)||"UsageWithVetoFailure"===a&&n(i)){let e;n(i)&&(e={name:i.vetoName??"",...i.vetoOptionalProperties}),this.logKpiFailure({kpiName:i.usageName,errorName:i.failureErrorName,optionalProperties:i.failureOptionalProperties,optionalVeto:e})}throw e}}}}r.kpiUsageBlocker=new i,r.kpiFailureBlocker=new i,r.kpiSuccessBlocker=new i;var s;!function(e){e[e.FailureBased=0]="FailureBased",e[e.SuccessBased=1]="SuccessBased"}(s||(s={}));const l=new class{getHealthInstance(e){if(e)return a.a.getInstance().initialize(e),a.a.getInstance()}getExtendedHealthInstance(e,t){if(e&&t)return r.getInstance(e,t)}}},9461:function(e,t,n){"use strict";var a;function i(e){if(!e)return;const t={};return e.forEach(((e,n)=>{n&&(t[n]="string"==typeof e||e instanceof String?e:o(e))})),t}function o(e){try{return JSON.stringify(e)}catch(e){return`Error stringifying object: ${e instanceof Error?e.message:"unknown error occurred"}`}}function r(e,t){const n=[],a=new Set;return e.concat(t).forEach((e=>a.add(e))),a.forEach((e=>n.push(e))),n}n.d(t,{a:function(){return h}}),function(e){e[e.Failure=0]="Failure",e[e.ImpliedUsageFailure=1]="ImpliedUsageFailure",e[e.ImpliedUsageSuccess=2]="ImpliedUsageSuccess",e[e.Success=3]="Success",e[e.Usage=4]="Usage"}(a||(a={}));var s,l,c,d,u,p=n(7449),g=n(2764);!function(e){e[e.BSqmError=0]="BSqmError",e[e.Kpi=1]="Kpi",e[e.QosError=2]="QosError",e[e.QosPillar=3]="QosPillar",e[e.DiagnosticLog=4]="DiagnosticLog",e[e.OfflineWorkerInit=5]="OfflineWorkerInit",e[e.OfflineWorkerFlush=6]="OfflineWorkerFlush",e[e.OfflineWorkerFailedUpload=7]="OfflineWorkerFailedUpload"}(s||(s={})),function(e){e.HealthDimensions="d",e.PartCDimensions="a",e.BSqmErrors="b",e.QosErrors="e",e.Heartbeat="h",e.QosPillars="q",e.Kpis="k",e.DiagnosticLogs="l",e.ClientSendTime="t"}(l||(l={})),function(e){e[e.AttemptToUseFunctionalityBeforeIitialization=0]="AttemptToUseFunctionalityBeforeIitialization",e[e.WorkerApiIsNotAvailable=1]="WorkerApiIsNotAvailable",e[e.InvalidWorkerUrl=2]="InvalidWorkerUrl",e[e.InstallingOfflineWorker=3]="InstallingOfflineWorker",e[e.OfflineWorkerMessage=4]="OfflineWorkerMessage",e[e.FailedToProcessMessageFromOfflineWorker=5]="FailedToProcessMessageFromOfflineWorker",e[e.FailedToInstallOfflineWorker=6]="FailedToInstallOfflineWorker",e[e.InitializedHealth=7]="InitializedHealth",e[e.BatchesOfHealthEventsInIndexedDB=8]="BatchesOfHealthEventsInIndexedDB",e[e.IndexedDbTransactionFailed=9]="IndexedDbTransactionFailed",e[e.InstalledOfflineWorker=10]="InstalledOfflineWorker",e[e.IndexedDdIsNotSupported=11]="IndexedDdIsNotSupported",e[e.GetAllKeysIsNotSupported=12]="GetAllKeysIsNotSupported",e[e.FailedToProcessMessage=13]="FailedToProcessMessage",e[e.FailedToLoadWorkerScript=14]="FailedToLoadWorkerScript",e[e.FailedToSendEventToWorker=15]="FailedToSendEventToWorker",e[e.FailedToJsonStringifyEvent=16]="FailedToJsonStringifyEvent",e[e.IndexedDbEntryIsNotAnObject=17]="IndexedDbEntryIsNotAnObject"}(c||(c={})),function(e){e[e.AttemptedToAddOrUpdatePartCDimension=0]="AttemptedToAddOrUpdatePartCDimension",e[e.AttemptedToRecordBSqmQosError=1]="AttemptedToRecordBSqmQosError",e[e.AttemptedToRecordSessionEndingQosError=2]="AttemptedToRecordSessionEndingQosError",e[e.AttemptedToSetAppOnlineStatus=3]="AttemptedToSetAppOnlineStatus",e[e.AttemptedToUpdatePartADimensions=4]="AttemptedToUpdatePartADimensions"}(d||(d={})),function(e){e[e.SendSucceeded=0]="SendSucceeded",e[e.SendFailed=1]="SendFailed",e[e.DidNotAttempt=2]="DidNotAttempt"}(u||(u={}));class h{static getInstance(e=!1){return h._instance&&!e||(h._instance=new h),this._instance}initialize(e){if(e)try{return this._healthConfig=function(e){return{_dimensions:e.dimensions??void 0,_heartbeatIntervalMs:e.heartbeatIntervalMs??3e5,_isHealthEnabled:e.isHealthEnabled??!1,_isOfflineEnabled:e.isOfflineEnabled??!1,_isErrorPartCEnabled:e.isErrorPartCEnabled??!1,_isFetchApiEnabled:e.isFetchApiEnabled??!1,_maxIntervalMs:e.loggerMaxIntervalMs??3e4,_maxQueueSize:e.loggerMaxQueueSize??25,_offlineWorkerUrl:e.offlineWorkerUrl??"",_absoluteTelemetryUrl:e.absoluteRemoteTelemetryUrlForOfflineWorker??"",_pillarIntervalMs:e.recordPillarToWarmPipelineIntervalMs??864e5,_telemetryUrl:e.remoteTelemetryUrl??"",_maxConcurrentRetries:e.maxConcurrentRetries??3,_retryMaxAttempts:e.retryMaxAttempts??3,_retryDelayMs:e.retryDelayMs??15e3,_disabledHealthEvents:e.disabledHealthEvents??new Set}}(e),this._updateMinifiedPartADimensions(),this._loggerScheduleEventUploadTimer(),this._startOfflineWorker(e.TrustedTypesPolicy??!1),this._initializationCompleted=!0,void this._diagnosticLog(c.InitializedHealth)}catch(e){}this._initializationCompleted=!1}addOrUpdatePartCDimension(e,t){this._checkForInitialization(d.AttemptedToAddOrUpdatePartCDimension)&&e&&(this._additionalPartCDimensions.hasOwnProperty(e)&&this._additionalPartCDimensions[e]===t||(this._loggerSendEventsAndRequeue(!0),this._additionalPartCDimensions[e]=t,this._dimensionsVersion+=1,this._logHeartbeatEvent(),this._logAllPillars()))}addOrUpdateErrorPartCDimension(e,t){this._healthConfig._isErrorPartCEnabled&&e&&(this._additionalErrorPartCDimensions[e]=t)}addQosPillar(e){if(e){const t=0===this._sessionPillars.length;-1===this._sessionPillars.indexOf(e)&&(this._sessionPillars.push(e),this._logPillar(e,!1),this._pillarsChanged(t))}}recordBsqmQosError(e,t,n){if(this._checkForInitialization(d.AttemptedToRecordBSqmQosError)&&(this._stopAllHealthTimers(!1),this._logAllPillars(),e)){const a={b:e,v:t,d:n?.durationMs,p:i(n?.extendedProperties),s:this._sessionPillars,i:n?.inStaging};this._loggerQueueEvent(s.BSqmError,a,e),this.shutdown(!0)}}recordKpiFailure(e,t,n,i,o){this._logKpiEvent(e,!0,a.Failure,o,t,i,n)}recordKpiImpliedFailure(e,t,n,i,o,r){this._logKpiEvent(e,!1,a.ImpliedUsageFailure,r,t,i,n,p.b.FailureBased,!1,o)}recordKpiImpliedSuccess(e,t,n){this._logKpiEvent(e,!1,a.ImpliedUsageSuccess,n,void 0,void 0,void 0,p.b.FailureBased,!1,t)}recordKpiSuccess(e,t){this._logKpiEvent(e,!0,a.Success,t)}recordKpiUsage(e,t,n,i){this._logKpiEvent(e,!1,a.Usage,{extendedProperties:i},void 0,void 0,void 0,t,!1,n)}recordKpiUsageForAlertableKpi(e,t,n){if(!e)return;let i=!0;const o=this._kpis[e];o&&(i=o.t===p.b.FailureBased),this._logKpiEvent(e,!1,a.Usage,{extendedProperties:n},void 0,void 0,void 0,p.b.FailureBased,!0,t),i&&this._startHeartbeatIfNotAlreadyStarted()}recordQosErrorForCopilot(e,t,n,a,i,o,r,s){const l=s?{...s}:{};l.extendedProperties=l.extendedProperties?{...l.extendedProperties}:new Map,l.extendedProperties.set("Copilot.InteractionId",e),this.recordQosError(t,n,a,i,o,r,l)}recordQosError(e,t,n,a,o,r,l){if((!r||this._checkForInitialization(d.AttemptedToRecordSessionEndingQosError))&&e&&t){const c={n:e,x:n,z:a,l:o,v:t,e:r,d:l?.durationMs,p:i(l?.extendedProperties),s:this._sessionPillars,i:l?.inStaging};this._loggerQueueEvent(s.QosError,c,e),r&&(this._stopAllHealthTimers(!1),this._logAllPillars(),this.shutdown(!0))}}removeQosPillar(e){if(!e)return;const t=this._sessionPillars.indexOf(e);t>-1&&(this._sessionPillars.splice(t,1),this._pillarsChanged(!1)),0===this._sessionPillars.length&&this._stopPeriodicPillarEvents()}resumeAllHealthTimers(){if(this._heartbeatInitialStartCalled&&!this._heartbeatRunning&&this._logHeartbeatAndReQueue(),0===this._recordPillarTimerId&&0!==this._recordPillarLastTimestamp){const e=Date.now()-this._recordPillarLastTimestamp;e>=this._healthConfig._pillarIntervalMs||e<=0?this._logPillarsAndReQueue():this._queueLogPillars(this._healthConfig._pillarIntervalMs-e)}}setHandlerForIsAppShuttingDown(e){e&&(this._isAppShuttingDown=e)}setIsAppOnline(e){this._checkForInitialization(d.AttemptedToSetAppOnlineStatus)&&(!this._isAppOnline&&e&&this._offlineWorker?.postMessage({t:s.OfflineWorkerFlush,v:this._isAppShuttingDown()}),this._isAppOnline=e)}shutdown(e=!1){this._healthConfig._isHealthEnabled&&(this._loggerCancelEventUploadTimer(),this._stopAllHealthTimers(!1),this._isAppShuttingDown=()=>!0,this._loggerFlush(),(!e||e&&this._isAppOnline)&&this._offlineWorker?.terminate())}stopAllHealthTimers(){this._stopAllHealthTimers(!0)}_stopAllHealthTimers(e){this._heartbeatRunning=!1,this._heartbeatOrderingNumber=-1,0!==this._heartbeatSendTimerId&&(window.clearTimeout(this._heartbeatSendTimerId),this._heartbeatSendTimerId=0),this._stopPeriodicPillarEvents(),e&&this._loggerFlush()}updatePartADimensions(e){if(!e||!this._checkForInitialization(d.AttemptedToUpdatePartADimensions))return;let t=!1;Object.keys(e).forEach((n=>{void 0!==e[n]&&null!==e[n]&&""!==e[n]&&this._healthConfig._dimensions[n]!==e[n]&&(this._healthConfig._dimensions[n]=e[n],t=!0)})),t&&(this._loggerSendEventsAndRequeue(),this._updateMinifiedPartADimensions(),this._dimensionsVersion+=1,this._logHeartbeatEvent(),this._logAllPillars())}flushAndSetNewEndpoint(e,t){e.localeCompare(this._healthConfig._telemetryUrl??"",void 0,{sensitivity:"accent"})&&(this._loggerSendEventsAndRequeue(!1),this._healthConfig._telemetryUrl=e,t&&t())}constructor(){this._additionalPartCDimensions={},this._additionalErrorPartCDimensions={},this._alertableKpiNames=[],this._dimensions={},this._dimensionsVersion=0,this._healthConfig={_heartbeatIntervalMs:3e5,_isHealthEnabled:!1,_isOfflineEnabled:!1,_isErrorPartCEnabled:!1,_maxIntervalMs:3e4,_maxQueueSize:25,_offlineWorkerUrl:"",_pillarIntervalMs:864e5,_telemetryUrl:"",_absoluteTelemetryUrl:"",_maxConcurrentRetries:3,_retryMaxAttempts:3,_retryDelayMs:15e3,_disabledHealthEvents:new Set,_isFetchApiEnabled:!1},this._heartbeatInitialStartCalled=!1,this._heartbeatOrderingNumber=-1,this._heartbeatRunning=!1,this._heartbeatSendTimerId=0,this._isAppOnline=!0,this._isAppShuttingDown=()=>!1,this._kpis={},this._loggerBSqmQosErrorQueue=[],this._loggerCurrentQueueSize=0,this._loggerNonHeartbeatDiagnosticLogsOrPillarsQueueSize=0,this._loggerQueuedHeartbeatEvent=void 0,this._loggerKpiQueue=[],this._loggerQosErrorQueue=[],this._loggerQosPillarQueue=[],this._loggerDiagnosticLogQueue=[],this._loggerSendTimerId=0,this._recordPillarLastTimestamp=0,this._recordPillarTimerId=0,this._sessionPillars=[],this._hasAtLeastOneRequestSucceeded=!1,this._currentRetriesCount=0,this.isUrlOriginPolicyEnabled=!1,this._initializationCompleted=!1,this._loggerCancelEventUploadTimer=()=>{this._loggerSendTimerId&&(window.clearTimeout(this._loggerSendTimerId),this._loggerSendTimerId=0)},this._loggerEmptyQueues=()=>{this._loggerBSqmQosErrorQueue=[],this._loggerKpiQueue=[],this._loggerQosErrorQueue=[],this._loggerQueuedHeartbeatEvent=void 0,this._loggerQosPillarQueue=[],this._loggerDiagnosticLogQueue=[],this._loggerCurrentQueueSize=0,this._loggerNonHeartbeatDiagnosticLogsOrPillarsQueueSize=0},this._loggerFlush=()=>{try{if(this._loggerCurrentQueueSize<=0)return;const e=this._loggerFormatPayload();this._healthConfig._isFetchApiEnabled?this._tryUpload_fetchApi(e,this._dimensionsVersion,this._healthConfig._retryMaxAttempts):this._tryUpload(e,this._dimensionsVersion,this._healthConfig._retryMaxAttempts),this._loggerEmptyQueues()}catch(e){}},this._loggerFormatPayload=()=>({d:this._dimensions,a:this._getMergedPartC(),b:this._loggerBSqmQosErrorQueue,e:this._loggerQosErrorQueue,h:this._loggerQueuedHeartbeatEvent,q:this._loggerQosPillarQueue,k:this._loggerKpiQueue,l:this._loggerDiagnosticLogQueue,type:"h_v2"}),this._getMergedPartC=()=>{if(!this._healthConfig._isErrorPartCEnabled)return this._additionalPartCDimensions;return(!!this._loggerBSqmQosErrorQueue&&this._loggerBSqmQosErrorQueue.length>0||!!this._loggerQosErrorQueue&&this._loggerQosErrorQueue.length>0)&&Object.keys(this._additionalErrorPartCDimensions).length>0?{...this._additionalPartCDimensions,...this._additionalErrorPartCDimensions}:this._additionalPartCDimensions},this._loggerQueueEvent=(e,t,n,a=!1)=>{if(t&&!this._healthConfig._disabledHealthEvents.has(n))if(this._isAppOnline){switch(e){case s.BSqmError:this._loggerBSqmQosErrorQueue.push(t);break;case s.Kpi:this._loggerKpiQueue.push(t);break;case s.QosError:this._loggerQosErrorQueue.push(t);break;case s.QosPillar:-1===this._loggerQosPillarQueue.map((e=>e.n)).indexOf(t.n)&&this._loggerQosPillarQueue.push(t);break;case s.DiagnosticLog:this._loggerDiagnosticLogQueue.push(t)}if(this._loggerCurrentQueueSize+=1,e!==s.DiagnosticLog&&e!==s.QosPillar&&(this._loggerNonHeartbeatDiagnosticLogsOrPillarsQueueSize+=1),this._isAppShuttingDown()&&!a)return void this._loggerFlush();this._loggerCurrentQueueSize>=this._healthConfig._maxQueueSize&&(this._loggerCancelEventUploadTimer(),this._loggerSendEventsAndRequeue())}else t.o=(new Date).toJSON(),this._offlineWorker?.postMessage({t:e,k:`${this._dimensions.w}.${this._dimensionsVersion}`,m:this._dimensions,c:this._getMergedPartC(),v:t})},this._loggerScheduleEventUploadTimer=()=>{this._loggerCancelEventUploadTimer(),this._loggerSendTimerId=window.setTimeout((()=>{this._loggerSendEventsAndRequeue()}),this._healthConfig._maxIntervalMs)},this._loggerSendEventsAndRequeue=(e=!1)=>{e&&this._loggerNonHeartbeatDiagnosticLogsOrPillarsQueueSize<=0||(this._loggerFlush(),this._loggerScheduleEventUploadTimer())},this._logHeartbeatEvent=()=>{if(!this._sessionPillars&&!this._kpis)return;this._loggerQueuedHeartbeatEvent&&-1!==this._heartbeatOrderingNumber||(this._heartbeatOrderingNumber=(this._heartbeatOrderingNumber+1)%1e3),this._loggerQueuedHeartbeatEvent||(this._loggerCurrentQueueSize+=1);const e={p:this._loggerQueuedHeartbeatEvent?r(this._loggerQueuedHeartbeatEvent.p,this._sessionPillars):this._sessionPillars,k:this._loggerQueuedHeartbeatEvent?r(this._loggerQueuedHeartbeatEvent.k,this._alertableKpiNames):this._alertableKpiNames,i:this._healthConfig._heartbeatIntervalMs,o:this._heartbeatOrderingNumber};this._loggerQueuedHeartbeatEvent=e},this._logKpiEvent=(e,t,n,a,o,r,l,c,d,u)=>{if(!e||t&&!this._kpis[e])return;t||this._initKpiIfNeeded(e,c,d,u);const p=this._kpis[e],g={n:p.k,e:n,t:p.t,a:p.a,f:p.o,d:a?.durationMs,p:i(a?.extendedProperties)};if(o){const e={n:o,x:l,z:r};g.k=e}this._loggerQueueEvent(s.Kpi,g,e)},this._updateMinifiedPartADimensions=()=>{const e=this._healthConfig._dimensions;e&&(this._dimensions={a:e.application??void 0,b:e.applicationLcid??void 0,c:e.applicationMode??void 0,d:e.applicationModeExtended??void 0,e:e.arrVersion??void 0,f:e.browser??void 0,g:e.browserLcid??void 0,h:e.browserMajorVersion??void 0,i:e.browserVersion??void 0,j:e.clientVersion??void 0,k:e.datacenter??void 0,l:e.dataCulture??void 0,m:e.flightsImpressionId??void 0,n:e.host??void 0,o:e.isAnonymousUser??void 0,p:e.isBusinessUser??void 0,q:e.isEduUser??void 0,r:e.isSynthetic??void 0,s:e.loggableUserId??void 0,t:e.loggableUserIdSpace??void 0,u:e.ring??void 0,v:e.serverDocId??void 0,w:e.session_id??void 0,x:e.sessionOrigin??void 0,y:e.tenantId??void 0,z:e.uiHost??void 0,aa:e.wfeVersion??void 0,ab:e.fileExtension??void 0,ac:e.uiHostIntegrationType??void 0,ad:e.osVersion??void 0,af:e.networkDownlink??void 0,ag:e.networkDownlinkMax??void 0,ah:e.networkEffectiveType??void 0,ai:e.networkRTT??void 0,aj:e.networkSaveData??void 0,ak:e.networkType??void 0,al:e.userLicenseType??void 0})},this._logHeartbeatAndReQueue=()=>{this._logHeartbeatEvent(),this._heartbeatSendTimerId=window.setTimeout((()=>{this._logHeartbeatAndReQueue()}),this._healthConfig._heartbeatIntervalMs)},this._logAllPillars=()=>{this._sessionPillars&&this._sessionPillars.forEach((e=>{e&&this._logPillar(e,!0)}))},this._logPillar=(e,t)=>{const n={};n.n=e,this._loggerQueueEvent(s.QosPillar,n,e,t)},this._logPillarsAndReQueue=()=>{this._sessionPillars&&(this._recordPillarLastTimestamp=Date.now(),this._logAllPillars()),this._queueLogPillars()},this._queueLogPillars=(e=this._healthConfig._pillarIntervalMs)=>{this._recordPillarTimerId=window.setTimeout((()=>{this._logPillarsAndReQueue()}),e)},this._startHeartbeatIfNotAlreadyStarted=()=>{this._heartbeatInitialStartCalled||(this._heartbeatInitialStartCalled=!0,this._heartbeatRunning=!0,this._logHeartbeatAndReQueue())},this._stopPeriodicPillarEvents=()=>{0!==this._recordPillarTimerId&&(window.clearTimeout(this._recordPillarTimerId),this._recordPillarTimerId=0)},this._startOfflineWorker=e=>{if(this._healthConfig._isHealthEnabled&&this._healthConfig._isOfflineEnabled&&this._healthConfig._absoluteTelemetryUrl&&""!==this._healthConfig._absoluteTelemetryUrl&&this._healthConfig._offlineWorkerUrl&&""!==this._healthConfig._offlineWorkerUrl){this.isUrlOriginPolicyEnabled=e;try{if("undefined"==typeof Worker)return void this._diagnosticLog(c.WorkerApiIsNotAvailable);if(!this._healthConfig._offlineWorkerUrl)return void this._diagnosticLog(c.InvalidWorkerUrl);this._diagnosticLog(c.InstallingOfflineWorker);const e=new Blob([`try{importScripts('${encodeURI(this._healthConfig._offlineWorkerUrl)}');}catch(e){self.postMessage({i:14,l:'W',r:e.toString()})}`],{type:"application/javascript"});if(this.isUrlOriginPolicyEnabled)try{this._offlineWorker=new Worker(g.b.createScriptURL(URL.createObjectURL(e)))}catch{this._offlineWorker=new Worker(URL.createObjectURL(e))}else this._offlineWorker=new Worker(URL.createObjectURL(e));this._offlineWorker.onmessage=e=>{try{const t=e.data;this._diagnosticLog(t.i,t.r)}catch(e){this._diagnosticLog(c.FailedToProcessMessageFromOfflineWorker,e.toString())}},this._offlineWorker.postMessage({t:s.OfflineWorkerInit,v:this._healthConfig._absoluteTelemetryUrl}),this._offlineWorker.postMessage({t:s.OfflineWorkerFlush})}catch(e){this._diagnosticLog(c.FailedToInstallOfflineWorker,e.toString())}}},this._trySendPayloadToOfflineWorker=(e,t)=>{if(e.b.length>0||e.e.length>0||e.q.length>0||e.k.length>0||e.l.length>0)try{return this._offlineWorker?.postMessage({t:s.OfflineWorkerFailedUpload,k:`${e.d.w}.${t}`,v:e}),u.SendSucceeded}catch(e){const t=this._convertExceptionToExtraRuntimeInfo(e);return this._diagnosticLog(c.FailedToSendEventToWorker,t),u.SendFailed}return u.DidNotAttempt},this._initKpiIfNeeded=(e,t,n,a)=>{e&&void 0!==t&&(this._kpis[e]||(this._kpis[e]={k:e,t,a:!0===n,o:a??void 0},n&&(this._alertableKpiNames.push(e),this._logHeartbeatEvent())))},this._pillarsChanged=e=>{this._heartbeatOrderingNumber=-1,e?(this._recordPillarLastTimestamp=Date.now(),this._queueLogPillars(),this._startHeartbeatIfNotAlreadyStarted()):this._logHeartbeatEvent()},this._checkForInitialization=e=>!!this._initializationCompleted||(this._diagnosticLog(c.AttemptToUseFunctionalityBeforeIitialization,e?.toString()),!1),this._tryUpload=(e,t,n)=>{if(!e)return;const a=this._healthConfig._telemetryUrl;if(""===a)return;if(this._hasAtLeastOneRequestSucceeded&&(n<=0||!this._isAppOnline)){if(this._trySendPayloadToOfflineWorker(e,t)!==u.SendFailed)return}if(n<=0)return;const i=this._jsonStringifyNoThrow(e,!1);if(null===i)return;if(this._isAppShuttingDown())try{if(void 0!==navigator.sendBeacon){if(i.length>=65536&&this._healthConfig._isErrorPartCEnabled){const t={...e,a:this._additionalPartCDimensions},n=this._jsonStringifyNoThrow(t,!0);if(null===n)return;navigator.sendBeacon(a,n)}else navigator.sendBeacon(a,i);return}}catch(e){}const o=new XMLHttpRequest;o.open("POST",a,!0),o.onreadystatechange=()=>{o.readyState===XMLHttpRequest.DONE&&(200===o.status?this._hasAtLeastOneRequestSucceeded||(this._hasAtLeastOneRequestSucceeded=!0):this._currentRetriesCount<this._healthConfig._maxConcurrentRetries?(this._currentRetriesCount+=1,window.setTimeout((()=>{this._currentRetriesCount-=1,this._tryUpload(e,t,n-1)}),this._healthConfig._retryDelayMs)):this._hasAtLeastOneRequestSucceeded&&this._trySendPayloadToOfflineWorker(e,t))},o.send(i)},this._diagnosticLog=(e,t)=>{const n={i:e,r:t};this._loggerQueueEvent(s.DiagnosticLog,n,e.toString())},this._convertExceptionToExtraRuntimeInfo=e=>{let t;return"string"==typeof e?t=e:e instanceof Error&&(t=e.name+" "+e.message,e.stack&&(t+=" "+e.stack)),t},this._jsonStringifyNoThrow=(e,t)=>{try{return o(e)}catch(e){let n=this._convertExceptionToExtraRuntimeInfo(e);return n="ModifiedPayload: "+t+" | "+n,this._diagnosticLog(c.FailedToJsonStringifyEvent,n),null}},this._tryUpload_fetchApi=(e,t,n)=>{if(!e)return;const a=this._healthConfig._telemetryUrl;if(""===a)return;if(this._hasAtLeastOneRequestSucceeded&&(n<=0||!this._isAppOnline)){if(this._trySendPayloadToOfflineWorker(e,t)!==u.SendFailed)return;if(n<=0)return}const i=this._jsonStringifyNoThrow(e,!1);if(null!==i){if(this._isAppShuttingDown())try{if(i.length>=65536&&this._healthConfig._isErrorPartCEnabled){const t={...e,a:this._additionalPartCDimensions},n=this._jsonStringifyNoThrow(t,!0);if(null===n)return;fetch(new Request(a,{method:"POST",body:n,keepalive:!0})).catch((()=>{}))}else fetch(new Request(a,{method:"POST",body:i,keepalive:!0})).catch((()=>{}));return}catch(e){}fetch(new Request(a,{method:"POST",body:i})).then((a=>{a.ok?this._hasAtLeastOneRequestSucceeded||(this._hasAtLeastOneRequestSucceeded=!0):this._currentRetriesCount<this._healthConfig._maxConcurrentRetries?(this._currentRetriesCount+=1,globalThis.setTimeout((async()=>{this._currentRetriesCount-=1,this._tryUpload_fetchApi(e,t,n-1)}),this._healthConfig._retryDelayMs)):this._hasAtLeastOneRequestSucceeded&&this._trySendPayloadToOfflineWorker(e,t)})).catch((e=>{}))}}}}},734:function(e,t,n){"use strict";var a;n.d(t,{a:function(){return a}}),function(e){e[e.Interruptions=0]="Interruptions",e[e.Open=1]="Open",e[e.Save=2]="Save",e[e.VetoMissingClassification=3]="VetoMissingClassification",e[e.RealTimeCoauth=4]="RealTimeCoauth",e[e.NotebookNavigation=5]="NotebookNavigation",e[e.Fidelity=6]="Fidelity",e[e.AsyncCollab=7]="AsyncCollab",e[e.Present=8]="Present",e[e.ContentConsumption=9]="ContentConsumption",e[e.ContentCreation=10]="ContentCreation",e[e.bSqmCompatibility=11]="bSqmCompatibility",e[e.Boot=12]="Boot"}(a||(a={}))},1212:function(e,t,n){"use strict";var a,i;n.d(t,{a:function(){return a},b:function(){return i}}),function(e){e.init="SharedAuth_Init",e.initAndGetToken="SharedAuth_InitAndGetToken",e.setSharedSettings="SharedAuth_SetSharedSettings",e.showSignInCancelButtons="SharedAuth_ShowSignInCancelButtons",e.tryGetToken="SharedAuth_TryGetToken",e.tryLogin="SharedAuth_TryLogin"}(a||(a={})),function(e){e.closeDialog="SharedAuth_CloseDialog",e.getSharedSettings="SharedAuth_GetSharedSettings",e.getTokenResponse="SharedAuth_GetTokenResponse",e.hideDialog="SharedAuth_HideDialog",e.interactiveFlowReady="SharedAuth_InteractiveFlowReady",e.loginResponse="SharedAuth_LoginResponse",e.scriptInitialized="SharedAuth_ScriptInitialized",e.scriptLoaded="SharedAuth_ScriptLoaded",e.signInExecute="SharedAuth_SignInExecute"}(i||(i={}))},2594:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});const a={},i="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t},o=(e,t,n=i)=>{try{a[e]||(a[e]=n.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch{console.info(`Skipped duplicate policy creation: ${e}`)}return a[e]}},4069:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(9502);const i={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},o=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],r=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],s=(e,t)=>{let n=!1;const s=t?(e=>({...i,ALLOW_ARIA_ATTR:!1!==e.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR:!1!==e.ALLOW_DATA_ATTR,FORCE_BODY:e.FORCE_BODY||!1,IN_PLACE:e.IN_PLACE||!1,SAFE_FOR_TEMPLATES:e.SAFE_FOR_TEMPLATES||!1,SANITIZE_DOM:!1!==e.SANITIZE_DOM,SANITIZE_NAMED_PROPS:e.SANITIZE_NAMED_PROPS||!1,USE_PROFILES:!!e.USE_PROFILES&&e.USE_PROFILES,WHOLE_DOCUMENT:e.WHOLE_DOCUMENT||!1,PARSER_MEDIA_TYPE:e.PARSER_MEDIA_TYPE?e.PARSER_MEDIA_TYPE:"text/html"}))(t):i,l=(0,a.sanitize)(e,s);return t?.USE_PROFILES?l:(n=(e=>{let t=!1,n=!1;const a=new Set,i=new Set;return e.length>0&&(e.forEach((e=>{e.attribute?(n=r.includes(e.attribute.localName)||n,a.add(e.attribute.localName)):e.element&&(n=o.includes(e.element.localName)||n,i.add(e.element.localName))})),(a.size>0||i.size>0)&&(n||(t=!0))),t})(a.removed),n?e:l)}},2764:function(e,t,n){"use strict";n.d(t,{a:function(){return r},b:function(){return s}});var a=n(2594);const i=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-dod.cdn.office.net","https://res-gcch.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-1.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://res-h1.cdn.office.net","https://res-2.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net/","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://word-edit.officeapps.live.com","https://ppc-word-edit.officeapps.live.com","https://ffc-word-edit.officeapps.live.com","https://fus1-word-edit.officeapps.live.com","https://fil1-word-edit.officeapps.live.com","https://fin1-word-edit.officeapps.live.com","https://eurppc-word-edit.officeapps.live.com","https://ffc-word-view.officeapps.live.com","https://ppc-word-view.officeapps.live.com","https://wordwebclientbuilds.blob.core.windows.net"],o=new RegExp("https?://(localhost|local\\.teams\\.(office|live)\\.com)(:|/|$)"),r=e=>i.includes(e)||o.test(e),s=(l="urlOriginPolicy",(0,a.a)(l,{createScriptURL:e=>{const{origin:t}=new URL(e,document.baseURI);if(r(t))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e}`)}},c));var l,c},6921:function(e,t,n){"use strict";n.r(t),n.d(t,{App:function(){return ni}});var a=n(100),i=n(625),o=n(3245);class r{get shouldRunThrottledAction(){const e=(new Date).getTime();if(e<this._sleepUntilTime)return!1;if(!this._windowStartTime)return this._windowStartTime=e,this._sleepUntilTime=0,!0;const t=e-this._windowStartTime;if(t>200){const n=this._measuredActionTotalMs/t;return this._measuredActionTotalMs=0,n>.8?(this._windowStartTime=0,this._sleepUntilTime=e+50,!1):(this._windowStartTime=e,!0)}return!0}recordThrottledActionTime(e){this._measuredActionTotalMs+=e}constructor(){this._windowStartTime=0,this._measuredActionTotalMs=0,this._sleepUntilTime=0}}(0,a.a)(r,"ThrottlingManager",null,[320]);var s=n(385);class l{get openInClientCommandUrl(){return l._openInClientCommandUrl}set_openInClientCommandUrl(e){return l._openInClientCommandUrl=this.supportsOpenInClientForAllApps?e:"",e}setPropertiesFromAppSettings(e){if(e){this.breadcrumbDocName=e.BreadcrumbDocName||"",this.set_openInClientCommandUrl(e.OpenInClientCommandUrl||""),this.breadcrumbFolderName=e.BreadcrumbFolderName||"",this.breadcrumbFolderUrl=e.BreadcrumbFolderUrl||"",this.breadcrumbBrandUrl=e.BreadcrumbBrandUrl||"",this.breadcrumbBrandName=e.BreadcrumbBrandName||"";const t=e.SharingStatus||"";this.sharingStatus=l.parseSharingStatus(t),this.maxFileNameLength=o.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LimitExcelFileName")?e.MaxFileNameLength:void 0}}get supportsOpenInClientForAllApps(){return!this.isAndroid||o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICForAndroidIsEnabled")}get isAndroid(){return window.navigator.userAgent.indexOf("Android")>=0}static parseSharingStatus(e){let t;switch(e){case"Private":t=1;break;case"Shared":t=2;break;default:t=0}return t}constructor(e){this.breadcrumbDocName="",this.breadcrumbFolderName="",this.breadcrumbFolderUrl="",this.breadcrumbBrandUrl="",this.breadcrumbBrandName="",this.set_openInClientCommandUrl(""),this.sharingStatus=0,e&&o.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((()=>{this.setPropertiesFromAppSettings(o.AFrameworkApplication.appSettingsManager.appSettings)}))}}l._openInClientCommandUrl=null,(0,a.a)(l,"DocPropertiesProvider",null,[74]);var c=n(7826),d=n(9865),u=n(4361),p=n(1891),g=n(680),h=n(2929);class m extends h.a{static create(e,t,n){return new m(e,t,n)}constructor(e,t,n){if(super(e,t,n,0),this.origin=null,this.data=null,this.source=null,n.rawEvent){const e=n.rawEvent;this.origin=e.origin,this.source=e.source,this.data=e.data}else this.origin="",this.source=null,this.data=""}}(0,a.a)(m,"WindowEventArgs",h.a,[]);class _{dispose(){}addHandler(e,t,n){this._eventHandlerManager.registerHandler(e,this._window,2,this.onWindowEvent,t,n)}removeHandler(e,t){this._eventHandlerManager.unregisterHandler(e,this._window,t)}constructor(){this.onWindowEvent=(e,t,n)=>{const a=m.create(e,this._window,n);return this._eventHandlerManager.processEvent(e,t,a)},_._windowEventManagerNumber++,this._window=window.self,this._eventHandlerManager=d.EventHandlerManager.instance}}_._windowEventManagerNumber=0,(0,a.a)(_,"WindowEventManager",null,[317,11]);var S=n(1163),f=n(9531),C=n(8585),y=n(6808),A=n(6923),b=n(629),T=n(2544),v=n(2217),w=n(9855),F=n(4706);class I{static dispose(){b.FocusManager.disposeInputManager(),A.a.disposeInputManager(),C.a.disposeInputManager(),y.a.disposeInputManager(),F.a.disposeInputManager(),v.a.disposeInputManager(),w.a.disposeInputManager(),T.a.disposeInputManager(),f.a.disposeInputManager(),d.EventHandlerManager.disposeInputManager()}}(0,a.a)(I,"Disposer",null,[]);var E=n(7905),M=n(3660),k=n(5149);const P="SessionOrigin",D="Ring",R="SovereignEnvironmentName";class x{static keyOf(e){return Object.getOwnPropertyNames(e).map((t=>e[t])).join(".")}get tokenData(){return this._tokenData}get count(){return this._count}get key(){return this._key}increment(){this._count++}constructor(e){this._tokenData=e,this._count=1,this._key=x.keyOf(e)}}(0,a.a)(x,"WacTokenDataCounter",null,[]);const L=3e5;class U{static get instance(){return U._singletonInstance||(U._singletonInstance=new U)}log(e){const t=x.keyOf(e);let n=this._tokenDataMap.get(t);n?n.increment():(n=new x(e),this._tokenDataMap.set(t,n))}dispose(){window.clearInterval(this._intervalId),this.logInternal(!0)}logInternal(e=!1){const t=Array.from(this._tokenDataMap.values());if(!e&&t.length<this._minimumEntryCountForLogging||e&&!t.length)return;this._tokenDataMap.clear();const n=t.map((e=>({...e.tokenData,Count:e.count})));k.ULS.sendTraceTag(506810770,3e3,20,JSON.stringify({Session:this._session,Token:n}))}constructor(){this._intervalId=0,this._tokenDataMap=new Map;const e=o.AFrameworkApplication&&o.AFrameworkApplication.appSettingsManager,t=o.AFrameworkApplication&&o.AFrameworkApplication.sessionStartInfoSettings;this._timeout=(e&&e.getIntAppSetting("WacTokenDataLoggerTimeout",L))??L,this._minimumEntryCountForLogging=(e&&e.getIntAppSetting("WacTokenMinimumEntryCountForLogging",5))??5,this._session={UiHost:e?.getStringAppSetting(o.AFrameworkApplication.uiHostSettingName)??"",UiHostIntegrationType:e?.getStringAppSetting(o.AFrameworkApplication.uiHostIntegrationTypeSettingName)??"",[P]:e?.getStringAppSetting(P)??"",[D]:t?.[D]??"",IsCommercial:e?.getBooleanAppSetting("IsO365CommercialHost")??!1,IsConsumer:e?.getBooleanAppSetting("IsO365ConsumerHost")??!1,[R]:e?.getStringAppSetting(R)??""},this._intervalId=window.setInterval(this.logInternal.bind(this),this._timeout)}}U._singletonInstance=null,(0,a.a)(U,"WacTokenDataLogger",null,[11]);var O=n(2594),B=n(4069),N=n(2764);const W=()=>{var e;(0,O.a)("default",{createHTML:(e,t,n)=>"Element innerHTML"===n&&ae(K)?ie.has(e)?e:(0,B.a)(e):"DOMParser parseFromString"===n&&ae(Z)?e:void 0,createScript:(e,t,n)=>{if("eval"===n&&ae(X)||"HTMLScriptElement text"===n&&ae(te))return e},createScriptURL:(e,t,n)=>{if("HTMLScriptElement src"===n&&ae($)||"Element setAttribute"===n&&ae(ee)){const{origin:t}=new URL(e);if((0,N.a)(t))return e}}},e)},H=/https?:\/\/[^\s/$.?#].[^\s]*/g,V=new RegExp(`(${/\/officeonline\/hashed\/[0-9a-fA-F]+\//.source}|(${/\/1js\/(build|pr)\/[0-9a-fA-F]+/.source}(${/\/wd1js\/ship\/we\/app_scripts\/((wp5|ac)\/)?/.source}|${/\/wo\/webpack\/((wp5|ac)\/)?/.source}|/lib-es5/))?)`),G=new RegExp(`(${V.source})(common|common50|commonux|jquery|compatparentelementfix|sharedcommentslazy)\\.(min\\.)?js`),Q=new RegExp("/officeonline/versioned/mathjax-lowercase-patched/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/mathjax/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/(config/|jax/output/html-css/)?(mathjax|jax|mml_htmlormml)\\.js"),q=new RegExp("/scripts/me/mecontrol/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/[a-zA-Z]{1,10}-[a-zA-Z]{1,10}/meboot.min.js"),K=new RegExp(`(${G.source})|(${Q.source})|(${q.source})`),z=new RegExp(`(${V.source})microsoftajaxds\\.js`),j=new RegExp("/officeonline/versioned/mathjax-lowercase-patched/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/mathjax/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/config/mml_htmlormml.js"),Z=new RegExp(`(${z.source})|(${j.source})`),X=new RegExp(`(${V.source})(mathdesigner|microsoftajaxds)\\.(min\\.)?js`),J=new RegExp("office-growth/resources/programmablesurfaces/int/officewebsurfaces\\.core\\.(min\\.)?js"),Y=new RegExp(`(${V.source})(lpplazy|mathjax|midgardbootstrapper)\\.(min\\.)?js`),$=new RegExp(`${J.source}|${Y.source}`),ee=new RegExp(`(${V.source})common\\.(min\\.)?js`),te=new RegExp("/officeonline/versioned/mathjax-lowercase-patched/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/mathjax/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/mathjax.js"),ne=e=>"https://amcdn.msftauth.net"===e||(0,N.a)(e),ae=e=>{try{throw new Error}catch(t){if(!t.stack)return!1;const n=t.stack.match(H);if(!n?.length)return!1;for(const t of n)try{const{origin:n,pathname:a}=new URL(t);if(!ne(n))continue;const i=a.toLowerCase().match(e);if(i?.length)return!0}catch{}return!1}},ie=new Set(["","<input/>","<a href='#'></a>","<option></option>","<textarea>x</textarea>","<form></form><form></form>","<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>","Add-ins","Bold (Ctrl+B)","Border Options","Bullets","Bullets (Ctrl+.)","Catch up","Checklist (Ctrl+,)","Click to see page load statistics","Clipboard","Clear Formatting","Comments","Copy (Ctrl+C)","Copilot","Cut (Ctrl+X)","Decrease Indent (Ctrl+Shift+M)","Designer","Dictate","Dictate (Alt+`)","Editor","Emphasis","Find","Find (Ctrl+F)","Font Color","Font Name","Font Size","Format Painter (Ctrl+Alt+C, Ctrl+Alt+V) <br /> To apply the formatting in multiple places, double-click Format Painter.","Grow Font Size (Ctrl+Shift+>)","Heading 1","Heading 2","Headings and Other Styles","Help Improve Office","Highlight","Increase Indent (Ctrl+M)","Italic (Ctrl+I)","Mode Menu: Editing","More Collaboration Options","More Options","Normal","Numbering","Numbering (Ctrl+/)","Line Spacing","Paragraph Options","Paragraph Shading","Paste","RibbonOptionsTooltip","Saved <br /> Click the cloud icon to view file location","Sensitivity","Separate Pages","Set Proofing Language","Share","Share: this file is shared","Show Developer Tools Menu","Shrink Font Size (Ctrl+Shift+<)","Strikethrough (Ctrl+Shift+X)","Subscript (Ctrl+Shift+-)","Subtitle","Superscript (Ctrl+Shift++)","Switch to light background","Text Alignment","The current page number in the document. Click or tap to open the Navigation Pane.","The number of words in the selection or document. Click or tap to open the word count dialog box.","Title","Underline (Ctrl+U)","Undo","Undo (Ctrl+Z)","Zoom","Zoom In","Zoom Level","Zoom Out","Zoom to fit page width"]);class oe extends o.AFrameworkApplication{initialize(e){if(super.initialize(e),o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsTrustedTypesDefaultPolicyEnabled",!1))try{W()}catch{}if(o.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsLoadScriptTrustedTypesPolicyEnabled",!1))try{appResourceLoader.setTrustedTypesPolicy(N.b)}catch{}o.AFrameworkApplication.theWindowEventManager=new _,u.a.instance.registerActions(o.AFrameworkApplication.theActionManager),o.AFrameworkApplication.theActionManager.throttlingManager=oe.theThrottlingManager,p.a.instance.userSessionId=o.AFrameworkApplication.userSessionId,p.a.instance.recordAppInitStart(o.AFrameworkApplication.bootTime),p.a.instance.recordResourceDownloadStart(),p.a.instance.recordResourceDownloadEnd(),p.a.instance.recordBootResourceTimings(),p.a.instance.recordPaintTimings(),p.a.instance.recordSplashScreenShown();const t=o.AFrameworkApplication.appSettingsManager.getLongAppSetting("HostProvidedClickTime",-1);t>0&&p.a.instance.recordUserClickedInHostUi(t),p.a.instance.recordNewFileMetrics(o.AFrameworkApplication.isNewFile,o.AFrameworkApplication.newFileTemplateName,o.AFrameworkApplication.newFileTemplateLcid),o.AFrameworkApplication.docPropertiesProvider=new l(e);Boolean.parse(e.AvoidCallStackReThrow||"false")&&!S.a.isSafari9Up||d.EventHandlerManager.instance.setOnExceptionOccurred((e=>{throw c.a(e),e})),s.a.get_instance().executeWhen(6,(0,i.a)(o.AFrameworkApplication.theActionManager,o.AFrameworkApplication.theActionManager.logUnhandledKeyboardActions,"logUnhandledKeyboardActions"))}dispose(){g.a.safeDispose(o.AFrameworkApplication.theWindowEventManager),o.AFrameworkApplication.theWindowEventManager=null,super.dispose(),I.dispose(),E.a.instance.dispose(),M.a.instance.dispose(),U.instance.dispose()}initializeBrowserSqm(e){super.initializeBrowserSqm(e),p.a.instance.initWsaClient(o.AFrameworkApplication.theWsaClient)}checkHostCanaryValidityAndRedirectIfNeeded(e,t){o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("InvalidHostCanary")&&e&&this.redirectOutside(e,t)}static get theThrottlingManager(){return oe._theThrottlingManager||(oe._theThrottlingManager=new r)}static set theThrottlingManager(e){oe._theThrottlingManager=e}constructor(e,t=!0){super(e,t)}}oe._theThrottlingManager=null,(0,a.a)(oe,"WebApp",o.AFrameworkApplication,[]);var re=n(6336),se=n(7296),le=n(9454),ce=n(2219),de=n(5721),ue=n(2280),pe=n(3792);const ge=(0,pe.b)("Common.App.NetworkConnectivity.NetworkConnectivityManager");var he=n(1520),me=n(9969);class _e{shouldSendRequest(e){let t=!1;if((o.AFrameworkApplication.isWopiTokenRefreshEnabled||_e.isAuthedRequest(e))&&(t=E.a.instance.checkAndTriggerSessionHasExpired()),o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.holdRequestsWhenSessionHasExpired&&t&&_e.isAuthedRequest(e)){const t=me.a.removeAllUrlParameters(e);return k.ULS.sendTraceTag(6636637,205,50,"Session has expired, so hold client request for [Url: {0}].",t),!1}return!0}static isAuthedRequest(e){const t=this.getNonAuthedUrls();return!me.a.isEndingWithSpecificUrl(e.toLowerCase(),t)}static getNonAuthedUrls(){const e=new he.a;return o.AFrameworkApplication.theWsaClient&&e.add(o.AFrameworkApplication.theWsaClient.uploadUrl.toLowerCase()),e.add("remoteuls.ashx"),e.add("remotetelemetry.ashx"),e.toArray()}static getProcessor(){return _e._instance||(_e._instance=new _e),_e._instance}}_e._instance=null,(0,a.a)(_e,"ClientRequestAuthProcessor",null,[]);var Se=n(4262),fe=n(9505),Ce=n(1493),ye=n(9858),Ae=n(1509);class be{updateAdditionalHeaders(e,t){this._additionalHeaders[e]=t}getModifiedUrl(e,t,n){t?o.AFrameworkApplication.requiresCrossDomainAjax&&(e=this.addQueryParameterToUrl(e,o.AFrameworkApplication.userSessionIdQueryParam,t)):n&&o.AFrameworkApplication.requiresCrossDomainAjax&&(e=this.addQueryParameterToUrl(e,o.AFrameworkApplication.userSessionIdQueryParam,n));const a=this._getBooleanFeatureGate("Microsoft.Office.WordOnline.LogRedirectionHeaderOnServer",!1),i=this._getBooleanFeatureGate("Microsoft.Office.WordOnline.WACFrontEndPerUrlIsEnabled",!1);return(a||i)&&(e=this.addQueryParameterToUrl(e,"DebugRedirectionInfo","true")),e=this.updateExpirableParamsUrl(e)}createUrlForShuttingDownRequest(e,t,n,a,i){return t&&(e=this.addOrReplaceQueryParameter(e,o.AFrameworkApplication.userSessionIdQueryParam,t)),o.AFrameworkApplication.buildVersion&&(e=this.addOrReplaceQueryParameter(e,"build",o.AFrameworkApplication.buildVersion)),n&&!this.shouldSkipDCSpecificRequest(e)&&(e=this.addOrReplaceQueryParameter(e,"waccluster",n)),o.AFrameworkApplication.userType&&(e=this.addOrReplaceQueryParameter(e,"WacUserType",o.AFrameworkApplication.userType)),o.AFrameworkApplication.canary&&(e=this.addOrReplaceQueryParameter(e,"ckey",o.AFrameworkApplication.canary)),_e.isAuthedRequest(e)&&(e=this.addOrReplaceQueryParameter(e,o.AFrameworkApplication.accessTokenParamName,o.AFrameworkApplication.accessToken),e=this.addOrReplaceAccessTokenTtlParamOnUrl(e)),i?(e=this.addOrReplaceQueryParameter(e,Se.a.endpointParamName,i.endpoint.toString()),0!==i.scenario&&(e=this.addOrReplaceQueryParameter(e,Se.a.scenarioParamName,i.scenario.toString())),e=this.addOrReplaceQueryParameter(e,Se.a.scenarioTypeParamName,i.scenarioType.toString())):e=this.addOrReplaceQueryParameter(e,Se.a.endpointParamName,a.toString()),e}setRequestHeaders(e,t,n,a,i,r,s,l,c,d,u,p,g,h){e["X-xhr"]="1",o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("CAETokenSecurePodsAPIs")&&o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SecureAPIsWithCAEToken",!1)&&(o.AFrameworkApplication.appSettingsManager.appSettings.WOPISrc&&!e.hasOwnProperty("X-WOPISrc")&&(e["X-WOPISrc"]=ye.a.httpHeaderEncode(o.AFrameworkApplication.appSettingsManager.appSettings.WOPISrc)),o.AFrameworkApplication.accessToken&&!e.hasOwnProperty("X-AccessToken")&&(e["X-AccessToken"]=ye.a.httpHeaderEncode(o.AFrameworkApplication.accessToken)),o.AFrameworkApplication.accessTokenServerExpirationTime&&!e.hasOwnProperty("X-AccessTokenTtl")&&(e["X-AccessTokenTtl"]=o.AFrameworkApplication.accessTokenServerExpirationTime.toString())),i?o.AFrameworkApplication.requiresCrossDomainAjax||(e["X-UserSessionId"]=ye.a.httpHeaderEncode(i)):s&&(o.AFrameworkApplication.requiresCrossDomainAjax||(e["X-UserSessionId"]=ye.a.httpHeaderEncode(s))),o.AFrameworkApplication.collectPageStats&&(e[ce.a.showPageStatsXHRHeader]=1),h&&(e["X-NetCoreRouting"]=h),(r||o.AFrameworkApplication.buildVersion)&&(e["X-OfficeVersion"]=ye.a.httpHeaderEncode(r||o.AFrameworkApplication.buildVersion));const m=this.shouldSkipClusterAndFeHeadersForUrl(t);!l||this.shouldSkipDCSpecificRequest(t)||m||(e["X-WacCluster"]=l);for(const t in this._additionalHeaders)e[t]=this._additionalHeaders[t];const _=this._getBooleanAppSetting("ShouldBrowserSendWacFrontEndHeader");if(this._getBooleanFeatureGate("Microsoft.Office.WordOnline.WACFrontEndPerUrlIsEnabled",!1)&&_&&!m?c?(e["X-WacFrontEnd"]=c,k.ULS.sendTraceTag(537995235,205,50,"Url {0} WACFrontEndHeader {1}",n,c)):k.ULS.sendTraceTag(537995264,205,50,"No FrontEnd for Url {0}",n):d&&_&&!m&&(e["X-WacFrontEnd"]=d),u&&(e["X-WacUserAgent"]=u),o.AFrameworkApplication.coauthManager&&(e["X-IsCoauthSession"]=(!o.AFrameworkApplication.coauthManager.getAmIAlone).toString()),a)for(const t in a){const n={key:t,value:a[t]};n.value&&(e[n.key]=ye.a.httpHeaderEncode(n.value.toString()))}if(this._getBooleanAppSetting("LogWhenClientRequestFailedEnabled")&&!("X-CorrelationId"in e)&&(e["X-CorrelationId"]=Ae.a.create().toString()),o.AFrameworkApplication.userType&&(e["X-UserType"]=ye.a.httpHeaderEncode(o.AFrameworkApplication.userType)),null!=g)e[Se.a.endpointParamName]=g.endpoint.toString(),e[Se.a.scenarioParamName]=g.scenario.toString(),e[Se.a.scenarioTypeParamName]=g.scenarioType.toString();else{let t=1;o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance&&(t=Se.a.getOfficeEndpointFromAppType(o.AFrameworkApplication.activeFrame.applicationInstance.officeAppType)),e[Se.a.endpointParamName]=t.toString()}this.updateExpirableRequestHeaders(e,t,p)}updateExpirableRequestHeaders(e,t,n){this._getBooleanAppSetting("SetRequestExpirableHeadersDuringInvoke")?(o.AFrameworkApplication.canary&&(me.a.hasParameterValue(t,"ckey")||(e["X-Key"]=ye.a.httpHeaderEncode(o.AFrameworkApplication.canary)),o.AFrameworkApplication.logCanaryInBrowser&&k.ULS.sendTraceTag(6063237,205,50,"Canary in request: {0}",e["X-Key"])),o.AFrameworkApplication.accessToken&&(me.a.hasParameterValue(t,o.AFrameworkApplication.accessTokenParamName)||(e["X-AccessToken"]=ye.a.httpHeaderEncode(o.AFrameworkApplication.accessToken)),me.a.hasParameterValue(t,o.AFrameworkApplication.accessTokenTtlParamName)||(e["X-AccessTokenTtl"]=o.AFrameworkApplication.accessTokenServerExpirationTime.toString()))):(o.AFrameworkApplication.canary&&(e["X-Key"]=ye.a.httpHeaderEncode(o.AFrameworkApplication.canary),o.AFrameworkApplication.logCanaryInBrowser&&k.ULS.sendTraceTag(571532887,205,50,"Canary in request: {0}",e["X-Key"]),o.AFrameworkApplication.logCanaryInBrowser&&k.ULS.sendTraceTag(508859714,205,50,"Canary in request: {0}",e["X-Key"])),o.AFrameworkApplication.accessToken&&(me.a.hasParameterValue(t,o.AFrameworkApplication.accessTokenParamName)||(e["X-AccessToken"]=ye.a.httpHeaderEncode(o.AFrameworkApplication.accessToken)),me.a.hasParameterValue(t,o.AFrameworkApplication.accessTokenTtlParamName)||(e["X-AccessTokenTtl"]=o.AFrameworkApplication.accessTokenServerExpirationTime.toString()))),this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenForAllRequestsIsEnabled",!1)&&(e["X-AttachAADToken"]="1");const a=this.shouldIncludeWacAadTokenHeaderWithBrsAndNullCheck(t,n);a&&(e["X-AADToken"]=n),this.shouldIncludeWACAADTokenHeader(t)&&this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacTokenDataLogging",!1)&&U.instance.log({Endpoint:me.a.getPageName(t),IncludesAadTokenHeader:a})}updateExpirableParamsUrl(e){return this._getBooleanAppSetting("SetRequestExpirableHeadersDuringInvoke")&&(o.AFrameworkApplication.canary&&me.a.hasParameterValue(e,"ckey")&&(e=this.addOrReplaceQueryParameter(e,"ckey",o.AFrameworkApplication.canary)),o.AFrameworkApplication.accessToken&&(me.a.hasParameterValue(e,o.AFrameworkApplication.accessTokenParamName)&&(e=this.addOrReplaceQueryParameter(e,o.AFrameworkApplication.accessTokenParamName,o.AFrameworkApplication.accessToken)),me.a.hasParameterValue(e,o.AFrameworkApplication.accessTokenTtlParamName)&&(e=this.addOrReplaceAccessTokenTtlParamOnUrl(e)))),e}addOrReplaceAccessTokenTtlParamOnUrl(e){return e=this._getBooleanAppSetting("UseServerAccessTokenTTLInClientRequests")?this.addOrReplaceQueryParameter(e,o.AFrameworkApplication.accessTokenTtlParamName,o.AFrameworkApplication.accessTokenServerExpirationTime.toString()):this.addOrReplaceQueryParameter(e,o.AFrameworkApplication.accessTokenTtlParamName,o.AFrameworkApplication.accessTokenTtl.toString())}shouldIncludeWacAadTokenHeaderWithBrsAndNullCheck(e,t){return!(!this._getBooleanAppSetting("AADTokenHeaderIsEnabled")||!t)&&this.shouldIncludeWACAADTokenHeader(e)}shouldIncludeWACAADTokenHeader(e){if(this.isSuiteEndpoint(e))return!0;const t=me.a.getAbsoluteUrl(e),n=me.a.getHostname(t),a=fe.a.corePFTData.WacAppCluster,i=me.a.getPageName(t);if(!a||!Ce.a(n,a))return!1;const r=o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("OfficeVSO:9063836_WebRequestOperationsAllowListForTokens");if(r&&this.allowListOfConnectionWebRequests(t))return!0;if(this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenForAllRequestsIsEnabled",!1))return!0;const s=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenInOCPSIsEnabled",!1),l=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenInPolicyHandlerIsEnabled",!1),c=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenInPowerpointPodsIsEnabled",!1),d=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenInOneNoteS2SHandlerIsEnabled",!1),u=o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9316585_WACAADTokenForPeopleAshxIsEnabled"),p=o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9316607_WACAADTokenForProofingAshxIsEnabled"),g=o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9316572_EnsureAADTokenForWordDSS"),h=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenForSafeLinksIsEnabled",!1),m=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenForAFHSIsEnabled",!1),_=o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_10050043_WACAADTokenForXLOHPACallsIsEnabled"),S=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenForVisioHPACallsIsEnabled",!1),f=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenForPOPSIsEnabled",!1),C=this._getBooleanAppSetting("FavoritesButtonEnabled"),y=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenInGetMoreInfoIsEnabled",!1);if(s&&i.toLowerCase().includes("cloudpolicysettings.ashx"))return!0;if(i.toLowerCase().includes("uploadfiletohosthandler.ashx"))return!0;if(c&&i.toLowerCase().includes("powerpoint.ashx"))return!0;if(l&&i.toLowerCase().includes("policyhandler.ashx"))return!0;if(d&&i.toLowerCase().includes("onenotes2shandler.ashx"))return!0;if(u&&i.toLowerCase().includes("people.ashx"))return!0;if(h&&i.toLowerCase().includes("safelinkshandler.ashx"))return!0;if(m&&i.toLowerCase().includes("applicationfeaturehelperhandler.ashx"))return!0;if(i.toLowerCase().includes("o365shellserviceproxy.ashx"))return!0;if(p&&i.toLowerCase().includes("proofing.ashx"))return!0;if(C&&i.toLowerCase().includes("favorites.ashx"))return!0;if(g&&i.toLowerCase().includes("onenote.ashx")){if(o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("OfficeVSO:9125703_SendAADTokenForAllOneNoteAshxReq"))return!0;{const t=me.a.getParameterValueDecoded(e,"perfTag");if(t){if(t.toLowerCase().includes("sessioninforefresh"))return!0}}}if(_){if(["readroamingstring","writeroamingstring","getlineagewywaauthors","getrelevantactivitiesdata","getsessionstatus","delaydatamodelload","pollsessionstatus","readroamingdocumententry","writeroamingdocumententry","getlinkedentitymetadata","linkedentitytryautorefresh","movetonextambiguouslinkedentity","converttolinkedentity","convertlinkedentitytotext","refreshlinkedentitywebservicehandshake","xlrestinternal","xlviewerinternal","refreshallnew","updatewacaadtoken","openworkbook","notifyfeaturelicensingstatus","getsessionstatuswithdelaydatamodelload"].some((e=>i.toLowerCase().includes(e.toLowerCase()))))return!0}if(S){if(["/v/get","/v/edit","/v/visioframe.aspx","/v/getfilestate","/v/getAmIAloneStatus.ashx","/v/renamehandler.ashx","/v/getcomments","/v/getCoauthEditUpdatesHandler.ashx","/v/imagehandler.ashx","/v/getdtbeligibility","/v/getLicensedFeatures","/v/RoamingServiceHandler.ashx","/v/MruV2ServiceHandler.ashx","/v/O365ShellServiceProxy.ashx","/v/getLicensedFeatures.ashx"].some((e=>Ce.a(t.toLocaleLowerCase(),e.toLocaleLowerCase()))))return!0}if(f&&(Ce.a(t,"/pops/ppt/edit.https.svc/jsonAnonymous/EnsureHostSession")||Ce.a(t,"/pops/ppt/edit.https.svc/jsonAnonymous/UpdateSessionUserAADToken")))return!0;if(y&&Ce.a(t.toLocaleLowerCase(),"GetMoreInfoHandler.ashx".toLocaleLowerCase()))return!0;return["AddinServiceHandler.ashx","RoamingServiceHandler.ashx","MruV2ServiceHandler.ashx","CreateNewDocument.aspx","sharepointsaveashandler.ashx","pptsharepointsaveashandler.ashx","skydriveuploadhandler.ashx","pptskydriveuploadhandler.ashx","savetohost.ashx","ChartHandler.ashx","CopilotActionHandler.ashx"].some((e=>i.toLowerCase().includes(e.toLowerCase())))}allowListOfConnectionWebRequests(e){return Ce.a(e,"EwaInternalWebService.json/ApplyFilter")||Ce.a(e,"EwaInternalWebService.json/ApplyFormatStylesByType")||Ce.a(e,"EwaInternalWebService.json/ApplyPivotFilter")||Ce.a(e,"EwaInternalWebService.json/ApplyPivot")||Ce.a(e,"EwaInternalWebService.json/ApplyPivotSort")||Ce.a(e,"EwaInternalWebService.json/ApplyPivotTableValueFieldSort")||Ce.a(e,"EwaInternalWebService.json/ApplyPivotValueFieldSettings")||Ce.a(e,"EwaInternalWebService.json/ApplySlicerSelection")||Ce.a(e,"EwaInternalWebService.json/ApplySort")||Ce.a(e,"EwaInternalWebService.json/ApplyTimeSlicerInteractivity")||Ce.a(e,"EwaInternalWebService.json/ApplyValueFieldSettingsToPivotTable")||Ce.a(e,"EwaInternalWebService.json/ClearAutoFilter")||Ce.a(e,"EwaInternalWebService.json/GetSlicerItemList")||Ce.a(e,"EwaInternalWebService.json/DeleteSheet")||Ce.a(e,"EwaInternalWebService.json/ExecutePivotTableOperation")||Ce.a(e,"EwaInternalWebService.json/ExecuteRichApiRequest")||Ce.a(e,"EwaInternalWebService.json/ExpandPivotFieldListLevels")||Ce.a(e,"EwaInternalWebService.json/FillRange")||Ce.a(e,"EwaInternalWebService.json/FindAllV2")||Ce.a(e,"EwaInternalWebService.json/FindCellV2")||Ce.a(e,"EwaInternalWebService.json/FormatCellsV2")||Ce.a(e,"EwaInternalWebService.json/GetPivotFilterData")||Ce.a(e,"EwaInternalWebService.json/GetPivotMenu")||Ce.a(e,"EwaInternalWebService.json/GetPivotMenuV2")||Ce.a(e,"DynamicGridContent.json/GetRangeContentJson")||Ce.a(e,"EwaInternalWebService.json/MoveLineItems")||Ce.a(e,"EwaInternalWebService.json/OpenWorkbook")||Ce.a(e,"EwaInternalWebService.json/Outline")||Ce.a(e,"EwaInternalWebService.json/PasteRange")||Ce.a(e,"EwaInternalWebService.json/PivotTableSettingsPaneOperations")||Ce.a(e,"EwaInternalWebService.json/PivotTableShowExpandButton")||Ce.a(e,"EwaInternalWebService.json/Recalc")||Ce.a(e,"EwaInternalWebService.json/Refresh")||Ce.a(e,"EwaInternalWebService.json/RefreshAllNew")||Ce.a(e,"EwaInternalWebService.json/SearchPivotFilter")||Ce.a(e,"EwaInternalWebService.json/SetRichTextCell")||Ce.a(e,"EwaInternalWebService.json/TogglePivotDrill")||Ce.a(e,"EwaInternalWebService.json/Undo")||this.allowListOfConnectionWebRequests2(e)}allowListOfConnectionWebRequests2(e){if(o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("OfficeVSO:8983114_BrowserOperationsWhiteList"))return Ce.a(e,"EwaInternalWebService.json/ChangeSheetsVisibility")||Ce.a(e,"EwaInternalWebService.json/DeleteFloatingObject")||Ce.a(e,"EwaInternalWebService.json/EvaluatePartialFormula")||Ce.a(e,"EwaInternalWebService.json/Paste")||Ce.a(e,"EwaInternalWebService.json/PasteString")||Ce.a(e,"EwaInternalWebService.json/RefreshAll")||Ce.a(e,"EwaInternalWebService.json/ReplaceAll")||Ce.a(e,"EwaInternalWebService.json/SetCalculationOptions")||Ce.a(e,"EwaInternalWebService.json/SwitchNamedSheetView")||Ce.a(e,"EwaInternalWebService.json/GetObserverChartFromHostAndInsert")||Ce.a(e,"EwaInternalWebService.json/RefreshExternalChartHostFileWopiToken")||Ce.a(e,"EwaInternalWebService.json/ApplyWellKnownPivotFilter")||Ce.a(e,"EwaInternalWebService.json/RemovePivotFilter")||Ce.a(e,"EwaInternalWebService.json/SetCustomFilter")||Ce.a(e,"EwaInternalWebService.json/ApplyToRange")||Ce.a(e,"EwaInternalWebService.json/ChangePivotFieldListSortOrder")||Ce.a(e,"EwaInternalWebService.json/InsertDeleteCells")||Ce.a(e,"EwaInternalWebService.json/LinkedEntitiesEnableUntrustedImages")||Ce.a(e,"EwaInternalWebService.json/Sort")||Ce.a(e,"CrossDomainAjax.ashx/ApplySlicerSelection")||Ce.a(e,"EwaInternalWebService.json/SetOutlineLevel")||Ce.a(e,"EwaInternalWebService.json/ExternalBookBreakLinksV2")||Ce.a(e,"EwaInternalWebService.json/EnableECSToAugLoopServiceOBOFlow")||Ce.a(e,"EwaInternalWebService.json/GetPivotFilterMenuAndFilterData")||Ce.a(e,"EwaInternalWebService.json/SetExternalBookWopiInfoV3")}addQueryParameterToUrl(e,t,n){if(me.a.getParameterValue(e,t))return k.ULS.sendTraceTag(508871057,205,15,"Param collision: {0}",t),e;const a=me.a.addParameterValue(e,t,n);return a.length>2048?k.ULS.sendTraceTag(508871056,205,15,"Url too long: {0}. Length: {1}",t,a.length):e=a,e}addOrReplaceQueryParameter(e,t,n){const a=me.a.addOrReplaceParameterValue(e,ye.a.urlKeyValueEncode(t),n?ye.a.urlKeyValueEncode(n):null);return a.length>2048?(k.ULS.sendTraceTag(508871055,205,15,"Url too long: {0}. Length: {1}",t,a.length),e):a}shouldSkipClusterAndFeHeadersForUrl(e){return this.isSuiteEndpoint(e)}isSuiteEndpoint(e){return void 0!==this._suiteEndpoint&&null!==this._suiteEndpoint||(this._suiteEndpoint=fe.a.corePFTData.Endpoint.toLowerCase()),!(void 0===this._suiteEndpoint||null===this._suiteEndpoint)&&""!==this._suiteEndpoint&&e.toLowerCase().startsWith(this._suiteEndpoint)}shouldSkipDCSpecificRequest(e){if(this._getBooleanAppSetting("NonDCSpecificSqmRequestIsEnabled")){const t=this.getNonDCSpecificUrls();return me.a.isEndingWithSpecificUrl(e.toLowerCase(),t)}return!1}getNonDCSpecificUrls(){return["rtc2/findsession"]}static getBuilder(e,t){return be._instance||(be._instance=new be(e,t)),be._instance}constructor(e,t){this._suiteEndpoint=null,this._getBooleanAppSetting=e,this._getBooleanFeatureGate=t,this._additionalHeaders=new Map}}be._instance=null,(0,a.a)(be,"ClientRequestBuilder",null,[]);var Te=n(8555),ve=n(353),we=n(3078),Fe=n(3299),Ie=n(871),Ee=n(5467),Me=n(8216),ke=n(657),Pe=n(965),De=n(4852),Re=n(2088),xe=n(7958),Le=n(8599),Ue=n(1779);class Oe{constructor(){this.Latency=0,this.Count=0}}(0,a.a)(Oe,"AverageLatency",null,[]);class Be{constructor(){this.HttpCode=null,this.Count=0}}(0,a.a)(Be,"HttpStatusSummaryEntry",null,[]);class Ne{constructor(){this.Endpoint=null,this.HttpStatusSummary=null}}(0,a.a)(Ne,"HttpSummaryPerRequestEntry",null,[]);class We{constructor(){this.Endpoint=null,this.AverageLatency=null}}(0,a.a)(We,"LatencyPerRequestEntry",null,[]);class He{get responseNotAvailableIds(){return this._responseNotAvailableIds}get httpStatusCodeSummary(){return this._httpStatusCodeSummary}get httpSummaryPerRequest(){return this._httpSummaryPerRequest}reset(){this.noOpenConnectionCount=0,this.invokeCount=0,this.invokeSentCount=0,this.invokeFailedCount=0,this.invokeTimeoutCount=0,this.succeededCount=0,this.failedCount=0,this.timeoutCount=0,this.synchronousNotificationCount=0,this._responseNotAvailableIds=null,this._httpStatusCodeSummary={},this._httpSummaryPerRequest={}}addToResponseNotAvailableIds(e){this.responseNotAvailableIds||(this._responseNotAvailableIds=new he.a),!this.responseNotAvailableIds.contains(e)&&this.responseNotAvailableIds.count<50&&this.responseNotAvailableIds.add(e)}registerHttpStatus(e,t){e<=299||(this.registerHttpSummary(e),this.registerHttpForRequest(e,t))}registerLatency(e,t){if(!this._shouldRecordLatencyIsEnabled)return;if(!t)return;const n=this.extractPathKey(t);if(!n.length)return;let a;({value:a}=this._latencyPerRequest.tryGetValue(n)).returnValue||(this._latencyPerRequest.set_item(n,Object.assign(new Oe,{Latency:0,Count:0})),a=this._latencyPerRequest.get_item(n)),this._latencyPerRequest.set_item(n,this.calculateAverageLatency(a,e))}calculateAverageLatency(e,t){const n=e.Count+1,a=t-e.Latency,i=e.Latency+a/n;return Object.assign(new Oe,{Latency:i,Count:n})}registerHttpSummary(e){this.updateHttpStatusDictionary(this.httpStatusCodeSummary,e)}registerHttpForRequest(e,t){if(!t)return;const n=this.extractPathKey(t);if(!n.length)return;n in this.httpSummaryPerRequest||(this.httpSummaryPerRequest[n]={});const a=this.httpSummaryPerRequest[n];this.updateHttpStatusDictionary(a,e)}extractPathKey(e){let t=me.a.getPageName(e);const n=me.a.getParameterValue(e,"PerfTag",!0);return n&&(t=String.format("{0}_{1}",t,n)),t}updateHttpStatusDictionary(e,t){const n=t.toString();let a=0;n in e&&(a=e[n]),e[n]=++a}generateLogDictionary(){const e={};try{e.NoOpenConnectionCount=this.noOpenConnectionCount,e.InvokeCount=this.invokeCount,e.InvokeSentCount=this.invokeSentCount,e.InvokeFailedCount=this.invokeFailedCount,e.InvokeTimeoutCount=this.invokeTimeoutCount,e.SucceededCount=this.succeededCount,e.FailedCount=this.failedCount,e.TimeoutCount=this.timeoutCount,e.SynchronousNotificationCount=this.synchronousNotificationCount,e.HttpStatusSummary=this.toArrayOfHttpStatusEntries(this.httpStatusCodeSummary),e.HttpSummaryPerRequest=this.toArrayOfSummaryPerRequestEntries(this.httpSummaryPerRequest),this._shouldRecordLatencyIsEnabled&&(e.LatencyPerRequest=this.toArrayOfLatencyPerRequestEntries(this._latencyPerRequest))}catch(t){e.Error=String.format("Exception thrown while creating log: {0}",t)}return e}toArrayOfHttpStatusEntries(e){const t=new he.a;for(const n in e){const a={key:n,value:e[n]};t.add(Object.assign(new Be,{HttpCode:a.key,Count:a.value}))}return t.toArray()}toArrayOfSummaryPerRequestEntries(e){const t=new he.a;for(const n in e){const a={key:n,value:e[n]};t.add(Object.assign(new Ne,{Endpoint:a.key,HttpStatusSummary:this.toArrayOfHttpStatusEntries(a.value)}))}return t.toArray()}toArrayOfLatencyPerRequestEntries(e){const t=new he.a;for(const n of e){const e=n.value;t.add(Object.assign(new We,{Endpoint:n.key,AverageLatency:Object.assign(new Oe,{Latency:e.Latency,Count:e.Count})}))}return t.toArray()}constructor(){this.noOpenConnectionCount=0,this.invokeCount=0,this.invokeSentCount=0,this.invokeFailedCount=0,this.invokeTimeoutCount=0,this.succeededCount=0,this.failedCount=0,this.timeoutCount=0,this.synchronousNotificationCount=0,this._responseNotAvailableIds=null,this._httpStatusCodeSummary={},this._httpSummaryPerRequest={},this._latencyPerRequest=new Le.a(Ue.a.get_ordinalIgnoreCase()),this._shouldRecordLatencyIsEnabled=!!o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldRecordLatency",!1)}}(0,a.a)(He,"ClientRequestManagerTelemetryStorage",null,[]);var Ve=n(3311),Ge=n(4176),Qe=n(9800);class qe{addNetworkConnectivityListener(e){Array.add(this._networkConnectivityListeners,e)}removeNetworkConnectivityListener(e){Array.remove(this._networkConnectivityListeners,e)}onNetworkDisconnect(){const e=Array.clone(this._networkConnectivityListeners);for(let t=0;t<e.length;t++)e[t].networkDisconnected();le.a.instance.addMetric(de.a.networkDisconnectedStart,(new Date).getTime())}onNetworkResume(){const e=Array.clone(this._networkConnectivityListeners);for(let t=0;t<e.length;t++)e[t].networkResumed();le.a.instance.addMetric(de.a.networkDisconnectedEnd,(new Date).getTime())}static getNotifier(e){return qe._instance||(qe._instance=new qe(e)),qe._instance}constructor(e){this._networkConnectivityListeners=[],this.onAppNetworkChanged=(e,t)=>{const n=t.oldNetworkState,a=t.newNetworkState;n!==a&&(Qe.a.logUniqueUsage("aie31469;he79b453"),0===a?this.onNetworkResume():1!==a&&3!==a||this.onNetworkDisconnect())},e.add_onAppNetworkChanged(this.onAppNetworkChanged)}}qe._instance=null,(0,a.a)(qe,"NetworkConnectivityNotifier",null,[]);class Ke{get args(){return this._args}constructor(e,t=!1){this._args=e,this.succeeded=t}}(0,a.a)(Ke,"RequestManagerResponse",null,[]);class ze{get requestId(){return this._requestId}get responsePromise(){return this._responsePromise}registerCallbacks(e,t){this.responsePromise&&this.responsePromise.then((n=>{o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("QueuedClientRequestFailureCallback")?e&&n&&n.succeeded?e(n.args):t&&n&&t(n.args):e&&n&&e(n.args)}),(e=>{const n=(0,Te.a)(Ke,e);t&&n&&t(n.args)}))}constructor(e,t){this._requestId=e,this._responsePromise=t}}(0,a.a)(ze,"QueuedClientRequest",null,[]);class je extends Sys.EventArgs{get data(){return this._data}constructor(e){super(),this._data=e}}(0,a.a)(je,"RequestFailedEventArgs",Sys.EventArgs,[65]);class Ze extends Sys.EventArgs{get data(){return this._data}constructor(e){super(),this._data=e}}(0,a.a)(Ze,"RequestInvokedEventArgs",Sys.EventArgs,[65]);var Xe=n(2609);class Je extends Sys.EventArgs{get data(){return this._data}constructor(e){super(),this._data=e}}(0,a.a)(Je,"RequestSucceededEventArgs",Sys.EventArgs,[65]);class Ye extends Sys.Net.WebRequestExecutor{clearTimer(){this._timer&&(window.clearTimeout(this._timer),this._timer=0)}get_aborted(){return this._aborted}get_responseAvailable(){return this._responseAvailable}get_started(){return this._started}get_timedOut(){return this._timedOut}executeRequest(){const e=this.get_webRequest();let t=e.get_body()||e.binaryBody;const n=e.get_headers();this._xmlHttpRequest=new XMLHttpRequest,this._xmlHttpRequest.onreadystatechange=this.onReadyStateChange,this._xmlHttpRequest.responseType=e.responseType;const a=e.get_httpVerb();if(this._xmlHttpRequest.open(a,e.getResolvedUrl(),!0),this._xmlHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest"),n)for(const e in n){const t={key:e,value:n[e]};"function"!=typeof t.value&&this._xmlHttpRequest.setRequestHeader(t.key,t.value?t.value.toString():null)}"post"===a.toLowerCase()&&(t&&"string"!=typeof t||n&&n["Content-Type"]||this._xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),t=t||"");const i=e.get_timeout();i>0&&(this._timer=window.setTimeout(this.onTimeout,i)),this._xmlHttpRequest.send(t),this._started=!0}getResponseHeader(e){let t=null;try{t=this._xmlHttpRequest.getResponseHeader(e)}catch(e){}return t=t||"",t}getAllResponseHeaders(){return this._xmlHttpRequest.getAllResponseHeaders()}get_responseData(){let e;try{e=this._xmlHttpRequest.responseText}catch(t){e=""}return e}get_object(){return this._xmlHttpRequest.response}get_statusCode(){return this._xmlHttpRequest.status}get_statusText(){return this._xmlHttpRequest.statusText}get_xml(){let e=this._xmlHttpRequest.responseXML;if(e&&e.documentElement)-1!==window.navigator.userAgent.indexOf("MSIE")&&void 0!==e.setProperty&&e.setProperty("SelectionLanguage","XPath");else if(e=Sys.Net.XMLDOM(this._xmlHttpRequest.responseText),!e||!e.documentElement)return null;return"http://www.mozilla.org/newlayout/xml/parsererror.xml"===e.documentElement.namespaceURI&&"parsererror"===e.documentElement.tagName||e.documentElement.firstChild&&"parsererror"===e.documentElement.firstChild.tagName?null:e}abort(){this._aborted||this._responseAvailable||this._timedOut||(this._aborted=!0,this.clearTimer(),this._xmlHttpRequest&&!this._responseAvailable&&(this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest.abort(),this._xmlHttpRequest=null,this.get_webRequest().completed(Sys.EventArgs.Empty)))}constructor(){super(),this._xmlHttpRequest=null,this._responseAvailable=!1,this._timer=0,this._timedOut=!1,this._aborted=!1,this._started=!1,this.onReadyStateChange=()=>{if(4===this._xmlHttpRequest.readyState){try{if(void 0===this._xmlHttpRequest.status)return}catch(e){return}this.clearTimer(),this._responseAvailable=!0,this.get_webRequest().completed(Sys.EventArgs.Empty),this._xmlHttpRequest&&(this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest=null)}},this.onTimeout=()=>{this.get_responseAvailable()||(this.clearTimer(),this._timedOut=!0,this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest.abort(),this.get_webRequest().completed(Sys.EventArgs.Empty),this._xmlHttpRequest=null)}}}(0,a.a)(Ye,"XMLHttpExecutorExtended",Sys.Net.WebRequestExecutor,[]);var $e=n(7531),et=n(6915);class tt{dispose(){this._parent.removeChild(this._iframe),$e.a.removeHandler(this._iframe,"load",this.onSigninFrameLoad),this._iframe=null,this._parent=null}constructor(e,t){this.onSigninFrameLoad=e=>{try{0,this._onAfterSignInCallback(this._iframe.contentWindow.document.URL),this.dispose()}catch(e){0}},this._parent=e,this._onAfterSignInCallback=t,this._iframe=document.createElement("iframe"),this._iframe.className="WACSigninFrame";const n=o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx",a=new et.a(n);o.AFrameworkApplication.addCommonUrlParameters(a),this._iframe.src=a.toString(),this._parent.appendChild(this._iframe),$e.a.addHandler(this._iframe,"load",this.onSigninFrameLoad)}}(0,a.a)(tt,"SigninFrame",null,[11]);var nt=n(6489),at=n(9784),it=n(9878),ot=n(5330),rt=n(5018),st=n(5557),lt=n(9317);class ct{static get instance(){return ct._instance||(ct._instance=new ct(lt.a.instance,o.AFrameworkApplication.theOfflineLogger)),ct._instance}onRequestSucceeded(){this.changeNetworkConnected()}onRequestFailed(e,t){e&&(0!==t&&-1!==t&&t!==Ge.a.requestTimeout_408||(this.consecutiveFailures++,this.sessionStatusManager.isNetworkConnected&&this.consecutiveFailures>=this.maximumConsecutiveFailures&&(this.offlineLogger&&this.offlineLogger.listenNextTag(507610832,306,15),k.ULS.sendTraceTag(507610832,306,15,"Network Timeout: {0}",{ConsecutiveFailures:this.consecutiveFailures,MaximumConsecutiveFailures:this.maximumConsecutiveFailures,StatusCode:t}),this.sessionStatusManager.changeAppNetworkStatus(3))))}onAppNetworkChanged(e,t){2!==t.newNetworkState&&0!==t.newNetworkState||(this.consecutiveFailures=0)}changeNetworkConnected(){this.sessionStatusManager.isNetworkConnected||(k.ULS.sendTraceTag(508045133,306,20,"Switch to connected network."),this.sessionStatusManager.changeAppNetworkStatus(0)),this.consecutiveFailures=0}constructor(e,t){this.sessionStatusManager=e,this.offlineLogger=t,this.maximumConsecutiveFailures=5,this.consecutiveFailures=0,e.add_onAppNetworkChanged(this.onAppNetworkChanged.bind(this))}}ct._instance=null,(0,a.a)(ct,"HttpConnectivityUpdater",null,[]);var dt=n(7260);function ut(e){e&&(e=function(e){const t=e.split(",");if(t.length>4)k.ULS.sendTraceTag(7161414,205,10,"Unexpected canary value [{0}]. Less than 4 commas expected.",e);else if(4===t.length){k.ULS.sendTraceTag(7161415,205,10,"Canary got duplicated header value : {0}",e);const n=t[0].trim()+","+t[1].trim();e=n===t[2].trim()+","+t[3].trim()?n:e,k.ULS.sendTraceTag(7161416,205,50,"Fixed canary value is: {0}",e)}return e}(e),o.AFrameworkApplication.canary=e,o.AFrameworkApplication.logCanaryInBrowser&&k.ULS.sendTraceTag(6063238,205,50,"New canary in response: {0}",o.AFrameworkApplication.canary))}var pt=n(9246),gt=n(2739);const ht="C403EOEK",mt="RunCompletionCallbackAfterCancelingRequest",_t=["PolicyHandler.ashx","MruV2ServiceHandler.ashx","RoamingServiceHandler.ashx","CloudPolicySettings.ashx","ApplicationFeatureHelperHandler.ashx","SafeLinksHandler.ashx","people.ashx","O365ShellServiceProxy.ashx"],St=["policyhandler.ashx","mruv2servicehandler.ashx","roamingservicehandler.ashx","cloudpolicysettings.ashx","applicationfeaturehelperhandler.ashx","people.ashx","readroamingstring","writeroamingstring","o365shellserviceproxy.ashx","addinservicehandler.ashx","onenotes2shandler.ashx","onenote.ashx","acquiretokenforaugloop.ashx","getlineagewywaauthors","getrelevantactivitiesdata","createnewdocument.aspx","sharepointsaveashandler.ashx","pptsharepointsaveashandler.ashx","skydriveuploadhandler.ashx","pptskydriveuploadhandler.ashx","savetohost.ashx","getsessionstatus","charthandler.ashx","copilotactionhandler.ashx","favorites.ashx","updatewacaadtoken","openworkbook"];class ft{add_consecutive403ErrorOccurred(e){this._eventSource.addHandler(ht,e)}remove_consecutive403ErrorOccurred(e){this._eventSource.removeHandler(ht,e)}get telemetryStorage(){return this._telemetryStorage}get userSessionId(){return this._userSessionId}set userSessionId(e){if(this._userSessionId)throw Error.invalidOperation("User session id is already set");this._userSessionId=e}get defaultSentTimeoutMs(){return this._defaultSentTimeoutMs}get lastResponseTime(){return this._lastResponseTime}get isNetworkOffline(){return 0!==this._sessionStatusManager.networkState}get lastCorrelationId(){return this._lastCorrelationId}get hasAvailableConnections(){return this._openConnections<this.maxConnections}get timeToWaitAfterLastKeyStroke(){return this._taskManager.timeToWaitAfterLastKeyStroke}set timeToWaitAfterLastKeyStroke(e){this._taskManager.timeToWaitAfterLastKeyStroke=e}get machineIds(){const e=new Sys.StringBuilder;let t=!1;const n=this._machineIds;for(const a in n){const i={key:a,value:n[a]};t&&e.append(",");const o=i.key;o&&(t=!0,e.append(o))}return e.toString()}get wacaadToken(){return this._wacaadToken}set wacaadToken(e){const t=!!this._wacaadToken,n=xe.a.getTickCount();this._wacAadTokenReceivedTime=this._wacAadTokenReceivedTime??n,this._wacAcquireTokenTelemetryEnabled&&!t&&(k.ULS.sendTraceTag(506036239,205,20,"Set WAC AAD Token"),ue.a.instance.resolveFuture(dt.a).execute((e=>e.logTokenActivity("WacAadToken",this._wacAadTokenReceivedTime)))),this._wacaadToken=e,this._wacAcquireTokenTelemetryEnabled&&this._wacaadToken!==this._wacAcquireToken&&!this._corePftTokenReceived&&(this._corePftTokenReceived=!0,k.ULS.sendTraceTag(505819478,205,20,"Set WAC AAD Token"),ue.a.instance.resolveFuture(dt.a).execute((e=>e.logTokenActivity("WacOAuthManagerToken",n)))),this._wacAadTokenCallbackEnabled&&this._wacAadTokenPromiseResolve&&!t&&this._wacAadTokenPromiseResolve({token:this._wacaadToken,receivedTime:this._wacAadTokenReceivedTime})}get wacAcquireToken(){return this._wacAcquireToken}set wacAcquireToken(e){const t=!!this._wacAcquireToken;this._wacAcquireTokenReceivedTime=this._wacAcquireTokenReceivedTime??xe.a.getTickCount(),this._wacAcquireTokenTelemetryEnabled&&!t&&(k.ULS.sendTraceTag(506036238,205,20,"Set WAC Acquire Token"),ue.a.instance.resolveFuture(dt.a).execute((e=>e.logTokenActivity("WacAcquireToken",this._wacAcquireTokenReceivedTime)))),this._wacAcquireToken=e,this._wacAadTokenCallbackEnabled&&this._wacAcquireTokenPromiseResolve&&!t&&this._wacAcquireTokenPromiseResolve({token:this._wacAcquireToken,receivedTime:this._wacAcquireTokenReceivedTime})}get wacClusterId(){return this._wacClusterId}set wacClusterId(e){o.AFrameworkApplication.appSettingsManager&&e&&e.length>0&&(o.AFrameworkApplication.dataPlumber.WacSessionDatacenter=e,Ee.Health.instance.addOrUpdatePartCDimension("WacSessionDatacenter",e)),this._wacClusterId&&this._wacClusterId!==e&&(k.ULS.sendTraceTag(541403361,205,15,"Clearning front end {0} for clusterid {1} to {2}",this.wacFrontEnd,this._wacClusterId,e),this._wacFrontEnd=null,this._wacFrontEndPerUrl={}),this._wacClusterId=e}get wacFrontEnd(){return this._wacFrontEnd}get wacFrontEndPerUrl(){return this._wacFrontEndPerUrl}get requestQueueLength(){return this._requests.length}send(e){let t=-1;const n=new Promise(((n,a)=>{let i=null;e.watchName&&(i=this._stopwatchBuilder.value.makeAndStartStopwatch("WebServiceCall",e.watchName)),t=this.sendRequestInternal(e,(e=>{i&&i.stop(),n(new Ke(e,!0))}),(e=>{i&&i.stop(),n(new Ke(e,!1))}))})).catch((e=>{const t=(0,Te.a)(Error,e);if(t)throw k.ULS.sendTraceTag(591737751,205,10,"CRM.Send exception:"+t.toString()),t;return k.ULS.sendTraceTag(591737752,205,10,"CRM.Send.Error caught"),Promise.resolve(new Ke(new je(null),!1))}));return new ze(t,n)}sendShuttingDown(e){this.sendShuttingDownRequestInternal(e.url,e.body,e.contentType,e.hostAttributionInfo)}sendShuttingDownRequestInternal(e,t,n,a){try{e=this._clientRequestBuilder.createUrlForShuttingDownRequest(e,this.userSessionId,this.wacClusterId,this._officeEndpoint,a);const i={};if(i.body=t,i.keepalive=!0,i.method="POST",null!=n){const e={};e["content-type"]=n,i.headers=e,i.mode="same-origin"}window.fetch(e,i).catch((e=>{k.ULS.sendTraceTag(541680156,100,15,"ClientRequestManager.SendShuttingDownRequest: error during fetch: '{0}'",e.toString())}))}catch(e){k.ULS.sendTraceTag(542913372,100,15,"ClientRequestManager.SendShuttingDownRequest: Failed to send shutting down request. [Message: {0}] [Stack: {1}]",e.message,e.stack)}o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ClientRequestManagerSummaryIsEnabled")&&this.telemetryStorage&&(this._detailedLogAlreadySentOnShutdown||(k.ULS.sendTraceTag(537273753,205,15,Pe.c(this.telemetryStorage.generateLogDictionary())),this._detailedLogAlreadySentOnShutdown=!0))}sendShuttingDownRequestWithHeaders(e,t,n,a){try{const i={},o=me.a.removeAllUrlParameters(e),r=this.getWacAadTokenToUse(e,!1);this._clientRequestBuilder.setRequestHeaders(i,e,o,t,void 0,void 0,this._userSessionId,this._wacClusterId,this.wacFrontEndPerUrl[o],this.wacFrontEnd,this.wacUserAgent,r,a,this.netcoreRouting);const s={};s.body=n,s.keepalive=!0,s.method="POST",s.mode="same-origin",s.headers=i,window.fetch(e,s).catch((e=>{k.ULS.sendTraceTag(506806625,100,15,"ClientRequestManager.SendShuttingDownRequestWithHeaders: error during fetch: '{0}'",e.toString())}))}catch(e){k.ULS.sendTraceTag(506806624,100,15,"ClientRequestManager.SendShuttingDownRequestWithHeaders: Failed to send shutting down request. [Message: {0}] [Stack: {1}]",e.message,e.stack)}o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ClientRequestManagerSummaryIsEnabled")&&this.telemetryStorage&&(this._detailedLogAlreadySentOnShutdown||(k.ULS.sendTraceTag(506806623,205,15,Pe.c(this.telemetryStorage.generateLogDictionary())),this._detailedLogAlreadySentOnShutdown=!0))}addRequest(e,t,n,a,i,o,r,s,l,c=null,d=!1,u=null,p=null,g=null,h=null,m=!1,_=null,S=!1,f=null){return this.addRequestInternal(e,t,n,a,f||[],i,o,r,s,l,c||"",d,u,p,g,h,m,_,S)}addXMLHttpRequestExtended(e,t,n,a,i,o,r,s,l,c=null,d=!1,u=null,p=null,g=null,h=null,m=!1,_=null,S=!1,f=null,C=null){throw Error.notImplemented()}addRequestWithTaskAndStopWatch(e,t,n,a,i,o,r,s,l=null,c=!1,d=null,u=null,p=null,g=null,h=!1,m=null){let _=null;s&&(_=this._stopwatchBuilder.value.makeAndStartStopwatch("WebServiceCall",s));const S=new ve.a;try{this.addRequestInternal(e,t,n,a,[],i,o,(e=>{_&&_.stop(),S.setResult(new Ke(e,!0))}),(e=>{_&&_.stop(),S.setResult(new Ke(e,!1))}),r,l||"",c,d,u,p,g,h)}catch(e){S.trySetException(e)}return S.task}addSynchronousRequest(e,t,n,a,i,o,r,s,l,c=null,d=null,u=null){return this.addRequestInternal(e,t,n,a,[],i,o,r,s,l,c||"",!0,d,u)}addFetchRequest(e,t,n,a,i,o,r,s,l,c,d=null,u=null,p=null,g=null,h=null,m=null,_=null){return this.addRequestInternal(e,t,n,a,_||[],o,r,s,l,c,d||"",!1,u,p,g,h,!1,m,void 0,void 0,void 0,void 0,void 0,i)}addRequestWithHeaderForwarding(e,t,n,a,i,o,r,s,l,c,d=null,u=!1,p=null,g=null,h=null,m=null,_=!1,S=null,f=!1,C=null,y=null,A=!1,b=!1){return this.addRequestInternal(e,t,n,a,i||[],o,r,s,l,c,d||"",u,p,g,h,m,_,S,f,C,y,void 0,void 0,void 0,A,b)}addSynchronousRequestWithHeaderForwarding(e,t,n,a,i,o,r,s,l,c,d=null,u=null){return this.addRequestInternal(e,t,n,a,i||[],o,r,s,l,c,"",!0,d,u,"24")}sendRequestInternal(e,t,n){return this.addRequestInternal(e.url,e.verb,e.body,e.headers,e.responseHeadersToSet||[],e.shouldSetResponseXml,e.priority,t,n,e.state,e.requestorId,e.isSynchronous,e.queueTimeoutMs,e.sentTimeoutMs,e.name,e.overwriteSessionId,e.forceSynchronousNotify,e.overwriteSessionId,!1,e.extraInfo,e.invokedCallback,e.hostAttributionInfo,e.responseType)}addRequestInternal(e,t,n,a,i,r,s,l,c,d,u,p,g=null,h=null,m=null,_=null,S=!1,f=null,C=!1,y=null,A=null,b=null,T=null,v=null,w=!1,F=!1){a=this.addNetCoreHeaders(a);if(!this._clientRequestAuthProcessor.shouldSendRequest(e))return-1;const I=g||this._defaultQueueTimeoutMs,E=h||this._defaultSentTimeoutMs;this._lastRequestId++,function(e){Array.contains(e,"X-CorrelationId")||Array.add(e,"X-CorrelationId"),Array.contains(e,"X-OfficeVersion")||Array.add(e,"X-OfficeVersion"),o.AFrameworkApplication.collectPageStats&&!Array.contains(e,ce.a.pageStatsResponseXHRHeader)&&Array.add(e,ce.a.pageStatsResponseXHRHeader)}(i);const M=new Sys.Net.WebRequest;M.set_url(e),2===t?(M.set_httpVerb("POST"),n&&("string"==typeof n?M.set_body(n):M.binaryBody=n)):M.set_httpVerb("GET"),M.responseType=T,(M.binaryBody||T)&&M.set_executor(new Ye);const k=me.a.removeAllUrlParameters(e),P=this.getWacAadTokenToUse(e,F);this._clientRequestBuilder.setRequestHeaders(M.get_headers(),e,k,a,_,f,this._userSessionId,this._wacClusterId,this.wacFrontEndPerUrl[k],this.wacFrontEnd,this.wacUserAgent,P,b,this.netcoreRouting),M.set_url(this._clientRequestBuilder.getModifiedUrl(e,_,this._userSessionId)),S?M.add_completed(this.onRequestCompletedSynchronousNotify):M.add_completed(this.onRequestCompleted),E>0&&M.set_timeout(E);const D=new Xe.a(this._lastRequestId,s,M,i,r,l,c,d,p,u,m,S,y,A,v,w);if(I>0){const e=new se.a(2,1,I,this.timeoutCallbackProcess,91);e.customData=D,e.data=D.id.toString(),D.requestQueuedTimeoutTask=e,this._taskManager.addTask(e)}return D.status=0,this._requests.enqueue(s,D),D.enqueueTime=new Date,this.onPendingRequestsModified(u,D),this.invoke(),this._lastRequestId}getWacAadTokenToUse(e,t){let n=this._wacaadToken;if(this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacAadTokenCallbackWithTimeout",!1)||this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.tryGetWacAadTokenWithTimeoutIsEnabled",!1)){let a="WacAADToken";const i=me.a.getPageName(e);(t&&this._wacAadTokenCallbackEnabled&&this._wacAcquireToken||this.isAcquireTokenAllowedEndpoint(i)&&!this._wacaadToken)&&(n=this._wacAcquireToken,a="SPOAcquireToken"),k.ULS.sendTraceTag(506986525,205,50,"Using Token type = {0} for page = {1}",a,i)}else n=t&&this._wacAcquireToken&&this._wacAadTokenCallbackEnabled?this._wacAcquireToken:this._wacaadToken;return n}isAuthedRequest(e){return!this.isRequestEndingWithSpecificUrl(e,this._nonAuthedUrls)}shouldSkipDCSpecificRequest(e){return!!this._getBooleanAppSetting("NonDCSpecificSqmRequestIsEnabled")&&this.isRequestEndingWithSpecificUrl(e,this._nonDCSpecificUrls)}isRequestEndingWithSpecificUrl(e,t){const n=me.a.removeAllUrlParameters(e).toLowerCase();for(let e=0;e<t.length;e++){const a=(0,t[e])();if(a&&n.endsWith(a))return!0}return!1}abortRequest(e){if(e<0)return void 0;const t=this.peekById(e);if(!t)throw Error.argument(String.format("No request is found for the given id: {0}",e));this.abortRequestInternal(t)}abortRequestInternal(e){e&&(k.ULS.sendTraceTag(20289093,205,50,"Trying to abort request id: [{0}], request status is: [{1}]",e.id,e.status),this.ensureCompletionCallbackTaskRemoved(e),this.ensureQueuedTimeoutTaskRemoved(e),1===e.status?this.terminateExecutingRequest(e):this._getBooleanAppSetting(mt)&&(e.status=10))}terminateExecutingRequest(e){e.request.get_executor().abort(),this.onPendingRequestsModified(e.requestorId,e)}ensureCompletionCallbackTaskRemoved(e){return this.ensureTaskRemoved((()=>e.completionCallbackTask),(()=>{e.completionCallbackTask=null}))}ensureQueuedTimeoutTaskRemoved(e){return this.ensureTaskRemoved((()=>e.requestQueuedTimeoutTask),(()=>{e.requestQueuedTimeoutTask=null}))}ensureTaskRemoved(e,t){const n=e();return!!n&&(this._taskManager.deleteTask(n),t(),!0)}tryAbortRequest(e){const t=this.peekById(e);return!!t&&(this.abortRequestInternal(t),!0)}getRequestStatus(e){const t=this.peekById(e);return t?t.status:4}pendingRequestsCount(e){let t=0;for(let n=0,a=this._requests.length;n<a;n++)this._requests.peekAt(n).requestorId===e&&t++;return t}executingRequestsCount(e){let t=0;for(let n=0,a=this._requests.length;n<a;n++){const a=this._requests.peekAt(n);a.requestorId===e&&1===a.status&&t++}return t}peekAtRequestQueue(e){return this._requests.peekAt(e)}abortAllOutstandingRequests(e){for(let t=this._requests.length-1;t>=0;t--){const n=this._requests.peekAt(t);o.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.OfficeVSO:9985213_FixClientRequestManagerBug")?n?.requestorId===e&&this.abortRequest(n.id):n.requestorId===e&&this.abortRequest(n.id)}}abortRequests(e){for(let t=this._requests.length-1;t>=0;t--){const n=this._requests.peekAt(t);e(n)&&this.abortRequest(n.id)}}addNetworkConnectivityListener(e){this._networkConnectivityNotifier.addNetworkConnectivityListener(e)}removeNetworkConnectivityListener(e){this._networkConnectivityNotifier.removeNetworkConnectivityListener(e)}addRequestStatusListener(e){Array.add(this._requestStatusListeners,e)}removeRequestStatusListener(e){Array.remove(this._requestStatusListeners,e)}onNetworkDisconnect(){const e=Array.clone(this._networkConnectivityListeners);for(let t=0;t<e.length;t++)e[t].networkDisconnected();le.a.instance.addMetric(de.a.networkDisconnectedStart,(new Date).getTime())}onNetworkResume(){const e=Array.clone(this._networkConnectivityListeners);for(let t=0;t<e.length;t++)e[t].networkResumed();le.a.instance.addMetric(de.a.networkDisconnectedEnd,(new Date).getTime())}onPendingRequestsModified(e,t){const n=Array.clone(this._requestStatusListeners);for(let a=0;a<n.length;a++)n[a].pendingRequestsModified(e,t)}createAndInvokeCompletionTask(e,t){const n=new se.a(e.priority,1,0,this.callbackProcess,9);n.data=e.id.toString(),n.name=e.name,o.AFrameworkApplication.isShuttingDown||e.isSynchronous||t?this.callbackProcess(n):(e.completionCallbackTask=n,this._taskManager.addTask(n))}addOrReplaceAccessTokenTtlParamOnUrl(e){return e=this._getBooleanAppSetting("UseServerAccessTokenTTLInClientRequests")?ft.addOrReplaceQueryParameter(e,o.AFrameworkApplication.accessTokenTtlParamName,o.AFrameworkApplication.accessTokenServerExpirationTime.toString()):ft.addOrReplaceQueryParameter(e,o.AFrameworkApplication.accessTokenTtlParamName,o.AFrameworkApplication.accessTokenTtl.toString())}invoke(){let e;if((e=this.telemetryStorage).invokeCount=e.invokeCount+1,this.hasAvailableConnections){this.removeCancelledItems();let e=null;for(let t=0;t<this._requests.length;++t){const n=this._requests.peekAt(t);if(0===n.status){e=n;break}}if(e){this._setRequestExpirableHeadersDuringInvoke&&(this._clientRequestBuilder.updateExpirableRequestHeaders(e.request.get_headers(),e.request.get_url(),this._wacaadToken),e.request.set_url(this._clientRequestBuilder.updateExpirableParamsUrl(e.request.get_url())));const t=this._logHpaEndpointUsageEnabled&&_t.find((t=>e.request.get_url().toLowerCase().includes(t.toLowerCase())));if(this._logHpaEndpointUsageEnabled&&t){const n=xe.a.getTickCount(),a=!!e.request.get_headers()["X-AADToken"];ue.a.instance.resolveFuture(dt.a).execute((e=>e.logEndpointUsageActivity(t,n,a)))}if(this.ensureQueuedTimeoutTaskRemoved(e),o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.runRequestCallbackWhenSessionHasExpired&&E.a.instance.isSessionExpired(o.AFrameworkApplication.accessTokenTtl)&&this.isAuthedRequest(e.request.get_url()))return e.status=14,void this.createAndInvokeCompletionTask(e,e.forceSynchronousNotify);e.status=1;let n=null;if(e.fetchRequestArgs)if(e.fetchRequestArgs.keepAlive){const t=new it.a;t.setbUlsImprovementEnable(!0),e.request.set_executor(t)}else{const t=new at.a;t.setbUlsImprovementEnable(!0),e.request.set_executor(t)}else if(e.useFetch){const t=o.AFrameworkApplication?.appSettingsManager?.getBooleanAppSetting("FetchExecutorFixEnabled"),n=new at.a(t);n.setbUlsImprovementEnable(!0),e.request.set_executor(n)}else o.AFrameworkApplication.isShuttingDown||e.isSynchronous?(n=Sys.Net.WebRequestManager.get_defaultExecutorType(),o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DisableSynchronousXMLHttpExecutor")||o.AFrameworkApplication.isShuttingDownFromPostMessage?Sys.Net.WebRequestManager.set_defaultExecutorType(nt.a.getName()):(st.b(509612808,306,50,"Forcing use of synchronous network request - IsShuttingDown: {0}, ForcedSynchronousNetworkRequest: {1}, DisableSynchronousXMLHttpExecutor: {2}, IsShuttingDownFromPostMessage: {3}",o.AFrameworkApplication.isShuttingDown,e.isSynchronous,o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DisableSynchronousXMLHttpExecutor"),o.AFrameworkApplication.isShuttingDownFromPostMessage),Sys.Net.WebRequestManager.set_defaultExecutorType(ot.a.getName()),e.request.get_executor()||k.ULS.sendTraceTag(587207577,205,15,"ClientRequestManager::Invoke: invoking synchronous request: {0}, is during shutdown: {1}",e.name,o.AFrameworkApplication.isShuttingDown))):o.AFrameworkApplication.requiresCrossDomainAjax&&(Ve.a.corsSimpleResponseHeadersOnlyIsEnabled=this._getBooleanAppSetting("CORSSimpleResponseHeadersOnlyIsEnabled"),n=Sys.Net.WebRequestManager.get_defaultExecutorType(),Sys.Net.WebRequestManager.set_defaultExecutorType(Ve.a.getName()));let a=!1;try{let t;e.invokedTime=new Date,e.invokedTimeTicks=De.a.roundNumber(xe.a.getTickCount(),2),this._markWebRequestOnTimelineIsEnabled&&e.shouldMarkOnTimeline&&p.a.instance.addMark("RequestInvoked"+e.invokedTimeTicks),e.invokedCallback&&e.invokedCallback(new Ze(e)),(t=this.telemetryStorage).invokeSentCount=t.invokeSentCount+1,e.request.invoke(),this.onPendingRequestsModified(e.requestorId,e)}catch(e){let t;(t=this.telemetryStorage).invokeFailedCount=t.invokeFailedCount+1,a=!0}n&&Sys.Net.WebRequestManager.set_defaultExecutorType(n),this._openConnections++,!a||o.AFrameworkApplication.isShuttingDown||e.isSynchronous||this.onRequestCompleted(e.request.get_executor())}}else{let e;(e=this.telemetryStorage).noOpenConnectionCount=e.noOpenConnectionCount+1}}removeCancelledItems(){if(this._getBooleanAppSetting(mt))for(let e=this._requests.length-1;e>=0;--e){const t=this._requests.peekAt(e);10===t.status&&(this.ensureQueuedTimeoutTaskRemoved(t),this.removeById(t.id))}}onRequestCompletedInternal(e,t){if(!e)return void k.ULS.sendTraceTag(19161607,205,15,"OnRequestCompleted: Executor doesn't exist.");const n=e.get_webRequest();if(!n)return void k.ULS.sendTraceTag(19161608,205,15,"OnRequestCompleted: Request doesn't exist.");const a=this.peekByWebRequest(n);if(!a)return void k.ULS.sendTraceTag(39965911,205,15,"OnRequestCompleted: Request is not found in the queue. Request body: {0}. ",ye.a.redactForLogging(n.get_body()));this._openConnections--;const i=e.get_responseAvailable()?e.get_statusCode():e.get_timedOut()?Ge.a.requestTimeout_408:-1;a.httpStatus=i,this.telemetryStorage&&this.telemetryStorage.registerHttpStatus(i,a.request.get_url());const r=e.get_aborted()?"'Aborted'":e.get_timedOut()?"'Request Timeout'":e.get_responseAvailable()?i.toString():"'Response Not Available'";this.setRequestCompletionTime(a),this.telemetryStorage&&e.get_responseAvailable()&&this.telemetryStorage.registerLatency(a.completedTime.getTime()-a.enqueueTime.getTime(),a.request.get_url());let s=!1;e.get_aborted()&&(a.status=10);let l=null,c=null;if(e.get_responseAvailable()){if(e.getResponseHeader("X-EndSession")&&o.AFrameworkApplication.endSessionHeaderReceivedCallback)return void o.AFrameworkApplication.endSessionHeaderReceivedCallback();const t=e.getResponseHeader("X-OfficeFE");t&&(this._machineIds[t]=1);const r=e.getResponseHeader("X-WacFrontEnd"),d=e.get_webRequest().get_url();let u="";if(this._wacFrontEndPerUrlIsEnabled){const e=d.indexOf("?");u=e>=0?d.substring(0,e):d,k.ULS.sendTraceTag(537995265,205,50,"Url {0}",u)}r&&(this._wacFrontEnd=r,this._wacFrontEndPerUrlIsEnabled&&(this.wacFrontEndPerUrl[u]=r,k.ULS.sendTraceTag(537995266,205,50,"Url. {0} FrontEnd Name: {1}",u,r)));e.getResponseHeader("X-RemoveWacFrontEnd")&&(this._wacFrontEnd=null,this._wacFrontEndPerUrlIsEnabled&&(this.wacFrontEndPerUrl[u]=null),k.ULS.sendTraceTag(574956177,205,50,"WacFrontEnd is set to null due to server draining to avoid unnecessary extra latency for subsequent requests."));const p=e.getResponseHeader("X-IsCacheable");!(null==p)&&Boolean.parse(p)?this._lastCorrelationId=Ae.a.create().toString():(this._lastCorrelationId=e.getResponseHeader("X-CorrelationId"),l=e.getResponseHeader("X-NewKey"),ut(l)),c=this.lastCorrelationId;const g=me.a.getPageName(n.get_url()),h=e.getResponseHeader("OdsiHttpModule"),m="1"===e.getResponseHeader("X-TokenExpired"),_=this.getFinalStatusOfRequest(i,h,m,g);a.status=_,2===_&&(s=!0),this.resetConsecutive403CounterIfRequired(i,g)}else e.get_timedOut()?a.status=7:this.telemetryStorage.addToResponseNotAvailableIds(a.id);if(null==c&&e.get_webRequest().get_headers()&&(c=e.get_webRequest().get_headers()["X-CorrelationId"]),s?this._shouldUseHttpConnectivityUpdater?this._httpConnectivityUpdater.onRequestSucceeded():this.changeNetworkStatusIfRequiredOnRequestSuccessful():this.logFailedRequestStatus(i,c,r,l,e.get_responseAvailable()?e.getAllResponseHeaders():null,a.status,n.getResolvedUrl()),e.get_responseAvailable())try{if(a.responseData=e.get_responseData(),(0,we.a)(Ye,e)&&(a.responseObject=e.get_object()),void 0!==a.responseHeadersToSet&&null!==a.responseHeadersToSet){a.responseHeaders={};for(let t=0;t<a.responseHeadersToSet.length;++t){const n=a.responseHeadersToSet[t];a.responseHeaders[n]=e.getResponseHeader(n)}}a.shouldSetResponseXml&&(e.get_responseData()&&e.get_responseData().length?a.responseXml=e.get_xml():a.responseXml=null)}catch(t){const n=me.a.removeAllUrlParameters(a.request.get_url());k.ULS.sendTraceTag(4322132,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}, Status={3}, CorrelationId={4}, Exception={5}",a.id,n,e.get_responseAvailable(),r,this.lastCorrelationId,t.toString())}this._getBooleanAppSetting(mt)&&10===a.status?this.removeById(a.id):this.createAndInvokeCompletionTask(a,t),this.invoke()}changeNetworkStatusIfRequiredOnRequestSuccessful(){this.isNetworkOffline&&(this._offlineLogger&&this._offlineLogger.listenNextTag(4284739,306,50),k.ULS.sendTraceTag(4284739,306,50,"OnNetworkResume"),this._sessionStatusManager.changeAppNetworkStatus(0)),this._firstConsecutiveFailureResponseTime=null}logFailedRequestStatus(e,t,n,a,i,o,r){if(this._shouldUseHttpConnectivityUpdater)this._httpConnectivityUpdater.onRequestFailed(!this.isRequestExemptFromTimeoutReporting(r),e);else{const t=e===Ge.a.preconditionFailed_412&&!!a,i=new Date;this._firstConsecutiveFailureResponseTime||(this._firstConsecutiveFailureResponseTime=i);const s=i.getTime()-this._firstConsecutiveFailureResponseTime.getTime();!this.isNetworkOffline&&!t&&s>=3e4&&!this.isRequestExemptFromTimeoutReporting(r)&&(this._offlineLogger&&this._offlineLogger.listenNextTag(4284740,306,50),k.ULS.sendTraceTag(4284740,306,50,"NetworkDisconnected {0}",{TimeSinceFirstFailure:s,OfflineRetryInterval:3e4,StatusCode:n,RequestStatus:o,Url:me.a.removeAllUrlParameters(r)}),this._sessionStatusManager.changeAppNetworkStatus(3))}if(this._getBooleanAppSetting("LogWhenClientRequestFailedEnabled")&&null!=t){const n="Request failed! Correlation: "+t+", StatusCode: "+e.toString();k.ULS.sendTraceTag(39936897,306,50,n)}}isRequestExemptFromTimeoutReporting(e){const t=me.a.getPageName(e);return null!=t&&this._requestsExemptFromTimeoutReporting.has(t.toLowerCase())}getRequestsExemptFromTimeoutReporting(){let e=new Array(0);o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.containsAppSetting("RequestPathsExemptFromTimeoutReporting")&&(e=o.AFrameworkApplication.appSettingsManager.getListAppSetting("RequestPathsExemptFromTimeoutReporting"));const t=new Set;for(let n=0;n<e.length;n++){const a=e[n].toLowerCase();t.add(a),k.ULS.sendTraceTag(508876616,306,50,"Request path [{0}] exempt from timeout reporting on ClientRequestManager",a)}return t}resetConsecutive403CounterIfRequired(e,t){e!==Ge.a.forbidden_403&&e&&2!==e&&this._consecutive403ErrorCount>0&&"1"===this._requestsFailedWith403Error[t]&&(this._consecutive403ErrorCount=0,this._consecutive403ErrorStart=0,this._silentAuthFailedWithError=!1,this._requestsFailedWith403Error={})}getFinalStatusOfRequest(e,t,n,a){let i;if(e===Ge.a.notFound_404)i=4;else if(e===Ge.a.preconditionFailed_412)i=5;else if(e===Ge.a.forbidden_403){t?(this._signInFrame=new tt(document.body,this.runAllSilentAuthCallbacks),i=12):i=n?12:3,k.ULS.shipAssertTag(8157283,205,!!a),this._requestsFailedWith403Error[a]="1";let e=!1;this._consecutive403ErrorStart?e=++this._consecutive403ErrorCount>=o.AFrameworkApplication.appSettingsManager.getIntAppSetting("MaxConsecutive403ErrorCount",2)&&(new Date).getTime()-this._consecutive403ErrorStart>=o.AFrameworkApplication.appSettingsManager.getIntAppSetting("Consecutive403ErrorInterval",3e3):(k.ULS.shipAssertTag(8157312,205,!this._consecutive403ErrorCount),k.ULS.sendTraceTag(8157313,205,50,"Try recovering from 403 error"),this._consecutive403ErrorCount=1,this._consecutive403ErrorStart=(new Date).getTime()),!this._isConsecutive403ErrorOccurredEventRaised&&e&&(this._silentAuthFailedWithError?k.ULS.sendTraceTag(8157314,205,50,"OnConsecutive403ErrorOccured: Legitimate since SoftAuth got MSA errors [Count: {0}]",this._consecutive403ErrorCount):k.ULS.sendTraceTag(7352910,205,50,"OnConsecutive403ErrorOccured: [Count: {0}]",this._consecutive403ErrorCount),this._isConsecutive403ErrorOccurredEventRaised=!0,this._eventSource.raiseEvent(ht))}else i=12029===e||12030===e||12031===e||12152===e||12159===e?6:Ge.a.isSuccess(e,this._getBooleanAppSetting("ClientRequestHTTPStatusResolverFix"))?2:Ge.a.isClientError(e)?11:Ge.a.isServerError(e)?9:e&&2!==e?3:8;return i}setRequestCompletionTime(e){e.completedTime=this._lastResponseTime=new Date,e.completedTimeTicks=De.a.roundNumber(xe.a.getTickCount(),2),this._markWebRequestOnTimelineIsEnabled&&e.shouldMarkOnTimeline&&p.a.instance.addMark("RequestCompleted"+e.completedTimeTicks)}addNextSilentAuthCallback(e){this._signInFrame?Array.add(this._onNextSilentAuthCallbacks,e):e()}addOnBeforeRemoveRequestCallback(e){Array.add(this._onBeforeRemoveRequestCallbacks,e)}removeOnBeforeRemoveRequestCallback(e){Array.remove(this._onBeforeRemoveRequestCallbacks,e)}executeCallbackForRequest(e,t){if(e)if(this.onPendingRequestsModified(e.requestorId,e),2===e.status){let t;e.successCallback&&e.successCallback(new Je(e)),(t=this.telemetryStorage).succeededCount=t.succeededCount+1}else{if(7===e.status){let e;(e=this.telemetryStorage).timeoutCount=e.timeoutCount+1}else{let e;(e=this.telemetryStorage).failedCount=e.failedCount+1}e.failureCallback&&e.failureCallback(new je(e))}else 0}removeById(e){const t=this.indexofId(e);if(-1===t)return null;const n=this.peekByIndex(t);return this._onBeforeRemoveRequestCallbacks.forEach((e=>{e(n)})),this._requests.removeAt(t),n}indexofId(e){return this.indexOfRequestWhere((t=>t.id===e))}indexofWebRequest(e){return this.indexOfRequestWhere((t=>t.request===e))}indexOfRequestWhere(e){for(let t=0;t<this._requests.length;++t){if(e(this._requests.peekAt(t)))return t}return-1}peekById(e){return this.peekByIndex(this.indexofId(e))}peekByWebRequest(e){return this.peekByIndex(this.indexofWebRequest(e))}peekByIndex(e){return e<0?null:this._requests.peekAt(e)}getNextRequestIdAndIncrement(){return E.a.instance.checkAndTriggerSessionHasExpired()?-1:(this._lastRequestId++,this._lastRequestId)}dump(){0}getUserTypeQueryStringPair(){return o.AFrameworkApplication.userType?String.format("{0}={1}","WacUserType",ye.a.urlKeyValueEncode(o.AFrameworkApplication.userType)):null}createUrlForShuttingDownRequest(e,t){return this.userSessionId&&(e=ft.addOrReplaceQueryParameter(e,o.AFrameworkApplication.userSessionIdQueryParam,this.userSessionId)),o.AFrameworkApplication.buildVersion&&(e=ft.addOrReplaceQueryParameter(e,"build",o.AFrameworkApplication.buildVersion)),this.wacClusterId&&!this.shouldSkipDCSpecificRequest(e)&&(e=ft.addOrReplaceQueryParameter(e,"waccluster",this.wacClusterId)),o.AFrameworkApplication.userType&&(e=ft.addOrReplaceQueryParameter(e,"WacUserType",o.AFrameworkApplication.userType)),o.AFrameworkApplication.canary&&(e=ft.addOrReplaceQueryParameter(e,"ckey",o.AFrameworkApplication.canary)),this.isAuthedRequest(e)&&(e=ft.addOrReplaceQueryParameter(e,o.AFrameworkApplication.accessTokenParamName,o.AFrameworkApplication.accessToken),e=this.addOrReplaceAccessTokenTtlParamOnUrl(e)),t?(e=ft.addOrReplaceQueryParameter(e,Se.a.endpointParamName,t.endpoint.toString()),0!==t.scenario&&(e=ft.addOrReplaceQueryParameter(e,Se.a.scenarioParamName,t.scenario.toString())),e=ft.addOrReplaceQueryParameter(e,Se.a.scenarioTypeParamName,t.scenarioType.toString())):e=ft.addOrReplaceQueryParameter(e,Se.a.endpointParamName,this._officeEndpoint.toString()),e}onWacAadTokenReceived(e){if(this._wacAadTokenCallbackEnabled){if(this._wacaadToken)return void e({token:this._wacaadToken,receivedTime:this._wacAadTokenReceivedTime});this._wacAadTokenPromise.then(e)}}onWacAcquireTokenReceived(e){if(this._wacAadTokenCallbackEnabled){if(this._wacAcquireToken)return void e({token:this._wacAcquireToken,receivedTime:this._wacAcquireTokenReceivedTime});this._wacAcquireTokenPromise.then(e)}}logWacAadTokenReceivedOrTimeOutStatus(e,t,n){k.ULS.sendTraceTag(506986524,205,50,"WacTokenReceivedOrTimeOutStatus: requestPage={0}, durationMs={1}, error={2}",e,t,n)}getWacAadTokenData(e){return!this._wacaadToken&&e&&this._wacAcquireToken?{token:this._wacAcquireToken,receivedTime:this._wacAcquireTokenReceivedTime}:{token:this._wacaadToken,receivedTime:this._wacAadTokenReceivedTime}}getTryRefreshTokenPromise(){return this._tryRefreshTokenPromise||(this._tryRefreshTokenPromise=new Promise((e=>{k.ULS.sendTraceTag(505742114,205,50,"ClientRequestManager.tryGetWacAadTokenWithTimeout: Token is expired, trying to refresh it asynchronously."),ue.a.instance.resolveFuture(gt.a).execute((t=>{const n=fe.a.corePFTData.Application;t.getTokenMetadata("Core",n).refreshFailure?e():t.tryGetToken("Core",n).then((t=>{t.IsSuccess?(k.ULS.sendTraceTag(505742113,205,50,"ClientRequestManager.tryGetWacAadTokenWithTimeout: Token is refreshed successfully."),this.wacaadToken=`Bearer ${t.Token}`,e()):(k.ULS.sendTraceTag(505741898,205,15,"ClientRequestManager.tryGetWacAadTokenWithTimeout: Token refresh failed."),e()),this._tryRefreshTokenPromise=null})).catch((t=>{k.ULS.sendTraceTag(505741795,205,15,`ClientRequestManager.tryGetWacAadTokenWithTimeout: Token refresh failed with ${t}`),e(),this._tryRefreshTokenPromise=null}))}))}))),this._tryRefreshTokenPromise}tryGetWacAadTokenWithTimeoutInternal(e,t){const n=me.a.getPageName(e),a=this.isAcquireTokenAllowedEndpoint(n);return this._wacaadToken||a&&this._wacAcquireToken||!(t>0)?Promise.resolve(this.getWacAadTokenData(a)):new Promise((e=>{let n=!1;const i=window.setTimeout((()=>{e(this.getWacAadTokenData(a)),n=!0}),t);this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldReturnAadTokenIfAvailableBeforeTimeout",!1)&&this.onWacAadTokenReceived((t=>{n||(e(t),window.clearTimeout(i))}))}))}tryGetWacAadTokenWithTimeout(e,t){const n=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.TokenRefreshManagerEnabled",!1),a=n&&pt.a.isTokenExpirationTimeKnown(this._wacaadToken),i=n&&pt.a.isTokenUnexpired(this._wacaadToken),r=n&&this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.AsynchronouslyRefreshCoreTokenIfExpired",!1)&&this.wacaadToken&&a&&!i;n&&k.ULS.sendTraceTag(505721875,205,100,"ClientRequestManager.tryGetWacAadTokenWithTimeout: Token is expired isTokenDefined={0}, isTokenExpirationTimeKnown={1}, isTokenUnexpired={2}",!!this._wacaadToken,a,i);const s=r?this.getTryRefreshTokenPromise()??Promise.resolve():Promise.resolve(),l=this._wacaadToken?r?s.then((()=>({token:this._wacaadToken,receivedTime:this._wacAadTokenReceivedTime}))):Promise.resolve({token:this._wacaadToken,receivedTime:this._wacAadTokenReceivedTime}):this._wacAadTokenPromise;if(o.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9694478_UseWacAadTokenTimeoutOnlyIfSpecified")&&(!t||t<=0))return l;if(this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldUseFixedWaitTimeoutForAadToken",!1)||this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldReturnAadTokenIfAvailableBeforeTimeout",!1))return this.tryGetWacAadTokenWithTimeoutInternal(e,t);if(!this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacAadTokenCallbackWithTimeout",!1)&&!this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.tryGetWacAadTokenWithTimeoutIsEnabled",!1))return l;if(this._wacaadToken)return l;const c=me.a.getPageName(e),d=this.isAcquireTokenAllowedEndpoint(c);if(d&&this._wacAcquireToken)return Promise.resolve({token:this._wacAcquireToken,receivedTime:this._wacAcquireTokenReceivedTime});if(!o.AFrameworkApplication.appSettingsManager)return l;const u=o.AFrameworkApplication.appSettingsManager.getStringFeatureGate("WaitForAADTokenDisabledEndpoints","");if(this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WaitforAADTokenIsDisabled",!1)||u&&c&&u.includes(c))return Promise.resolve({token:null,receivedTime:0});const p=o.AFrameworkApplication.appSettingsManager.getStringFeatureGate("WaitTimeoutForAADTokenIsDisabledEndpoints","");if(this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WaitTimeoutForAADTokenIsDisabled",!1)||p&&c&&p.includes(c))return l;if(this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSingleTimeoutForAADTokenIsEnabled",!1)){if(!this._wacAadTokenTimeoutPromise){(!o.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.WacAadTokenWaitTimeoutMs",0)||t<0)&&(t=o.AFrameworkApplication.appSettingsManager.getIntAppSetting("WacAadTokenWaitTimeoutMs",5e3)),this._wacAadTokenTimeoutPromise=new Promise((e=>{window.setTimeout((()=>{e({token:null,receivedTime:0})}),t)}))}return Promise.race([l,this._wacAadTokenTimeoutPromise])}{const e=new Date;let n=null;(!t||t<0)&&(t=o.AFrameworkApplication.appSettingsManager.getIntAppSetting("WacAadTokenWaitTimeoutMs",2e4));const a=new Promise(((e,n)=>{window.setTimeout((()=>{n("Timeout")}),t)}));if(o.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9429947_HandleAadTokenTimeourPromiseRejection")&&a.catch((e=>{k.ULS.sendTraceTag(506286490,205,100,"tryGetWacAadTokenWithTimeout timeoutPromise Error={0}",e)})),d){const e=this._wacAcquireToken?Promise.resolve({token:this._wacAcquireToken,receivedTime:this._wacAcquireTokenReceivedTime}):this._wacAcquireTokenPromise;n=Promise.race([e,l,a])}else n=Promise.race([l,a]);return n.then((t=>{const n=(new Date).getTime()-e.getTime();return this.logWacAadTokenReceivedOrTimeOutStatus(c,n,"None"),t})).catch((t=>{const n=(new Date).getTime()-e.getTime();return this.logWacAadTokenReceivedOrTimeOutStatus(c,n,t),null}))}}isAcquireTokenAllowedEndpoint(e){if(!e)return!1;let t=St;o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.containsAppSetting("AcquireTokenAllowedEndpoints")&&(t=o.AFrameworkApplication.appSettingsManager.getListAppSetting("AcquireTokenAllowedEndpoints")),t||(t=St);const n=t.includes(e.toLowerCase());return k.ULS.sendTraceTag(506986523,205,50,"isAcquireTokenAllowedEndpoint: endpoint = {0}, allowed = {1}",e,n),n}static createAnInstance(e){return ft.createAnInstanceWithResolvedDependencies(e)}static createAnInstanceWithResolvedDependencies(e){const t=o.AFrameworkApplication.appSettingsManager||new Ie.a({}),a=new Fe.a((()=>o.AFrameworkApplication.activeFrame.theStopwatchBuilder)),i=[()=>o.AFrameworkApplication.theWsaClient?o.AFrameworkApplication.theWsaClient.uploadUrl.toLowerCase():null,()=>"remoteuls.ashx",()=>"remotetelemetry.ashx",()=>"appprefetchresources.ashx"],r=(0,pe.h)(ge);let s=1;o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance&&(s=Se.a.getOfficeEndpointFromAppType(o.AFrameworkApplication.activeFrame.applicationInstance.officeAppType));const l=n(9317).a.instance;return new ft(e,t.getIntAppSetting("ClientRequestManagerMaxConnections",2),t.getIntAppSetting("ClientRequestManagerDefaultQueueTimeMs",0),t.getIntAppSetting("ClientRequestManagerDefaultSentTimeMs",0),ke.TaskManager.instance,i,(e=>!!o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e)),[()=>"rtc2/findsession"],a,o.AFrameworkApplication.theOfflineLogger,r,s,(e=>o.AFrameworkApplication.appSettingsManager?o.AFrameworkApplication.appSettingsManager.getStringAppSetting(e):null),l,((e,t)=>o.AFrameworkApplication.appSettingsManager?o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate(e,t):t))}static addGlobalRequestInfo(e,t,n,a,i){return o.AFrameworkApplication.requiresCrossDomainAjax?t=ft.addQueryParameterToUrl(t,a,i):e[n]=ye.a.httpHeaderEncode(i),t}static addQueryParameterToUrl(e,t,n){if(me.a.getParameterValue(e,t))return k.ULS.sendTraceTag(4301539,205,15,"Param collision: {0}",t),e;const a=me.a.addParameterValue(e,t,n);return a.length>2048?k.ULS.sendTraceTag(4301568,205,15,"Url too long: {0}. Length: {1}",t,a.length):e=a,e}static checkParamInUrl(e,t){return!(!e||!t)&&(-1!==e.indexOf("?"+t+"=")||-1!==e.indexOf("&"+t+"="))}static addOrReplaceQueryParameter(e,t,n){const a=me.a.addOrReplaceParameterValue(e,ye.a.urlKeyValueEncode(t),n?ye.a.urlKeyValueEncode(n):null);return a.length>2048?(k.ULS.sendTraceTag(592318752,205,15,"Url too long: {0}. Length: {1}",t,a.length),e):a}addNetCoreHeaders(e){return o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.Excel.NetCoreMigrationFlight",!1)&&(e={...e,"X-NetCoreMigrationFlight":"true"}),e}constructor(e,t,n,a,i,r,s,l,c,d,u,g,h,m,_){this._lastRequestId=0,this._openConnections=0,this._networkConnectivityListeners=[],this._requestStatusListeners=[],this._machineIds={},this._signInFrame=null,this._onNextSilentAuthCallbacks=[],this._onBeforeRemoveRequestCallbacks=[],this._requestsFailedWith403Error={},this._consecutive403ErrorCount=0,this._consecutive403ErrorStart=0,this._silentAuthFailedWithError=!1,this._isConsecutive403ErrorOccurredEventRaised=!1,this._detailedLogAlreadySentOnShutdown=!1,this._firstConsecutiveFailureResponseTime=null,this._lastCorrelationId=null,this._wacClusterId=null,this.wacUserAgent=null,this._corePftTokenReceived=!1,this._tryRefreshTokenPromise=null,this.onNetworkConnectionChanged=(e,t)=>{t.isConnected?t.isConnected&&(k.ULS.sendTraceTag(592327897,205,50,"Browser detected a network reconnect. "),this._sessionStatusManager.changeAppNetworkStatus(2)):(this._offlineLogger&&this._offlineLogger.listenNextTag(592327896,205,50),k.ULS.sendTraceTag(592327896,205,15,"Browser detected a network disconnect. "),this._sessionStatusManager.changeAppNetworkStatus(1))},this.onRequestCompletedSynchronousNotify=e=>{let t;(t=this.telemetryStorage).synchronousNotificationCount=t.synchronousNotificationCount+1,this.onRequestCompletedInternal(e,!0)},this.onRequestCompleted=e=>{this.onRequestCompletedInternal(e,!1)},this.runAllSilentAuthCallbacks=e=>{const t=e;if(t){const e=me.a.getParameterValue(t,"f");e?(k.ULS.sendTraceTag(8157315,205,50,"SilentAuth failed with error code: {0}",{f:e,MSPPError:me.a.getParameterValue(t,"MSPPError")}),this._silentAuthFailedWithError=!0):this._silentAuthFailedWithError=!1}this._signInFrame&&(this._onNextSilentAuthCallbacks.forEach((e=>{e()})),Array.clear(this._onNextSilentAuthCallbacks),this._signInFrame=null)},this.timeoutCallbackProcess=e=>{const t=e.data,n=e.customData;if(!this.ensureQueuedTimeoutTaskRemoved(n))return void 0;const a=me.a.removeAllUrlParameters(n.request.get_url());let i;0===n.status?(n.status=13,n.completedTime=new Date,n.completedTimeTicks=De.a.roundNumber(xe.a.getTickCount(),2),this._markWebRequestOnTimelineIsEnabled&&n.shouldMarkOnTimeline&&p.a.instance.addMark("RequestCompleted"+n.completedTimeTicks),this.removeById(n.id),this.executeCallbackForRequest(n,t),k.ULS.sendTraceTag(5904528,306,15,"TimeoutCallbackProcess: Request timed out in the queue. {0}",{Url:a})):k.ULS.shipAssertTag(5904529,306,!1,"TimeoutCallbackProcess: Leaving request untouched. It timed out in the queue with unexpected status. {0}",{Url:a,Status:n.status}),(i=this.telemetryStorage).invokeTimeoutCount=i.invokeTimeoutCount+1},this.callbackProcess=e=>{const t=e.data;const n=this.removeById(parseInt(t));this.executeCallbackForRequest(n,t)},this.sendShuttingDownRequest=this.sendShuttingDownRequestInternal,this._requests=new Re.a,this._userSessionId=e,this._stopwatchBuilder=c,this.maxConnections=t,this._defaultQueueTimeoutMs=n,this._defaultSentTimeoutMs=a,this._taskManager=i,this._nonAuthedUrls=r,this._nonDCSpecificUrls=l,this._lastResponseTime=new Date,this._eventSource=new rt.a,this._telemetryStorage=new He,this._getBooleanAppSetting=s,this._getStringAppSetting=h,this._getBooleanFeatureGate=_,this._clientRequestAuthProcessor=_e.getProcessor(),this._clientRequestBuilder=be.getBuilder(s,_),this._networkConnectivityNotifier=qe.getNotifier(m),this._httpConnectivityUpdater=ct.instance,this._offlineLogger=d,this._markWebRequestOnTimelineIsEnabled=this._getBooleanAppSetting("MarkWebRequestOnTimelineIsEnabled"),this._wacFrontEnd=this._getStringAppSetting("WacWebFrontEnd"),this._wacFrontEndPerUrl={},this._setRequestExpirableHeadersDuringInvoke=this._getBooleanAppSetting("SetRequestExpirableHeadersDuringInvoke"),this._wacFrontEndPerUrlIsEnabled=this._getBooleanFeatureGate("Microsoft.Office.WordOnline.WACFrontEndPerUrlIsEnabled",!1),this._shouldUseHttpConnectivityUpdater=o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HttpConnectivityUpdaterIsEnabled"),this._requestsExemptFromTimeoutReporting=this.getRequestsExemptFromTimeoutReporting(),u&&u.execute((e=>{e.add_networkConnectivityChanged(this.onNetworkConnectionChanged)}));const S=this._getStringAppSetting("WacToken");window.location.href.indexOf("wdnetcorerouting=true")>-1?this.netcoreRouting="true":window.location.href.indexOf("wdnetcorerouting=false")>-1&&(this.netcoreRouting="false"),S&&(this.wacaadToken="Bearer "+S),this._wacAadTokenPromise=new Promise((e=>{this._wacAadTokenPromiseResolve=e})),this._wacAcquireTokenPromise=new Promise((e=>{this._wacAcquireTokenPromiseResolve=e})),this._wacAadTokenCallbackEnabled=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacAadTokenCallback",!1),this._wacAcquireTokenTelemetryEnabled=o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9562513_AcquireTokenTelemetry"),this._logHpaEndpointUsageEnabled=this._getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogHPAEndpointUsage",!1),this._sessionStatusManager=m,this._officeEndpoint=g,Me.a.addConnectivityListener(this)}}ft.invalidRequestId=0,(0,a.a)(ft,"ClientRequestManager",null,[63]);var Ct=n(3989),yt=n(6012),At=n(4238),bt=n(815),Tt=n(507),vt=n(2409),wt=n(7827),Ft=n(2246),It=n(1207),Et=n(502);class Mt{constructor(){this.buttonActionCommand=null,this.createNewDocumentAspxRelativePath="",this.flyoutAnchorId=null,this.headerButtonId=null,this.headerButtonText=null,this.headerButtonTitle=null,this.image32by32=null,this.image32by32Class=null,this.labelText=null}}(0,a.a)(Mt,"FileNewProperties",null,[]);class kt{constructor(){this.buttonActionCommand=null,this.flyoutAnchorId=null,this.image32by32=null,this.image32by32Class=null}}(0,a.a)(kt,"FileOpenProperties",null,[]);var Pt=n(4378),Dt=n(576),Rt=n(5368),xt=n(451),Lt=n(8054),Ut=n(9267),Ot=n(8009),Bt=n(8174);class Nt{constructor(e=null,t=null,n=null,a=null,i=null,o=null,r=null,s=null){this.logMessageMaxChars=3072,this.sizeThresholdBytes=65536,this.uploadCadenceMs=6e4,this.throttlingTimeoutMs=2e3,this.delayedLogHandlingCadenceMs=1e4,this.asyncUploadRequestTimeout=5e3,this.asyncOverride=!1,this.uploadMaximumSizeBytes=0,null!=e&&(this.logMessageMaxChars=e),null!=t&&(this.sizeThresholdBytes=t),null!=n&&(this.uploadCadenceMs=n),null!=a&&(this.throttlingTimeoutMs=a),null!=i&&(this.delayedLogHandlingCadenceMs=i),null!=o&&(this.asyncUploadRequestTimeout=o),null!=r&&(this.asyncOverride=r),null!=s&&s>0&&(this.uploadMaximumSizeBytes=s)}}(0,a.a)(Nt,"UlsUploadConfiguration",null,[]);var Wt=n(2691);class Ht{resetDelayedLogBuffer(){this._delayedLogBuffer=[],this._exceededDelayedLogLimit=!1}handleTrace(e){if(this.ulsCallDepth>1){const t=this.delayedLogsLimit();t<0||this._delayedLogBuffer.length<t?Array.add(this._delayedLogBuffer,e):this._exceededDelayedLogLimit=!0}else this._logCache.addLog(e),this.logIndicatesError(e)&&!this.disableSynchronousFlush()?(this.flushSynchronous("LogIndicatesError in HandleTrace"),k.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",Wt.a(e.tag))):this._logCache.isDataSizeThresholdExceeded&&(this.flushImpl(!1,!0),k.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size"))}logIndicatesError(e){return!!e&&(1===e.logType||10===e.level)}disableSynchronousFlush(){return!1}dispose(){this._disposing||(this._disposing=!0,this.flushForAppClose(),k.ULS.setUlsHost(null),window.clearTimeout(this._asyncFlushTimeoutId),window.clearTimeout(this._delayedLoggingTimerId),window.clearTimeout(this._cadenceTimerId),this._asyncFlushTimeoutId=0,this._delayedLoggingTimerId=0,this._cadenceTimerId=0)}flushForAppClose(){this.mode=2,this.handleDelayedLogs(),this.sendAfterThrottling=!1,this.endThrottling(),this.flushSynchronous("FlushForAppClose")}uploadLogs(e,t){return e.uploadId=this.nextUploadId,!!this.uploadSerializedLogs(e.serialize(),t)&&(this.nextUploadId++,!0)}uploadSerializedLogs(e,t){const n=this._asyncOverride||!t;return this._request&&n||(this._request=new XMLHttpRequest),0===this._request.readyState||4===this._request.readyState?(this._request.open("POST",this.uploadUrl,n),this._request.setRequestHeader("Content-Type","application/json"),this._request.setRequestHeader(Ht.sessionIdHeaderName,this._sessionId),n&&(this._request.timeout=this._uploadRequestTimeout),this.modifyHttpRequestBeforeUploading(this._request),this._request.send(e),!0):(k.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{UploadId:this.nextUploadId,XhrReadyState:this._request.readyState}),!1)}onUploadException(e){this._request&&this._request.abort()}modifyHttpRequestBeforeUploading(e){}suppressAssertOnUploadFailure(){return!1}delayedLogsLimit(){return 256}setTimeoutToLogOriginAndExecute(e,t,n){try{return window.setTimeout((()=>{k.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",t,n),e()}),t)}catch(t){if(k.ULS.sendTraceTag(0,100,15,"SetTimeoutToLogOriginAndExecute: Calling Window.SetTimeout() failed with exception: {0}",t.toString()),!this.setTimeoutToLogOriginAndExecuteReentrancyDetector){this.setTimeoutToLogOriginAndExecuteReentrancyDetector=!0;try{e()}finally{this.setTimeoutToLogOriginAndExecuteReentrancyDetector=!1}}return 0}}resetDelayedLoggingTimer(){try{window.clearTimeout(this._delayedLoggingTimerId)}catch(e){k.ULS.sendTraceTag(0,100,15,"ResetDelayedLoggingTimer: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}this._delayedLoggingTimerId=this.setTimeoutToLogOriginAndExecute((0,i.a)(this,this.handleDelayedLogs,"handleDelayedLogs"),this._delayedLogHandlingCadenceMs,"ResetDelayedLoggingTimer")}get ulsCallDepth(){return k.ULS.ulsCallDepth+this._ulsCallDepthAdjustment}handleDelayedLogs(){const e=this._delayedLogBuffer.length;if(!e)return void this.resetDelayedLoggingTimer();const t=this._delayedLogBuffer,n=this._exceededDelayedLogLimit;this.resetDelayedLogBuffer(),k.ULS.sendTraceTag(3731798,100,50,"HandleDelayedLogs {0}",{Count:e,Limit:this.delayedLogsLimit(),ExceededLimit:n}),this._ulsCallDepthAdjustment++;for(let n=0;n<e;n++)this.handleTrace(t[n]);this._ulsCallDepthAdjustment--,this.resetDelayedLoggingTimer()}resetCadenceTimer(){try{window.clearTimeout(this._cadenceTimerId)}catch(e){k.ULS.sendTraceTag(0,100,15,"ResetCadenceTimer: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}this._cadenceTimerId=this.setTimeoutToLogOriginAndExecute((0,i.a)(this,this.flushImpl,"flushImpl"),this._uploadCadenceMs,"ResetCadenceTimer")}get mode(){return this._mode}set mode(e){const t=this._mode;if(this._mode=e,0===this._mode&&0!==t)try{const e=this._throttlingTimeoutId;this._throttlingTimeoutId=0,window.clearTimeout(e)}catch(e){k.ULS.sendTraceTag(0,100,15,"set_Mode: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}else 0!==this._mode&&0===t&&(this._throttlingTimeoutId=this.setTimeoutToLogOriginAndExecute((0,i.a)(this,this.endThrottling,"endThrottling"),this._throttlingTimeoutMs,"ThrottlingMode Setter"))}endThrottling(){this.mode=0,this.sendAfterThrottling&&(this.sendAfterThrottling=!1,this.flushImpl())}shouldThrottle(e){return 2===this.mode||1===this.mode&&!e}flushSynchronous(e){k.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",e),this.flushImpl(!0)}flushAsynchronous(){this.flushAsynchronousInternal(0)}flushAsynchronousInternal(e){this._asyncFlushTimeoutId||(this._asyncFlushTimeoutId=this.setTimeoutToLogOriginAndExecute((0,i.a)(this,this.flushImpl,"flushImpl"),e,"FlushAsynchronous"))}flushImpl(e,t){this._ulsCallDepthAdjustment++;try{window.clearTimeout(this._asyncFlushTimeoutId)}catch(e){k.ULS.sendTraceTag(0,100,15,"FlushImpl: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}if(this._asyncFlushTimeoutId=0,!this._logCache.count)return this.resetCadenceTimer(),void this._ulsCallDepthAdjustment--;if(!t&&this.shouldThrottle(e))return k.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",e?"sync":"async"),this.sendAfterThrottling=!0,void this._ulsCallDepthAdjustment--;let n;this.mode=e?2:1,this.resetCadenceTimer(),k.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",e?"sync":"async",this._logCache.count);try{n=this.uploadLogs(this._logCache,e)}catch(e){0,this.onUploadException(e),n=!1}n?(this._logCache.reset(),this._failedUploadAttemptCount=0):(this._failedUploadAttemptCount++,this._failedUploadAttemptCount<Ht.maxUploadAttempts?this.flushAsynchronousInternal(Ht.retryDelay):(this.suppressAssertOnUploadFailure(),this._logCache.reset(),this.nextUploadId++,this._failedUploadAttemptCount=0)),this._ulsCallDepthAdjustment--}showAssertDialog(e){}handoffToNewHost(e){}add_onUlsTrace(e){}remove_onUlsTrace(e){}get logCache(){return this._logCache}set logCache(e){this._logCache=e}get delayedLogBuffer(){return this._delayedLogBuffer}get cadenceTimerId(){return this._cadenceTimerId}get delayedLoggingTimerId(){return this._delayedLoggingTimerId}get asyncFlushTimeoutId(){return this._asyncFlushTimeoutId}get throttlingTimeoutId(){return this._throttlingTimeoutId}get ulsCallDepthAdjustment(){return this._ulsCallDepthAdjustment}set ulsCallDepthAdjustment(e){this._ulsCallDepthAdjustment=e}constructor(e,t,n=null){this._failedUploadAttemptCount=0,this._exceededDelayedLogLimit=!1,this.nextUploadId=0,this._delayedLogBuffer=null,this._ulsCallDepthAdjustment=0,this._request=null,this._disposing=!1,this.setTimeoutToLogOriginAndExecuteReentrancyDetector=!1,this._delayedLoggingTimerId=0,this._cadenceTimerId=0,this._throttlingTimeoutId=0,this._mode=0,this.sendAfterThrottling=!1,this._asyncFlushTimeoutId=0,n||(n=new Nt),this._sessionId=e,this.uploadUrl=t,this.uploadUrl.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&k.ULS.disable(),this._uploadCadenceMs=n.uploadCadenceMs,this._throttlingTimeoutMs=n.throttlingTimeoutMs,this._delayedLogHandlingCadenceMs=n.delayedLogHandlingCadenceMs,this._uploadRequestTimeout=n.asyncUploadRequestTimeout,this._asyncOverride=n.asyncOverride,this._logCache=new Bt.a(n.sizeThresholdBytes,n.logMessageMaxChars,e),this._logCache.uploadMaximumSizeBytes=n.uploadMaximumSizeBytes,this.resetCadenceTimer(),this.resetDelayedLogBuffer(),this.resetDelayedLoggingTimer()}}Ht.defaultRemoteUlsUrl="RemoteUls.ashx",Ht.maxUploadAttempts=3,Ht.retryDelay=15e3,Ht.sessionIdHeaderName="X-UserSessionId",(0,a.a)(Ht,"UploadingUlsHost",null,[190,11]);class Vt{constructor(e,t,n,a){this.uploadId=e,this.attemptCount=t,this.sessionId=n,this.version=a}}(0,a.a)(Vt,"UploadState",null,[]);class Gt{get keepAlive(){return this._keepAlive}constructor(e){this._keepAlive=e}}(0,a.a)(Gt,"FetchRequestArgs",null,[]);var Qt=n(8498);class qt extends Sys.EventArgs{constructor(e){super(),this.args=e}}(0,a.a)(qt,"UlsLoggingEventArgs",Sys.EventArgs,[]);class Kt extends Ht{get events(){return this._events||(this._events=new Sys.EventHandlerList)}add_onUlsTrace(e){this.events.addHandler(Kt.ulsTraceEventKey,e)}remove_onUlsTrace(e){this.events.removeHandler(Kt.ulsTraceEventKey,e)}get overwriteSessionId(){return null}get overwriteVersion(){return null}get bUlsExceptionLoggingIsEnabled(){return this._appSettingsGetter.getBooleanAppSetting("BUlsExceptionLoggingIsEnabled")}dispose(){this._disposing$1||(this._disposing$1=!0,super.dispose(),this._appSettingsRefresher&&this._appSettingsRefresher.remove_onSettingsRefreshed(this.onSettingsRefreshed))}getCallStack(){return(new Error).stack}getTagCallStackInclusionList(){let e=null;return this._appSettingsGetter.containsAppSetting(Kt.tagCallStackInclusionListSettingName)&&(e=new Set(this._appSettingsGetter.getListAppSetting(Kt.tagCallStackInclusionListSettingName))),e}handleTrace(e){if(this._tagCallStackInclusionList||(this._tagCallStackInclusionList=this.getTagCallStackInclusionList()),this._tagCallStackInclusionList&&this._tagCallStackInclusionList.has(e.tag))try{if(!e.exceptionArgs&&this.bUlsExceptionLoggingIsEnabled)e.exceptionArgs=new Qt.a(new Error);else{const t=this.getCallStack();e.message+=". JsCallStack: "+t}}catch(t){e.message+=" [Failed to add callstack for this tag. BUlsExceptionLoggingIsEnabled="+this.bUlsExceptionLoggingIsEnabled+" ("+t.message+")]"}super.handleTrace(e);const t=this.events.getHandler(Kt.ulsTraceEventKey),n=new qt(e);t&&t(null,n)}showAssertDialog(e){0}uploadLogs(e,t){if(this._clientRequestManager){if(!this.shouldTrySendingTheRequest)return!1;const t=e.serialize();return!(o.AFrameworkApplication.bulsUploadMaxSize>0&&t.length>o.AFrameworkApplication.bulsUploadMaxSize)&&(e.uploadId=this.nextUploadId++,this.shouldSendShuttingDownRequest()?(this.sendShuttingDownRequest(this.uploadUrl,t),!0):(this.addUploadRequestUseFetch(this.uploadUrl,t,3,1,e.uploadId,this.overwriteSessionId,this.overwriteVersion),!0))}return this.sendRequestUseFetchWithoutClientRequestManager(this.uploadUrl,e.serialize()),!0}onSuccessfulUpload(e){this.setbUlsFailingUnexpectedlyFalse();try{if(!(e&&e.data&&e.data.responseHeaders&&Kt.headerSuppressionETag in e.data.responseHeaders))return;const t=e.data.responseHeaders[Kt.headerSuppressionETag];if(t===this._suppressionETag)return;this._suppressionETag=t;const n=e.data.responseHeaders[Kt.headerSuppressedTags];Kt.processSuppressedTags(n)}catch(e){k.ULS.sendTraceTag(593847297,100,50,"Failed to process tag suppressions. [Message: {0}] [Stack: {1}]",e.message,e.stack)}}onFailedUpload(e){const t=e.data;if(!t)return void k.ULS.sendTraceTag(5002497,100,15,"Request Item is null! RequestFailedEventArgs = {0}",e);if(13===t.status)return k.ULS.sendTraceTag(6399108,100,50,"Request timed out in the ClientRequestManager queue. Falling back to default XHR."),void this.uploadSerializedLogs(t.request.get_body(),!1);if(!t.responseHeaders)return k.ULS.sendTraceTag(5002498,100,15,"Item.ResponseHeader is null! RequestItem id = {0}, responseXml = {1}, data = {2}, HttpStatusCode = {3}",t.id,t.responseXml,t.responseData,t.httpStatus),void this.checkAndSetbUlsFailingUnexpectedlyTrue();if(Kt.invalidUlsJsonHeaderName in t.responseHeaders)return;const n=t.httpStatus;if(400<=n&&n<=499)return;const a=t.state;a.attemptCount>=Ht.maxUploadAttempts||window.setTimeout((()=>{this.addUploadRequestUseFetch(t.request.get_url(),t.request.get_body(),3,a.attemptCount+1,a.uploadId,a.sessionId,a.version)}),Ht.retryDelay)}addUploadRequest(e,t,n,a,i,o,r,s){this.addUploadRequestUseFetch(e,t,n,a,o,r,s)}addUploadRequestUseFetch(e,t,n,a,o,r,s){this._clientRequestManager.addFetchRequest(e,2,t,this.createHeaders(),new Gt(!1),!1,n,(0,i.a)(this,this.onSuccessfulUpload,"onSuccessfulUpload"),(0,i.a)(this,this.onFailedUpload,"onFailedUpload"),new Vt(o,a,r,s),null,this._appSettingsGetter.getIntAppSetting("BulsClientRequestManagerQueueTimeInMS",3e4),void 0,"19",r,s,[Kt.headerSuppressionETag,Kt.headerSuppressedTags])}sendRequestUseFetchWithoutClientRequestManager(e,t){const n={};n.body=t,n.method="POST",n.headers=this.createHeaders(),window.fetch(e,n).then((e=>null),(e=>(k.ULS.sendTraceTag(509149207,100,50,"exception from buls fetch"),null)))}checkAndSetbUlsFailingUnexpectedlyTrue(){const e=this._lazyClientRequestBuilder.value;e&&this.shouldTrySendingTheRequest&&(this._bUlsUploadsFailingUnexpectedly=!0,e.updateAdditionalHeaders(Kt.headerbUlsUploadsFailingUnexpectedly,"1"))}setbUlsFailingUnexpectedlyFalse(){const e=this._lazyClientRequestBuilder.value;e&&this._bUlsUploadsFailingUnexpectedly&&(this._bUlsUploadsFailingUnexpectedly=!1,e.updateAdditionalHeaders(Kt.headerbUlsUploadsFailingUnexpectedly,"0"))}createHeaders(){let e=null;if(this._suppressionETag&&(e={},e[Kt.headerSuppressionETag]=this._suppressionETag),this.bUlsExceptionLoggingIsEnabled){const t=o.AFrameworkApplication.activeFrame;let n=null;t&&(n=t.applicationInstance),n&&(e||(e={}),e[Kt.headerOfficeAppMode]=n.officeAppMode,e[Kt.headerOfficeAppType]=n.officeAppType,e[Kt.headerUseSourceMaps]=o.AFrameworkApplication.isClosureEnabled?"1":"0",e[Kt.headerContentType]="text/plain")}return e}sendShuttingDownRequest(e,t){this._clientRequestManager.sendShuttingDownRequest(e,t)}shouldSendShuttingDownRequest(){return o.AFrameworkApplication.isShuttingDown||o.AFrameworkApplication.isShuttingDownFromPostMessage}get retryDelayWhenDisconnectedInMilliseconds(){return this._retryDelayWhenDisconnectedInMilliseconds||(this._retryDelayWhenDisconnectedInMilliseconds=this._appSettingsGetter.getIntAppSetting("bULSUploadRetryDelayWhenDisconnectedInMilliseconds",6e4)),this._retryDelayWhenDisconnectedInMilliseconds}get shouldTrySendingTheRequest(){const e=this._clientRequestManager.isNetworkOffline;if(e){if((new Date).getTime()-this._clientRequestManager.lastResponseTime.getTime()>=this.retryDelayWhenDisconnectedInMilliseconds)return!0}return!e}static getBulsEndpointUrl(e,t){const n=t.getStringAppSetting("BulsEndpointUrl");return Kt.isNonEmptyString(n)?n:e}static isNonEmptyString(e){return!(null==e)&&""!==e}static generateCompleteRemoteUlsUrl(e,t,n,a){return e=Kt.addBuildNumber(e,t),e=Kt.addWacCluster(e,n),e=Kt.addOfficeServerVersion(e,a),e=Kt.addUserSessionId(e)}static addBuildNumber(e,t){return t?me.a.addOrReplaceParameterValue(e,"build",o.AFrameworkApplication.buildVersion):e}static addWacCluster(e,t){if(!t)return e;const n=t.wacClusterId;return n?e=me.a.addOrReplaceParameterValue(e,"waccluster",n):e}static addOfficeServerVersion(e,t){return Kt.isNonEmptyString(t)?me.a.addOrReplaceParameterValue(e,"officeserverversion",t):e}static addUserSessionId(e){return o.AFrameworkApplication.userSessionId&&""!==o.AFrameworkApplication.userSessionId?me.a.addOrReplaceParameterValue(e,o.AFrameworkApplication.userSessionIdQueryParam,o.AFrameworkApplication.userSessionId):e}static createHostAndInitUlsForApp(e=Ht.defaultRemoteUlsUrl,t=!0){if(o.AFrameworkApplication.browserUlsIsEnabled){const n=(0,pe.j)(Ot.a),a=new Kt(e,t,o.AFrameworkApplication.theClientRequestManager,n||o.AFrameworkApplication.appSettingsManager,n);k.ULS.setUlsHost(a),k.ULS.setTraceLevel(o.AFrameworkApplication.browserUlsTraceLevel)}else k.ULS.disable();return k.ULS.host}static processSuppressedTags(e){if(k.ULS.clearSuppressedTags(),!e)return;const t=e.split(",");for(const e of t){const t=parseInt(e);!isNaN(t)&&isFinite(t)&&k.ULS.addSuppressedTag(t)}}constructor(e,t,n,a,i,r=null){if(super(o.AFrameworkApplication.userSessionId,Kt.generateCompleteRemoteUlsUrl(Kt.getBulsEndpointUrl(e,a),t,n,r),new Nt(void 0,o.AFrameworkApplication.get_bulsSizeThresholdBytes(),a.getIntAppSetting("BulsUploadFrequencyInMs",6e4),void 0,void 0,void 0,void 0,o.AFrameworkApplication.bulsUploadMaxSize)),this._disposing$1=!1,this._events=null,this._appSettingsRefresher=null,this._tagCallStackInclusionList=null,this._firstFailure=void 0,this._retryDelayWhenDisconnectedInMilliseconds=null,this.onSettingsRefreshed=(e,t)=>{t.isSettingChanged(Kt.tagCallStackInclusionListSettingName)&&(this._tagCallStackInclusionList=this.getTagCallStackInclusionList())},this._clientRequestManager=n,this._appSettingsGetter=a,this._clientRequestManager,this._suppressionETag=this._appSettingsGetter.getStringAppSetting("RemoteUlsETag"),this._suppressionETag){const e=this._appSettingsGetter.getStringAppSetting("RemoteUlsSuppressions");Kt.processSuppressedTags(e)}i&&(this._appSettingsRefresher=i,this._appSettingsRefresher.add_onSettingsRefreshed(this.onSettingsRefreshed)),this._bUlsUploadsFailingUnexpectedly=!1,this._lazyClientRequestBuilder=new Fe.a((()=>be.getBuilder(o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting,o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate)))}}Kt.headerSuppressionETag="X-bULS-SuppressionETag",Kt.headerSuppressedTags="X-bULS-SuppressedTags",Kt.headerOfficeAppMode="X-bULS-OfficeAppMode",Kt.headerOfficeAppType="X-bULS-OfficeAppType",Kt.headerUseSourceMaps="X-bULS-UseSourceMaps",Kt.headerbUlsUploadsFailingUnexpectedly="X-NoUls",Kt.headerContentType="Content-Type",Kt.ulsTraceEventKey="CommonUlsTraceEventKey",Kt.tagCallStackInclusionListSettingName="TagCallStackInclusionList",Kt.invalidUlsJsonHeaderName="X-InvalidUlsJson",(0,a.a)(Kt,"CommonUlsHost",Ht,[]);var zt=n(5374),jt=n(1333),Zt=n(988),Xt=n(3529);class Jt extends Xt.a{reset(e){this._argsCache=[],e||window.setTimeout((0,i.a)(this,this.reset,"reset"),6e4),k.ULS.sendTraceTag(3973958,101,50,"Reset")}handleTrace(e){e&&Array.add(this._argsCache,e)}handoffToNewHost(e){const t=this._argsCache.length;if(k.ULS.sendTraceTag(3973959,101,50,"Cached {0} logs",t),this._fixCachingUlsHostBugHandoffToNewHost)for(const t of this._argsCache)e.handleTrace(t);else for(let n=0;n<t;n++)e.handleTrace(this._argsCache[n])}flushAsynchronous(){}get argsCache(){return this._argsCache}constructor(e,t,n=!1){super(),this._argsCache=null,this._appName=e,this._fixCachingUlsHostBugHandoffToNewHost=n,this.reset(t)}}var Yt;(0,a.a)(Jt,"CachingUlsHost",Xt.a,[]),function(e){e[e.nil=0]="nil",e[e.incorrectPassword=1]="incorrectPassword",e[e.thresholdExceededForAttempt=2]="thresholdExceededForAttempt"}(Yt||(Yt={})),(0,a.b)("ErrorState",Yt);var $t,en=n(15),tn=n(3563);class nn extends tn.CustomDialog{start(){const e={id:"PasswordDialog",bodyControls:{description:String.format(CommonUiStrings.PasswordDialogContentText,this._filename),placeholderText:CommonUiStrings.PasswordDialogPlaceholderText,passwordShowEyeIconAriaLabel:CommonUiStrings.PasswordDialogShowPasswordEyeIconAriaLabel,passwordHideEyeIconAriaLabel:CommonUiStrings.PasswordDialogHidePasswordEyeIconAriaLabel,passwordInputFieldAriaLabel:CommonUiStrings.PasswordDialogPlaceholderText,verifyPasswordAction:this.passwordCallbackHandler.bind(this),incorrectPasswordErrorMessage:CommonUiStrings.PasswordDialogIncorrectPasswordMessage,attemptThresholdExceededErrorMessage:CommonUiStrings.PasswordDialogThresholdAttemptExceededMessage}};this.initializeAndShow(CommonUiStrings.PasswordDialogTitleText,((e,t)=>{}),e)}passwordCallbackHandler(e,t){this._setErrorStateHandler=t,this._dialogHandler(e)}setErrorState(e){this._setErrorStateHandler(e)}constructor(e,t){super(!1,!1,!0),this._filename=e,this._dialogHandler=t,this._hideOnButtonClick=!1,this.buttonsOption=0,this.hasCloseGlyph=!1}}(0,a.a)(nn,"PasswordInputDialog",tn.CustomDialog,[]),function(e){e[e.none=0]="none",e[e.oneNote=1]="oneNote",e[e.word=2]="word",e[e.wordViewer=3]="wordViewer",e[e.powerPoint=4]="powerPoint"}($t||($t={})),(0,a.b)("AppMode",$t);var an=n(6996),on=n(3911),rn=n(4555);class sn extends tn.CustomDialog{get radioboxName(){return"ListRadioBox"}get radioboxPrefix(){return"radiobox"}get radioRowClassName(){return"WACZoomDialogRadioRow"}get radioRowHighlightClassName(){return"WACZoomDialogRadioRow-highlight"}get focusManager(){return this._focusManager}get activeSelection(){return this._activeSelection}showZoomDialog(e,t){const n=new Array(this._zoomLists.length);let a="";for(let e=0;e<this._zoomLists.length;e++){const i=e.toString(),o=this._zoomLists[e];n[e]={key:i,text:o},t===this._zoomValues[e]&&(a=i)}const i={};i.dialogChoiceGroupProps={id:this.zoomDialogBoxGroupID,defaultSelectedKey:a,options:n};const o={id:"OptionsDialog",bodyControls:i};this.initializeAndShow(e,this.zoomDialogReactHandler,o)}selectFirstZoomOption(){this._activeSelection=document.getElementsByName(this.radioboxName)[0],this.focusRadioButton(this.activeSelection)}focusRadioButton(e){e&&(e.checked=!0,this.focusManager.currentScope&&this.focusManager.currentScope.name===this.fullDialogFocusId||this.focusManager.setScope(this.fullDialogFocusId),this.focusManager.getCurrentRegion().listing.trySetCurrentElement(e),e.focus(),this.activeSelection&&Sys.UI.DomElement.removeCssClass(this.activeSelection.parentNode,this.radioRowHighlightClassName),Sys.UI.DomElement.addCssClass(e.parentNode,this.radioRowHighlightClassName),this._activeSelection=e)}constructor(e,t,n,a){super(!1,!1,!0),this._activeSelection=null,this.zoomDialogBoxGroupID="ZoomDialogBoxGroup",this.zoomDialogReactHandler=(e,t)=>{if(1!==e)return;const n=t.selectedOption.toString(),a=Number.parseInvariant(n);this._zoomDialogCallback(this._zoomValues[a])},this._zoomLists=e,this._zoomValues=t,this._zoomDialogCallback=n,this._focusManager=a,this.dialogId="ZoomDialog"}}(0,a.a)(sn,"ZoomDialog",tn.CustomDialog,[281]);class ln{create(e,t,n,a){return this._dialog=new sn(e,t,n,a),this._dialog}constructor(){this._dialog=null}}(0,a.a)(ln,"ZoomDialogFactory",null,[41]);var cn=n(4934),dn=n(459),un=n(3823),pn=n(1694),gn=n(5072),hn=n(415),mn=n(3485);class _n{init(){this._actionManager.addAction(on.a.onCurrentPageChange,hn.a.application,this.onCurrentPageChange),this._actionManager.addActionWithFlags(on.a.queryCurrentPageLabel,hn.a.application,this.onQueryCurrentPageLabel,96);const e=this._focusManager.getScope(At.a.appFocusId);e.bindAction(T.a.hashKey(gn.a.vK_Comma,T.a.commandKeyModifier),on.a.prevPage),e.bindAction(T.a.hashKey(gn.a.vK_Period,T.a.commandKeyModifier),on.a.nextPage),this._inited=!0}dispose(){}onPageJump(e){const{App:t}=n(6921);this._lazyScrollControl.value.scrollToPage(e),t.get_activeAppFrame().ribbonUser&&t.get_activeAppFrame().ribbonUser.poll(),t.get_activeAppFrame().statusBarUser&&t.get_activeAppFrame().statusBarUser.pollControl(mn.a.pageInfoLabel)}constructor(e,t,a,i){this._inited=!1,this.nextPage=(e,t,a,i,o)=>{const{App:r}=n(6921);if(1===a||!this._inited)return 32;let s;return s=r.get_activeAppFrame()?r.get_activeAppFrame().workspace.getCurrentPage():1,s<this._documentDataUtils.pageCount&&this.onPageJump(s+1),32},this.prevPage=(e,t,a,i,o)=>{const{App:r}=n(6921);if(1===a||!this._inited)return 32;let s;return s=r.get_activeAppFrame()?r.get_activeAppFrame().workspace.getCurrentPage():1,s>1&&this.onPageJump(s-1),32},this.onCurrentPageChange=(e,t,a,i,o)=>{const{App:r}=n(6921);return 1===a?r.isReadyForRibbon()?32:8:(this.onPageJump(o),32)},this.onQueryCurrentPageLabel=(e,t,a,i,o)=>{if(1===a)return 32;const r=o,s=n(6921).App.get_activeAppFrame().workspace.getCurrentPage(),l=this._documentDataUtils.pageCount;return r[un.a.Value]=String.format(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PageLabel),s,l>0?l.toString():WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PageCountUnknown)),r[pn.a.labelText]=r[un.a.Value],32},this._actionManager=e,this._focusManager=t,this._documentDataUtils=a,this._lazyScrollControl=i,this._actionManager.addAction(on.a.prevPage,hn.a.application,this.prevPage),this._actionManager.addAction(on.a.nextPage,hn.a.application,this.nextPage)}}(0,a.a)(_n,"NavigationControl",null,[15,11]);var Sn=n(6094);class fn{isDragPossible(e){return 3!==e.inputSource&&e.mouseButton===Sys.UI.MouseButton.leftButton}onDragStart(e){return!!this.isDragPossible(e)&&(this._mostRecentClientPoint=e.clientPoint,!0)}onDragMove(e){const t=e.clientPoint,n=t.y-this._mostRecentClientPoint.y,a=t.x-this._mostRecentClientPoint.x;return this.scrollVert&&(this._element.scrollTop-=n),this.scrollHoriz&&(this._element.scrollLeft-=a),this._mostRecentClientPoint=t,!0}onDragEnd(e){this._mostRecentClientPoint=null}onDragCancel(e){this._mostRecentClientPoint=null}constructor(e){this._mostRecentClientPoint=null,this.scrollHoriz=!0,this.scrollVert=!0,this._element=e}}(0,a.a)(fn,"ScrollDragAdapter",null,[296]);var Cn=n(872);class yn{registerDragScrollRegion(e){const t=new fn(e);this._dragInputManager.registerDragAdapterWithPriority(e,t,2),Cn.a.setObject(e,"dsa",t)}unregisterDragScrollRegion(e){const t=Cn.a.getObject(e,"dsa");null!=t&&this._dragInputManager.unregisterDragAdapter(e,t)}constructor(e){this._dragInputManager=e}}(0,a.a)(yn,"DragScrollManager",null,[]);var An=n(5210),bn=n(3116),Tn=n(6734),vn=n(1507);class wn{get container(){return this._container}get scroller(){return this._scroller}get scrollLeft(){return this._isScrollLeftDirty&&(this._scrollLeft=this._container.scrollLeft,this._isScrollLeftDirty=!1),this._scrollLeft}set scrollLeft(e){this._scrollLeft=e,this._container.scrollLeft=e,this._isScrollLeftDirty=!1}get scrollTop(){return this._isScrollTopDirty&&(this._scrollTop=this.convertScrollTopToDocumentSpace(this._container.scrollTop),this._isScrollTopDirty=!1),this._scrollTop}set scrollTop(e){this._scrollTop=this.convertScrollTopToControlSpace(e),this._container.scrollTop=this._scrollTop,this._futureScrollTop=-1,this._isScrollTopDirty=!1}get futureContainerWidth(){return this._reportFutureContainerWidth?this._containerOffsetWidth:this.containerClientWidth}get futureScrollTop(){return-1===this._futureScrollTop?this.scrollTop:this._futureScrollTop}get ignoreNextOnScroll(){return this._ignoreNextOnScroll}set ignoreNextOnScroll(e){this._ignoreNextOnScroll=e}get containerClientHeight(){return this._isContainerHeightDirty&&(this._containerClientHeight=this._container.clientHeight,this._isContainerHeightDirty=!1),this._containerClientHeight}get containerClientWidth(){return this._isContainerWidthDirty&&(this._containerClientWidth=this._container.clientWidth,!this._containerClientWidth||this._reportFutureContainerWidth?this._containerClientWidth=this._containerOffsetWidth:this._containerClientWidth!==this._containerOffsetWidth&&(this._isContainerWidthDirty=!1)),this._containerClientWidth}get resizingScroller(){return this._resizingScroller}get verticalScrollBarWidth(){return this.container.offsetWidth-this.container.clientWidth}get horizontalScrollBarHeight(){return this.container.offsetHeight-this.container.clientHeight}get mouseInputManager(){const{App:e}=n(6921);return e.get_activeAppFrame().theMouseInputManager}get clickInputManager(){const{App:e}=n(6921);return e.get_activeAppFrame().theClickInputManager}get dragScrollManager(){const{App:e}=n(6921);return this._dragScrollManager||(this._dragScrollManager=new yn(e.get_activeAppFrame().theDragInputManager))}get workspace(){return this._workspace||(this._workspace=ue.a.instance.resolve("WordViewer.Workspace"))}init(){}getWidth(){return this.containerClientWidth}getClientHeight(){return this.containerClientHeight}getScrollLeft(){return this.scrollLeft}getScrollTop(){return this.scrollTop}getFutureScrollTop(){return this.futureScrollTop}setIgnoreNextOnScroll(e){this.ignoreNextOnScroll=e}focus(){this._container.focus()}dispose(){this._scroller&&(this._container.removeChild(this._scroller),this._scroller=null),this.clickInputManager.unregisterHandler(yt.a.doubleClick,this._container,this.onDoubleClick),this.mouseInputManager.unregisterHandler(yt.a.mouseDown,this._container,this.onMouseDown),$e.a.removeHandler(this._container,yt.a.scroll,this.onScroll),$e.a.removeHandler(this._container,yt.a.selectStart,this.onSelectStart),this.mouseInputManager.unregisterHandler(yt.a.mouseWheel,this._container,this.onMouseWheel),this._isSmallView&&!this._newEmbedModeIsEnabled&&this._dragScrollManager&&(this._dragScrollManager.unregisterDragScrollRegion(this._container),this._dragScrollManager=null),this._container=null}scrollToPage(e){let t;e<=1?t=0:(e>this._documentDataUtils.pageCount&&(e=this._documentDataUtils.pageCount),t=this._documentDataUtils.getPageTopAtZoom(e,this._lazyZoomControl.value.currentZoom)-this._theConfig.pageGapPixels/2),this._actionManager.processActionWithData(on.a.repositionScroller,2,new vn.a(t,0))}scrollToPageOffset(e,t){const{App:a}=n(6921);if(e<1||e>a.instance.theDocument.pageCount)return 8;const i=this._lazyZoomControl.value.currentZoom,r=bn.a.instance.getPageTopAtZoom(e,i),s=bn.a.instance.getPageHeightAtZoom(e,i)*t/100;return o.AFrameworkApplication.theActionManager.processActionWithData(on.a.repositionScroller,2,new vn.a(r+s,0))}broadcastCurrentScrollPosition(){o.AFrameworkApplication.theActionManager.processActionWithData(on.a.broadcastOnScroll,2,new An.a(this.workspace.getCurrentPage(),new vn.a(this.scrollTop,this.scrollLeft),1))}setUpPinchZoom(){ue.a.instance.resolveFuture("Common.IGestureInputRegistrar").execute((e=>{e.register(this._container,this)}))}updateScrollerDimensionsForCurrentZoom(){const e=this._lazyZoomControl.value.currentZoom;this._scrollerHeight=this._documentDataUtils.totalPageGap+Math.round(this._documentDataUtils.totalPageHeight*e),this._scrollerWidth=2*this._theConfig.marginPixels+Math.round(this._documentDataUtils.maxPageWidth*e)}repositionScroller(e,t){const n=this.convertScrollTopToControlSpace(e.scrollTop),a=e.scrollLeft;if(t){this._actionManager.processAction(on.a.beforeAnimateScroll,2),this._futureScrollTop=n;const e=Tn.a.animateScroll(this._container,a,n,this.onAfterScroll).runTime;this._actionManager.processActionWithData(on.a.animateScrollStarted,2,e)}else this._container.scrollLeft=a,this._container.scrollTop=n,this._futureScrollTop=-1;isNaN(n)&&isNaN(a)||(this._isScrollTopDirty=!0)}resizeContainer(){const{App:e}=n(6921);if(!this._container)return;this._containerOffsetWidth=e.get_activeAppFrame().getDOMElement().clientWidth;let t=0,a=0;e.get_activeAppFrame().isSearchPaneVisible&&(t=this._theConfig.searchPaneWidth,this._containerOffsetWidth-=t,o.AFrameworkApplication.isRtl||(a=t));let i=0;e.get_activeAppFrame().isCommentPaneVisible&&(i=this._theConfig.commentPaneWidth,this._containerOffsetWidth-=i,o.AFrameworkApplication.isRtl&&(a=i)),this._containerOffsetWidth=this._containerOffsetWidth<0?0:this._containerOffsetWidth,this._isSmallView&&!this._newEmbedModeIsEnabled&&(this._containerOffsetWidth+=this.verticalScrollBarWidth),this._reportFutureContainerWidth=!0,Tn.a.resizeContainerAnimation(this._container,a,this._containerOffsetWidth,this.onAfterResizeContainer),this._containerOffsetWidth-=this.verticalScrollBarWidth,this._isSmallView&&!this._newEmbedModeIsEnabled&&(this._container.style.height=this._container.offsetHeight+this.horizontalScrollBarHeight+"px",this._containerOffsetWidth-=this.verticalScrollBarWidth),this._isContainerHeightDirty=!0,this._isContainerWidthDirty=!0}onAfterResizeAction(){if(S.a.isIPad&&o.AFrameworkApplication.isRtl){0;const e=this._container.scrollWidth>this._container.offsetWidth?"auto":"touch";this._container.style.webkitOverflowScrolling=e}}convertScrollTopToControlSpace(e){return e}convertScrollTopToDocumentSpace(e){return e}constructor(e,t,a,i,r,s){this._containerOffsetWidth=0,this._reportFutureContainerWidth=!1,this._containerClientWidth=0,this._isContainerWidthDirty=!0,this._containerClientHeight=0,this._isContainerHeightDirty=!0,this._scrollLeft=0,this._isScrollLeftDirty=!1,this._resizingScroller=!1,this._scrollTop=0,this._isScrollTopDirty=!1,this._futureScrollTop=-1,this._ignoreNextOnScroll=!1,this._dragScrollManager=null,this._workspace=null,this.onMouseWheel=e=>{if(e.ctrlKey)return!1;const t=3*e.wheelData*this._theConfig.autoScrollAmount;for(let e=0;e<2;e++)this._actionManager.processActionWithData(on.a.repositionScrollerWithoutAnimation,2,new vn.a(Math.round(this.scrollTop+t),this._scrollLeft));return!0},this.resizeScroller=(e,t,n,a,i)=>(this._resizingScroller=!0,this.updateScrollerDimensionsForCurrentZoom(),Tn.a.animateSize(this._scroller,this._scrollerHeight,this._scrollerWidth,this.onAfterResizeScroller),this._isContainerHeightDirty=!0,32),this.onAfterResizeScroller=e=>{this._resizingScroller=!1,this._actionManager.processAction(on.a.resizeCache,2),this.onAfterResizeAction()},this.resizeScrollerWithoutAnimation=(e,t,n,a,i)=>(this.updateScrollerDimensionsForCurrentZoom(),Sn.a.setElementStyleWidthInPixels(this._scroller,this._scrollerWidth),Sn.a.setElementStyleHeightInPixels(this._scroller,this._scrollerHeight),this._isContainerHeightDirty=!0,32),this.onScroll=e=>{this._ignoreNextOnScroll?this._ignoreNextOnScroll=!1:(this._scrollTop=this.convertScrollTopToDocumentSpace(this._container.scrollTop),this._scrollLeft=this._container.scrollLeft,this._isScrollTopDirty=!1,this._containerClientWidth<this._scrollerWidth&&(this._isScrollLeftDirty=!0),this._actionManager.processActionWithData(on.a.onScroll,2,new vn.a(this._scrollTop,this._scrollLeft)))},this.repositionScrollerWithAnimation=(e,t,n,a,i)=>(this.repositionScroller(i,!0),32),this.repositionScrollerWithoutAnimation=(e,t,n,a,i)=>(this.repositionScroller(i,!1),32),this.onAfterScroll=e=>{this._appSettingsManager.getBooleanAppSetting("BroadcastMode")&&this.broadcastCurrentScrollPosition()},this.onDoubleClick=e=>(this._actionManager.processAction(on.a.zoomToNextLevel,2),!0),this.onMouseDown=e=>(b.FocusManager.usable()&&this._focusManager.setScope(At.a.documentFocusID),e.innerEvent.preventDefault(),!1),this.windowResize=()=>{this.resizeContainer(),this._actionManager.processAction(on.a.onContainerResizeForSelection,2),this._actionManager.processAction(on.a.updateZoomOnWindowResize,2)},this.onAfterResizeContainer=e=>{this._isContainerHeightDirty=!0,this._isContainerWidthDirty=!0,this._reportFutureContainerWidth=!1,this.onAfterResizeAction()},this.onSelectStart=e=>{e.stopPropagation(),e.preventDefault()},this.scrollDownArrow=(e,t,n,a,i)=>(this._scrollTop=this._scrollTop+this._theConfig.keyboardArrowScrollAmount,this._scrollTop=Math.min(this._scrollTop,this._scrollerHeight-this.containerClientHeight),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32),this.scrollUpArrow=(e,t,n,a,i)=>(this._scrollTop=this._scrollTop-this._theConfig.keyboardArrowScrollAmount,this._scrollTop=Math.max(this._scrollTop,0),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32),this.scrollRightArrow=(e,t,n,a,i)=>(this._scrollLeft=this._scrollLeft+this._theConfig.keyboardArrowScrollAmount,this._scrollLeft=Math.min(this._scrollLeft,this._scrollerWidth-this.containerClientWidth),this._isScrollLeftDirty=!1,this._container.scrollLeft=this._scrollLeft,32),this.scrollLeftArrow=(e,t,n,a,i)=>(this._scrollLeft=this._scrollLeft-this._theConfig.keyboardArrowScrollAmount,this._scrollLeft=Math.max(this._scrollLeft,0),this._isScrollLeftDirty=!1,this._container.scrollLeft=this._scrollLeft,32),this.scrollPageDown=(e,t,n,a,i)=>this._lazyZoomControl.value.isFitPage?(this._actionManager.processAction(on.a.nextPage,2),32):(this._scrollTop=this._scrollTop+this.containerClientHeight-this._theConfig.pageGapPixels,this._scrollTop=Math.min(this._scrollTop,this._scrollerHeight-this.containerClientHeight),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32),this.scrollPageUp=(e,t,n,a,i)=>this._lazyZoomControl.value.isFitPage?(this._actionManager.processAction(on.a.prevPage,2),32):(this._scrollTop=this._scrollTop-this.containerClientHeight-this._theConfig.pageGapPixels,this._scrollTop=Math.max(this._scrollTop,0),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32),this.scrollHome=(e,t,n,a,i)=>(this._scrollTop=0,this._container.scrollTop=0,this._isScrollTopDirty=!1,32),this.scrollEnd=(e,t,n,a,i)=>(this._scrollTop=this._scrollerHeight-this.containerClientHeight,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),this._isScrollTopDirty=!1,32);const{App:l}=n(6921);this._appSettingsManager=e,this._actionManager=t,this._focusManager=a,this._documentDataUtils=i,this._lazyZoomControl=r,this._theConfig=s,l.get_activeAppFrame().add_onResize(this.windowResize),this._container=document.createElement("div"),this._container.id="WACContainer",this._container.className="WACContainer",this._scroller=document.createElement("div"),this._scroller.id="WACScroller",this._scroller.className="WACScroller",this._scrollerHeight=this._documentDataUtils.totalPageGap+this._documentDataUtils.totalPageHeight,this._scrollerWidth=2*this._theConfig.marginPixels+this._documentDataUtils.maxPageWidth,this._scroller.style.height=this._scrollerHeight+"px",this._scroller.style.width=this._scrollerWidth+"px",this._container.appendChild(this._scroller),this.setUpPinchZoom(),S.a.isIPad&&!o.AFrameworkApplication.isEmbedded&&window.setTimeout((()=>{Sys.UI.DomElement.addCssClass(this._container,"webkitTouchScrolling")}),0),this._newEmbedModeIsEnabled=this._appSettingsManager.getBooleanAppSetting("NewEmbedModeIsEnabled"),this._isSmallView=this._appSettingsManager.getBooleanAppSetting("IsSmallView"),this._isSmallView&&!this._newEmbedModeIsEnabled&&(this.clickInputManager.registerHandler(yt.a.doubleClick,this._container,this.onDoubleClick),this.mouseInputManager.registerHandler(yt.a.mouseDown,this._container,this.onMouseDown,null)),Sys.UI.DomElement.addCssClass(this._container,o.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),$e.a.addHandler(this._container,yt.a.scroll,this.onScroll),$e.a.addHandler(this._container,yt.a.selectStart,this.onSelectStart),this._isSmallView&&!this._newEmbedModeIsEnabled&&this.dragScrollManager.registerDragScrollRegion(this._container),this.mouseInputManager.registerHandler(yt.a.mouseWheel,this._container,this.onMouseWheel,null),this._actionManager.addAction(on.a.scrollDownArrow,hn.a.application,this.scrollDownArrow),this._actionManager.addAction(on.a.scrollUpArrow,hn.a.application,this.scrollUpArrow),this._actionManager.addAction(on.a.scrollRightArrow,hn.a.application,this.scrollRightArrow),this._actionManager.addAction(on.a.scrollLeftArrow,hn.a.application,this.scrollLeftArrow),this._actionManager.addAction(on.a.scrollPageDown,hn.a.application,this.scrollPageDown),this._actionManager.addAction(on.a.scrollPageUp,hn.a.application,this.scrollPageUp),this._actionManager.addAction(on.a.scrollHome,hn.a.application,this.scrollHome),this._actionManager.addAction(on.a.scrollEnd,hn.a.application,this.scrollEnd),this._actionManager.addActionWithFlags(on.a.resizeScroller,hn.a.application,this.resizeScroller,96),this._actionManager.addActionWithFlags(on.a.resizeScrollerWithoutAnimation,hn.a.application,this.resizeScrollerWithoutAnimation,96),this._actionManager.addActionWithFlags(on.a.repositionScroller,hn.a.application,this.repositionScrollerWithAnimation,97),this._actionManager.addActionWithFlags(on.a.repositionScrollerWithoutAnimation,hn.a.application,this.repositionScrollerWithoutAnimation,97);const c=this._focusManager.getScope(At.a.documentFocusID);c.bindAction(T.a.hashKey(gn.a.vK_DownArrow,0),on.a.scrollDownArrow),c.bindAction(T.a.hashKey(gn.a.vK_UpArrow,0),on.a.scrollUpArrow),c.bindAction(T.a.hashKey(gn.a.vK_RightArrow,0),on.a.scrollRightArrow),c.bindAction(T.a.hashKey(gn.a.vK_LeftArrow,0),on.a.scrollLeftArrow),c.bindAction(T.a.hashKey(gn.a.vK_PageDown,0),on.a.scrollPageDown),c.bindAction(T.a.hashKey(gn.a.vK_PageUp,0),on.a.scrollPageUp),c.bindAction(T.a.hashKey(gn.a.vK_Home,0),on.a.scrollHome),c.bindAction(T.a.hashKey(gn.a.vK_End,0),on.a.scrollEnd),c.bindAction(T.a.hashKey(gn.a.vK_Home,2),on.a.scrollHome),c.bindAction(T.a.hashKey(gn.a.vK_End,2),on.a.scrollEnd),c.bindAction(T.a.hashKey(gn.a.vK_Space,0),on.a.scrollPageDown),c.bindAction(T.a.hashKey(gn.a.vK_Space,4),on.a.scrollPageUp)}}(0,a.a)(wn,"ScrollControl",null,[16,11,17]);var Fn=n(1091),In=n(1057),En=n(9611);class Mn{registerActions(){this._appSettingsManager.getBooleanAppSetting("ZoomPopupDialogIsEnabled")&&(this._actionManager.addActionWithFlags(Zt.a.showZoomDialog,En.a.frame,(0,i.a)(this._zoomManager,this._zoomManager.showZoomDialog,"showZoomDialog"),65536),this._actionManager.addActionWithFlags(Zt.a.queryZoomText,En.a.frame,(0,i.a)(this._zoomManager,this._zoomManager.onQueryZoomText,"onQueryZoomText"),65632),this._actionManager.addActionWithFlags(Zt.a.zoomDialogFocusForward,En.a.frame,(0,i.a)(this._zoomManager,this._zoomManager.zoomDialogTabFocusHandler,"zoomDialogTabFocusHandler"),65536),this._actionManager.addActionWithFlags(Zt.a.zoomDialogFocusBackward,En.a.frame,(0,i.a)(this._zoomManager,this._zoomManager.zoomDialogTabFocusHandler,"zoomDialogTabFocusHandler"),65536)),this._appSettingsManager.getBooleanAppSetting("ZoomSliderIsEnabled")&&(this._actionManager.addActionWithFlags(Zt.a.queryZoomPercentage,En.a.frame,(0,i.a)(this._zoomManager,this._zoomManager.onQueryZoomPercentage,"onQueryZoomPercentage"),65632),this._actionManager.addActionWithFlags(Zt.a.zoomToPercentage,En.a.frame,(0,i.a)(this._zoomManager,this._zoomManager.onZoomToPercentage,"onZoomToPercentage"),65632),this._actionManager.addActionWithFlags(Zt.a.zoomToPercentageCompleted,En.a.frame,In.ActionManager.doNothingButReportHandler,65536))}constructor(e,t,n){this._actionManager=e,this._zoomManager=t,this._appSettingsManager=n}}(0,a.a)(Mn,"CommonZoomActor",null,[197]);class kn{constructor(e,t){this.zoom=e,this.allowScrollUpdate=t}}(0,a.a)(kn,"SetCustomZoomArgs",null,[]);var Pn=n(9123),Dn=n(8103);const Rn="ZoomChanged";class xn{get currentZoom(){return this._currentZoom}set_currentZoom(e){return this._currentZoom=e,e}get currentZoomOnUI(){return Math.round(100*this.currentZoom)}get nextValueIncreaseZoom(){return Math.floor(this.currentZoomOnUI/10)/10+this.delta}get nextValueDecreaseZoom(){return Math.ceil(this.currentZoomOnUI/10)/10-this.delta}get _actionManager(){return o.AFrameworkApplication.theActionManager}add_zoomChanged(e){this.eventSource.addHandler(Rn,e)}remove_zoomChanged(e){this.eventSource.removeHandler(Rn,e)}registerZoomChangedEvent(e){this.add_zoomChanged(e)}removeZoomChangedEvent(e){this.remove_zoomChanged(e)}registerPinchStartEvent(e){}removePinchStartEvent(e){}registerPinchEndEvent(e){}removePinchEndEvent(e){}zoomElement(e){this.zoomElementTo(e,this.currentZoom)}zoomElementTo(e,t){null!==e&&Pn.a.setScale(e,t)}setZoom(e,t=!0){const n=100*e;let a=n;this.appSettingsManager&&this.appSettingsManager.getBooleanAppSetting("DoNotAutoScrollAfterPinchIsEnabled")&&(a=new kn(n,t)),this.setCustomZoom(0,null,2,null,a)}setZoomDuringResize(e,t=!1){const n=3|(t?0:4);this.updateZoom(e,n)}isInScope(e){return!0}onZoomChange(e,t,n,a,i,o=0){if(1===n)return this.isReadyForRibbon()?32:8;let r=i/100;return r<this.minimumZoom?r=this.minimumZoom:r>this.maximumZoom&&(r=this.maximumZoom),this.onZoomChangeCustomAction(r),this.updateZoom(r,o),a&&(a.dataValue1=Math.floor(100*r)),32}onQueryZoomLevel(e,t,n,a,i){return 1===n||(i.value=Math.floor(100*this.currentZoom)),32}onQueryZoomText(e,t,n,a,i){if(1===n)return 32;const r=i;let s="";return s=ye.a.formatNumberToString(this.currentZoomOnUI,6,o.AFrameworkApplication.numberFormat),r.Value=s,r.LabelText=s,32}onZoomToPercentage(e,t,n,a,i){return 1===n?this.isReadyForRibbon()?32:8:this.onZoomChange(e,t,n,a,i.value,1)}onQueryZoomPercentage(e,t,n,a,i){const o=i;return o.MinValue=100*this.minimumZoom,o.MaxValue=100*this.maximumZoom,o.value=this.currentZoomOnUI,32}onZoomChangeCustomAction(e){}isReadyForRibbon(){return!0}getZoomDialogOptionList(){return this.defaultDialogOptions}getZoomDialogValueList(){return this.defaultDialogValues}getCurrentZoomValueBasedOnZoomStatus(){let e=Math.floor(100*this.currentZoom).toString();return 1===this.currentZoomStatus?e=xn.dialogResult_FullPage:2===this.currentZoomStatus&&(e=xn.dialogResult_PageWidth),e}increaseZoom(e,t,n,a,i){return 1===n||(this.logUpdateZoomEvents(this.actionManager?this.actionManager.commandLocation:0,"IncreaseZoom"),this.currentZoomStatus=0,this.updateZoom(this.nextValueIncreaseZoom)),32}decreaseZoom(e,t,n,a,i){return 1===n||(this.logUpdateZoomEvents(this.actionManager?this.actionManager.commandLocation:0,"DecreaseZoom"),this.currentZoomStatus=0,this.updateZoom(this.nextValueDecreaseZoom)),32}setZoomLevelFromRibbon(e,t,n,a,i){if(1===n)return 32;this.logUpdateZoomEvents(this.actionManager?this.actionManager.commandLocation:0,"SetZoomLevelFromRibbon");const o=i.IsFreeForm,r=o?i.Value:i.CommandValueId,s=!isNaN(parseInt(r));if(o&&!s)return 2;if(r.toLowerCase().startsWith("fit")){const e=new se.a(0,1,0,(e=>{this.zoomToPageWidth(0,null,2,null,null)}),138,void 0,!0);return ke.TaskManager.instance.addTask(e),32}const l=parseInt(r)/100;return isNaN(l)?2:(this.currentZoomStatus=0,this.updateZoom(l),32)}logUpdateZoomEvents(e,t){k.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",e,t,o.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled)}showZoomDialog(e,t,n,a,i){return 1===n||(k.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog"),this.showDialog()),32}showDialog(){const e=this.getCurrentZoomValueBasedOnZoomStatus();this._dialog=this._dialogFactoryCallback().create(this.getZoomDialogOptionList(),this.getZoomDialogValueList(),(0,i.a)(this,this.handleZoomDialogResult,"handleZoomDialogResult"),b.FocusManager.instance(),!0),this._dialog.showZoomDialog((0,Dn.a)("ZoomDialogTitle"),e)}isDialogResultFullPage(e){return e.toLowerCase()===xn.dialogResult_FullPage.toLowerCase()}isDialogResultPageWidth(e){return e.toLowerCase()===xn.dialogResult_PageWidth.toLowerCase()}handleZoomDialogResult(e){let t=8;if(e){if(this.isDialogResultFullPage(e))this.currentZoomStatus=1,t=this.zoomToFit(0,null,2,null,null);else if(this.isDialogResultPageWidth(e))this.currentZoomStatus=2,t=this.zoomToPageWidth(0,null,2,null,null);else{const n=Number.parseInvariant(e);if(n){this.currentZoomStatus=0;let e=n;this.appSettingsManager&&this.appSettingsManager.getBooleanAppSetting("DoNotAutoScrollAfterPinchIsEnabled")&&(e=new kn(n,!0)),t=this.setCustomZoom(0,null,2,null,e)}else t=8}32===t?k.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{DialogResult:e}):k.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{DialogResult:e})}else k.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{DialogResult:e})}raiseZoomChangedEvent(){this.eventSource.raiseEvent(Rn,null)}raisePinchStartEvent(){}raisePinchEndEvent(){}zoomDialogTabFocusHandler(e,t,n,a,i){if(!this._dialog)return 2;const o=this._dialog.focusManager.getCurrentRegion().listing.currentElement;if(o===this._dialog._btnCancel&&e===Zt.a.zoomDialogFocusForward||o===this._dialog._btnAction&&e===Zt.a.zoomDialogFocusBackward)this._dialog.activeSelection||this._dialog.selectFirstZoomOption(),this._dialog.focusManager.getCurrentRegion().listing.trySetCurrentElement(this._dialog.activeSelection);else if(o.id.startsWith(this._dialog.radioboxPrefix)||o.className.startsWith(this._dialog.radioRowClassName)){let t=null;e===Zt.a.zoomDialogFocusForward?t=this._dialog._btnAction:e===Zt.a.zoomDialogFocusBackward&&(t=this._dialog._btnCancel),this._dialog.focusManager.getCurrentRegion().listing.trySetCurrentElement(t),Sys.UI.DomElement.removeCssClass(this._dialog.activeSelection.parentNode,this._dialog.radioRowHighlightClassName)}else if(e===Zt.a.zoomDialogFocusForward)this._dialog.focusManager.getCurrentRegion().moveForward();else{if(e!==Zt.a.zoomDialogFocusBackward)return 2;this._dialog.focusManager.getCurrentRegion().moveBackward()}return 32}constructor(e,t,n){this.defaultDialogOptions=[(0,Dn.a)("FullPage"),(0,Dn.a)("PageWidth"),"200%","150%","100%","75%","50%"],this.defaultDialogValues=[xn.dialogResult_FullPage,xn.dialogResult_PageWidth,"200","150","100","75","50"],this.currentZoomStatus=3,this._currentZoom=0,this.delta=.1,this.leftPageMargin=0,this.eventSource=new rt.a,this._dialog=null,this.appSettingsManager=e,this.actionManager=t,this._dialogFactoryCallback=n,this.set_currentZoom(1)}}xn.dialogResult_FullPage="FullPage",xn.dialogResult_PageWidth="PageWidth",(0,a.a)(xn,"ZoomManager",null,[19]);var Ln,Un=n(9224);!function(e){e[e.manual=0]="manual",e[e.fitToFullPage=1]="fitToFullPage",e[e.fitWidth=2]="fitWidth",e[e.onBoot=3]="onBoot"}(Ln||(Ln={})),(0,a.b)("ZoomFlag",Ln);class On extends xn{get isFitPage(){return 1===this._zoomFlag}get appName(){return"WordViewer"}get maximumZoom(){return this._app.theConfig.maximumZoom}get minimumZoom(){return this._app.theConfig.minimumZoom}get zoomLabelTextDictionaryKey(){return Fn.a.LabelText}get scrollControl(){return this._scrollControl||(this._scrollControl=ue.a.instance.resolve("WordViewer.Controls.IScrollControl"))}dispose(){}fitPage(e){if(e){const e=n(6921).App.get_activeAppFrame().workspace.getHeight(),t=this.scrollControl.getWidth();this.onFitPage(t,e)}else this.onFitWidth(this.scrollControl.getWidth())}onZoomChangeCustomAction(e){this._isThroughZoomDialog?k.ULS.sendTraceTag(7410947,353,50,"Word Viewer - Zoom to custom value through new dialog: {0}",e):k.ULS.sendTraceTag(7410948,353,50,"Word Viewer - Zoom to custom value through old menu : {0}",e),this._zoomFlag=0,super.onZoomChangeCustomAction(e)}isReadyForRibbon(){const{App:e}=n(6921);return e.isReadyForRibbon()}zoomOnFitPage(e,t){const{App:a}=n(6921),{App:i}=n(6921);let o;t-=this._app.theConfig.pageGapPixels,o=a.get_activeAppFrame()?this._documentDataUtils.getPageHeightAtZoom(i.get_activeAppFrame().workspace.getCurrentPage(),1):this._documentDataUtils.getPageHeightAtZoom(1,1);const r=t/o;e-=2*this._app.theConfig.marginPixels;const s=this._documentDataUtils.getPageWidthAtZoom(n(6921).App.get_activeAppFrame().workspace.getCurrentPage(),1),l=e/s;let c;return r>l?(c=r,s*c>e&&(c/=s*c/e)):(c=l,o*c>t&&(c/=o*c/t)),c}onFitPage(e,t){this._zoomFlag=1,this.updateZoom(this.zoomOnFitPage(e,t))}zoomOnFitWidth(e){e-=2*this._app.theConfig.marginPixels;const t=n(6921).App.get_activeAppFrame().workspace.getCurrentPage();return e/this._documentDataUtils.getPageWidthAtZoom(t,1)}onFitWidth(e){this._zoomFlag=2,this.updateZoom(this.zoomOnFitWidth(e))}updateZoom(e,t=0){const{App:a}=n(6921),{App:i}=n(6921);e<this._app.theConfig.minimumZoom?e=this._app.theConfig.minimumZoom:e>this._app.theConfig.maximumZoom&&(e=this._app.theConfig.maximumZoom);const o=!(2&t),r=o?this.repositionScrollbars(this.currentZoom,e):null,s=!!(1&t);!s&&this._isInitZoomLogged&&this.currentZoom!==e&&k.ULS.sendTraceTag(25236179,353,50,'{{"ZoomedThroughViewer":1 , "OldViewerZoom":{0}, "NewViewerZoom":{1}, "ZoomFlag":{2}}}',this.currentZoom,e,Ln[this._zoomFlag]),this._isInitZoomLogged||(k.ULS.sendTraceTag(25236180,353,50,'Zoom properties on boot. {{"ZoomFlag":{0},"ZoomLevel":{1}}}',Ln[this._zoomFlag],e),this._isInitZoomLogged=!0);const l=this.currentZoom;this.set_currentZoom(e);const c=o?on.a.resizeScroller:on.a.resizeScrollerWithoutAnimation,d=o?on.a.resizeCache:on.a.resizeCacheWithoutAnimation,u=o?on.a.rebuildCommentHints:on.a.rebuildCommentHintsWithoutAnimation;if(this.actionManager.processAction(c,2),this.actionManager.processAction(d,2),o&&this.actionManager.processActionWithData(on.a.repositionScroller,2,new vn.a(r[0],r[1])),this.actionManager.processAction(on.a.updateSelection,2),this.actionManager.processAction(u,2),this.actionManager.processAction(on.a.updateSearchHighlight,2),this.actionManager.processAction(on.a.onContainerResizeForSelection,2),!s&&this.currentZoom!==l){const e={newLevel:this.currentZoom,oldLevel:l};this.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this._lazyPostMessenger.value.sendMessageWithRetry("ZoomChanged",e):this._lazyPostMessenger.value.sendMessage("ZoomChanged",e)}return!(4&t)&&a.get_activeAppFrame().statusBarUser&&i.get_activeAppFrame().statusBarUser.pollZoomControl(),!0}setMaximumZoom(e){this._app.theConfig.minimumZoom<=e&&(this._app.theConfig.maximumZoom=e,this.updateZoom(this.currentZoom))}setMinimumZoom(e){e<=0||e<=this._app.theConfig.maximumZoom&&(this._app.theConfig.minimumZoom=e,this.updateZoom(this.currentZoom))}repositionScrollbars(e,t){const{App:a}=n(6921),i=n(6921).App.get_activeAppFrame().workspace.getCurrentPage(),o=t/e,r=[];if(a.get_activeAppFrame()){const n=this.scrollControl.getScrollTop(),a=this.scrollControl.getScrollLeft(),s=this.scrollControl.getWidth();if(n<this._app.theConfig.pageGapPixels/2)r[0]=n;else{const e=Math.round((i-.5)*this._app.theConfig.pageGapPixels);r[0]=Math.round((n-e)*o)+e}const l=this._documentDataUtils.getPageWidthAtZoom(i,t)+2*this._app.theConfig.marginPixels;if(s>l)r[1]=0;else{const t=1*a/(this._documentDataUtils.getPageWidthAtZoom(i,e)+2*this._app.theConfig.marginPixels-s);r[1]=t*(l-s)}}else r[0]=0,r[1]=0;return r}setCustomZoom(e,t,n,a,i){let o=i;if(this._useSetCustomZoomArgs){if(!(0,we.a)(kn,i))return k.ULS.sendTraceTag(51644239,353,10,"actiondata is not a SetCustomZoomArgs"),8;o=i.zoom}return this._isThroughZoomDialog=!0,this.onZoomChange(e,t,n,a,o)}zoomToFit(e,t,n,a,i){return this._isThroughZoomDialog=!0,this.onFitFullPage(e,t,n,a,i)}zoomToPageWidth(e,t,n,a,i){return this._isThroughZoomDialog=!0,this.onFitPageWidth(e,t,n,a,i)}initializeActor(){new Mn(this.actionManager,this,this.appSettingsManager).registerActions()}constructor(e,t,a,i,o,r){super(t,a,r),this._zoomFlag=3,this._isThroughZoomDialog=!1,this._isInitZoomLogged=!1,this._scrollControl=null,this.setZoomLevel=(e,t,n,a,i)=>{const o=i;if(o<this._app.theConfig.minimumZoom||o>this._app.theConfig.maximumZoom){const e={newLevel:o,maxZoom:this._app.theConfig.maximumZoom,minZoom:this._app.theConfig.minimumZoom};return k.ULS.sendTraceTag(34219330,301,10,"ZoomChangeError: "+e),this._lazyPostMessenger.value.sendError({errorType:"ZoomChangeError",errorObject:e}),16}return this._zoomFlag=0,this.updateZoom(o),32},this.updateZoomOnWindowResize=(e,t,a,i,o)=>{const{App:r}=n(6921),s=this._currentDevicePixelRatio;if(this._currentDevicePixelRatio=window.self.devicePixelRatio,this._currentDevicePixelRatio!==s&&k.ULS.sendTraceTag(25236178,353,50,'{{"ZoomedThroughBrowser":1, "OldBrowserZoom":{0}, "NewBrowserZoom":{1}}}',s,this._currentDevicePixelRatio),3===this._zoomFlag)if(this._isSmallView&&k.ULS.sendTraceTag(36226190,301,50,"{{NewEmbedModeIsEnabled: {0}}}",this._newEmbedModeIsEnabled),this._isSmallView&&!this._newEmbedModeIsEnabled)this.fitPage(!1);else{let e=1;if(r.get_activeAppFrame().workspace){const t=n(6921).App.get_activeAppFrame().workspace.getCurrentPage();e=(this.scrollControl.getWidth()-2*this._app.theConfig.marginPixels)/this._documentDataUtils.getPageWidthAtZoom(t,1)}e>1?e=1:!this._isSmallView&&e<.75?e=.75:this._isSmallView&&e<.1&&this._newEmbedModeIsEnabled&&(e=.1),this.updateZoom(e)}else this._zoomFlag?this.fitPage(1===this._zoomFlag):this.actionManager.processAction(on.a.resizeCache,2);return 32},this.onFitFullPage=(e,t,a,i,o)=>{const{App:r}=n(6921);return 1===a?r.isReadyForRibbon()?32:8:(this._isThroughZoomDialog?k.ULS.sendTraceTag(7410945,353,50,"Word Viewer - Zoom to fit page height through new dialog"):k.ULS.sendTraceTag(7410946,353,50,"Word Viewer - Zoom to fit page height through old menu"),this.fitPage(!0),32)},this.onFitPageWidth=(e,t,a,i,o)=>{const{App:r}=n(6921);return 1===a?r.isReadyForRibbon()?32:8:(this._isThroughZoomDialog?k.ULS.sendTraceTag(7410949,353,50,"Word Viewer - Zoom to fit page width through new dialog"):k.ULS.sendTraceTag(7410950,353,50,"Word Viewer - Zoom to fit page width through old menu"),this.fitPage(!1),32)},this.onNextZoomLevel=(e,t,a,i,o)=>{if(2===a){const e=n(6921).App.get_activeAppFrame().workspace.getHeight(),t=this.scrollControl.getWidth(),a=this.zoomOnFitPage(t,e),i=this.zoomOnFitWidth(t),o=[1,1.5,a,i];let r;for(o.sort(),r=0;r<o.length&&!(o[r]-this.currentZoom>=.05);r++);r%=o.length;const s=o[r];this._zoomFlag=s===a?1:s===i?2:0,this.updateZoom(s)}return 32},this.populateZoomFlyout=(e,t,n,a,i)=>{if(1===n)return 2===this._app.status?32:8;const o=[Un.f("btnZoom200",on.a.onZoomChange.toString(),200),Un.f("btnZoom150",on.a.onZoomChange.toString(),150),Un.f("btnZoom100",on.a.onZoomChange.toString(),100),Un.f("btnZoom75",on.a.onZoomChange.toString(),75),Un.f("btnZoom50",on.a.onZoomChange.toString(),50)],r=Un.c("msZoom.Controls",o),s=Un.d("msZoom",r,null),l=[Un.a("fseaFitHeight",on.a.fitHeight.toString(),WacWordviewerStringsManager.get(WacWordviewerStringsEnum.FitHeight)),Un.a("fseaFitWidth",on.a.fitWidth.toString(),WacWordviewerStringsManager.get(WacWordviewerStringsEnum.FitWidth))],c=Un.c("msZoomFit.Controls",l),d=[s,Un.d("msZoomFit",c,null)],u=Un.e(d,"menuZoom");return i.PopulationXML=u,32},this._app=e,this._lazyPostMessenger=i,this._documentDataUtils=o,this._currentDevicePixelRatio=window.self.devicePixelRatio,this._newEmbedModeIsEnabled=t.getBooleanAppSetting("NewEmbedModeIsEnabled"),this._isSmallView=t.getBooleanAppSetting("IsSmallView"),this._useSetCustomZoomArgs=t.getBooleanAppSetting("DoNotAutoScrollAfterPinchIsEnabled"),a.addActionWithFlags(on.a.onZoomChange,hn.a.application,this.onZoomChange.bind(this),8),a.addAction(on.a.fitHeight,hn.a.application,this.onFitFullPage),a.addAction(on.a.fitWidth,hn.a.application,this.onFitPageWidth),a.addActionWithFlags(on.a.queryZoomLevel,hn.a.application,this.onQueryZoomLevel.bind(this),97),a.addActionWithFlags(on.a.updateZoomOnWindowResize,hn.a.application,this.updateZoomOnWindowResize,96),a.addActionWithFlags(on.a.zoomToNextLevel,hn.a.application,this.onNextZoomLevel,96),t.getBooleanAppSetting("ZoomPopupDialogIsEnabled")||a.addActionWithFlags(on.a.queryZoomText,hn.a.application,this.onQueryZoomText.bind(this),97),a.addActionWithFlags(on.a.populateZoomFlyout,hn.a.application,this.populateZoomFlyout,96),a.addActionWithFlags(on.a.setZoomLevel,hn.a.application,this.setZoomLevel,8)}}(0,a.a)(On,"ZoomControl",xn,[18,19,11]);var Bn=n(6534),Nn=n(1307),Wn=n(734),Hn=n(668),Vn=n(9823);class Gn{constructRequestUrl(){this.url="WordViewer/Document.pdf?"+this.appSettingsManager.getBaseDocQuerySignature(),this.url=me.a.addOrReplaceParameterValue(this.url,"type",this.appSettingsManager.getBooleanAppSetting("IsSmallView")||this.appSettingsManager.getBooleanAppSetting("IsNoChrome")?"accessprintpdf":"accesspdf"),this.url=me.a.addOrReplaceParameterValue(this.url,"language",this.appSettingsManager.getStringAppSetting("TranslationLanguage")),this.url=me.a.addOrReplaceParameterValue(this.url,"DataUrlEnabled","true")}get currentPage(){return 1}get endPage(){return 1}get startPage(){return 1}get outerElementID(){return this._elementId}showErrorDialogAndLogMessage(e){k.ULS.sendTraceTag(20480267,301,10,e),Vn.a.showErrorDialog(29,CommonUiStrings.DefaultDialogTitle,CommonUiStrings.ErrorDialogMessage)}dispose(){this._disposed||(this.parent=null,this._disposed=!0)}addWaterMark(e){this.isDWInViewModeEnabled&&null!==e&&this.policyActor?.execute((t=>{t.addWatermarks([{watermarkElement:e}])}))}get isDWInViewModeEnabled(){return null!=this.__cached_isDWInViewModeEnabled_0_c44d5dcf?this.__cached_isDWInViewModeEnabled_0_c44d5dcf:this.__cached_isDWInViewModeEnabled_0_c44d5dcf=(()=>this.appSettingsManager.getBooleanAppSetting("DocumentPolicyLabelForViewer"))()}constructor(e,t,n,a){this.parent=e,this.appSettingsManager=t,this.postMessenger=n,this.policyActor=a,this._elementId="viewerContents",this.pdfElementOuterDiv=null,this._disposed=!1,this.onRequestComplete=(e,t,n)=>{const{App:a}=Vn.a.AppInstance;if(this._disposed)return void 0;if(!e){const e=String.format("The request for the PDF in accessible mode failed. HTTP Status: {0} Request Status: {1}",n.httpStatus,n.status);return this.showErrorDialogAndLogMessage(e),void Vn.a.propagateError(!0,"RequestFailed",29,e)}const i=n.responseXml;let r=null;if(i&&(r=i.selectSingleNode("/docdata")),r){const e=String.format("The request for the PDF in accessible mode never returned the PDF. HTTP Status: {0} Request Status: {1}",n.httpStatus,n.status);k.ULS.sendTraceTag(20480266,301,10,e),Vn.a.showErrorDialogFromResponseXml(i),Vn.a.propagateError(!0,"RequestFailed",29,e)}else{k.ULS.sendTraceTag(556656209,301,50,"PDF request succeeded"),a.reportFirstPageAndRenderTime(),o.AFrameworkApplication.reportDocumentLoadedTime();let e=this.url;try{const t=n.responseData,a=window.atob(t.substring(28,t.length)),i=a.length,o=new ArrayBuffer(i),r=new Uint8Array(o);for(let e=0;e<i;e++){const t=a.charCodeAt(e);r[e]=t}const s=new Blob([o],{type:"application/pdf"});e=URL.createObjectURL(s)}catch(e){return void k.ULS.sendTraceTag(570782017,301,10,"Failed to create object url for PDF blob"+e)}this.pdfElementOuterDiv=document.createElement("div"),this.pdfElementOuterDiv.id=Hn.AppFrame.pdfElementOuterDivId,this.pdfElementOuterDiv.setAttribute("tabIndex",0),this.pdfElementOuterDiv.setAttribute("style","height: 100%; width:100%");const t=document.createElement("div");t.id=this._elementId,t.setAttribute("style","height: 100%; width:100%"),this.pdfElementOuterDiv.appendChild(t),Nn.a.getReactPdfAPI().then((n=>(n.renderReactPdf(t,{pdfURL:e,isProtectedDoc:!a.instance.copyingEnabled,addWaterMark:this.addWaterMark,pdfStrings:{pageLabel:WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PageLabel)}}),document.getElementById(Hn.AppFrame.pdfElementOuterDivId).role="document",Bn.b("ReactPdfRenderedInAccessibleMode"),this.postMessenger.reportAppCompleted(),null))).catch((e=>{const t=String.format("Failed to render accessible PDF. Error: {0}",e);this.showErrorDialogAndLogMessage(t),Vn.a.propagateError(!0,"PdfRenderFailed",29,t)})).finally((()=>{o.AFrameworkApplication.dismissSplashScreen(),Ee.Health.instance.removeQosPillar(Wn.a[Wn.a.Boot]),"AppModeSwitch"===this.appSettingsManager.getStringAppSetting("SessionOrigin")&&Vn.a.triggerFloodgateSurveyForSwitchingToViewer()})),this.parent.appendChild(this.pdfElementOuterDiv)}};const{App:i}=Vn.a.AppInstance;this.constructRequestUrl(),k.ULS.sendTraceTag(20820060,301,50,"Sending request for the PDF in accessible mode.");const{url:r,headers:s}=Vn.a.getURLAndHeadersForRequest(this.url);if(jt.a.doRequestWithBodyAndHeaders(r,null,s,null,this.onRequestComplete,i.get_activeAppFrame().notificationBar,!1))k.ULS.sendTraceTag(556828826,301,50,"We sent the request for the PDF in accessible mode");else{let e="We failed to send the request for the PDF in accessible mode.";this.showErrorDialogAndLogMessage(e),Bn.b("WordViewerPdfFailures",void 0,void 0,[{name:"FailureType",string:"PdfRequestFailed"}]),e+=String.format(" URL: {0}",this.url),Vn.a.propagateError(!0,"RequestFailed",29,e)}}}(0,a.a)(Gn,"DisplayManagerPdf",null,[189,11]);class Qn{static createElement(e,t){return e.createElement(t.toString())}static createElementNS(e,t,n){return e.createElementNS(t,n.toString())}}(0,a.a)(Qn,"DOMDocumentExtension",null,[]);class qn{toString(){return this._tagName}constructor(e){this._tagName=e}}qn.a=new qn("a"),qn.br=new qn("br"),qn.button=new qn("button"),qn.col=new qn("col"),qn.colgroup=new qn("colgroup"),qn.div=new qn("div"),qn.img=new qn("img"),qn.li=new qn("li"),qn.ol=new qn("ol"),qn.p=new qn("p"),qn.path=new qn("path"),qn.span=new qn("span"),qn.svg=new qn("svg"),qn.table=new qn("table"),qn.tbody=new qn("tbody"),qn.td=new qn("td"),qn.tr=new qn("tr"),qn.ul=new qn("ul"),qn.th=new qn("th"),(0,a.a)(qn,"DomTagName",null,[]);const Kn=(e,t,n,a,i)=>{const o=["FShadowLeftInner","FShadowLeftOuter","FShadowTopLeftInner","FShadowTopLeftOuter","FShadowTopInner","FShadowTopOuter","FShadowTopRightInner","FShadowTopRightOuter","FShadowRightInner","FShadowRightOuter","FShadowBottomRightInner","FShadowBottomRightOuter","FShadowBottomInner","FShadowBottomOuter","FShadowBottomLeftInner","FShadowBottomLeftOuter"],r=[t,t,t&&n,t&&n,n,n,n&&a,n&&a,a,a,a&&i,a&&i,i,i,i&&t,i&&t];const s=Qn.createElement(e,qn.div);s.className="WACPageBorder";for(let t=0;t<o.length;t++)if(r[t]){const n=Qn.createElement(e,qn.div);n.className=o[t],s.appendChild(n)}return s};var zn=n(1591),jn=n(5562),Zn=n(9207);class Xn{dispose(){this.pageImage=null,this.waitImage=null}constructor(){this.pageImage=null,this.waitImage=null}}(0,a.a)(Xn,"ImageSet",null,[11]);class Jn{setupActions(){this.actionManager.addActionWithFlags(on.a.onScroll,hn.a.application,this.onScroll,96),this.actionManager.addActionWithFlags(on.a.resizeCache,hn.a.application,this.resizeCache,96),this.actionManager.addActionWithFlags(on.a.resizeCacheWithoutAnimation,hn.a.application,this.resizeCacheWithoutAnimation,96),this.actionManager.addActionWithFlags(on.a.setCurrentPage,hn.a.application,this.setCurrentPage,8)}get currentPage(){return this._currentPage}get endPage(){return this._startPage+this._cachePageCount-1}get startPage(){return this._startPage}get outerElementID(){return this._elementId}get zoomControl(){return this.lazyZoomControl.value}get scrollControl(){return this.lazyScrollControl.value}calculatePageCount(){const e=this.zoomControl.currentZoom,t=Vn.a.AppInstance.App.get_activeAppFrame().workspace,n=Math.ceil(t.getHeight()/(this.documentDataUtils.minPageHeight*e));return 1+this.theConfig.pagesToCacheBefore+this.theConfig.pagesToCacheAfter+n}resizeCacheInternal(e,t){const{App:n}=Vn.a.AppInstance;if(this.scrollControl.resizingScroller)return this.updateImages(this._startPage,t),32;const a=this._startPage,i=this._cachePageCount,o=this.zoomControl.currentZoom;let r;r=n.get_activeAppFrame()?this.scrollControl.getFutureScrollTop():0;const s=this.documentDataUtils.getPageFromScrollTop(r,o),l=Math.min(this.calculatePageCount(),this.documentDataUtils.pageCount);if(l!==this._cachePageCount){let e=Math.max(1,s-this.theConfig.pagesToCacheBefore);e=Math.min(e,1+this.documentDataUtils.pageCount-l);const t=e+l,n=this._startPage+this._cachePageCount;this._startPage<e&&this.removeImages(this._startPage,Math.min(e,n)),t<n&&this.removeImages(Math.max(t,this._startPage),n),e<this._startPage&&this.addImages(e,Math.min(t,this._startPage)),n<t&&this.addImages(Math.max(n,e),t),this._startPage=e,this._cachePageCount=l}s!==this._currentPage&&(this._oldPage=this._currentPage,this._currentPage=s,this.callSetPage()),this.updateImages(this._startPage,t);const c=Vn.a.AppInstance.App.get_activeAppFrame().thePageInfoCache;return c&&e!==In.ActionManager.nullAction&&c.removeFromCache(a,a+i-1),32}addImages(e,t){const n=t-e,a=this._startPage<e?this._images.length:0,i=S.a.supportsPerformanceNow?performance.now():Date.now();for(let t=0;t<n;t++){const n=Kn(this.parent.ownerDocument,!0,!0,!0,!0);this.parent.appendChild(n);const i=document.createElement("img");i.id="i"+(e+t),i.className="WACPageImg",i.alt=String.format(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PageAltText),e+t),i.style.display="inline",i.style.visibility="hidden",this.isDWInViewModeEnabled&&(this.isDWEnabledEmbedDoc()?zn.a.getAppChrome(!1).then((()=>{this.addWaterMarkApi(n)})):this.appSettingsManager.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_9599956_DWFixCrossTenant")?s.a.get_instance().executeWhen(7,(()=>this.addWaterMarkApi(n))):this.addWaterMarkApi(n)),n.appendChild(i);const o=Jn.createWaitElement(e+t,this.parent);this.parent.appendChild(o);const r=new Xn;r.pageImage=i,r.waitImage=o,Array.insert(this._images,t+a,r)}le.a.instance.addMetric(de.a.ppApendingImageTagsDuration,(S.a.supportsPerformanceNow?performance.now():Date.now())-i)}addWaterMarkApi(e){this.policyActor.execute((t=>{t.addWatermarks([{watermarkElement:e,zIndex:10}])}))}isDWEnabledEmbedDoc(){return this.appSettingsManager.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8845728_DWInEmbedView")&&this.appSettingsManager.getStringAppSetting("DynamicWatermarkingText")?.length>0&&ni.get_activeAppFrame().wordViewerApp.isSmallView}removeImages(e,t){for(let n=e;n<t;n++){let e=0;for(let t=0;t<this._images.length;t++){if(this._images[t].pageImage.id.substr(1)===n.toString()){e=t;break}}const t=this._images[e];Array.removeAt(this._images,e),this.isDWInViewModeEnabled&&this.policyActor.execute((e=>{e.removeWatermarks([{watermarkElement:t.pageImage.parentNode}])})),this.parent.removeChild(t.pageImage.parentNode),this.parent.removeChild(t.waitImage)}}updateImages(e,t){const{App:n}=Vn.a.AppInstance;if(this._startPage===e&&1===this._startPage)for(let n=0;n<this._cachePageCount;n++)this.swapImages(e+n,n,0,t);else if(this._startPage===e||this._startPage+this._cachePageCount-1<e||e+this._cachePageCount-1<this._startPage){for(let n=this.theConfig.pagesToCacheBefore;n<this._cachePageCount;n++)this.swapImages(e+n,n,0,t);for(let n=this.theConfig.pagesToCacheBefore-1;0<=n;n--)this.swapImages(e+n,n,0,t)}else if(e<this._startPage){for(let n=this._startPage-e-1;n>=0;n--)this.swapImages(e+n,Number.NaN,1,t)}else{const n=e-this._startPage-1,a=e+this._cachePageCount-1;for(let e=n;e>=0;e--)this.swapImages(a-e,Number.NaN,2,t)}const a=Vn.a.AppInstance.App.get_activeAppFrame().thePageInfoCache,i=e+this._cachePageCount-1;a&&a.addToCache(e,i),n.get_activeAppFrame().workspace.pageCacheChanged(e,i)}swapImages(e,t,n,a){let i;if(n){const e=1===n?this._images.length-1:0,t=1===n?0:this._images.length-1;i=this._images[e],Array.removeAt(this._images,e),Array.insert(this._images,t,i)}else i=this._images[t];const r="i"+e;r!==i.pageImage.id&&(i.pageImage.id=r,i.waitImage.id="wait"+e);let s=Ft.a.urlForNamedObject("p"+e+".img",!0);if(this.appSettingsManager.getBooleanAppSetting("UpdateAccessTokenInEditedImageUrlIsEnabled")&&(me.a.getParameterValue(s,o.AFrameworkApplication.accessTokenParamName)&&(s=me.a.addOrReplaceParameterValue(s,o.AFrameworkApplication.accessTokenParamName,encodeURIComponent(o.AFrameworkApplication.accessToken))),me.a.getParameterValue(s,o.AFrameworkApplication.accessTokenTtlParamName)&&(s=this.appSettingsManager.getBooleanAppSetting("UseServerAccessTokenTTLInClientRequests")?me.a.addOrReplaceParameterValue(s,o.AFrameworkApplication.accessTokenTtlParamName,o.AFrameworkApplication.accessTokenServerExpirationTime.toString()):me.a.addOrReplaceParameterValue(s,o.AFrameworkApplication.accessTokenTtlParamName,o.AFrameworkApplication.accessTokenTtl.toString()))),this.setPagePosition(i.pageImage,e,!1,a),!i.pageImage.src.endsWith(s)){i.waitImage.style.display="inline";const{url:e,headers:t}=Vn.a.getURLAndHeadersForRequest(s);this.InitiateImageDownloadRequest(e,t,i.pageImage)}this.setPagePosition(i.waitImage,e,!0,a)}InitiateImageDownloadRequest(e,t,n){o.AFrameworkApplication.theClientRequestManager.addRequest(e,1,null,t,!0,2,this.onItemRequestSucceeded,this.onItemRequestFail,n),k.ULS.sendTraceTag(556828825,301,50,"Image download request added to the ClientRequestManager")}alignPageHorizontally(e){const t=this.zoomControl.currentZoom;return this.documentDataUtils.getPageLeftAtZoom(e,t,!1)}callSetPage(){const{App:e}=Vn.a.AppInstance,t={newPage:this._currentPage,oldPage:this._oldPage};this.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this.postMessenger.sendMessageWithRetry("PageChanged",t):this.postMessenger.sendMessage("PageChanged",t),e.get_activeAppFrame().statusBarUser&&e.get_activeAppFrame().statusBarUser.pollControl(mn.a.pageInfoLabel)}raisePageChangeError(e){const t=Vn.a.AppInstance.App.get_activeAppFrame().getTopParagraphId();t&&(e.topParagraphId=t);const n={errorType:"PageChangeError",errorObject:e};k.ULS.sendTraceTag(35149197,301,10,JSON.stringify(n)),this.postMessenger.sendError(n)}dispose(){if(!this._isDisposed){for(let e=0;e<this._images.length;e++){const t=this._images[e];$e.a.removeHandler(t.pageImage,"load",this.onPageImgLoaded),t.dispose()}this._images&&(Array.clear(this._images),this._images=null),this._isDisposed=!0,this.parent=null}}setPagePosition(e,t,n,a){const i=this.zoomControl.currentZoom,r=this.documentDataUtils.getPageTopAtZoom(t,i),s=this.documentDataUtils.getPageWidthAtZoom(t,i),l=this.documentDataUtils.getPageHeightAtZoom(t,i);if(a?Tn.a.animateSize(e,l,s):(e.style.height=l+"px",e.style.width=s+"px"),n){if(e.children.length>0){a?Tn.a.animatePosition(e,this.alignPageHorizontally(t),r):(e.style.top=r+"px",o.AFrameworkApplication.isRtl?e.style.right=this.alignPageHorizontally(t)+"px":e.style.left=this.alignPageHorizontally(t)+"px");const n=e.lastChild;n.id&&""!==n.id.trim()||(n.id="WACProgress"+n.parentNode.id),a?Tn.a.animatePosition(n,s/2,.3*l):(n.style.top=.3*l+"px",o.AFrameworkApplication.isRtl?n.style.right=s/2+"px":n.style.left=s/2+"px")}}else a?(Tn.a.animateSize(e.parentNode,l,s),Tn.a.animatePosition(e.parentNode,this.alignPageHorizontally(t),r)):(e.parentNode.style.height=l+"px",e.parentNode.style.width=s+"px",e.parentNode.style.top=r+"px",o.AFrameworkApplication.isRtl?e.parentNode.style.right=this.alignPageHorizontally(t)+"px":e.parentNode.style.left=this.alignPageHorizontally(t)+"px")}onImgLoadError(e,t=void 0){const n=parseInt(e.id.substr(1));if(!(isNaN(n)||n<1||n>this.theDocument.pageCount||(k.ULS.sendTraceTag(520402763,301,15,"Retrying request for page no {0}",n),this._retryRequest))){void 0===t&&k.ULS.sendTraceTag(557904483,301,15,"Image source is null or empty while retrying");const{url:e,headers:n}=Vn.a.getURLAndHeadersForRequest(t);this._retryRequest=new Zn.a(this.onRetrySuccessful,e,n),this._retryRequest.send()}}onImgLoaded(e){const{App:t}=Vn.a.AppInstance;if(!e)return void k.ULS.sendTraceTag(21570583,301,10,"Image element of dom event is null");if(!e.id||!e.id.substr(1))return void k.ULS.sendTraceTag(21570585,301,10,"Image element has null ID");const n=parseInt(e.id.substr(1));if(isNaN(n)||n<1||n>this.theDocument.pageCount)return void 0;this.initializeStopWatch(),this._isBootFinished||n!==t.initialPageNumber?5===n&&o.AFrameworkApplication.theWsaClient.setBool(8810,1):(this._isBootFinished=!0,t.reportFirstPageAndRenderTime(),o.AFrameworkApplication.reportDocumentLoadedTime(),re.a.mark(5039),ce.a.endRootMeasurement("Load"),this.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this.postMessenger.sendMessageWithRetry("AppState",{pageCount:this.documentDataUtils.pageCount,newPage:this.currentPage,newLevel:this.zoomControl.currentZoom}):(this.postMessenger.sendPageCountWithRetry(new jn.a("PageCount",{pageCount:this.documentDataUtils.pageCount},(e=>this.postMessenger.sendPageCountWithRetry(e)))),this.postMessenger.sendPageChangeWithRetry(new jn.a("PageChanged",{newPage:this.currentPage},(e=>this.postMessenger.sendPageChangeWithRetry(e)))),this.postMessenger.sendZoomChangeWithRetry(new jn.a("ZoomChanged",{newLevel:this.zoomControl.currentZoom},(e=>this.postMessenger.sendZoomChangeWithRetry(e))))),this.postMessenger.reportAppCompleted(),this.updateImages(this._startPage,!1),this.actionManager.processAction(on.a.documentLoadFinished,2),t.initialScrollTop&&(this.actionManager.processActionWithData(on.a.repositionScroller,2,new vn.a(t.initialScrollTop,Number.NaN)),t.initialScrollTop=0),t.hideFirstPageImage(),o.AFrameworkApplication.dismissSplashScreen(),Ee.Health.instance.removeQosPillar(Wn.a[Wn.a.Boot]),"AppModeSwitch"===this.appSettingsManager.getStringAppSetting("SessionOrigin")&&Vn.a.triggerFloodgateSurveyForSwitchingToViewer()),4===n&&this.recordInitialPagesLoadingTime(),n===this.theDocument.pageCount&&o.AFrameworkApplication.theWsaClient.setBool(8811,1),n===this._currentPage&&re.a.mark(5043),n===this.theDocument.pageCount&&re.a.mark(5041),this.setPagePosition(e,n,!1,!0),e.style.display="inline",e.style.visibility="visible";const a="wait"+n,i=document.getElementById(a);i&&(i.style.display="none")}initializeStopWatch(){this._initialPagesLoaded||null!=this._initialPageLoadStart||(this._initialPageLoadStart=S.a.supportsPerformanceNow?performance.now():Date.now())}recordInitialPagesLoadingTime(){this._initialPagesLoaded||(le.a.instance.addMetric(de.a.ppInitialPagesLoadingDuration,(S.a.supportsPerformanceNow?performance.now():Date.now())-this._initialPageLoadStart),this._initialPagesLoaded=!0)}static createWaitElement(e,t){const n=Kn(t.ownerDocument,!0,!0,!0,!0);return n.id="wait"+e.toString(),n.style.display="none",n.appendChild(Vn.a.createWaitImage()),n}get isDWInViewModeEnabled(){return null!=this.__cached_isDWInViewModeEnabled_0_5c9b8d27?this.__cached_isDWInViewModeEnabled_0_5c9b8d27:this.__cached_isDWInViewModeEnabled_0_5c9b8d27=(()=>this.appSettingsManager.getBooleanAppSetting("DocumentPolicyLabelForViewer"))()}constructor(e,t,n,a,i,r,s,l,c,d){this.parent=e,this.appSettingsManager=t,this.actionManager=n,this.postMessenger=a,this.documentDataUtils=i,this.lazyZoomControl=r,this.lazyScrollControl=s,this.policyActor=l,this.theConfig=c,this.theDocument=d,this._cachePageCount=0,this._startPage=1,this._currentPage=1,this._oldPage=1,this._isBootFinished=!1,this._isDisposed=!1,this._retryRequest=null,this._initialPageLoadStart=null,this._initialPagesLoaded=!1,this.resizeCache=(e,t,n,a,i)=>this.resizeCacheInternal(e,!0),this.resizeCacheWithoutAnimation=(e,t,n,a,i)=>this.resizeCacheInternal(e,!1),this.onItemRequestSucceeded=e=>{k.ULS.sendTraceTag(556658718,301,50,"Image download request succeeded");try{const t=e.data.state;t.src=e.data.responseData,this.onImgLoaded(t)}catch(e){k.ULS.sendTraceTag(554735714,301,10,e.message),Vn.a.showErrorDialog(1,CommonUiStrings.DefaultDialogTitle,CommonUiStrings.CannotOpenFile),Vn.a.propagateError(!1,"ImageSetFailed",1,CommonUiStrings.CannotOpenFile)}},this.onItemRequestFail=e=>{k.ULS.sendTraceTag(556658719,301,50,"Image download request failed"),this.onImgLoadError(e.data.state,e.data.request.get_url())},this.onScroll=(e,t,n,a,i)=>{const{App:o}=Vn.a.AppInstance;if(this.scrollControl.resizingScroller)return 32;const r=i,s=Math.max(0,r.scrollTop);let l=!1;if(o.get_activeAppFrame()){const e=20,t=this.documentDataUtils.getPageFromScrollTop(s+e,this.zoomControl.currentZoom);t!==this._currentPage&&(this._oldPage=this._currentPage,this._currentPage=t,l=!0)}else this._currentPage=1;let c=Math.max(1,this._currentPage-this.theConfig.pagesToCacheBefore);if(c=Math.min(c,1+this.documentDataUtils.pageCount-this._cachePageCount),c!==this._startPage){const e=Vn.a.AppInstance.App.get_activeAppFrame().thePageInfoCache;this.updateImages(c,!1);const t=this._startPage;this._startPage=c,e.removeFromCache(t,Math.min(this._startPage,t+this._cachePageCount-1)),e.removeFromCache(Math.max(this._startPage+this._cachePageCount-1,t),t+this._cachePageCount-1)}return l&&this.callSetPage(),this.appSettingsManager.getBooleanAppSetting("BroadcastMode")&&this.actionManager.processActionWithData(on.a.broadcastOnScroll,2,new An.a(this._currentPage,new vn.a(s,r.scrollLeft),0)),32},this.setCurrentPage=(e,t,n,a,i)=>{const{App:o}=Vn.a.AppInstance,r=i;if(o.get_activeAppFrame().workspace&&o.get_activeAppFrame().workspace.initialized){if(r>0&&r<=this.documentDataUtils.pageCount)return this.scrollControl.scrollToPage(r),32;this.raisePageChangeError({errorType:"InvalidPageIndex",newPage:r,pageCount:this.documentDataUtils.pageCount})}else k.ULS.sendTraceTag(35149196,301,10,"AppInitError: SetCurrentPageError"),this.postMessenger.sendError({errorType:"AppInitError",errorObject:{Message:"App was likely not fully initialized when SetCurrentPage was called"}});return 16},this.onRetrySuccessful=e=>{this._retryRequest=null,k.ULS.sendTraceTag(522302290,301,50,"Retrying request. current cache page count is {0}",this._cachePageCount);for(let e=0;e<this._cachePageCount;e++){const t=this._images[e],n=Ft.a.urlForNamedObject("p"+(e+this._startPage)+".img",!0),{url:a,headers:i}=Vn.a.getURLAndHeadersForRequest(n);o.AFrameworkApplication.theClientRequestManager.addRequest(a,1,null,i,!0,2,this.onItemRequestSucceeded,null,t.pageImage)}},this.onPageImgLoaded=e=>{e?e.rawEvent?e.rawEvent.srcElement?this.onImgLoaded(e.rawEvent.srcElement):k.ULS.sendTraceTag(21570581,301,10,"DomEvent's srcSlement is null"):k.ULS.sendTraceTag(25190429,301,10,"DomEvent's RawEvent is null"):k.ULS.sendTraceTag(21570579,301,10,"DomEvent on page image loaded is null")},this._elementId=this.parent?this.parent.id:"",this._images=[],this.setupActions()}}(0,a.a)(Jn,"DisplayManagerPng",null,[189,11]);class Yn{create(e,t){switch(e){case 0:return Bn.b("WordViewerMode",void 0,void 0,[{name:"PNG"}]),new Jn(t,this._appSettingsManager,this._actionManager,this._postMessenger,this._documentDataUtils,this._lazyZoomControl,this._lazyScrollControl,this._policyActor,this._theConfig,this._theDocument);case 1:return Bn.b("WordViewerMode",void 0,void 0,[{name:"PDF"}]),new Gn(t,this._appSettingsManager,this._postMessenger,this._policyActor);default:Bn.b("WordViewerMode",void 0,void 0,[{name:"Invalid"}])}return null}constructor(e,t,n,a,i,o,r,s,l){this._appSettingsManager=e,this._actionManager=t,this._postMessenger=n,this._documentDataUtils=a,this._lazyZoomControl=i,this._lazyScrollControl=o,this._policyActor=r,this._theConfig=s,this._theDocument=l}}(0,a.a)(Yn,"DisplayManagerFactory",null,[23]);var $n=n(8510),ea=n(4763);class ta{sendMessage(e,t){this._isJsApi&&this._hostPostmessenger.sendMessage(e,t)}sendMessageWithRetry(e,t){const n=$n.a.createRetriableMessage(e,t,o.AFrameworkApplication.userSessionId,3);this._hostPostmessenger.postMessage(n)}sendError(e){this.sendMessage("Error",e)}sendErrorWithRetry(e){this.sendMessageWithRetry("Error",e)}reportAppCompleted(e=!1){const t={},n=this._pageLoadPerfRecorder.getMetric(de.a.frameRequestStart);null!=n&&(t.officeFrameRequestStartTime=n);const a=this._pageLoadPerfRecorder.getMetric(de.a.resourceDownloadStart);null!=a&&(t.officeFrameFirstFlushTime=a);const r=this._pageLoadPerfRecorder.getMetric(de.a.contentViewable);if(t.documentLoadedTime=r||o.AFrameworkApplication.documentLoadedTime.getTime(),null==r&&k.ULS.sendTraceTag(36992713,301,15,"DocumentLoadedTime was used since ContentViewable time is null"),e)t.ignoreForEUPL=!0;else{const e=this._pageLoadPerfRecorder.getMetric(de.a.documentLoadedTime);null!=e&&(t.appCompletedTime=e)}t.officeServerVersion=this._appSettingsManager.getStringAppSetting("BuildVersion"),t.officeAppEndpoint=this._appSettingsManager.getStringAppSetting("WacCluster");const s={Diagnostics:t};this._appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.RedirectToViewerE2EReporting",!1)&&"1"===this._appSettingsManager.getStringAppSetting("UnexpectedFailedToLoad")?this.propogateWordEditorBootFailedRedirectToViewer(s):this._isJsApiV2?this.sendMessageWithRetry("Wac_AppCompleted",s):this.sendAppCompletedWithRetry(new jn.a("Wac_AppCompleted",s,(0,i.a)(this,this.sendAppCompletedWithRetry,"sendAppCompletedWithRetry")))}sendAppCompletedWithRetry(e){this._isJsApi&&(window.setTimeout((()=>{this._appCompleteAckMessageReceived=this.timeoutAckMessage(e,this._appCompleteAckMessageReceived)}),this._ackMessageTimeoutInMs),this._appCompleteAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)}sendAppFailedWithRetry(e){this._isJsApi&&(window.setTimeout((()=>{this._appFailedAckMessageReceived=this.timeoutAckMessage(e,this._appFailedAckMessageReceived)}),this._ackMessageTimeoutInMs),this._appFailedAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)}sendZoomChangeWithRetry(e){this._isJsApi&&this._isCoreMode&&(window.setTimeout((()=>{this._zoomChangeAckMessageReceived=this.timeoutAckMessage(e,this._zoomChangeAckMessageReceived)}),this._ackMessageTimeoutInMs),this._zoomChangeAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)}sendPageChangeWithRetry(e){this._isJsApi&&this._isCoreMode&&(window.setTimeout((()=>{this._pageChangeAckMessageReceived=this.timeoutAckMessage(e,this._pageChangeAckMessageReceived)}),this._ackMessageTimeoutInMs),this._pageChangeAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)}sendPageCountWithRetry(e){this._isJsApi&&this._isCoreMode&&(window.setTimeout((()=>{this._pageCountAckMessageReceived=this.timeoutAckMessage(e,this._pageCountAckMessageReceived)}),this._ackMessageTimeoutInMs),this._pageCountAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)}timeoutAckMessage(e,t){return!this._isJsApi||t||(e.retryCount<this._postMessageMaxRetries?(e.callback(e),k.ULS.sendTraceTag(38318930,301,50,"AckMessageTimeout for {0}. Retry sent. Retries left: {1}",e.messageId,this._postMessageMaxRetries-e.retryCount)):k.ULS.sendTraceTag(38318931,301,15,"AckMessageTimeout for {0}. No retries left.",e.messageId)),t}propogateWordEditorBootFailedRedirectToViewer(e){const t={errorType:"WordEditorBootFailedRedirectToViewer",errorCode:ea.a.wordEditorBootFailed_RedirectToViewer,message:"WordEditor boot failed for unexpected reasons and redirected to Viewer successfully"};e.Error=t,this._isJsApiV2?this.sendMessageWithRetry("Wac_AppFailed",e):this.sendAppFailedWithRetry(new jn.a("Wac_AppFailed",e,(e=>this.sendAppFailedWithRetry(e))))}constructor(e,t,n,a){this._ackMessageTimeoutInMs=1e3,this._postMessageMaxRetries=4,this._appCompleteAckMessageReceived=!1,this._appFailedAckMessageReceived=!1,this._zoomChangeAckMessageReceived=!1,this._pageChangeAckMessageReceived=!1,this._pageCountAckMessageReceived=!1,this.receiveAckMessages=e=>{switch(k.ULS.sendTraceTag(38318928,301,50,"Ack received: {0}.",e.MessageId),e.MessageId){case"Wac_AppCompleted_Ack":this._appCompleteAckMessageReceived=!0;break;case"Wac_AppFailed_Ack":this._appFailedAckMessageReceived=!0;break;case"ZoomChanged_Ack":this._zoomChangeAckMessageReceived=!0;break;case"PageChanged_Ack":this._pageChangeAckMessageReceived=!0;break;case"PageCount_Ack":this._pageCountAckMessageReceived=!0;break;default:k.ULS.sendTraceTag(38318929,301,15,"Received unhandled message "+e.MessageId+" from host")}},this.setZoomLevelHandler=e=>{if(!this._isJsApi||!this._isCoreMode)throw Error.invalidOperation("JsApi core mode is not enabled");if(!e.Values||!("newLevel"in e.Values)){const e={errorType:"InvalidArgument"};return void this.sendError({errorType:"ZoomChangeError",errorObject:e})}const t=e.Values.newLevel;this._actionManager.processActionWithData(on.a.setZoomLevel,2,t)},this.setCurrentPageHandler=e=>{if(!this._isJsApi||!this._isCoreMode)throw Error.invalidOperation("JsApi core mode is not enabled");if(!e.Values||!("newPage"in e.Values)){const e={errorType:"InvalidArgument"};return void this.sendError({errorType:"PageChangeError",errorObject:e})}const t=e.Values.newPage;this._actionManager.processActionWithData(on.a.setCurrentPage,2,t)},this.recordFastBootDiagnostic=e=>{e.Values&&"HostCacheLoadTime"in e.Values&&this._pageLoadPerfRecorder.addMetric(de.a.fastViewOpenTime,e.Values.HostCacheLoadTime)},this._isJsApi=n.getBooleanAppSetting("IsJsApi"),this._isJsApiV2=n.getBooleanAppSetting("IsJsApiV2"),this._isCoreMode=n.getBooleanAppSetting("IsCoreMode"),this._actionManager=e,this._hostPostmessenger=t,this._appSettingsManager=n,this._pageLoadPerfRecorder=a,this._isJsApi&&(this._hostPostmessenger.addAllowedReceivingMessage("SetZoomLevel"),this._hostPostmessenger.addAllowedReceivingMessage("SetCurrentPage"),this._hostPostmessenger.addAllowedReceivingMessage("HostCacheDiagnostic"),this._hostPostmessenger.registerCallback("SetZoomLevel",this.setZoomLevelHandler),this._hostPostmessenger.registerCallback("SetCurrentPage",this.setCurrentPageHandler),this._hostPostmessenger.registerCallback("HostCacheDiagnostic",this.recordFastBootDiagnostic),this._isJsApiV2||(this._hostPostmessenger.addAllowedReceivingMessage("Wac_AppCompleted_Ack"),this._hostPostmessenger.addAllowedReceivingMessage("Wac_AppFailed_Ack"),this._hostPostmessenger.addAllowedReceivingMessage("ZoomChanged_Ack"),this._hostPostmessenger.addAllowedReceivingMessage("PageChanged_Ack"),this._hostPostmessenger.addAllowedReceivingMessage("PageCount_Ack"),this._hostPostmessenger.registerCallback("Wac_AppCompleted_Ack",this.receiveAckMessages),this._hostPostmessenger.registerCallback("Wac_AppFailed_Ack",this.receiveAckMessages),this._hostPostmessenger.registerCallback("ZoomChanged_Ack",this.receiveAckMessages),this._hostPostmessenger.registerCallback("PageChanged_Ack",this.receiveAckMessages),this._hostPostmessenger.registerCallback("PageCount_Ack",this.receiveAckMessages)))}}(0,a.a)(ta,"WordViewerPostMessenger",null,[14]);var na=n(9578),aa=n(7445),ia=n(1752);class oa{getCommandById(e){return this._controlLegacyCommandMap.get(e)}getExternalUxIdsByLegacyControlId(e){return this._controlLegacyIdMap.get(e)}getGroupsMetadataByLegacyGroupId(e){return this._groupLegacyIdMap.get(e)}getCommandByExternalUxId(e){return this._controlReactIdMap.get(e)}getTabCommandByExternalUxId(e){return this._tabIdMap.get(e)}getExternalIconIdByLegacyIconId(e){return this._iconMap.has(e)?this._iconMap.get(e):(k.ULS.sendTraceTag(39946131,306,15,"ReactCommandDefinitionMapping.GetExternalIconIdByLegacyIconId: can't find mapping for legacy icon {0}",e),"MissingIcon_20")}getGroupsMetadataByExternalUxId(e){return this._groupReactIdMap.get(e)}addAddInCommandToMaps(e){this.addCommandToMaps(e)}addCommandToMaps(e){const t=e.externalUxCommand,n=this._controlReactIdMap.get(t);if(n){const e=n.externalUxCommand;this._controlReactIdMap.delete(e);const t=this._controlLegacyCommandMap.get(n.commandId),a=t.findIndex((t=>t.externalUxCommand===e));-1!==a&&t.splice(a,1)}this._controlReactIdMap.set(t,e);let a=this._controlLegacyCommandMap.get(e.commandId);a||(a=[],this._controlLegacyCommandMap.set(e.commandId,a)),a.push(e);const i=e.legacyControlId;if(i){let e=this._controlLegacyIdMap.get(i);e||(e=new he.a,this._controlLegacyIdMap.set(i,e)),e.add(t)}}addTabToMap(e,t){this._tabIdMap.set(e,t)}addIconToMap(e,t){this._iconMap.set(t,e)}addGroupToMap(e){let t=e.legacyGroupId;if(t){let n=this._groupLegacyIdMap.get(t);n||(n=[],this._groupLegacyIdMap.set(t,n)),n.push(e)}if(t=e.externalUxGroupId,t){let n=this._groupReactIdMap.get(t);n||(n=[],this._groupReactIdMap.set(t,n)),n.push(e)}}addCommandDefinitionMapping(){let e;this.addCommandToMaps(Object.assign(new aa.a("AccessibilityHelp","3276527670"),{legacyControlId:"jbtnAccessibilityHelp"})),this.addCommandToMaps(new aa.a("AlwaysShowRibbon","336231556")),this.addCommandToMaps(new aa.a("CoauthorsRendered","691867605")),this.addCommandToMaps(Object.assign(new aa.a("CopyLink",this._isUnauthEdit?Zt.a.saveAnonymousCreation.toString():"981334692"),{legacyControlId:"CopyLink"})),this.addCommandToMaps(Object.assign(new aa.a("CopyLinkFileMenu",this._isUnauthEdit?Zt.a.saveAnonymousCreation.toString():"981334692"),{legacyControlId:"CopyLink"})),o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.isPublishToWebEnabled()&&this.addCommandToMaps(new aa.a("PublishToWeb",Zt.a.publishToWeb.toString())),this.addCommandToMaps(Object.assign(new aa.a("ShareMenu","336231556"),{legacyControlId:"jbtnFileSharing"})),this.addCommandToMaps(Object.assign(new aa.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",queryCommandId:"1059068017"})),this.addCommandToMaps(Object.assign(new aa.a("CheckAccessibility","2529583086"),{legacyControlId:"btnOpenAccCheckerPane",queryCommandId:"1949220702"})),this.addCommandToMaps(new aa.a("CoEditInTeams","327119921")),this.addCommandToMaps(Object.assign(new aa.a("ConsumerHealthPolicy","4178239494"),{legacyControlId:"ConsumerHealthPolicy"})),this.addCommandToMaps(Object.assign(new aa.a("ContactSupport","2918242107"),{legacyControlId:"btnContactSupport"})),this.addCommandToMaps(Object.assign(new aa.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"})),this.addCommandToMaps(Object.assign(new aa.a("DownloadACopy",this._isUnauthEdit?Zt.a.saveAnonymousCreation.toString():"3555692408"),{legacyControlId:"jbtnDownloadACopy",queryCommandId:na.a.fileMenuDisabledButtonsHandlingEnabled?Zt.a.queryDownloadACopy.toString():void 0})),this.addCommandToMaps(new aa.a("FileMenuLauncher","1784018444")),this.addCommandToMaps(Object.assign(new aa.a("GiveFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"})),this.addCommandToMaps(Object.assign(new aa.a("Help","1454393937"),{legacyControlId:"jbtnHelp"})),this.addCommandToMaps(new aa.a("HideRibbon","336231556")),this.addCommandToMaps(new aa.a("InsertAddIns","1945259303")),this.addCommandToMaps(new aa.a("InsertMoreAddInsFromBackstageFooter","1945259303")),this.addCommandToMaps(new aa.a("InsertMoreAddInsFromFooter","1945259303")),this.addCommandToMaps(new aa.a("InsertAddInsFromBackstage","1945259303")),this.addCommandToMaps(new aa.a("SearchAddinInFlyout","1617957002")),this.addCommandToMaps(new aa.a("feedbackButtonInSearchResultView","22240842")),o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MosForWXPEnabled",!1)&&this.addCommandToMaps(new aa.a("LaunchOMEXStoreFromClassicFeaturesLink","1945259303")),this.addCommandToMaps(new aa.a("InsertComment","2423504651")),this.addCommandToMaps(Object.assign(new aa.a("InsertComment","2423504651"),{legacyControlId:"btnInsertComment"})),this.addCommandToMaps(new aa.a("LaunchAddinInstallDialogFromBackstage","3164366947")),this.addCommandToMaps(new aa.a("LaunchMyAddInsFromBackstage","1945259303")),this.addCommandToMaps(new aa.a("LaunchUserInstalledAddInFromBackstage","2544406033")),this.addCommandToMaps(new aa.a("ManageAccess",this._isUnauthEdit?Zt.a.saveAnonymousCreation.toString():"981334692")),this.addCommandToMaps(new aa.a("MenuClose","336231556")),this.addCommandToMaps(new aa.a("MenuOpen","336231556")),this.addCommandToMaps(new aa.a("MenuPopulate","336231556")),this.addCommandToMaps(new aa.a("TriggerModeSwitcherTUI","1251719100")),this.addCommandToMaps(new aa.a("MoveToFolder","1182470434")),this.addCommandToMaps(new aa.a("NavigateToCoauthor","4033456482")),this.addCommandToMaps(new aa.a("New","1056925771")),this.addCommandToMaps(new aa.a("NewBrowserSuggestionClicked","3734060499")),this.addCommandToMaps(Object.assign(new aa.a("NewComment","2423504651"),{legacyControlId:"btnNewComment"})),this.addCommandToMaps(Object.assign(new aa.a("PeopleWell","929022654"),{queryCommandId:"3798167515",populationProps:new ia.a("1285265560",!1)})),this.addCommandToMaps(Object.assign(new aa.a("Privacy","1208554566"),{legacyControlId:"jbtnPrivacy"})),this.addCommandToMaps(Object.assign(new aa.a("Rename",this._isUnauthEdit?Zt.a.saveAnonymousCreation.toString():"2382951455"),{legacyControlId:"jbtnRenameDialog"})),this.addCommandToMaps(Object.assign(new aa.a("SaveAs",this._isUnauthEdit?Zt.a.saveAnonymousCreation.toString():"4246497969"),{legacyControlId:"jbtnSaveACopy"})),this.addCommandToMaps(Object.assign(new aa.a("SaveAsToHost","2316717900"),{legacyControlId:"jbtnSaveAsToHost"})),this.addCommandToMaps(Object.assign(new aa.a("SaveToSharePoint","3050207199"),{legacyControlId:"jbtnSaveToSharePoint",queryCommandId:na.a.fileMenuDisabledButtonsHandlingEnabled?Zt.a.querySaveToSharePoint.toString():void 0})),this.addCommandToMaps(Object.assign(new aa.a("SearchHelp","2918242107"),{legacyControlId:"btnHelp"})),this.addCommandToMaps(Object.assign(new aa.a("Share",this._isUnauthEdit?Zt.a.saveAnonymousCreation.toString():"981334692"),{legacyControlId:"jbtnFileSharing"})),this.addCommandToMaps(Object.assign(new aa.a("ShareTopBar",this._isUnauthEdit?Zt.a.saveAnonymousCreation.toString():"981334692"),{legacyControlId:"jbtnFileSharing"})),this.addCommandToMaps(new aa.a("ShowMultilineRibbonFromToolbar","1088082265")),this.addCommandToMaps(new aa.a("ShowToolBarFromMultiLineRibbon","336231556")),this.addCommandToMaps(Object.assign(new aa.a("SmartLookUp","1435347209"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new aa.a("TabSwitch","336231556")),this.addCommandToMaps(Object.assign(new aa.a("TermsOfUse","2349775795"),{legacyControlId:"jbtnTermsOfUse"})),this.addCommandToMaps(Object.assign(new aa.a("Training","2918242107"),{legacyControlId:"btnShowTraining"})),this.addCommandToMaps(Object.assign(new aa.a("VersionHistory","3681556347"),{legacyControlId:"jbtnVersion"})),this.addCommandToMaps(Object.assign(new aa.a("WhatsNew","2918242107"),{legacyControlId:"btnWhatsNew"})),this.addCommandToMaps(Object.assign(new aa.a("Zoom","1738002952"),{legacyControlId:"btnViewZoomDialog"})),this.addCommandToMaps(Object.assign(new aa.a("ToggleRibbonUXDialog","1342108365"),{legacyControlId:"toggleBtnSimpleRibbon",queryCommandId:"1536028887"})),this.addCommandToMaps(new aa.a("CommitNewDocumentTitle","1808554760")),this.addCommandToMaps(new aa.a("RibbonModeToggledToMLR","536345575")),this.addCommandToMaps(new aa.a("RibbonModeToggledToSLR","4031133701")),this.addCommandToMaps(new aa.a("Workflow","2988588587")),this.addCommandToMaps(Object.assign(new aa.a("DefinitionsParameterized","2114287254"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new aa.a("GetHelpFromTellMe","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(Object.assign(new aa.a("GetHelpFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(Object.assign(new aa.a("GetHelpFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(Object.assign(new aa.a("GetHelpWithDescriptionFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(Object.assign(new aa.a("GetHelpWithDescriptionFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"})),this.addCommandToMaps(new aa.a("AnswerForSearch","1914896509")),this.addCommandToMaps(new aa.a("AnswerForSearchSingleLine","1914896509")),this.addCommandToMaps(new aa.a("ReuseFileQuickActionForSearch","1914896509")),this.addCommandToMaps(new aa.a("PeopleSuggestion1","2133437452")),this.addCommandToMaps(new aa.a("PeopleSuggestion2","2133437453")),this.addCommandToMaps(new aa.a("PeopleSuggestion3","2133437454")),this.addCommandToMaps(new aa.a("QuickActionOnFile","548581900")),this.addCommandToMaps(new aa.a("GenerateSlidesFromTellMe","2862675062")),this.addCommandToMaps(new aa.a("FileSuggestion1","2260671807")),this.addCommandToMaps(new aa.a("FileSuggestion2","2260671810")),this.addCommandToMaps(new aa.a("FileSuggestion3","2260671809")),this.addCommandToMaps(new aa.a("FileSuggestion4","2260671804")),this.addCommandToMaps(new aa.a("FileSuggestion5","2260671803")),this.addCommandToMaps(new aa.a("NotesSuggestion1","1914896509")),this.addCommandToMaps(new aa.a("NotesSuggestion2","1914896509")),this.addCommandToMaps(new aa.a("NotesSuggestion3","1914896509")),this.addCommandToMaps(new aa.a("OnenoteNotesSuggestion1","4083547050")),this.addCommandToMaps(new aa.a("OnenoteNotesSuggestion2","4083547053")),this.addCommandToMaps(new aa.a("OnenoteNotesSuggestion3","4083547052")),this.addCommandToMaps(new aa.a("TellMeFeedback","2230755196")),this.addCommandToMaps(new aa.a("TemplateForSearch","57037313")),this.addCommandToMaps(new aa.a("AddinSuggestion1","1385019911")),this.addCommandToMaps(new aa.a("AddinSuggestion2","981735384")),this.addCommandToMaps(new aa.a("AddinSuggestion3","2547819325")),this.addCommandToMaps(new aa.a("AddInBlogClicked","3343352239")),this.addCommandToMaps(new aa.a("LaunchAddinDialogFromTellMe","1421877154")),o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.shouldFindInDocWithMatchesOpenSerplet?(this.addCommandToMaps(new aa.a("FindWithMatchesParameterized","1914896509")),this.addCommandToMaps(new aa.a("FindParameterized","1914896509")),this.addCommandToMaps(new aa.a("FindInDocumentSuggestion1","1914896509")),this.addCommandToMaps(new aa.a("FindInDocumentSuggestion2","1914896509")),this.addCommandToMaps(new aa.a("FindInDocumentSuggestion3","1914896509"))):(this.addCommandToMaps(new aa.a("FindWithMatchesParameterized","1540292897")),this.addCommandToMaps(new aa.a("FindParameterized","1540292897")),this.addCommandToMaps(new aa.a("FindInDocumentSuggestion1","1540292897")),this.addCommandToMaps(new aa.a("FindInDocumentSuggestion2","1540292897")),this.addCommandToMaps(new aa.a("FindInDocumentSuggestion3","1540292897"))),this.addCommandToMaps(new aa.a("ImageForSearch","1914896509")),this.addCommandToMaps(new aa.a("LearningForSearch","1006342541")),this.addCommandToMaps(new aa.a("SmartLookupFromTellMe","1914896509")),this.addCommandToMaps(new aa.a("SmartLookupFromTellMeQueryTermAtTop","1914896509")),this.addCommandToMaps(new aa.a("SmartLookupFromTellMeZeroTerm","3359903192")),this.addCommandToMaps(new aa.a("ActionAIFromTellMe","1914896509")),!o.AFrameworkApplication.insightsIsEnabled||o.AFrameworkApplication.smartLookupIsEnabled||o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableNativePane")||(this.addCommandToMaps(Object.assign(new aa.a("SmartLookupFromTellMe","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new aa.a("SmartLookupFromTellMeQueryTermAtTop","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new aa.a("AnswerForSearch","3317204163")),this.addCommandToMaps(new aa.a("AnswerForSearchSingleLine","3317204163"))),this.addCommandToMaps(Object.assign(new aa.a("SynonymsParameterized","2114287254"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new aa.a("TellMeLogMenuClose","4266170064")),this.addCommandToMaps(new aa.a("TellMeLogMenuOpen","2480888384")),this.addCommandToMaps(new aa.a("TellMeMenuItemExecuted","878547493")),this.addCommandToMaps(new aa.a("TellMeSearchResultChange","2652476189")),this.addCommandToMaps(new aa.a("TellMeSuggestion_1","1404166600")),this.addCommandToMaps(new aa.a("TellMeSuggestion_2","1404166600")),this.addCommandToMaps(new aa.a("TellMeSuggestion_3","1404166600")),this.addCommandToMaps(new aa.a("TellMeSuggestion_4","1404166600")),this.addCommandToMaps(new aa.a("TellMeSuggestion_5","1404166600")),this.addCommandToMaps(new aa.a("TryOfficeUpsell","215809929")),this.addCommandToMaps(Object.assign(new aa.a("TellMeControl","336231556"),{legacyControlId:"TellMeControl"})),this.addCommandToMaps(Object.assign(new aa.a("DiagnosticsSection","336231556"),{legacyControlId:"AboutInformationMenuSectionDiagnostics"})),this.addCommandToMaps(Object.assign(new aa.a("FileAboutPage","336231556"),{legacyControlId:"faAbout"})),this.addCommandToMaps(Object.assign(new aa.a("FileHelpPage","336231556"),{legacyControlId:"faHelp"})),this.addCommandToMaps(Object.assign(new aa.a("FileHomePage","2074131365"),{legacyControlId:"faHome"})),this.addCommandToMaps(Object.assign(new aa.a("FileGetAddinsPage","508686645"),{legacyControlId:"faGetAddinsFromBackstage"})),this.addCommandToMaps(Object.assign(new aa.a("FileInfoPage","336231556"),{legacyControlId:"faInfo"})),this.addCommandToMaps(Object.assign(new aa.a("FileNewPage","2074131365"),{legacyControlId:"faNew"})),this.addCommandToMaps(Object.assign(new aa.a("FileOpenPage","2799130311"),{legacyControlId:"faOpen"})),this.addCommandToMaps(Object.assign(new aa.a("FilePrintPage","336231556"),{legacyControlId:"faPrint"})),this.addCommandToMaps(Object.assign(new aa.a("FileSaveAsPage","336231556"),{legacyControlId:"faSaveAs"})),this.addCommandToMaps(Object.assign(new aa.a("FileSharePage","336231556"),{legacyControlId:"faShare"})),this.addCommandToMaps(Object.assign(new aa.a("FileTransformPage","336231556"),{legacyControlId:"faTransform"})),this.addCommandToMaps(new aa.a("NewDocument","1056925771")),this.addCommandToMaps(new aa.a("OpenUrlInNewTab","1959943459")),this.addCommandToMaps(new aa.a("OpenDocumentUrl","2155708348")),this.addCommandToMaps(Object.assign(new aa.a("ReplyWithChanges","1197060601"),{legacyControlId:"jbtnShareRWC"})),this.addCommandToMaps(Object.assign(new aa.a("ReportAbuse","3237171630"),{legacyControlId:"jbtnReportAbuse"})),this.addCommandToMaps(Object.assign(new aa.a("ThirdPartyNotices","2220417879"),{legacyControlId:"jbtnThirdPartyNotices"})),this.addCommandToMaps(Object.assign(new aa.a("TrustCenter","2583751502"),{legacyControlId:"jbtnTrustCenter"})),this.addCommandToMaps(Object.assign(new aa.a("TryOfficeForWordEditor","1773624819"),{legacyControlId:"btnjTryMacOfficeForWordEditor"})),this.addCommandToMaps(Object.assign(new aa.a("TryMacOfficeForWordEditor","3901198658"),{legacyControlId:"btnjTryOfficeForWordEditor"})),this.addCommandToMaps(Object.assign(new aa.a("PreviousVersions","466976539"),{legacyControlId:"btnjVersionHistory"})),this.addCommandToMaps(Object.assign(new aa.a("FileVersionHistory","466976539"),{legacyControlId:"btnjVersionHistory"})),this.addCommandToMaps(Object.assign(new aa.a("FilePreviousVersions","3681556347"),{legacyControlId:"jbtnVersion"})),this.addCommandToMaps(Object.assign(new aa.a("HostConversation","710925581"),{legacyControlId:"HostConversation"})),this.addCommandToMaps(Object.assign(new aa.a("HostClose","3033402446"),{legacyControlId:"HostClose"})),this.addCommandToMaps(Object.assign(new aa.a("HostDownload","3555692408"),{legacyControlId:"HostDownload"})),this.addCommandToMaps(Object.assign(new aa.a("HostOpenInBrowser","2596942163"),{legacyControlId:"HostOpenInBrowser"})),this.addCommandToMaps(Object.assign(new aa.a("HostMoreOptions","336231556"),{legacyControlId:"HostMoreOptions"})),this.addCommandToMaps(Object.assign(new aa.a("Sensitivity","941487903"),{legacyControlId:"flySensitivity",queryCommandId:"3134802707",populationProps:new ia.a("1145315516",!0)})),this.addCommandToMaps(Object.assign(new aa.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"})),o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&this.addCommandToMaps(Object.assign(new aa.a("OpenDocumentShortLabelPane","390001269"),{queryCommandId:"888027492"})),this.addCommandToMaps(Object.assign(new aa.a("InsertAddInFlyout","2749373765"),{populationProps:new ia.a("1230970894",!1)})),this.addCommandToMaps(Object.assign(new aa.a("Citation","3418030507"),{queryCommandId:"969756804",populationProps:new ia.a("3418030507",!1)})),o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinContextMenuShareButtonEnabled",!1)&&(this.addCommandToMaps(Object.assign(new aa.a("AddInFlyoutMRUContextMenu",Zt.a.alwaysEnabled.toString()),{populationProps:new ia.a(Zt.a.populateAddInMRUContextMenu.toString(),!1)})),this.addCommandToMaps(Object.assign(new aa.a("ShareAddIn",Zt.a.shareAddIn.toString()),{}))),this.addCommandToMaps(Object.assign(new aa.a("ReloadAddInPicker","2502873265"),{populationProps:new ia.a("1230970894",!1)})),this.addCommandToMaps(Object.assign(new aa.a("ReloadCitationAddInPicker","3207566856"),{populationProps:new ia.a("3418030507",!1)})),this.addCommandToMaps(new aa.a("LaunchAddinInstallDialogFromList","1497204054")),this.addCommandToMaps(new aa.a("InstallPopularAddInAndLaunchIt","2882601901")),this.addCommandToMaps(new aa.a("FreemiumUpsellEligible","1274543852")),this.addCommandToMaps(new aa.a("FreemiumUpsellDialogShowUI","4180531998")),this.addCommandToMaps(new aa.a("ReportFreemiumUpsellEligibleDisplayed","2539564555")),this.addCommandToMaps(new aa.a("HandleDiscoverPremiumButtonClick","2280081216")),this.addCommandToMaps(new aa.a("SignInNavigate","1534118067")),this.addCommandToMaps(new aa.a("RequestFontInfo","3169500754")),this.addCommandToMaps(new aa.a("PinOrUnpinFont","1500655301")),this.addCommandToMaps(new aa.a("FontPickerMenuClose","146595126")),this.addCommandToMaps(new aa.a("FontPickerMenuOpen","482125874")),this.addCommandToMaps(new aa.a("ShowAccessibilitySettingsDialog","2236763780")),this.addCommandToMaps(Object.assign(new aa.a("ShowZoomDialog","1738002952"),{queryCommandId:"433063458",legacyControlId:"buttonShowZoomDialog"})),this.addCommandToMaps(Object.assign(new aa.a("ZoomToPercentage","3745693956"),{queryCommandId:"2901130581",legacyControlId:"ZoomSlider"})),this.addCommandToMaps(new aa.a("ZoomToPercentageCompleted","3139946409")),this.addCommandToMaps(new aa.a("UnauthEditRenameAttempt",Zt.a.saveAnonymousCreation.toString())),this.addCommandToMaps(new aa.a("UnauthEditSignIn",Zt.a.saveAnonymousCreation.toString())),this.addCommandToMaps(new aa.a("Favorites",Zt.a.updateFavorites.toString())),this.addCommandToMaps(Object.assign(new aa.a("RecentLinks","2535492938"),{queryCommandId:"2535492938",populationProps:new ia.a("860679239",!1)})),this.addCommandToMaps((e=new aa.a("InsertLinkFlyout","1052791248"),e.queryCommandId="1052791248",e.populationProps=new ia.a("276140882",!1),e))}constructor(){this._controlReactIdMap=new Map,this._controlLegacyCommandMap=new Map,this._controlLegacyIdMap=new Map,this._tabIdMap=new Map,this._groupLegacyIdMap=new Map,this._groupReactIdMap=new Map,this._iconMap=new Map,this._isUnauthEdit=o.AFrameworkApplication.isUnauthEdit,this.addCommandDefinitionMapping()}}(0,a.a)(oa,"ReactCommandDefinitionMapping",null,[101]);class ra extends oa{addCommandDefinitionMapping$1(){this.addReactToolbarCommandDefinitionMapping(),this.addReactStatusBarCommandDefinitionMapping()}addReactToolbarCommandDefinitionMapping(){this.addCommandToMaps(Object.assign(new aa.a("ToggleAccessibilityViewMode",on.a.toggleViewMode.toString()),{queryCommandId:on.a.queryAccessibleModeButtonToggledState.toString(),legacyControlId:"jbtnToggleViewMode"})),this.addCommandToMaps(Object.assign(new aa.a("LaunchImmersiveReaderEdu",on.a.launchImmersiveReader.toString()),{legacyControlId:"btnLaunchImmersiveViewEdu"})),this.addCommandToMaps(Object.assign(new aa.a("OpenInClientOnDock",on.a.openInClient.toString()),{legacyControlId:"btnEditInClientOnDock"})),this.addCommandToMaps(Object.assign(new aa.a("EditDocumentFlyoutAnchor",Zt.a.alwaysEnabled.toString()),{legacyControlId:"flyoutWordViewerEdit"})),this.addCommandToMaps(Object.assign(new aa.a("EditDocumentFlyoutAnchorUpdated",Zt.a.alwaysEnabled.toString()),{legacyControlId:"flyoutWordViewerEditNew"})),this.addCommandToMaps(Object.assign(new aa.a("EditOnWebInMenu",on.a.switchToEditMode.toString()),{legacyControlId:"btnFlyoutEditOnWeb"})),this.addCommandToMaps(Object.assign(new aa.a("ConvertToEditOnWebInMenu",on.a.binaryConvert.toString()),{legacyControlId:"btnFlyoutConvertToEditOnWeb"})),this.addCommandToMaps(Object.assign(new aa.a("CopyAndEditInMenu",Zt.a.copyAndEdit.toString()),{legacyControlId:"btnFlyoutCopyAndEdit"})),this.addCommandToMaps(Object.assign(new aa.a("EditInDesktopClientInMenu",on.a.openInClient.toString()),{legacyControlId:"btnEditInClient"})),this.addCommandToMaps(Object.assign(new aa.a("SwitchToViewMode",Zt.a.alwaysEnabled.toString()),{legacyControlId:"btnViewOnWeb"})),this.addCommandToMaps(Object.assign(new aa.a("ShowPdfConvertAndEditDialog",on.a.showPdfConvertAndEditDialog.toString()),{legacyControlId:"btnPdfConvertAndEdit"})),this.addCommandToMaps(Object.assign(new aa.a("ShowPdfCopyAndEditDialog",on.a.showPdfCopyAndEditDialog.toString()),{legacyControlId:"btnPdfCopyAndEdit"})),this.addCommandToMaps(Object.assign(new aa.a("OpenInClientViewingNonPdf",on.a.openInClient.toString()),{legacyControlId:"btnOpenInClient"})),this.addCommandToMaps(Object.assign(new aa.a("InteractiveViewOnWeb",on.a.switchToEditMode.toString()),{legacyControlId:"btnInteractiveViewOnWeb"})),this.addCommandToMaps(Object.assign(new aa.a("EditOnWeb",on.a.switchToEditMode.toString()),{legacyControlId:"btnEditOnWeb"})),this.addCommandToMaps(Object.assign(new aa.a("EditOnWebInRibbon",on.a.switchToEditMode.toString()),{legacyControlId:"btnEditOnWebInRibbon"})),this.addCommandToMaps(Object.assign(new aa.a("ConvertToEditOnWeb",on.a.binaryConvert.toString()),{legacyControlId:"btnConvertToEditOnWeb"})),this.addCommandToMaps(Object.assign(new aa.a("CopyAndEdit",Zt.a.copyAndEdit.toString()),{legacyControlId:"btnCopyAndEdit"})),this.addCommandToMaps(Object.assign(new aa.a("SaveAndEdit",on.a.saveAndEditATranslatedCopy.toString()),{legacyControlId:"btnSaveAndEdit"})),this.addCommandToMaps(Object.assign(new aa.a("TranslateBackToOriginal",on.a.translateBackToOriginal.toString()),{legacyControlId:"jbtnTranslateDocumentBack"})),this.addCommandToMaps(Object.assign(new aa.a("DownloadADocumentCopy",Zt.a.downloadACopy.toString()),{legacyControlId:"btnDownloadWithWord"})),this.addCommandToMaps(Object.assign(new aa.a("SaveToCloudStorage",Zt.a.saveToCloudStorage.toString()),{legacyControlId:"btnSaveToCloudStorage"})),this.addCommandToMaps(Object.assign(new aa.a("PrintDocumentDirect",on.a.printDocument.toString()),{legacyControlId:"PrintUnified"})),this.addCommandToMaps(Object.assign(new aa.a("CloseViewer",Zt.a.close.toString()),{legacyControlId:"btnjClose"})),this.addCommandToMaps(Object.assign(new aa.a("HostConversation",Zt.a.conversation.toString()),{legacyControlId:"HostConversation"})),this.addCommandToMaps(Object.assign(new aa.a("HostOpenDocumentInBrowser",Zt.a.openInBrowser.toString()),{legacyControlId:"HostOpenInBrowser"})),this.addCommandToMaps(Object.assign(new aa.a("FileSharing",Zt.a.fileSharing.toString()),{legacyControlId:"btnFileSharing"})),this.addCommandToMaps(Object.assign(new aa.a("MoreViewerOptionsFlyoutAnchor",Zt.a.doNothing.toString()),{legacyControlId:"MoreViewerOptionsFlyoutAnchor"})),this.addCommandToMaps(Object.assign(new aa.a("ToggleCommentPane",on.a.toggleCommentPane.toString()),{queryCommandId:Zt.a.queryToggleCommentPane.toString(),legacyControlId:"btnOpenCommentPane"})),this.addCommandToMaps(Object.assign(new aa.a("ToggleSearchPane",on.a.toggleSearchPane.toString()),{queryCommandId:on.a.queryToggleSearchPane.toString(),legacyControlId:"btnOpenSearchPane"})),this.addCommandToMaps(Object.assign(new aa.a("LaunchImmersiveReaderNonEdu",on.a.launchImmersiveReader.toString()),{legacyControlId:"btnLaunchImmersiveViewNonEdu"})),this.addCommandToMaps(Object.assign(new aa.a("TranslateDocument",on.a.translateDocument.toString()),{legacyControlId:"jbtnTranslateDocument"})),this.addCommandToMaps(Object.assign(new aa.a("ShowFileVersion",Zt.a.showFileVersion.toString()),{legacyControlId:"jbtnFileVersion"})),this.addCommandToMaps(Object.assign(new aa.a("OverflowDownloadWithWord",Zt.a.downloadACopy.toString()),{legacyControlId:"overflowbtnDownloadWithWord"})),this.addCommandToMaps(Object.assign(new aa.a("DownloadATranslatedCopy",on.a.downloadATranslatedCopy.toString()),{legacyControlId:"jbtnDownloadATranslatedCopy"})),this.addCommandToMaps(Object.assign(new aa.a("DownloadAPdfCopy",Zt.a.downloadACopy.toString()),{legacyControlId:"btnDownloadPdf"})),this.addCommandToMaps(Object.assign(new aa.a("DownloadWordDocAsPdf",on.a.downloadAsPdf.toString()),{legacyControlId:"jbtnDownloadAsPdf"})),this.addCommandToMaps(Object.assign(new aa.a("ShowFileEmbedInfo",on.a.showFileEmbedInfo.toString()),{legacyControlId:"jbtnFileEmbed"})),this.addCommandToMaps(Object.assign(new aa.a("ViewerHelp",Zt.a.help.toString()),{legacyControlId:"jbtnHelp"})),this.addCommandToMaps(Object.assign(new aa.a("ShowAccessibilityHelpDialog",Zt.a.showAccessibilityHelpDialog.toString()),{legacyControlId:"jbtnAccessibilityHelp"})),this.addCommandToMaps(Object.assign(new aa.a("GiveViewerFeedback",Zt.a.giveFeedback.toString()),{legacyControlId:"jbtnGiveFeedback"})),this.addCommandToMaps(Object.assign(new aa.a("TryOfficeFromWordViewer",Zt.a.tryOfficeFromWordViewer.toString()),{legacyControlId:"btnjTryOffice"})),this.addCommandToMaps(Object.assign(new aa.a("TryMacOfficeFromWordViewer",Zt.a.tryMacOfficeFromWordViewer.toString()),{legacyControlId:"btnjTryMacOffice"})),this.addCommandToMaps(Object.assign(new aa.a("OpenTermsOfUseLink",Zt.a.openTermsOfUseLink.toString()),{legacyControlId:"jbtnTermsOfUse"})),this.addCommandToMaps(Object.assign(new aa.a("PrivacyLink",Zt.a.privacyLink.toString()),{legacyControlId:"jbtnPrivacy"})),this.addCommandToMaps(Object.assign(new aa.a("PrintAccessibilityDocument",on.a.printAccessibilityDocument.toString()),{legacyControlId:"jbtnAccessibility"})),this.addCommandToMaps(Object.assign(new aa.a("DownloadAccessibilityPdf",Zt.a.downloadACopy.toString()),{legacyControlId:"jbtnAccessibilityPdf"})),this.addCommandToMaps(Object.assign(new aa.a("SyncToPresenter",on.a.syncToPresenter.toString()),{legacyControlId:"btnSyncToPresenter"})),this.addCommandToMaps(Object.assign(new aa.a("OpenSharedNotes",on.a.openSharedNotes.toString()),{legacyControlId:"btnOpenSharedNotes"})),this.addCommandToMaps(Object.assign(new aa.a("ShowTrustCenter",Zt.a.showTrustCenter.toString()),{legacyControlId:"jbtnTrustCenter"})),this.addCommandToMaps(Object.assign(new aa.a("SwitchToUnifiedReadMode",on.a.switchToUnifiedReadMode.toString()),{legacyControlId:"jbtnSwitchToUnifiedReadMode"})),this.addCommandToMaps(Object.assign(new aa.a("FrenchAccessibilityStatement",Zt.a.frenchAccessibilityStatement.toString()),{legacyControlId:"jbtnFrenchAccessibilityStatement"})),this.addCommandToMaps(Object.assign(new aa.a("ItalianAccessibilityStatement",Zt.a.italianAccessibilityStatement.toString()),{legacyControlId:"jbtnItalianAccessibilityStatement"})),this.addCommandToMaps(Object.assign(new aa.a("ConsumerHealthPolicy",Zt.a.openConsumerHealthPolicyLink.toString()),{legacyControlId:"OpenConsumerHealthPolicyLink"}))}addReactStatusBarCommandDefinitionMapping(){this.addCommandToMaps(Object.assign(new aa.a("GetQueryCurrentPageLabel",Zt.a.alwaysEnabled.toString()),{queryCommandId:on.a.queryCurrentPageLabel.toString(),legacyControlId:"PageInfoLabel"})),this.addCommandToMaps(Object.assign(new aa.a("OpenDocumentLabelPane",Zt.a.openDocumentLabelPane.toString()),{queryCommandId:Zt.a.queryPolicyLabel.toString(),legacyControlId:"ClassificationLabel"})),this.addCommandToMaps(Object.assign(new aa.a("GetQueryEnvironmentName",Zt.a.alwaysEnabled.toString()),{queryCommandId:Zt.a.queryEnvironmentName.toString(),legacyControlId:"EnvironmentLabel"})),this.addCommandToMaps(Object.assign(new aa.a("GetQueryPresenterPageLabel",Zt.a.alwaysEnabled.toString()),{queryCommandId:on.a.queryPresenterPageLabel.toString(),legacyControlId:"PresenterPageLabel"})),this.addCommandToMaps(Object.assign(new aa.a("ShowZoomDialog",Zt.a.showZoomDialog.toString()),{queryCommandId:on.a.queryZoomText.toString(),legacyControlId:"buttonShowZoomDialog"})),this.addCommandToMaps(Object.assign(new aa.a("GiveFeedback",Zt.a.giveFeedback.toString()),{legacyControlId:"GiveFeedback"}))}constructor(){super(),this.addCommandDefinitionMapping$1()}}(0,a.a)(ra,"WordViewerReactCommandDefinitionMapping",oa,[]);var sa=n(5325),la=n(4606),ca=n(1676),da=n(7109),ua=n(6004),pa=n(4965);class ga{get appBaseDom(){return this._appBase}get heightAboveAppBase(){return this._heightAboveAppBase}get theSearchManager(){return this._theSearchManager}get theDisplayManager(){return this._theDisplayManager}get theSelectionManager(){return this._theSelectionManager}get theZoomControl(){return this._zoomControl||(this._zoomControl=this.lazyZoomControl.value)}get theNavigationControl(){return this._navigationControl||(this._navigationControl=this.lazyNavigationControl.value)}get theScrollControl(){return this._scrollControl||(this._scrollControl=this.lazyScrollControl.value)}get initialized(){return this._initialized}init(e){const{App:t}=Vn.a.AppInstance;t.get_activeAppFrame().add_onResize(this.resizeAppBase),this._appBase=document.createElement("div"),this._appBase.id="WACAppBase";let n="WACAppBase";(o.AFrameworkApplication.protectFile||o.AFrameworkApplication.protectedFile)&&(n+=" Protected"),this._appBase.className=n,e.appendChild(this._appBase),this._thePrintManager=la.a.getPrintManagerInstance();const a=this.focusManager.getScope(At.a.documentFocusID);a.bindAction(T.a.hashKey(gn.a.VK_F10,4),on.a.showContextMenuFromKey),a.bindAction(T.a.hashKey(gn.a.vK_ContextMenu,0),on.a.showContextMenuFromKey),ua.a(),t.instance.isAccessiblePdfMode?(pa.a.disableAccessibleModeForProtectedDocs&&Vn.a.isDocumentProtected()?Vn.a.handleCannotOpenAccessibleModeError():this._theDisplayManager=this.lazyDisplayManagerFactory.value.create(1,this._appBase),t.hideFirstPageImage()):(this.theScrollControl.init(),this.theZoomControl.initializeActor(),this.theNavigationControl.init(),this._appBase.appendChild(this.theScrollControl.container),this._theDisplayManager=this.lazyDisplayManagerFactory.value.create(0,this.theScrollControl.scroller)),t.get_activeAppFrame().ribbonPanel&&(this._heightAboveAppBase=t.get_activeAppFrame().ribbonPanel.clientHeight),t.get_activeAppFrame().statusBarUser&&(this._heightBelowAppBase=da.a.isReactStatusBarEnabled?ca.a.reactStatusBarHeight:At.a.statusBarHeight),this._initialized=!0}setCommentManagerDisposable(e){this._theCommentManager=e}setSelectionManager(e){this._theSelectionManager=e}setSearchManager(e){this._theSearchManager=e}getCurrentPage(){return this._theDisplayManager?this._theDisplayManager.currentPage:1}getHeight(){return this._isAppBaseHeightDirty&&(this._appBaseClientHeight=this._appBase.clientHeight,this._isAppBaseHeightDirty=!1),this._appBaseClientHeight}getFirstCachedPage(){return this._theDisplayManager?this._theDisplayManager.startPage:0}getFirstSelectedPage(){return this._theDisplayManager&&this._theSelectionManager?this._theSelectionManager.firstPage:0}getLastCachedPage(){return this._theDisplayManager?this._theDisplayManager.endPage:0}getLastSelectedPage(){return this._theDisplayManager&&this._theSelectionManager?this._theSelectionManager.lastPage:0}pageCacheChanged(e,t){o.AFrameworkApplication.theActionManager.processActionWithData(on.a.pageCacheChanged,2,[e,t])}searchActive(){return!!this._theSearchManager?.isSearchActive}dispose(){const{App:e}=Vn.a.AppInstance;e.get_activeAppFrame().remove_onResize(this.resizeAppBase),this._theSearchManager&&(this._theSearchManager.dispose(),this._theSearchManager=null),this._theCommentManager&&(this._theCommentManager.dispose(),this._theCommentManager=null),this._navigationControl&&(this._navigationControl.dispose(),this._navigationControl=null),this._theDisplayManager&&(this._theDisplayManager.dispose(),this._theDisplayManager=null),this._thePrintManager&&(this._thePrintManager.dispose(),this._thePrintManager=null),this._zoomControl&&(this._zoomControl.dispose(),this._zoomControl=null),this._theSelectionManager&&(this._theSelectionManager.dispose(),this._theSelectionManager=null),this._scrollControl&&(this._scrollControl.dispose(),this._scrollControl=null),this._appBase=null}constructor(e,t,n,a,i){this.focusManager=e,this.lazyDisplayManagerFactory=t,this.lazyZoomControl=n,this.lazyNavigationControl=a,this.lazyScrollControl=i,this._appBase=null,this._appBaseClientHeight=0,this._isAppBaseHeightDirty=!0,this._theDisplayManager=null,this._theSelectionManager=null,this._theSearchManager=null,this._thePrintManager=null,this._theCommentManager=null,this._scrollControl=null,this._navigationControl=null,this._zoomControl=null,this._heightAboveAppBase=0,this._heightBelowAppBase=0,this._initialized=!1,this.resizeAppBase=()=>{const{App:e}=Vn.a.AppInstance;let t=this._heightAboveAppBase;const n=e.get_activeAppFrame().businessBar;n&&n.visible&&(t+=n.htmlElement.offsetHeight),this._appBase?(this._appBase.style.width=e.get_activeAppFrame().getDOMElement().clientWidth+"px",this._appBase.style.top=t+"px",this._appBase.style.bottom=this._heightBelowAppBase+"px"):st.a(4331590,301,!1,"We didn't expect the _appBase to be null");const a=document.getElementById("FirstPageContainer");if(a){const e=sa.a.calculateToolbarWithTopBarHeight(o.AFrameworkApplication.hideHeader,!1);a.style.top=e+"px"}this._isAppBaseHeightDirty=!0}}}(0,a.a)(ga,"Workspace",null,[11]);var ha=n(1400);class ma extends ha.a{onFlexPaneOpen(e){}onFlexPaneClose(e){}constructor(e,t,n,a,i){super(e,t,n,a,i)}}(0,a.a)(ma,"ReactSharedHeaderFocusManagerWordViewer",ha.a,[]);var _a,Sa=n(4290);!function(e){e[e.unattempted=0]="unattempted",e[e.inProgress=1]="inProgress",e[e.notHandled=2]="notHandled",e[e.handleExternally=4]="handleExternally",e[e.failed=8]="failed",e[e.error=16]="error",e[e.succeeded=32]="succeeded",e[e.delayed=64]="delayed"}(_a||(_a={})),(0,a.b)("ActionResponse",_a);var fa=n(6295),Ca=n(92);class ya{onActionError(e,t){this.logActionAsKpi(e,!1,t)}onBeforeAction(e){this.logActionAsKpi(e,!0)}onAfterAction(e){this.logActionAsKpi(e,!1)}logActionAsKpi(e,t,n){if(this.shouldLogActionAsKpi(e))if(t||n||32!==e.response&&4!==e.response){if(!t){const t=this.getActionName(e);if(!t)return;const a=this.getExtendedProperties(e,n);this.featureUsageLogger.logKpiFailure(cn.a.getKpiFailureParams(t,n?Sa.a.getCrashErrorName(n):_a[e.response],this.getDuration(e),a))}}else{const t=this.getActionName(e);if(!t)return;const a=this.getExtendedProperties(e,n);this.featureUsageLogger.logKpiSuccess(cn.a.getKpiSuccessParams(t,this.getDuration(e),a))}}getDuration(e){const t=e?.startTime?.getTime();if(!t)return null;const n=e.endTime?.getTime();if(!n)return null;let a=n-t;return a=a<0?0:a,a}getActionName(e){const t=e.actionId;return In.ActionManager.actionIdResolver(t)}getExtendedProperties(e,t){const n=new Map;return n.set("ActionId",e.actionId.toString()),e.commandTabName&&n.set("CommandTabName",e.commandTabName),t&&(n.set("ErrorName",t.name??""),n.set("ErrorMessage",t.message??""),n.set("CrashCallstack",t.stack??"")),e.invocationMethod>0&&n.set("InvocationMethod",fa.a[e.invocationMethod]),e.commandLocation>0&&n.set("CommandLocation",Ca.a[e.commandLocation]),n}shouldLogActionAsKpi(e){if(!this.canLogActionAsKpi(e))return!1;const t=o.AFrameworkApplication.theActionManager.getActionMetadata(e.actionId),n=!!t&&(t.flags[32]||t.flags[64]||t.flags[96]);return 2===e.behavior&&!n}canLogActionAsKpi(e){return!(null==this.featureUsageLogger||!e)}constructor(e){this.featureUsageLogger=e}}(0,a.a)(ya,"ActionManagerKpiListener",null,[43]);const Aa="ActionManager",ba="wwtotalvisibilityfc",Ta="Infrastructure";class va{pendingRequestsModified(e,t){this.clientRequestRecorder&&this.clientRequestRecorder.recordClientRequest(t)}constructor(e){this.clientRequestRecorder=e}}(0,a.a)(va,"ClientRequestListener",null,[192]);var wa,Fa=n(9084),Ia=n(5499),Ea=n(2863);!function(e){e[e.nil=-1]="nil",e[e.success=0]="success",e[e.invalidPropertyData=1]="invalidPropertyData",e[e.invalidBaseRevision=2]="invalidBaseRevision",e[e.referencedRevisionNotFound=3]="referencedRevisionNotFound",e[e.coherencyFailure=4]="coherencyFailure",e[e.expectedLatestMissing=5]="expectedLatestMissing",e[e.invalidFileID=6]="invalidFileID",e[e.permissionDenied=7]="permissionDenied",e[e.documentProtectionSettings=9]="documentProtectionSettings",e[e.fileLockedByOtherInterface=11]="fileLockedByOtherInterface",e[e.corruptedFile=12]="corruptedFile",e[e.unsupportedObjects=13]="unsupportedObjects",e[e.unspecifiedFailure=14]="unspecifiedFailure",e[e.dependentOperationFailure=15]="dependentOperationFailure",e[e.fileLockedForOfflineCheckout=16]="fileLockedForOfflineCheckout",e[e.fileRequiresCheckout=17]="fileRequiresCheckout",e[e.incompatibleOldFile=18]="incompatibleOldFile",e[e.genericVirus=19]="genericVirus",e[e.knownVirus=20]="knownVirus",e[e.minorVersionLimitReached=21]="minorVersionLimitReached",e[e.quotaExceeded=22]="quotaExceeded",e[e.fileTooLarge=23]="fileTooLarge",e[e.invalidImageFile=25]="invalidImageFile",e[e.officeOnlineConnectFail=26]="officeOnlineConnectFail",e[e.clipDownloadFail=27]="clipDownloadFail",e[e.canaryError=28]="canaryError",e[e.passwordProtected=29]="passwordProtected",e[e.documentPasswordEncrypted=30]="documentPasswordEncrypted",e[e.fileCheckedOut=31]="fileCheckedOut",e[e.imageTooLarge=32]="imageTooLarge",e[e.requestCountTooLarge=33]="requestCountTooLarge",e[e.responseTooLarge=34]="responseTooLarge",e[e.lockMismatch=35]="lockMismatch",e[e.oldProductDigitalSignature=36]="oldProductDigitalSignature",e[e.sectionProtectionSettings=37]="sectionProtectionSettings",e[e.preReleaseFile=38]="preReleaseFile",e[e.fileEditedInRichClient=39]="fileEditedInRichClient",e[e.pageDeleteFailedDueToOtherUser=40]="pageDeleteFailedDueToOtherUser",e[e.completePageDeleteFailure=41]="completePageDeleteFailure",e[e.deletedPageDisconnectFailure=42]="deletedPageDisconnectFailure",e[e.errorSavingWordDocument=43]="errorSavingWordDocument",e[e.unrecoverableFailureOnWordSave=44]="unrecoverableFailureOnWordSave",e[e.unreadableFutureContent=45]="unreadableFutureContent",e[e.busy_RetryLater=46]="busy_RetryLater",e[e.wordFileVersionMismatch=47]="wordFileVersionMismatch",e[e.wordLostUsersChanges=48]="wordLostUsersChanges",e[e.lockCoherencyFailure=49]="lockCoherencyFailure",e[e.wordKickOutSuccessDocumentTooLarge=51]="wordKickOutSuccessDocumentTooLarge",e[e.wordKickOutSuccessOther=52]="wordKickOutSuccessOther",e[e.wordKickOutFailDocumentTooLarge=54]="wordKickOutFailDocumentTooLarge",e[e.wordKickOutFailOther=55]="wordKickOutFailOther",e[e.numberOfCoauthorsReachedMax=57]="numberOfCoauthorsReachedMax",e[e.odtEditingDisabled=58]="odtEditingDisabled",e[e.docxCoherencyFailure=59]="docxCoherencyFailure",e[e.documentMarkedFinal=61]="documentMarkedFinal",e[e.needSeedSync=62]="needSeedSync",e[e.unrecoverableStoreBusy=63]="unrecoverableStoreBusy",e[e.documentNeedsExclusiveLock=65]="documentNeedsExclusiveLock",e[e.oneNoteEditorsTableOnSingleSectionDenied=66]="oneNoteEditorsTableOnSingleSectionDenied",e[e.customXml=68]="customXml",e[e.clientServerNormalizationConflict=69]="clientServerNormalizationConflict",e[e.wordKickOutOnLoad=70]="wordKickOutOnLoad",e[e.wordKickOutOnSave=71]="wordKickOutOnSave",e[e.wordSessionCoherencyFailure=72]="wordSessionCoherencyFailure",e[e.templateDocxFile=73]="templateDocxFile",e[e.playSaveReplayCompleted=74]="playSaveReplayCompleted",e[e.tooManyFailedUpgradeAttempts=75]="tooManyFailedUpgradeAttempts",e[e.passwordProtectedUnlockable=76]="passwordProtectedUnlockable",e[e.wordFootnoteEndnoteNotConformant=77]="wordFootnoteEndnoteNotConformant",e[e.redirectToClusterSpecificUrl=78]="redirectToClusterSpecificUrl",e[e.tooManyMergeAttempts=79]="tooManyMergeAttempts",e[e.failingWithImmediateRetry=80]="failingWithImmediateRetry",e[e.startedAsynchronousAutoSave=81]="startedAsynchronousAutoSave",e[e.localCobaltCommunicationFailure=82]="localCobaltCommunicationFailure",e[e.localCobaltFault=83]="localCobaltFault",e[e.wordCoauthRequestCancelled=84]="wordCoauthRequestCancelled",e[e.wordTransformHeaderFooter=85]="wordTransformHeaderFooter",e[e.wordAdjustHeaderFooterGraph=86]="wordAdjustHeaderFooterGraph",e[e.wordAdjustHeaderFooterDocx=87]="wordAdjustHeaderFooterDocx",e[e.localCobaltDeletedSessionFault=88]="localCobaltDeletedSessionFault",e[e.localCobaltExpiredSessionFault=89]="localCobaltExpiredSessionFault",e[e.graphMissingFromLocalCobalt=90]="graphMissingFromLocalCobalt",e[e.fileAlreadyLockedOnServer=91]="fileAlreadyLockedOnServer",e[e.wordSaveRetriableTimeOut=92]="wordSaveRetriableTimeOut",e[e.wordSaveNonRetriableTimeOut=93]="wordSaveNonRetriableTimeOut",e[e.wordSaveTimedOut=94]="wordSaveTimedOut",e[e.headerFooterKindSpecifiedTwice=95]="headerFooterKindSpecifiedTwice",e[e.headerFooterReferencesNonHeaderFooter=96]="headerFooterReferencesNonHeaderFooter",e[e.noResponseObjects=97]="noResponseObjects",e[e.preProcessingKickedTheUserOut=98]="preProcessingKickedTheUserOut",e[e.failedToDeserializeRevision=99]="failedToDeserializeRevision",e[e.localCobaltInvalidSessionWithoutLastAutoSave=100]="localCobaltInvalidSessionWithoutLastAutoSave",e[e.responseNotReady=101]="responseNotReady",e[e.unmatchedFieldBegins=102]="unmatchedFieldBegins",e[e.unmatchedFieldEnds=103]="unmatchedFieldEnds",e[e.operationDisabled=104]="operationDisabled",e[e.originalBaseRootAndOriginalDocxRootNotInSync=105]="originalBaseRootAndOriginalDocxRootNotInSync",e[e.originalBaseGraphAndOriginalDocxNotInSync=106]="originalBaseGraphAndOriginalDocxNotInSync",e[e.failSessionUsingOriginalDocx=107]="failSessionUsingOriginalDocx",e[e.fileFormatError=108]="fileFormatError",e[e.hostCommunicationNetworkError=109]="hostCommunicationNetworkError",e[e.wordTransformFailureTable=110]="wordTransformFailureTable",e[e.wordAdjustInvalidFieldStructure=111]="wordAdjustInvalidFieldStructure",e[e.docxUnchanged=112]="docxUnchanged",e[e.zeroByteFile=113]="zeroByteFile",e[e.incompatibleFeaturesInModel=114]="incompatibleFeaturesInModel",e[e.editingWithLocksDisabled=115]="editingWithLocksDisabled",e[e.failedToRetrieveDocumentFromLocalCobalt=116]="failedToRetrieveDocumentFromLocalCobalt",e[e.tooManyRetries=117]="tooManyRetries",e[e.noParagraphsAfterSave=118]="noParagraphsAfterSave",e[e.wordKickOutOnSaveValidationFailure=119]="wordKickOutOnSaveValidationFailure",e[e.oneNoteImageToolsFailure=120]="oneNoteImageToolsFailure",e[e.oneNoteApiError=121]="oneNoteApiError",e[e.oneNoteContentUnavailable=122]="oneNoteContentUnavailable",e[e.activityGenerationHitPermanentFailure=123]="activityGenerationHitPermanentFailure",e[e.pptServerError=124]="pptServerError",e[e.pptServerAsyncError=125]="pptServerAsyncError",e[e.unspecifiedCobaltFailure=126]="unspecifiedCobaltFailure",e[e.unexpectedErrorException=127]="unexpectedErrorException",e[e.genericDocNotAppropriateFailure=128]="genericDocNotAppropriateFailure",e[e.genericAdjustFailure=129]="genericAdjustFailure",e[e.genericTransformFailure=130]="genericTransformFailure",e[e.itemsAlreadyExist=131]="itemsAlreadyExist",e[e.badRequest=132]="badRequest",e[e.softAffinityFailure=133]="softAffinityFailure",e[e.deserializationFailure=134]="deserializationFailure",e[e.cacheMiss=135]="cacheMiss",e[e.repairPossibleWithSword=136]="repairPossibleWithSword",e[e.dsS_PrimaryFailover_FailedToReadTruthFromHost=137]="dsS_PrimaryFailover_FailedToReadTruthFromHost",e[e.templateDownloadFailed=138]="templateDownloadFailed",e[e.hostThrottledRequest=139]="hostThrottledRequest",e[e.interactiveViewDisabled=140]="interactiveViewDisabled",e[e.redirectToViewer=141]="redirectToViewer",e[e.missingRequiredProperties=142]="missingRequiredProperties",e[e.invalidObject=143]="invalidObject",e[e.invalidRevisionTopology=144]="invalidRevisionTopology",e[e.fileNotFound=145]="fileNotFound",e[e.siteReadOnlyMode=146]="siteReadOnlyMode",e[e.blockedFileType=147]="blockedFileType",e[e.failedToUpdateOcsRoots=148]="failedToUpdateOcsRoots",e[e.failedToRetrieveOcsRoots=149]="failedToRetrieveOcsRoots",e[e.wordOcsConversionServiceRequestFailed=150]="wordOcsConversionServiceRequestFailed",e[e.ocsRetriableSaveError=151]="ocsRetriableSaveError",e[e.sectionPropertiesNotFinalChildOfBody=152]="sectionPropertiesNotFinalChildOfBody",e[e.ocsHostFallbackRequired=153]="ocsHostFallbackRequired",e[e.ocsPermanentSaveError=154]="ocsPermanentSaveError",e[e.noWaterline=155]="noWaterline",e[e.ocsPermanentErrorKickout=156]="ocsPermanentErrorKickout",e[e.oneNoteGenericError=157]="oneNoteGenericError",e[e.openXmlPackageHasNoRelationships=158]="openXmlPackageHasNoRelationships",e[e.odtFileWithIncorrectExtension=159]="odtFileWithIncorrectExtension",e[e.putChangesValidationFailed=160]="putChangesValidationFailed",e[e.unsupportedObjects_AltChunk=161]="unsupportedObjects_AltChunk",e[e.unsupportedObjects_BdoElement=162]="unsupportedObjects_BdoElement",e[e.invalidFieldStructure=163]="invalidFieldStructure",e[e.getCellsMissingFileId=164]="getCellsMissingFileId",e[e.openXmlIsolatedStorageError=165]="openXmlIsolatedStorageError",e[e.exceptionWhileDisposingTransformGlobals=166]="exceptionWhileDisposingTransformGlobals",e[e.repairUsingSWordFailed=167]="repairUsingSWordFailed",e[e.tranformFailedAfterSWordRepair=168]="tranformFailedAfterSWordRepair",e[e.normalizeAttemptedTwice=169]="normalizeAttemptedTwice",e[e.unsupportedObjects_ColorSpecification=170]="unsupportedObjects_ColorSpecification",e[e.docxFileWithIncorrectExtension=171]="docxFileWithIncorrectExtension",e[e.graphFeaturesNodeContainsUnsupportedFeatures=172]="graphFeaturesNodeContainsUnsupportedFeatures",e[e.invalidStyleXml=173]="invalidStyleXml",e[e.getCellsRunTimeLimitExceeded=174]="getCellsRunTimeLimitExceeded",e[e.autoSaveExceptionInDss=175]="autoSaveExceptionInDss",e[e.failedToSaveReplayToDisk=176]="failedToSaveReplayToDisk",e[e.contentSyncServerTimeout=177]="contentSyncServerTimeout",e[e.commentsExtensibleDuplicateDurableID=178]="commentsExtensibleDuplicateDurableID",e[e.noChangeIdObjectIdMappingExists=179]="noChangeIdObjectIdMappingExists",e[e.fullFileAugLoopSeedError=180]="fullFileAugLoopSeedError",e[e.saveServiceRejectionDueToHighCpu=181]="saveServiceRejectionDueToHighCpu",e[e.noChangeIdCommitMappingExists=182]="noChangeIdCommitMappingExists",e[e.noChangeIdMappingExistsInChangeIdCommitMapping=183]="noChangeIdMappingExistsInChangeIdCommitMapping",e[e.changeIdIsNullOrEmpty=184]="changeIdIsNullOrEmpty",e[e.changeIdIsNotExtendedGUID=185]="changeIdIsNotExtendedGUID",e[e.noChangeIdCommitMappingExistsAndCreatingOne=186]="noChangeIdCommitMappingExistsAndCreatingOne",e[e.encryptedSectionMergeFinished=187]="encryptedSectionMergeFinished",e[e.oneNoteSectionUpgradeNotSupported=188]="oneNoteSectionUpgradeNotSupported",e[e.readOnlyEmbeddedFont=189]="readOnlyEmbeddedFont",e[e.invalidCoauthSession=190]="invalidCoauthSession",e[e.multipleClientsInCoauthSession=191]="multipleClientsInCoauthSession",e[e.exitCoauthSessionAsConvertToExclusiveFailed=192]="exitCoauthSessionAsConvertToExclusiveFailed",e[e.lockRequestFail=193]="lockRequestFail",e[e.invalidTableCell=194]="invalidTableCell",e[e.unsupportedObjects_InfiniteLoopInNumbering=195]="unsupportedObjects_InfiniteLoopInNumbering",e[e.acquireLock_UnspecifiedFailure=196]="acquireLock_UnspecifiedFailure",e[e.localCobalt_UnspecifiedFailure=197]="localCobalt_UnspecifiedFailure",e[e.versionNotFound=198]="versionNotFound",e[e.unsupportedObjects_EmptyContentControl=199]="unsupportedObjects_EmptyContentControl",e[e.invalidWebExtensionXml=200]="invalidWebExtensionXml",e[e.nullFileIdLastSavedRevisionRequest=201]="nullFileIdLastSavedRevisionRequest",e[e.invalidOEmbedElementXml=202]="invalidOEmbedElementXml",e[e.hostServiceUnavailable=203]="hostServiceUnavailable",e[e.invalidHostResponse=204]="invalidHostResponse",e[e.invalidListData=205]="invalidListData",e[e.invalidAbstractNumData=206]="invalidAbstractNumData",e[e.abstractIdMappingMissing=207]="abstractIdMappingMissing",e[e.listIdToAbstractIdMapMissing=208]="listIdToAbstractIdMapMissing",e[e.hostForbidden=209]="hostForbidden",e[e.hostUnused=210]="hostUnused",e[e.hostBadGateway=211]="hostBadGateway",e[e.hostGatewayTimeout=212]="hostGatewayTimeout",e[e.hostInternalServerError=213]="hostInternalServerError",e[e.hostConflict=214]="hostConflict",e[e.hostNotImplemented=215]="hostNotImplemented",e[e.hostMovedPermanently=216]="hostMovedPermanently",e[e.hostUnsupportedMediaType=217]="hostUnsupportedMediaType",e[e.hostGone=218]="hostGone",e[e.hostRequestEntityTooLarge=219]="hostRequestEntityTooLarge",e[e.hostMethodNotAllowed=220]="hostMethodNotAllowed",e[e.hostTooManyRequest=221]="hostTooManyRequest",e[e.hostHttpRequestFailureStatusCodeUndefined=222]="hostHttpRequestFailureStatusCodeUndefined",e[e.wordSaveHostServiceUnavailable=230]="wordSaveHostServiceUnavailable",e[e.wordSaveHostTooManyRequests=231]="wordSaveHostTooManyRequests",e[e.docxPermissionDenied=232]="docxPermissionDenied",e[e.tooManyFailuresCheckCachedBaseDoc=233]="tooManyFailuresCheckCachedBaseDoc",e[e.oneNoteServerTooBusy=234]="oneNoteServerTooBusy",e[e.invalidXmlDuringNormalization=235]="invalidXmlDuringNormalization",e[e.localCobaltSessionNotFound=236]="localCobaltSessionNotFound",e[e.successOnCurrentRequestRedirectNextRequestToClusterSpecificUrl=237]="successOnCurrentRequestRedirectNextRequestToClusterSpecificUrl",e[e.invalidSDTElementXml=238]="invalidSDTElementXml",e[e.nonCoauthorableGraphFoundInDss=239]="nonCoauthorableGraphFoundInDss",e[e.hostBadRequest=240]="hostBadRequest",e[e.hostUnauthorized=241]="hostUnauthorized",e[e.hostFileNotFound=242]="hostFileNotFound",e[e.hostFileMinorVersionLimitExceeded=243]="hostFileMinorVersionLimitExceeded",e[e.networkLocationPermissionDenied=244]="networkLocationPermissionDenied",e[e.initializeLocalCobalt_RetriableFailure=245]="initializeLocalCobalt_RetriableFailure",e[e.wordSaveHostTimeout=246]="wordSaveHostTimeout",e[e.wordSaveOcsNonRetriableTimeout=247]="wordSaveOcsNonRetriableTimeout",e[e.hostNetwork_KeepAliveFailure=248]="hostNetwork_KeepAliveFailure",e[e.hostNetwork_NameResolutionFailure=249]="hostNetwork_NameResolutionFailure",e[e.hostNetwork_ConnectFailure=250]="hostNetwork_ConnectFailure",e[e.hostNetwork_ReceiveFailure=251]="hostNetwork_ReceiveFailure",e[e.hostNetwork_SendFailure=252]="hostNetwork_SendFailure",e[e.hostNetwork_ServerProtocolViolation=253]="hostNetwork_ServerProtocolViolation",e[e.hostNetwork_TrustFailure=254]="hostNetwork_TrustFailure",e[e.hostNetwork_SecureChannelFailure=255]="hostNetwork_SecureChannelFailure",e[e.hostNetwork_ConnectionClosed=256]="hostNetwork_ConnectionClosed",e[e.hostNetwork_RequestCanceled=257]="hostNetwork_RequestCanceled",e[e.graphCache_PropertyTransformFailure=258]="graphCache_PropertyTransformFailure",e[e.NSIDToAbsListIdMappingMissing=259]="NSIDToAbsListIdMappingMissing",e[e.convertToOcsbFailed=260]="convertToOcsbFailed",e[e.convertToWPMFailed=261]="convertToWPMFailed",e[e.convertToWPMFallbackFailed=262]="convertToWPMFallbackFailed",e[e.convertToDocxFailed=263]="convertToDocxFailed",e[e.genericSyncDiffFailure=264]="genericSyncDiffFailure",e[e.ocsGateError=265]="ocsGateError",e[e.mocsiError_NoSession=266]="mocsiError_NoSession",e[e.mocsiError_BadWopiSrc=267]="mocsiError_BadWopiSrc",e[e.mocsiError_BadRequest=268]="mocsiError_BadRequest",e[e.mocsiError_Generic=269]="mocsiError_Generic",e[e.ocsAppWorkerError=270]="ocsAppWorkerError",e[e.bootTimeout=271]="bootTimeout",e[e.zeroRsid=272]="zeroRsid",e[e.invalidTableRowCellCount=273]="invalidTableRowCellCount",e[e.AltChunk_HTML=274]="AltChunk_HTML",e[e.ServerLayoutGenerationFailed=275]="ServerLayoutGenerationFailed",e[e.tokenRevoked=276]="tokenRevoked",e[e.dssAutoSaveErrorId_BackupConsidersSelfAsPrimary=277]="dssAutoSaveErrorId_BackupConsidersSelfAsPrimary",e[e.dssAutoSaveErrorId_IAmZombie=278]="dssAutoSaveErrorId_IAmZombie",e[e.dssAutoSaveErrorId_NoResponseObject=279]="dssAutoSaveErrorId_NoResponseObject",e[e.dssAutoSaveErrorId_SaveRequestFailureRetryable=280]="dssAutoSaveErrorId_SaveRequestFailureRetryable",e[e.dssAutoSaveErrorId_SaveRequestFailureTimeout=281]="dssAutoSaveErrorId_SaveRequestFailureTimeout",e[e.dssAutoSaveErrorId_SaveRequestFailureUnknown=282]="dssAutoSaveErrorId_SaveRequestFailureUnknown",e[e.dssAutoSaveErrorId_SaveRequestUnexpectedWcfError=283]="dssAutoSaveErrorId_SaveRequestUnexpectedWcfError",e[e.lineageTombstone_Unknown=285]="lineageTombstone_Unknown",e[e.lineageTombstone_LineageClosed=286]="lineageTombstone_LineageClosed",e[e.lineageTombstone_LineageExpired=287]="lineageTombstone_LineageExpired",e[e.lineageTombstone_PermanentSaveFailure=288]="lineageTombstone_PermanentSaveFailure",e[e.lineageTombstone_VersionRestored=289]="lineageTombstone_VersionRestored",e[e.lineageTombstone_MaxLineageLifetime=290]="lineageTombstone_MaxLineageLifetime",e[e.lineageTombstone_Ctrl24Shutdown=291]="lineageTombstone_Ctrl24Shutdown",e[e.lineageTombstone_NoGraphSessionTombstone=292]="lineageTombstone_NoGraphSessionTombstone",e[e.FixHMergeTableCell=293]="FixHMergeTableCell",e[e.documentCheckoutRequired=294]="documentCheckoutRequired",e[e.fileAlreadyCheckedOutOnServer=295]="fileAlreadyCheckedOutOnServer",e[e.pathNotFound=296]="pathNotFound",e[e.canceledByEventHandler=297]="canceledByEventHandler",e[e.contentApprovalRequired=298]="contentApprovalRequired",e[e.sharePointValidationFailure=299]="sharePointValidationFailure",e[e.duplicateValueFound=300]="duplicateValueFound",e[e.fileAlreadyExists=301]="fileAlreadyExists",e[e.localCobaltLockRequestFail=302]="localCobaltLockRequestFail",e[e.tableAdjustFailure=303]="tableAdjustFailure",e[e.contentControlAdjustFailure=304]="contentControlAdjustFailure",e[e.commentAdjustFailure=305]="commentAdjustFailure",e[e.taskAdjustFailure=306]="taskAdjustFailure",e[e.imageAdjustFailure=307]="imageAdjustFailure",e[e.stylesAdjustFailure=308]="stylesAdjustFailure",e[e.trackChangesAdjustFailure=309]="trackChangesAdjustFailure",e[e.lineageTombstone_ParallelLineageDetected=310]="lineageTombstone_ParallelLineageDetected",e[e.swordValidationFailure=311]="swordValidationFailure",e[e.lineageTombstone_DataInTransitLineageMaxLifetime=312]="lineageTombstone_DataInTransitLineageMaxLifetime",e[e.lineageTombstone_UnviableFeatureDetectedLineageExpired=313]="lineageTombstone_UnviableFeatureDetectedLineageExpired",e[e.lineageTombstone_DataInTransitLineageExpired=314]="lineageTombstone_DataInTransitLineageExpired",e[e.listAdjustFailure=315]="listAdjustFailure",e[e.swordValidationOnOpenFailure=316]="swordValidationOnOpenFailure"}(wa||(wa={})),(0,a.b)("OperationResult",wa);const Ma={KpiName:"Default",KpiType:n(7449).b.SuccessBased,KpiFeatureName:"Default",FcAlias:"wwtotalvisibilityfc",TopLevelKpiName:"Default",AreaName:"Requests",KpiEventBlockingDuringInMs:3e5,EndpointToFeatureNameMapping:new Map([["/we/OneNote.ashx","OneNoteHandler"],["/we/RemoteUls.ashx","RemoteUls"],["/wt/RemoteUls.ashx","RemoteUls"],["/we/RemoteTelemetry.ashx","RemoteTelemetry"],["/wv/ResReader.ashx","ResReader"],["/wv/docdatahandler.ashx","DocDataHandler"]]),FeatureNameFieldNameInExtendedProperties:"FeatureName",SkipAriaFieldNameInExtendedProperty:"SkipAria",ServerVersionFieldNameInExtendedProperty:"ServerVersion",HttpStatusCodeFieldNameInExtendedProperty:"HttpStatusCode"};class ka{recordClientRequest(e){if(!this.featureUsageLogger)return;if(!this.settingsProvider||!this.settingsProvider.isFeatureEnabled())return;const t=this.settingsProvider.getLoggingEndpointList();if(!t||0===t.length)return void k.ULS.sendTraceTag(512255830,383,15,"Failed to get valid endpoint list from settings.");let n;try{n=new URL(e.request.getResolvedUrl())}catch(e){}if(n){if(t.includes(n.pathname)){const t=new Map([[Ma.FeatureNameFieldNameInExtendedProperties,Ma.EndpointToFeatureNameMapping.get(n.pathname)??n.pathname],[Ma.SkipAriaFieldNameInExtendedProperty,"True"]]),a={extendedProperties:t,durationMs:void 0,inStaging:void 0};e.completedTimeTicks>0&&(a.durationMs=e.completedTimeTicks-e.invokedTimeTicks),e.responseHeaders&&t.set(Ma.ServerVersionFieldNameInExtendedProperty,e.responseHeaders["X-OfficeVersion"]);const i=this.extractKpiNameFromRequest(e.request.get_body(),n.pathname);switch(e.status){case 0:{const e={extendedProperties:t,isForAlertableKpi:void 0};i.forEach((t=>{this.featureUsageLogger.logKpiUsage(t,e)}));break}case 2:if(!this.tryLogKpiFromResponse(e,a,n.pathname)){const e={additionalValues:a,hasImpliedUsage:void 0};i.forEach((t=>{this.featureUsageLogger.logKpiSuccess(t,e)}))}break;case 3:case 4:case 5:case 6:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 7:{t.set(Ma.HttpStatusCodeFieldNameInExtendedProperty,e.httpStatus.toString());const n={additionalValues:a,isIntentional:void 0,isInternal:void 0,hasImpliedUsage:void 0};n.isIntentional=10===e.status,i.forEach((t=>{this.featureUsageLogger.logKpiFailure(t,Fa.a[e.status],n)}));break}}}}else k.ULS.sendTraceTag(512255829,383,15,"Failed to parse URL for logging.")}extractKpiNameFromRequest(e,t){if(!t||!e||!this.KpiNamesExtractionLogic.has(t))return[Ma.KpiName];let n;try{const a=this.KpiNamesExtractionLogic.get(t);n=a&&a.call(this,e)}catch(e){}return n||(k.ULS.sendTraceTag(512255828,383,15,"Failed to extract KpiName from request."),[Ma.KpiName])}extractKpiNamesFromServerRequestGroup(e){if(!e?.srs)return[Ma.KpiName];const t=[];for(const n of e?.srs)if(2===n.length){const[e]=n;e&&t.push(Ia.a[e])}else k.ULS.sendTraceTag(512255827,383,15,"Unexpected request group format.");return t.length>0?t:[Ma.KpiName]}tryLogKpiFromResponse(e,t,n){if(!this.LoggingKpiFromResponseLogic.has(n))return!1;const a=e?.responseData;if(!a)return!1;const i=this.LoggingKpiFromResponseLogic.get(n);return i&&i.call(this,a,t)}tryLogKpiFromServerResponseGroup(e,t){if(!e)return!1;const{group:n,returnValue:a}=Ea.a.tryDeserializeServerResponse(e);if(!a||!n)return!1;if(!n.Responses||0===n.Responses.length)return!1;for(const e of n.Responses)if(0===e.StatusCode){const n={additionalValues:t,hasImpliedUsage:void 0};this.featureUsageLogger.logKpiSuccess(Ia.a[e.classId],n)}else{const n={additionalValues:t,isIntentional:void 0,isInternal:void 0,hasImpliedUsage:void 0};this.featureUsageLogger.logKpiFailure(Ia.a[e.classId],wa[e.StatusCode],n)}return!0}constructor(e,t){this.featureUsageLogger=e,this.settingsProvider=t,this.KpiNamesExtractionLogic=new Map([["/we/OneNote.ashx",e=>{const t=JSON.parse(e);return this.extractKpiNamesFromServerRequestGroup(t)}]]),this.LoggingKpiFromResponseLogic=new Map([["/we/OneNote.ashx",(e,t)=>this.tryLogKpiFromServerResponseGroup(e,t)]])}}(0,a.a)(ka,"ClientRequestRecorder",null,[466]);class Pa{logKpiUsage(e,t){const n={kpiName:e,kpiType:Ma.KpiType,optionalProperties:t,blockFutureEmissionDurationInMs:Ma.KpiEventBlockingDuringInMs};this.featureUsageLogger.logKpiUsage(n)}logKpiSuccess(e,t){const n={kpiName:e,optionalProperties:t,blockFutureEmissionDurationInMs:Ma.KpiEventBlockingDuringInMs};this.featureUsageLogger.logKpiSuccess(n)}logKpiFailure(e,t,n){const a={kpiName:e,errorName:t,optionalProperties:n,optionalVeto:null,blockFutureEmissionDurationInMs:Ma.KpiEventBlockingDuringInMs};this.featureUsageLogger.logKpiFailure(a)}constructor(e){this.featureUsageLogger=e}}(0,a.a)(Pa,"ClientRequestKpiLogger",null,[464]);class Da{isFeatureEnabled(){return"Word"===o.AFrameworkApplication.appSettingsManager.getStringAppSetting("Application")&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordIsClientRequestLoggingEnabled")}getLoggingEndpointList(){return o.AFrameworkApplication.appSettingsManager.getListAppSetting("WordClientRequestLoggingEndpointList")}}(0,a.a)(Da,"ClientRequestTelemetrySettingsProvider",null,[465]);class Ra{getKpiName(e,t){return 19===t?`TaskItemID:${t.toString()}:${e}`:e&&Ra.ValidNamePattern.test(e)&&!Ra.DigitsPattern.test(e)?e:`TaskItemID:${t.toString()}`}getNow(){return S.a.supportsPerformanceNow?performance.now():Date.now()}getExtendedProperties(e){const t=new Map;return t.set("TaskItemID",e.taskItemId.toString()),e.name&&Ra.ValidNamePattern.test(e.name)&&t.set("TaskName",e.name),t}onBeforeTask(e){null!=this.featureUsageLogger&&e&&(this._taskStart=this.getNow())}onCrashedTask(e,t){if(null==this.featureUsageLogger||!e)return;const n=this.getExtendedProperties(e);t?.message&&(n.set("ErrorName",t.name??""),n.set("ErrorMessage",t.message??""),n.set("CrashCallstack",t.stack??""));const a=t?Sa.a.getCrashErrorName(t):"UnknownError";this.featureUsageLogger.logKpiFailure(cn.a.getKpiFailureParams(this.getKpiName(e.name,e.taskItemId),a,null!=this._taskStart?this.getNow()-this._taskStart:null,n))}onAfterTask(e){if(null==this.featureUsageLogger||!e)return;const t=this.getExtendedProperties(e);this.featureUsageLogger.logKpiSuccess(cn.a.getKpiSuccessParams(this.getKpiName(e.name,e.taskItemId),null!=this._taskStart?this.getNow()-this._taskStart:null,t))}constructor(e){this.featureUsageLogger=e,this._taskStart=null}}Ra.ValidNamePattern=/^[\w:\-]+$/,Ra.DigitsPattern=/^[\d]+$/,(0,a.a)(Ra,"KpiTaskManagerListener",null,[467]);const xa="TaskManager",La="wwtotalvisibilityfc",Ua="Infrastructure";class Oa{configure(e){e.registerFactory("WordViewer.IWordViewerPostMessenger",(()=>new ta(o.AFrameworkApplication.theActionManager,(0,pe.a)(rn.a),o.AFrameworkApplication.appSettingsManager,le.a.instance))).singleInstance(),e.registerFactory("WordViewer.WordViewerReactCommandDefinitionMapping",(()=>new ra)).as("Common.IExternalUICommandDefinitionMapping").singleInstance();const t=()=>new ln;e.registerFactory("WordViewer.Controls.ZoomControl",(()=>{const{App:a}=n(6921);return new On(a.instance,o.AFrameworkApplication.appSettingsManager,o.AFrameworkApplication.theActionManager,e.resolveLazy("WordViewer.IWordViewerPostMessenger"),bn.a.instance,t)})).as("WordViewer.Controls.IZoomControl").as("Common.IZoomManager").singleInstance(),e.registerFactory("WordViewer.DisplayManager.IDisplayManagerFactory",(()=>{const{App:t}=n(6921);return new Yn(o.AFrameworkApplication.appSettingsManager,o.AFrameworkApplication.theActionManager,e.resolve("WordViewer.IWordViewerPostMessenger"),bn.a.instance,e.resolveLazy("WordViewer.Controls.IZoomControl"),e.resolveLazy("WordViewer.Controls.IScrollControl"),e.resolveFuture("Common.App.Policy.Contracts.IPolicyActor"),t.instance.theConfig,t.instance.theDocument)})).singleInstance(),e.registerFactory("WordViewer.Controls.IScrollControl",(()=>{const{App:t}=n(6921);return new wn(o.AFrameworkApplication.appSettingsManager,o.AFrameworkApplication.theActionManager,b.FocusManager.instance(),bn.a.instance,e.resolveLazy("WordViewer.Controls.IZoomControl"),t.instance.theConfig)})).singleInstance(),e.registerFactory("WordViewer.Controls.INavigationControl",(()=>new _n(o.AFrameworkApplication.theActionManager,b.FocusManager.instance(),bn.a.instance,e.resolveLazy("WordViewer.Controls.IScrollControl")))).singleInstance(),e.registerFactory("WordViewer.Workspace",(()=>new ga(b.FocusManager.instance(),e.resolveLazy("WordViewer.DisplayManager.IDisplayManagerFactory"),e.resolveLazy("WordViewer.Controls.IZoomControl"),e.resolveLazy("WordViewer.Controls.INavigationControl"),e.resolveLazy("WordViewer.Controls.IScrollControl")))).singleInstance(),e.registerFactory("Common.IAppSettingsManager",(()=>o.AFrameworkApplication.appSettingsManager)).singleInstance(),e.registerFactory("Common.ISessionStatus",(()=>lt.a.instance)).singleInstance(),e.register(ma,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().usingFactory((()=>new ma(o.AFrameworkApplication.activeFrame.theFocusManager,o.AFrameworkApplication.activeFrame.theF6Manager,o.AFrameworkApplication.activeFrame.theMouseInputManager,o.AFrameworkApplication.activeFrame.theTouchInputManager,o.AFrameworkApplication.theActionManager))),e.registerFactory("ActionManagerTelemetry.ActionManagerKpiListener",(()=>new ya(cn.a.getInstance({crewAlias:ba,featureName:Aa,vetoPillar:Ta,doNotEmitAggregatedCount:!0})))),e.registerFactory("ClientRequestTelemetry.ClientRequestListener",(()=>new va(new ka(new Pa(cn.a.getInstance({crewAlias:Ma.FcAlias,featureName:Ma.KpiFeatureName,topLevelKpiName:Ma.TopLevelKpiName,vetoPillar:Ma.AreaName})),new Da)))),e.registerFactory("TaskManagerTelemetry.KpiTaskManagerListener",(()=>new Ra(cn.a.getInstance({crewAlias:La,featureName:xa,vetoPillar:Ua,doNotEmitAggregatedCount:!0})))),o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_9029501_AddingAppSettingsSupportToAppComponentConfiguration")&&e.registerFactory("Common.Utils.AriaNotifier",(()=>new dn.a(document.getElementById(this?._settings?.ClientId)))).as("Common.Utils.IAriaNotifier").singleInstance()}constructor(e){this._settings=e}}(0,a.a)(Oa,"AppComponentConfiguration",null,[1]);class Ba extends Ie.a{getBaseDocQuerySignature(){return this.appSettings.BaseDocQueryParam}constructor(e){super(e)}}(0,a.a)(Ba,"WordViewerAppSettingsManager",Ie.a,[]);class Na{constructor(){this.pageSetSize=4,this.pageSetXmlSize=10,this.marginPixels=10,this.pageGapPixels=20,this.pagesToCacheAfter=1,this.pagesToCacheBefore=1,this.searchPaneWidth=270,this.commentPaneWidth=300,this.commentPaneHorizontalBorderWidth=0,this.commentPaneVerticalBorderWidth=0,this.maximumZoom=4,this.minimumZoom=.1,this.dpiAspectRatio=4/3,this.scrollDelay=1,this.scrollOffset=20,this.scrollZone=50,this.scrollMagnitudePerSecond=1e3,this.autoScrollAmount=15,this.selectionTolerance=5,this.keyboardArrowScrollAmount=50,this.searchLookAheadInPagesets=1,this.highlightTaskDelay=25,this.searchTaskDelay=5,this.searchPageIncrement=100,this.searchResultVerticalMultiplier=1.5,this.searchResultHorizontalBuffer=25,this.minCharactersToSearchBeforePausing=200,this.maxParagraphsToSearchBeforePausing=10,this.maxRetryAttempts=22,this.retryIntervalInMSecs=1e3,this.retryIntervalLongInMSecs=2e4,this.retryTimeoutInMSecs=18e4,this.defaultImageDpi=96,this.silverlightURL="https://r.office.microsoft.com/r/rlidWebOfficeSilverlight?clid={0}",this.divLengthLimitInPixels=4e6}}(0,a.a)(Na,"Config",null,[]);class Wa{get contextId(){return En.a.frame}get nextContext(){return null}get isContextSet(){return!1}get isGraphNodeContext(){return!1}}(0,a.a)(Wa,"FrameContext",null,[8]);class Ha{get contextId(){return hn.a.application}get nextContext(){return this._frameContext}get isContextSet(){return!1}get isGraphNodeContext(){return!1}constructor(){this._frameContext=new Wa}}(0,a.a)(Ha,"WordViewerContext",null,[8]);class Va{get pageHeight(){return this._pageHeight}set pageHeight(e){this._pageHeight=e}get pageWidth(){return this._pageWidth}set pageWidth(e){this._pageWidth=e}get startPage(){return this._startPage}set startPage(e){this._startPage=e}get pageCount(){return this._pageCount}set pageCount(e){this._pageCount=e}get top(){return this._top}set top(e){this._top=e}constructor(e,t,n,a,i){this._pageHeight=e,this._pageWidth=t,this._startPage=n,this._pageCount=a,this._top=i}}(0,a.a)(Va,"ASection",null,[]);class Ga{get baseDocQuerySignature(){return o.AFrameworkApplication.appSettingsManager.getBaseDocQuerySignature()}get pageCount(){return this._pageCount}get sectionCount(){return this._sections.length-1}get totalPageHeight(){return this._totalPageHeight}get maxPageWidth(){return this._maxPageWidth}get minPageHeight(){return this._minPageHeight}get hasComments(){return this._hasComments}get isNormalized(){return this._isNormalized}get isProtectedPdf(){return this._isProtectedPdf}getSection(e){return e>=1&&e<this._sections.length?this._sections[e]:null}init(e){const{App:t}=n(6921);if(!e)return void 0;const a=e.selectSingleNode("@dxpInch"),i=e.selectSingleNode("@dypInch"),r=e.selectSingleNode("@pages"),s=parseInt(a.text),l=parseInt(i.text),c=(parseInt(r.text),e.selectSingleNode("@hasComments")),d=e.selectSingleNode("@hasIds"),u=e.selectSingleNode("@isProtectedPdf");if(this._hasComments=!c||Boolean.parse(c.text),this._isNormalized=!!d&&Boolean.parse(d.text),this._isProtectedPdf=!!u&&Boolean.parse(u.text),!t.instance.isPdfMode){const t=new Array(4),n=new Array(4);try{n[0]=e.selectSingleNode("@docHashDw0"),n[1]=e.selectSingleNode("@docHashDw1"),n[2]=e.selectSingleNode("@docHashDw2"),n[3]=e.selectSingleNode("@docHashDw3"),t[0]=parseInt(n[0].text,16),t[1]=parseInt(n[1].text,16),t[2]=parseInt(n[2].text,16),t[3]=parseInt(n[3].text,16)}catch(e){k.ULS.sendTraceTag(5007365,100,15,"Error when parsing dochashDw: {0}",e)}o.AFrameworkApplication.theWsaClient.registerPersistentDocId(t)}const p=e.selectNodes("pageset");let g,h,m,_,S,f,C,y,A,b;for(let e=0;e<p.length;e++){if(g=p[e],h=g.selectSingleNode("@width"),m=g.selectSingleNode("@height"),_=g.selectSingleNode("@count"),S=parseInt(h.text),f=parseInt(m.text),C=parseInt(_.text),A=S/s*96,b=f/l*96,e){const t=this._sections[e];y=t.top+t.pageHeight*t.pageCount}else y=0;this._sections[e+1]=new Va(b,A,this._pageCount+1,C,y),b<this._minPageHeight&&(this._minPageHeight=b),A>this._maxPageWidth&&(this._maxPageWidth=A),this._totalPageHeight+=b*C,this._pageCount+=C}}constructor(){this._hasComments=!1,this._isNormalized=!1,this._isProtectedPdf=!1,this._pageCount=0,this._totalPageHeight=0,this._minPageHeight=Number.MAX_VALUE,this._maxPageWidth=Number.MIN_VALUE,this._sections=[]}}(0,a.a)(Ga,"ADocument",null,[]);var Qa=n(7220);class qa{}qa.clientRequestWithRetry="ClientRequestWithRetry",qa.clipboard="Clipboard",qa.comment="Comment",qa.displayManager="DisplayManager",qa.displayManagerPng="DisplayManagerPng",qa.displayManagerSl="DisplayManagerSl",qa.events="Events (WordViewer)",qa.highlight="Highlight",qa.highlightPng="HighlightPng",qa.highlightSl="HighlightSl",qa.pageInfoCache="PageInfoCache",qa.scrolling="Scrolling",qa.search="Search",qa.searchManager="SearchManager",qa.searchPane="SearchPane",qa.searchWorker="SearchWorker",qa.selection="Selection",qa.selectionXml="SelectionXml",qa.wordViewer="WordViewer",qa.viewerEditorTransition="ViewerEditorTransition",(0,a.a)(qa,"DebugLogCategory",null,[]);var Ka=n(689);class za{addToCache(e,t){const n=Vn.a.getPageSetXmlFromPage(e),a=Vn.a.getPageSetXmlFromPage(t);for(let e=n;e<=a;e++)if(!this._pageInfoList[e-1]){0,this._pagesToRequest.push(e);const t=new se.a(2,1,1,this.requestPage);0,o.AFrameworkApplication.theTaskManager.addTask(t)}}removeFromCache(e,t){const n=Vn.a.getPageSetXmlFromPage(e),a=Vn.a.getPageSetXmlFromPage(t);for(let e=n;e<=a;e++)za.isPageSetInViewingCache(e)||za.isPageSetInSelectionCache(e)||this.isPageSetInSearchCache(e)||(this._pageInfoList[e-1]=null)}isPageSetInSearchCache(e){const{App:t}=n(6921),a=e>=this._firstSearchPageSet&&e<=this._lastSearchPageSet;return t.get_activeAppFrame().workspace.searchActive()&&a}removeSearchCache(){if(!isNaN(this._firstSearchPageSet)&&!isNaN(this._lastSearchPageSet)){const e=n(6921).App.instance.theConfig.pageSetSize,t=this._firstSearchPageSet,a=this._lastSearchPageSet;this._firstSearchPageSet=Number.NaN,this._lastSearchPageSet=Number.NaN,this.removeFromCache(t*e,a*e)}}updateSearchCache(e){const{App:t}=n(6921);if(isNaN(this._firstSearchPageSet)||isNaN(this._lastSearchPageSet)){0;const e=this._pageInfoList.length;return this._firstSearchPageSet=1,this._lastSearchPageSet=Math.min(e,this._firstSearchPageSet+t.instance.theConfig.searchLookAheadInPagesets),void this.addToCache(1,this._lastSearchPageSet*t.instance.theConfig.pageSetXmlSize)}const a=n(6921).App.instance.theConfig.pageSetXmlSize;if(1===a||e%a==1){Vn.a.getPageSetXmlFromPage(e);0;const t=this._pageInfoList.length;this._lastSearchPageSet=Math.min(t,this._lastSearchPageSet+1),this.addToCache(this._lastSearchPageSet*a,this._lastSearchPageSet*a),this.removeFromCache(this._firstSearchPageSet*a,this._firstSearchPageSet*a),this._firstSearchPageSet++}}isPageCached(e){const t=Vn.a.getPageSetFromPage(e);return!!this._pageInfoList[t-1]}buildCache(){const e=Vn.a.getPageSetXmlFromPage(bn.a.instance.pageCount);for(let t=0;t<e;t++)this._pageInfoList.push(null)}getPage(e){const t=this.getTextDataForPage(e);return null===t?null:t.selectSingleNode(String.format("/Pages/Page[@id='{0}']",e))}getXmlForPage(e){const t=Vn.a.getPageSetXmlFromPage(e)-1;if(this._pageInfoList[t]){const n=za.buildXPathForPageXml(e);return this._pageInfoList[t].selectSingleNode(n)}return null}requestSelectionXmlForPageSet(e){const{url:t,headers:n}=Vn.a.getURLAndHeadersForRequest(e);this._urlRequests[t]||(this._urlRequests[t]=!0,o.AFrameworkApplication.theClientRequestManager.addRequest(t,1,null,n,!0,2,this.onItemRequestSucceeded,this.onItemRequestFail,null))}getTextDataForPage(e){const t=Vn.a.getPageSetXmlFromPage(e);return t<=0||t>this._pageInfoList.length||!this._pageInfoList[t-1]?null:this._pageInfoList[t-1]}getCopyableHtmlElementsForQuery(e,t,n,a){const i=this.getTextDataForPage(t);if(!i)return null;const o=i.selectNodes(e),r=[];let s=null;if(1===o.length&&-1!==n&&-1!==a){if(n===a)return r;if(a<n){const e=n;n=a,a=e}}for(let e=0;e<o.length;e++){const t=o[e].parentNode.firstChild,i=o[e].selectSingleNode("ancestor::Table"),l=o[e].selectSingleNode("ancestor::List"),c=o[e].selectSingleNode("ancestor::TextBox");if(t!==o[e]||i||l)if(i){if(i.selectSingleNode("descendant::T")===o[e])s=document.createElement("p"),r.push(s);else{const t=o[e].selectSingleNode("ancestor::TR"),n=o[e].selectSingleNode("ancestor::TD | ancestor::TH");t!==i.firstChild&&n===t.firstChild&&(s=document.createElement("p"),r.push(s))}}else l&&o[e]===t&&(s=document.createElement("p"),r.push(s));else s=document.createElement("p"),r.push(s);if(o[e].childNodes[0]){s||(s=document.createElement("p"),r.push(s));let t=o[e].childNodes[0].nodeValue;-1===n||-1===a||c||(e+1===o.length&&(t=t.substring(0,a)),e||(t=t.substring(n,t.length))),s.innerText+=t}}return r}static isPageSetInViewingCache(e){const t=n(6921).App.get_activeAppFrame().workspace,a=Vn.a.getPageSetXmlFromPage(t.getFirstCachedPage()),i=Vn.a.getPageSetXmlFromPage(t.getLastCachedPage());return e>=a&&e<=i}static isPageSetInSelectionCache(e){const t=n(6921).App.get_activeAppFrame().workspace,a=Vn.a.getPageSetXmlFromPage(t.getFirstSelectedPage()),i=Vn.a.getPageSetXmlFromPage(t.getLastSelectedPage());return e>=a&&e<=i}static buildXPathForPageXml(e){return String.format("/Pages/Page[@id='{0}']",e)}constructor(){this._pageInfoList=[],this._retryRequest=null,this._urlRequests={},this._pagesToRequest=[],this._firstSearchPageSet=Number.NaN,this._lastSearchPageSet=Number.NaN,this.requestPage=e=>{this._pagesToRequest.length>0&&(this.requestSelectionXmlForPageSet(Ft.a.urlForNamedObject(Vn.a.getPageSetXmlName(this._pagesToRequest[0]))),Array.removeAt(this._pagesToRequest,0))},this.onItemRequestSucceeded=e=>{const{App:t}=n(6921);this._urlRequests[e.data.request.get_url()]=!1;let a=e.data.responseXml;if(!a)return void 0;jt.a.isValidResponseXMLDoc(a)||(a=Sys.Net.XMLDOM(e.data.responseData,!0));const i=a.getElementsByTagName("Page");let r=Number.NaN;for(let e=0;e<i.length&&(r=parseInt(i[e].attributes.getNamedItem("id").nodeValue),isNaN(r)||!(r>0));e++);if(isNaN(r))return void 0;const s=n(6921).App.get_activeAppFrame().workspace,l=Vn.a.getPageSetXmlFromPage(r);o.AFrameworkApplication.collectPageStats&&(ce.a.beginMeasurement("RequestSelectionXML",e.data.invokedTime),e.data.responseHeaders["X-CorrelationId"]&&ce.a.addAttribute("c",e.data.responseHeaders["X-CorrelationId"].toString()),e.data.responseHeaders[ce.a.pageStatsResponseXHRHeader]&&ce.a.addServerMeasurements(e.data.responseHeaders[ce.a.pageStatsResponseXHRHeader].toString()),ce.a.endMeasurement("RequestSelectionXML"));if(za.isPageSetInViewingCache(l)||za.isPageSetInSelectionCache(l)||this.isPageSetInSearchCache(l)||t.initialParagraphId){if(this._pageInfoList[l-1])return void 0;0,this._pageInfoList[l-1]=a}const c=Vn.a.getStartPageFromPageSetXml(l),d=Vn.a.getEndPageFromPageSetXml(l);if(o.AFrameworkApplication.theActionManager.processActionWithData(on.a.xmlPageDownloaded,2,new Ka.a(c,d)),o.AFrameworkApplication.theActionManager.processActionWithData(on.a.xmlPageDownloaded2,2,new Ka.a(c,d)),t.initialParagraphId&&o.AFrameworkApplication.theActionManager.processActionWithData(on.a.xmlPageDownloaded3,2,new Ka.a(c,d)),t.instance.copyingEnabled&&za.isPageSetInSelectionCache(l)){let e=!0;const t=Vn.a.getPageSetXmlFromPage(s.getFirstSelectedPage()),n=Vn.a.getPageSetXmlFromPage(s.getLastSelectedPage());for(let a=t-1;a<n;a++)if(!this._pageInfoList[a]){e=!1;break}e&&o.AFrameworkApplication.theActionManager.processAction(on.a.buildClipboard,2)}},this.onItemRequestFail=e=>{if(o.AFrameworkApplication.collectPageStats&&(ce.a.beginMeasurement("RequestSelectionXML",e.data.invokedTime),e.data.responseHeaders["X-CorrelationId"]&&ce.a.addAttribute("c",e.data.responseHeaders["X-CorrelationId"].toString()),ce.a.endMeasurement("RequestSelectionXML")),this._urlRequests[e.data.request.get_url()]=!1,!this._retryRequest){0;const{url:t,headers:n}=Vn.a.getURLAndHeadersForRequest(e.data.request.get_url());this._retryRequest=new Zn.a(this.onRetrySuccessful,t,n),this._retryRequest.send()}},this.onRetrySuccessful=e=>{this._retryRequest=null,this.requestSelectionXmlForPageSet(e.name)},this.printCache=(e,t,a,i,o)=>{const{App:r}=n(6921);for(let e=0;e<this._pageInfoList.length;e++)if(this._pageInfoList[e]){const t=this._pageInfoList[e].getElementsByTagName("Page");for(let e=0;e<t.length;e++){const n=parseInt(t[e].attributes.getNamedItem("id").nodeValue);isNaN(n)||Qa.a.log("XML For Page : "+n+" is loaded",qa.pageInfoCache,2)}}else Qa.a.log("XML For Pages : "+(1+e*r.instance.theConfig.pageSetXmlSize)+"-"+(1+e)*r.instance.theConfig.pageSetXmlSize+" is null",qa.pageInfoCache,2);const s=n(6921).App.get_activeAppFrame().workspace,l=Vn.a.getPageSetXmlFromPage(s.getFirstCachedPage()),c=Vn.a.getPageSetXmlFromPage(s.getLastCachedPage());return Qa.a.log("Viewing cache is pagesets "+l+" to "+c,qa.pageInfoCache,2),Qa.a.log("Search cache is pagesets "+this._firstSearchPageSet+" to "+this._lastSearchPageSet,qa.pageInfoCache,2),32},this.pageSetResized=(e,t,a,i,o)=>{Array.clear(this._pageInfoList),this.buildCache();const r=n(6921).App.get_activeAppFrame().workspace,s=r.getFirstCachedPage(),l=r.getFirstSelectedPage(),c=r.getLastCachedPage(),d=r.getLastSelectedPage();return this.addToCache(s,c),this.addToCache(l,d),32},this.buildCache()}}(0,a.a)(za,"PageInfoCache",null,[]);var ja=n(4951),Za=n(4244),Xa=n(7872),Ja=n(8920);class Ya{onSessionExpiredV2(){Qe.a.logUniqueUsage("0d8d1812;ib10e183"),k.ULS.sendTraceTag(505811426,301,50,"Session Expired for WordViewer, token refresh failed")}onSessionExpired(){Qe.a.logUniqueUsage("0d8d1812;ib10e183"),k.ULS.sendTraceTag(505811425,301,50,"Session Expired for WordViewer")}refreshSessionInfo(){Qe.a.logUniqueUsage("0d8d1812;ib10e183"),k.ULS.sendTraceTag(505811424,301,50,"Session Refreshed for WordViewer"),o.AFrameworkApplication.baseDocQuerySignatureWithoutVersion=Vn.a.getRefreshedQueryString(o.AFrameworkApplication.baseDocQuerySignatureWithoutVersion),o.AFrameworkApplication.appSettingsManager.appSettings.BaseDocQueryParam=Vn.a.getRefreshedQueryString(o.AFrameworkApplication.appSettingsManager.appSettings.BaseDocQueryParam)}}(0,a.a)(Ya,"SessionRefreshEventHandler",null,[]);const $a=10383,ei="pnglarge",ti="WordViewerAccessibilityModeCookie";class ni extends oe{initializeAppResourceLoader(e){let t=null;if("true"===e.UXAutoChunkIsEnabled?t="ac/":"true"===e.IsWebpack5RibbonEnabled?t="wp5/":"true"===e.DynamicBundlesIsEnabled&&(t="true"===e.IsCombinedBundleEnabled?"wcb/":"exp/"),null!==t)if("true"===e.AppChromeOverrideEnabled){const n="true"===e.AppChromeOverrideIsCombinedBundle?"":"webpack/"+t;appResourceLoader.init(Tt.a.resolveScript,e.AppChromeBaseUrlOverride+n,k.ULS.sendTraceTag)}else appResourceLoader.init(Tt.a.resolveScript,e.StaticContentHost+e.CommonScriptsBase+t,k.ULS.sendTraceTag)}get postMessenger(){return this._postMessenger||(this._postMessenger=ue.a.instance.resolve("WordViewer.IWordViewerPostMessenger"))}get resourceTimingLoggerFuture(){return this._resourceTimingLoggerFuture||(this._resourceTimingLoggerFuture=ue.a.instance.resolveFuture("Common.NetworkTiming.IResourceTimingLogger"))}get zoomControl(){return this._zoomControl||(this._zoomControl=ue.a.instance.resolve("WordViewer.Controls.IZoomControl"))}get scrollControl(){return this._scrollControl||(this._scrollControl=ue.a.instance.resolve("WordViewer.Controls.IScrollControl"))}get commandsToHostControlIdsMap(){return this._wordCommandsToHostControlIdsMap}get isAccessiblePdfMode(){return!!this.userMayEnterAccessiblePdfMode&&(this._accessiblePdfModeInitialized||(this._accessiblePdfModeInitialized=!0,this._accessiblePdfModeAppSetting?this._accessiblePdfMode=Boolean.parse(this._accessiblePdfModeAppSetting):(st.a(20300620,301,null!=this.isScreenReaderPresent,"IsScreenReaderPresent was not initialized, defaulting to false"),this._accessiblePdfMode=null!=this.isScreenReaderPresent&&(this.isScreenReaderPresent||Boolean.parse(vt.a.get(ti)||"false"))),this._accessiblePdfMode&&k.ULS.sendTraceTag(20451526,301,50,"Accessible PDF mode enabled for user")),this._accessiblePdfMode)}get pngFormat(){return this._pngFormat}set pngFormat(e){this._pngFormat=e}get highDpiDocToPngBrsIsEnabled(){return this._highDpiDocToPngBrsIsEnabled}set highDpiDocToPngBrsIsEnabled(e){this._highDpiDocToPngBrsIsEnabled=e}get highDpiPdfToPngBrsIsEnabled(){return this._highDpiPdfToPngBrsIsEnabled}set highDpiPdfToPngBrsIsEnabled(e){this._highDpiPdfToPngBrsIsEnabled=e}get zoomPopupDialogIsEnabled(){return this._zoomPopupDialogIsEnabled}set zoomPopupDialogIsEnabled(e){this._zoomPopupDialogIsEnabled=e}get isReactStatusBarEnabled(){return da.a.isReactStatusBarEnabled}get baseDocQueryParam(){return this._baseDocQueryParam}get isCoreMode(){return this._isCoreMode}set isCoreMode(e){this._isCoreMode=e}get isSmallView(){return this._isSmallView}set_isSmallView(e){return this._isSmallView=e,e}get embedPreviewUrl(){return this._embedPreviewUrl}set embedPreviewUrl(e){this._embedPreviewUrl=e}get translationLanguage(){return this._translationLanguage}get translationLanguages(){return this._translationLanguages}get isBinary(){return this._isBinary}get supportsEditing(){return(this._supportsCobalt||this._supportsEditingWithLocks)&&o.AFrameworkApplication.webEditingEnabled&&!this._translationLanguage&&!this.isBroadcastMode&&!o.AFrameworkApplication.protectFile}get accessibleModeEnabled(){return this._accessibleModeEnabled}get userMayEnterAccessiblePdfMode(){return null!=this._userMayEnterAccessiblePdfMode||(this._userMayEnterAccessiblePdfMode=!1,this.accessibleModeEnabled&&(this.isBroadcastMode?k.ULS.sendTraceTag(20451527,301,50,"Accessible PDF mode not allowed: User is in broadcast mode"):this.isPdfMode?k.ULS.sendTraceTag(20451528,301,50,"Accessible PDF mode not allowed: User is in PDF mode"):this.showPrint?pa.a.useReactPdf&&(k.ULS.sendTraceTag(20451531,301,50,"Accessible PDF mode may be entered by user"),this._userMayEnterAccessiblePdfMode=!0):pa.a.useReactPdf?(k.ULS.sendTraceTag(509657667,301,50,"Accessible React PDF mode may be entered by user"),this._userMayEnterAccessiblePdfMode=!0):k.ULS.sendTraceTag(20451530,301,50,"Accessible PDF mode not allowed: Printing is not being shown (document may be protected)"))),this._userMayEnterAccessiblePdfMode}get userCanComment(){return!o.AFrameworkApplication.isEmbedded&&this._supportsCobalt&&!ni.instance.translationLanguage&&!ni.instance.isBroadcastMode&&ni.instance.canCreateComments&&(ni.canEdit||ni.isReviewer)}isInHighContrastMode(){return window&&(window.matchMedia("screen and (-ms-high-contrast: active)").matches||window.matchMedia("screen and (forced-colors: active)").matches)}get copyingEnabled(){const e=o.AFrameworkApplication.protectFile||o.AFrameworkApplication.protectedFile;return this._copyingEnabled&&(!e||o.AFrameworkApplication.enableExtractForProtectedFile)&&!S.a.isIPad&&!this.isProtectedPdf}get isProtectedPdf(){return!!this.theDocument&&this.theDocument.isProtectedPdf}get printingEnabled(){return this._printingEnabled&&!o.AFrameworkApplication.protectFile&&!o.AFrameworkApplication.protectedFile}get showPrint(){return this.printingEnabled&&(!o.AFrameworkApplication.isEmbedded||this._showPrintWhenEmbedded)}get showEmbed(){return this._showEmbed}addEntryToBusinessBar(e,t){return!!ni.get_activeAppFrame().businessBar&&(ni.get_activeAppFrame().businessBar.addEntry(e,t),!0)}addGdprBusinessBarWithCloseCallback(e,t,n,a){if(!ni.get_activeAppFrame().businessBar)return;const i=new Ut.a(null,e,null);i.closeable=!0,i.id=23,i.image=3,i.addLinkWithHandler(t,(()=>{xe.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+n)})),a&&(i.closeHandler=a),ni.get_activeAppFrame().businessBar.addEntry(i,!0)}addGdprBusinessBar(e,t,n){this.addGdprBusinessBarWithCloseCallback(e,t,n,null)}get clientUrl(){return ni.get_activeAppFrame().clientEditDocumentUrl}get officeAppType(){return 3}get officeAppMode(){return 2}get status(){return this._status}set status(e){this._status=e}get activeUserName(){return this._userName}get canCreateComments(){return this._canCreateComments}get fileTypeSupportsCommenting(){return!this.isPdfMode}get isBroadcastMode(){return this._isBroadcastMode}get isPdfMode(){return this._pdfMode}get showReadOnlyBusinessBar(){return!!this.kindOfReadOnlyBusinessBar&&!!this.editMode&&2!==this.editMode}get kindOfReadOnlyBusinessBar(){return 2===o.AFrameworkApplication.appSettingsManager.getIntAppSetting("ShowReadonlyBusinessBar",0)?2:0}get translationFromEditor(){return this._translationFromEditor}get fromReadingView(){return this._fromReadingView}get fromWithinViewerApp(){return this._fromWithinViewerApp}get isTellMeInSharedHeaderEnabled(){return!1}get isSharedHeaderSearchUxEnabled(){return!1}get isOdt(){return this._isOdt}get showLegacyPrintDialogPdfMode(){return this._showLegacyPrintDialogPdfMode}get userCanWriteRelative(){return this._userCanWriteRelative}get userCanSaveAndEditTranslatedDocument(){return!(!this.translationLanguage||o.AFrameworkApplication.protectFile||o.AFrameworkApplication.protectedFile||o.AFrameworkApplication.disableEditIfAndroid||!this.userCanWriteRelative||o.AFrameworkApplication.isUIEmbedMode&&!o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HostSupportsDocRebootFeaturesInOtherMode"))}fastFail(e,t=null){const n=new wt.a,a=new Ja.a;throw a.register(n),this.initializeDefaultErrorHandler(a,e,true),null!=t&&(o.AFrameworkApplication.reportError(t),o.AFrameworkApplication.suppressCrashReportingToBSqm=!0,o.AFrameworkApplication.suppressCrashReportingToWatson=!0),Error.invalidOperation("Unable to load resources for LCID "+e.Lcid)}get editMode(){return!o.AFrameworkApplication.copyAndEditUrl||o.AFrameworkApplication.protectFile||o.AFrameworkApplication.protectedFile?ni.instance.supportsEditing&&ni.get_activeAppFrame().wordEditorUrl?ni.get_activeAppFrame().editNeedsConversion?2:1:0:3}handleEditInBrowser(){switch(this.editMode){case 1:o.AFrameworkApplication.theActionManager.processAction(on.a.switchToEditMode,2);break;case 3:{const e={targetWacAction:"Edit"},t=ni.get_activeAppFrame().getTopParagraphId();t&&(e.wdparams="wd=pid("+t+")"),o.AFrameworkApplication.theActionManager.processActionWithData(Zt.a.copyAndEdit,2,e);break}case 2:o.AFrameworkApplication.theActionManager.processAction(on.a.binaryConvert,2)}}get isReactDialogEnabled(){return!0}setAccessiblePdfModeCookie(e){vt.a.setWithExpiration(ti,e.toString(),30)||k.ULS.sendTraceTag(20267092,301,50,"Failed to set cookie for accessible mode cookie to {0}",e.toString())}updateFullAppSettings(e){super.updateFullAppSettings(e),o.AFrameworkApplication.docPropertiesProvider=new l(e),"true"===e.UserCanWriteRelative&&(this._userCanWriteRelative=!0);const t=e.Scenarios;this._supportsCobalt=t.indexOf(o.AFrameworkApplication.supportsCobaltFlag)>-1,this._supportsEditingWithLocks=t.indexOf(o.AFrameworkApplication.supportsEditingWithLocksFlag)>-1,"false"===e.PrintingEnabled&&(this._printingEnabled=!1),this.appEmbedPreviewUrl=e.AppEmbedPreviewUrl,this._embedPreviewUrl=this.computeEmbedPreviewUrl(o.AFrameworkApplication.hostEmbeddedViewUrl,this.appEmbedPreviewUrl),this._isBroadcastMode&&this.broadcastPostMessageOrigin&&(o.AFrameworkApplication.postMessageOrigin=this.broadcastPostMessageOrigin)}dispose(){this._disposed||(u.a.instance.dispose(),ni.get_activeAppFrame().theMouseInputManager.unregisterHandler(yt.a.mouseDown,this._target,this.propagateMouseDownEventToHost),ni.get_activeAppFrame().theTouchInputManager.unregisterHandler(yt.a.touchStart,this._target,this.propagateTouchEventToHost),this.resourceTimingLoggerFuture.execute((e=>{e.deactivate(!0),e.remove_entriesAvailable(ni.onResourceTimingEntriesAvailable)})),this._target=null,this._disposed=!0,super.dispose())}checkIfStringIsDownloaded(e,t,n){let a=!1;try{t()||(a=!0)}catch(e){a=!0}a&&this.fastFail(e,n)}computeEmbedPreviewUrl(e,t){let n=null;return!o.AFrameworkApplication.isEmbedded&&e&&(n=e,n.toUpperCase().startsWith("HTTP://")?document.URL.toUpperCase().startsWith("HTTPS://")&&(n=t):n.toUpperCase().startsWith("HTTPS://")||(k.ULS.sendTraceTag(5017923,301,15,"HostEmbeddedViewUrl must start with HTTP or HTTPS."),n=null)),n}getDocDataUri(e){let t=null;t=this.highDpiDocToPngBrsIsEnabled&&!this.isPdfMode||this.highDpiPdfToPngBrsIsEnabled&&this.isPdfMode?this.pngFormat:"png";let n=ni.webServiceBase+"docdatahandler.ashx?"+this.theDocument.baseDocQuerySignature+"&type="+t+"&o15=1";const a=new he.a;return a.add("access_token"),a.add("access_token_ttl"),n=me.a.removeParameters(n,a),e&&(n+="&language="+e),""!==this._uiQueryParameter&&(n+="&ui="+this._uiQueryParameter),this.isPdfMode&&(n+="&PdfMode=1"),n}requestDocData(e){if(this.shouldSkipDocDataRequest())return;o.AFrameworkApplication.collectPageStats&&ce.a.beginMeasurement("RequestDocData");const t=this.getDocDataUri(this._translationLanguage);let n=!1;n=jt.a.doRequestWithBodyAndHeaders(t,null,null!==e?{"x-pass":e}:null,null,this.onRequestComplete,ni.get_activeAppFrame().notificationBar,!1),!n&&o.AFrameworkApplication.collectPageStats&&ce.a.endMeasurement("RequestDocData"),re.a.mark(7244),k.ULS.sendTraceTag(556828827,301,50,"DocData request sent from the browser")}shouldSkipDocDataRequest(){return!!S.a.isBingPreview&&(k.ULS.sendTraceTag(6031385,301,50,"Skipping DocData: BingPreview"),!0)}showPasswordDialog(e){1!==ni.get_activeAppFrame().state&&(null==this._passDialog&&(this._passDialog=new nn(ni.fileName,this.passwordDialogDismissCallback)),this._passDialog.start(),null!=e&&this._passDialog.setErrorState(e),k.ULS.sendTraceTag(556828829,301,50,"Password dialog started. Error state: {0}",e))}initNamedObject(e,t,n){Ft.a.initWithExtraUrlParameters(ni.webServiceBase+"ResReader.ashx",t,this.nilUuidStringPng,this.getExtraUrlParamsForNamedObject()),null!=n&&Ft.a.initHeaders(n)}initializeShowDialogTime(){null==this.passwordDialogOpen&&(this.passwordDialogOpen=S.a.supportsPerformanceNow?performance.now():Date.now())}recordPasswordDialogDuration(){if(null!=this.passwordDialogClose&&null!=this.passwordDialogOpen){const e=this.passwordDialogClose-this.passwordDialogOpen;le.a.instance.addMetric(de.a.encryptedPasswordDialogPageDuration,e)}}getExtraUrlParamsForNamedObject(){const e=o.AFrameworkApplication.theClientRequestManager.wacClusterId;return(e?"&waccluster="+e:"")+(this.isPdfMode?"&PdfMode=1":"")}get isReactSharedHeaderUxEnabled(){return super.isReactSharedHeaderUxEnabled&&!o.AFrameworkApplication.hideHeader}handleCannotOpenFileStatus(e,t){this.recordPasswordDialogDuration(),Vn.a.showErrorDialogFromResponseXml(e),Vn.a.propagateError(!0,"InvalidDocData",Vn.a.getCannotOpenFileError(e),CommonUiStrings.CannotOpenFile,t),k.ULS.sendTraceTag(556619094,301,10,"Cannot open file with given docdata response")}initPaths(e){ja.a.wordViewerImageBase=e.WordViewerImageBase,ja.a.wordViewerCssBase=e.WordViewerCssBase,ja.a.wordViewerScriptsBase=e.WordViewerScriptsBase,ja.a.wordViewerScriptsLcidBase=e.WordViewerScriptsLcidBase,ja.a.ribbonImageBase=e.RibbonImageBase,ja.a.ribbonCssBase=e.RibbonCssBase,ja.a.ribbonScriptsBase=e.RibbonScriptsBase,It.a.staticContentHost=e.StaticContentHost,It.a.sharedStaticContentHost=e.SharedStaticContentHost,It.a.staticContentQueryParameter=e.StaticContentQueryParameter,It.a.commonImageBase=e.CommonImageBase,It.a.commonCssBase=e.CommonCssBase,It.a.commonScriptsBase=e.CommonScriptsBase,It.a.commonScriptsLcidBase=e.CommonScriptsLcidBase}initializeDocument(){let e=ni._docData.responseXml;jt.a.isValidResponseXMLDoc(e)||(e=Sys.Net.XMLDOM(ni._docData.responseData,!0));let t=null;if(e&&(t=e.selectSingleNode("/docdata/document")),t){ni.get_activeAppFrame().initializeAll(this._target),ni.instance.status=2;const e=ue.a.instance.resolveFuture(Et.a);e?e.execute((e=>{const t=ue.a.instance.tryResolve("Common.App.IWACAppFeedbackParameters");t?e.initializeWACAppParameters(t):k.ULS.sendTraceTag(557097164,301,15,"initializeDocument: wacAppFeedbackParameters is null")})):k.ULS.sendTraceTag(557097165,301,15,"initializeDocument:  SIF future is null"),1!==ni.initialPageNumber&&this.scrollControl.scrollToPage(ni.initialPageNumber),this.isBroadcastMode&&o.AFrameworkApplication.theActionManager.processAction(on.a.onAppReady,2)}else Vn.a.showErrorDialogFromResponseXml(e),Vn.a.propagateError(!0,"InvalidDocData",Vn.a.getCannotOpenFileError(e),CommonUiStrings.CannotOpenFile)}foundParaIdInPageInfo(e){const t=e.firstPage,n=e.lastPage;let a,i;if(({pageOfPara:i,firstTextrunTop:a}=this.findParagraphInSelectionXml(e)).returnValue){const e=this.zoomControl.currentZoom,t=bn.a.instance.getPageTopAtZoom(i,e),n=Math.round(t+a*e)-40;ni.initialParagraphId=0,isNaN(n)||(ni.initialScrollTop=n)}else{if(!(n>=bn.a.instance.pageCount))return ni.get_activeAppFrame().thePageInfoCache.addToCache(n+1,n+1),!1;ni.initialParagraphId=0,ni.get_activeAppFrame().thePageInfoCache.removeFromCache(t,t)}return!0}findParagraphInSelectionXml(e){let t=1;for(let n=e.firstPage;n<=e.lastPage;n++){const e=ni.get_activeAppFrame().thePageInfoCache.getXmlForPage(n);if(!e)continue;const a=e.selectSingleNode(Za.c(n));if(a&&Za.d(a,40))return t=n,{returnValue:!0,pageOfPara:t,firstTextrunTop:40}}return{returnValue:!1,pageOfPara:t,firstTextrunTop:40}}getSignInParams(){const e=ni.get_activeAppFrame().getTopParagraphId(),t={targetWacAction:"View"};return t.wdparams="wdparaid= "+e,t}getCopyAndEditParams(){const e={targetWacAction:"Edit"},t=ni.get_activeAppFrame().getTopParagraphId();return t&&(e.wdparams="wd=pid("+t+")"),e}getFileNewProperties(){const e=new Mt;return e.createNewDocumentAspxRelativePath=this._wordEditorAppRootUrl+"/",e.flyoutAnchorId="faNew",e.headerButtonId="jbtnNewBlank",e.headerButtonText=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.NewBlank),e.headerButtonTitle=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.NewBlankDescription),e.image32by32=o.AFrameworkApplication.imageClusterPath,e.image32by32Class=zt.c("OLKNewButton_32x32x32"),e.labelText=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.New),e}getFileOpenProperties(){const e=new kt;return e.flyoutAnchorId="faOpen",e.image32by32=o.AFrameworkApplication.imageClusterPath,e.image32by32Class=zt.c("SaveAsWordDocx_32x32x32"),e}createAppSettingsManager(e){return new Ba(e)}enqueueDelayLoadedFiles(){Pt.a.enqueueResourceWithoutEnabling(Dt.a.create(It.a.commonScripts("wacairspaceanimationlibrary.js"),null,null,null,!1,!1,null,!0,this.isHttp2Enabled))}resolveActionId(e){return on.a.getNameFromId(e)||super.resolveActionId(e)}static get instance(){return o.AFrameworkApplication._instance}static get_activeAppFrame(){return o.AFrameworkApplication.activeFrame}static updateUrlForAccessiblePdfMode(e,t){const n=ni.getUrlParametersForAccessiblePdfMode(t);return me.a.addOrReplaceParametersValue(e,n)}static getUrlParametersForAccessiblePdfMode(e){const t=new an.a;return t.add("wdAccPdf",e?"1":"0"),o.AFrameworkApplication.isEmbedded&&(ni.instance.showEmbed||t.add("wdEmbedCode","0"),1!==ni.initialPageNumber&&t.add("wdStartOn",ni.initialPageNumber.toString())),t}static updateUrlForEmbeddedFullScreen(e){const t=new an.a;return t.add("wdEmbedFS","1"),me.a.addOrReplaceParametersValue(e,t)}static reportFirstPageAndRenderTime(){if(o.AFrameworkApplication._reportedRenderTime)return;let e,t=window.g_1stPgLdT;null==t&&(t=new Date);const n=t.getTime();if(p.a.instance.recordContentFetchEnd(n),p.a.instance.recordContentDisplayed(n),p.a.instance.recordWacRenderTimeFromBrowserFetchStart(n),p.a.instance.recordOfficeFrameRequestStart(),void 0!==window.__startTime){const n=window.__startTime;p.a.instance.recordContentFetchStart(n.getTime()),e=t.getTime()-n.getTime()}else e=1e9;if(o.AFrameworkApplication.isNoChrome){let e=-1;void 0!==window.documentClickTime&&(e=window.documentClickTime.getTime(),p.a.instance.recordUserClickedInHostUi(e));let t=-1;void 0!==window.hostInitTime&&(t=window.hostInitTime.getTime(),le.a.instance.addMetric(de.a.officeInitializationTime,t))}o.AFrameworkApplication.theWsaClient.setDw(10600,e)}static isReadyForRibbon(){return 1===ni.instance.status||2===ni.instance.status}static isFirstPageImageDisplayed(){const e=document.getElementById("FirstPageImage");return!!e&&!!e.firstPageDisplayed}get isReactDialogWithLinkToResourceEnabled(){return!0}get customFallbackMessageForPrintDialog(){return CommonUiStrings.WordViewer_DirectPrintDialogFallbackSuggestion}static hideFirstPageImage(){const e=document.getElementById("FirstPageImage");e&&(e.onload="",e.onerror="");const t=document.getElementById("FirstPageContainer");t&&t.parentElement.removeChild(t)}static InitializeHtmlScratchPadProvider(e){Rt.a.initialize(e)}static determineInitialParagraphId(e){let t=null;null!=e.InitialParaId&&(t=e.InitialParaId);let n=0;if(t)try{n=parseInt(t,16)}catch(e){0}return n}static onResourceTimingEntriesAvailable(e,t){for(let e=0;e<t.entries.length;e++){const n=t.entries[e];n.url=me.a.removeParameter(n.url,o.AFrameworkApplication.accessTokenParamName);const a=me.a.removeAllUrlParameters(n.url);("about:blank"===n.url||a.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===a&&"2"===me.a.getParameterValue(n.url,"u"))&&(n.behavior=1)}}static get sessionExpirationManagerFuture(){return(0,pe.h)(xt.a)}constructor(e){super(e,!1),this._disposed=!1,this.nilUuidStringPng="",this._embedPreviewUrl=null,this._isSmallView=!1,this._isCoreMode=!1,this._showPrintWhenEmbedded=!1,this._showEmbed=!1,this._supportsCobalt=!1,this._supportsEditingWithLocks=!1,this._printingEnabled=!0,this._copyingEnabled=!0,this._isBroadcastMode=!1,this._translationFromEditor=!1,this._fromReadingView=!1,this._fromWithinViewerApp=!1,this._pdfMode=!1,this._accessiblePdfMode=!1,this._accessiblePdfModeInitialized=!1,this._showLegacyPrintDialogPdfMode=!1,this._userCanWriteRelative=!1,this._resourceTimingLoggerFuture=null,this._pngFormat=null,this._highDpiDocToPngBrsIsEnabled=!1,this._highDpiPdfToPngBrsIsEnabled=!1,this._zoomPopupDialogIsEnabled=!1,this._zoomControl=null,this._scrollControl=null,this._postMessenger=null,this._passDialog=null,this._wordCommandsToHostControlIdsMap={[Zt.a.close.toString()]:"close",[Zt.a.conversation.toString()]:"conversation",[Zt.a.openInBrowser.toString()]:"ellipsisOpenInBrowser"},this._debugPanel=null,this.isScreenReaderPresent=null,this.appEmbedPreviewUrl=null,this._userMayEnterAccessiblePdfMode=null,this._isOdt=!1,this.broadcastPostMessageOrigin=null,this.passwordDialogOpen=null,this.passwordDialogClose=null,this.propagateMouseDownEventToHost=e=>(this.postMessenger.sendMessage("BrowserEvent",{type:"mousedown",altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1}),!1),this.propagateTouchEventToHost=e=>(this.postMessenger.sendMessage("BrowserEvent",{type:"touchstart",altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1}),!1),this.passwordDialogDismissCallback=e=>{this.requestDocData(e),this.passwordDialogClose=S.a.supportsPerformanceNow?performance.now():Date.now()},this.onFullAppSettingsFailed=()=>{k.ULS.sendTraceTag(7387203,301,10,"Full App Settings failed to download."),Vn.a.showErrorDialog(19,CommonUiStrings.DefaultDialogTitle,CommonUiStrings.NetworkProblemInitialDialogDescription),Vn.a.propagateError(!0,"FullAppSettingsDownloadFailed",19,CommonUiStrings.NetworkProblemInitialDialogDescription)},this.onRequestComplete=(e,t,n)=>{if(this._disposed)return void 0;if(!e)return ni.reportFirstPageAndRenderTime(),Vn.a.showErrorDialog(6,CommonUiStrings.DefaultDialogTitle,CommonUiStrings.NetworkProblemInitialDialogDescription),Vn.a.propagateError(!0,"RequestFailed",6,CommonUiStrings.NetworkProblemInitialDialogDescription),void k.ULS.sendTraceTag(556656210,301,15,"DocData request failed");ni.isFirstPageImageDisplayed()||ni.hideFirstPageImage();let a=n.responseXml;const i=n.responseData;let r=null;if(a&&(jt.a.isValidResponseXMLDoc(a)||(a=Sys.Net.XMLDOM(n.responseData,!0)),r=a.selectSingleNode("/docdata/document")),r){{this.recordPasswordDialogDuration(),ni.instance.status=1,null!=this._passDialog&&this._passDialog.hide();const e=n.request.get_headers()["x-pass"];this.initNamedObject(i,this.theDocument.baseDocQuerySignature,null!==e?{"x-pass":e}:null),this.theDocument.init(r),o.AFrameworkApplication.theWsaClient.setDw(9131,this.theDocument.pageCount);const t=(new Date).getTime()-o.AFrameworkApplication.bootTime;if(o.AFrameworkApplication.theWsaClient.setDw(8867,t),re.a.mark(5051),p.a.instance.recordAppInteractive((new Date).getTime()),!o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogBootPerfMetricsOnAppDisposeIsEnabled")){const e=new se.a(2,1,2e3,(e=>{le.a.instance.log()}),79);o.AFrameworkApplication.theTaskManager.addTask(e)}o.AFrameworkApplication.collectPageStats&&(n.responseHeaders["X-CorrelationId"]&&ce.a.addAttribute("c",n.responseHeaders["X-CorrelationId"].toString()),n.responseHeaders[ce.a.pageStatsResponseXHRHeader]&&ce.a.addServerMeasurements(n.responseHeaders[ce.a.pageStatsResponseXHRHeader].toString()),ce.a.endMeasurement("RequestDocData")),ni.get_activeAppFrame().statusBarUser&&ni.get_activeAppFrame().statusBarUser.setZoomVisibility(!0);const a=new se.a(2,1,1e3,(e=>{Xa.a.translationLanguages.requestTranslationLanguagesAppSetting()}));o.AFrameworkApplication.theTaskManager.addTask(a)}k.ULS.sendTraceTag(556656212,301,50,"Doc data request returned success status"),ni._docData=n,ni.get_activeAppFrame().thePageInfoCache=new za,bn.a.instance.isNormalized&&ni.initialParagraphId?ni.get_activeAppFrame().thePageInfoCache.addToCache(1,1):this.initializeDocument(),k.ULS.sendTraceTag(556828828,301,50,"Doc data response handled successfully")}else switch(ni.reportFirstPageAndRenderTime(),t){case"DocumentIsEncrypted":null!=ni.fileName&&ni.fileName.toLowerCase().endsWith(".docx")?(le.a.instance.addMetric(de.a.isEncryptedPasswordFlow,!0),this.initializeShowDialogTime(),this.showPasswordDialog(null)):this.handleCannotOpenFileStatus(a,t);break;case"IncorrectPasswordForEncryptedDocument":this.showPasswordDialog(Yt.incorrectPassword);break;default:this.handleCannotOpenFileStatus(a,t)}},this.appClose=e=>{this.dispose()},this.xmlPageDownloaded3=(e,t,n,a,i)=>{const o=i;return ni.initialParagraphId&&this.foundParaIdInPageInfo(o)&&this.initializeDocument(),32},this.onFullAppSettingsReady=()=>{this.updateFullAppSettings(o.AFrameworkApplication.appSettingsManager.appSettings),ni.get_activeAppFrame().updateFullSettings(o.AFrameworkApplication.appSettingsManager.appSettings)};const t=(()=>{let e;try{const t=sessionStorage.getItem("wacSettingsOverrides");t&&(e=JSON.parse(t))}catch(e){console.error("Failed to get sessings overrides.",e)}return e})();t&&(e={...e,...t}),Boolean.parse(e.UseCachingUlsHost||"false")&&k.ULS.setUlsHost(new Jt(e.Application||"",!0)),e.HostUrl=e.HostViewUrl,this.initializeAppResourceLoader(e),this.initialize(e),window.g_wordViewerAppConstructed=!0,o.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_9029501_AddingAppSettingsSupportToAppComponentConfiguration")?new Oa(e).configure(ue.a.instance):(new Oa).configure(ue.a.instance),o.AFrameworkApplication.loadTestFrameworkIfRequested(),this.initializeBrowserSqm(e),this._accessibleModeEnabled=Boolean.parse(e.WordViewerAccessibleModeEnabled),this._accessiblePdfModeAppSetting=e.IsAccessiblePdfMode,"true"===e.PdfMode&&(this._pdfMode=!0),"true"===e.TranslationFromEditor&&(this._translationFromEditor=!0),"true"===e.FromReadingView&&(this._fromReadingView=!0),"true"===e.FromWithinViewerApp&&(this._fromWithinViewerApp=!0),o.AFrameworkApplication.canSupportConsumption=en.a.isConsumptionEnabled&&Boolean.parse(e.CanSupportConsumption)||!1,o.AFrameworkApplication.isEmbedded&&(this._isBroadcastMode="true"===e.BroadcastMode),this._translationLanguage=e.TranslationLanguage,this._translationLanguages=e.TranslationLanguages;const n=o.AFrameworkApplication.theWsaClient;if(n&&n.isUserOptedIn()){let e;if(e=o.AFrameworkApplication.isNoChrome?19:this.isBroadcastMode?8:this.translationLanguage?10:this.isPdfMode?15:o.AFrameworkApplication.isEmbedded?14:1,n.setDw(o.AFrameworkApplication.officeApplicationModeDatapointId,e),o.AFrameworkApplication.protectFile||o.AFrameworkApplication.protectedFile){const e=new Array(o.AFrameworkApplication.documentStreamWidth);for(let t=0;t<o.AFrameworkApplication.documentStreamWidth;t++)e[t]=0;e[2]=256,n.addToStreamDw.apply(n,[o.AFrameworkApplication.documentStreamId].concat(e))}}o.AFrameworkApplication.theClientRequestManager||(o.AFrameworkApplication.theClientRequestManager=ft.createAnInstance(o.AFrameworkApplication.userSessionId)),o.AFrameworkApplication.theClientRequestManager.wacClusterId=e.WacCluster,o.AFrameworkApplication.theUlsHost=Kt.createHostAndInitUlsForApp(),o.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady||(o.AFrameworkApplication.appSettingsManager.requestPostBootAppSettings(),o.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady(this.onFullAppSettingsReady),o.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsFailed(this.onFullAppSettingsFailed)),o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordActionManagerKpiLoggingEnabled")&&o.AFrameworkApplication.theActionManager.registerListener(ue.a.instance.resolve("ActionManagerTelemetry.ActionManagerKpiListener")),o.AFrameworkApplication.theClientRequestManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordIsClientRequestLoggingEnabled")&&o.AFrameworkApplication.theClientRequestManager.addRequestStatusListener(ue.a.instance.resolve("ClientRequestTelemetry.ClientRequestListener")),o.AFrameworkApplication.theTaskManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordIsTaskManagerKpiLoggingEnabled")&&void 0!==o.AFrameworkApplication.theTaskManager?.registerListener&&o.AFrameworkApplication.theTaskManager.registerListener(ue.a.instance.resolve("TaskManagerTelemetry.KpiTaskManagerListener")),this.checkIfStringIsDownloaded(e,(()=>WacWordviewerStrings),ea.a.stringsFailedToLoadWordViewer),this.checkIfStringIsDownloaded(e,(()=>CommonUiStrings),ea.a.stringsFailedToLoadCommonUI),"true"===e.WordViewerPdfModePrintShowsLegacyDialog&&(this._showLegacyPrintDialogPdfMode=!0),this._status=0,this.isPdfMode?(Ct.a.documentType=CommonUiStrings.DocumentType_Pdf,Ct.a.documentTypeTitleCase=CommonUiStrings.DocumentType_Pdf,Ct.a.documentTypePlural=CommonUiStrings.DocumentTypePlural_Pdf,Ct.a.subDocumentType=CommonUiStrings.SubDocumentType_Pdf):(Ct.a.documentType=CommonUiStrings.DocumentType_W,Ct.a.documentTypeTitleCase=CommonUiStrings.DocumentTypeTitleCase_W,Ct.a.documentTypePlural=CommonUiStrings.DocumentTypePlural_W,Ct.a.subDocumentType=CommonUiStrings.SubDocumentType_W),Ct.a.richClientNameLong=CommonUiStrings.RichClientNameLong_W,Ct.a.applicationNameOnly=CommonUiStrings.AppNameShort_W,Ct.a.formatResourceStrings(CommonUiStrings),"undefined"!=typeof CommonUIStrings&&Ct.a.formatResourceStrings(CommonUIStrings),Ct.a.formatResourceStrings(WacWordviewerStrings),"true"===e.PerfMarkersEnabled&&re.a.start(),this._canCreateComments=Boolean.parse(e.CanComment),this._userName=e.UserName,this._uiQueryParameter=e.UIParameter,ni.webServiceBase=e.WebServiceBase,this.isCoreMode=Boolean.parse(e.IsCoreMode||"false"),o.AFrameworkApplication._extraErrorInfoFromHost=e.ExtraErrorInfo,this._wordEditorAppRootUrl=e.WordEditorAppRootUrl,this._isBinary=Boolean.parse(e.IsBinary||"false"),this.initPaths(e),o.AFrameworkApplication._unifiedHeaderOfficeOnlineLogoWidth=159,o.AFrameworkApplication.imageClusterName=zt.d,o.AFrameworkApplication.imageClusterPath=ja.a.ribbonImage(o.AFrameworkApplication.imageClusterName+".png"),o.AFrameworkApplication.scriptFolderPath=ja.a.wordViewerScriptsBase,o.AFrameworkApplication.scriptBase="WordViewer.{0}";const a=e.DocumentPermissions||"";ni.canEdit=a.indexOf("W")>-1,ni.isReviewer=a.indexOf("R")>-1,o.AFrameworkApplication.isEmbedded&&(k.ULS.sendTraceTag(18395276,301,50,"Embedded view"),this.set_isSmallView("true"===e.SmallView),this._showPrintWhenEmbedded="true"===e.ShowPrint,this._showPrintWhenEmbedded&&o.AFrameworkApplication.theWsaClient.setBitsOr($a,1),this._showEmbed="true"===e.ShowEmbedCode,this._showEmbed&&o.AFrameworkApplication.theWsaClient.setBitsOr($a,2),o.AFrameworkApplication.theWsaClient.setDw(10380,window.document.documentElement.clientWidth),o.AFrameworkApplication.theWsaClient.setDw(10379,window.document.documentElement.clientHeight)),this._isBroadcastMode&&(this.broadcastPostMessageOrigin=e.BroadcastPostMessageOrigin,o.AFrameworkApplication.postMessageOrigin=this.broadcastPostMessageOrigin),this._target=document.getElementById(e.ClientId),o.AFrameworkApplication.registerFrame(new Hn.AppFrame(this,this._target,e)),this.isAccessiblePdfMode&&(o.AFrameworkApplication.showSplashScreen(!0),ni.hideFirstPageImage()),(o.AFrameworkApplication.isEmbedded||this.isAccessiblePdfMode)&&(ni.initialPageNumber=parseInt(e.InitialPageNumber),isNaN(ni.initialPageNumber)||ni.initialPageNumber<1?ni.initialPageNumber=1:(o.AFrameworkApplication.theWsaClient.setDw(10382,ni.initialPageNumber),o.AFrameworkApplication.theWsaClient.setBitsOr($a,4))),this.initializeDefaultErrorHandler(o.AFrameworkApplication.activeFrame.theErrorHandler,e,true);Boolean.parse(e.ConfigError||"false")&&(Vn.a.showErrorDialog(16,CommonUiStrings.DefaultDialogTitle,CommonUiStrings.ConfigError),Vn.a.propagateError(!0,"ServerConfigError",16,CommonUiStrings.ConfigError)),this.pngFormat=Lt.a.devicePixelRatio>(this.isPdfMode?1.24:ni.DEVICE_PIXEL_RATIO_THRESHOLD_DOC)?ei:"png",this.highDpiDocToPngBrsIsEnabled=Boolean.parse(e.WordViewerHighDpiDocToPngIsEnabled||"false"),this.highDpiPdfToPngBrsIsEnabled=Boolean.parse(e.WordViewerHighDpiPdfToPngIsEnabled||"false"),this.zoomPopupDialogIsEnabled=Boolean.parse(e.ZoomPopupDialogIsEnabled||"false"),ei===this.pngFormat&&(this.isPdfMode&&this.highDpiPdfToPngBrsIsEnabled||!this.isPdfMode&&this.highDpiDocToPngBrsIsEnabled)?this.nilUuidStringPng=e.PngLargeFormatGuid:this.nilUuidStringPng=e.PngFormatGuid,this.theConfig=new Na,o.AFrameworkApplication.appPreloadStatistics&&ce.a.addServerMeasurements(o.AFrameworkApplication.appPreloadStatistics),ce.a.beginRootMeasurement("Load",o.AFrameworkApplication.appInitTime),ce.a.addAttribute("sid",o.AFrameworkApplication.userSessionId),this._baseDocQueryParam=e.BaseDocQueryParam,this.theDocument=new Ga;o.AFrameworkApplication.theActionManager.addActionWithFlags(on.a.xmlPageDownloaded3,hn.a.application,this.xmlPageDownloaded3,97),this.requestDocData(null);const i=new Ha;o.AFrameworkApplication.theActionManager.registerApplication(i),ni.get_activeAppFrame().thePageManager.registerHandler(2,this.appClose,null),ni.get_activeAppFrame().theMouseInputManager.registerHandler(yt.a.mouseDown,this._target,this.propagateMouseDownEventToHost),ni.get_activeAppFrame().theTouchInputManager.registerHandler(yt.a.touchStart,this._target,this.propagateTouchEventToHost),ni.initialParagraphId=ni.determineInitialParagraphId(e),ni.get_activeAppFrame().ribbonUser&&ni.get_activeAppFrame().ribbonUser.poll(),ni.get_activeAppFrame().statusBarUser&&ni.get_activeAppFrame().statusBarUser.poll();const r=e.PageTitle;null!=r&&(document.title=r),MSOJS.ClientUtils.InitUrls(o.AFrameworkApplication.roamingAppsX86RootUrl,o.AFrameworkApplication.roamingAppsControlInstallerUrl,o.AFrameworkApplication.roamingAppsFirefoxExtensionUrl);const s=b.FocusManager.instance().getScope(At.a.mainAppFocusId);At.a.bindWithDoNothingFallback(s,T.a.hashKeyString(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.HK_Save)),Zt.a.doNothing),this.resourceTimingLoggerFuture.execute((e=>{e.configure(30,0),e.add_entriesAvailable(ni.onResourceTimingEntriesAvailable),e.activate()})),this.enqueueDelayLoadedFiles(),this.checkHostCanaryValidityAndRedirectIfNeeded(e.HostViewUrl,ea.a.hostCanaryFailure),u.a.instance.notifyReadyToInit();const l=e.FileName;null!=l&&l.toUpperCase().endsWith(".ODT")&&k.ULS.sendTraceTag(18449630,301,50,"ODT load");const c=e.ModeSwitchTime;null!=c&&le.a.instance.addMetric(de.a.modeSwitchTime,c);const d=e.RedirectionReason;null!=d&&o.AFrameworkApplication.isNoChrome&&le.a.instance.addMetric(de.a.isFallback,"NOBUNDLEINFO"!==d.toUpperCase()?1:0),ni.sessionExpirationManagerFuture.execute((e=>{const t=new Ya;(0,bt.a)()?(e.add_onSessionExpiredV2(t.onSessionExpiredV2),e.add_onTokenRefreshedV2(t.refreshSessionInfo)):e.add_onSessionExpired(t.onSessionExpired)})),p.a.instance.recordAppInitEnd()}}ni.DEVICE_PIXEL_RATIO_THRESHOLD_DOC=1.24,ni.canEdit=!1,ni.isReviewer=!1,ni.interactiveViewIsEnabled=!1,ni.initialParagraphId=0,ni.initialPageNumber=1,ni.initialScrollTop=0,ni.allowUnsafeAppClose=!1,ni._docData=null,ni.fromWithinViewerAppParamName="fromWithinViewerApp",ni.webServiceBase=null,ni.mode=$t.wordViewer,(0,a.a)(ni,"App",oe,[0])},668:function(e,t,n){"use strict";n.r(t),n.d(t,{AppFrame:function(){return co}});var a=n(100),i=n(5149),o=n(625),r=n(4238),s=n(3245),l=n(6808),c=n(3225),d=n(629),u=n(7827),p=n(2219),g=n(680),h=n(9611),m=n(988),_=n(8103);class S extends r.a{get businessBar(){return this._businessBar}set_businessBar(e){return this._businessBar=e,e}get canUseAppAfterAuthLost(){return!1}get uiFontFamily(){return(0,_.a)("UserInterfaceFontName")}get uiFontFamilySemiLight(){return(0,_.a)("UserInterfaceSemiLightFontName")}get uiFontFamilyLight(){return(0,_.a)("UserInterfaceLightFontName")}get uiFontSize(){return(0,_.a)("UserInterfaceFontSize")}get uiSmallFontSize(){return(0,_.a)("UserInterfaceSmallFontSize")}get uiFontSizeReactSmall(){return(0,_.a)("FontSize14")}get uiFontSizeReactLarge(){return(0,_.a)("FontSize26")}get headerLargeFontSize(){return(0,_.a)("HeaderLargeFontSize")}get jewelMenuFontSize(){return(0,_.a)("JewelMenuFontSize")}get jewelSubmenuFontSize(){return(0,_.a)("JewelSubMenuFontSize")}get jewelSubmenuFileNameFontSize(){return(0,_.a)("JewelSubmenuFileNameFontSize")}get jewelSubmenuMainTitleFontSize(){return(0,_.a)("JewelSubMenuMainTitleFontSize")}get dialogTitleFontSize(){return(0,_.a)("UserInterfaceDialogTitleFontSize")}get dialogButtonFontSize(){return(0,_.a)("UserInterfaceDialogButtonFontSize")}get dialogTextFontSize(){return(0,_.a)("UserInterfaceDialogTextFontSize")}get dialogTextLargeFontSize(){return(0,_.a)("UserInterfaceDialogTextLargeFontSize")}get jewelSubmenuMruButtonTitleFontSize(){return(0,_.a)("JewelSubmenuMruButtonTitleFontSize")}get jewelSubmenuFooterButtonFontSize(){return(0,_.a)("JewelSubmenuFooterButtonFontSize")}get uiFontWeightBold(){return(0,_.a)("UserInterfaceFontWeightBold")}get uiTextTranformUpperCase(){return(0,_.a)("UserInterfaceUpperCaseTextTransform")}get taskPaneTitleFontSize(){return(0,_.a)("UserInterfaceTaskPaneTitleFontSize")}dispose(){p.a.stop(),g.a.safeDispose(this._businessBar),this._businessBar=null,g.a.safeDispose(this.thePageManager),this.thePageManager=null,super.dispose()}signInInternal(e){32!==s.AFrameworkApplication.theActionManager.processActionWithData(m.a.signIn,2,e)&&i.ULS.sendTraceTag(4776159,207,15,"SignIn failed")}beginModal(e){super.beginModal(e),e&&d.FocusManager.instance().pushScope(r.a.modalCommandUIFocusId,!1)}endModal(e){super.endModal(e),e&&(s.AFrameworkApplication.isShuttingDown||d.FocusManager.instance().popScope(r.a.modalCommandUIFocusId))}static onBeforeAppClose(e){let t=null;try{t=WacAnimation.Telemetry.GetAnimationSqmStats()}catch(e){0}t&&(s.AFrameworkApplication.theWsaClient.setDw(10486,parseInt(String(Math.round(t[0])))),s.AFrameworkApplication.theWsaClient.setDw(10487,parseInt(String(Math.round(t[1])))),s.AFrameworkApplication.theWsaClient.setDw(10485,parseInt(String(Math.round(t[2])))))}static includeCloseButton(){return!s.AFrameworkApplication.isEmbedded&&(!!s.AFrameworkApplication.closeWindowOnAppClose||!!s.AFrameworkApplication.closeUrl)}constructor(e,t){super(e,t),this._businessBar=null,this.theContextMenuInputManager=l.a.instance,s.AFrameworkApplication.nativeSelectionAndContextMenu||this.theContextMenuInputManager.initializeForElement(this.get_element()),this.thePageManager=new u.a,this.thePageManager.registerHandler(1,S.onBeforeAppClose,null),this.thePageManager.registerHandler(0,(e=>{this.notifyResize()}),null),this.theF6Manager=c.a.instance,p.a.start(this);const n=s.AFrameworkApplication.theActionManager;n.addActionWithFlags(m.a.f6,h.a.frame,(0,o.a)(this.theF6Manager,this.theF6Manager.handleF6,"handleF6"),67584),n.addActionWithFlags(m.a.f6shift,h.a.frame,(0,o.a)(this.theF6Manager,this.theF6Manager.handleF6Shift,"handleF6Shift"),67584),n.addActionWithFlags(m.a.resumeFocusWithDirection,h.a.frame,(0,o.a)(this.theF6Manager,this.theF6Manager.resumeFocusWithDirection,"resumeFocusWithDirection"),67584)}}(0,a.a)(S,"WebAppFrame",r.a,[]);var f=n(5072),C=n(7958),y=n(1891),A=n(5368),b=n(7072),T=n(2544),v=n(1163),w=n(2378),F=n(385),I=n(1057),E=n(2469),M=n(7296),k=n(2280),P=n(8979),D=n(3792);const R=(0,D.b)("CommonUI.ICalloutManager");var x=n(4733),L=n(6012),U=n(7531),O=n(5374),B=n(6094);const N="WACNotificationEntry";class W{get image(){return this._image}set image(e){this._image=e,5!==this._image&&(this.imagePath="")}get imagePath(){return this._imagePath}set imagePath(e){this._imagePath!==e&&(this._imagePath=e,this._imageElement&&(this._imageElement.src=this._imagePath))}get imageAltText(){return this._imageAltText}set imageAltText(e){this._imageAltText!==e&&(this._imageAltText=e,this._imageElement&&(this._imageElement.alt=this._imageAltText))}get toolTip(){return this._toolTip}set toolTip(e){this._toolTip!==e&&(this._toolTip=e,this.htmlElement&&(this.htmlElement.title=this._toolTip))}get displayTimeoutSeconds(){return this._displayTimeoutSeconds}set displayTimeoutSeconds(e){this._displayTimeoutSeconds=e,this._displayTimeoutSeconds>0&&(this._isSticky=!1)}get isSticky(){return this._isSticky}get message(){return this._message}set message(e){this._message!==e&&(this._message=e,this._message&&(this._messageElement.innerText=this._message))}get htmlElement(){return this._htmlElement}get isShowing(){return!!this.htmlElement&&B.a.isInDocument(this.htmlElement)}createElement(e=!0){this._htmlElement=document.createElement("span");const t=!!s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isRegionComposerEnabled;this.htmlElement.className=t?N+" regionComposer":N,this.htmlElement.setAttribute("UNSELECTABLE","on"),this.htmlElement.title=this._toolTip;const n=document.createElement("div");if(n.setAttribute("UNSELECTABLE","on"),n.className="WACNotificationBottomBar",this.htmlElement.appendChild(n),0!==this._image){const e=document.createElement("a");n.appendChild(e);let t=null,a=null;switch(this._image){case 2:t="CancelRequest_16x16x32",a=(0,_.a)("DialogError");break;case 1:t="Risks_16x16x32",a=(0,_.a)("DialogWarning");break;case 3:t="Info_16x16x32",a=(0,_.a)("DialogInfo");break;case 5:t=this._imagePath,a=this._imageAltText}e.appendChild(O.a(16,16,t,"WACNotificationImage",!0,a))}return this._messageElement=document.createElement("span"),this._messageElement.className="WACNotificationMessage",this._messageElement.setAttribute("UNSELECTABLE","on"),e&&(this._messageElement.innerText=this._message),n.appendChild(this._messageElement),this.htmlElement}updateInnerText(e){this._messageElement&&e&&this._messageElement.innerText!==e&&(this._messageElement.innerText=e,this._message=e)}dispose(){this._imagePath=null,this._imageAltText=null,this._message=null,this._imageElement=null,this._messageElement=null,this._htmlElement=null}constructor(e,t){this._imagePath=null,this._imageAltText="",this._toolTip="",this._displayTimeoutSeconds=5,this._image=0,this._imageElement=null,this._messageElement=null,this._htmlElement=null,this._isSticky=t,this._message=e,this.image=1}}(0,a.a)(W,"NotificationBarEntry",null,[124,125,11]);var H=n(872);const V="WACNotificationBar";class G{get calloutManager(){return this._calloutManager||(this._calloutManager=(0,D.j)(R))}get htmlElement(){return this._htmlElement}get isVisible(){return this._visible}set_isVisible(e){if(this._visible!==e)return e?this.attachToTarget():this.detachFromTarget(),this._visible=e,e}addEntry(e){if(!this.calloutManager)return i.ULS.sendTraceTag(37552159,207,100,"The Notification Bar is displaying entries without using the Callout Manager."),void this.addEntryApproved(e);this.htmlElement.childNodes.length>0?this.addEntryApproved(e):(Array.add(this._entriesToAdd,e),this._enteredCalloutManagerQueue||(this._enteredCalloutManagerQueue=!0,i.ULS.sendTraceTag(37552160,207,50,"The Notification Bar enters the Callout Manager queue."),this.calloutManager.enterCalloutManagerQueue(this,(0,o.a)(this,this.onShowApproved,"onShowApproved"))))}onShowApproved(){for(let e=0;e<this._entriesToAdd.length;e++)this.addEntryApproved(this._entriesToAdd[e]);Array.clear(this._entriesToAdd)}createEntry(e,t){return new W(e,t)}addEntryApproved(e){const t=e.createElement(!1);t.setAttribute(b.a.ariaRoleAttribute,b.a.ariaAlertRole),this.htmlElement.appendChild(t),x.a.addNotification(t),this.set_isVisible(!0),e.isSticky||(H.a.setObject(t,"expires",(new Date).getTime()+1e3*e.displayTimeoutSeconds),this._isRetireTaskRunning||(s.AFrameworkApplication.theTaskManager.addTask(this._retireNotificationTask),this._isRetireTaskRunning=!0)),e.updateInnerText(e.message)}removeEntry(e){const t=e.htmlElement;B.a.isInDocument(t)&&x.a.removeNotification(t,null,this.afterRemoveEntry)}onFinishedShowingEntries(){this.calloutManager&&this._enteredCalloutManagerQueue&&!this.htmlElement.childNodes.length&&(i.ULS.sendTraceTag(37552161,207,50,"The Notification Bar exits the Callout Manager queue."),this.calloutManager.exitCalloutManagerQueue(this),this._enteredCalloutManagerQueue=!1)}attachToTarget(){this.htmlElement.style.visibility="visible",U.a.addHandler(this.htmlElement,L.a.selectStart,U.a.cancelEventHandler),s.AFrameworkApplication.activeFrame.add_onResize(this.onResize),this._resizeHandlerAttached=!0,this._contextMenuHandler=this.contextMenuHandler,s.AFrameworkApplication.activeFrame.theContextMenuInputManager.registerHandler(this.htmlElement,this._contextMenuHandler,null),this.updateTop(null)}detachFromTarget(){this.htmlElement.style.visibility="hidden",U.a.removeHandler(this.htmlElement,L.a.selectStart,U.a.cancelEventHandler),this._resizeHandlerAttached&&(s.AFrameworkApplication.activeFrame.remove_onResize(this.onResize),this._resizeHandlerAttached=!1),this._contextMenuHandler&&(s.AFrameworkApplication.activeFrame.theContextMenuInputManager.unregisterHandler(this.htmlElement,this._contextMenuHandler),this._contextMenuHandler=null)}dispose(){this._visible&&this.detachFromTarget(),this._htmlElement=null,this._target=null}constructor(e,t){this._visible=!1,this._isRetireTaskRunning=!1,this._updateTargetTaskPending=!1,this._updateTopTask=null,this._resizeHandlerAttached=!1,this._contextMenuHandler=null,this._calloutManager=null,this._enteredCalloutManagerQueue=!1,this.afterRemoveEntry=e=>{e.element&&e.element.parentNode&&e.element.parentNode.removeChild(e.element),this.onFinishedShowingEntries()},this.retireNotification=e=>{const t=this.htmlElement.childNodes;let n=!0;const a=[],i=(new Date).getTime();for(let e=0;e<t.length;++e){const o=t[e],r=H.a.getObject(o,"expires");r&&(i>r?Array.add(a,o):n=!1)}for(let e=0;e<a.length;++e)this.htmlElement.removeChild(a[e]);n&&(s.AFrameworkApplication.theTaskManager.deleteTask(this._retireNotificationTask),this._isRetireTaskRunning=!1),this.onFinishedShowingEntries()},this.onResize=()=>{this._updateTopTask||(this._updateTopTask=new M.a(4,1,500,this.updateTop,17)),this._updateTargetTaskPending&&s.AFrameworkApplication.theTaskManager.deleteTask(this._updateTopTask),s.AFrameworkApplication.theTaskManager.addTask(this._updateTopTask),this._updateTargetTaskPending=!0},this.updateTop=e=>{this.htmlElement.style.top=(this._target?B.a.parseCssSize(this._target.style.top):0)+2+"px",this._updateTargetTaskPending=!1},this.contextMenuHandler=e=>!0,this._target=t,this._htmlElement=document.createElement("div");const n=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RegionComposerIsEnabled");this.htmlElement.className=n?V+" regionComposer":V,this._retireNotificationTask=new M.a(4,2,2500,this.retireNotification,16),this._entriesToAdd=[],e.insertBefore(this.htmlElement,t)}}(0,a.a)(G,"NotificationBar",null,[315,11]);var Q=n(3299),q=n(1307),K=n(5324),z=n(5970);class j{constructor(){this.icon=0,this.customIconName=null}}(0,a.a)(j,"ToastIconOptions",null,[]);var Z=n(5709);class X extends Z.a{constructor(){super(),this.icon=null,this.hasSpinner=!1}}(0,a.a)(X,"ToastParameters",Z.a,[]);class J{get message(){return this._message}set message(e){this.updateInnerText(e)}get image(){return this._image}set image(e){this._image!==e&&(this._image=e,this.updateEntry())}get imagePath(){return this._imagePath}set imagePath(e){this._imagePath!==e&&(this._imagePath=e,5===this._image&&this.updateEntry())}get displayTimeoutSeconds(){return this._displayTimeoutSeconds}set displayTimeoutSeconds(e){this.isRegistered||(this._displayTimeoutSeconds=e,e<=0&&(this._isSticky=!0))}get isShowing(){return this._isShowing}get isSticky(){return this._isSticky}get hasSpinner(){return this._hasSpinner}set hasSpinner(e){this._hasSpinner!=e&&(this._hasSpinner=e,this.updateEntry())}createElement(e=!0){if(!this.isRegistered){const e=Object.assign(new z.a,{onShow:()=>{this._isShowing=!0}});this.isSticky||(e.expirationOptions=Object.assign(new K.a,{displayTimeoutSeconds:this.displayTimeoutSeconds,onExpire:()=>{this._isShowing=!1,this.dispose()}})),q.a.getNotificationsAPIAsync().then((t=>{const n=t.toast(Object.assign(new X,{message:this._message,icon:this.getIconOptions(),hasSpinner:this._hasSpinner}));return this.id=t.addNotification(n,e),this.registerEntry(this.id,this),this.isRegistered=!0,null}),(e=>(i.ULS.sendTraceTag(51451665,383,15,"Attempt to add toast notification failed: {0}",e),null)))}return null}updateInnerText(e){e!==this._message&&(this._message=e,this.updateEntry())}get htmlElement(){return this._htmlElement}dispose(){this.isRegistered&&q.a.getNotificationsAPIAsync().then((e=>(this.id&&e.removeNotification(this.id),this.unregisterEntry(this.id),null)))}updateEntry(){q.a.getNotificationsAPIAsync().then((e=>(e.updateNotification(this.id,e.toast(Object.assign(new X,{message:this._message,icon:this.getIconOptions(),hasSpinner:this._hasSpinner}))),null)))}getIconOptions(){let e;switch(this.image){case 3:e=1;break;case 5:e=5;break;case 2:e=3;break;case 1:e=2;break;default:return null}const t=Object.assign(new j,{icon:e});if(5===e){if(!this.imagePath)return null;t.customIconName=this.imagePath}return t}constructor(e,t,n,a){this.id=null,this._message=null,this._image=0,this._imagePath=null,this._displayTimeoutSeconds=5,this.isRegistered=!1,this._isShowing=!1,this._hasSpinner=!1,this._htmlElement=null,this.message=e,this._isSticky=t,this.registerEntry=n,this.unregisterEntry=a}}(0,a.a)(J,"ReactNotificationBarEntry",null,[124,125,11]);var Y=n(6362);class ${addEntry(e){this.initializedNotificationsApi.value.then((()=>{e.createElement()}))}removeEntry(e){e.dispose()}get isVisible(){return Y.a.any(this.entryById,((e,t)=>t.isShowing))}createEntry(e,t){return new J(e,t,((e,t)=>{this.entryById[e]=t}),(e=>{delete this.entryById[e]}))}dispose(){}constructor(e,t){this.entryById={};const n=document.createElement("div");n.className="WACNotificationBar",e.insertBefore(n,t),this.initializedNotificationsApi=new Q.a((()=>q.a.getNotificationsAPIAsync().then((e=>(e.initializeToastNotifications(n),e)),(e=>(i.ULS.sendTraceTag(51451664,383,15,"Notifications API not available. Cannot initialize toast notifications: {0}",e),null)))))}}(0,a.a)($,"ReactNotificationBar",null,[315,11]);class ee{static createInstance(e,t,n=!1){return ee._instance=n?new $(e,t):new G(e,t),ee._instance}}ee._instance=null,(0,a.a)(ee,"NotificationBarFactory",null,[]);var te=n(502),ne=n(6566),ae=n(9969),ie=n(4345);class oe{makeStopwatch(e,t){return new ie.a(e,t)}makeAndStartStopwatch(e,t){const n=this.makeStopwatch(e,t);return n.start(),n}bindStopwatchBuilderFactory(e){}}(0,a.a)(oe,"DefaultStopwatchBuilder",null,[146]);class re{makeStopwatch(e,t){return this._factory.makeStopwatch(e,t)}makeAndStartStopwatch(e,t){return this._factory.makeAndStartStopwatch(e,t)}bindStopwatchBuilderFactory(e){this._factory=e()}constructor(){this._factory=new oe}}(0,a.a)(re,"StopwatchBuilder",null,[146]);var se=n(3989),le=n(2518),ce=n(9858),de=n(3323),ue=n(2500),pe=n(1489),ge=n(681),he=n(7128);const me="Shared_BasicClass",_e=e=>{e.element.style.top=""};var Se=n(5278);const fe="WACBusinessBar";class Ce{get htmlElement(){return this._htmlElement}get visible(){return this._visible}set_visible(e){if(this._visible!==e)return this._visible=e,e?this.attachToTarget():this.detachFromTarget(),e}dispose(){this.visible&&this.detachFromTarget(),B.a.clearElementHtml(this.htmlElement),this._htmlElement=null,this._target=null}showEntry(e,t){const n=e.htmlElement||e.createElement();t===this.htmlElement.childNodes.length?this.htmlElement.appendChild(n):this.htmlElement.insertBefore(n,this.htmlElement.childNodes[t]),e.resizeToFit(),this._currentHeight+=e.htmlElement.clientHeight,((e,t,n,a,i)=>{he.WacAirSpace.setAnimationClass(e,me);const o=new ge.a(e);o.animateOpacity(0,1);const r=new pe.a(e);r.animateY(e.clientTop-30,e.clientTop),a?(he.WacAirSpace.moveElementWithoutAnimation(o,null,null),he.WacAirSpace.moveElementWithoutAnimation(r,null,i)):(he.WacAirSpace.animate(o,null,null),he.WacAirSpace.animate(r,null,i));for(let i=n+1;i<t.length;i++){const n=t[i];he.WacAirSpace.setAnimationClass(n,me);const o=new pe.a(n);o.animateY(n.clientTop-e.clientHeight,n.clientTop),a?he.WacAirSpace.moveElementWithoutAnimation(o,null,null):he.WacAirSpace.animate(o,null,null)}})(n,this.htmlElement.childNodes,t,e.animationDisabled,this.onAfterShowEntry),e.showEntryForScreenReader(),this.set_visible(!0)}hideEntry(e){const t=e.htmlElement;if(B.a.isInDocument(t)){this._currentHeight-=e.htmlElement.clientHeight;((e,t,n,a,i)=>{he.WacAirSpace.setAnimationClass(e,me);const o=new ue.a(e);o.animateOpacity(1,0),n?he.WacAirSpace.moveElementWithoutAnimation(o,a,i):he.WacAirSpace.animate(o,a,i);let r=!1;for(let a=0;a<t.length;a++){if(r){const i=t[a];he.WacAirSpace.setAnimationClass(i,me);const o=new pe.a(i);o.animateY(i.clientTop,-e.clientHeight),n?he.WacAirSpace.moveElementWithoutAnimation(o,null,_e):he.WacAirSpace.animate(o,null,_e)}r||t[a]!==e||(r=!0)}})(t,t.parentNode.children,e.animationDisabled,null,this.onAfterHideEntry)}}attachToTarget(){""===this._target.style.top.trim()&&(this._target.style.top=this._target.offsetTop+"px"),this.htmlElement.style.left=this._target.style.left,this.htmlElement.style.top=this._target.style.top,this.htmlElement.style.height="auto",this.htmlElement.style.visibility="visible";const e=Sys.UI.DomElement.getBounds(this.htmlElement);if(this._originalTargetTop=this._target.style.top,this._currentHeight=e.height,this.updateTarget(),s.AFrameworkApplication.activeFrame.add_onResize(this.onResize),U.a.addHandler(this.htmlElement,L.a.selectStart,U.a.cancelEventHandler),this._contextMenuHandler=this.contextMenuHandler,s.AFrameworkApplication.activeFrame.theContextMenuInputManager.registerHandler(this.htmlElement,this._contextMenuHandler,null),d.FocusManager.usable()){const e=d.FocusManager.instance(),t=e.getScope("businessBar");t.parent=r.a.mainAppFocusId;const n=new Se.a((()=>this.htmlElement));n.addValidTag(1),n.addValidTag(2),n.addValidTag(8),e.buildRegionWithDelegate((()=>this.htmlElement),t,n);const a=e.getRegion("businessBar");a.rememberFocusStealers(),a.looped=!0,a.contained=!0;const i=s.AFrameworkApplication.activeFrame.theF6Manager;t.addDispose((()=>{i.deactivateFocus("businessBar")})),i.addF6KeyBindings("businessBar");(n.firstElement||s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactBusinessBarIsEnabled"))&&i.activateFocus("businessBar")}}detachFromTarget(){if(this.shouldUpdateTargetTop()&&(this._target.style.top=this._originalTargetTop),this.htmlElement.style.visibility="hidden",s.AFrameworkApplication.activeFrame){if(d.FocusManager.usable()){d.FocusManager.instance().removeScope("businessBar")}this._contextMenuHandler&&(s.AFrameworkApplication.activeFrame.theContextMenuInputManager.unregisterHandler(this.htmlElement,this._contextMenuHandler),this._contextMenuHandler=null)}U.a.removeHandler(this.htmlElement,L.a.selectStart,U.a.cancelEventHandler)}updateTarget(){this.shouldUpdateTargetTop()&&this.visible&&((e,t,n,a)=>{const i=B.a.parseCssSize(e.style.top);he.WacAirSpace.setAnimationClass(e,me);const o=new pe.a(e);o.animateY(i,t),he.WacAirSpace.animate(o,n,a)})(this._target,this._currentHeight+this._targetOffset,null,null)}shouldUpdateTargetTop(){return!this._isRegionComposerEnabled&&!this._businessBar.displayOverTarget}constructor(e,t,n){this._visible=!1,this._currentHeight=0,this._originalTargetTop=null,this._contextMenuHandler=null,this.onAfterShowEntry=e=>{e.element.style.top="",s.AFrameworkApplication.activeFrame.notifyResize()},this.onAfterHideEntry=e=>{e.element.parentNode.removeChild(e.element),this.htmlElement.hasChildNodes()||this.set_visible(!1),s.AFrameworkApplication.activeFrame.notifyResize()},this.onResize=()=>{const e=this._businessBar.entries.length,t=Sys.UI.DomElement.getBounds(this.htmlElement).height;let n;for(let t=0;t<e;++t)n=this._businessBar.entries[t],n.htmlElement&&n.resizeToFit();this._currentHeight=Sys.UI.DomElement.getBounds(this.htmlElement).height,t!==this._currentHeight&&this.updateTarget()},this.contextMenuHandler=e=>!0,this._target=e,this._targetOffset=t,this._businessBar=n;const a=e.ownerDocument;this._htmlElement=a.createElement("div"),this.htmlElement.className=fe,this._isRegionComposerEnabled=!!s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isRegionComposerEnabled,this._isRegionComposerEnabled&&!this._businessBar.displayOverTarget&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer"),this.htmlElement.id=fe,v.a.isFirefox&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}}var ye;(0,a.a)(Ce,"BusinessBarDom",null,[191,11]),function(e){e[e.none=0]="none",e[e.corruptPage=1]="corruptPage",e[e.currentPageStatus=2]="currentPageStatus",e[e.documentMarkedAsFinal=3]="documentMarkedAsFinal",e[e.documentSigned=4]="documentSigned",e[e.fileAccess=5]="fileAccess",e[e.kickoutWithDataLoss=6]="kickoutWithDataLoss",e[e.lostSession=7]="lostSession",e[e.malformedHyperlinkUris=8]="malformedHyperlinkUris",e[e.odt=9]="odt",e[e.readonlyRecommended=10]="readonlyRecommended",e[e.saveReplaySuccess=11]="saveReplaySuccess",e[e.saveReplayFailed=12]="saveReplayFailed",e[e.unsupportedObjects=13]="unsupportedObjects",e[e.word11Compat=14]="word11Compat",e[e.unsupportedBrowser=15]="unsupportedBrowser",e[e.applicationNotification=16]="applicationNotification",e[e.skypeDocChatFailed=17]="skypeDocChatFailed",e[e.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo",e[e.sessionExpired=19]="sessionExpired",e[e.irmPolicyDescription=20]="irmPolicyDescription",e[e.policyWarningMessage=21]="policyWarningMessage",e[e.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled",e[e.gdprPrivacyNotice=23]="gdprPrivacyNotice",e[e.datacenterDecommissionWarning=24]="datacenterDecommissionWarning",e[e.graphMergePrompt=25]="graphMergePrompt",e[e.readOnlyDocument=26]="readOnlyDocument",e[e.dictationSilence=27]="dictationSilence",e[e.autoSensitivityLabel=28]="autoSensitivityLabel",e[e.recommendedSensitivityLabel=29]="recommendedSensitivityLabel",e[e.dictationDebugInfo=30]="dictationDebugInfo",e[e.oneNoteCovid19Message=31]="oneNoteCovid19Message",e[e.citationStylePrompt=32]="citationStylePrompt",e[e.oneNoteViewModeMessage=33]="oneNoteViewModeMessage",e[e.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading",e[e.oneNotePagePrintReady=35]="oneNotePagePrintReady",e[e.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled",e[e.mandatoryLabel=37]="mandatoryLabel",e[e.policyTip=38]="policyTip",e[e.minorVersionLimit=39]="minorVersionLimit",e[e.testEntry1=40]="testEntry1",e[e.testEntry2=41]="testEntry2",e[e.testEntry3=42]="testEntry3",e[e.testEntry4=43]="testEntry4",e[e.testEntry5=44]="testEntry5",e[e.testEntry6=45]="testEntry6",e[e.testEntry7=46]="testEntry7",e[e.syntexContractsWarning=47]="syntexContractsWarning",e[e.cookieRefresh=48]="cookieRefresh",e[e.irmPolicyCausedReadOnlyDocument=49]="irmPolicyCausedReadOnlyDocument",e[e.dataLossWarning=50]="dataLossWarning",e[e.editInInteractiveReadOnlyWarning=51]="editInInteractiveReadOnlyWarning"}(ye||(ye={})),(0,a.b)("BusinessBarId",ye);class Ae{initializePriorityMap(e){if(!e)return;this._priorityMap={};const t=e.ranking;for(let e=0;e<t.length;e++)this._priorityMap[ye[t[e]]]=e}dispose(){this._businessBarDom.dispose(),g.a.safeDisposeArray(this._entries),this._entries=null}get htmlElement(){return this._businessBarDom.htmlElement}get visible(){return this._businessBarDom.visible}get displayOverTarget(){return this._displayOverTarget}set displayOverTarget(e){this._displayOverTarget=e}get isReactBusinessBarStoreInitialized(){return this._isReactBusinessBarStoreInitialized}set isReactBusinessBarStoreInitialized(e){this._isReactBusinessBarStoreInitialized=e}get entries(){return this._entries}set entries(e){this._entries=e}isEntryExistent(e){for(let t=0;t<this._entries.length;t++)if(this._entries[t].id===e)return!0;return!1}addEntry(e,t=!1,n=null,a=null,o=null){e.businessBar=this;let r=this.getIndexForNewEntry(e.id);t&&!this._priorityMap&&(r=0),r<Ae.maxBarsVisible&&(this._businessBarDom.showEntry(e,r),this._entries.length>=Ae.maxBarsVisible&&this._businessBarDom.hideEntry(this._entries[Ae.maxBarsVisible-1]),this._businessBarDom.updateTarget()),Array.insert(this._entries,r,e),i.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",ye[e.id],void 0===e.containerID||null===e.containerID?"":e.containerID),e.errorCode&&s.AFrameworkApplication.reportError(e.errorCode,n,a,o)}removeEntry(e){const t=Array.indexOf(this._entries,e);-1!==t&&t<Ae.maxBarsVisible&&(this._entries.length>Ae.maxBarsVisible&&this._businessBarDom.showEntry(this._entries[Ae.maxBarsVisible],Ae.maxBarsVisible),this._businessBarDom.hideEntry(e),this._businessBarDom.updateTarget()),Array.remove(this._entries,e),e.businessBar=null,e.dispose()}getIndexForNewEntry(e){if(!this._priorityMap)return this._entries.length;if(0===e)return this._entries.length;const t=this._priorityMap[ye[e]];if(null==t)return this._entries.length;for(let e=0;e<this._entries.length;e++)if(t<this._priorityMap[ye[this._entries[e].id]])return e;return this._entries.length}constructor(e,t=0,n=null,a=null){this._displayOverTarget=!1,this._isReactBusinessBarStoreInitialized=!1,this._priorityMap=null,this._entries=[],this._businessBarDom=a||new Ce(e,t,this),this.initializePriorityMap(n)}}Ae.maxBarsVisible=2,(0,a.a)(Ae,"BusinessBar",null,[21,11,22]);var be=n(9267),Te=n(8326),ve=n(5325),we=n(7646);const Fe=(e,t)=>{const n={};return n[we.a.previousSessionParamName]=s.AFrameworkApplication.userSessionId,n[s.AFrameworkApplication.modeSwitchTimeParamName]=t.toString(),e.sendMessage("UI_Edit",n)?32:(i.ULS.sendTraceTag(5023452,204,10,"SendForEditModeAction failed"),8)};var Ie=n(6534),Ee=n(6677),Me=n(6798);class ke{get actionManager(){return this._actionManager}get focusManager(){return this._focusManager}areReady(){return this._isFullAppSettingsReady&&!!this.officeTrialExperience&&!!this.macOfficeOffer}waitForReady(e,t,n=null){this.theAppSettingsManager.invokeOrRegisterOnFullAppSettingsReady((()=>{i.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready"),this._isFullAppSettingsReady=!0,this.executeCallbackWhenReady(e,t)})),(0,D.h)(Ee.a).execute((n=>{i.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready"),this.officeTrialExperience=n,this.executeCallbackWhenReady(e,t)})),(0,D.h)(Me.a).execute((n=>{i.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready"),this.macOfficeOffer=n,this.executeCallbackWhenReady(e,t)}))}executeCallbackWhenReady(e,t){ke._callbackExecuted||(this.areReady()?(i.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),e(this,t),ke._callbackExecuted=!0):i.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}constructor(e,t,n,a=!1){this.theAppSettingsManager=e,this._isFullAppSettingsReady=this.theAppSettingsManager.isFullAppSettingsReady,this.officeTrialExperience=(0,D.j)(Ee.a),this.macOfficeOffer=(0,D.j)(Me.a),ke._callbackExecuted=!1,this.isPasteOptionsEnable=a,this._actionManager=t,this._focusManager=n}}ke._callbackExecuted=!1,(0,a.a)(ke,"RibbonDependencies",null,[196]);var Pe=n(8258),De=n(6996),Re=n(3911),xe=n(3696),Le=n(6127);class Ue{showInitialScreen(e,t){const n=new xe.StandardDialog;n.buttonsOption=3,n.setButtonText(1,(0,_.a)("ConversionButton")),n.setButtonText(2,t);const a=String.format("{0} {1}",(0,_.a)("ConversionDialogLine1"),(0,_.a)("ConversionDialogLine2"));n.messageBox((0,_.a)("ConversionDialogTitle"),a,3,e)}showInitialScreenPdf(e){const t=new xe.StandardDialog;t.buttonsOption=1,t.setButtonText(1,(0,_.a)("ConversionButton")),t.messageBox((0,_.a)("ConversionDialogTitle"),(0,_.a)("ConversionDialogPdf"),3,e)}showProgressDialog(){const e=new Le.a;this._progressDialog=e.create(),this._progressDialog.buttonsOption=5,this._progressDialog.message=(0,_.a)("ConversionProgressString"),this._progressDialog.showProgressDialog((0,_.a)("ConversionDialogTitle"),null,null)}dismissWaitUI(){this._progressDialog.close(),this._progressDialog=null}showErrorUI(e,t,n,a,i=!1){if(1!==s.AFrameworkApplication.activeFrame.state){const o=new xe.StandardDialog;let r="";a?(o.buttonsOption=6,o.setButtonText(0,(0,_.a)("DialogClose")),r=i?n:(0,_.a)("ErrorDialogMessage")):(o.buttonsOption=1,o.setButtonText(1,t),o.setButtonText(0,(0,_.a)("DialogClose")),r=String.format("{0} {1}",i?n:(0,_.a)("ConversionErrorMessage1"),(0,_.a)("ConversionErrorMessage2"))),s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReportConversionFailedErrorUnderAdditionalVetoes")?s.AFrameworkApplication.reportError(3,void 0,["NonDismissibleDialog"]):s.AFrameworkApplication.reportError(3),o.messageBox((0,_.a)("ConversionDialogTitle"),r,2,a?null:e)}}constructor(){this._progressDialog=null}}(0,a.a)(Ue,"BinaryConversionUI",null,[]);var Oe=n(1333),Be=n(9823),Ne=n(1520);class We{hideOpenButton(){return 32!==s.AFrameworkApplication.theActionManager.processAction(Re.a.openInClient,1)}showSuccessUI(){if(1!==s.AFrameworkApplication.activeFrame.state){const e=new xe.StandardDialog;e.buttonsOption=4,e.setButtonText(2,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.Edit)),e.setButtonText(1,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.View));const t=String.format("{0} {1}",CommonUiStrings.ConversionSucceded1,CommonUiStrings.ConversionSucceded2);e.messageBox(CommonUiStrings.ConversionDialogTitle,t,0,this.onNavigate)}}showConvertedFileExistsUI(){if(1!==s.AFrameworkApplication.activeFrame.state){const e=new xe.StandardDialog;e.buttonsOption=3,e.setButtonText(1,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.View)),e.setButtonText(2,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.Edit)),e.setButtonText(0,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.Close)),e.showError(8,CommonUiStrings.ConversionDialogTitle,CommonUiStrings.ConversionFileExists,this.onStandardDialog)}}static launch(){new We}static openInRichClient(){s.AFrameworkApplication.theActionManager.processAction(Re.a.openInClient,2)}static errorDialogHandler(e,t){1===e&&We.openInRichClient()}constructor(){this._editUrl=null,this._viewUrl=null,this.initialDialogHandler=(e,t)=>{const{App:a}=n(6921);if(1===e){this._binaryConversionUi.showProgressDialog();let e=n(6921).App.webServiceBase+"docdatahandler.ashx?"+n(6921).App.instance.theDocument.baseDocQuerySignature+"&type=docx&o15=1";const t=new Ne.a;t.add("access_token"),t.add("access_token_ttl"),e=ae.a.removeParameters(e,t),a.instance.isPdfMode?(e+="&PdfMode=1",i.ULS.sendTraceTag(18411874,301,50,"PDF conversion start.")):i.ULS.sendTraceTag(18411875,301,50,"Binary conversion start."),Oe.a.doRequest(e,this.onRequestComplete,a.get_activeAppFrame().notificationBar)}else 2===e&&We.openInRichClient()},this.onRequestComplete=(e,t,n)=>{if(this._binaryConversionUi.dismissWaitUI(),e&&"Success"===t||"ConvertedFileExists"===t){0;const e=n.responseXml.selectSingleNode("/docdata/editUrl"),a=n.responseXml.selectSingleNode("/docdata/viewUrl");if(!e||!a){const e="Unexpected null edit or view url in response!";return this._binaryConversionUi.showErrorUI(We.errorDialogHandler,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.OpenInWord),n.responseData,this.hideOpenButton()),void Be.a.propagateError(!1,"BinaryConversionFailed",3,e)}this._editUrl=e.text,this._viewUrl=a.text,"Success"===t?(i.ULS.sendTraceTag(18411904,301,50,"Binary conversion success."),this.showSuccessUI()):(i.ULS.sendTraceTag(18411905,301,50,"Converted file already exists."),this.showConvertedFileExistsUI(),Be.a.propagateError(!1,"ConvertedFileExists",8,CommonUiStrings.ConversionFileExists))}else{const e=String.format("Binary Conversion failed: {0}",t||"No status");i.ULS.sendTraceTag(18990600,301,10,e),this._binaryConversionUi.showErrorUI(We.errorDialogHandler,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.OpenInWord),n.responseData,this.hideOpenButton()),Be.a.propagateError(!1,"BinaryConversionFailed",3,e)}},this.onStandardDialog=(e,t)=>{this.onNavigate(e,t)},this.onNavigate=(e,t)=>{const n=2===e,a=1===e;if(!n&&!a)return;let o=!1,r=!1,l=!1;s.AFrameworkApplication.appSettingsManager&&(o=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsUIEmbedMode"),r=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"),l=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UiHostSupportsConvertScenarios"));const c=String.format("BinaryConversion. Open converted document in editMode {0} IsEnabledForUiHost {1} uiHostSupportsDocRebootFeature {2}\r\n\t\t\t UiHostSupportsConvertScenarios {3}",n,o,r,l);if(i.ULS.sendTraceTag(591541397,301,50,c),o&&r&&l){i.ULS.sendTraceTag(591541398,301,50,"BinaryConversion: Sending DocumentRefresh post message.");const e={rebootMode:"1"};e.documentUrl=n?this._editUrl:this._viewUrl,e.mode=n?"edit":"view",e.reason="convert",s.AFrameworkApplication.get_hostPostmessengerFuture().execute((t=>{t.sendMessage("App_DocReboot",e)}))}else{const e=window.top;n?e.location.href=this._editUrl:a&&(e.location.href=this._viewUrl)}};const{App:e}=n(6921);this._binaryConversionUi=new Ue,e.instance.isPdfMode?this._binaryConversionUi.showInitialScreenPdf(this.initialDialogHandler):this._binaryConversionUi.showInitialScreen(this.initialDialogHandler,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.OpenInWord))}}(0,a.a)(We,"BinaryConversionManager",null,[]);var He=n(9214),Ve=n(4378),Ge=n(3429),Qe=n(415),qe=n(3116);class Ke{static registerActions(){const e=[new He.a(m.a.showCommentPane,Qe.a.application,0),new He.a(Re.a.toggleCommentPane,Qe.a.application,0)];Ve.a.enqueueActions(e,Ge.a.create("dll1",null,(()=>n.e(2).then(n.bind(n,6694)))))}static get hideCommentsButtonFromRibbon(){const e=n(6921).App.instance;if(e){const t=!e.fileTypeSupportsCommenting||!e.userCanComment&&!s.AFrameworkApplication.useRedeemForCommentingPostMessage,a=!qe.a.instance.hasComments&&n(6921).App.instance.accessibleModeEnabled;return t||a}return!1}}(0,a.a)(Ke,"CommentManagerStub",null,[]);var ze=n(3152),je=n(4606),Ze=n(637),Xe=n(8315);class Je{setReactToolbarControlIds(e,t,n){if(this._reactCommandDefinitionMapping){const a=this._reactCommandDefinitionMapping.getExternalUxIdsByLegacyControlId(t);if(a&&a.count>0)for(const t of a)e[t]=n;else e[t]=n}}poll(){this._reactToolbar&&this._reactToolbar.poll()}static get isReactToolbarEnabled(){return s.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled}constructor(e,t,n){this._reactCommandDefinitionMapping=k.a.instance.tryResolve("WordViewer.WordViewerReactCommandDefinitionMapping");const a={};for(const e in t){const n={key:e,value:t[e]};this.setReactToolbarControlIds(a,n.key,n.value)}this._reactToolbar=new Ze.a(e,Object.assign(new Xe.a,{trimmedIds:null,whitelistedControlIds:a,updateRibbonControls:(e,t)=>n.reactRibbonRootPoller.pollForStateAndUpdateCommands(e,t),isViewer:!0,statusBarId:"WordViewerToolbar"}))}}(0,a.a)(Je,"ReactToolbar",null,[]);class Ye{constructor(e){const t=n(6921).App.get_activeAppFrame();if(!t.businessBar)return;const a=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DefaultToViewerDueToCogsTitle),i=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DefaultToViewerDueToCogsMessage),o=new be.a(a,i,null);o.closeable=!0,o.image=3,o.addButton(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DefaultToViewerButtonText),t.navigateToEditor,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DefaultToViewerButtonText)),t.businessBar.addEntry(o,!0)}}(0,a.a)(Ye,"ReadOnlyBusinessBar",null,[]);var $e,et=n(9800),tt=n(5401),nt=n(6101),at=n(8555),it=n(7445),ot=n(8281);class rt extends ot.a{get ControlType(){return 11}get Type(){return 0}constructor(){super(),this.Command=null,this.QueryCommand=null,this.Alt=null,this.Role=null,this.LabelText=null,this.MenuItemId=null,this.InnerHTML=null,this.ShouldSetTitle=null,this.VerticalCenterAlign=null,this.Image=null,this.ImageClass=null,this.IsDisabled=null}}(0,a.a)(rt,"GalleryButtonProps",ot.a,[]),function(e){e[e.UnspecifiedGallery=0]="UnspecifiedGallery",e[e.CharacterCodeGallery=1]="CharacterCodeGallery",e[e.FontStyleGallery=2]="FontStyleGallery",e[e.InkThicknessGallery=3]="InkThicknessGallery",e[e.IconGallery=4]="IconGallery",e[e.ListGallery=5]="ListGallery",e[e.TableStyleGallery=6]="TableStyleGallery",e[e.PageNumberGallery=7]="PageNumberGallery",e[e.ChangeColorsGallery=8]="ChangeColorsGallery"}($e||($e={})),(0,a.b)("GalleryType",$e);class st{constructor(){this.disabled=null,this.hidden=null,this.style=null,this.title=null}}(0,a.a)(st,"CommonGalleryButtonProps",null,[]);class lt extends st{constructor(){super(),this.tableCellStyles=null,this.tableStyles=null,this.columns=0}}(0,a.a)(lt,"AdditionalTableStyleGalleryButtonProps",st,[]);class ct extends lt{constructor(){super()}}(0,a.a)(ct,"AdditionalChangeColorsGalleryButtonProps",lt,[]);class dt extends st{constructor(){super(),this.character=null}}(0,a.a)(dt,"AdditionalCharacterCodeGalleryButtonProps",st,[]);class ut extends st{constructor(){super(),this.styleDisplayName=null,this.previewStyleLabel=null,this.previewStyleFontNameAndSize=null,this.menuModel=null}}(0,a.a)(ut,"AdditionalFontStyleGalleryButtonProps",st,[]);class pt{constructor(){this.disabled=null,this.hidden=null,this.sections=null,this.selectedId=null,this.columns=0,this.level=0,this.styles=null,this.galleryType="TableStyleGallery",this.contextMenuMap=null}}(0,a.a)(pt,"AdditionalGalleryProperties",null,[]);class gt extends st{constructor(){super(),this.icon=null,this.label=null,this.fullIconStyle=null,this.previewIconStyle=null,this.keytip=null,this.role=null,this.largeFullIconStyle=null,this.largePreviewIconStyle=null}}(0,a.a)(gt,"AdditionalIconButtonProperties",st,[]);class ht extends st{constructor(){super(),this.styleDisplayName=null}}(0,a.a)(ht,"AdditionalInkThicknessGalleryButtonProps",st,[]);class mt extends st{constructor(){super(),this.infoAtLevel=null,this.ariaLabel=null}}(0,a.a)(mt,"AdditionalListGallerButtonProps",st,[]);class _t extends st{constructor(){super(),this.text=null}}(0,a.a)(_t,"AdditionalPageNumberGalleryButtonProps",st,[]);var St=n(869),ft=n(2666),Ct=n(1892),yt=n(1091);class At{}At.SelectedFont="SelectedFont",At.Formatting="Format",At.RequestUpdateMru="RequestUpdateMru",At.FontPickerId="fontPickerId",At.IsPinned="IsPinned",At.Trigger="Trigger",(0,a.a)(At,"FontPickerCommandProperties",null,[]);var bt=n(5503),Tt=n(10),vt=n(8870),wt=n(5837),Ft=n(3497),It=n(7693),Et=n(1694),Mt=n(3823);class kt{}kt.FileLocationProps="FileLocationProps",(0,a.a)(kt,"FileLocationBreadcrumbCommandProperties",null,[]);const Pt=(e,t,n,a)=>{if(Vt(a)){const a=new Array(0);switch(t){case"ToggleButtonModel":case"InkButtonModel":a.push(Rt(e,n[It.a.On]));break;case"CheckboxModel":a.push(xt(e,n[It.a.On]));break;case"ComboBoxModel":{if((0,nt.d)("updateComboBoxFreeForm")&&Ct.a.IsFreeForm in n&&a.push(appChrome.actions.updateComboBoxFreeForm(e,n[Ct.a.IsFreeForm])),!((e,t)=>{const n=appChrome.selectors.getActiveControlStates(),a=(0,at.a)(Object,n[e]);if(a){const e=(0,at.a)(String,a.value);if(e&&e===t)return!1;const n=(0,at.a)(String,a.selectedKey);if(!t&&!n)return!1;if(n){const e=Array.isArray(a.options)?a.options:null;let i=null;for(let t=0;t<e.length;t++){const a=(0,at.a)(Object,e[t]);if((0,at.a)(String,a.key)===n){i=a;break}}if(i&&(0,at.a)(String,i.text)===t)return!1}}return!0})(e,n[Ct.a.Value]))break;const t=n[Ct.a.Key];t?a.push(appChrome.actions.updateComboBoxKey(e,t,n[Ct.a.Value])):a.push(appChrome.actions.updateComboBoxValue(e,n[Ct.a.Value]));break}case"FontPickerModel":{const t=n[At.SelectedFont];a.push(appChrome.actions.updateFontPickerSelectedFont(e,t));break}case"SplitButtonModel":a.push(Rt(e,n[wt.a.On]));break;case"SpinButtonModel":a.push(appChrome.actions.updateSpinButton(e,n[vt.a.Number],St.a.convertUnitTypeToString(n[vt.a.UnitType]),n[vt.a.Text],n[vt.a.MaxValue],n[vt.a.Alt]));break;case"ColorPickerModel":a.push(appChrome.actions.updateColorPickerSelectedColor(e,n[ft.a.IndexColorSelected]));break;case"PageNumberGalleryButtonModel":a.push(appChrome.actions.updatePageNumberGalleryButtonText(e,n[bt.a.Text]));break;case"CompoundButtonModel":n[It.a.Description]&&a.push(appChrome.actions.updateCompoundButtonDescription(e,n[It.a.Description])),It.a.On in n&&a.push(Rt(e,n[It.a.On]));break;case"SliderModel":n.snapToStep?a.push(appChrome.actions.updateSliderSelectedValue(e,n[Tt.a.Value])):a.push(appChrome.actions.updateSliderValue(e,n[Tt.a.Value],n[Tt.a.MinValue]||0,n[Tt.a.MaxValue],n[Tt.a.Text]));break;case"FlyoutAnchorModel":yt.a.ImageIsVisible in n&&a.push(appChrome.actions.hideFlyoutAnchorIcon(e,!n[yt.a.ImageIsVisible])),It.a.On in n&&a.push(Rt(e,n[It.a.On]));break;case"InputBoxModel":a.push(appChrome.actions.updateInputBoxValue(e,n[Ft.a.Text]));break;case"LabelModel":Mt.a.SecondaryLabel in n&&a.push(appChrome.actions.setSecondaryLabel(e,n[Mt.a.SecondaryLabel])),Mt.a.LinkInfo in n&&a.push(appChrome.actions.setLinkInfo(e,n[Mt.a.LinkInfo]));break;case"FileLocationBreadcrumbModel":kt.FileLocationProps in n&&a.push(appChrome.actions.setFileLocationProps(e,n[kt.FileLocationProps]))}return Nt(e,n,a),Ot(e,n,a),Bt(e,n,a),Ut(e,n,a),Wt(n,a),a}return null},Dt=(e,t)=>appChrome.actions.updateControlEnabledDisabledState(e,t),Rt=(e,t)=>appChrome.actions.toggleButton(e,t),xt=(e,t)=>appChrome.actions.toggleCheckbox(e,t),Lt=(e,t)=>appChrome.actions.setControlLabel(e,t),Ut=(e,t,n)=>{const a=(0,at.a)(String,t[Et.a.customTooltip]);null!=a&&n.push(((e,t)=>appChrome.actions.setControlCustomTooltip(e,t))(e,a))},Ot=(e,t,n)=>{const a=(0,at.a)(String,t[Et.a.Icon]);null!=a&&n.push(((e,t)=>appChrome.actions.setControlIcon(e,t))(e,a))},Bt=(e,t,n)=>{const a=(0,at.a)(Object,t[Et.a.IconSet]);a&&n.push(((e,t)=>appChrome.actions.setControlIconSet(e,t))(e,a))},Nt=(e,t,n)=>{const a=(0,at.a)(String,t[Et.a.iconColor]);null!=a&&n.push(appChrome.actions.updateIconColor(e,a))},Wt=(e,t)=>{const n=Array.isArray(e[Et.a.reduxActions])?e[Et.a.reduxActions]:null;n&&t.push.apply(t,n)},Ht=e=>(1&e)<1,Vt=e=>(2&e)>0;var Gt=n(1903);class Qt{static get isTableStyleGallerySelectionFixEnabled(){return null!=Qt.__cached_isTableStyleGallerySelectionFixEnabled_0_ada94b07?Qt.__cached_isTableStyleGallerySelectionFixEnabled_0_ada94b07:Qt.__cached_isTableStyleGallerySelectionFixEnabled_0_ada94b07=s.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.sharedOnline.ChangeGate.OfficeVSO_9049043_isTableStyleGallerySelectionFix")??!1}populateGallery(e,t,n,a,i=null){const o=e.ExternalGalleryId||e.ExternalId,r=e.ExternalId;if(a.push(o),appChrome.selectors.isControlDefined(o))e.GalleryStyle&&nt.d("setGalleryStyles")&&t.push(appChrome.actions.setGalleryStyles(o,e.GalleryStyle));else{if(4!==e.Type)return void 0;n.push(appChrome.api.createGalleryModel(o,Object.assign(new pt,{columns:e.Width,sections:[appChrome.api.gallerySection(new Array(0),r)],styles:e.GalleryStyle,galleryType:"IconGallery",contextMenuMap:e.GalleryContextMenu,dismissHostingSurfaceOnExecute:e.DismissHostingSurfaceOnExecute})))}let s=0;if(nt.d("setGallerySections")&&e.GallerySections&&e.GallerySections.length>0){const n=new Array(0),a=new Array(0),r=new Array(0),l={};for(const t of e.GallerySections){const e=t.Collapse;0===s&&t.GalleryButtons&&t.GalleryButtons.length>0&&(s=t.GalleryButtons[0].Type),this.getPollResultsForGalleryButtonProps(t.GalleryButtons,i,l,!0);const c=this.addGalleryButtonControlActions(a,t.GalleryButtons,l);let d;if(e){const[t,n]=this.addGalleryButtonControlActions(a,[e.expandButton,e.collapseButton]);d={amountToShowWhenCollapsed:e.amountToShowWhenCollapsed,expandButtonId:t,collapseButtonId:n}}a.push.apply(a,this.getPopulateGalleryActions(c,o,t.SectionId,!1,s,i,!0,l)),r.push.apply(r,c),n.push(appChrome.api.gallerySection(new Array(0),t.SectionId,t.Title,void 0,d))}return t.push(appChrome.actions.setGallerySections(o,n)),t.push.apply(t,a),void t.push.apply(t,this.getGalleryQueryCommandActionsInternal(o,$e[s],r,null,5===e.Type,!0,null,l))}e.GalleryItems&&e.GalleryItems.length>0&&(s=e.GalleryItems[0].Type);const l=this.getPollResultsForGalleryButtonProps(e.GalleryItems,i,null,!0);t.push.apply(t,this.getPopulateGalleryActions(this.addGalleryButtonControlActions(t,e.GalleryItems,l),o,r,!1,s,i,!1,l))}getPreviewGalleryQueryCommandActions(e,t){const n=new Array(0);let a=null,o=!1;if(!e)return null;const r=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,e.commandId,t);n.push(Dt(e.externalUxCommand,!r));const s=e.getPreviewControlIdsExternally?t.items:e.previewControlIds;if(s){const l=new Array(0);for(let i=0;i<s.length;i++){const c={},d=s[i];c.SourceControlId=d;const u=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(d),p=this.getPollResult(u||e,c);c[bt.a.On]&&(a=c.SourceControlId,c[bt.a.HighlightOn]&&(o=!0)),Ot(d,c,n);const g=(0,at.a)(rt,c[bt.a.GalleryButtonProps]);if(g){if(l.push(g),r){const e=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,g.Command,t);g.IsDisabled=!e}}else if(e.getPreviewControlIdsExternally&&u){const e=0==(1&p);n.push(appChrome.actions.updateControlEnabledDisabledState(d,e))}}l.length>0&&n.push.apply(n,this.getPopulateGalleryActions(this.addGalleryButtonControlActions(n,l),e.externalUxCommand,e.externalUxCommand,!0,l[0].Type)),n.push(appChrome.actions.updateGallerySelectedId(e.externalUxCommand,a)),o&&(i.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",a),n.push(appChrome.actions.highlightSelectedFontStyle(a)))}return n}addGalleryButtonControlActions(e,t,n=null){const a=new Array(0),i=new Array(0);for(let e=0;e<t.length;e++){const o=t[e],r=Gt.b(o.ExternalId)?o.Id:o.ExternalId;a.push(r);const s=n&&n[r]?n[r].result:-1;switch(o.Type){case 1:{const e=o;i.push(appChrome.api.createCharacterCodeGalleryButtonModel(r,Object.assign(new dt,{disabled:-1!==s?Ht(s):e.IsDisabled,character:e.Character,style:e.Style,title:e.Alt})));break}case 2:{const e=o;i.push(appChrome.api.createFontStylesGalleryButtonModel(r,Object.assign(new ut,{disabled:-1!==s?Ht(s):e.IsDisabled,styleDisplayName:e.LabelText,style:e.Style,title:e.Alt,previewStyleLabel:e.PreviewStyleLabel,previewStyleFontNameAndSize:e.previewStyleFontNameAndSize,menuModel:e.menuModel})));break}case 3:{const e=o;i.push(appChrome.api.createInkThicknessGalleryButtonModel(r,Object.assign(new ht,{disabled:-1!==s?Ht(s):e.IsDisabled,styleDisplayName:e.LabelText,style:e.Style,title:e.Alt})));break}case 4:{const e=o;i.push(appChrome.api.createIconGalleryButtonModel(r,Object.assign(new gt,{disabled:-1!==s?Ht(s):e.IsDisabled,icon:[e.Icon],role:e.Role,fullIconStyle:e.FullIconStyle,previewIconStyle:e.PreviewIconStyle,largePreviewIconStyle:e.LargePreviewIconStyle,label:e.LabelText,title:e.Alt})));break}case 5:{const e=o;i.push(appChrome.api.createListGalleryButtonModel(r,Object.assign(new mt,{disabled:-1!==s?Ht(s):e.IsDisabled,infoAtLevel:e.LevelInfo,ariaLabel:e.Alt})));break}case 6:{const e=o;i.push(appChrome.api.createTableStyleGalleryButtonModel(r,Object.assign(new lt,{disabled:-1!==s?Ht(s):e.IsDisabled,tableCellStyles:e.TableCellStyles,tableStyles:e.TableStyles,title:e.Alt,columns:e.columns})));break}case 8:{const e=o;i.push(appChrome.api.createChangeColorsGalleryButtonModel(r,Object.assign(new ct,{disabled:-1!==s?Ht(s):e.IsDisabled,tableCellStyles:e.TableCellStyles,tableStyles:e.TableStyles,title:e.Alt})));break}case 7:{const e=o;i.push(appChrome.api.createPageNumberGalleryButtonModel(r,Object.assign(new _t,{disabled:-1!==s?Ht(s):e.IsDisabled,text:e.Text,title:e.Alt})));break}}this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new it.a(r,o.Command),{queryCommandId:o.QueryCommand,menuItemId:o.MenuItemId}))}return e.push(appChrome.actions.addControls(i)),a}getPopulateGalleryActions(e,t,n,a,i,o=null,r=!1,s=null){const l=new Array(0);if(a)l.push(appChrome.actions.populateGalleryItems(t,e));else{if(this._justPopulatedFullGalleriesMap[t]=!1,!r){let n=!0;if(appChrome.selectors.isControlDefined(t)){const e=appChrome.selectors.getGalleryState(t);n=!e.disableIndividualButtons||e.disableIndividualButtons}l.push.apply(l,this.getGalleryQueryCommandActionsInternal(t,$e[i],e,null,5===i,n,o,s))}l.push(appChrome.actions.updateGallerySectionItems(t,n,e))}return l}getGalleryQueryCommandActions(e){const t=e.items,n=e.sections,a=!e.disableIndividualButtons||e.disableIndividualButtons;return this.getGalleryQueryCommandActionsInternal(e.ExternalUxId,e.galleryType,t,n,e.isListGallery,a)}getGalleryQueryCommandActionsInternal(e,t,n,a,i,o=!0,r=null,s=null){const l=new Array(0);if(e in this._justPopulatedFullGalleriesMap){if(this._justPopulatedFullGalleriesMap[e])return delete this._justPopulatedFullGalleriesMap[e],l;this._justPopulatedFullGalleriesMap[e]=!0}let c=null,d=-1;if(n)({galleryTextDirection:d,returnValue:c}=this.addGalleryButtonQueryActions(t,n,l,o,r,s));else if(a)for(const e of a){const n=({galleryTextDirection:d}=this.addGalleryButtonQueryActions(t,e.galleryButtons,l,o,null,s)).returnValue;n&&(c=n)}return(!Qt.isTableStyleGallerySelectionFixEnabled||"TableStyleGallery"!==e||null!=c)&&l.push(appChrome.actions.updateGallerySelectedId(e,c)),o&&l.push(Dt(e,!1)),i&&d>0&&l.push(appChrome.actions.updateListGalleryTextDirection(e,2===d)),l}getPollResultsForGalleryButton(e,t=null,n=!1){const a={},i={};i.SourceControlId=e,i.Location=t;const o=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e);if(!o)return a.result=-1,a.props=i,a;const r=this.getPollResult(o,i);return a.result=r,a.props=i,a}getPollResultsForGalleryButtonProps(e,t=null,n=null,a=!1){n||(n={});for(const i of e){const e=Gt.b(i.ExternalId)?i.Id:i.ExternalId;n[e]=this.getPollResultsForGalleryButton(e,t,a)}return n}addGalleryButtonQueryActions(e,t,n,a,o=null,r=null){let s,l=null;s=-1;let c=!1;for(const i of t){const t=this.getGalleryButtonModelTypeFromFullGalleryType(e),d=r&&r[i]&&-1!==r[i].result?r[i]:this.getPollResultsForGalleryButton(i,o),u=d.result,p=d.props;a&&n.push(Dt(i,Ht(u)));const g=Pt(i,t,p,u);if(g&&n.push.apply(n,g),p[bt.a.On]&&(l=i,p[bt.a.HighlightOn]&&p[bt.a.HighlightOn]&&(c=!0)),void 0!==p[Et.a.labelText]&&null!==p[Et.a.labelText]){const e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(i);n.push(Lt(e.externalUxCommand,p[Et.a.labelText]))}p[bt.a.IsRtl]&&s<0&&(s=p[bt.a.IsRtl])}return c&&(i.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",l),n.push(appChrome.actions.highlightSelectedFontStyle(l))),{returnValue:l,galleryTextDirection:s}}getGalleryButtonModelTypeFromFullGalleryType(e){switch(e){case"CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case"FontStyleGallery":return"FontStyleGalleryButtonModel";case"InkThicknessGallery":return"InkThicknessGalleryButtonModel";case"IconGallery":return"IconGalleryButtonModel";case"ListGallery":return"ListGalleryButtonModel";case"TableStyleGallery":return"TableStyleGalleryButtonModel";case"ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case"PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}getPollResult(e,t){return t.MenuItemId=e.menuItemId,this._rootPoller.pollForCommandState(this._rootUser,this._rootType,e.commandId,e.queryCommandId,t)}constructor(e,t,n,a){this._externalUICommandDefinitionMapping=a,this._rootPoller=e,this._rootUser=t,this._rootType=n,this._justPopulatedFullGalleriesMap={}}}(0,a.a)(Qt,"ReactGalleryPoller",null,[]);var qt=n(4182),Kt=n(3078),zt=n(1752),jt=n(9052),Zt=n(4853),Xt=n(8574);class Jt extends Xt.a{constructor(){super(),this.Styles=null,this.AriaLabel=null,this.Data=null,this.Disabled=!1}}(0,a.a)(Jt,"ComboBoxItemButtonProps",Xt.a,[]);class Yt extends Xt.a{get ControlType(){return 3}constructor(){super()}}(0,a.a)(Yt,"CompoundButtonProps",Xt.a,[]);class $t extends ot.a{get ControlType(){return 12}constructor(){super(),this.Label=null,this.IconName=null,this.AriaDescription=null,this.RetryButtonTitle=null,this.OnRetryCommandId=null,this.LinkText=null,this.LinkUrl=null,this.OnLinkClicked=null,this.Title=null,this.IsNoResultView=!1}}(0,a.a)($t,"ErrorViewProps",ot.a,[]);var en=n(121),tn=n(1993),nn=n(9645),an=n(7257);class on extends ot.a{get ControlType(){return 13}constructor(){super(),this.CommandId=null,this.CommandIdMapped=null,this.ActionCommandId=null,this.iconSet=null,this.Label=null,this.SecondaryLabel=null,this.Description=null,this.Links=null,this.Details=null,this.ActionId=null,this.ActionIdMapped=null,this.ActionText=null,this.ActionCommandValueId=null,this.CommandValueId=null,this.IsFeedbackButton=!1}}(0,a.a)(on,"MultiActionButtonProps",ot.a,[]);class rn extends Xt.a{get ControlType(){return 4}constructor(){super(),this.DisplayName=null,this.PersonaId=null,this.IsAnonymous=!1}}(0,a.a)(rn,"PersonaButtonProps",Xt.a,[]);class sn{constructor(){this.commandId=null,this.fonts=null,this.mruList=null,this.initialPinnedFontKeys=null,this.suggestedFontKeys=null,this.isSubscriber=!1,this.previewFontFamily=null,this.shouldShowSegregatedView=!1}}(0,a.a)(sn,"PopulateFontPickerDataProps",null,[]);class ln{}ln.licenseFeatureId="ModernFontPicker",ln.missingFont="missing",ln.compatibilityFont="compatible",ln.embeddedFont="embedded",ln.premiumFont="premium",ln.organizationFont="organization",(0,a.a)(ln,"FontPickerConstants",null,[]);class cn{constructor(e,t=null,n=null,a=null){this.iconSet={},this.iconSet.default=e,this.iconSet.icon16=t,this.iconSet.icon24=n,this.iconSet.icon32=a}}(0,a.a)(cn,"IconSetContainer",null,[]);class dn{constructor(){this.iconSet=null,this.disabled=!1,this.hidden=!1,this.iconColor=null,this.fullDescriptionLabel=null,this.keytip=null,this.customTooltip=null,this.shouldTakeFocus=!1,this.secondaryText=null}}(0,a.a)(dn,"CommonOptionalButtonProperties",null,[]);class un extends dn{constructor(){super(),this.commandValueId=null,this.role=null,this.hideLabel=!1,this.supportsPreview=!1,this.lang=null,this.dismissHostingSurfaceOnExecute=!1}}(0,a.a)(un,"OptionalButtonProperties",dn,[]);class pn extends dn{constructor(){super(),this.commandValueId=null,this.styles=null,this.roleInMenu=null,this.lang=null,this.ariaDescription=null}}(0,a.a)(pn,"OptionalCompoundButtonProperties",dn,[]);class gn extends dn{constructor(){super(),this.label=null,this.ariaDescription=null,this.retryButtonTitle=null,this.onRetryCommandId=null,this.linkText=null,this.linkUrl=null,this.onLinkClicked=null,this.title=null,this.isNoResultView=!1}}(0,a.a)(gn,"OptionalErrorViewProperties",dn,[]);class hn extends dn{constructor(){super(),this.menuModel=null,this.hideLabel=!1,this.downChevronIcon=null,this.hideChevron=!1,this.hideIcon=!1,this.lang=null,this.labelInMenu=null,this.toggled=!1,this.roleInMenu=null}}(0,a.a)(hn,"OptionalFlyoutAnchorProperties",dn,[]);class mn extends dn{constructor(){super(),this.isBanner=null}}(0,a.a)(mn,"OptionalLabelProperties",dn,[]);class _n extends dn{constructor(){super(),this.label=null,this.secondaryLabel=null,this.commandId=null,this.actionCommandId=null,this.description=null,this.links=null,this.details=null,this.actionId=null,this.actionText=null,this.actionCommandValueId=null,this.commandValueId=null,this.isFeedbackButton=!1}}(0,a.a)(_n,"OptionalMultipActionButtonProperties",dn,[]);class Sn extends un{constructor(){super(),this.secondaryText=null,this.styles=null,this.flipIconInRtl=!1}}(0,a.a)(Sn,"OptionalPersonaButtonProperties",un,[]);class fn extends dn{constructor(){super(),this.toggled=!1,this.roleInMenu=null,this.toggleUsingIcon=!1,this.stylingParameters=null}}(0,a.a)(fn,"OptionalToggleButtonProperties",dn,[]);class Cn{}(0,a.a)(Cn,"PersonaIdentifiers",null,[]);class yn{}(0,a.a)(yn,"PersonaInfo",null,[]);var An=n(3435),bn=n(7689);class Tn{constructor(){this.actions=null,this.commandsToPoll=null,this.wasShadowMenuOpen=!1,this.galleriesPolled=[]}}(0,a.a)(Tn,"PopulateActions",null,[]);class vn{getStateProps(e,t){switch(t){case"ColorPickerModel":return appChrome.selectors.getColorPickerState(e);case"ToggleButtonModel":return this.getPropsForToggleButtonModel(e);case"InkButtonModel":return this.getPropsForInkButtonModel(e);case"GalleryModel":return appChrome.selectors.getGalleryState(e);case"PreviewGalleryModel":return(0,nt.h)("getPreviewGalleryState")?appChrome.selectors.getPreviewGalleryState(e):{};case"SplitButtonModel":return appChrome.selectors.getSplitButtonState(e);case"SliderModel":return appChrome.selectors.getSliderState(e)}return{}}getPropsForToggleButtonModel(e){const t={};return t[It.a.On]=appChrome.selectors.getButtonToggleState(e),t}getPropsForInkButtonModel(e){const t={};return t[It.a.On]=nt.h("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(e):appChrome.selectors.getButtonToggleState(e),t}}(0,a.a)(vn,"ReactStatePropsSelector",null,[]);class wn extends dn{constructor(){super(),this.label=null,this.value=null,this.showIcon=!1,this.underlined=!1,this.autoComplete="off",this.resultAriaLiveText=null,this.onChangeCommandId=null}}(0,a.a)(wn,"OptionalSearchBoxProperties",dn,[]);class Fn extends ot.a{get ControlType(){return 15}constructor(){super(),this.Label=null,this.Value=null,this.ShowIcon=!1,this.Underlined=!1,this.AutoComplete="off",this.ResultAriaLiveText=null,this.OnChangeCommandId=null}}(0,a.a)(Fn,"SearchBoxProps",ot.a,[]);class In{skipPopulation(e){const t=e.populationProps.populateQueryCommandId;return e.populationProps.populateOnlyOnce&&t in this._successfullyPolledPopulateCommands}getReduxActionsAndCommandsToPoll(e,t,n=null){const a=new Array(0),i={},o=[];if(!this.skipPopulation(e)){const r=e.populationProps.populateQueryCommandId,l={};l.MenuId=e.externalUxCommand,l.IsShadowMenuOpen=this.isShadowMenuOpen(n),s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_7992977_AddLocationToActionData")&&(l.location=n&&void 0!==n.location?n.location:null);if((1&this._rootPoller.pollForCommandState(this._rootUser,this._rootType,r,r,l,this.getInputMethod(n)))>0)if("FontPickerModel"===t){this._successfullyPolledPopulateCommands[r]=!0;const t=l;a.push(In.getPopulateFontPickerAction(e,t)),i[e.externalUxCommand]="FontPickerModel"}else{const s=l;if(s.MenuItems)switch(this._successfullyPolledPopulateCommands[r]=!0,t){case"ComboBoxModel":a.push(In.getPopulateComboBoxAction(e,s)),i[e.externalUxCommand]="ComboBoxModel";break;case"FlyoutAnchorModel":case"InkFlyoutAnchorModel":case"PreviewGalleryModel":case"SplitButtonModel":case"StatefulSplitButtonModel":a.push.apply(a,this.getUpdateActionsForMenuControls(e.externalUxCommand,t,s.MenuItems,i,n&&"location"in n?n.location:null,o))}}}return Object.assign(new Tn,{actions:a,commandsToPoll:i,wasShadowMenuOpen:this.isShadowMenuOpen(n),galleriesPolled:o})}getMenuSectionAndActions(e,t,n,a,i,o,r,s,l=null,c){let d=null;const u=new Array(0);Gt.d(e.Title)||(d=e.Title);for(let s=0;s<e.ControlList.length;s++){const d=(0,at.a)(ot.a,e.ControlList[s]);d&&!d.ExternalId||(o&&this.getCommandsToPoll(d,o),t.push.apply(t,this.getPopulateControlReduxActions(d,r,u,i,n,a,l,c)))}return s?appChrome.api.menuSection(u,d,e.Lang):null}getUpdateActionsForMenuControls(e,t,n,a,i=null,o){const r=new Array(0),s=new Array(0),l=new Array(0),c=new Array(0);for(let d=0;d<n.MenuSectionList.length;d++){const u=(0,at.a)(an.a,n.MenuSectionList[d]);if(!u)continue;const p=this.getMenuSectionAndActions(u,r,e,t,c,a,s,n.UpdateDynamically,i,o);n.UpdateDynamically&&l.push(p)}let d=null;n.MenuHeaderSection&&(d=this.getMenuSectionAndActions(n.MenuHeaderSection,r,e,t,c,a,s,n.UpdateDynamically,i));let u=null;return n.MenuFooterSection&&(u=this.getMenuSectionAndActions(n.MenuFooterSection,r,e,t,c,a,s,n.UpdateDynamically,i)),n.UpdateDynamically&&r.push(appChrome.actions.updateMenu(e,l,n.Title,n.AriaLabel,n.ShouldAutoOpen,n.AriaRoleDescription,n.MenuTargetDescriptor,u,n.IsFlexLayout,d)),s.length>0&&r.splice(0,0,appChrome.actions.addControls(s)),c.length>0&&nt.d("setStatefulSplitButtonMruBypassControls")&&r.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(e,c)),r}getCommandsToPoll(e,t){switch(e.ControlType){case 1:case 3:return void(t[e.ExternalId]=1===e.ControlType?"ButtonModel":"CompoundButtonModel");case 2:return void(t[e.ExternalId]="ToggleButtonModel");case 6:return void(t[e.ExternalId]="CheckboxModel");case 7:{t[e.ExternalId]="ColorPickerModel";const n=(0,at.a)(Zt.a,e);return void(n.McuLayout&&(t[n.McuExternalId]="ColorPickerModel"))}case 9:return void(t[e.ExternalId]="FlyoutAnchorModel")}}getPopulateControlReduxActions(e,t,n,a,i,o,r=null,l){const c=new Array(0);switch(e.ControlType){case 14:if(s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)){const a=(0,at.a)(nn.a,e);return null!=a.IsBanner&&a.IsBanner&&this.populateBannerLabel((0,at.a)(nn.a,e),c,t,n),c}break;case 1:case 3:{const a=(0,at.a)(Xt.a,e);return this.populateButton(a,c,t,n),a.MenuItemsStatefulData&&nt.d("setStatefulSplitButtonMenuItemsStatefulData")&&c.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(i,a.MenuItemsStatefulData)),c}case 2:return this.populateToggleButton((0,at.a)(An.a,e),c,t,n),c;case 6:return this.populateCheckMarkToggleButton((0,at.a)(jt.a,e),c,t,n),c;case 4:return this.populatePersonaButton((0,at.a)(rn,e),c,t,n),c;case 7:return this.populateColorPicker((0,at.a)(Zt.a,e),c,t,n),c;case 15:return this.populateSearchBox((0,at.a)(Fn,e),c,t,n),c;case 12:return this.populateErrorView((0,at.a)($t,e),c,t,n),c;case 13:return this.populateMultiActionButton((0,at.a)(on,e),c,t,n),c;case 9:{const i=(0,at.a)(en.a,e);return this.populateFlyoutAnchor(i,c,t,n),"StatefulSplitButtonModel"===o&&a.push(i.ExternalId),c}case 8:return this._reactGalleryPoller.populateGallery((0,at.a)(tn.a,e),c,t,n,r),l&&l.push(e.ExternalGalleryId),c}return c}populateBannerLabel(e,t,n,a){if(a.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId))e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)),e.IconName&&e.IconName.length>0&&t.push(appChrome.actions.setControlIcon(e.ExternalId,e.IconName));else{let t=null;e.IconName&&e.IconName.length>0&&(t=new cn(e.IconName)),n.push(appChrome.api.createLabelModel(e.ExternalId,e.LabelText,e.Id,Object.assign(new mn,{isBanner:e.IsBanner,iconSet:t?t.iconSet:null})))}}populateButton(e,t,n,a){if(a.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)){if(e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)),e.Description&&t.push(appChrome.actions.updateCompoundButtonDescription(e.ExternalId,e.Description)),e.CommandValueId&&t.push(appChrome.actions.setButtonCommandValueId(e.ExternalId,e.CommandValueId)),this.allowFullPropPoulation()){const n=this.getIconName(e);n&&n.length>0&&t.push(appChrome.actions.setControlIconSet(e.ExternalId,new cn(n).iconSet)),e.LabelText!==e.Alt&&t.push(appChrome.actions.setControlCustomTooltip(e.ExternalId,e.Alt))}}else{if(e.Description||(0,Kt.a)(Yt,e))n.push(appChrome.api.createCompoundButtonModel(e.ExternalId,e.LabelText,e.Description,Object.assign(new pn,{iconSet:new cn(this.getIconName(e)).iconSet,keytip:e.KeyTip,roleInMenu:e.RoleInMenu,ariaDescription:e.AriaDescription,customTooltip:e.LabelText!==e.Alt?e.Alt:null,secondaryText:e.SecondaryText})));else{const t=e.DismissHostingSurfaceOnExecute;n.push(appChrome.api.createButtonModel(e.ExternalId,e.LabelText,Object.assign(new un,{iconSet:new cn(this.getIconName(e)).iconSet,keytip:e.KeyTip,supportsPreview:!!e.CommandPreviewId&&!!e.CommandRevertId,customTooltip:e.LabelText!==e.Alt?e.Alt:null,secondaryText:e.SecondaryText,commandValueId:e.CommandValueId,shouldTakeFocus:e.ShouldTakeFocus,dismissHostingSurfaceOnExecute:null==t||t})))}this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new it.a(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand,commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId}))}e.Lang&&nt.d("setControlLanguage")&&t.push(appChrome.actions.setControlLanguage(e.ExternalId,e.Lang))}populateCheckMarkToggleButton(e,t,n,a){if(a.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)){if(e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)),this.allowFullPropPoulation()){const n=this.getIconName(e);n&&n.length>0&&t.push(appChrome.actions.setControlIconSet(e.ExternalId,new cn(n).iconSet)),e.IsChecked&&t.push(appChrome.actions.toggleButton(e.ExternalId,e.IsChecked)),e.LabelText!==e.Alt&&t.push(appChrome.actions.setControlCustomTooltip(e.ExternalId,e.Alt))}}else n.push(appChrome.api.createToggleButtonModel(e.ExternalId,e.LabelText,Object.assign(new fn,{iconSet:new cn(this.getIconName(e)).iconSet,keytip:e.KeyTip,toggled:e.IsChecked,fullDescriptionLabel:e.Description,roleInMenu:e.AriaLabel,customTooltip:e.LabelText!==e.Alt?e.Alt:null,toggleUsingIcon:!!e.CheckedImageClass}))),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new it.a(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand}))}populateSearchBox(e,t,n,a){a.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?(t.push(appChrome.actions.updateSearchBoxValue(e.ExternalId,e.Value)),t.push(appChrome.actions.updateSearchBoxResultAriaLiveText(e.ExternalId,e.ResultAriaLiveText))):n.push(appChrome.api.createSearchBoxModel(e.ExternalId,Object.assign(new wn,{label:e.Label,value:e.Value,showIcon:e.ShowIcon,underlined:e.Underlined,autoComplete:e.AutoComplete,resultAriaLiveText:e.ResultAriaLiveText,onChangeCommandId:e.OnChangeCommandId})))}populateErrorView(e,t,n,a){if(a.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId))e.Label&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.Label)),e.IconName&&e.IconName.length>0&&t.push(appChrome.actions.setControlIcon(e.ExternalId,e.IconName));else{let t=null;e.IconName&&e.IconName.length>0&&(t=new cn(e.IconName)),n.push(appChrome.api.createErrorViewModel(e.ExternalId,Object.assign(new gn,{label:e.Label,retryButtonTitle:e.RetryButtonTitle,onRetryCommandId:e.OnRetryCommandId,ariaDescription:e.AriaDescription,iconSet:t?t.iconSet:null,linkText:e.LinkText,linkUrl:e.LinkUrl,onLinkClicked:e.OnLinkClicked,title:e.Title,isNoResultView:e.IsNoResultView})))}}populateMultiActionButton(e,t,n,a){if(a.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)){const n={};e.Label&&(n.label=e.Label),e.SecondaryLabel&&(n.secondaryLabel=e.SecondaryLabel),e.Details&&(n.details=e.Details),e.Description&&(n.description=e.Description),e.iconSet&&(n.iconSet=e.iconSet),e.Links&&(n.links=e.Links),e.CommandValueId&&(n.commandValueId=e.CommandValueId),e.ActionCommandValueId&&(n.actionCommandValueId=e.ActionCommandValueId),e.ActionCommandId&&(n.actionCommandId=e.ActionCommandId),e.CommandId&&(n.commandId=e.CommandId),e.IsFeedbackButton&&(n.isFeedbackButton=e.IsFeedbackButton),t.push(appChrome.actions.updateMultiActionButton(e.ExternalId,n))}else n.push(appChrome.api.createMultiActionButtonModel(e.Id,Object.assign(new _n,{label:e.Label,secondaryLabel:e.SecondaryLabel,actionText:e.ActionText,description:e.Description,iconSet:e.iconSet,links:e.Links,details:e.Details,actionId:e.ActionId,commandId:e.CommandId,actionCommandId:e.ActionCommandId||e.ActionId,commandValueId:e.CommandValueId,actionCommandValueId:e.ActionCommandValueId||e.CommandValueId,isFeedbackButton:e.IsFeedbackButton}))),e.CommandIdMapped&&this._externalUICommandDefinitionMapping.addCommandToMaps(new it.a(e.CommandId,e.CommandIdMapped)),e.ActionIdMapped&&this._externalUICommandDefinitionMapping.addCommandToMaps(new it.a(e.ActionId,e.ActionIdMapped))}populateToggleButton(e,t,n,a){if(a.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)){if(e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)),this.allowFullPropPoulation()){const n=this.getIconName(e);n&&n.length>0&&t.push(appChrome.actions.setControlIconSet(e.ExternalId,new cn(n).iconSet)),s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&e.LabelText!==e.Alt&&t.push(appChrome.actions.setControlCustomTooltip(e.ExternalId,e.Alt))}}else s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?n.push(appChrome.api.createToggleButtonModel(e.ExternalId,e.LabelText,Object.assign(new fn,{iconSet:new cn(this.getIconName(e)).iconSet,iconColor:e.IconColor,keytip:e.KeyTip,fullDescriptionLabel:e.Description,roleInMenu:e.AriaLabel,customTooltip:e.LabelText!==e.Alt?e.Alt:null,toggleUsingIcon:e.ToggleUsingIcon,stylingParameters:e.StylingParameters}))):n.push(appChrome.api.createToggleButtonModel(e.ExternalId,e.LabelText,Object.assign(new fn,{iconSet:new cn(this.getIconName(e)).iconSet,iconColor:e.IconColor,keytip:e.KeyTip,fullDescriptionLabel:e.Description,roleInMenu:e.AriaLabel,toggleUsingIcon:e.ToggleUsingIcon,stylingParameters:e.StylingParameters}))),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new it.a(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand}))}populatePersonaButton(e,t,n,a){a.push(e.ExternalId);const i=this.getPersonaInfoFromProps(e);appChrome.selectors.isControlDefined(e.ExternalId)?e.LabelText&&t.push(appChrome.actions.setPersonaButtonCoauthor(e.ExternalId,i,e.LabelText)):nt.a("createPersonaButtonModel")&&n.push(appChrome.api.createPersonaButtonModel(e.ExternalId,i,e.LabelText,Object.assign(new Sn,{role:e.RoleInMenu,fullDescriptionLabel:e.AriaDescription,iconSet:{default:"doughboywhiteglyph_20"}})))}populateFlyoutAnchor(e,t,n,a){if(a.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)){if(e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)),this.allowFullPropPoulation()){const n=this.getIconName(e);n&&n.length>0&&t.push(appChrome.actions.setControlIconSet(e.ExternalId,new cn(n).iconSet)),void 0!==e.ImageIsVisible&&null!==e.ImageIsVisible&&t.push(appChrome.actions.hideFlyoutAnchorIcon(e.ExternalId,!e.ImageIsVisible)),void 0!==e.Toggled&&null!==e.Toggled&&t.push(appChrome.actions.toggleButton(e.ExternalId,e.Toggled))}}else{const t=!(void 0===e.ImageIsVisible||null===e.ImageIsVisible||e.ImageIsVisible),a=!(void 0===e.Toggled||null===e.Toggled)&&e.Toggled;n.push(appChrome.api.createFlyoutAnchorModel(e.ExternalId,e.LabelText,Object.assign(new hn,{iconSet:new cn(this.getIconName(e)).iconSet,keytip:e.KeyTip,hideIcon:t,toggled:a,roleInMenu:e.AriaLabel,customTooltip:e.LabelText!==e.Alt?e.Alt:null}))),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new it.a(e.ExternalId,e.Command),{queryCommandId:e.QueryCommand,populationProps:new zt.a(e.PopulateQueryCommand,e.PopulateOnlyOnce)}))}e.Menu&&t.push.apply(t,this.getUpdateActionsForMenuControls(e.ExternalId,"FlyoutAnchorModel",e.Menu,null)),e.Lang&&t.push(appChrome.actions.setControlLanguage(e.ExternalId,e.Lang))}populateColorPicker(e,t,n,a){e.McuLayout&&a.push(e.McuExternalId),a.push(e.ExternalId);let i=0;if(appChrome.selectors.isControlDefined(e.ExternalId)){if(e.McuLayout){i=this._reactStatePropsSelector.getStateProps(e.ExternalId,"ColorPickerModel").columnCount}}else e.McuLayout&&(n.push(appChrome.api.createColorPickerModel(e.McuExternalId,e.Width)),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new it.a(e.McuExternalId,e.Command),{commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId})),i=e.Width),n.push(appChrome.api.createColorPickerModel(e.ExternalId,e.Width)),this._externalUICommandDefinitionMapping.addCommandToMaps(Object.assign(new it.a(e.ExternalId,e.Command),{commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId}));const o=new Array(0),r=new Array(0);for(let t=0;t<e.Colors.length;t++){const n=e.Colors[t],a=!!s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.HighContrastColorPickerEnabled",!1)&&n.Disabled;t<i?o.push(appChrome.api.colorPickerCell(n.Color,n.DisplayColor,n.Alt,a)):r.push(appChrome.api.colorPickerCell(n.Color,n.DisplayColor,n.Alt,a))}o.length>0&&t.push(appChrome.actions.populateColorPickerCells(e.McuExternalId,o)),t.push(appChrome.actions.populateColorPickerCells(e.ExternalId,r)),e.SelectedColorId&&(o.length>0&&t.push(appChrome.actions.updateColorPickerSelectedColor(e.McuExternalId,e.SelectedColorId)),t.push(appChrome.actions.updateColorPickerSelectedColor(e.ExternalId,e.SelectedColorId)))}getIconName(e){return e.Image32by32Class?this._externalUICommandDefinitionMapping.getExternalIconIdByLegacyIconId(e.Image32by32Class):e.Image16by16Class?this._externalUICommandDefinitionMapping.getExternalIconIdByLegacyIconId(e.Image16by16Class):e.ExternalImageId}getPersonaInfoFromProps(e){return e?Object.assign(new yn,{displayName:e.DisplayName,personaCoinColor:e.ImageBackColor,isUnauthenticatedSender:e.IsAnonymous,identifiers:Object.assign(new Cn,{PersonaType:"User",Smtp:e.PersonaId})}):null}getInputMethod(e){let t=2;return e&&"inputMethod"in e&&e.inputMethod&&(t=e.inputMethod),t}isShadowMenuOpen(e){return!!e&&e.isShadowRendering}allowFullPropPoulation(){return s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static getPopulateFontPickerAction(e,t){return appChrome.actions.populateFontPickerDataAsync(new Promise(((n,a)=>{(0,D.h)(qt.a).execute((i=>{i.isFeatureEnabled(ln.licenseFeatureId,!1).then((a=>{let o=t.fonts;if(!a){i.isFreemiumUpsellEnabled()||(o=bn.a.where(o,(e=>e.fontType!==ln.premiumFont)))}const r=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost"),l=s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FontImprovementsV1Experiment",!1);l&&r&&!a&&(t.suggestedFontKeys=[]);const c=(s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ShouldShowAggregatedViewInFontPicker")||l)&&r&&!a,d=Object.assign(new sn,{commandId:e.externalUxCommand,fonts:o,isSubscriber:a,shouldShowSegregatedView:c,mruList:t.mruList,initialPinnedFontKeys:t.initialPinnedFontKeys,suggestedFontKeys:t.suggestedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});n(d)})).catch(a)}))})))}static getPopulateComboBoxAction(e,t){const n=new Array(0);for(let e=0;e<t.MenuItems.MenuSectionList.length;e++){const a=t.MenuItems.MenuSectionList[e];a.Title&&n.push(appChrome.api.comboBoxHeader("Header-"+e.toString(),a.Title));for(let e=0;e<a.ControlList.length;e++){const t=(0,at.a)(Jt,a.ControlList[e]);t&&n.push(appChrome.api.comboBoxItem(t.MenuItemId,t.LabelText,t.Styles,t.CommandValueId,t.AriaLabel,t.Data,t.Disabled))}e<t.MenuItems.MenuSectionList.length-1&&n.push(appChrome.api.comboBoxDivider("Divider-"+e.toString()))}return appChrome.actions.populateComboBoxOptions(e.externalUxCommand,n)}constructor(e,t,n,a,i){this._rootPoller=e,this._rootUser=t,this._rootType=n,this._externalUICommandDefinitionMapping=a,this._successfullyPolledPopulateCommands={},this._reactStatePropsSelector=new vn,this._reactGalleryPoller=i}}(0,a.a)(In,"ReactPopulateQueryCommandPoller",null,[]);class En{getReduxActions(e,t,n){const a=new Array(0);if(this.isContainerModelType(t)){const i=this.getStateActionsForContainerModelType(e,t,n);null!=i&&a.push.apply(a,i)}else if(e){const i=this.getPollResult(e,n);if(Et.a.visible in n&&a.push(((e,t)=>appChrome.actions.updateControlHiddenState(e,t))(e.externalUxCommand,!n[Et.a.visible])),a.push(Dt(e.externalUxCommand,Ht(i))),void 0!==n[Et.a.labelText]&&null!==n[Et.a.labelText]&&a.push(Lt(e.externalUxCommand,n[Et.a.labelText])),null!=t){const o=Pt(e.externalUxCommand,t,n,i);null!=o&&a.push.apply(a,o),"PeopleWell"===t&&this.addPeopleWellStateActions(e.externalUxCommand,n,a)}}return a}getEnabledDisabledActionBasedOnChildrenCommands(e,t,n,a){const i=new Array(0);let o={};switch(t){case"FlyoutAnchorModel":o=appChrome.selectors.getFlyoutAnchorMenuItems(e);break;case"SplitButtonModel":{const t=appChrome.selectors.getSplitButtonState(e),a=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(t.command);if(a){const t=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,a.commandId,n);i.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(e,!t)),i.push(Dt(e,!1))}return i}default:return null}let r=!1;for(const t in o){const a={key:t,value:o[t]},s=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(a.key);if(Gt.d(s)){r=!0;continue}n.SourceControlId=s.externalUxCommand;if(this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,s.commandId,n))return i.push(Dt(e,!1)),i}const s=r||a&&0===Object.keys(o).length;return i.push(Dt(e,!s)),i}getStateActionsForContainerModelType(e,t,n){switch(t){case"PreviewGalleryModel":return this._reactGalleryPoller.getPreviewGalleryQueryCommandActions(e,n);case"GalleryModel":return this._reactGalleryPoller.getGalleryQueryCommandActions(n)}return null}isContainerModelType(e){return"GalleryModel"===e||"PreviewGalleryModel"===e}getPollResult(e,t){return t.MenuItemId=e.menuItemId,this._rootPoller.pollForCommandState(this._rootUser,this._rootType,e.commandId,e.queryCommandId,t)}addPeopleWellStateActions(e,t,n){const a=t[yt.a.LabelText],i=t[yt.a.LabelTextUserGeneratedPlaceholderReplacements];let o=a;return i&&i.length>0&&(o=String.format.apply(null,[o].concat(i))),n.push(this.getUpdatePeopleWellAction(e,o)),n}getUpdatePeopleWellAction(e,t){return appChrome.actions.updatePeopleWell(this.getCoauthorsInfo(e),t)}getCoauthorsInfo(e){const t=new Array(0),n={},a=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e).populationProps.populateQueryCommandId;this._rootPoller.pollForCommandState(this._rootUser,this._rootType,"1285265560",a,n);const i=n.MenuItems;if(!i)return t;const o=i.MenuSectionList[0];for(let e=0;e<o.ControlList.length;e++){const n=o.ControlList[e],a={};a.name=n.Alt,a.id=n.MenuItemId,a.description=n.Description,a.color=n.ImageBackColor,a.joinTime=n.JoinTimeInMS,a.imageUrl=n.ImageUrl,a.activeStatus=n.ActiveStatus,a.isAnonymous=n.IsAnonymous,a.canJump=n.CanJump,a.upn=n.Upn,a.coauthorPresenceDescription=n.CoauthorPresenceDescription,t.push(a)}return t}constructor(e,t,n,a,i){this._externalUICommandDefinitionMapping=n,this._rootPoller=e,this._rootUser=t,this._rootType=a,this._reactGalleryPoller=i}}(0,a.a)(En,"ReactQueryCommandPoller",null,[]);var Mn=n(4174),kn=n(2274),Pn=n(9606);let Dn={};const Rn=(e,t,n)=>{Dn[e]={id:e,[t]:n,...Dn[e]}},xn=new Set,Ln=(e=Un)=>{const t=[];let n=[];try{const e=kn.AFrameworkApplication_AppSettingsManager?.appSettingsManager?.getStringAppSetting("HostDefinedUIControls");n=e?JSON.parse(e):[]}catch(e){console.error("Failed to parse HostDefinedUIControls:",e),n=[]}return n.forEach((n=>{const a=n?.id,i=n?.visibility;if(1===i&&a in e){e[a].forEach((e=>{xn.has(e)||(t.push(e),xn.add(e))}))}})),t.length>0&&(staticRibbon.api.setTrimmedControlIds([],t),!0)},Un={ellipsisOpenInApp:["HostOpenInClient"],ellipsisOpenInBrowser:["HostOpenInBrowser"],ellipsisDownload:["HostDownload"],conversation:["HostConversation"],close:["HostClose"],copyLink:["CopyLink"],share:["CopyLink"],docChat:["DocChat"],openInApp:["EditInApp"]},On=e=>{const t=[],{pollingData:n,externalUICommandDefinitionMapping:a,isRootCommandEnabled:i}=e;return n?.contextualTabIds?.forEach((e=>{const n=a.getTabCommandByExternalUxId(e);if(n){let a=!1;kn.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&kn.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ContextualTabPollingActions")&&!F.a.get_instance().isCompleted(20)?s.AFrameworkApplication.theActionManager.getActionMetadata(parseInt(n))&&(a=i(n)):a=i(n),a&&!xn.has(e)&&(t.push(e),xn.add(e))}})),t.length>0&&(staticRibbon.api.setTrimmedControlIds([],t),!0)},Bn=e=>{const{pollingData:t,externalUICommandDefinitionMapping:n,isRootCommandEnabled:a}=e,i=t.activeGroupIds,o=[];for(const e of i){const i=n.getGroupsMetadataByExternalUxId(e);if(i)for(const e of i){if(a(e.commandId))continue;let n=e.externalUxCommandIds;n||(n=t.controlIdsPerGroup[e.externalUxGroupId]??[]),o.push.apply(o,n)}}o.forEach((e=>{Rn(e,"disabled",!0)}))},Nn=e=>{const{activeControlIds:t}=e.pollingData;Object.keys(t).forEach((n=>{Wn(n,t[n],e)}))},Wn=(e,t,n)=>{const{externalUICommandDefinitionMapping:a}=n,i=a.getCommandByExternalUxId(e),o={UILocation:2};if(i)o.MenuItemId=i.menuItemId,o.SourceControlId=e;else{o.ExternalUxId=e;Hn(e,t,o,n)}Vn(i,e,t,o,n)},Hn=(e,t,n,a)=>{const{pollingData:i,externalUICommandDefinitionMapping:o,isRootCommandEnabled:r}=a;switch(t){case"flyoutAnchor":{const t=i.flyoutMenuItemsById[e];if(!t||!t.length)break;let a=!1,s=!1;if(t.forEach((e=>{const t=o.getCommandByExternalUxId(e);t?r(t.commandId,n)&&(a=!0):s=!0})),a){Rn(e,"disabled",!1);break}Rn(e,"disabled",!s);break}case"splitButton":{const t=i.splitButtonCommandsById[e];if(!t)break;const a=r(t,n);Rn(e,"primaryDisabled",!a),Rn(e,"disabled",!1);break}}},Vn=(e,t,n,a,i)=>{if("previewGallery"===n)Kn(t,e,a,i);else if(e){const o=Gn(e,a,i);Rn(t,"disabled",Qn(o)),qn(t,n,a,o)}},Gn=(e,t,n)=>{let a=0;const{isRootCommandEnabled:i,executeRootCommand:o}=n,{commandId:r,queryCommandId:s}=e;i(r,t)&&(a|=1);const l=new tt.a;return s&&o(s,t,l)&&(a|=2),a},Qn=e=>(1&e)<1,qn=(e,t,n,a)=>{if((e=>(2&e)>0)(a))switch(t){case"toggleButton":case"splitButton":Rn(e,"toggled",n.On);break;case"checkBox":Rn(e,"checked",n.On);break;case"fontPicker":case"comboBox":Rn(e,"text",n.Value??n.SelectedFont?.name);break;case"spinButton":Rn(e,"text",n.Text)}},Kn=(e,t,n,a)=>{if(!t)return[];const{isRootCommandEnabled:i,externalUICommandDefinitionMapping:o}=a,r={UILocation:2};if(r.MenuItemId=t.menuItemId,r.SourceControlId=e,Rn(e,"disabled",!i(t.commandId,r)),t.previewControlIds){const r=[];t.previewControlIds.forEach((s=>{const l=o.getCommandByExternalUxId(s),c={SourceControlId:s};Gn(l||t,c,a),c.On&&Rn(e,"selected",!0);const d=c.GalleryButtonProps;d&&(r.push({topText:d.LabelText,bottomText:d.previewStyleFontNameAndSize,style:d.Style}),Rn(s,"disabled",!i(d.Command,n)))})),Rn(e,"previewGalleryStates",r)}};class zn{getPollForStateAndUpdateActions(){const e=new Array(0);if((0,Pn.d)()&&((e,t,n)=>{Dn={};const a={pollingData:staticRibbon.api.getStaticRibbonPollingData(),externalUICommandDefinitionMapping:e,isRootCommandEnabled:t,executeRootCommand:n},i=On(a),o=Ln();Bn(a),Nn(a),staticRibbon.api.applyControlStates(Object.values(Dn),kn.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveReferencesToRemovedDomElements",!1)),(i||o)&&(0,Pn.a)()})(this._externalUICommandDefinitionMapping,this._rootUser.isRootCommandEnabled.bind(this._rootUser),this._rootUser.executeRootCommand.bind(this._rootUser)),!nt.c())return e;e.push.apply(e,this.getUpdateContextualTabsActions());const t=this.getDisableControlsInTabsActions(appChrome.selectors.getSelectedTabId());if(t.length>0)e.push.apply(e,t);else{const t=appChrome.selectors.getActiveControlIds();if(Object.keys(t).length){const n=this.getDisabledControlsInGroups(appChrome.selectors.getActiveGroupIds());for(const a of n)e.push(appChrome.actions.updateControlEnabledDisabledState(a,!0)),delete t[a];e.push.apply(e,this.getUpdateActionsForCommands(t))}}return e}getGroupedPollForStateAndUpdateActions(){const e=new Array(0);if(!nt.c())return e;e[e.length]=this.getUpdateContextualTabsActions();const t=this.getGroupedDisableControlsInTabActions(appChrome.selectors.getSelectedTabId());if(!(t.length>0)){const t=appChrome.selectors.getActiveControlIds(),n=appChrome.selectors.getActiveGroupIds(),a=this.getRibbonControlsToDisableMap(n);for(const i of n){const n=new Array(0);for(const e of appChrome.selectors.getVisibleControlsInGroup(i)){const i=t[e];a[e]?n.push(appChrome.actions.updateControlEnabledDisabledState(e,!0)):n.push.apply(n,this.getUpdateActionsForCommand(e,i,0,performance?performance.now():Date.now())),delete t[e]}e[e.length]=n}return e[e.length]=this.getUpdateActionsForCommands(t),e}return e.push.apply(e,t),e}pollForStateAndUpdateCommands(e,t,n){nt.c()&&(s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RelevantSurfacesMappingEnabled")&&s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.relevantSurfaceCustomizeMenuFix")&&!n&&7===t&&(n=4),s.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("ReactPollerPFSUWithTimeout")?window.setTimeout((()=>{appChrome.api.dispatch(this.getUpdateActionsForCommands(e,t),n)}),0):appChrome.api.dispatch(this.getUpdateActionsForCommands(e,t),n))}populateControlMenu(e,t,n=null){return this.populateControlMenuAndGetUpdatedControls(e,t,n).populatedMenu}populateControlMenuAndGetUpdatedControls(e,t,n){if(!Gt.d(e)&&e.populationProps&&!this._reactPopulateQueryCommandPoller.skipPopulation(e)){const a=this._reactPopulateQueryCommandPoller.getReduxActionsAndCommandsToPoll(e,t,n);if(!a.wasShadowMenuOpen){let e;(e=a.actions).push.apply(e,this.getUpdateActionsForCommands(a.commandsToPoll,nt.f(n)))}if(a.actions.length>0)return appChrome.api.dispatch(a.actions),{populatedMenu:!0,polledMenuControls:Object.keys(a.commandsToPoll).concat(a.galleriesPolled)}}return{populatedMenu:!1,polledMenuControls:[]}}getUpdateActionsForCommands(e,t=0){const n=new Array(0),a={};if(s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(const e of appChrome.selectors.getActiveGroupIds())for(const t of appChrome.selectors.getVisibleControlsInGroup(e))a[t]=!0;const i=performance?performance.now():Date.now();for(const o in e){const r={key:o,value:e[o]};0===t&&a[r.key]&&(t=2),n.push.apply(n,this.getUpdateActionsForCommand(r.key,r.value,t,i))}return n}getUpdateActionsForCommand(e,t,n=0,a=0){const i=new Array(0),o=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e);let r={};if(appChrome.selectors.isControlDefined(e)&&(r=this._statePropsSelector.getStateProps(e,t)),r.UILocation=n,r.menuInitTime=a,Gt.d(o)){r.ExternalUxId=e;const n=kn.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("OfficeVSO:9874660_EnableChildlessRibbonCommands"),a=this._queryCommandPoller.getEnabledDisabledActionBasedOnChildrenCommands(e,t,r,n);a&&a.length>0&&i.push.apply(i,a)}else r.MenuItemId=o.menuItemId,r.SourceControlId=e;return i.push.apply(i,this._queryCommandPoller.getReduxActions(o,t,r)),i}getUpdateContextualTabsActions(){const e=new Array(0),t=appChrome.selectors.getContextualTabIds(),n=appChrome.selectors.getActiveContextualTabIds();for(let a=0;a<t.length;a++){const i=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(t[a]);if(i){let o=!1;kn.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&kn.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ContextualTabPollingActions")&&!F.a.get_instance().isCompleted(20)?s.AFrameworkApplication.theActionManager.getActionMetadata(parseInt(i))&&(o=this._rootUser.isRootCommandEnabled(i)):o=this._rootUser.isRootCommandEnabled(i);Array.indexOf(n,t[a])>=0!==o&&e.push(appChrome.actions.activateDeactivateContextualTab(t[a],o))}}return e}getDisableControlsInTabsActions(e){const t=new Array(0),n=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(e);if(n){this._rootUser.isRootCommandEnabled(n)||t.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(e,!0))}return t}getGroupedDisableControlsInTabActions(e){const t=new Array(0),n=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(e);if(n){if(!this._rootUser.isRootCommandEnabled(n)){const e=appChrome.selectors.getActiveGroupIds();for(const n of e){const e=new Array(0);for(const t of appChrome.selectors.getVisibleControlsInGroup(n))e.push(appChrome.actions.updateControlEnabledDisabledState(t,!0));t[t.length]=e}}}return t}getRibbonControlsToDisableMap(e){const t=this.getDisabledControlsInGroups(e),n={};for(const e of t)n[e]=!0;return n}getDisabledControlsInGroups(e){const t=new Array(0);for(const n of e){const e=this._externalUICommandDefinitionMapping.getGroupsMetadataByExternalUxId(n);if(e)for(const n of e){if(this._rootUser.isRootCommandEnabled(n.commandId))continue;let e=n.externalUxCommandIds;e||(e=appChrome.selectors.getVisibleControlsInGroup(n.externalUxGroupId)),t.push.apply(t,e)}}return t}getDisableControlsInGroupsActions(e){const t=new Array(0);for(const n of e){const e=this._externalUICommandDefinitionMapping.getGroupsMetadataByExternalUxId(n);if(e)for(const n of e){if(!this._rootUser.isRootCommandEnabled(n.commandId))if(n.externalUxCommandIds)for(const e of n.externalUxCommandIds)t.push(appChrome.actions.updateControlEnabledDisabledState(e,!0));else t.push(appChrome.actions.updateDisabledEnabledStateForControlsInGroup(n.externalUxGroupId,!0))}}return t}constructor(e,t,n){this._externalUICommandDefinitionMapping=e,this._rootUser=t;const a=new Mn.a;this._statePropsSelector=new vn,this._reactGalleryPoller=new Qt(a,this._rootUser,n,this._externalUICommandDefinitionMapping),this._reactPopulateQueryCommandPoller=new In(a,this._rootUser,n,this._externalUICommandDefinitionMapping,this._reactGalleryPoller),this._queryCommandPoller=new En(a,this._rootUser,this._externalUICommandDefinitionMapping,n,this._reactGalleryPoller)}}(0,a.a)(zn,"ReactRibbonRootPoller",null,[155]);class jn{get lastPollTime(){return this._lastPollTime||(this._lastPollTime=new Date,this._lastPollTime.setTime(0)),this._lastPollTime}set lastPollTime(e){this._lastPollTime=e}get rootType(){return 2}get rootUser(){return this._rootUser}set rootUser(e){this._rootUser=e}get reactRibbonRootPoller(){return this._reactRibbonRootPoller||(this._reactRibbonRootPoller=new zn(this._reactCommandDefinitionMapping,this.rootUser,this.rootType)),this._reactRibbonRootPoller}commitAnyPendingChange(){const e=document.activeElement;B.a.isEditable(e)&&e.blur()}executeCommand(e,t,n,a,i,o,r,s=2){if(!Gt.d(this.rootUser)){const i=new tt.a;i.CommandLocation=s,i.InvocationMethod=a,i.CommandTabName=n,t.UILocation=s,this.rootUser.executeRootCommand(e,t,i,o,r),this.logCommandActivity(e,t,n)}}getPollForStateAndUpdateActions(){return Gt.d(this.rootUser)?new Array(0):this.reactRibbonRootPoller.getPollForStateAndUpdateActions()}getGroupedPollForStateAndUpdateActions(){return Gt.d(this.rootUser)?new Array(0):this.reactRibbonRootPoller.getGroupedPollForStateAndUpdateActions()}pollForStateAndUpdate(){const e=this.getPollForStateAndUpdateActions();e.length>0&&(this.lastPollTime=new Date,appChrome.api.dispatch(e))}updatePeopleWellControl(){if(nt.c()){const e={PeopleWell:"PeopleWell"};this.reactRibbonRootPoller.pollForStateAndUpdateCommands(e,18)}}updateControl(e){}logCommandActivity(e,t,n){try{const n=(0,D.j)(te.a);if(n&&t){const a=t.SqmControlId?"_"+t.SqmControlId:"",i=t.SourceControlId||t.launcherId||t.LegacyId||t.NewContextId,o="Ribbon";let r=(i?"_"+i:"")+a;r=r.length?r:"_"+e;const s=o+r;n.logActivityDeferred(s,null)}}catch(e){i.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(e?e.toString():""))}}constructor(e,t,n=null){this._reactRibbonRootPoller=null,this._lastPollTime=null,this._rootUser=null,this._reactCommandDefinitionMapping=t,e.addRoot(this),this.rootUser=n}}(0,a.a)(jn,"ReactRibbonRoot",null,[153,152]);var Zn=n(8304),Xn=n(5434);const Jn=(0,D.b)("Common.IReactContextualUILauncher");var Yn=n(9855);class $n{onMenuOpen(){this._menuStack>0?this._menuStack++:(this._menuStack++,s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame((e=>{window.setTimeout(this.pushTransientFocusScope,0)})):this.pushTransientFocusScope(),this.showModal())}isToolbarMode(){const e=document.getElementById("WACToolbarContainer");return!!e&&"block"===e.style.display}getRibbonMode(){return this._isSingleLineToolbarEnabled&&this.isToolbarMode()?"Toolbar":nt.e()}getCachedTopPaddingKey(){const e=this.getRibbonMode(),t=appChrome.selectors.getShyState(),n=this._isShyRibbonEnabled&&t.isActive&&0!==t.state?"_ShyRibbon":"",a=this._isResponsiveUxEnabled&&t.isActive?"_ResponsiveUx":"";return String.format("{0}{1}{2}",e,n,a)}getTopPadding(e){let t=0;if(this._isRegionComposerEnabled){if(this._cachedTopPadding[e])return this._cachedTopPadding[e];const n=document.getElementById("BusinessBar");n||i.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div"),t=n?n.offsetTop:0,this._cachedTopPadding[e]=t}return t}showModal(){if(!this._elmModalDiv)if(this._elmModalDiv=this.createElement("div"),this._elmModalDiv.setAttribute("id","ReactModalDiv"),this._elmModalDiv.style.position="absolute",this._elmModalDiv.style.bottom="0px",this._elmModalDiv.style.left="0px",this._elmModalDiv.style.right="0px",this._elmModalDiv.style.backgroundColor="white",this._elmModalDiv.style.opacity="0.0",this._isRegionComposerEnabled){const e=document.getElementById("regionComposerRoot");e&&e.appendChild(this._elmModalDiv)}else this._modalContainer.appendChild(this._elmModalDiv);const e=this.getCachedTopPaddingKey();if(e!==this._lastCachedTopPaddingState){const t=this.getTopPadding(e),n=appChrome.selectors.getShyState();if(this._isShyRibbonEnabled&&n.isActive&&0!==n.state){const e=this._isSingleLineToolbarEnabled?appChrome.api.getRibbonHeight("Multiline")-appChrome.api.getRibbonHeight("SingleLine"):appChrome.api.getRibbonHeight(nt.e());this._elmModalDiv.style.top=String.format("{0}px",t+e)}else this._elmModalDiv.style.top=String.format("{0}px",t);this._lastCachedTopPaddingState=e}this._elmModalDiv.style.display="block",this._elmModalDiv.style.visibility="visible",this._elmModalDiv.style.zIndex=String(1e3),this._registeredHandlers||(window.addEventListener("wheel",this._onMouseWheelBlockAppZoom,{passive:!1}),this.isMenuDismissPerfImprovementsEnabled()?Yn.a.instance.registerHandler(L.a.pointerUp,this._elmModalDiv,this.onModalPointerUp):Yn.a.instance.registerHandler(L.a.pointerDown,this._elmModalDiv,this.onModalPointerDown),this._registeredHandlers=!0)}onMenuClose(){this._menuStack--,this._menuStack>0||(this._menuStack<0?this._menuStack=0:this.hideModalAndPopScopeWrapper())}onCloseAllMenus(){this._menuStack=0,this.dismissContextMenu(),this.hideModalAndPopScopeWrapper()}createElement(e){const t=document.createElement(e);return t.setAttribute("unselectable","on"),t}hideModalAndPopScope(){this._focusManager&&this._focusManager.currentScope&&this._focusManager.currentScope.name===r.a.reactTransientUIFocusId&&!s.AFrameworkApplication.theTaskManager.isYielding&&this._focusManager.popScope(r.a.reactTransientUIFocusId,!1),this._elmModalDiv&&(this._elmModalDiv.style.zIndex=String(-1),this._elmModalDiv.style.visibility="hidden",this._elmModalDiv.style.display="none"),this._registeredHandlers&&(window.removeEventListener("wheel",this._onMouseWheelBlockAppZoom,{passive:!1}),this.isMenuDismissPerfImprovementsEnabled()?Yn.a.instance.unregisterHandler(L.a.pointerUp,this._elmModalDiv,this.onModalPointerUp):Yn.a.instance.unregisterHandler(L.a.pointerDown,this._elmModalDiv,this.onModalPointerDown),this._registeredHandlers=!1)}hideModalAndPopScopeWrapper(){this.isMenuDismissPerfImprovementsEnabled()||this.isHideModalAndPopScopePerfImprovementsEnabled()?window.requestAnimationFrame((e=>{window.setTimeout((()=>{this.hideModalAndPopScope()}),0)})):this.hideModalAndPopScope()}setFocusOnDocument(){4===s.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?s.AFrameworkApplication.activeFrame.setFocusOnDocument():this._focusManager.setScope(r.a.documentFocusID)}dismissContextualUI(){const e=(0,D.j)(Jn);e&&e.dismissContextualUI()}dismissContextMenu(){const e=(0,D.j)(Jn);e&&e.dismissContextMenu()}dismissFileMenu(){s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isReactFileMenuUxEnabled&&(!this.isMenuDismissPerfImprovementsEnabled()||appChrome.selectors.getFileMenuExpanded())&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}isMenuDismissPerfImprovementsEnabled(){return s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}isHideModalAndPopScopePerfImprovementsEnabled(){return this._appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideModalAndPopScope",!1)&&null!=window.Event&&null!=window.Event.ActionCommandId&&!this._hideModalAndPopScopeDelayExcludedUserActions.has(window.Event.ActionCommandId)}constructor(e,t){this._elmModalDiv=null,this._registeredHandlers=!1,this._menuStack=0,this._lastCachedTopPaddingState="",this._cachedTopPadding={},this._hideModalAndPopScopeDelayExcludedUserActions=new Set,this.pushTransientFocusScope=()=>{this._focusManager&&this._focusManager.pushScope(r.a.reactTransientUIFocusId,!0)},this.onModalPointerDown=e=>(e.preventDismissTransientUI||this.dismissContextualUI(),this.dismissFileMenu(),this.onCloseAllMenus(),this.setFocusOnDocument(),!0),this.onModalPointerUp=e=>(this.dismissContextualUI(),this.dismissFileMenu(),this.onCloseAllMenus(),window.requestAnimationFrame((e=>{window.setTimeout((()=>{this.setFocusOnDocument()}),0)})),!0),this.onModalMouseWheelBlockAppZoom=e=>{e.stopPropagation();(e.ctrlKey||e.metaKey)&&(i.ULS.sendTraceTag(508045274,306,50,"Blocking App Zoom on ModalDiv"),e.preventDefault())},this._modalContainer=e,this._focusManager=t,this._onMouseWheelBlockAppZoom=this.onModalMouseWheelBlockAppZoom,this._isShyRibbonEnabled=!!s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isShyRibbonEnabled,this._isRegionComposerEnabled=!!s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isRegionComposerEnabled,this._isSingleLineToolbarEnabled=!!s.AFrameworkApplication.appSettingsManager&&s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1),this._isResponsiveUxEnabled=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ResponsiveUxIsEnabled"),this._appSettingsManager=s.AFrameworkApplication.appSettingsManager;const n=this._appSettingsManager?.getStringAppSetting("HideModalAndPopScopeDelayExclusionList")??"";n&&""!=n&&(this._hideModalAndPopScopeDelayExcludedUserActions=new Set(n.split(",")))}}(0,a.a)($n,"ReactModalDiv",null,[]);var ea=n(9037),ta=n(657),na=n(965),aa=n(1105);const ia=(0,D.e)(aa.a);var oa=n(7481),ra=n(1779),sa=n(8599);class la{get documentFonts(){return this._documentFonts}getFonts(){return this._documentFonts}isEmpty(){return!this._documentFonts.count}contains(e){return this._documentFonts.containsKey(e)}getFontInfo(e){return this.contains(e)?this._documentFonts.get_item(e):null}constructor(){this._documentFonts=new sa.a(ra.a.get_ordinalIgnoreCase())}}(0,a.a)(la,"DocumentFontsManager",null,[]);var ca=n(9224);class da{constructor(){this.fontToApply=null,this.themeIndex=null}}(0,a.a)(da,"FontFamilyExtraData",null,[301]);class ua{constructor(){this.name=null,this.fontKey=null,this.displayName=null,this.submenu=null,this.fontType=null,this.data=null}}(0,a.a)(ua,"FontFamilyProps",null,[]);class pa{constructor(){this.name=null,this.mruKey=null,this.variantType=null,this.isThemeFont=!1,this.themeStyle=null,this.displayName=null,this.fontFamilyKey=null,this.previewFontName=null,this.data=null}}(0,a.a)(pa,"FontPickerMruEntryProps",null,[]);class ga{constructor(){this.fonts=null,this.mruList=null,this.initialPinnedFontKeys=null,this.suggestedFontKeys=null,this.menuId=null,this.isShadowMenuOpen=!1}}(0,a.a)(ga,"FontPickerProps",null,[]);class ha{constructor(){this.showFontInfoCommand=!1,this.variants=null}}(0,a.a)(ha,"FontSubmenuProps",null,[]);class ma{constructor(){this.fontToApply=null,this.themeIndex=null,this.isBold=!1,this.isItalic=!1}}(0,a.a)(ma,"FontVariantExtraData",null,[301]);class _a{constructor(){this.variantKey=null,this.name=null,this.displayName=null,this.fullDisplayName=null,this.parentKey=null,this.order=0,this.data=null}}(0,a.a)(_a,"FontVariantProps",null,[]);var Sa=n(9086),fa=n(6336);class Ca{get fontName(){return this._fontName}get isSymbol(){return this._isSymbol}get codepoint(){return this._codepoint}get fontSource(){return this._fontSource}constructor(e,t,n,a=0){this._fontName=e,this._isSymbol=t,this._codepoint=n,this._fontSource=a}}(0,a.a)(Ca,"FontInfo",null,[]);var ya=n(3758);class Aa{aclBitsIndex(){return this._aclBitsIndex}aclMask(){return this._aclMask}constructor(e,t){this._aclBitsIndex=e,this._aclMask=t}}(0,a.a)(Aa,"AccessControlInfo",null,[]);class ba{static isACLHidden(e){return!!e&&!!(e[ba.aclHidden.aclBitsIndex()]&ba.aclHidden.aclMask())}}ba.aclHidden=new Aa(0,256),(0,a.a)(ba,"FontAclProperties",null,[]);class Ta{static getFontFamilyName(e,t){if(!e)return t;const n=e[t];return n&&n.length?n[0].fontFamily:t}}(0,a.a)(Ta,"FontUtilsStatic",null,[]);class va{addOrBuildHiddenFontFamilySet(e){if(e){this._hiddenFontFamilySet||(this._hiddenFontFamilySet=new ya.a);for(const t in e){const n={key:t,value:e[t]}.value;if(n.length>0){const e=n[0];ba.isACLHidden(e.ACL)&&this._hiddenFontFamilySet.add(e.fontFamily)}}for(const t of this._hiddenFontsStage)this._hiddenFontsStage.remove(t),this.removeHiddenFont(e,t)}}isFontHidden(e,t){if(!this.areHiddenFontFamiliesInitialized()||!t)return!1;let n=t;return e&&(n=Ta.getFontFamilyName(e,t)),this._hiddenFontFamilySet.contains(n)}removeHiddenFonts(e,t){if(t)for(const n of t)e?this.removeHiddenFont(e,n):this.addToHiddenFontStage(n)}removeHiddenFont(e,t){if(!t)return;if(!this.areHiddenFontFamiliesInitialized())return void this.addToHiddenFontStage(t);let n=t;e&&(n=Ta.getFontFamilyName(e,t)),this._hiddenFontFamilySet.remove(n)}addToHiddenFontStage(e){e&&(this.areHiddenFontFamiliesInitialized()||this._hiddenFontsStage.add(e))}areHiddenFontFamiliesInitialized(){return!!this._hiddenFontFamilySet}constructor(){this._hiddenFontsStage=new ya.a,this._hiddenFontFamilySet=null}}(0,a.a)(va,"HiddenFontsManager",null,[]);class wa{get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=e}addFont(e){if(this._mruFontNameList||(this._mruFontNameList=[]),Array.contains(this._mruFontNameList,e)){const t=Array.indexOf(this._mruFontNameList,e);if(!t)return;Array.removeAt(this._mruFontNameList,t)}this._mruFontNameList.length===this._maxSize&&Array.removeAt(this._mruFontNameList,this._mruFontNameList.length-1),Array.insert(this._mruFontNameList,0,e)}getFonts(){return this._mruFontNameList}currentSize(){return this._mruFontNameList?this._mruFontNameList.length:0}constructor(){this._maxSize=10,this._mruFontNameList=null}}(0,a.a)(wa,"MruFontsManager",null,[]);class Fa{get onDemandFonts(){return this._onDemandFonts}getFonts(){return this._onDemandFonts}isEmpty(){return!this._onDemandFonts.count}isFontAvailableOnDemand(e){return this._onDemandFonts.containsKey(e)}getFontInfo(e){return this.isFontAvailableOnDemand(e)?this._onDemandFonts.get_item(e):null}removeFont(e){this.isFontAvailableOnDemand(e)&&this._onDemandFonts.remove(e)}constructor(){this._onDemandFonts=new sa.a(ra.a.get_ordinalIgnoreCase())}}(0,a.a)(Fa,"OnDemandFontsManager",null,[]);class Ia{static get themeFonts(){return Ia._themeFonts}static set themeFonts(e){Ia._themeFonts=e}static get themeFontsNames(){return Ia._themeFontsNames}static set themeFontsNames(e){Ia._themeFontsNames=e}}Ia._themeFonts=null,Ia._themeFontsNames=null,(0,a.a)(Ia,"ThemeFontsManagerStatic",null,[]);class Ea{getFonts(){return Ia.themeFonts}isEmpty(){return!Ia.themeFonts||!Ia.themeFonts.length}contains(e){return!!Ia.themeFontsNames&&!!Ia.themeFontsNames[e]}getFontInfo(e){return this.contains(e)?Ia.themeFonts[Ia.themeFontsNames[e]]:null}}(0,a.a)(Ea,"ThemeFontsManager",null,[]);class Ma{get fontName(){return this._fontName}get isBold(){return this._isBold}get isItalic(){return this._isItalic}toString(){return String.format("{0}_{1}_{2}",this.fontName,Ma.getCSSFontWeight(this.isBold),Ma.getCSSFontStyle(this.isItalic))}equals(e){return!!e&&(e.fontName===this.fontName&&e.isBold===this.isBold&&e.isItalic===this.isItalic)}getCustomHashCode(){return-1===this._customHashCode&&(this._customHashCode=Ma.getCustomHashCodeUtil(this.fontName)),this._customHashCode}static getCSSFontStyle(e){return e?"italic":"normal"}static getCSSFontWeight(e){return e?"bold":"normal"}static getCustomHashCodeUtil(e){if(null==e)return-1;let t=0;const n=e.length;for(let a=0;a<n;a++)t+=e.charCodeAt(a)*Math.pow(31,n-a),t|=0;return t}constructor(e,t=!1,n=!1){this._customHashCode=-1,this._fontName=e,this._isBold=t,this._isItalic=n}}(0,a.a)(Ma,"FontProperties",null,[165]);var ka=n(205);const Pa="_MSFontService",Da="swap",Ra="'Segoe UI',Tahoma,Sans-Serif;",xa="font-size:12pt;font-family:{0};",La="_MSCustomFont",Ua="_EmbeddedFont",Oa=["-apple-system","system-ui","BlinkMacSystemFont"];var Ba,Na,Wa;!function(e){e.Cloud="cloud",e.Embedded="embedded",e.Custom="custom"}(Ba||(Ba={})),(0,a.b)("FontType",Ba),function(e){e.Cloud="_MSFontService",e.Embedded="_EmbeddedFont",e.Custom="_MSCustomFont"}(Na||(Na={})),(0,a.b)("FontSuffix",Na),function(e){e.Pending="Pending",e.Illegal="Illegal",e.Unsupported="Unsupported",e.Supported="Supported"}(Wa||(Wa={})),(0,a.b)("FontStatus",Wa);class Ha{static get illegalFontChars(){return Ha._illegalFontChars.value}static get_commonFontsCss(){return Ha._commonFontsCss.value}static get_customFontAlternateNameDict(){return Ha._customFontAlternateNameDict.value}static createIllegalFontCharsRegex(){let e="[\"'\\\\;:&#()\\r\\n\\<\\>]";return s.AFrameworkApplication.activeFrame&&Ha.appSettingsManager&&Ha.appSettingsManager.isChangeGateEnabled("CorrectFontValidation")&&2===s.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&(e+="|^\\d+$"),new RegExp(e)}static createCustomFontAlternateNameDict(){try{return Sys.Serialization.JavaScriptSerializer.deserialize(Ha.appSettingsManager.getStringAppSetting("CustomFontAlternateName"),!0)}catch(e){return i.ULS.sendTraceTag(506798983,306,50,"FontUtils:getCustomFontAlternateNameDict Exception while parsing BRS CustomFontAlternateName: {0}"),[]}}static createCommonFontsCss(){const e=new De.a;return e.set_item("Angsana New","Angsana New,Serif"),e.set_item("Aptos","Aptos,Sans-Serif"),e.set_item("Aptos Display","Aptos Display,Sans-Serif"),e.set_item("Aptos Narrow","Aptos Narrow,Sans-Serif"),e.set_item("Arial Black","Arial Black,Sans-Serif"),e.set_item("Arial","Arial,Sans-Serif"),e.set_item("Batang","Batang,Serif"),e.set_item("Book Antiqua","Book Antiqua,Serif"),e.set_item("Bookman Old Style","Bookman Old Style,Serif"),e.set_item("Browallia New","Browallia New,Sans-Serif"),e.set_item("Calibri","Calibri,Sans-Serif"),e.set_item("Cambria","Cambria,Serif"),e.set_item("Candara","Candara,Sans-Serif"),e.set_item("Century Gothic","Century Gothic,Sans-Serif"),e.set_item("Century Schoolbook","Century Schoolbook,Serif"),e.set_item("Century","Century,Serif"),e.set_item("Comic Sans MS","Comic Sans MS,Fantasy"),e.set_item("Community","Community,Sans-Serif"),e.set_item("Community Light","Community Light,Community,Sans-Serif"),e.set_item("Community Semibold","Community Semibold,Community,Sans-Serif"),e.set_item("Community Slab","Community Slab,Serif"),e.set_item("Community Slab Medium","Community Slab Medium,Community Slab,Serif"),e.set_item("Community Slab Semibold","Community Slab Semibold,Community Slab,Serif"),e.set_item("Consolas","Consolas,monospace"),e.set_item("Constantia","Constantia,Serif"),e.set_item("Corbel","Corbel,Sans-Serif"),e.set_item("Cordia New","Cordia New,Sans-Serif"),e.set_item("Courier New","Courier New,monospace"),e.set_item("DaunPenh","DaunPenh,Sans-Serif"),e.set_item("DilleniaUPC","DilleniaUPC,Serif"),e.set_item("Dotum","Dotum,Sans-Serif"),e.set_item("FangSong","FangSong,Serif"),e.set_item("Franklin Gothic Book","Franklin Gothic Book,Sans-Serif"),e.set_item("Franklin Gothic Medium","Franklin Gothic Medium,Sans-Serif"),e.set_item("Garamond","Garamond,Serif"),e.set_item("Gautami","Gautami,Sans-Serif"),e.set_item("Georgia","Georgia,Serif"),e.set_item("Gill Sans MT","Gill Sans MT,Sans-Serif"),e.set_item("Gulim","Gulim,Sans-Serif"),e.set_item("GungSuh","GungSuh,Serif"),e.set_item("HGGothicE","HGGothicE,Sans-Serif"),e.set_item("HGGyoshotai","HGGyoshotai,Sans-Serif"),e.set_item("HGPMinchoE","HGPMinchoE,Serif"),e.set_item("HYGothic-Extra","HYGothic-Extra,Serif"),e.set_item("HYMyeongJo-Extra","HYMyeongJo-Extra, Sans-Serif"),e.set_item("Iskoola Pota","Iskoola Pota,Sans-Serif"),e.set_item("JasmineUPC","JasmineUPC,Serif"),e.set_item("KaiTi","KaiTi, Sans-Serif"),e.set_item("Kalinga","Kalinga,Sans-Serif"),e.set_item("Kartika","Kartika,Sans-Serif"),e.set_item("Latha","Latha,Sans-Serif"),e.set_item("LiSu","LiSu,Serif"),e.set_item("LKN Sans","LKN Sans,Sans-Serif"),e.set_item("LKN Sans Light","LKN Sans Light,LKN Sans,Sans-Serif"),e.set_item("LKN Sans Semibold","LKN Sans Semibold,LKN Sans,Sans-Serif"),e.set_item("Lucida Sans Unicode","Lucida Sans Unicode,Sans-Serif"),e.set_item("Lucida Sans","Lucida Sans,Sans-Serif"),e.set_item("Malgun Gothic","Malgun Gothic,Sans-Serif"),e.set_item("Mangal","Mangal,Sans-Serif"),e.set_item("Meiryo","Meiryo,Sans-Serif"),e.set_item("Microsoft JhengHei","Microsoft JhengHei,Sans-Serif"),e.set_item("Microsoft YaHei","Microsoft YaHei,Sans-Serif"),e.set_item("MingLiU","MingLiU,Serif"),e.set_item("MingLiU_HKSCS","MingLiU_HKSCS,Serif"),e.set_item("MS Gothic","MS Gothic,Sans-Serif"),e.set_item("MS Mincho","MS Mincho,Serif"),e.set_item("MS PGothic","MS PGothic,Sans-Serif"),e.set_item("MS PMincho","MS PMincho,Serif"),e.set_item("Nyala","Nyala,Sans-Serif"),e.set_item("PMingLiU","PMingLiU,Serif"),e.set_item("PMingLiU-ExtB","PMingLiU-ExtB,Serif"),e.set_item("Raavi","Raavi,Sans-Serif"),e.set_item("Rockwell","Rockwell,Serif"),e.set_item("Segoe Light","Segoe Light,Sans-Serif"),e.set_item("Segoe UI Light","Segoe UI Light,Sans-Serif"),e.set_item("Segoe UI","Segoe UI,Sans-Serif"),e.set_item("Segoe","Segoe,Sans-Serif"),e.set_item("Shruti","Shruti,Sans-Serif"),e.set_item("SimHei","SimHei,Sans-Serif"),e.set_item("SimSun","SimSun,Serif"),e.set_item("SimSun-ExtB","SimSun-ExtB,Serif"),e.set_item("STKaiti","STKaiti,Sans-Serif"),e.set_item("STXingkai","STXingkai,Sans-Serif"),e.set_item("STXinwei","STXinwei,Sans-Serif"),e.set_item("Sylfaen","Sylfaen,Serif"),e.set_item("Tahoma","Tahoma,Sans-Serif"),e.set_item("TH SarabunPSK","TH SarabunPSK,Sans-Serif"),e.set_item("Times New Roman","Times New Roman,Serif"),e.set_item("Times","Times,Times New Roman,Serif"),e.set_item("Trebuchet MS","Trebuchet MS,Sans-Serif"),e.set_item("Tunga","Tunga,Sans-Serif"),Ha.appSettingsManager?.getBooleanAppSetting("FixTwCenMtFont")?e.set_item("Tw Cen MT","Tw Cen MT,Sans-Serif"):e.set_item("TW Cen MT","TW Cen MT,Sans-Serif"),e.set_item("Verdana","Verdana,Sans-Serif"),e.set_item("Vrinda","Vrinda,Sans-Serif"),e}static isFontPickerOfficeFontsSectionCacheEnabled(){if(void 0===Ha.isFontPickerOfficeFontsSectionCacheFixEnabled){const e=appChrome?.api?.getSharedUxSettings()?.commonSettings;if(e){const t=e();Ha.isFontPickerOfficeFontsSectionCacheFixEnabled=!!(t&&t.isFontPickerOfficeFontsSectionCacheEnabled&&t.isFontPickerOfficeFontsSectionCacheEnabled())}}return Ha.isFontPickerOfficeFontsSectionCacheFixEnabled}static getFirstFontName(e){return e.split(",")[0]}static isSafeFontName(e){if(!e)return!1;const t=e.match(Ha.illegalFontChars);return!(t&&t.length>0)||(i.ULS.sendTraceTag(574166290,306,50,"Font contains illegal chars :"+t[0]),!1)}static isFontAvailable(e){return e in Ha._supportedFonts}static addFontToSupportedList(e,t){Ha.addSupportedFont(e,t)}static convertFontNameToCSSValue(e){let t;return e&&""!==e?({value:t}=Ha.get_commonFontsCss().tryGetValue(e)).returnValue?t:Ha.allowSpecialCharacterFontsToRender()?-1===e.indexOf("'")?"'"+e+"',Sans-Serif":'"'+e+'",Sans-Serif':Ha.isSafeFontName(e)?Ha.isRemoveQuotesFromWingdingsFontsFixEnabled||-1===ce.a.toUpper(e).indexOf(Ha.wingdingsFontsPrefix)?e+",Sans-Serif":"'"+e+"',Sans-Serif":"Sans-Serif":"Sans-Serif"}static addDefaultCallbackFont(e){return e&&""!==e?e+",Sans-Serif":"Sans-Serif"}static getFontServiceFontName(e){return Ha.getFallbackFontName(e,Pa)}static getFallbackFontName(e,t){return(e.startsWith("'")||e.startsWith('"'))&&(e=e.substring(1,e.length-1)),Ha.isRemoveQuotesFromWingdingsFontsFixEnabled||-1===ce.a.toUpper(e).indexOf(Ha.wingdingsFontsPrefix)?Ha.allowSpecialCharacterFontsToRender()?e.indexOf("'")>-1?'"'+e+t+'"':"'"+e+t+"'":e+t:"'"+e+t+"'"}static getFirstFontCss(e){let t;if(!e)return t="",{returnValue:"",fallbackFonts:t};const n=e.indexOf(",");return n<=0?(t="",{returnValue:e,fallbackFonts:t}):(t=e.substr(n+1),{returnValue:e.substring(0,n),fallbackFonts:t})}static addFontServiceFallbackFont(e,t){let n="";({fallbackFonts:n,returnValue:t}=Ha.getFirstFontCss(t));const a=Ha.getFontServiceFontName(e);return""===t||(t+=","+a,n&&""!==n&&(t+=","+n)),t}static get_fontStyleIncludedList(){return Ha._fontStyleIncludedList}static get legalCssClassNameChars(){return Ha._legalCssClassNameChars.value}static get customFontCatalogUrl(){return Ha._customFontCatalogUrl}static get customFontBaseUrl(){return Ha._customFontBaseUrl}static get customFontCatalogVersion(){return Ha._customFontCatalogVersion}static get customFontEncData(){return Ha._customFontEncData}static get isCustomFontAlreadyPresentInDocument(){return Ha._isCustomFontAlreadyPresentInDocument}static get_allFonts(){return Ha.get_commonFontsCss()}static get fontSupportThroughCanvasIsEnabled(){return!!Ha.appSettingsManager&&Ha.appSettingsManager.getBooleanAppSetting("FontSupportThroughCanvasIsEnabled")}static get suggestedFontsExperimentEnabled(){return!!Ha.appSettingsManager&&Ha.appSettingsManager.getBooleanAppSetting("SuggestedFontsExperimentEnabled")}static get isRemoveQuotesFromWingdingsFontsFixEnabled(){return!!s.AFrameworkApplication.activeFrame&&!!Ha.appSettingsManager&&Ha.appSettingsManager.isChangeGateEnabled("Microsoft.Office.PowerPointOnline.ChangeGate.RemoveQuotesFromWingdingsFontsFix")&&2===s.AFrameworkApplication.activeFrame.applicationInstance.officeAppType}static get appSettingsManager(){return Ha._appSettingsManager||(Ha._appSettingsManager=s.AFrameworkApplication.appSettingsManager),Ha._appSettingsManager}static set appSettingsManager(e){Ha._appSettingsManager=e}static isFontBoldnessFixEnabled(){return Ha._appSettingsManager.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FontImprovementsV3Experiment",!1)}static get_isFontSupportedFunction(){return Ha._isFontSupportedFunction||(Ha.fontSupportThroughCanvasIsEnabled?Ha._isFontSupportedFunction=Ha.isFontSupportedOnCanvas:(Ha.addFontDetectionSpan(),Ha._isFontSupportedFunction=Ha.isFontSupportedOnSpan)),Ha._isFontSupportedFunction}static set_isFontSupportedFunction(e){return Ha._isFontSupportedFunction=e,e}static get stopwatchBuilder(){return Ha._stopwatchBuilder||(Ha._stopwatchBuilder=(0,D.a)(ia)),Ha._stopwatchBuilder}static set stopwatchBuilder(e){Ha._stopwatchBuilder=e}static getUnsupportedFonts(e){const t=[];return e||(t.push("HGGyoshotai"),t.push("HYGothic - Extra"),t.push("HYMyeongJo - Extra"),t.push("LiSu"),t.push("Segoe Light"),t.push("Segoe UI Light"),t.push("Segoe UI"),t.push("Segoe"),t.push("Times")),t}static get isFontSupportedOnCanvasContext(){if(!Ha._isFontSupportedOnCanvasContext){const e=document.createElement("canvas");Ha._isFontSupportedOnCanvasContext=e.getContext("2d")}return Ha._isFontSupportedOnCanvasContext}static createCustomFontConfigUrl(){return null}static convertFontSizeToCSSValue(e){return e/2+"pt"}static isFontServiceName(e){return e.endsWith(Pa)}static isCustomFontName(e){return e.length>13&&e.endsWith(La)}static isEmbeddedFontName(e){return e.endsWith(Ua)}static correctFontHavingFontSuffix(e){return e?(Ha.isFontServiceName(e)?e=e.substring(0,e.length-14):(Ha.isEmbeddedFontName(e)||Ha.isCustomFontName(e))&&(e=e.substring(0,e.length-13)),e):e}static addSupportedFont(e,t){Ha._supportedFonts[e]=!0}static addAllSupportedFonts(e=!1){let t=null;Ha._addAllSupportedFontsPerfLogged||(t=Ha.stopwatchBuilder.makeAndStartStopwatch("LoadResource","SupportedFonts"),Ha._addAllSupportedFontsPerfLogged=!0),Ha._fontServiceFontEnabled?Ha.areFontsSupported(Ha.getUnsupportedFonts(e)):Ha.areFontsSupported(ka.d(Ha.get_allFonts().keys)),t&&t.stop()}static convertFontNamesToCSSValue(e){const t=e.split(",");if(!t||!t.length)return"Sans-Serif";const n=new Ne.a;let a;for(let i=0;i<t.length&&({value:a}=Ha.get_commonFontsCss().tryGetValue(e)).returnValue;i++)if(n.add(a),i===t.length-1)return n.toArray().join(",");n.clear();for(const e of t)Ha.allowSpecialCharacterFontsToRender()?e.indexOf("'")>-1?n.add('"'+e+'"'):n.add("'"+e+"'"):Ha.isSafeFontName(e)&&(Ha.isRemoveQuotesFromWingdingsFontsFixEnabled||-1===ce.a.toUpper(e).indexOf(Ha.wingdingsFontsPrefix)?n.add(e):n.add("'"+e+"'"));return n.count>0?n.toArray().join(",")+",Sans-Serif":"Sans-Serif"}static allowSpecialCharacterFontsToRender(){return!!s.AFrameworkApplication.activeFrame&&!!s.AFrameworkApplication.appSettingsManager&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AllowSpecialCharacterFontsToRender")&&(3===s.AFrameworkApplication.activeFrame.applicationInstance.officeAppType||2===s.AFrameworkApplication.activeFrame.applicationInstance.officeAppType)}static isEmbeddedFont(e){return!!Ha._embeddedFontDictionary&&e in Ha._embeddedFontDictionary||!!Ha._embeddedFontsForTelemetry&&e in Ha._embeddedFontsForTelemetry}static isFontServiceFont(e){return!!Ha._fontServiceFontDictionary&&e in Ha._fontServiceFontDictionary}static isCustomServiceFont(e){return!!Ha._customFontDictionary&&e in Ha._customFontDictionary}static doesFontBelongToSubFamily(e,t){return!!t&&Object.values(t).some((t=>Array.isArray(t)&&t.some((({fontName:t})=>t===e))))}static doesFontBelongToCustomSubFamily(e){return Ha.doesFontBelongToSubFamily(e,Ha._customFontDictionary)}static doesFontBelongToOfficeSubFamily(e){return Ha.doesFontBelongToSubFamily(e,Ha._fontServiceFontDictionary)}static isCompatibilityFont(e){return Ha.hiddenFonts.isFontHidden(Ha._fontServiceFontDictionary,e)}static get fontSizeDictionary(){return Ha._fontSizeDictionary}static initializeFontSize(){Ha._fontSizeDictionary={8:(0,_.a)("FontSize8"),9:(0,_.a)("FontSize9"),10:(0,_.a)("FontSize10"),11:(0,_.a)("FontSize11"),12:(0,_.a)("FontSize12"),14:(0,_.a)("FontSize14"),16:(0,_.a)("FontSize16"),18:(0,_.a)("FontSize18"),20:(0,_.a)("FontSize20"),24:(0,_.a)("FontSize24"),26:(0,_.a)("FontSize26"),28:(0,_.a)("FontSize28"),36:(0,_.a)("FontSize36"),48:(0,_.a)("FontSize48"),72:(0,_.a)("FontSize72")}}static initializeFontArrays(){i.ULS.sendTraceTag(507585678,306,100,"FontUtils.initializeFontArrays : called"),Ha._supportedFonts||(Ha._supportedFonts={}),Ha._normalizedFonts={},Ha._alwaysSupportedFonts={},Ha.initializeFontSize(),Ha._commonFontsNames={"Angsana New":(0,_.a)("AngsanaNew"),Aptos:(0,_.a)("Aptos"),"Aptos Display":(0,_.a)("AptosDisplay"),"Aptos Narrow":(0,_.a)("AptosNarrow"),"Arial Black":(0,_.a)("ArialBlack"),Arial:(0,_.a)("Arial"),Batang:(0,_.a)("Batang"),"Book Antiqua":(0,_.a)("BookAntiqua"),"Bookman Old Style":(0,_.a)("BookmanOldStyle"),"Browallia New":(0,_.a)("BrowalliaNew"),Calibri:(0,_.a)("Calibri"),Cambria:(0,_.a)("Cambria"),Candara:(0,_.a)("Candara"),"Century Gothic":(0,_.a)("CenturyGothic"),"Century Schoolbook":(0,_.a)("CenturySchoolbook"),Century:(0,_.a)("Century"),"Comic Sans MS":(0,_.a)("ComicSansMS"),Consolas:(0,_.a)("Consolas"),Constantia:(0,_.a)("Constantia"),Corbel:(0,_.a)("Corbel"),"Cordia New":(0,_.a)("CordiaNew"),"Courier New":(0,_.a)("CourierNew"),DaunPenh:(0,_.a)("DaunPenh"),DilleniaUPC:(0,_.a)("DilleniaUPC"),Dotum:(0,_.a)("Dotum"),FangSong:(0,_.a)("FangSong"),"Franklin Gothic Book":(0,_.a)("FranklinGothicBook"),"Franklin Gothic Medium":(0,_.a)("FranklinGothicMedium"),Garamond:(0,_.a)("Garamond"),Gautami:(0,_.a)("Gautami"),Georgia:(0,_.a)("Georgia"),"Gill Sans MT":(0,_.a)("GillSansMT"),Gulim:(0,_.a)("Gulim"),GungSuh:(0,_.a)("GungSuh"),HGGothicE:(0,_.a)("HGGothicE"),HGGyoshotai:(0,_.a)("HGGyoshotai"),HGPMinchoE:(0,_.a)("HGPMinchoE"),"HYGothic-Extra":(0,_.a)("HYGothic_Extra"),"HYMyeongJo-Extra":(0,_.a)("HYMyeongJo_Extra"),"Iskoola Pota":(0,_.a)("IskoolaPota"),JasmineUPC:(0,_.a)("JasmineUPC"),KaiTi:(0,_.a)("KaiTi"),Kalinga:(0,_.a)("Kalinga"),Kartika:(0,_.a)("Kartika"),Latha:(0,_.a)("Latha"),LiSu:(0,_.a)("LiSu"),"Lucida Sans Unicode":(0,_.a)("LucidaSansUnicode"),"Lucida Sans":(0,_.a)("LucidaSans"),"Malgun Gothic":(0,_.a)("MalgunGothic"),Mangal:(0,_.a)("Mangal"),Meiryo:(0,_.a)("Meiryo"),"Microsoft JhengHei":(0,_.a)("MicrosoftJhengHei"),"Microsoft YaHei":(0,_.a)("MicrosoftYaHei"),MingLiU:(0,_.a)("MingLiU"),MingLiU_HKSCS:(0,_.a)("MingLiU_HKSCS"),"MS Gothic":(0,_.a)("MSGothic"),"MS Mincho":(0,_.a)("MSMincho"),"MS PGothic":(0,_.a)("MSPGothic"),"MS PMincho":(0,_.a)("MSPMincho"),Nyala:(0,_.a)("Nyala"),PMingLiU:(0,_.a)("PMingLiU"),"PMingLiU-ExtB":(0,_.a)("PMingLiU_ExtB"),Raavi:(0,_.a)("Raavi"),Rockwell:(0,_.a)("Rockwell"),"Segoe Light":(0,_.a)("SegoeLight"),"Segoe UI Light":(0,_.a)("SegoeUILight"),"Segoe UI":(0,_.a)("SegoeUI"),Segoe:(0,_.a)("Segoe"),Shruti:(0,_.a)("Shruti"),SimHei:(0,_.a)("SimHei"),SimSun:(0,_.a)("SimSun"),"SimSun-ExtB":(0,_.a)("SimSun_ExtB"),STKaiti:(0,_.a)("STKaiti"),STXingkai:(0,_.a)("STXingkai"),STXinwei:(0,_.a)("STXinwei"),Sylfaen:(0,_.a)("Sylfaen"),Tahoma:(0,_.a)("Tahoma"),"Times New Roman":(0,_.a)("TimesNewRoman"),Times:(0,_.a)("Times"),"Trebuchet MS":(0,_.a)("TrebuchetMS"),Tunga:(0,_.a)("Tunga"),Verdana:(0,_.a)("Verdana"),Vrinda:(0,_.a)("Vrinda")},Ha.appSettingsManager.getBooleanAppSetting("THSarabunPSKFontIsEnabled")&&(Ha._commonFontsNames["TH SarabunPSK"]=(0,_.a)("THSarabunPSK"),Ha._alwaysSupportedFonts["TH SarabunPSK"]=(0,_.a)("THSarabunPSK")),v.a.isWebKit&&Ha.shouldApplyAltName&&Ha.get_commonFontsCss().set_item("PMingLiU-ExtB","PMingLiU-ExtB,-ExtB,PMingLiU,Serif"),Ha.appSettingsManager?.getBooleanAppSetting("FixTwCenMtFont")?Ha._commonFontsNames["Tw Cen MT"]=(0,_.a)("TwCenMT"):Ha._commonFontsNames["TW Cen MT"]=(0,_.a)("TWCenMT"),Ha.ensureAltFontMaps(),Ha._areFontArraysInitialized=!0}static get areFontArraysInitialized(){return Ha._areFontArraysInitialized}static getLocalizedFontName(e){return e?(e=Ha.normalizedFontName(e),Ha._commonFontsNames[e]?Ha._commonFontsNames[e]:e):""}static addFontDetectionSpan(){Ha._fontDetectionSpan=document.createElement("SPAN"),Ha._fontDetectionSpan.innerText=Ha.fontTestString,Ha._fontDetectionSpan.style.fontSize="16pt",Ha._fontDetectionSpan.style.visibility="hidden",Ha._fontDetectionSpan.style.position="absolute",Ha._fontDetectionSpan.style.left="0px",Ha._fontDetectionSpan.style.top="0px",s.AFrameworkApplication.activeFrame.getDOMElement().appendChild(Ha._fontDetectionSpan)}static removeFontDetectionSpan(){Ha._fontDetectionSpan&&s.AFrameworkApplication.activeFrame.getDOMElement().removeChild(Ha._fontDetectionSpan)}static isFontRendered(e,t){let n="'"+e+"'";Ha._altFontEucToNative[e]&&(n="'"+Ha._altFontEucToNative[e]+"','"+e+"'"),(Ha._defaultFontWidths[0]<0||Ha._defaultFontHeights[0]<0)&&Ha.setDefaultFallbackWidthAndHeight(t);for(let e=0;e<Ha._defaultFonts.length;e++){t.style.fontFamily=n+","+Ha._defaultFonts[e];const a=t.offsetWidth,i=t.offsetHeight;if(a!==Ha._defaultFontWidths[e]||i!==Ha._defaultFontHeights[e])return!0}return!1}static setDefaultFallbackWidthAndHeight(e){for(let t=0;t<Ha._defaultFonts.length;t++)e.style.fontFamily=Ha._defaultFonts[t],Ha._defaultFontWidths[t]=e.offsetWidth,Ha._defaultFontHeights[t]=e.clientHeight}static getNormalizedFontNames(e){const t=new Ne.a;for(let n of e)Ha.appSettingsManager&&Ha.appSettingsManager.isChangeGateEnabled("SharedOnline.ChangeGate.CorrectFontName")&&(n=n.trim()),t.add(Ha.normalizedFontName(n));return t.toArray()}static normalizedFontName(e){if(Ha._commonFontsNames[e]||Ha._supportedFonts[e])return e;const t=(e=Ha.eucFontName(e)).toLowerCase();if(Ha._normalizedFonts[t])return Ha._normalizedFonts[t];{const e=Ha._commonFontsNames;for(const n in e){const a={key:n,value:e[n]};if(a.key.toLowerCase()===t)return Ha._normalizedFonts[t]=a.key,a.key}}return Ha._normalizedFonts[t]=e,e}static areFontsSupported(e,t){const n=new Array(e.length);Ha._supportedFonts||(Ha._supportedFonts={});for(let a=0;a<e.length;a++){const i=t?e[a]:Ha.normalizedFontName(e[a]);if(Ha._supportedFonts[i]){n[a]=!0;continue}const o=Ha.stopwatchBuilder.makeAndStartStopwatch("LoadResource","IsFontSupported");n[a]=Ha.get_isFontSupportedFunction()(i,t),o.stop(),n[a]&&Ha.addSupportedFont(i,t)}return n}static isFontSupportedOnSpan(e,t){return e=Ha.normalizedFontName(e),Ha.isFontRendered(e,Ha._fontDetectionSpan)}static getFontString(e){const t=Ha.normalizedFontName(e);let n="";const a=e.indexOf("'"),o=e.indexOf('"');let r=!1;return Ha.allowSpecialCharacterFontsToRender()&&(a>-1||o>-1)?(a&&o?(a>0||o>0)&&(-1===a?n="'"+t+"'":-1===o?n='"'+t+'"':a<o?(n='"'+t+'"',r=!0):o<a&&(n="'"+t+"'",r=!0)):n=t,Ha._altFontEucToNative[t]?n='"'+Ha._altFontEucToNative[t]+'",'+n:!t.indexOf('"')&&Ha._altFontEucToNative[t.substring(1,t.length-1)]&&(n='"'+Ha._altFontEucToNative[t.substring(1,t.length-1)]+'",'+n)):(n="'"+t+"'",Ha._altFontEucToNative[t]&&(n="'"+Ha._altFontEucToNative[t]+"','"+t+"'")),r&&i.ULS.sendTraceTag(540856771,210,15,String.format("FontName used has both single and double quotes in non-starting positions.")),n}static isFontSupportedOnCanvas(e,t){if(!Ha.isFontSupportedOnCanvasContext)return i.ULS.sendTraceTag(508073920,210,15,"We couldn't resolve the canvas context."),!1;if(Ha._defaultFonts.length!==Ha._defaultFontWidthsCanvas.length)return i.ULS.sendTraceTag(38081176,210,15,"The length of these arrays should be the same."),!1;try{let n=0;if(Ha._defaultFontWidthsCanvas[0]<0)for(let e=0;e<Ha._defaultFonts.length;e++){Ha.isFontSupportedOnCanvasContext.font=String.format("48px {0}",Ha._defaultFonts[e]);const t=Ha.isFontSupportedOnCanvasContext.measureText(Ha.fontTestString);0,Ha._defaultFontWidthsCanvas[e]=t?t.width:-1}const a=t?e:Ha.getFontString(e);for(let e=0;e<Ha._defaultFonts.length;e++){Ha.isFontSupportedOnCanvasContext.font=String.format("48px {0}",a+","+Ha._defaultFonts[e]);const t=Ha.isFontSupportedOnCanvasContext.measureText(Ha.fontTestString);0;const i=t?t.width:Ha._defaultFontWidthsCanvas[e];if(i!==Ha._defaultFontWidthsCanvas[e])return!0;if(n>0&&n!==i)return!1;n=i}}catch(e){i.ULS.sendTraceTag(38081177,210,15,String.format("IsFontSupportedOnCanvas failed: {0}",e.toString()))}return!1}static isFontSupported(e,t){return Ha.areFontsSupported([e],t)[0]}static searchFontInfo(e){if(Ha.documentFonts.contains(e))return Ha.documentFonts.getFontInfo(e);if(Ha.themeFonts.contains(e))return Ha.themeFonts.getFontInfo(e);if(Ha._supportedFonts[e]){return new Ca(e,Ha.isSymbolFont(e),0)}return null}static getFontCss(e,t,n=!1,a=!1){let i;return({value:i}=Ha.get_commonFontsCss().tryGetValue(e)).returnValue||(i="'"+e+"','Segoe UI',Tahoma,Sans-Serif;"),i=Ha.addWebFontsAndAltName(e,i,t,Ha.shouldApplyAltName,n,a),i}static generateFontDropdownXml(e,t,n,a,i=!1,o=!1,r=!1){let s;return({menuProps:s}=Ha.generateFontDropdownXmlAndMenuProps(e,t,n,a,i,o,r)).returnValue}static generateFontDropdownXmlAndMenuProps(e,t,n,a,i=!1,o=!1,r=!1){fa.a.mark(4765);const s=Ha.generateFontDropdownMenuProps(e,t,a,i,o,r),l=Ha.buildMenuXmlFromMenuProps(s,n.toString());return fa.a.mark(4766),{returnValue:l,menuProps:s}}static getOptionTextStyle(e,t){const n={};n.fontFamily=t?Ra:e;const a={};return a.optionText=n,a}static generateFontPickerDropdownMenuProps(e,t,n=!1){Ha._isDocumentFontsPopulatedToMruFonts||Ha.populateDocumentFontsToMruFonts();const a=Ha.generateFontPickerOfficeFontsSection(n),i=Ha.generateFontPickerSuggestedFontsSection(a);return Object.assign(new ga,{mruList:Ha.generateFontPickerMruSection(e,t),suggestedFontKeys:i,fonts:a})}static getFontVariantKey(e){return"L2"+e}static queryFullFontVariantName(e,t,n,a,i){Ha.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.CustomFontAlternateNameFixEnabled")&&Ha.get_customFontAlternateNameDict()[e]&&(e=Ha.get_customFontAlternateNameDict()[e]),e=Ha.eucFontName(e);const o=i??appChrome.api.selectedFont;if(!Ha.isFontServiceFont(e)){if(Ha._supportedFonts&&e in Ha._supportedFonts){return o(String.format(a,e),e,!1)}return o(e)}let r=null;const s=Ha._fontServiceFontDictionary[e];for(const e of s){const a=Ha.isBold(e),i=Ha.isItalic(e);if(a===t&&i===n){const t=e.fontName!==e.fontFamily?Ha.getFontVariantKey(e.fontName):e.fontName;return o(e.localizedFontName,t,!1)}a||i||(r=e.localizedFontName)}const l=s.length>0&&e!==s[0].fontFamily?Ha.getFontVariantKey(e):e;return o(String.format(a,r||e),l,!1)}static checkFontNameInCommonFontsCss(e){return!!(s.AFrameworkApplication.activeFrame&&Ha.appSettingsManager&&Ha.appSettingsManager.isChangeGateEnabled("Microsoft.Office.PowerPointOnline.ChangeGate.CheckFontNameInCommonFontsCss")&&2===s.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&Ha.get_commonFontsCss().containsKey(e))&&(i.ULS.sendTraceTag(506025629,306,15,"FontUtils::checkFontInCommonCss Font is available"),!0)}static isMissingFont(e,t,n){return Ha.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.MissingFontsBug8838219Fix")?!(Ha.isEmbeddedFont(e)||Ha.isFontServiceFont(e)||Ha.isCustomServiceFont(e)||Ha.isCompatibilityFont(e)||(n?Ha.isFontSupported(e,t):Ha.get_isFontSupportedFunction()(e))||Ha.isFontBoldnessFixEnabled()&&Ha.doesFontBelongToCustomSubFamily(e)||Ha.checkFontNameInCommonFontsCss(e)):!(Ha.isEmbeddedFont(e)||Ha.isFontServiceFont(e)||Ha.isCustomServiceFont(e)||Ha.isCompatibilityFont(e)||n?Ha.isFontSupported(e,t):Ha.get_isFontSupportedFunction()(e))}static getVariantType(e){return Ha.isCompatibilityFont(e)?ln.compatibilityFont:Ha.isFontServiceFont(e)||Ha.isCustomServiceFont(e)||Ha.isFontBoldnessFixEnabled()&&Ha.doesFontBelongToCustomSubFamily(e)?null:Ha.isEmbeddedFont(e)?ln.embeddedFont:Ha.get_isFontSupportedFunction()(e)?null:ln.missingFont}static createMruEntry(e,t=-1){if(Ha._fontServiceFontDictionary){const n=Ha._fontServiceFontDictionary[e];if(n&&n.length>0){let a;a=Ha.isSymbolFont(e);const i=Ha.isCompatibilityFont(e);for(let o=0;o<n.length;++o){const r=n[o];if(r.fontName===e)return Object.assign(new pa,{name:r.localizedFontName,mruKey:e!==r.fontFamily?Ha.getFontVariantKey(e):e,variantType:i?ln.compatibilityFont:null,displayName:a||!r.codepoint?null:Ha.convertCodepointToString(r.codepoint),fontFamilyKey:r.fontFamily,data:Object.assign(new da,{fontToApply:e,themeIndex:-1!==t?Ha.sectionIdTheme+t:null}),previewFontName:i?Ha.getFontServiceFontName(r.fontFamily):null})}const o=n[0].fontFamilyCodepoint||0;return Object.assign(new pa,{name:n[0].localizedFontFamily,mruKey:e,variantType:i?ln.compatibilityFont:null,displayName:a||!o?null:Ha.convertCodepointToString(o),fontFamilyKey:e,data:Object.assign(new da,{fontToApply:e,themeIndex:-1!==t?Ha.sectionIdTheme+t:null}),previewFontName:i?Ha.getFontServiceFontName(e):null})}}const n=Ha.getVariantType(e),a=n===ln.embeddedFont?Ha.getEmbeddedFontName(e):e in Ha._supportedFonts?e:null;return Object.assign(new pa,{name:e,mruKey:e,variantType:n,previewFontName:a})}static getEucFontName(e){return this.eucFontName(e)}static generateFontPickerMruSection(e,t){const n={};if(Ha.shouldAddThemeSection()){const a=Ha.themeFonts.getFonts();for(let i=0;i<a.length;i++)if(e(i)&&a[i]){const e=a[i].fontName,o=Ha.createMruEntry(e,i);o.isThemeFont=!0,o.themeStyle=t(i),n[e]?n[e+i]=o:n[e]=o}}let a=0;if(Ha.shouldAddMruSection()){const e=Ha.mruFonts.getFonts();for(const t of e)if(!n[t]&&(n[t]=Ha.createMruEntry(t),++a>=10))break}for(const e of Ha.documentFonts.getFonts().values){if(!e)continue;const t=e.fontName;if(!n[t]&&(n[t]=Ha.createMruEntry(t),++a>=10))break}const i=new Array(0);for(const e in n){const t={key:e,value:n[e]};i.push(t.value)}return i}static isBoldOrItalic(e){return Ha.isItalic(e)||Ha.isBold(e)}static isBold(e){return!!e&&700===e.weight}static isItalic(e){return!!e&&2===e.style}static calculateFontVariantOrder(e){return(5===e.width?0:e.width+5)<<24|e.weight<<8|e.style}static addFontPickerCloudFonts(e,t,n){for(const a in t){const i={key:a,value:t[a]},o=i.value;if(!o.length)continue;const r=i.key;let s;s=Ha.isSymbolFont(r);const l=o.length;for(let t=0;t<l;++t){const a=o[t];if(ba.isACLHidden(a.ACL))continue;const i=a.fontFamily,l=a.localizedFontFamily,c=a.fontName,d=a.localizedFontName;let u=a.shortCodepoint||0;n&&(u=0);const p=Object.assign(new _a,{name:d,variantKey:Ha.getFontVariantKey(c),parentKey:i,displayName:s||!u?null:Ha.convertCodepointToString(u),fullDisplayName:s||!a.codepoint?null:Ha.convertCodepointToString(a.codepoint),data:Object.assign(new ma,{fontToApply:r,isBold:Ha.isBold(a),isItalic:Ha.isItalic(a)}),order:Ha.calculateFontVariantOrder(a)}),g=e[l];if(g&&g.submenu)g.submenu.variants.push(p),g.fontType===ln.premiumFont&&Ha.get_commonFontsCss().containsKey(c)&&(g.fontType=null);else{let t=a.fontFamilyCodepoint||0;n&&(t=0);let o=null;if(n)o=ln.organizationFont;else{!Ha.get_commonFontsCss().containsKey(i)&&!Ha.get_commonFontsCss().containsKey(r)&&!Ha.get_commonFontsCss().containsKey(c)&&(o=ln.premiumFont)}e[l]=Object.assign(new ua,{name:l,fontKey:i,displayName:s||!t?null:Ha.convertCodepointToString(t),submenu:Object.assign(new ha,{showFontInfoCommand:!n,variants:[p]}),data:i===l?null:Object.assign(new da,{fontToApply:i}),fontType:o})}}}}static createSuggestedFontsList(){return[["Baskerville Old Face","Bookman Old Style","Century Schoolbook","Constantia","Garamond","Lucida Bright","Modern No. 20","Palatino Linotype","Perpetua","Rockwell"],["Bell MT","Berlin Sans FB","Corbel","Gill Sans MT","Lucida Sans","Microsoft Sans Serif","Quire Sans","Segoe UI","Tempus Sans ITC","Trebuchet MS"],["Consolas","Courier New","Lucida Sans Typewriter","Miriam Fixed","MS Mincho","Sabon Next LT","Sagona Book","Seaford","Selawik","Sitka Text"],["Baguet Script","Brush Script MT","Fairwater Script","Freestyle Script","Kunstler Script","Lucida Calligraphy","Matura MT Script Capitals","Mystical Woods Rough Script","Palace Script MT","Segoe Script"],["Algerian","Aptos Display","Bierstadt Display","Broadway","Cooper","Forte","Gabriola","Grandview Display","Jokerman","Walbaum Display"],["Bradley Hand ITC","Comic Sans MS","Kristen ITC","Lucida Handwriting","Mistral","Papyrus","Pristina","Rage","The Hand","Viner Hand ITC"]]}static generateFontPickerSuggestedFontsSection(e){if(!Ha.suggestedFontsExperimentEnabled)return[];const t=this.createSuggestedFontsList(),n=["Angsana New","Aptos","Arial","Century","Georgia","Verdana"],a=[];for(let i=0;i<t.length;i++){const o=t[i].filter((t=>e.some((e=>e.fontKey===t))));if(o.length>0){const e=Math.floor(Math.random()*o.length);a.push(o[e])}else a.push(n[i])}return a}static handleOuterMenuOrganizationFontToApply(e){for(const t in e){const n=e[t];if(n.fontType&&n.fontType===ln.organizationFont&&n.submenu&&n.submenu.variants.length>0){const{variants:e}=n.submenu;e.some((e=>e.name===t))||(n.data=e[0].data)}}}static generateFontPickerOfficeFontsSection(e){if(Ha.isFontPickerOfficeFontsSectionCacheEnabled()&&null!==Ha.cachedFontPickerOfficeFontsSection&&Ha.cachedFontPickerOfficeFontsSection.length>0)return Ha.cachedFontPickerOfficeFontsSection;const t={};if(!Ha._fontServiceFontEnabled)for(const e of Ha.get_allFonts().keys)t[e]=Object.assign(new ua,{name:e,fontKey:e});if(Ha.addFontPickerCloudFonts(t,Ha._fontServiceFontDictionary,!1),Ha.shouldAddCustomFontSection()&&Ha.addFontPickerCloudFonts(t,Ha._customFontDictionary,!0),e){const e=Ha._supportedFonts;for(const n in e){const a={key:n,value:e[n]}.key;a in t||(t[a]=Object.assign(new ua,{name:a,fontKey:a,fontType:ln.organizationFont}))}}Ha.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HandleOuterMenuOrganizationFontToApply")&&Ha.handleOuterMenuOrganizationFontToApply(t);const n=new Array(0);for(const e in t){const a={key:e,value:t[e]};Ha.updateFontToApply(a.value),n.push(a.value)}return Ha.isFontPickerOfficeFontsSectionCacheEnabled()&&(Ha.cachedFontPickerOfficeFontsSection=n),n}static updateFontToApply(e){if(!e.submenu)return;let t=null;for(const n of e.submenu.variants){if(102400===n.order||n.name===e.name)return;(!t||t.order>n.order)&&(t=n)}e.data=t.data}static generateFontDropdownMenuProps(e,t,n,a=!1,i=!1,o=!1){Ha._isDocumentFontsPopulatedToMruFonts||Ha.populateDocumentFontsToMruFonts();const r=Object.assign(new Sa.a,{Id:"FontDropdownMenu"});if(r.MenuSectionList=[],Ha.shouldAddThemeSection()){const a=Ha.generateThemeFontsSection(e,t,n,o);Array.add(r.MenuSectionList,a)}if(Ha.shouldAddMruSection()){const e=Ha.generateMruFontsSection(n,a,i,o);Array.add(r.MenuSectionList,e)}if(Ha.shouldAddCustomFontSection()){const e=Ha.generateCustomFontsSection(n,o);Array.add(r.MenuSectionList,e)}const s=Ha.shouldAddThemeSection()||Ha.shouldAddMruSection()?ce.a.xmlEncode((0,_.a)("FontDropdownMenuSectionAll")):null,l=Object.assign(new an.a,{Id:"AllFontsDropdown",Title:s});return l.ControlList=Ha.getFontButtonsForAllFontsMenuSection(n,a,i,o),Array.add(r.MenuSectionList,l),r}static generateMruFontsSection(e,t=!1,n=!1,a=!1){const i=Ha.createProperties("MostRecentlyUsedFontDropdown",(0,_.a)("FontDropdownMenuSectionMru")),o=Ha.mruFonts.getFonts();for(let r=0;r<o.length;r++){const s=o[r],l=Ha.searchFontInfo(s);if(!l){0;continue}const c=Ha.getCommonFontEncodedName(s),d=Ha.createFontDropDownButton(s,Ha.sectionIdMru,l.isSymbol,e,r,c,t,n,a);Array.add(i.ControlList,d)}return i}static generateThemeFontsSection(e,t,n,a){const i=Ha.createProperties("ThemeFontDropdown",(0,_.a)("FontDropdownMenuSectionTheme")),o=Ha.themeFonts.getFonts();for(let a=0;a<o.length;a++)if(e(a)&&o[a]){const e=o[a].fontName,r=t(a,Ha.getCommonFontEncodedName(e)),s=Ha.createFontDropDownButton(e,Ha.sectionIdTheme,o[a].isSymbol,n,a,r,!1,!1,!1);Array.add(i.ControlList,s)}return i}static generateCustomFontsSection(e,t){const n=Ha.createProperties("CustomFontDropdown","Organizational Fonts"),a=Y.a.getKeys(Ha._customFontDictionary);for(let i=0;i<a.length;i++){const o=a[i];if(Ha.hiddenFonts.isFontHidden(Ha._customFontDictionary,o))continue;const r=Ha.isSymbolFont(o),s=(Ha.sectionCustomFont,Ha.getCommonFontEncodedName(o)),l=Ha.createFontDropDownButton(o,Ha.sectionCustomFont,r,e,i,s,!1,!1,t);Array.add(n.ControlList,l)}return n}static createProperties(e,t){return Object.assign(new an.a,{Id:e,Title:ce.a.xmlEncode(t),ControlList:[]})}static getCommonFontEncodedName(e){const t=Ha._commonFontsNames[e];return ce.a.xmlEncode(t||e)}static createFontDropDownButton(e,t,n,a,i,o,r=!1,s=!1,l=!1){const c=a?"":ce.a.xmlEncode(e),d=Ha.getFontCss(e,r,s,l),u=ce.a.xmlEncode(d);return Object.assign(new Jt,{MenuItemId:t+i,CommandValueId:a?u:c,LabelText:o,LabelCss:String.format(xa,n?Ra:u),Styles:Ha.getOptionTextStyle(d,n)})}static getFontButtonsForAllFontsMenuSection(e,t,n,a=!1){const i=new Set,o=[];let r=0;const s=Ha._supportedFonts;for(const l in s){let c={key:l,value:s[l]}.key;if(Ha.allowSpecialCharacterFontsToRender()&&c.length>0&&("'"===c.charAt(0)||'"'===c.charAt(0))&&(c=c.substring(1,c.length-1)),Ha.isFontServiceName(c)?c=c.substring(0,c.length-14):(Ha.isEmbeddedFontName(c)||Ha.isCustomFontName(c))&&(c=c.substring(0,c.length-13)),i.has(c))continue;const d=Ha.getCommonFontEncodedName(c),u=Ha.createFontDropDownButton(c,Ha.sectionIdAll,Ha.isSymbolFont(c),e,r,d,t,n,a);i.add(c),Array.add(o,u),r++}r=0;for(const s of Ha.documentFonts.getFonts().values)if(s){Ha.alternateFontName(s.fontName);if(i.has(s.fontName))continue;const l=Ha.getCommonFontEncodedName(s.fontName),c=Ha.createFontDropDownButton(s.fontName,Ha.sectionIdDocument,s.isSymbol,e,r,l,t,n,a);i.add(s.fontName),Array.add(o,c),r++}Ha.shouldAddCustomFontSection()&&Ha.addCustomFontsToAllFonts(e,a,i,o),r=0;for(const s of Ha.onDemandFonts.getFonts().values)if(s){if(i.has(s.fontName)||Ha.hiddenFonts.isFontHidden(Ha._fontServiceFontDictionary,s.fontName))continue;const l=e?"":ce.a.xmlEncode(s.fontName),c=Ha.getFontCss(s.fontName,t,n,a),d=ce.a.xmlEncode(c),u=Ha.getCommonFontEncodedName(s.fontName),p=Object.assign(new Jt,{MenuItemId:Ha.sectionIdOnDemand+r,CommandValueId:e?d:l,LabelText:u,LabelCss:String.format(xa,s.codepoint>0?Ha._previewFontCss:Ra),Styles:Ha.getOptionTextStyle(s.codepoint>0?Ha._previewFontCss:Ra,s.isSymbol),AriaLabel:l});i.add(s.fontName),Array.add(o,p),r++}return o.sort(Ha.compareFontDropDownEntries),o}static addCustomFontsToAllFonts(e,t,n,a){let i=0;const o=Y.a.getKeys(Ha._customFontDictionary);for(const r of o){if(n.has(r)||Ha.hiddenFonts.isFontHidden(Ha._customFontDictionary,r))continue;const o=Ha.isSymbolFont(r),s=(Ha.sectionIdAllCustomFont,Ha.getCommonFontEncodedName(r)),l=Ha.createFontDropDownButton(r,Ha.sectionIdAllCustomFont,o,e,i,s,!1,!1,t);n.add(r),Array.add(a,l),i++}}static generateFontSizeDropdownXml(e){return Ha.buildMenuXmlFromMenuProps(Ha.generateFontSizeDropdownMenuProps(),e.toString())}static generateFontSizeDropdownMenuProps(){const e=new Sa.a;e.MenuSectionList=[];const t=Object.assign(new an.a,{Id:"fontSizes",ControlsId:"ctrlFontSizes",ControlList:[]}),n=Ha.fontSizeDictionary;for(const e in n){const a={key:e,value:n[e]},i=Object.assign(new Xt.a,{MenuItemId:ce.a.xmlEncode(a.value),LabelText:ce.a.xmlEncode(a.value)});Array.add(t.ControlList,i)}return Array.add(e.MenuSectionList,t),e}static buildMenuXmlFromMenuProps(e,t){const n=e.MenuSectionList,a=new Array(n.length);for(let e=0;e<n.length;e++){const i=n[e],o=i.ControlList,r=new Array(o.length);for(let e=0;e<o.length;e++){const n=o[e];r[e]=ca.a(n.MenuItemId,t,n.LabelText,n.Image16by16||null,n.MenuItemId,n.CommandValueId,n.Alt||null,null,n.LabelCss,"",null,null,null,!0,n.AriaLabel)}const s=ca.c(i.ControlsId,r);a[e]=ca.d(i.Id,s,null,i.Title)}return ca.e(a,e.Id)}static alternateFontName(e){const t=Ha._altFontNativeToEuc[e];if(t)return t;const n=Ha._altFontEucToNative[e];return n||e}static eucFontName(e){if(Ha.appSettingsManager&&Ha.appSettingsManager.isChangeGateEnabled("HandleMultipleFontNamesWhileFetchingEnglishFont"))return e.split(",").map((e=>{const t=e.trim(),n=Ha._altFontNativeToEuc[t];return n||t})).join(", ");{const t=Ha._altFontNativeToEuc[e];return t||e}}static compareFontDropDownEntries(e,t){const n=e,a=t;return ce.a.localeCompare(n.CommandValueId,a.CommandValueId)}static convertCodepointToString(e){return ce.a.xmlEncode(String.fromCodePoint(e))}static ensureAltFontMaps(){if(Ha._altFontEucToNative&&Ha._altFontNativeToEuc)return;Ha._altFontEucToNative={"Ami R":"","Arphic Gyokailenmentai Heavy JIS":"ARH","Arphic Gyokailenmentai Light JIS":"ARL","Arphic Gyokaisho Heavy JIS":"ARH","Arphic Gyokaisho Light JIS":"ARL","Arphic Kaisho Medium JIS":"AR M","Arphic Kanteiryu Heavy JIS":"ARH","Arphic Koin-Tai Bold JIS":"ARB","Arphic Kuro-Maru-POP Heavy JIS":"ARH","Arphic Pengyokaisho Light JIS":"AR L","Arphic Penkaisho Light JIS":"ARL","Arphic PGyokaisho Heavy JIS":"AR PH","Arphic PGyokaisho Light JIS":"AR PL","Arphic PKaisho Medium JIS":"AR P M","Arphic PKanteiryu Heavy JIS":"AR PH","Arphic PKoin-Tai Bold JIS":"AR PB","Arphic PKuro-Maru-POP Heavy JIS":"AR PH","Arphic PPengyokaisho Light JIS":"AR P L","Arphic PPenkaisho Light JIS":"AR PL","Arphic PReisho Medium JIS":"AR P M","Arphic PSiro-Maru-POP Heavy JIS":"AR PH","Arphic Reisho Medium JIS":"AR M","Arphic Siro-Maru-POP Heavy JIS":"ARH",Batang:"","Batang Old Hangu":" ",BatangChe:"","DFGothic-EB":"","DFKai-SB":"",DFLiHeiBold:"","DFLiHeiBold(P)":"","DFPGothic-EB":"","DFPOP-SB":"POP","DFPPOP-SB":"POP",Dotum:"","Dotum Old Hangu":" ",DotumChe:"","Expo M":"",FangSong_GB2312:"_GB2312",FZShuTi:"",FZYaoTi:"",Gothic:"",Gulim:"","Gulim Old Hangu":" ",GulimChe:"",Gungsuh:"","Gungsuh Old Hangu":" ",GungsuhChe:"","Headline R":"","Headline Sans R":"",HGGothicE:"HGE",HGGothicM:"HGM",HGGyoshotai:"HG",HGKyokashotai:"HG",HGMaruGothicMPRO:"HGM-PRO",HGMinchoB:"HGB",HGMinchoE:"HGE",HGPGothicE:"HGPE",HGPGothicM:"HGPM",HGPGyoshotai:"HGP",HGPKyokashotai:"HGP",HGPMinchoB:"HGPB",HGPMinchoE:"HGPE",HGPSoeiKakugothicUB:"HGPUB",HGPSoeiKakupoptai:"HGP",HGPSoeiPresenceEB:"HGPEB",HGPSoueiKakugothicUB:"HGPUB",HGPSoueiKakuPoptai:"HGP",HGSeikaishotaiPRO:"HG-PRO",HGSGothicE:"HGSE",HGSGothicM:"HGSM",HGSGyoshotai:"HGS",HGSKyokashotai:"HGS",HGSMinchoB:"HGSB",HGSMinchoE:"HGSE",HGSoeiKakugothicUB:"HGUB",HGSoeiPresenceEB:"HGEB",HGSoueiKakugothicUB:"HGUB",HGSoueiKakuPoptai:"HG",HGSSoeiKakugothicUB:"HGSUB",HGSSoeiKakupoptai:"HGS",HGSSoeiPresenceEB:"HGSEB",HGSSoueiKakugothicUB:"HGSUB",HGSSoueiKakuPoptai:"HGS","HYGothic-Extra":"HY","HYGothic-Medium":"HY","HYGraphic-Medium":"HYM","HYHeadLine-Medium":"HYM","HYMyeongJo-Extra":"HY","HYPMokGak-Bold":"HYB","HYPost-Light":"HYL","HYPost-Medium":"HYM","HYShortSamul-Medium":"HYM","HYSinMun-MyeongJo":"HY","HYSinMyeongJo-Medium":"HY","HYTaJa-Medium":"HYM",KaiTi_GB2312:"_GB2312",LiSu:"","Magic R":"","Malgun Gothic":" ",Meiryo:"","Microsoft JhengHei":"","Microsoft YaHei":"",Mincho:"",MingLiU:"",MingLiU_HKSCS:"_HKSCS","MingLiU-ExtB":"-ExtB","MoeumT R":"T","MS Gothic":" ","MS Mincho":" ","MS PGothic":" ","MS PMincho":" ","MS UI Gothic":"MS UI Gothic","New Batang":"","New Gulim":"",NSimSun:"",PMingLiU:"","PMingLiU-ExtB":"-ExtB","Pyunji R":"",SimHei:"",SimSun:"",STCaiyun:"",STFangsong:"",STHupo:"",STKaiti:"",STLiti:"",STSong:"",STXihei:"",STXingkai:"",STXinwei:"",STZhongsong:"","Yet R":"",YouYuan:"","LG Smart_H Bold":"LG Bold","LG Smart_H Light":"LG Light","LG Smart_H Regular":"LG Regular","LG Smart_H SemiBold":"LG SemiBold","LG Smart_H2.0 B":"LG2.0 Bold","LG Smart_H2.0 L":"LG2.0 Light","LG Smart_H2.0 R":"LG2.0 Regular","LG Smart_H2.0 SB":"LG2.0 SemiBold","HDharmony L":" L","HDharmony M":" M","HDharmony R":" R","HDharmony B":" B","KT font Thin":"KT Thin","KT font Bold":"KT Bold","KT font Light":"KT Light","KT font Medium":"KT Medium"},i.ULS.sendTraceTag(507585677,306,100,"FontUtils.ensureAltFontMaps : Before _altFontNativeToEuc init"),Ha._altFontNativeToEuc={};const e=Ha._altFontEucToNative;for(const t in e){const n={key:t,value:e[t]};Ha._altFontNativeToEuc[n.value]=n.key}}static ensureSymbolFonts(){Ha._symbolFonts||(Ha._symbolFonts=Y.a.buildHashSet(["Apple Symbols","Bookshelf Symbol 7","Dingbat","Marlett","MT Extra","MS Outlook","Sonata","Symbol","Webdings","Wingdings","Wingdings 2","Wingdings 3","Wingdings 4","ZapfDingbats"]))}static areSymbolFonts(e){const t=new Ne.a;for(const n of e)t.add(Ha.isSymbolFont(n));return t.toArray()}static isSymbolFont(e){return!Ha._commonFontsNames[e]&&(Ha.themeFonts&&Ha.themeFonts.contains(e)?Ha.themeFonts.getFontInfo(e).isSymbol:Ha.documentFonts&&Ha.documentFonts.contains(e)?Ha.documentFonts.getFontInfo(e).isSymbol:(Ha.ensureSymbolFonts(),!!Ha._symbolFonts[e]))}static get mruFonts(){return Ha._mruFonts||(Ha._mruFonts=new wa)}static set mruFonts(e){Ha._mruFonts=e}static addFont(e,t){if(s.AFrameworkApplication.activeFrame&&Ha.appSettingsManager&&Ha.appSettingsManager.isChangeGateEnabled("RemoveInvalidFont")&&2===s.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&(e=Ha.correctFontHavingFontSuffix(e),Oa.some((t=>e.includes(t)))))return;if(Ha.documentFonts.contains(e))return;if(!(Ha.allowSpecialCharacterFontsToRender()&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PPTOModernFontPickerIsEnabled")||Ha.isSafeFontName(e)))return;const n=new Ca(e,t,0);Ha.documentFonts.documentFonts.add(e,n)}static addFonts(e,t){if(!e)return;const n=Ha.getNormalizedFontNames(e);for(let a=0;a<e.length;a++)this.addFont(n[a],t[a])}static addMruFont(e){const t=Ha.stopwatchBuilder.makeAndStartStopwatch("LoadResource","AddMruFont");s.AFrameworkApplication.activeFrame&&Ha.appSettingsManager&&Ha.appSettingsManager.isChangeGateEnabled("RemoveInvalidFont")&&2===s.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&(e=Ha.correctFontHavingFontSuffix(e),Oa.some((t=>e.includes(t))))||(e=Ha.normalizedFontName(e),Ha.ensureFontAvailable(e),Ha.searchFontInfo(e)||Ha.addFont(e,Ha.isSymbolFont(e)),Ha.mruFonts.addFont(e),t.stop())}static shouldAddMruSection(){return Ha.mruFonts.currentSize()>0}static get documentFonts(){return Ha._documentFonts||(Ha._documentFonts=new la)}static set documentFonts(e){Ha._documentFonts=e}static refresheDocumentFontsToMru(){Ha._isDocumentFontsPopulatedToMruFonts=!1}static loadDocumentFonts(e,t){Ha.addFonts(e,t)}static populateDocumentFontsToMruFonts(){if(Ha._isDocumentFontsPopulatedToMruFonts=!0,!Ha.mruFonts.currentSize()&&!Ha.documentFonts.isEmpty()){0;for(const e of Ha.documentFonts.getFonts().values)Ha.mruFonts.addFont(e.fontName)}}static isCustomFontUsedInDocument(){if(Y.a.isNullOrEmpty(Ha._customFontDictionary))return!1;if(Ha.isCustomFontAlreadyPresentInDocument)return!0;for(const e of Y.a.getKeys(Ha._customFontDictionary))if(Ha.documentFonts.contains(e))return!0;return!1}static addDocumentFonts(e,t=!0){if(e)for(const n in e){const a={key:n,value:e[n]}.key.split(",");0;const i=Ha.getNormalizedFontNames(a);Ha.addFonts(i,Ha.areSymbolFonts(i)),t&&Ha.hiddenFonts.removeHiddenFonts(Ha._fontServiceFontDictionary,i)}Ha.loadOnDemandFonts()}static trySupportDocumentFont(e){let t;if(e=Ha.normalizedFontName(e),t=Ha.searchFontInfo(e),!Ha.isFontSupported(e))return{returnValue:!1,fontInfo:t};const n=t?t.isSymbol:Ha.isSymbolFont(e);return Ha.addFont(e,n),t=Ha.documentFonts.getFontInfo(e),{returnValue:!!t,fontInfo:t}}static get themeFonts(){return Ha._themeFonts||(Ha._themeFonts=new Ea)}static get_themeFontInfoList(){return Ha.themeFonts.getFonts()}static loadThemeFonts(e){if(!e)return;Ia.themeFonts&&(Ia.themeFonts=null),Ia.themeFonts=new Array(e.length),Ia.themeFontsNames={};const t=Ha.getNormalizedFontNames(e);for(let n=0;n<e.length;n++)e[n].length>0&&Ha.isSafeFontName(e[n])?(Ia.themeFonts[n]=new Ca(t[n],Ha.isSymbolFont(t[n]),0),Ia.themeFontsNames[t[n]]=n):Ia.themeFonts[n]=null}static shouldAddThemeSection(){return!Ha.themeFonts.isEmpty()}static get hiddenFonts(){return Ha._hiddenFontsManager||(Ha._hiddenFontsManager=new va)}static set hiddenFonts(e){Ha._hiddenFontsManager=e}static get onDemandFonts(){return Ha._onDemandFontsManager||(Ha._onDemandFontsManager=new Fa)}static set onDemandFonts(e){Ha._onDemandFontsManager=e}static resetFontServiceDictionary(){Ha._fontServiceFontDictionary={}}static shouldAddCustomFontSection(){return!!Ha._customFontDictionary&&!Y.a.isEmpty(Ha._customFontDictionary)}static getFontFamilyName(e,t){if(!e)return t;const n=e[t];return n&&n.length?n[0].fontFamily:t}static addFontServiceFonts(e,t,n){Ha._fontServiceFontDictionary=e,Ha._fontServiceFontEnabled=!0,Ha._previewFontCss=Ha.getFontCss(t,!0),Ha._addFontServiceFontCallback=n,Ha.hiddenFonts.addOrBuildHiddenFontFamilySet(Ha._fontServiceFontDictionary)}static addCustomFonts(e,t,n){Ha._customFontDictionary=e,Ha._addCustomFontCallback=t,Ha._customFontSectionLabel=n,Ha.hiddenFonts.addOrBuildHiddenFontFamilySet(Ha._customFontDictionary)}static addCustomFontsV2(e,t){Ha._customFontDictionary=e,Ha._addCustomFontCallback=t,Ha.hiddenFonts.addOrBuildHiddenFontFamilySet(Ha._customFontDictionary)}static setCustomFontConfigData(e,t,n){Ha._customFontCatalogUrl=e,Ha._customFontCatalogVersion=t,Ha._customFontEncData=n}static setCustomFontConfigDataV2(e,t,n,a){Ha._customFontCatalogUrl=e,Ha._customFontCatalogVersion=n,Ha._customFontEncData=a,Ha._customFontBaseUrl=t}static addEmbeddedFonts(e,t){Ha._embeddedFontDictionary=e,Ha._embeddedFontEnabled=!0,Ha._addEmbeddedFontCallback=t}static addEmbeddedFontsDictionary(e){Ha._embeddedFontsForTelemetry=e}static logFontUsageCountPerFontSource(e){if(!Y.a.isNullOrEmpty(e)){let t=0,n=0,a=0,o=0;for(const i of Y.a.getKeys(e))!Y.a.isNullOrEmpty(Ha._embeddedFontsForTelemetry)&&i in Ha._embeddedFontsForTelemetry?t++:!Y.a.isNullOrEmpty(Ha._customFontDictionary)&&i in Ha._customFontDictionary?n++:!Y.a.isNullOrEmpty(Ha._fontServiceFontDictionary)&&i in Ha._fontServiceFontDictionary?a++:o++;n>0&&(Ha._isCustomFontAlreadyPresentInDocument=!0),i.ULS.sendTraceTag(51446541,210,50,String.format("Total Fonts used in Doc EmbeddedFont:{0}, CustomFont:{1}, CloudFont:{2}, FallbackFont:{3}",t,n,a,o))}}static addOnDemandFont(e,t,n,a){if(Ha.onDemandFonts.isFontAvailableOnDemand(e))return;if(!Ha.isSafeFontName(e))return;const i=new Ca(e,t,n,a);Ha.onDemandFonts.onDemandFonts.add(e,i)}static loadOnDemandFontDictionary(e,t){if(e){for(const n in e){const a={key:n,value:e[n]},i=Ha.normalizedFontName(a.key);if(!Ha.documentFonts.contains(i)&&!Ha._supportedFonts[i]){const e=a.value;if(e.length>0){const n=e[0];if(n.fontFamilyCodepoint&&Ha.isBoldOrItalic(n))continue;Ha.addOnDemandFont(i,Ha.isSymbolFont(i),n.codepoint,t)}}}e=null}}static loadOnDemandFonts(){if(Ha._fontServiceFontEnabled){const e=Ha.stopwatchBuilder.makeAndStartStopwatch("LoadResource","FontServiceFonts");Ha.loadOnDemandFontDictionary(Ha._fontServiceFontDictionary,1),e.stop()}if(Ha._embeddedFontEnabled){const e=Ha.stopwatchBuilder.makeAndStartStopwatch("LoadResource","EmbeddedFonts");Ha.loadOnDemandFontDictionary(Ha._embeddedFontDictionary,2),e.stop()}}static addAlwaysSupportedFonts(e){if(e){const t=Ha._alwaysSupportedFonts;for(const n in t){const a={key:n,value:t[n]}.key;Ha.documentFonts.contains(a)||Ha.isFontSupported(a)||(e(a),Ha.addSupportedFont(a))}}}static ensureFontAvailable(e){if(Ha.onDemandFonts){Ha._supportedFonts[e]||Ha.documentFonts.contains(e)||Ha.onDemandFonts.isFontAvailableOnDemand(e)||i.ULS.sendTraceTag(37291725,210,15,"The font isn't available on demand and isn't supported locally");const t=Ha.onDemandFonts.getFontInfo(e);t&&(Ha.isFontSupported(e)||(1===t.fontSource&&Ha._addFontServiceFontCallback?(Ha._fontDownloadStopwatch=Ha.stopwatchBuilder.makeAndStartStopwatch("LoadResource","FontDownloadOnDemand"),Ha._addFontServiceFontCallback(e),Ha.addSupportedFont(e)):2===t.fontSource&&Ha._addEmbeddedFontCallback&&(Ha._fontDownloadStopwatch=Ha.stopwatchBuilder.makeAndStartStopwatch("LoadResource","FontDownloadOnDemand"),Ha._addEmbeddedFontCallback(e),Ha.addSupportedFont(e))),Ha.onDemandFonts.removeFont(e),Ha.addFont(e,Ha.isSymbolFont(e)))}}static addWebFontsAndAltName(e,t,n,a,i,o,r){let s="";if(t=({fallbackFonts:s}=Ha.getFirstFontCss(t)).returnValue+",",t=this.addWebFontsAndAltNameHelper(e,t,n,a,i,o),Ha.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.AddWebFontForEachFontFixEnabled")&&r){r.split(",").map((e=>e.trim())).forEach((e=>{t+=e+",",t=this.addWebFontsAndAltNameHelper(e,t,n,a,i,o)}))}return t+=s}static addWebFontsAndAltNameHelper(e,t,n,a,i,o){if(a){const n=Ha.alternateFontName(e);n!==e&&(t+="'"+n+"',")}if(i){t+=Ha.getEmbeddedFontName(e)+","}if(o){t+=Ha.getCustomFontName(e)+","}if(n){t+=Ha.getFontServiceFontName(e)+","}return Ha.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.CustomFontAlternateNameFixEnabled")&&Ha.get_customFontAlternateNameDict()[e]&&(t+=Ha.get_customFontAlternateNameDict()[e]+","),t}static addWebFontsToFallback(e,t,n,a,i=!1,o){return Ha.addWebFontsAndAltName(t,e,n,!1,a,i,o)}static getCustomFontName(e){return Ha.getFallbackFontName(e,La)}static getEmbeddedFontName(e){return Ha.getFallbackFontName(e,Ua)}static computePenalty(e,t,n,a,i,o){let r=0;e.isItalic?t.style||(r+=1):t.style&&(r+=4);let s=(e.isBold?n:a)-t.weight;if(s){s>0?s>i&&(s-=o):s=-s;r+=Math.floor(73*s/256)}return r}static buildFontFaceStyle(e,t){Ha._fontDownloadStopwatch||(Ha._fontDownloadStopwatch=Ha.stopwatchBuilder.makeAndStartStopwatch("LoadResource","FontDownload"));const n=document.getElementsByTagName("head"),a=document.createElement("Style");U.a.addHandler(a,"load",(e=>{Ha._fontDownloadStopwatch&&(Ha._fontDownloadStopwatch.stop(),Ha._fontDownloadStopwatch=null)})),Ha.appSettingsManager.getBooleanAppSetting("UseQuotesWithFontFamily")?(i.ULS.sendTraceTag(595190148,210,50,"UseQuotesWithFontFamily is enabled."),a.innerText=String.format("@font-face {{ font-family: '{0}'; src: {1}; font-display: {2}; }}",e,t,Da)):a.innerText=String.format("@font-face {{ font-family: {0}; src: {1}; font-display: {2}; }}",e,t,Da),n&&n.length>0&&n[0].appendChild(a)}static buildFontFaceStyleFromFontProperties(e,t,n){Ha._fontPropertiesFontDownloadStopwatch||(Ha._fontPropertiesFontDownloadStopwatch=Ha.stopwatchBuilder.makeAndStartStopwatch("LoadResource","Font, specified by FontProperties, Download"));const a=document.getElementsByTagName("head"),o=document.createElement("Style");U.a.addHandler(o,"load",(e=>{Ha._fontPropertiesFontDownloadStopwatch&&(Ha._fontPropertiesFontDownloadStopwatch.stop(),Ha._fontPropertiesFontDownloadStopwatch=null)}));let r="";Ha.isFontBoldnessFixEnabled()&&n===Ba.Custom||!e.isBold||(r=String.format("font-weight: {0}; ",Ma.getCSSFontWeight(e.isBold)));let s="";Ha.isFontBoldnessFixEnabled()&&n===Ba.Custom||!e.isItalic||(s=String.format("font-style: {0}; ",Ma.getCSSFontStyle(e.isItalic)));const l=String.format("font-display: {0}; ",Da);Ha.appSettingsManager.getBooleanAppSetting("UseQuotesWithFontFamily")?(i.ULS.sendTraceTag(595190147,210,50,"UseQuotesWithFontFamily is enabled."),o.innerText=String.format("@font-face {{ font-family: '{0}'; src: {1}; {2}{3}{4}}}",e.fontName,t,l,r,s)):o.innerText=String.format("@font-face {{ font-family: {0}; src: {1}; {2}{3}{4}}}",e.fontName,t,l,r,s),a&&a.length>0&&a[0].appendChild(o)}static buildFontServiceFontFaceStyle(e,t){const n=Ha.getFontServiceFontName(e);Ha.buildFontFaceStyle(n,String.format("url('{0}')",t))}static buildCustomFontFaceStyle(e,t){if(!e||!t)return;const n=Ha.getCustomFontName(e);Ha.buildFontFaceStyle(n,String.format("url('{0}')",t))}static buildEmbeddedFontServiceFontFaceStyle(e,t){if(!e||!t)return;const n=Ha.getEmbeddedFontName(e.fontName),a=new Ma(n,e.isBold,e.isItalic);Ha.buildFontFaceStyleFromFontProperties(a,String.format("url('{0}')",t),Ba.Embedded)}static buildWebFontServiceFontFaceStyles(e,t){if(e&&e.count)for(const n of e){let e="";e=Ha.isFontBoldnessFixEnabled()&&t===Ba.Custom?Ha.getCustomFontName(n.fontProperties.fontName):Ha.getFontServiceFontName(n.fontProperties.fontName);const a=new Ma(e,n.fontProperties.isBold,n.fontProperties.isItalic);Ha.buildFontFaceStyleFromFontProperties(a,String.format("url('{0}')",n.fontUrl),t)}}static buildBoldAndItalicWebFontCssForCustomFontFamilies(e,t){if(!t||!t.count)return;let n=0;for(const a of t){if(e==a.fontProperties.fontName)continue;if(!a.fontProperties.isBold&&!a.fontProperties.isItalic)continue;const t=(a.fontProperties.isBold?2:0)|(a.fontProperties.isItalic?1:0);if(n&1<<t)continue;const i=Ha.getCustomFontName(e),o=new Ma(i,a.fontProperties.isBold,a.fontProperties.isItalic);Ha.buildFontFaceStyleFromFontProperties(o,String.format("url('{0}')",a.fontUrl)),n|=1<<t}}static addFontClassStyleInHead(e,t){if(!e||!t||Ha.get_fontStyleIncludedList().contains(e))return void 0;const n=document.getElementsByTagName("head"),a=document.createElement("Style");a.innerText="."+e+"{ font-family : "+t+"}",n&&n.length>0&&n[0].appendChild(a),Ha.get_fontStyleIncludedList().add(e)}static isFontStyleIncluded(e){const t=Ha.getFontCssClassName(e);return e?{returnValue:Ha.get_fontStyleIncludedList().contains(t),fontStyleName:t}:{returnValue:!1,fontStyleName:t}}static getFontCssClassName(e){let t=null;return e?(t=e.replace(new RegExp("\\s+","g"),""),Ha.legalCssClassNameChars.test(t)?t:null):t}static createLegalCSSClassNameCharRegex(){return new RegExp("^[a-zA-Z][0-9a-zA-Z_-]*$")}static useBulletFontsFromFontServiceIfNeeded(e){if(v.a.isWindows)return;if(Boolean.parse(e.WordEditorFontServiceForBulletFontsIsEnabled||"false")){let t=e.WordEditorFontServiceSymbolFontUrl||"";""!==t&&Ha.buildFontFaceStyle("symbol",String.format("url('{0}')",t)),t=e.WordEditorFontServiceCourierNewFontUrl||"",""!==t&&Ha.buildFontFaceStyle(Ha.getFontServiceFontName("Courier New"),String.format("url('{0}')",t)),t=e.WordEditorFontServiceWingdingsFontUrl||"",""!==t&&Ha.buildFontFaceStyle(Ha.getFontServiceFontName("Wingdings"),String.format("url('{0}')",t))}else{const e="./Resources/"+s.AFrameworkApplication.lcid,t=String.format("url('{0}/symbol.woff') format('woff'), url('{0}/symbol.eot') format('embedded-opentype'), url('{0}/symbol.ttf') format('truetype')",e);Ha.buildFontFaceStyle("symbol",t)}}static isEmptyNullFontDictionary(){return Y.a.isNullOrEmpty(Ha._fontServiceFontDictionary)}}Ha.wingdingsFontsPrefix="WINGDINGS ",Ha.cloudFontServiceOnClientIsEnabled="FontServiceOnClientIsEnabled",Ha._illegalFontChars=new Q.a(Ha.createIllegalFontCharsRegex),Ha._commonFontsCss=new Q.a(Ha.createCommonFontsCss),Ha.fontTestString="AaXxWwm!10.jiJ#@"+String.fromCharCode(59136),Ha._appSettingsManager=null,Ha._isFontSupportedFunction=null,Ha._stopwatchBuilder=null,Ha._fontDownloadStopwatch=null,Ha._fontPropertiesFontDownloadStopwatch=null,Ha._isFontSupportedOnCanvasContext=null,Ha._customFontAlternateNameDict=new Q.a(Ha.createCustomFontAlternateNameDict),Ha.cachedFontPickerOfficeFontsSection=null,Ha.isFontPickerOfficeFontsSectionCacheFixEnabled=void 0,Ha._legalCssClassNameChars=new Q.a(Ha.createLegalCSSClassNameCharRegex),Ha._fontStyleIncludedList=new oa.a(ra.a.get_ordinalIgnoreCase()),Ha._customFontCatalogUrl=null,Ha._customFontBaseUrl=null,Ha._customFontCatalogVersion=0,Ha._customFontEncData=null,Ha._isCustomFontAlreadyPresentInDocument=!1,Ha.shouldApplyAltName=!0,Ha._defaultFonts=["sans-serif","serif","cursive","monospace"],Ha._defaultFontWidths=[-1,-1,-1,-1],Ha._defaultFontHeights=[-1,-1,-1,-1],Ha._defaultFontWidthsCanvas=[-1,-1,-1,-1],Ha._alwaysSupportedFonts=null,Ha._addAllSupportedFontsPerfLogged=!1,Ha._isFontDropdownInitialized=void 0,Ha._fontSizeDictionary=null,Ha._areFontArraysInitialized=!1,Ha.sectionIdTheme="T",Ha.sectionIdMru="M",Ha.sectionIdDocument="D",Ha.sectionIdOnDemand="O",Ha.sectionIdAll="A",Ha.sectionCustomFont="C",Ha.sectionIdAllCustomFont="AC",Ha._supportedFonts=null,Ha._commonFontsNames=null,Ha._normalizedFonts=null,Ha._customFontSectionLabel=null,Ha._fontDetectionSpan=null,Ha._altFontEucToNative=null,Ha._altFontNativeToEuc=null,Ha._symbolFonts=null,Ha._mruFonts=null,Ha._documentFonts=null,Ha._isDocumentFontsPopulatedToMruFonts=!1,Ha._themeFonts=null,Ha._hiddenFontsManager=null,Ha._fontServiceFontDictionary=null,Ha._customFontDictionary=null,Ha._embeddedFontDictionary=null,Ha._embeddedFontsForTelemetry=null,Ha._fontServiceFontEnabled=!1,Ha._embeddedFontEnabled=!1,Ha._addFontServiceFontCallback=null,Ha._addCustomFontCallback=null,Ha._addEmbeddedFontCallback=null,Ha._previewFontCss=null,Ha._onDemandFontsManager=null,(0,a.a)(Ha,"FontUtils",null,[]);class Va{constructor(e,t){this._simplifiedUxCommand=e,this._commandHandlerData=t}}(0,a.a)(Va,"ReactExecuteCommandContext",null,[]);class Ga{}Ga.Trigger="FontTrigger",Ga.Name="FontName",Ga.Action="FontAction",Ga.Level="FontLevel",Ga.IsPinned="FontIsPinned",(0,a.a)(Ga,"FontPickerLogProperties",null,[]);var Qa=n(6244),qa=n(5901);const Ka="ScheduledFocusOnMenuPositioned";class za{get selectorsAreReady(){return!!window.appChrome&&!!appChrome.selectors}schedulePendingTasks(){-1!==this._currentEnqueuedExecuteTasksTimerId&&window.clearTimeout(this._currentEnqueuedExecuteTasksTimerId),this._currentEnqueuedExecuteTasksTimerId=window.setTimeout((()=>{for(this._currentEnqueuedExecuteTasksTimerId=-1;this._enqueuedExecuteTasks.length>0;){if(ta.TaskManager.instance.isYielding){this.schedulePendingTasks();break}const e=this._enqueuedExecuteTasks.shift();e&&this.executeCommand(e._simplifiedUxCommand,e._commandHandlerData)}}),0)}executeCommand(e,t){if(ta.TaskManager.instance.isYielding){if(this._shouldEnqueueTasksWhenTaskManagerIsYielding)return this._enqueuedExecuteTasks.push(new Va(e,t)),void this.schedulePendingTasks();if(i.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",e,t.modelType,Y.a.toJSON(t.payload)),this._appSettingsManager.getBooleanAppSetting("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(t){const n=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e),a=t.modelType;this._PRICommandHandler&&this._PRICommandHandler.logCommandExecuted(e,t),this.isHideModalAndPopScopeAsyncEnabled&&n&&window.Event&&(window.Event.ActionCommandId=n.commandId),n?this.executeCommandWithCommandMetadata(e,n,a,t):this.executeCommandWithNoCommandMetadata(e,a,t),this.checkForBypassedPRIReadinessCheck(t),this.manageAppFocus(e,t)}}executeCommandWithNoCommandMetadata(e,t,n){switch(t){case"GalleryModel":case"PreviewGalleryModel":this.executeGalleryButtonCommand(n,e);break;case"ButtonModel":this.executeButtonCommand(n,e);break;default:return void 0}}updateParametersForButton(e,t,n,a,i){let o=i;if(n.payload){switch(n.payload.type){case"CoauthorMenuPayload":e.MenuItemId=n.payload.coauthorId;break;case"ButtonPayload":if(e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,e.TerminalParentControlId=n.payload.terminalParentControlId,this._appSettingsManager&&this._appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8213680_EnableUnDismissWhenClickingMenu")){let e=!0;Gt.d(n.payload.dismissHostingSurfaceOnExecute)||(e=n.payload.dismissHostingSurfaceOnExecute),(e||this._appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9383525_DismissWhenClickingMenuInTellMe")&&17===nt.f(n.payload))&&this.closeAllMenus()}else this.closeAllMenus();break;case"ButtonPreviewPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,o=t.commandPreviewId;break;case"ButtonRevertPreviewPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,o=t.commandRevertId;break;default:e.MenuItemId=t.menuItemId}}else e.MenuItemId=t.menuItemId;return e.SourceControlId=a,o}updateParametersForTellMe(e,t,n){if(t.payload){switch(t.payload.type){case"MenuOpenPayload":e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case"MenuClosePayload":e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case"TellMeMenuItemExecuted":n.CommandId=t.payload.executedControl,n.ControlId=t.payload.executedControl,n.ParentControlId=t.payload.parentControl,n.CloseAllMenus=!0,this.closeAllMenus();break;case"TellMeSearchResultChangePayload":n.Value=t.payload.searchText;break;case"SmartLookupPayload":n.CommandValueId=t.payload.selectionContextJson;break;case"CopilotHandoffPayload":n.handoffMessage=t.payload.operation}}return e}clearPolledMenuCommands(){this._polledMenuCommands=[]}executeCommandWithCommandMetadata(e,t,n,a){const o=Date.now(),r=this.populateControlMenuOnExecute(a,n);let l=t.commandId;const c=this._appSettingsManager&&!this._appSettingsManager.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RemoveFontNameFromTelemetryData",!1),d={},u={};switch(n){case"SplitButtonModel":if(this.handleMenuOpenClosePayload(a.payload,this.updateSplitButtonMenuState,r))return;d.MenuItemId=t.menuItemId,this.setToggledParameter(a,d);break;case"StatefulSplitButtonModel":{if(this.handleMenuOpenClosePayload(a.payload,this.updateStatefulSplitButtonMenuState,r))return;const e=a.payload.statefulData,t=a.payload.statefulMode;if("color"===t)d.Color=e;else if("icon"===t){const t=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e);t&&(d.MenuItemId=t.menuItemId)}else 0;break}case"FileMenu":d.MenuItemId=t.menuItemId,d.SourceControlId=e,a.payload&&"FileMenuPageSwitchPayload"===a.payload.type&&this.handleFileMenuPageSwitch(l,a.payload,e);break;case"TellMe":l=this.updateParametersForTellMe(l,a,d),d.SourceControlId=e,d.Location=a.payload.location;break;case"ButtonModel":a.payload&&"TabSwitchPayload"===a.payload.type?this.handleTabSwitch(d,a):l=this.updateParametersForButton(d,t,a,e,l);break;case"CompoundButtonModel":d.MenuItemId=t.menuItemId,d.CommandValueId=a.payload.commandValueId,d.SourceControlId=e,this.setToggledParameter(a,d),this.closeAllMenus();break;case"ToggleButtonModel":d.IsDoubleClick=a.payload.isDoubleClick;case"InkButtonModel":d.MenuItemId=t.menuItemId,d.SourceControlId=e,this.setToggledParameter(a,d),this.closeAllMenus();break;case"FontPickerModel":switch(a.payload.type){case"MenuOpenPayload":l=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("FontPickerMenuOpen").commandId,d[At.FontPickerId]=a.payload.launcherId;break;case"MenuClosePayload":l=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("FontPickerMenuClose").commandId,d[At.FontPickerId]=a.payload.launcherId;break;case"FontPickerFontSelectedPayload":{const t=a.payload.font;this._appSettingsManager&&this._appSettingsManager.isChangeGateEnabled("TelemetryFontUserAction")&&t&&t.fontSectionName&&this.logFontSection("FontSelected",t.fontSectionName);let n=null;if("string"==typeof t){const e=Ha.normalizedFontName(t);d.CommandValueId=e,n=Ha.createMruEntry(e)}else{const e=t;e.data?(d.CommandValueId=e.data.fontToApply,d.MenuItemId=e.data.themeIndex,d[At.Formatting]=e.data):d.CommandValueId=e.name,n=t}if(d.SourceControlId=e,d[At.RequestUpdateMru]=n,c){if(a.payload.nameToLog)u[Ga.Name]=a.payload.nameToLog;else if("string"==typeof t){const e=t;u[Ga.Name]=Ha.isCompatibilityFont(e)?"*"+e:Ha.isEmbeddedFont(e)?"[EF]":"[MF]"}else u[Ga.Name]="";u[Ga.IsPinned]=a.payload.isPinned,u[Ga.Level]=a.payload.level}this.logFontPickerExperience();break}case"ButtonPayload":this.logFontPickerExperience();break;case"FontPickerFontPreviewPayload":{l=t.commandPreviewId;const e=a.payload.font;if("string"==typeof e){const t=Ha.normalizedFontName(e);d.CommandValueId=t}else{const t=e;t.data?d.CommandValueId=t.data.fontToApply:d.CommandValueId=t.name}this.logFontPickerExperience();break}case"FontPickerFontResetPreviewPayload":l=t.commandRevertId,this.logFontPickerExperience();break;case"FontPickerFontInfoRequestedPayload":{const e=a.payload.font;d.CommandValueId=e.name,d[At.Trigger]=a.payload.trigger,u[Ga.Trigger]=a.payload.trigger,c&&(u[Ga.Name]=a.payload.nameToLog),this.logFontPickerExperience();break}case"FontPickerFontPinningPayload":{const e=a.payload.fontKey,t=a.payload.isPinned;if(d.CommandValueId=e,d[At.IsPinned]=t,this._appSettingsManager&&this._appSettingsManager.isChangeGateEnabled("TelemetryFontUserAction")){const e=a.payload.font;e&&e.fontSectionName&&t&&this.logFontSection("FontPinned",e.fontSectionName)}c&&(u[Ga.Name]=a.payload.nameToLog,u[Ga.Action]=t?"pin":"unpin",u[Ga.Level]=a.payload.level),this.logFontPickerExperience();break}default:return void 0}break;case"ComboBoxModel":{const i=a.payload.type;switch(i){case"MenuOpenPayload":case"MenuPopulatePayload":if(this.shouldPoll(a.payload.launcherId,r)){const t={};t[a.payload.launcherId]=n,this._reactRibbonRootPoller.pollForStateAndUpdateCommands(t,nt.f(a.payload)),this._lastPollTimes[e]=new Date}return;case"MenuClosePayload":return;case"ComboBoxPayload":case"ComboBoxPreviewPayload":{const e=a.payload.newValue;if(!e)return;e.value?(d[Ct.a.Value]=e.value,d[Ct.a.IsFreeForm]=!0):(d[Ct.a.Value]=e.text,d.MenuItemId=e.key,d.CommandValueId=e.commandValueId),"ComboBoxPreviewPayload"===i&&(l=t.commandPreviewId);break}case"ComboBoxRevertPreviewPayload":l=t.commandRevertId;break;default:return void 0}break}case"FlyoutAnchorModel":switch(a.payload.type){case"ZeroTermContextMenuClosePayload":{const e=Y.a.getKeys(a.payload);for(const t of e)d[t]=a.payload[t];break}default:this.handleMenuOpenClosePayload(a.payload,this.updateFlyoutAnchorMenuState,r),d.launcherId=a.payload.launcherId}break;case"InkFlyoutAnchorModel":this.handleMenuOpenClosePayload(a.payload,this.updateInkFlyoutAnchorMenuState,r),d.launcherId=a.payload.launcherId;break;case"ColorPickerModel":switch(a.payload.type){case"ColorPickerPayload":d[ft.a.Color]=a.payload.selectedColorId,d.colorRGB=a.payload.color;break;case"ColorPickerPreviewPayload":l=t.commandPreviewId,d[ft.a.Color]=a.payload.selectedColorId;break;case"ColorPickerRevertPreviewPayload":l=t.commandRevertId;break;default:return void 0}break;case"SpinButtonModel":d[vt.a.Number]=a.payload.value,d[vt.a.UnitType]=St.a.convertStringToUnitType(a.payload.unitType.toLowerCase()),d[vt.a.Text]=a.payload.reservedValue;break;case"SliderModel":d[Tt.a.Value]=a.payload.value;break;case"InsertTableModel":d[Qa.a.Rows]=a.payload.rows,d[Qa.a.Columns]=a.payload.columns;break;case"CheckboxModel":d[It.a.On]=a.payload.checked,d.MenuItemId=t.menuItemId,d.TerminalParentControlId=a.payload.terminalParentControlId;break;case"PreviewGalleryModel":if(this.handleMenuOpenClosePayload(a.payload,this.updatePreviewGalleryMenuState,r)){d.launcherId=a.payload.launcherId;break}return void this.executeGalleryButtonCommand(a,e);case"DocumentTitleModel":switch(a.payload.type){case"DocumentTitleRenamePayload":d.getNewDocumentTitle=a.payload.getNewDocumentTitle;break;case"MenuOpenPayload":{const t={};return t[a.payload.launcherId]=n,this._reactRibbonRootPoller.pollForStateAndUpdateCommands(t,nt.f(a.payload)),void(this._lastPollTimes[e]=new Date)}case"MenuClosePayload":return;default:return void 0}break;case"MRUCompoundButtonModel":d.MenuItemId=a.payload.url,this.logFileMenuMRUExecution(a.payload.pageId);break;case"NewBlankDocumentModel":case"CustomTemplateModel":d.MenuItemId=a.payload.assetId,d.SourceControlId=e,s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BackstagePremiumTemplateExperienceEnabled")&&(d.IsPremium=a.payload.isPremium||!1),this.logFileMenuTemplateExecution(a.payload.pageId);break;case"CoauthorGallery":case"PeopleWell":d.RenderTime=a.triggerTime;break;case"SyncStatus":d.SourceControlId=e;break;case"InputBoxModel":d.Text=a.payload.newValue;break;case"PersonaButtonModel":d.CommandValueId=a.payload.commandValueId,this.handlePersonaCardOpenClose(a.payload);break;case"MultiActionButtonModel":d.CommandValueId=a.payload.commandValueId,d.Href=a.payload.href,d.SourceControlId=e,d.Type=a.payload.type,d.TerminalParentControlId=a.payload.terminalParentControlId,this.closeAllMenus();break;case"SearchBoxModel":d.Type=a.payload.type,d.SearchBoxNewValue=a.payload.newValue;break;case"PromptInputModel":d.MenuItemId=a.payload.value,d.SourceControlId=`${a.payload.location}.${e}`;break;default:return void 0}if(!l||this.isShadowMenuOpen(a.payload))return;if(a.payload&&"terminalParentControlId"in a.payload&&(d.ParentMenuId=a.payload.terminalParentControlId),d.CommandValueId||(d.CommandValueId=d.MenuItemId),t.legacyControlId&&(d.LegacyId=t.legacyControlId),d.SourceControlId||(d.SqmControlId=e),this._appSettingsManager&&this._appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&d.launcherId){const e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(d.launcherId);e&&(d.launcherCommandId=parseInt(e.commandId))}a.payload&&!Gt.d(a.payload.PRIReadinessCheck)&&(d.PRIReadinessCheck=a.payload.PRIReadinessCheck,this._priReadinessCheckHandled=!0),a.payload&&!Gt.d(a.payload.shouldTakeFocus)&&(d.ShouldCanvasTakeFocus=a.payload.shouldTakeFocus);const p=this.addInputMethodToParameters(a,d);a.payload&&!Gt.d(a.payload.interactiveUid)&&(u.interactive_uid=a.payload.interactiveUid),Gt.d(a.triggerTime)||(u.TriggerTime=a.triggerTime),a.payload&&!Gt.d(a.payload.userActionKey)&&(u.userActionKey=a.payload.userActionKey),this.setControlInformationForAction(u,a,e,l),a.payload&&!Gt.d(a.payload.event)&&(u.event=a.payload.event),this._rootCommandHandler.executeCommand(l,d,this.getSelectedTabId(),p,!0,(t=>{this.moveFocusAfterCommandExecution(d,e)}),u,nt.f(a.payload)),this._appSettingsManager&&this._appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTimeToExecuteCommandWithCommandMetadata",!1)&&i.ULS.sendTraceTag(508118238,207,50,"executeCommandWithCommandMetadata executed for command :{0} and time taken in execution :{1}",e,Date.now()-o)}setControlInformationForAction(e,t,n,a){if(this._appSettingsManager&&this._appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8561837_EnableControlIDDatafields")&&n&&a&&t.payload){const i=!Gt.d(t.payload.launcherId),o=i?t.payload.launcherId:n,r=this.sanitizeControlId(this.getNormalizedControlId(o,a),a,!1);e.ControlId=r;const s=t.payload.inputMethod,l=t.payload.location;if(!Gt.d(s)&&!Gt.d(l)){const e=!i&&1===s,n=!i&&(2===s||3===s||4===s),a=i&&("Overflow"===l||"ToolBarOverflow"===l),o=t.payload.type,c=a||"TabSwitchPayload"===o,d=o&&o?.includes("Preview");this.logControlActivityForExperiment(e,n,c,r,l,d)}}this._appSettingsManager&&this._appSettingsManager.getBooleanAppSetting("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&t.payload&&"terminalParentControlId"in t.payload&&(e.TerminalParentControlId=this.sanitizeControlId(t.payload.terminalParentControlId,a,!0))}logControlActivityForExperiment(e,t,n,a,i,o){if(this._appSettingsManager&&this._appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&!o){this._controlIdsSeen||(this._controlIdsSeen={});const o=new Array(0),r=Xn.a.getDataField("UILocation",i,qa.g.String);Array.add(o,r);const s=this.getSelectedTabId();if(s){const e=Xn.a.getDataField("Tab",s,qa.g.String);Array.add(o,e)}this._controlIdsSeen[a]||n||(this._controlIdsSeen[a]=1,t?this.logCommandingActivity("DistinctUserInitiatedTerminalCommand",o):e&&this.logCommandingActivity("DistinctUserInitiatedKeyboardCommand",o)),t?n?this.logCommandingActivity("UserInitiatedNavigationalCommand",o):this.logCommandingActivity("UserInitiatedTerminalCommand",o):e&&this.logCommandingActivity("UserInitiatedKeyboardCommand",o)}}logCommandingActivity(e,t){Ie.a(e,null,0,!0,0,t)}sanitizeControlId(e,t,n){if(new RegExp("^[a-zA-Z0-9_]*$").test(e))return e;{let e;return e=n?"CommandId: "+t+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+t+" has a controlId that is non-alphanumeric and may need to be changed",i.ULS.sendTraceTag(510247689,207,15,e),"MalformedId"}}getNormalizedControlId(e,t){const n=parseInt(t),a=I.ActionManager.commandIdResolver(n)||I.ActionManager.actionIdResolver(n)||"";return Gt.d(a)||!(a in this._commandControlIdOverridePairs)?e.length>100?"":e:this._commandControlIdOverridePairs[a]}logFontPickerExperience(){this._systemInitiatedFeedback&&this._systemInitiatedFeedback.execute((e=>{e.logActivityDeferred("ModernFontPickerExperience",null)}))}logFontSection(e,t){i.ULS.sendTraceTag(507789587,3021,50,"FontUserAction:{0}, FontSectionName: {1}",e,t)}addInputMethodToParameters(e,t){let n=2;return e.payload&&"inputMethod"in e.payload&&e.payload.inputMethod&&(n=e.payload.inputMethod,t.InputMethod=n),n}moveFocusAfterCommandExecution(e,t){const n=(0,at.a)(r.a,s.AFrameworkApplication.activeFrame);if(this._focusManager&&this.shouldMoveFocus(e)){if(!this._focusManager.currentScope&&n){let a="null";if(e){const t=e.Value;delete e.Value,a=Y.a.toJSON(e),Gt.d(t)||(e.Value=t)}i.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",t,a,n.ribbonFocusScopeName)}this._focusManager.focusLastEditableSurface()}(!!this._focusManager&&!!this._focusManager.currentScope&&this._focusManager.currentScope.name!==r.a.reactTransientUIFocusId&&!!n&&this._focusManager.currentScope.name!==n.ribbonFocusScopeName||this.shouldMoveFocus(e))&&this.collapseShyRibbonOnKeyboard(e)}shouldMoveFocus(e){return!!e&&!Gt.d(e.ShouldCanvasTakeFocus)&&e.ShouldCanvasTakeFocus}collapseShyRibbonOnKeyboard(e){"InputMethod"in e&&1===e.InputMethod&&ea.a.changeShyRibbonState(1,0)}handleTabSwitch(e,t){const n=t.payload?.automaticallyTriggered;if(!s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")||s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("SharedOnline.ChangeGate.FixContextualMenuDismissOnTabSwitch")&&n||this.closeAllMenus(),this._ribbonRoot.pollForStateAndUpdate(),this._ribbonSQMInformation&&this._actionManager){const e={};e.TabId=t.payload.tabId,this._actionManager.processActionWithData(m.a.reportTabSwitch,2,e,this.getTelemetryData(t)),Gt.d(t.payload.inputMethod)||(this._actionManager.processAction(m.a.reportTabSwitchManual,2),this._appSettingsManager&&this._appSettingsManager.isChangeGateEnabled("PPTOAutoTabExperimentTelemetryEnabled")&&this._appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoTabTelemetryEnabled",!1)&&Ie.a("Report"+t.payload.tabId+"TabManualSwitch"),this._tellMeCoachMarkShown||this.showTellMeCoachMarks(t.payload.tabId))}const a=t.payload.tabId;if(e.NewContextId=a,e.NewContextCommand=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(a),i.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+a),this._systemInitiatedFeedback&&a){const e=a+"TabSwitchActivity";this._systemInitiatedFeedback.execute((t=>{t.logActivityDeferred(e,null)}))}}handleMenuOpenClosePayload(e,t,n){const a=e.type;return"MenuClosePayload"===a||"MenuOpenPayload"===a&&(t(e,n),!0)}handlePersonaCardOpenClose(e){const t=e.type;"MenuOpenPayload"===t?s.AFrameworkApplication.suppressAppCloseOnNavigate=!0:"MenuClosePayload"===t&&(s.AFrameworkApplication.suppressAppCloseOnNavigate=!1)}populateControlMenuOnExecute(e,t){if(!e.payload||!e.payload.launcherId||"MenuOpenPayload"!==e.payload.type&&"MenuPopulatePayload"!==e.payload.type)return!1;const n=e.payload.launcherId,a=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(n);if(a&&a.populationProps){const o=performance.now(),r=this._reactRibbonRootPoller.populateControlMenuAndGetUpdatedControls(a,t,e.payload);return this._logGetUpdatedMenuControlsTimeEnabled&&i.ULS.sendTraceTag(507568153,207,50,"populateControlMenuAndGetUpdatedControls executed for Command :{0}, ModelType: {1}, TotalTime :{2}, populatedControlMenu :{3}",n,t,performance.now()-o,Y.a.toJSON(r)),r?.populatedMenu&&n in this._lastPollTimes&&delete this._lastPollTimes[n],this._polledMenuCommands=r?.polledMenuControls??[],r?.populatedMenu}return!1}getMenuItemsToPoll(e){const t=e;return this._pollAllMenuCommandsEnabled&&0!==this._polledMenuCommands.length?(Object.keys(e).forEach((e=>{-1!==this._polledMenuCommands.indexOf(e)&&delete t[e]})),t):t}getSelectedTabId(){return this.selectorsAreReady?appChrome.selectors.getSelectedTabId():null}updateMenuItems(e,t,n){this._reactRibbonRootPoller.pollForStateAndUpdateCommands(e,n),this._lastPollTimes[t]=new Date}shouldPoll(e,t,n){let a=!0;if(this._pollAllMenuCommandsEnabled&&n)return n;if(e in this._lastPollTimes){a=this._lastPollTimes[e].getTime()<this._ribbonRoot.lastPollTime.getTime()}return a=a&&!t,a&&this.selectorsAreReady}executeGalleryButtonCommand(e,t){const n={},a=e.payload.selectedGalleryId,i=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(a);if(i){n.SourceControlId=a,n.MenuItemId=i.menuItemId,n.SqmControlId=t,i.legacyControlId&&(n.LegacyId=i.legacyControlId),e.payload&&!Gt.d(e.payload.shouldTakeFocus)&&(n.ShouldCanvasTakeFocus=e.payload.shouldTakeFocus),this.getParametersByGalleryPayloadType(e.payload,n);let o=this.getTelemetryData(e);o||(o={}),this._appSettingsManager&&this._appSettingsManager.isChangeGateEnabled("AddInteractiveUidForGalleryButtonCommand")&&e.payload&&!Gt.d(e.payload.interactiveUid)&&(o.interactive_uid=e.payload.interactiveUid),this.setControlInformationForAction(o,e,t,i.commandId);const r=this.addInputMethodToParameters(e,n);this._rootCommandHandler.executeCommand(i.commandId,n,this.getSelectedTabId(),r,!0,(e=>{this.moveFocusAfterCommandExecution(n,t)}),o,nt.f(e.payload))}}executeButtonCommand(e,t){const n=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(t);if(n){const a={};a.SourceControlId=t,a.MenuItemId=t,a.SqmControlId=t,e.payload&&!Gt.d(e.payload.shouldTakeFocus)&&(a.ShouldCanvasTakeFocus=e.payload.shouldTakeFocus);let i=this.getTelemetryData(e);i||(i={}),this.setControlInformationForAction(i,e,t,n.commandId);const o=this.addInputMethodToParameters(e,a);this._rootCommandHandler.executeCommand(n.commandId,a,this.getSelectedTabId(),o,!1,(e=>{this.moveFocusAfterCommandExecution(a,t)}),i,nt.f(e.payload))}}getParametersByGalleryPayloadType(e,t){"CharacterGalleryPayload"===e.type&&(t.MenuItemId=e.character)}setToggledParameter(e,t){e.payload&&"toggled"in e.payload&&(t[It.a.On]=e.payload.toggled)}static get isSchedulingFocusOnMenuPositionedEnabled(){return null!=za.__cached_isSchedulingFocusOnMenuPositionedEnabled_0_157e8cd9?za.__cached_isSchedulingFocusOnMenuPositionedEnabled_0_157e8cd9:za.__cached_isSchedulingFocusOnMenuPositionedEnabled_0_157e8cd9=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SchedulingFocusOnMenuPositionedEnabled")}static isMultiFrameRender(e){return"isMultiFrameRender"in e&&e.isMultiFrameRender}static isShadowRendering(e){return"isShadowRendering"in e&&e.isShadowRendering}manageAppFocus(e,t){const{payload:n}=t;if("MenuOpen"===e){if(this._modalDiv&&!za.isShadowRendering(n))if(za.isSchedulingFocusOnMenuPositionedEnabled&&za.isMultiFrameRender(n)){const e=()=>{this._modalDiv?this._modalDiv.onMenuOpen():i.ULS.sendTraceTag(505709794,207,15,"modalDiv is null in callback of manageAppFocusScopeForMultiFrame"),window.removeEventListener(Ka,e)};window.addEventListener(Ka,e)}else this._modalDiv.onMenuOpen()}else"MenuClose"===e&&this._modalDiv&&this._modalDiv.onMenuClose()}closeAllMenus(){this._modalDiv&&this._modalDiv.onCloseAllMenus()}getTelemetryData(e){let t=null;return Gt.d(e.triggerTime)||(t={},t.TriggerTime=e.triggerTime),t}handleFileMenuPageSwitch(e,t,n){if(this._fileMenuSQMInformation&&this._actionManager){const e={};e.PageId=n,this._actionManager.processActionWithData(m.a.reportFileMenuPageSwitch,2,e)}this.updateMenuItems(t.pageControlIdMap,e,nt.f(t))}logFileMenuTemplateExecution(e){if(this._actionManager)switch(e){case"FileHomePage":this._actionManager.processAction(m.a.reportTemplateFromHomePage,2);break;case"FileNewPage":this._actionManager.processAction(m.a.reportTemplateFromNewPage,2)}}logFileMenuMRUExecution(e){if(this._actionManager)switch(e){case"FileHomePage":this._actionManager.processAction(m.a.reportMRUFromHomePage,2);break;case"FileOpenPage":this._actionManager.processAction(m.a.reportMRUFromOpenPage,2)}}isShadowMenuOpen(e){return!!e&&"MenuOpenPayload"===e.type&&e.isShadowRendering}showTellMeCoachMarks(e){if(s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMeHelpCoachMarkActivityEnabled")&&"Help"===e)return this._systemInitiatedFeedback.execute((e=>{e.logActivity("TellMeHelpCoachMarkActivity",null)})),void(this._tellMeCoachMarkShown=!0);if(s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMe3TabSwitchCoachMarkActivityEnabled")&&3==++this._tabSwitchCount)return this._systemInitiatedFeedback.execute((e=>{e.logActivity("TellMe3TabSwitchCoachMarkActivity",null)})),void(this._tellMeCoachMarkShown=!0);if(s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMe1TabSwitchCoachMarkActivityEnabled")){32===this._actionManager.processAction(m.a.showTellMeCoachmark,2)&&(this._tellMeCoachMarkShown=!0)}}checkForBypassedPRIReadinessCheck(e){e&&e.payload&&e.payload.PRIReadinessCheck&&!this._priReadinessCheckHandled&&appChrome.PRIToastManager.dismissToast()}get isHideModalAndPopScopeAsyncEnabled(){return s.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideModalAndPopScope",!1)}constructor(e,t,n,a,i,o,r,s,l,c=null,d=null){if(this._modalDiv=null,this._shouldEnqueueTasksWhenTaskManagerIsYielding=!1,this._enqueuedExecuteTasks=[],this._currentEnqueuedExecuteTasksTimerId=-1,this._tellMeCoachMarkShown=!1,this._tabSwitchCount=0,this._commandControlIdOverridePairs=null,this._priReadinessCheckHandled=!1,this._controlIdsSeen=null,this._loggedToolbarSurveyActivity=!1,this._pollAllMenuCommandsEnabled=!1,this._logGetUpdatedMenuControlsTimeEnabled=!1,this._polledMenuCommands=[],this.updateFlyoutAnchorMenuState=(e,t)=>{const n=e.launcherId,a=this.getMenuItemsToPoll(this.selectorsAreReady?appChrome.selectors.getFlyoutAnchorMenuItems(n):{});this.shouldPoll(n,t,Object.keys(a).length>0)&&this.updateMenuItems(a,n,nt.f(e))},this.updateInkFlyoutAnchorMenuState=(e,t)=>{const n=e.launcherId,a=this.getMenuItemsToPoll(this.selectorsAreReady?appChrome.selectors.getInkFlyoutAnchorMenuItems(n):{});this.shouldPoll(n,t,Object.keys(a).length>0)&&this.updateMenuItems(a,n,nt.f(e))},this.updatePreviewGalleryMenuState=(e,t)=>{const n=e.launcherId,a=this.getMenuItemsToPoll(this.selectorsAreReady?appChrome.selectors.getPreviewGalleryMenuItems(n):{});this.shouldPoll(n,t,Object.keys(a).length>0)&&this.updateMenuItems(a,n,nt.f(e))},this.updateSplitButtonMenuState=(e,t)=>{const n=e.launcherId,a=this.getMenuItemsToPoll(this.selectorsAreReady?appChrome.selectors.getSplitButtonMenuItems(n):{});this.shouldPoll(n,t,Object.keys(a).length>0)&&this.updateMenuItems(a,n,nt.f(e))},this.updateStatefulSplitButtonMenuState=(e,t)=>{const n=e.launcherId,a=this.getMenuItemsToPoll(this.selectorsAreReady?appChrome.selectors.getStatefulSplitButtonMenuItems(n):{});this.shouldPoll(n,t,Object.keys(a).length>0)&&this.updateMenuItems(a,n,nt.f(e))},this._ribbonRoot=e,this._reactRibbonRootPoller=t,this._rootCommandHandler=(0,at.a)(152,e),this._externalUICommandDefinitionMapping=n,this._focusManager=a,i&&(this._modalDiv=new $n(i,a)),this._ribbonSQMInformation=o,this._fileMenuSQMInformation=r,this._systemInitiatedFeedback=c,this._actionManager=s,this._lastPollTimes={},this._appSettingsManager=l,this._PRICommandHandler=d,l&&(l.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||l.getBooleanAppSetting("EnqueueTasksWhenTaskMgrIsYielding"))){y.a.instance.appIsInteractiveTask.CWR((e=>this._shouldEnqueueTasksWhenTaskManagerIsYielding=!0))}if(l){const e=this._appSettingsManager.getStringAppSetting("CommandControlIdPairsForLoggingOverride")||"";e&&e.trim().length>=0&&({deserialized:this._commandControlIdOverridePairs}=na.d(e))}this._commandControlIdOverridePairs||(this._commandControlIdOverridePairs={}),this._pollAllMenuCommandsEnabled=l&&l.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8213680_PollAllMenuCommandsEnabled"),this._logGetUpdatedMenuControlsTimeEnabled=l&&l.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTimeToExecuteGetUpdatedMenuControlsTime",!1)}}(0,a.a)(za,"ReactExecuteCommandHandler",null,[]);var ja=n(2091),Za=n(5122),Xa=n(4094);let Ja;class Ya{static trimPeripheralControls(e){s.AFrameworkApplication.activeFrame.applicationInstance.isCommentsButtonInCollabCornerEnabled||(e.ShowCommentsTopBar=!0),s.AFrameworkApplication.activeFrame.applicationInstance.isChangesButtonEnabled||(e.CatchUpWithChanges=!0)}static trimAllHostControls(e){for(const t of Ya._hostControlIdsToTrimByDefault)e[t]=!0}static updateTrimmingOfHostProvidedUIControls(e,t){const n=s.AFrameworkApplication.hostUIControlSettingName;if(!s.AFrameworkApplication.appSettingsManager.containsAppSetting(n)||!s.AFrameworkApplication.appSettingsManager.getStringAppSetting(n))return;Ya.trimAllHostControls(t);const a=s.AFrameworkApplication.appSettingsManager.getListAppSetting("HostDefinedUIControls");for(let n=0;n<a.length;n++)Ya.updateTrimmingOfHostUIControl(e,t,a[n]);Ya.trimControlsImplicitlyBasedOnInitialTrimming(t),Ya.trimControlsByExperiment(t)}static updateTrimmingOfHostUIControl(e,t,n){if(!(n.id in e))return;const a=e[n.id];for(const e of a)1===n.visibility?t[e]=!1:n.visibility||(t[e]=!0)}static trimControlsImplicitlyBasedOnInitialTrimming(e){e.HostOpenInBrowser&&e.HostOpenInClient&&e.HostDownload?e.HostMoreOptions=!0:e.HostMoreOptions=!1}static isTeams(){const e=s.AFrameworkApplication.appSettingsManager.getStringAppSetting(s.AFrameworkApplication.uiHostSettingName);return!!e&&"teams"===e.toLowerCase()}static shouldShowHostOpenInclientFromExperiment(){return s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsTeamsCollabDeclutterIsEnabled")}static shouldTrimHostMoreOptionsFromExperiment(){return s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",!1)||s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsPeripheralOverflowScalingEnabled")||s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsTeamsCollabDeclutterIsEnabled")}static trimControlsByExperiment(e){Ya.isTeams()&&(Ya.shouldShowHostOpenInclientFromExperiment()&&(e.HostOpenInClient=!1),Ya.shouldTrimHostMoreOptionsFromExperiment()&&(e.HostMoreOptions=!0))}}Ya._hostControlIdsToTrimByDefault=(Ja=new Ne.a,Ja.add("HostOpenInClient"),Ja.add("HostConversation"),Ja.add("HostClose"),Ja.add("HostDownload"),Ja.add("HostOpenInBrowser"),Ja.add("HostMoreOptions"),Ja),(0,a.a)(Ya,"CommandTrimmer",null,[]);var $a=n(753),ei=n(9717),ti=n(4754);const ni=(0,D.b)("Common.App.SaveStatus.ISaveStatusUIHandler");var ai=n(8028),ii=n(1400);const oi=(0,D.e)(ai.a,{onDemandRegister:(e,t)=>e.register(ii.a,"Common.App.Header.ReactSharedHeaderFocusManager").as(t).singleInstance().usingFactory((()=>new ii.a(s.AFrameworkApplication.activeFrame.theFocusManager,s.AFrameworkApplication.activeFrame.theF6Manager,s.AFrameworkApplication.activeFrame.theMouseInputManager,s.AFrameworkApplication.activeFrame.theTouchInputManager,s.AFrameworkApplication.theActionManager)))}),ri=(0,D.b)("Common.IRenameProps"),si=(0,D.b)("Common.IExternalUICommandDefinitionMapping");var li=n(4401),ci=n(2650);const di=(0,D.e)(ci.a);class ui{getCustomAuthConfig(){return this.hostPostMessengerPromise?(i.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.hostPostMessengerPromise):(this.stopWatch=this.stopWatchBuilder.makeAndStartStopwatch("ComponentAttach","getCustomAuthConfig"),this.hostPostMessengerPromise=new Promise(((e,t)=>{const n={};let a=!1,o=!1,r=0;this.timeoutIntervalHandle=window.setInterval((()=>{if(!(r<4))return window.clearInterval(this.timeoutIntervalHandle),a=!0,i.ULS.sendTraceTag(588087303,344,10,na.c({error:"Request timeout after 4 retries."})),void t("Request timeout.");r++,this.hostPostmessenger.sendMessage("App_GetCustomAuthConfig",n)}),1e3),this.promiseCallback=(n,r)=>{window.clearInterval(this.timeoutIntervalHandle),a||o||(o=!0,n?(i.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),e(n)):(i.ULS.sendTraceTag(589050654,369,10,na.c({error:r.toString()})),t(r)))},this.hostPostmessenger.sendMessage("App_GetCustomAuthConfig",n)})),this.hostPostMessengerPromise)}onReceivedCustomAuthConfig(e){try{const t=e.Values.AuthConfig,n=na.a(t);let a=s.AFrameworkApplication.appSettingsManager.getStringAppSetting("Application")||"";a=ce.a.toLower(a),n.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+a+"%3Facctsw%3D1&prompt=select_account",n.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+a+"%3Facctsw%3D1",n.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+a+"%3Facctsw%3D1&prompt=select_account",n.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+a+"%3Facctsw%3D1",this.stopWatch&&(this.stopWatch.stop(),this.stopWatch=null),this.promiseCallback(n,"")}catch(e){i.ULS.sendTraceTag(589050655,344,10,na.c({error:e.message,stack:e.stack})),this.promiseCallback(null,e.message)}}constructor(e){this.timeoutIntervalHandle=0,this.stopWatch=null,this.promiseCallback=null,this.hostPostMessengerPromise=null,this.stopWatchBuilder=s.AFrameworkApplication.activeFrame.theStopwatchBuilder,this.hostPostmessenger=e,this.hostPostmessenger.addAllowedReceivingMessage("Host_SetCustomAuthConfig"),this.hostPostmessenger.registerCallback("Host_SetCustomAuthConfig",(0,o.a)(this,this.onReceivedCustomAuthConfig,"onReceivedCustomAuthConfig"))}}(0,a.a)(ui,"AccountSwitchingManager",null,[434]);const pi=(0,D.e)("Common.App.AccountSwitching.AccountSwitchingManager",{onDemandSingleton:e=>new ui((0,D.a)(di))});class gi{resolveAccountSwitchingManager(){this._accountSwitchingManager||(this._accountSwitchingManager=(0,D.a)(pi))}getAccountSwitchingConfig(){return this.resolveAccountSwitchingManager(),this._accountSwitchingManager?this._accountSwitchingManager.getCustomAuthConfig():null}static isCustomAccountSwitchingConfigEnabled(){return s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UiHostSupportsCustomAuthConfig")}constructor(){this._accountSwitchingManager=null}}(0,a.a)(gi,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class hi{constructor(){this.cultureName=null,this.languageName=null}}(0,a.a)(hi,"HeaderCultureInfo",null,[]);var mi=n(5301);var _i=n(9223);const Si=(0,D.b)("Common.App.SearchCommon.ISearchOAuthManager");var fi=n(8135);class Ci{getTokenIfCached(e=!0){const t=this.dateNow();return t<this.m_cacheTime+this.tokenExpiryTime?(t>this.m_cacheTime+this.tokenRenewalTime&&this.getAndUpdateToken(),this.m_cachedToken):(e&&this.getAndUpdateToken(),null)}getToken(e=!0){const t=this.getTokenIfCached(e);return t?Promise.resolve(t):this.getAndUpdateToken()}getAndUpdateToken(){return this.m_oAuthPromise=this.m_oAuthPromise||new Promise((e=>{this.getTokenInternal().then((t=>{this.m_oAuthPromise=null,""!==t&&t&&(this.m_cachedToken=t,this.m_cacheTime=this.dateNow(),e(t)),e(null)})).catch((t=>{this.m_oAuthPromise=null,e(null)})),window.setTimeout((()=>{this.m_oAuthPromise=null,e(null)}),this.tokenRequestTimeout)})),this.m_oAuthPromise}_GetCurrentPromiseOrCacheToken_FORTEST(){return this.m_oAuthPromise?Promise.resolve(this.getTokenIfCached(!1)):this.getAndUpdateToken()}_ReplaceDateTimeProvider_FORTEST(e){this.dateNow=e}_ReplaceTokenMethod_FORTEST(e){this.getTokenInternal=e}constructor(e,t=3e4){this.tokenExpiryTime=9e5,this.tokenRenewalTime=1e4,this.m_oAuthPromise=null,this.m_cachedToken=null,this.m_cacheTime=0,this.dateNow=Date.now,this.getTokenInternal=e,this.tokenRequestTimeout=t,this.getAndUpdateToken()}}(0,a.a)(Ci,"OAuthCacheManager",null,[]);var yi=n(5665);class Ai{getToken(e,t){if(this.tokenCache.containsKey(t))return this.tokenCache.get_item(t).getToken();const n=new Ci((()=>this.getTokenInternalImplicitJS(e,t)));return this.tokenCache.set_item(t,n),n.getToken()}getTokenIfAvailable(e,t){if(this.tokenCache.containsKey(t))return this.tokenCache.get_item(t).getTokenIfCached();const n=new Ci((()=>this.getTokenInternalImplicitJS(e,t)));return this.tokenCache.set_item(t,n),null}getTokenInternalImplicitJS(e,t){if(!this.m_oauthManager)try{this.m_oauthManager=(0,D.a)(fi.a)}catch(e){i.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+e)}return this.m_oauthManager?new Promise((n=>{const a=Date.now();this.m_oauthManager.tryGetToken(e,t).then((i=>{const o=i.Token;if(!i.IsSuccess||this.isTokenEmpty(o))return this.sendGetTokenTelemetry("GetTokenInternalImplicitJS",!1,Date.now()-a,e,!0,i.ErrorCode,i.ErrorMessage,t),void n(null);this.sendGetTokenTelemetry("GetTokenInternalImplicitJS",!0,Date.now()-a,e,!0,i.ErrorCode,i.ErrorMessage,t),n(o)})).catch((i=>{const o=i?na.c(i):"";this.sendGetTokenTelemetry("GetTokenInternalImplicitJS",!1,Date.now()-a,e,!0,"Caught Exception",o,t),n(null)}))})):new Promise((t=>{this.sendGetTokenTelemetry("GetTokenInternalImplicitJS",!1,0,e,!0,"Null OAuthManager","OAuthManager not set"),t(null)}))}sendGetTokenTelemetry(e,t,n,a,i,o="",r="",s=""){const l="Search"===a,c=new Array(0),d=Xn.a.getDataField(l?"Event":"EventName",e,qa.g.String),u=Xn.a.getDataField("AppName",a,qa.g.String);if(Array.add(c,d),Array.add(c,u),l){const e=Xn.a.getDataField("LatencyType","FetchToken",qa.g.String);Array.add(c,e)}if(o&&""!==o){const e=Xn.a.getDataField("ErrorCode",o,qa.g.String);Array.add(c,e)}if(r&&""!==r){const e=Xn.a.getDataField("ErrorMessage",r,qa.g.String);Array.add(c,e)}if(s&&""!==s){const e=!(s in this._endpointCallDict);this._endpointCallDict[s]=e;const t=Xn.a.getDataField("WarmUpCall",e.toString(),qa.g.Boolean);Array.add(c,t);const n=Xn.a.getDataField("Service",this.getService(s),qa.g.String);Array.add(c,n)}const p=l?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";if(i){const e={name:p,samplingPolicy:qa.e.Complete,dataFields:c,succeeded:t,durationMs:n};yi.a.sendActivityEvent(e)}else{const e={name:p,samplingPolicy:qa.e.Complete,dataFields:c};yi.a.sendTelemetryEvent(e)}}getService(e){return e===s.AFrameworkApplication.lokiEndpointForSearch?"Loki":e===s.AFrameworkApplication.substrateEndpointForSearch?"Substrate":s.AFrameworkApplication.appSettingsManager&&e===s.AFrameworkApplication.appSettingsManager.getStringAppSetting("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}isTokenEmpty(e){return!e||!e.length}isValidString(e){return!!e&&""!==e.trim()}constructor(){this.m_oauthManager=null,this._endpointCallDict={},this.tokenCache=new sa.a(ra.a.get_ordinalIgnoreCase())}}(0,a.a)(Ai,"SearchOAuthManager",null,[454]);const bi=(0,D.e)(Si,{onDemandSingleton:e=>new Ai});class Ti{tryResolveSearchOAuthManager(){try{this._searchOauthManager||(this._searchOauthManager=(0,D.a)(bi))}catch(e){i.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+e)}}getTokenPromise(e,t){return this._searchOauthManager?this._searchOauthManager.getToken(e,t):new Promise((n=>{(0,D.h)(Si).execute((a=>{a?(this._searchOauthManager=a,this._searchOauthManager.getToken(e,t).then((e=>n(e)))):n(null)}))}))}getLokiTokenPromise(){return this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.getToken("Search",s.AFrameworkApplication.lokiEndpointForSearch):null}getSubstrateTokenPromise(){return"Dev Box"===s.AFrameworkApplication.appSettingsManager.getStringAppSetting("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride?new Promise((e=>{window.setTimeout((()=>{e(window.TellMeSubstrateTokenOverride)}),750)})):(this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.getToken("Search",s.AFrameworkApplication.substrateEndpointForSearch):null)}getTellMeTokenPromise(){return this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.getToken("Search",this.getTellMeServiceAuthEndpoint()):null}getTellMeServiceAuthEndpoint(){return s.AFrameworkApplication.appSettingsManager.getStringAppSetting("TellMeServiceAuthEndpointForSearch")}getShredderTokenPromise(){return"Dev Box"===s.AFrameworkApplication.appSettingsManager.getStringAppSetting("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride?new Promise((e=>{window.setTimeout((()=>{e(window.TellMeSubstrateTokenOverride)}),750)})):(this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.getToken("SmartLookup",this.getShredderServiceAuthEndpoint()):null)}getShredderServiceAuthEndpoint(){return s.AFrameworkApplication.appSettingsManager.getStringAppSetting("SmartLookupShredderServiceEndpoint")}getLokiTokenPromiseFunc(){return(0,o.a)(this,this.getLokiTokenPromise,"getLokiTokenPromise")}getSubstrateTokenPromiseFunc(){return(0,o.a)(this,this.getSubstrateTokenPromise,"getSubstrateTokenPromise")}shouldFetchTokensForSearch(){return!!s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.shouldFetchTokensForSearch}getTokenRequestDict(){const e={};return this.shouldFetchTokensForSearch()&&(e.Loki=this.getLokiTokenPromiseFunc(),e.Substrate=this.getSubstrateTokenPromiseFunc()),e}logTellMeResourceLoadEvent(e){yi.a.sendTellMeActivityEvent({name:"Events",dataFields:[{name:"Event",string:"StringsLoaded"},{name:"Status",bool:e}],durationMs:Math.round(window.performance.now())},"TellMeWAC.")}loadTellMeStrings(){return s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch((e=>(this.logTellMeResourceLoadEvent(!1),!1))).then((e=>(this.logTellMeResourceLoadEvent(!0),!0))):new Promise(((e,t)=>{const n=(0,D.a)(_i.a).getScriptLoader();n?n.loadScript("tellme-strings").then((()=>{this.logTellMeResourceLoadEvent(!0),e(!0)})).catch((e=>{this.logTellMeResourceLoadEvent(!1),t(!1)})):(this.logTellMeResourceLoadEvent(!1),t(!1))}))}static isSearchEnabled(){return!!s.AFrameworkApplication.activeFrame&&(s.AFrameworkApplication.activeFrame.applicationInstance.isTellMeInSharedHeaderEnabled||s.AFrameworkApplication.activeFrame.applicationInstance.isSharedHeaderSearchUxEnabled)}static isSearchUxEnabled(){return!!s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isSharedHeaderSearchUxEnabled}constructor(){this._searchOauthManager=null}}(0,a.a)(Ti,"ReactSharedHeaderSearchUtils",null,[]);class vi{constructor(){this.loadTellMeResources=null,this.userRing=null,this.getTokenRequestDictionary=null}}(0,a.a)(vi,"SearchInitializationSettings",null,[]);var wi,Fi=n(8444),Ii=n(7146),Ei=n(1207),Mi=n(3946);class ki{constructor(){this.documentTitle=null,this.saveStatus=null,this.isVersionHistoryEnabled=!1,this.breadcrumbBrandName=null,this.breadcrumbBrandUrl=null,this.breadcrumbFolderName=null,this.breadcrumbFolderUrl=null,this.hideDocumentTitleInput=!1,this.showFolderAndFileName=!1,this.documentExtension=null,this.onGetSuggestedTitle=null,this.onFirstRender=null,this.getCalloutAppProps=null,this.isShared=!1,this.maxFileNameLength=void 0}}(0,a.a)(ki,"DocumentTitleAppProps",null,[]);class Pi{constructor(){this.breadcrumbBrandName=null,this.breadcrumbBrandUrl=null,this.breadcrumbFolderName=null,this.breadcrumbFolderUrl=null,this.documentExtension=null,this.fileName=null,this.showFolderAndFileName=!1,this.hideDocumentTitleInput=!1,this.isVersionHistoryEnabled=!1,this.isMoveEnabled=!1,this.onMove=null,this.message=null,this.renameDisableReason=null,this.openBreadcrumbsInNewTab=!1,this.maxFileNameLength=void 0}}(0,a.a)(Pi,"DocumentTitleCalloutAppProps",null,[]);class Di{constructor(){this.appName=null,this.userDisplayName=null,this.emailAddress=null,this.userID=null,this.culture=null,this.language=null,this.isConsumer=!1,this.showAppLauncher=!1,this.showMeControl=!1,this.appIconForTTVRControl=!1,this.settingIconForTTVRControl=!1,this.notificationIconForTTVRControl=!1,this.placeHolderMeIconForTTVRControl=!1,this.sensitivityIconForTTVRControl=!1,this.saveIconForTTVRControl=!1,this.showDiscoverPremiumButton=!1,this.hideUserName=!1,this.defaultDocumentTitleToLeft=!1,this.assetsContainerOverride=null,this.controls=null,this.documentTitleAppProps=null,this.showChatControl=!1,this.showSearchControl=!1,this.enableSearchControl=!1,this.showGoPremiumControl=!1,this.signInLink=null,this.signOutLink=null,this.getTokenRequestDictionary=null,this.onFlexPaneOpen=null,this.onFlexPaneClose=null,this.enableTheming=!1,this.userRing=null,this.testTraffic=!1,this.loadTellMeResources=null,this.onFirstRender=null,this.onFullyLoaded=null,this.onLoadFailed=null,this.enableVanillaSearchBox=!1,this.showWorkflowButton=!1,this.showRibbonToggle=!1,this.showDocumentTitleControl=!1,this.shellAuthProviderConfigPromise=null,this.enableUpdatedRUMReporting=!1,this.showTryMicrosoft365Button=!1,this.appBrandUrl=null,this.homeIconName=null,this.enableSubComponentsNonReportingTTVR=!1}}(0,a.a)(Di,"HeaderAppProps",null,[]);class Ri{constructor(){this.ribbonToggleId=null,this.workflowButton=null}}(0,a.a)(Ri,"HeaderControls",null,[]);class xi{constructor(){this.label=null,this.command=null}}(0,a.a)(xi,"WorkflowButtonAppProps",null,[]),function(e){e[e.none=0]="none",e[e.readOnly=1]="readOnly",e[e.insufficientPermission=2]="insufficientPermission",e[e.incompatibleEditorsPresent=3]="incompatibleEditorsPresent",e[e.editorsPresent=4]="editorsPresent",e[e.notSupported=5]="notSupported"}(wi||(wi={})),(0,a.b)("RenameDisableReason",wi);var Li=n(2409);class Ui{}Ui.Enabled={buttonId:"overrideSettingButtonId",badgeIcon:"",tooltip:"Sideloading is active so javascript is coming from an unofficial source.",iconColor:"white",backgroundColor:"green"},Ui.Disabled={buttonId:"overrideSettingButtonId",badgeIcon:"",tooltip:"Sideloading is not active.",iconColor:"white",backgroundColor:"red"},(0,a.a)(Ui,"SideLoadingHeaderConstants",null,[]);var Oi=n(3647);class Bi{getReactCommand(e){const t=(0,D.j)(si).getCommandById(e);return t&&t.length>0?t[0].externalUxCommand:(i.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",e)),null)}getControls(){return Object.assign(new Ri,{workflowButton:this.getWorkflowButtonAppProps()})}getRenameDisableMessage(e){switch(e){case 1:return(0,_.a)("CalloutRenameReadOnlyError");case 2:return(0,_.a)("CalloutRenamePermissionError");case 3:case 4:return(0,_.a)("CalloutRenameCoauthError");case 5:return null;default:return(0,_.a)("CalloutRenameGenericError")}}shouldShowVersionHistory(){return!!s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isSharedHeaderVersionHistoryEnabled}shouldShowPageNameAsDocumentTitle(){return s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.ShowOneNotePageNameInDocumentTitle",!1)&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SupportsPolicies")&&s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.isCLPEnabled",!1)&&!s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser")&&s.AFrameworkApplication.appSettingsManager.getIntAppSetting("ClpRolloutStage",0)>=3}shouldEnableTheming(){return!!s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isSharedHeaderThemingEnabled}shouldShowChatControl(){const e=!li.b()&&!s.AFrameworkApplication.hideHeader&&!s.AFrameworkApplication.hideChatInHeaderByUiHost&&(s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SkypeWebControlIsEnabled")||s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TeamsChatIsEnabled"));return i.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",e),e}registerCommandHandlers(e=!1){appChrome.getHeaderApi().then((t=>{const n=(0,D.a)(oi);t.setHeaderCommandHandler("OnFirstRender",(e=>{this.onFirstRender()})),t.setHeaderCommandHandler("OnFullyLoaded",(e=>{this.onFullyLoaded()})),t.setHeaderCommandHandler("OnFlexPaneOpen",(e=>{n.onFlexPaneOpen(e)})),t.setHeaderCommandHandler("OnFlexPaneClose",(e=>{n.onFlexPaneClose(e)})),t.setHeaderCommandHandler("SetCookie",(e=>{const t=e;return Li.a.set(t.cookieName,t.value)})),t.setHeaderCommandHandler("GetCookie",(e=>this.getCookie(e))),t.setHeaderCommandHandler("QueryWorkflowButtonSettings",this.getWorkflowButtonAppProps),e||(t.setHeaderCommandHandler("QueryDocumentTitleAppProps",this.getDocumentTitleAppProps),t.setHeaderCommandHandler("OnDocumentTitleReducerReady",(()=>(this.onDocumentTitleReducersReady(),null)))),Ti.isSearchUxEnabled()&&t.setHeaderCommandHandler("QuerySearchInitializationSettings",(0,o.a)(this,this.getSearchInitializationSettings,"getSearchInitializationSettings"))}))}onDocumentTitleReducersReady(){(0,D.h)(ni).execute((e=>{e.updateSaveStatusDisplay(!1,s.AFrameworkApplication.theActionManager.mode)}))}getCookie(e){let t=Li.a.get(e);return null!=t&&t.length>0&&(t=decodeURIComponent(t)),t}getSuiteUxShellPath(){const e="suiteux-shell";if(Mi.a.isEnabled)return Mi.a.getPath(e,!1);if(Ii.a.instance.isShippingFrom1JSEnabled)return Fi.a.instance.getVersionedResourceUrl(e,null,null);return this._staticContentHostPath+s.AFrameworkApplication.scriptFolderPath+e}getProps(e=!1,t,n){const a=(e=>{try{const e=mi.a.getCultureInfo(s.AFrameworkApplication.lcid);if(e)return Object.assign(new hi,{cultureName:e.name,languageName:e.languageName})}catch(e){i.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+s.AFrameworkApplication.lcid.toString())}return Object.assign(new hi,{cultureName:"en-us",languageName:"en"})})(s.AFrameworkApplication.appSettingsManager),r=(0,D.a)(oi),l=Object.assign(new Di,{appName:(0,_.a)("AppNameShort"),culture:a.cultureName,language:a.languageName,isConsumer:!s.AFrameworkApplication.useO365ShellService,showAppLauncher:li.f(),showMeControl:li.e(),hideUserName:s.AFrameworkApplication.hideMeInHeaderByUiHost,defaultDocumentTitleToLeft:s.AFrameworkApplication.defaultDocumentTitleToLeftByUiHost,assetsContainerOverride:this.getSuiteUxShellPath(),controls:this.getControls(),documentTitleAppProps:e?null:this.getDocumentTitleAppProps(t,n),showDocumentTitleControl:!e,showWorkflowButton:!!this.getWorkflowButtonAppProps(),showChatControl:this.shouldShowChatControl(),showGoPremiumControl:li.h(),showDiscoverPremiumButton:li.d(),showTryMicrosoft365Button:li.g(),enableSearchControl:Ti.isSearchEnabled(),onFlexPaneOpen:(0,o.a)(r,r.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:(0,o.a)(r,r.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.shouldEnableTheming(),testTraffic:s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SharedHeaderTestTrafficIsEnabled"),onFirstRender:this.onFirstRender,onFullyLoaded:this.onFullyLoaded,enableUpdatedRUMReporting:s.AFrameworkApplication.shouldEnableUpdatedRUMReporting(),appBrandUrl:s.AFrameworkApplication.homeButtonUrl});if(!s.AFrameworkApplication.userNameUnknown||s.AFrameworkApplication.signoutUrl?(l.userDisplayName=s.AFrameworkApplication.userName,l.emailAddress=s.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName"),l.userID=s.AFrameworkApplication.appSettingsManager.getStringAppSetting("Puid")||"",l.signOutLink=s.AFrameworkApplication.signoutUrl):s.AFrameworkApplication.signInUrl&&(l.signInLink=s.AFrameworkApplication.signInUrl),Ti.isSearchUxEnabled()){const e=this.getSearchInitializationSettings();l.loadTellMeResources=e.loadTellMeResources,l.getTokenRequestDictionary=e.getTokenRequestDictionary,l.enableVanillaSearchBox=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("VanillaSearchUxInHeaderIsEnabled"),l.userRing=e.userRing}if(gi.isCustomAccountSwitchingConfigEnabled()){const e=new gi;l.shellAuthProviderConfigPromise=(0,o.a)(e,e.getAccountSwitchingConfig,"getAccountSwitchingConfig")}return this.addBadgeIfSideLoadingIsEnabled(),this.registerCommandHandlers(e),et.a.logUniqueUsage("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232"),l}addBadgeIfSideLoadingIsEnabled(){s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SideLoadingIsEnabled")?this.addBadgeForHeaderButton(Ui.Enabled):this.addBadgeForHeaderButton(Ui.Disabled)}addBadgeForHeaderButton(e){F.a.get_instance().executeWhen(16,(()=>{appChrome.getHeaderApi().then((t=>(t.setCustomHeaderButtonBadgeCharacter(e.buttonId,e.badgeIcon),t.setCustomHeaderButtonBadgeLabel(e.buttonId,e.tooltip),t.setCustomHeaderButtonBadgeColors(e.buttonId,{badgeColor:e.backgroundColor,badgeHoverColor:e.backgroundColor,badgeFontColor:e.iconColor,badgeFontHoverColor:e.iconColor}),null)))}))}getSearchInitializationSettings(){if(!this.searchInitializationSettings){const e=new Ti;let t=s.AFrameworkApplication.appSettingsManager.getStringAppSetting("Microsoft365Ring");t&&t.length||(t="generalAudience"),this.searchInitializationSettings=Object.assign(new vi,{loadTellMeResources:e.loadTellMeStrings(),getTokenRequestDictionary:(0,o.a)(e,e.getTokenRequestDict,"getTokenRequestDict"),userRing:t})}return this.searchInitializationSettings}onBeforeContinue(e=!1){this.onFirstRender(),this.registerCommandHandlers(e)}constructor(e=""){this.workflowButtonAppProps=null,this.documentTitleAppProps=null,this.searchInitializationSettings=null,this.getWorkflowButtonAppProps=()=>{if(!this.workflowButtonAppProps){const e=li.a();if(e){const t=this.getReactCommand(e.command);t&&(this.workflowButtonAppProps=Object.assign(new xi,{command:t,label:e.label}))}}return this.workflowButtonAppProps},this.onDocumentTitleFirstRender=()=>{F.a.get_instance().setAppInitializationStatus(17)},this.onMove=()=>{const e={};e.MoveButtonClickedTime=new Date,s.AFrameworkApplication.theActionManager.processActionWithData(m.a.moveToFolder,2,e)},this.getDocumentFlyoutProperties=()=>{let e=null,t=null;const n=(0,D.j)(ri),a=appChrome?.api?.getSharedUxSettings(),o=a&&a.hasOwnProperty("commonSettings")?a.commonSettings():void 0,r=!(!o||!o.hasOwnProperty("openBreadcrumbsInNewTab"))&&o.openBreadcrumbsInNewTab();if(n){const a=n.getRenameDisableReason();0!==a&&(e=this.getRenameDisableMessage(a),t=wi[a])}else i.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new Pi,{breadcrumbBrandName:s.AFrameworkApplication.docPropertiesProvider.breadcrumbBrandName,breadcrumbBrandUrl:s.AFrameworkApplication.docPropertiesProvider.breadcrumbBrandUrl,breadcrumbFolderName:s.AFrameworkApplication.docPropertiesProvider.breadcrumbFolderName,breadcrumbFolderUrl:s.AFrameworkApplication.docPropertiesProvider.breadcrumbFolderUrl,hideDocumentTitleInput:s.AFrameworkApplication.activeFrame.applicationInstance.hideFileNameInDTT,maxFileNameLength:s.AFrameworkApplication.docPropertiesProvider.maxFileNameLength,isVersionHistoryEnabled:this.shouldShowVersionHistory(),showFolderAndFileName:s.AFrameworkApplication.activeFrame.applicationInstance.showFolderAndFileNameInDTT,documentExtension:ce.a.getFileExtension(s.AFrameworkApplication.fileName),isMoveEnabled:32===s.AFrameworkApplication.theActionManager.processAction(m.a.moveToFolder,1),onMove:this.onMove,message:e,renameDisableReason:t,openBreadcrumbsInNewTab:r||s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OpenLinksInNewWindow")})},this.getDocumentTitleAppProps=(e,t)=>{if(!this.documentTitleAppProps){const n=s.AFrameworkApplication.docPropertiesProvider.breadcrumbDocName;let a="";a=this.shouldShowPageNameAsDocumentTitle()&&e?e():s.AFrameworkApplication.documentIsFolder?n:ce.a.getFileNameWithoutExtension(n),this.documentTitleAppProps=Object.assign(new ki,{documentTitle:a,onFirstRender:this.onDocumentTitleFirstRender,getCalloutAppProps:()=>({...this.getDocumentFlyoutProperties(),fileName:t&&t()}),isShared:!1})}return this.documentTitleAppProps},this.continueShellServiceDataAsync=e=>{appChrome.getHeaderApi().then((t=>(t.setNavBarData(e.result),null))),i.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")},this.onFirstRender=()=>{if(s.AFrameworkApplication.hideHeader&&s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8451051_NoOpOnHideHeader"))return;(0,D.h)(Oi.a).execute((e=>{e.shellServiceDataAsync.continueWith(this.continueShellServiceDataAsync,3)})),F.a.get_instance().setAppInitializationStatus(15)},this.onFullyLoaded=()=>{F.a.get_instance().setAppInitializationStatus(16)},this._staticContentHostPath=""!==e?e:Ei.a.staticContentHost}}(0,a.a)(Bi,"ReactSharedHeaderPropsHelper",null,[194]);var Ni=n(1244),Wi=n(1591),Hi=n(4951),Vi=n(7109);class Gi{}Gi.getAccessibilityHelpButtonId="jbtnAccessibilityHelp",Gi.getAccessiblePdfLinkButtonId="jbtnAccessibility",Gi.toggleCommentPaneButtonId="btnOpenCommentPane",Gi.toggleSearchPaneButtonId="btnOpenSearchPane",Gi.toggleWordViewerModeButtonId="jbtnToggleViewMode",(0,a.a)(Gi,"AccessibilityModeIds",null,[]);class Qi{}Qi.toolbarDownloadWithWordButtonId="btnDownloadWithWord",Qi.toolbarOverflowDownloadWithWordButtonId="overflowbtnDownloadWithWord",Qi.toolbarDownloadPdfButtonId="btnDownloadPdf",Qi.toolbarDownloadWordDocAsPdfButtonId="jbtnDownloadAsPdf",Qi.toolbarDownloadATranslatedCopy="jbtnDownloadATranslatedCopy",(0,a.a)(Qi,"DownloadButtonIds",null,[]);class qi{}qi.yammerButtonId="btnToggleYammerPanel",qi.fileVersionButtonId="jbtnFileVersion",qi.jewelFileSharingButtonId="jbtnFileSharing",qi.toolbarFileSharingButtonId="btnFileSharing",qi.privacyButtonId="jbtnPrivacy",qi.reportAbuseButtonId="jbtnReportAbuse",qi.termsOfUseButtonId="jbtnTermsOfUse",qi.giveFeedbackButtonId="jbtnGiveFeedback",qi.closeButtonId="btnjClose",qi.translateButtonId="jbtnTranslateDocument",qi.trustCenterButtonId="jbtnTrustCenter",(0,a.a)(qi,"FeatureButtonIds",null,[]);class Ki{}Ki.toolbarConvertToPdfPrintButtonId="btnPrintToPdf",Ki.toolbarDirectPrintButtonId="btnDirectPrint",Ki.toolbarPrintPdfButtonId="btnPrintPdfFile",Ki.toolbarDirectPrintPdfButtonId="btnDirectPrintPdfMode",Ki.jewelPrintSubMenuId="faPrint",(0,a.a)(Ki,"PrintButtonIds",null,[]);const zi=(e,t)=>{if(s.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.ForceViewOnlyFromHost")&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ForceViewOnlyFromHost")&&(t=!1),s.AFrameworkApplication.trimOICButtons||s.AFrameworkApplication.limitedEdit)e.flyoutWordViewerEdit=!0,e.flyoutWordViewerEditNew=!0,e.flyoutWordViewerOpen=!0,e.btnOpenInClient=!0,!s.AFrameworkApplication.limitedEdit&&t&&n(6921).App.interactiveViewIsEnabled||(e.btnInteractiveViewOnWeb=!0);else if(t){if(n(6921).App.canEdit||n(6921).App.isReviewer){const t=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsOwaUnifiedFlightEnabled"),n=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsUIEmbedMode");s.AFrameworkApplication.disableEditIfAndroid||t&&n?(e.flyoutWordViewerEdit=!0,e.flyoutWordViewerEditNew=!0):e.btnOpenInClient=!0,e.flyoutWordViewerOpen=!0}else n(6921).App.interactiveViewIsEnabled?(e.flyoutWordViewerEdit=!0,e.flyoutWordViewerEditNew=!0,e.btnOpenInClient=!0):(e.flyoutWordViewerEdit=!0,e.flyoutWordViewerEditNew=!0,e.flyoutWordViewerOpen=!0);e.btnInteractiveViewOnWeb=!0,e.btnConvertToEditOnWeb=!0,e.btnCopyAndEdit=!0,e.btnEditOnWeb=!0}else e.flyoutWordViewerEdit=!0,e.flyoutWordViewerEditNew=!0,e.flyoutWordViewerOpen=!0,e.btnInteractiveViewOnWeb=!0,s.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.ForceViewOnlyFromHost")&&(e.btnEditOnWeb=!0)},ji=(e,t,a,i)=>{!s.AFrameworkApplication.copyAndEditUrl||s.AFrameworkApplication.protectFile||s.AFrameworkApplication.protectedFile||i?t&&(n(6921).App.canEdit||n(6921).App.isReviewer)?a?(e.btnEditOnWeb=!0,e.btnCopyAndEdit=!0,e.btnPdfCopyAndEdit=!0,e.btnFlyoutEditOnWeb=!0,e.btnFlyoutCopyAndEdit=!0,e.btnSaveToCloudStorage=!0):(e.btnConvertToEditOnWeb=!0,e.btnPdfConvertAndEdit=!0,e.btnCopyAndEdit=!0,e.btnPdfCopyAndEdit=!0,e.btnFlyoutConvertToEditOnWeb=!0,e.btnFlyoutCopyAndEdit=!0,e.btnSaveToCloudStorage=!0):(e.btnConvertToEditOnWeb=!0,e.btnPdfConvertAndEdit=!0,e.btnCopyAndEdit=!0,e.btnPdfCopyAndEdit=!0,e.btnEditOnWeb=!0,e.sep1=!0):(e.btnConvertToEditOnWeb=!0,e.btnPdfConvertAndEdit=!0,e.btnFlyoutConvertToEditOnWeb=!0,e.btnEditOnWeb=!0,e.btnFlyoutEditOnWeb=!0,s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")&&"HMWeb"===s.AFrameworkApplication.appSettingsManager.appSettings.FileSource||(e.btnSaveToCloudStorage=!0))};let Zi,Xi,Ji,Yi;const $i="toolbar";class eo{get reactRibbonRoot(){return this._reactRoot}initReactCommandingEnvironment(e=null){this._appChromePromise=Wi.a.getAppChrome(!1),this._appChromePromise.then((()=>{appChrome.setAppSettings(s.AFrameworkApplication.appSettingsManager.appSettings),nt.i(),appChrome.api.setWebpackPublicPath(s.AFrameworkApplication.staticContentScriptNameBase),F.a.get_instance().setAppInitializationStatus(7);const e=k.a.instance.resolve("Common.IDynamicScriptLoaderProvider").getScriptLoader();appChrome.setScriptLoader((t=>e.loadScript(t))),appChrome.registerInitialAppSprites(),this._reactRoot=new jn(Zn.a.instance,k.a.instance.resolve("Common.IExternalUICommandDefinitionMapping"),this);const t=document.createElement("div");document.body.appendChild(t);const n=new za(this._reactRoot,this._reactRoot.reactRibbonRootPoller,k.a.instance.resolve("WordViewer.WordViewerReactCommandDefinitionMapping"),s.AFrameworkApplication.activeFrame.theFocusManager,t,null,null,s.AFrameworkApplication.theActionManager,null);appChrome.api.bindCommandHandler(((e,t)=>{n.executeCommand(e,t)}));const a=new M.a(3,1,0,(e=>{this.initializeLazyAppSprite()}));ta.TaskManager.instance.addTask(a)})),(Vi.a.isReactStatusBarEnabled||Je.isReactToolbarEnabled)&&q.a.setAppChromeProviderDelegate((()=>this._appChromePromise))}initializeLazyAppSprite(){appChrome.getLazyAppSpriteInitActions().then((e=>(appChrome.api.dispatch(e),null)))}initializeRibbonToolbar(e,t,n){if(Je.isReactToolbarEnabled)window.setTimeout((()=>{F.a.get_instance().executeWhen(7,(()=>{this._reactToolbar=new Je(this._theViewerChrome.toolbarContainer,this.getToolbarEnabledIds(t),this._reactRoot),this._reactToolbar.poll()}))}),0);else{const a=new ja.a;a.clientID=$i,a.staticUiTouchMode=this._hostingAppFrame.isStaticUiTouchMode,a.supportsEmphasizedControls=!0,a.trimmedIds=this.getLegacyToolbarTrimmedIds(t);const i=new Za.a(a,this._theViewerChrome.toolbarContainer,this,e);i.dataSource=new Xa.a("WordViewerToolbarData",n),i.buildToolbar(),this._theToolbar=i.toolbar,this._theToolbar.rootUser=this,this._theToolbar.refresh(),this._theViewerChrome.scale(),this.poll()}}getToolbarEnabledIds(e){const t=s.AFrameworkApplication.protectFile||s.AFrameworkApplication.protectedFile,a=t||s.AFrameworkApplication.isEmbedded||!s.AFrameworkApplication.hostEmbeddedViewUrl&&!s.AFrameworkApplication.fileEmbedCommandUrl&&!s.AFrameworkApplication.useFileEmbedCommandPostMessage,i=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerLearningToolsIsEnabled"),o=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEduUser"),r=this._hostingAppFrame.wordViewerApp.isPdfMode,l=!!this._hostingAppFrame.wordViewerApp.translationLanguage,c=!!this._hostingAppFrame.wordViewerApp.fromReadingView,d=s.AFrameworkApplication.disableEditIfAndroid,u=this._hostingAppFrame.wordViewerApp.supportsEditing,p=s.AFrameworkApplication.trimDownloadACopy,g=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordDownloadAsPdfIsEnabled"),h=s.AFrameworkApplication.downloadCopyOnOpenInClient,m=this._hostingAppFrame.wordViewerApp.userMayEnterAccessiblePdfMode,_=this._hostingAppFrame.wordViewerApp.isAccessiblePdfMode,f=1036===s.AFrameworkApplication.lcid,C=1040===s.AFrameworkApplication.lcid,y={jbtnToggleViewMode:m,btnLaunchImmersiveViewEdu:i&&o,flyoutWordViewerEdit:!r&&!d,flyoutWordViewerEditNew:!r&&!d,btnEditOnWebInRibbon:!r&&!d,btnPdfConvertAndEdit:r&&this._hostingAppFrame.wordViewerApp.userCanWriteRelative&&!d,btnPdfCopyAndEdit:r&&this._hostingAppFrame.wordViewerApp.userCanWriteRelative&&!d,btnOpenInClient:!r&&!l,btnInteractiveViewOnWeb:!r&&!d,btnEditOnWeb:!r&&!d,btnConvertToEditOnWeb:!r&&!d,btnCopyAndEdit:!r,btnSaveAndEdit:this._hostingAppFrame.wordViewerApp.userCanSaveAndEditTranslatedDocument,jbtnTranslateDocumentBack:l,btnDownloadWithWord:!p&&!r&&!l&&h,btnSaveToCloudStorage:!l&&!v.a.isMobile&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled"),PrintUnified:this._hostingAppFrame.wordViewerApp.showPrint&&!t,btnjClose:!0,HostConversation:!0,HostOpenInBrowser:!0,btnFileSharing:!l&&s.AFrameworkApplication.fileShareEnabled,btnFlyoutEditOnWeb:!0,btnFlyoutConvertToEditOnWeb:!0,btnFlyoutCopyAndEdit:!0,btnEditInClient:!0,MoreViewerOptionsFlyoutAnchor:!0,btnOpenCommentPane:!(r||Ke.hideCommentsButtonFromRibbon||m&&_),btnOpenSearchPane:!m||!_,btnLaunchImmersiveViewNonEdu:i&&!o,jbtnTranslateDocument:!(t||l||r||!n(6921).App.instance.translationLanguages||!n(6921).App.instance.translationLanguages.length),jbtnFileVersion:!l&&(!!s.AFrameworkApplication.fileVersionUrl||s.AFrameworkApplication.useFileVersionPostMessage),overflowbtnDownloadWithWord:!(p||r||l||h),jbtnDownloadATranslatedCopy:!p&&l,btnDownloadPdf:!p&&r&&!l,jbtnDownloadAsPdf:!p&&!r&&g,jbtnFileEmbed:!l&&!a,jbtnHelp:!0,jbtnAccessibilityHelp:m&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled"),jbtnGiveFeedback:s.AFrameworkApplication.showFeedbackButton,btnjTryOffice:!!e.officeTrialExperience&&e.officeTrialExperience.offerOfficeTrialInFileMenu,btnjTryMacOffice:!!e.macOfficeOffer&&e.macOfficeOffer.shouldOfferMacOfficeTrialInFileMenu,jbtnTermsOfUse:!!s.AFrameworkApplication.termsUrl,jbtnPrivacy:!!s.AFrameworkApplication.privacyUrl,jbtnAccessibility:!r&&!t&&!m,jbtnAccessibilityPdf:r&&!t,btnSyncToPresenter:this._hostingAppFrame.wordViewerApp.isBroadcastMode,btnOpenSharedNotes:this._hostingAppFrame.wordViewerApp.isBroadcastMode,jbtnTrustCenter:s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled")&&!s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HidePrivacyDialogueInViewerForNoHpa",!1),jbtnSwitchToUnifiedReadMode:c,jbtnFrenchAccessibilityStatement:f,btnViewOnWeb:!0,jbtnItalianAccessibilityStatement:C},A={};ji(A,u,this._hostingAppFrame.editNeedsConversion,l),zi(A,u),Ya.trimAllHostControls(A),A.btnjClose=!S.includeCloseButton(),Ya.updateTrimmingOfHostProvidedUIControls(eo.hostControlsToLegacyControlsMap,A);for(const e of Object.keys(y))(!y[e]||A[e]&&y[e])&&delete y[e];return y}getLegacyToolbarTrimmedIds(e){const t={},a=s.AFrameworkApplication.protectFile||s.AFrameworkApplication.protectedFile;return Ya.trimAllHostControls(t),((e,t,n,a,i,o)=>{e[Qi.toolbarDownloadWithWordButtonId]=t||n||o||!i,e[Qi.toolbarDownloadPdfButtonId]=t||!n||o,e[Qi.toolbarOverflowDownloadWithWordButtonId]=t||n||o||i,e[Qi.toolbarDownloadWordDocAsPdfButtonId]=t||n||!a,e[Qi.toolbarDownloadATranslatedCopy]=t||!o})(t,s.AFrameworkApplication.trimDownloadACopy,this._hostingAppFrame.wordViewerApp.isPdfMode,s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordDownloadAsPdfIsEnabled"),s.AFrameworkApplication.downloadCopyOnOpenInClient,!!this._hostingAppFrame.wordViewerApp.translationLanguage),this._hostingAppFrame.wordViewerApp.isPdfMode?(t.jbtnAccessibility=!0,t.flyoutWordViewerEdit=!0,t.flyoutWordViewerEditNew=!0,t.btnEditOnWebInRibbon=!0,t.flyoutWordViewerOpen=!0,t.btnInteractiveViewOnWeb=!0,t.btnOpenInClient=!0,t.btnOpenCommentPane=!0,t.btnEditOnWeb=!0,t.btnConvertToEditOnWeb=!0,t.btnCopyAndEdit=!0,t.sep1=!0):(t.btnPdfConvertAndEdit=!0,t.btnPdfCopyAndEdit=!0,t.jbtnAccessibilityPdf=!0),((e,t,n,a)=>{t?(e[Gi.getAccessiblePdfLinkButtonId]=!0,n&&(e[Gi.toggleCommentPaneButtonId]=!0,e[Gi.toggleSearchPaneButtonId]=!0)):e[Gi.toggleWordViewerModeButtonId]=!0,a&&t||(e[Gi.getAccessibilityHelpButtonId]=!0)})(t,this._hostingAppFrame.wordViewerApp.userMayEnterAccessiblePdfMode,this._hostingAppFrame.wordViewerApp.isAccessiblePdfMode,s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled")),((e,t,n,a)=>{e[Ki.toolbarConvertToPdfPrintButtonId]=!a||n||t,e[Ki.toolbarDirectPrintButtonId]=!a||n||!t,e[Ki.toolbarPrintPdfButtonId]=!a||!n||t,e[Ki.toolbarDirectPrintPdfButtonId]=!a||!n||!t})(t,s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DirectPrintIsEnabled"),this._hostingAppFrame.wordViewerApp.isPdfMode,this._hostingAppFrame.wordViewerApp.showPrint),this._hostingAppFrame.wordViewerApp.showPrint||(t.PrintUnified=!0),(e=>{e[qi.yammerButtonId]=!s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("YammerIsEnabled"),e[qi.fileVersionButtonId]=!s.AFrameworkApplication.fileVersionUrl&&!s.AFrameworkApplication.useFileVersionPostMessage,e[qi.jewelFileSharingButtonId]=!s.AFrameworkApplication.fileShareEnabled,e[qi.toolbarFileSharingButtonId]=!s.AFrameworkApplication.fileShareEnabled,e[qi.privacyButtonId]=!s.AFrameworkApplication.privacyUrl,e[qi.reportAbuseButtonId]=!s.AFrameworkApplication.reportAbuseUrl,e[qi.termsOfUseButtonId]=!s.AFrameworkApplication.termsUrl,e[qi.giveFeedbackButtonId]=!s.AFrameworkApplication.showFeedbackButton,e[qi.closeButtonId]=!S.includeCloseButton(),e[qi.trustCenterButtonId]=!s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled"),e[qi.translateButtonId]=n(6921).App.instance.isPdfMode||!n(6921).App.instance.translationLanguages||!n(6921).App.instance.translationLanguages.length})(t),ji(t,this._hostingAppFrame.wordViewerApp.supportsEditing,this._hostingAppFrame.editNeedsConversion,!!this._hostingAppFrame.wordViewerApp.translationLanguage),zi(t,this._hostingAppFrame.wordViewerApp.supportsEditing),v.a.isMobile&&(t.btnSaveToCloudStorage=!0),a&&(t.PrintUnified=!0,t.btnPrintToPdf=!0,t.jbtnPrintPdfFile=!0,t.btnPrintPdfFile=!0,t.jbtnAccessibility=!0,t.jbtnAccessibilityPdf=!0,t.jbtnTranslateDocument=!0),(a||s.AFrameworkApplication.isEmbedded||!s.AFrameworkApplication.hostEmbeddedViewUrl&&!s.AFrameworkApplication.fileEmbedCommandUrl&&!s.AFrameworkApplication.useFileEmbedCommandPostMessage)&&(t.jbtnFileEmbed=!0),e.officeTrialExperience&&e.officeTrialExperience.offerOfficeTrialInFileMenu||(t.msJewelTryOffice=!0,t.btnjTryOffice=!0,i.ULS.shipAssertTag(5838167,301,!!e.officeTrialExperience)),e.macOfficeOffer&&e.macOfficeOffer.shouldOfferMacOfficeTrialInFileMenu||(t.msJewelTryMacOffice=!0,t.btnjTryMacOffice=!0,i.ULS.shipAssertTag(5838168,301,!!e.macOfficeOffer)),this._hostingAppFrame.wordViewerApp.translationLanguage?(t.jbtnFileProperties=!0,t.jbtnFileVersion=!0,t.btnOpenInClient=!0,t.btnFileSharing=!0,t.jbtnBroadcast=!0,t.jbtnFileEmbed=!0,t.jbtnTranslateDocument=!0,t.btnSaveToCloudStorage=!0):t.jbtnTranslateDocumentBack=!0,this._hostingAppFrame.wordViewerApp.userCanWriteRelative||(t.btnPdfConvertAndEdit=!0,t.btnPdfCopyAndEdit=!0),Ke.hideCommentsButtonFromRibbon&&(t.btnOpenCommentPane=!0),s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")||(t.btnSaveToCloudStorage=!0),this._hostingAppFrame.wordViewerApp.isBroadcastMode?(t.jbtnTranslateDocument=!0,t.jbtnTranslateDocumentBack=!0,t.jbtnBroadcast=!0,t.btnFileSharing=!0,t.btnOpenInClient=!0,t.btnDownloadWithWord=!0,t.btnDownloadPdf=!0,t.sep1=!0,t.msJewelTryMacOffice=!0,t.btnjTryMacOffice=!0,t.msJewelTryOffice=!0,t.btnjTryOffice=!0,t.btnjTryO14=!0,t.msJewelProperties=!0,t.jbtnFileEmbed=!0,t.btnCopyAndEdit=!0,t.btnConvertToEditOnWeb=!0,t.btnPdfConvertAndEdit=!0,t.btnPdfCopyAndEdit=!0,t.btnEditOnWeb=!0,t.btnOpenSearchPane=!0,t.jbtnFileVersion=!0,t.btnjClose=!0,t.jbtnAccessibility=!0,t.jbtnAccessibilityPdf=!0,t.jbtnReportAbuse=!0,t.btnSaveToCloudStorage=!0):(t.btnSyncToPresenter=!0,t.btnOpenSharedNotes=!0),s.AFrameworkApplication.disableEditIfAndroid&&(this._hostingAppFrame.wordViewerApp.isPdfMode?(t.btnPdfConvertAndEdit=!0,t.btnPdfCopyAndEdit=!0):(t.btnEditOnWeb=!0,t.flyoutWordViewerEdit=!0,t.flyoutWordViewerEditNew=!0,t.btnEditOnWebInRibbon=!0,t.flyoutWordViewerOpen=!0,t.btnInteractiveViewOnWeb=!0,t.btnFlyoutEditOnWeb=!0,t.btnFlyoutConvertToEditOnWeb=!0,t.btnFlyoutCopyAndEdit=!0,t.btnConvertToEditOnWeb=!0)),s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerLearningToolsIsEnabled")?s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEduUser")?t.btnLaunchImmersiveViewNonEdu=!0:t.btnLaunchImmersiveViewEdu=!0:(t.btnLaunchImmersiveViewEdu=!0,t.btnLaunchImmersiveViewNonEdu=!0),s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled")||(t.jbtnTrustCenter=!0),t.btnSaveAndEdit=!this._hostingAppFrame.wordViewerApp.userCanSaveAndEditTranslatedDocument,Ya.updateTrimmingOfHostProvidedUIControls(eo.hostControlsToLegacyControlsMap,t),t}createStandaloneRoot(){const e=new $a.a;e.ImageUpArrow=e.ImageDownArrow=e.ImageSideArrow=s.AFrameworkApplication.imageClusterPath,e.ImageUpArrowClass=O.c("RibbonUpArrow_5x3x32"),e.ImageDownArrowClass=O.c("SplitButtonArrow_5x3x32"),e.ImageSideArrowClass=O.c("SubmenuFlyoutArrow_13x13x32"),e.TextDirection=s.AFrameworkApplication.isRtl?"rtl":"ltr",this._theStandaloneRoot=new ei.a("TheStandaloneRoot",e),this._theStandaloneRoot.rootUser=this,this._theStandaloneRoot.refresh()}dispose(){this._theToolbar&&(this._theToolbar.dispose(),this._theToolbar=null),this._theViewerChrome&&(this._theViewerChrome.dispose(),this._theViewerChrome=null),this._theStandaloneRoot&&(this._theStandaloneRoot.dispose(),this._theStandaloneRoot=null),this._topRowControls&&(Te.a.disposeTopRowControls(this._topRowControls),this._topRowControls=null)}get theToolbar(){return this._theToolbar}get theViewerChrome(){return this._theViewerChrome}poll(){this._theToolbar&&this._theToolbar.pollForStateAndUpdate(),this._theStandaloneRoot&&this._theStandaloneRoot.pollForStateAndUpdate(),this._reactToolbar&&this._reactToolbar.poll()}executeRootCommand(e,t,n,a=null,i=null){if(s.AFrameworkApplication.isShuttingDown)return!1;const o=parseInt(e);let r=null;switch(o){case m.a.close:r=Ni.b;break;case Re.a.toggleSearchPane:case Re.a.toggleCommentPane:r=new ti.a(r,n.InvocationMethod);break;default:r=t}const l=s.AFrameworkApplication.theActionManager;n&&(l.commandLocation=n.CommandLocation,l.invocationMethod=n.InvocationMethod);return 32===l.processActionWithData(o,2,r,i)}isRootCommandEnabled(e,t=null){if(s.AFrameworkApplication.isShuttingDown)return!1;if(!e)return!0;const n=parseInt(e);return 32===s.AFrameworkApplication.theActionManager.processAction(n,1)}onComponentBuilt(e,t){e.rootUser=this}constructor(e,t,a,i){this._theToolbar=null,this._theStandaloneRoot=null,this._topRowControls=null,this._appChromePromise=null,this._reactRoot=null,this._reactToolbar=null;const{AppFrame:o}=n(668),{AppFrame:r}=n(668);if(null==e)throw Error.argumentNull("hostingAppFrame");this._hostingAppFrame=e,(s.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled||Vi.a.isReactStatusBarEnabled||Je.isReactToolbarEnabled)&&this.initReactCommandingEnvironment();const l=new Te.a(Hi.a.wordViewerImageBase,WacWordviewerStrings);s.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled||(this.createStandaloneRoot(),this._topRowControls=l.createTopRowControls($i,t,null,this._theStandaloneRoot,!0)),this._theViewerChrome=new ve.a(t,$i,i,s.AFrameworkApplication.hideHeader,s.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled,Je.isReactToolbarEnabled),s.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled&&this._appChromePromise.then((()=>{const e=new Bi;appChrome.renderSharedHeader(this._theViewerChrome.peripheralContentContainer,e.getProps()).then((()=>{appChrome.getHeaderApi().then((e=>e.dismissPlaceholder()))}))})),this.initializeRibbonToolbar(i,a,l),w.a.initializeCuiScope(o.ribbonFocusId,null,this._theViewerChrome.toolbarContentContainer,!1,!0,!0,!0),w.a.initializeCuiScope(r.headerUiFocusId,null,this._theViewerChrome.peripheralContentContainer,!1,!0,!0,!0);if(s.AFrameworkApplication.appSettingsManager&&s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.IsOpenFromUrlTriggerEnabled")){s.AFrameworkApplication.appSettingsManager&&"OpenFromUrl"===s.AFrameworkApplication.appSettingsManager.getStringAppSetting("HostNameFromContext")&&et.a.logUniqueUsage("openfromurlaa;openfromurlaacf")}}}eo.hostControlsToLegacyControlsMap={close:(Yi=new Ne.a,Yi.add("btnjClose"),Yi),conversation:(Ji=new Ne.a,Ji.add("HostConversation"),Ji),ellipsisOpenInBrowser:(Xi=new Ne.a,Xi.add("HostOpenInBrowser"),Xi),share:(Zi=new Ne.a,Zi.add("jbtnFileSharing"),Zi.add("btnFileSharing"),Zi)},(0,a.a)(eo,"RibbonUser",null,[2,3,11]);var to=n(8035);var no=n(4244),ao=n(1676);class io{constructor(){const{App:e}=n(6921);if(!e.get_activeAppFrame().businessBar)return;const t=new be.a(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.TranslatedDocumentBusinessBarTitle),n(6921).App.get_activeAppFrame().wordViewerApp.userCanSaveAndEditTranslatedDocument?WacWordviewerStringsManager.get(WacWordviewerStringsEnum.TranslatedDocumentBusinessBarDescription):"",null);t.closeable=!0,t.image=3,e.get_activeAppFrame().businessBar.addEntry(t,!0)}}(0,a.a)(io,"TranslatedDocumentBusinessBar",null,[]);var oo=n(7872),ro=n(6734),so=n(4763),lo=n(8920);class co extends S{get workspace(){return this._workspace||(this._workspace=k.a.instance.resolve("WordViewer.Workspace"))}set_workspace(e){return this._workspace=e,e}get postMessenger(){return this._postMessenger||(this._postMessenger=k.a.instance.resolve("WordViewer.IWordViewerPostMessenger"))}get modeName(){return this.wordViewerApp.isBroadcastMode?"Attendee":"View"}get state(){return this._frameState}set state(e){this._frameState=e;const t={isDisabled:!!this._frameState};s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this.postMessenger.sendMessageWithRetry("StateChanged",t):this.postMessenger.sendMessage("StateChanged",t)}get ribbonPanel(){return this._ribbonPanel}get ribbonUser(){return this._theRibbonUser}get statusBarUser(){return this._theStatusBarUser}get contextMenuControl(){return this._theContextMenu}get notificationBar(){return this._notificationBar?this._notificationBar:null}get clientEditDocumentUrl(){return this._clientEditDocumentUrl}set clientEditDocumentUrl(e){this._clientEditDocumentUrl=v.a.supportsOpenInClientForAllApps?e:null}get wordEditorUrl(){return this._wordEditorUrl}set wordEditorUrl(e){this._wordEditorUrl=e}get hostViewUrl(){return this._hostViewUrl}set hostViewUrl(e){this._hostViewUrl=e}get hostEditUrl(){return this._hostEditUrl}set hostEditUrl(e){this._hostEditUrl=e}get editNeedsConversion(){return this._editNeedsConversion}set editNeedsConversion(e){this._editNeedsConversion=e}get hasStatusBar(){return!this.wordViewerApp.isCoreMode}get wordViewerApp(){return this._wordViewerApp}set_wordViewerApp(e){return this._wordViewerApp=e,e}get ribbonFocusScopeName(){return"NoOpWordViewerAppFrame"}updateFullSettings(e){const{App:t}=Be.a.AppInstance;if(this.wordViewerApp.printingEnabled){const e=document.createElement("a");e.innerText=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.AccessibilityLink),e.href="javascript:;",e.id=je.a.accessibilityLinkId,e.className=je.a.accessibilityLinkHiddenClass,this.get_element().insertBefore(e,this.get_element().firstChild)}this.clientEditDocumentUrl=e.EditDocInClientUrl,this.clientEditDocumentUrl||(s.AFrameworkApplication.isOpenInClientEnabled=!1),this.hostViewUrl=e.HostViewUrl,this.hostEditUrl=e.HostEditUrl,this.editNeedsConversion="true"===e.ConvertToEdit,t.interactiveViewIsEnabled="true"===e.InteractiveViewIsEnabled}tryInitializeToolbar(){const e=new ke(s.AFrameworkApplication.appSettingsManager,this.theActionManager,this.theFocusManager);if(e.areReady())this.initializeToolbarInternal(e,null);else{const t=Te.a.createEmptyHeaderAndToolbar(s.AFrameworkApplication.hideHeader);this._ribbonPanel.appendChild(t),this._ribbonPanel.style.height=ve.a.calculateToolbarWithTopBarHeight(s.AFrameworkApplication.hideHeader,s.AFrameworkApplication.hasExternalHeader)+"px",e.waitForReady(this.initializeToolbarInternal,t)}}updateCommandUI(e=!1){this._updateCommandUITask||(this._updateCommandUITask=new M.a(2,1,25,(e=>{this.onUpdateCommandUI()}),45),s.AFrameworkApplication.theTaskManager.addTask(this._updateCommandUITask))}onUpdateCommandUI(){const e=P.a.instance.startActivity(m.a.updateCommandUI);this._updateCommandUITask=null,this.statusBarUser&&this.statusBarUser.poll(),e.end()}restoreFocusAfterDismissingPopup(e,t){1!==t?this.setFocusOnDocument():super.restoreFocusAfterDismissingPopup(e,t)}setFocusOnDocument(){this.theFocusManager.setScope(r.a.documentFocusID)}updateOpenMenu(e){return!!this.ribbonUser&&!!this.ribbonUser.theToolbar&&this.ribbonUser.theToolbar.updateOpenMenu(e)}get isUnsupportedBrowserBusinessBar(){return!!s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)&&v.a.isUnsupportedBrowserVersion}get shouldViewIrmProtectedDocuments(){return s.AFrameworkApplication.isEmbedded&&!s.AFrameworkApplication.isUIEmbedMode}checkUnsupportedBrowserBusinessBarEntry(){if(this.businessBar&&this.isUnsupportedBrowserBusinessBar){const e=new be.a("",CommonUiStrings.UnsupportedBrowserDeadline,null);e.id=15,e.isMultiLine=!1,e.closeable=!0,E.a.isHelpAvailable()&&e.addButton(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.LearnMore),this.unsupportedBrowserHandler,""),this.businessBar.addEntry(e,!1)}}initializeAll(e){const{App:t}=Be.a.AppInstance;if(!s.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.EmbedViewSupportForIRMEnabled",!1)&&this.shouldViewIrmProtectedDocuments&&(s.AFrameworkApplication.protectFile||s.AFrameworkApplication.protectedFile))return Be.a.showErrorDialog(so.a.documentIsIRMProtected,CommonUiStrings.DefaultDialogTitle,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DocumentProtectionSettingsEmbed)),Ie.b("WordViewerPdfFailures",void 0,void 0,[{name:"FailureType",string:"DocumentIsIRMProtected"}]),void Be.a.propagateError(!0,"DocumentIsIRMProtected",so.a.documentIsIRMProtected,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DocumentProtectionSettingsEmbed));if(this.workspace.init(e),this.wordViewerApp.isSmallView||this.wordViewerApp.isAccessiblePdfMode||s.AFrameworkApplication.isNoChrome||(Ke.registerActions(),(()=>{const e=[new He.a(Re.a.showSearchPane,Qe.a.application,0),new He.a(Re.a.toggleSearchPane,Qe.a.application,0)];Ve.a.enqueueActions(e,Ge.a.create("dll1",null,(()=>n.e(2).then(n.bind(n,6694)))))})()),this.ribbonUser&&this.ribbonUser.poll(),this.statusBarUser&&this.statusBarUser.poll(),this._theContextMenu=new ze.a(this),!this.wordViewerApp.isSmallView&&!s.AFrameworkApplication.isNoChrome||this.wordViewerApp.showReadOnlyBusinessBar){if(this.set_businessBar(new Ae(this.workspace.appBaseDom,this.workspace.heightAboveAppBase)),e.insertBefore(this.businessBar.htmlElement,this.workspace.appBaseDom),!s.AFrameworkApplication.protectFile&&!s.AFrameworkApplication.protectedFile||""===this.wordViewerApp.irmPolicyTitle&&""===this.wordViewerApp.irmPolicyDescription){if(!this.wordViewerApp.showPrint&&""!==this.wordViewerApp.irmPolicyDescription){const e=new be.a("",this.wordViewerApp.irmPolicyDescription,null);e.closeable=!0,this.businessBar.addEntry(e,!0)}}else{const e=new be.a(this.wordViewerApp.irmPolicyTitle,this.wordViewerApp.irmPolicyDescription,null);e.closeable=!0,this.businessBar.addEntry(e,!0)}this.checkUnsupportedBrowserBusinessBarEntry()}this._notificationBar=ee.createInstance(e,this.workspace.appBaseDom),this.wordViewerApp.showReadOnlyBusinessBar&&new Ye(this.wordViewerApp.kindOfReadOnlyBusinessBar),this.wordViewerApp.translationLanguage&&new io,this.notifyResize();const a=this.theFocusManager.getScope(r.a.documentFocusID);a.parent=r.a.mainAppFocusId,this._disableFocus||a.addSetFocus(((e,t)=>{try{if(this.wordViewerApp.isAccessiblePdfMode){const e=document.getElementById(this.workspace.theDisplayManager?.outerElementID??"");e&&(document.body.blur(),window.self.blur(),Je.isReactToolbarEnabled&&this._theRibbonUser&&this._theRibbonUser.theViewerChrome.toolbarContainer.click(),e.focus())}else document.body.focus(),window.self.focus()}catch(e){i.ULS.shipAssertTag(4318919,321,!1)}})),this.theF6Manager.addF6(r.a.documentFocusID),t.instance.isSmallView||this._disableFocusOnBoot||this.theFocusManager.setScope(r.a.documentFocusID),this.theFocusManager.defaultScopeName=r.a.documentFocusID;this.theFocusManager.getScope(r.a.appFocusId).bindAction(T.a.hashKey(f.a.vK_Esc,0),Re.a.handleEscKeyDown),this.setOnEditCommand(),this._showCommentPaneOnBoot&&s.AFrameworkApplication.theActionManager.processAction(m.a.showCommentPane,2),this.checkDynamicWebCampaignActivities()}checkDynamicWebCampaignActivities(){try{const e=s.AFrameworkApplication.appSettingsManager.getStringAppSetting("FlightId");if(!e||-1===e.toLowerCase().indexOf("floodgateflight"))return;const t=k.a.instance.resolveFuture(te.a);if(!t)return void i.ULS.sendTraceTag(592537824,301,10,"ISystemInitiatedFeedback was null");t.execute((e=>{e&&e.logActivity("DynamicWebCampaignFloodgateFlightActivity",null)}))}catch(e){i.ULS.sendTraceTag(592537823,301,10,"Error checking web campaign activity",e?e.toString():null)}}setOnEditCommand(){const{App:e}=Be.a.AppInstance;s.AFrameworkApplication.copyAndEditUrl?this._onEditCommand=m.a.copyAndEdit:e.instance.supportsEditing?this.editNeedsConversion?this._onEditCommand=Re.a.binaryConvert:this._onEditCommand=Re.a.switchToEditMode:e.interactiveViewIsEnabled?this._onEditCommand=Re.a.switchToEditMode:this._onEditCommand=0}dispose(){this._isDisposed$4||(this._notificationBar&&(this._notificationBar.dispose(),this._notificationBar=null),this._theContextMenu&&(this._theContextMenu.dispose(),this._theContextMenu=null),this.workspace&&(this.workspace.dispose(),this.set_workspace(null)),this._theRibbonUser&&(this._theRibbonUser.dispose(),this._theRibbonUser=null),this._theStatusBarUser&&(this._theStatusBarUser.dispose(),this._theStatusBarUser=null),this.unregisterShowViewerWarningBusinessBarElement(document.body),super.dispose(),this._isDisposed$4=!0)}registerShowViewerWarningBusinessBarElement(e){this.theKeyInputManager.registerHandler(L.a.keyPress,e,this.showViewerWarningBusinessBar),this.theCompositionEventManager.registerHandler(L.a.compositionStart,e,this.showViewerWarningBusinessBar,null)}unregisterShowViewerWarningBusinessBarElement(e){this.theKeyInputManager.unregisterHandler(L.a.keyPress,e,this.showViewerWarningBusinessBar),this.theCompositionEventManager.unregisterHandler(L.a.compositionStart,e,this.showViewerWarningBusinessBar)}pdfElementOuterDivScopeSetFocus(e,t){const n=document.getElementById(co.pdfElementOuterDivId);n?.focus()}refreshDocument(e){const{App:t}=Be.a.AppInstance;if(!s.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady)return void i.ULS.sendTraceTag(5560476,301,15,"WordViewer.AppFrame.RefreshDocument tried to refresh page before full app settings ready.");const n={mode:"view"},a={actionName:ne.a.refresh,extraData:n};if(32===s.AFrameworkApplication.theActionManager.processActionWithData(m.a.raiseActionToHost,2,a))return void i.ULS.sendTraceTag(41972614,301,50,"WordViewer.AppFrame.RefreshDocument - sending refresh request to the host instead.");let o="";s.AFrameworkApplication.isEmbedded?(o=s.AFrameworkApplication.hostEmbeddedViewUrl,this.wordViewerApp.showPrint||(o=ae.a.addOrReplaceParameterValue(o,"wdPrint","0")),this.wordViewerApp.showEmbed||(o=ae.a.addOrReplaceParameterValue(o,"wdEmbedCode","0"))):o=this.hostViewUrl,this.wordViewerApp.userMayEnterAccessiblePdfMode&&(o=t.updateUrlForAccessiblePdfMode(o,this.wordViewerApp.isAccessiblePdfMode));const r=this.getTopParagraphId();r&&(o=ae.a.addOrReplaceParameterValue(o,"wdparaid",r)),this.isCommentPaneVisible&&(o=ae.a.addOrReplaceParameterValue(o,"wdcomments","1")),s.AFrameworkApplication.isControllerServicesQueryParamNeeded&&(o=ae.a.addOrReplaceParameterValue(o,s.AFrameworkApplication.controllerServicesParamName,"1")),C.a.safelyOpenWindow(o,"_parent",void 0,"WordViewer.AppFrame.RefreshDocument")}makeStopwatchBuilder(){return new re}get isSearchPaneVisible(){return this._isSearchPaneVisible}get isSearchPaneTouchMode(){return this._isSearchPaneTouchMode}showSearchPane(e){3===e?this._isSearchPaneTouchMode=!0:2===e&&(this._isSearchPaneTouchMode=!1),this._isSearchPaneVisible=!0,this.notifyResize()}hideSearchPane(){this._isSearchPaneVisible=!1,this.notifyResize()}get isCommentPaneVisible(){return this._isCommentPaneVisible}get isCommentPaneTouchMode(){return this._isCommentPaneTouchMode}showCommentPane(e){3===e?this._isCommentPaneTouchMode=!0:2===e&&(this._isCommentPaneTouchMode=!1),this._isCommentPaneVisible=!0,this.notifyResize()}hideCommentPane(){this._isCommentPaneVisible=!1,this.notifyResize()}propagateEscKeyEventToHost(){this.postMessenger.sendMessage("BrowserEvent",{type:"keydown",keyCode:f.a.vK_Esc,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1})}getTopParagraphId(){if(!this.wordViewerApp.theDocument.pageCount)return null;const e=this.wordViewerApp.zoomControl.currentZoom,t=this.wordViewerApp.scrollControl.getScrollTop(),n=qe.a.instance.getPageFromScrollTop(t,e),a=qe.a.instance.getPageTopAtZoom(n,e),i=this.thePageInfoCache.getPage(n),o=(t-a)/e,r=qe.a.instance.getPageWidthAtZoom(n,1),s=qe.a.instance.getPageHeightAtZoom(n,1);let l=no.b(0,r,o,s,n,i),c=l&&l.length>0?l[0]:null;c||(l=no.b(0,r,0,o,n,i),c=l&&l.length>0?l[l.length-1]:null);let d=null;if(c){0;const e=c.parentNode;e&&"P"===e.nodeName&&e.attributes.getNamedItem("id")&&(d=e.attributes.getNamedItem("id").nodeValue)}return d}switchIntoEditMode(e,t,n,a=!1){const{App:o}=Be.a.AppInstance;if(t&&!this.wordEditorUrl&&!s.AFrameworkApplication.useEditModePostMessage)return 8;if(t&&!o.instance.supportsEditing)return 8;if(1===e)return 32;if(2!==e)return i.ULS.sendTraceTag(41170244,301,15,"Unexpected ActionBehavior {0} for switching to edit mode",e),2;if(Be.a.isDocumentEncrypted()){i.ULS.sendTraceTag(572072226,301,50,"Try to switching into edit mode for an encrypted document");const e=se.a.formatSingleString(CommonUiStrings.SwitchToEditModeForEncryptedDocumentErrorTitle);return Be.a.showErrorDialog(so.a.documentIsEncrypted,e,CommonUiStrings.SwitchToEditModeForEncryptedDocumentErrorLabel,!1,!1,!0),32}const r=(new Date).getTime();if(y.a.instance.recordEditClickedInWebApp(r),t&&s.AFrameworkApplication.useEditModePostMessage)return Fe(t,r);if(s.AFrameworkApplication.isEmbedded){const e=new De.a;let t=this.hostEditUrl;this._isTranslatorRedirect&&e.add("translatorRedirect","1"),s.AFrameworkApplication.isControllerServicesQueryParamNeeded&&e.add(s.AFrameworkApplication.controllerServicesParamName,"1"),Pe.a(s.AFrameworkApplication.appSettingsManager)?Pe.e("edit",e,Pe.c):(t=ae.a.addOrReplaceParametersValue(t,e),C.a.safelyOpenWindow(t,void 0,void 0,"SwitchToEditMode.IsEmbed"))}else try{let e;const{windowTarget:t,urlParams:i}=({wordEditorUrl:e}=this.generateEditUrlAndTarget(r,n,!0,a));Pe.a(s.AFrameworkApplication.appSettingsManager)?Pe.e("edit",i,Pe.c):(e=ae.a.addOrReplaceParametersValue(e,i),s.AFrameworkApplication.wasAuthenticationLostDuringSession?C.a.safelyOpenWindow(e,C.a.windowTargetToString(t),void 0,"SwitchToEditMode"):C.a.openWindow(t,e,void 0,void 0,"AppModeSwitch")),s.AFrameworkApplication.isShuttingDown=!0}catch(e){}return 32}openNewWindowInEditMode(){try{let e;const t=(new Date).getTime(),{urlParams:n}=({wordEditorUrl:e}=this.generateEditUrlAndTarget(t,!1,!1,!1));e=ae.a.addOrReplaceParametersValue(e,n),C.a.safelyOpenWindow(e,C.a.windowTargetToString(4),void 0,"OpenNewWindowInEditMode")}catch(e){}}generateEditUrlAndTarget(e,t,n,a){let i,o;const{App:r}=Be.a.AppInstance;s.AFrameworkApplication.wasAuthenticationLostDuringSession||t?(o=this.hostEditUrl,i=3):(o=this.wordEditorUrl,i=1);const l=new De.a,c=this.getTopParagraphId();if(c&&l.add("wdPid",c),l.add(s.AFrameworkApplication.modeSwitchTimeParamName,e.toString()),l.add(s.AFrameworkApplication.previousSessionParamName,s.AFrameworkApplication.userSessionId),l.add(le.a.userSessionDataParam,le.a.userSessionData),s.AFrameworkApplication.canSupportConsumption&&l.add(s.AFrameworkApplication.consumptionSupportedParamName,"1"),n){const e=s.AFrameworkApplication.appSettingsManager.getStringAppSetting(s.AFrameworkApplication.uiHostSettingName);e&&l.add(s.AFrameworkApplication.uiHostParamName,e)}else l.add(s.AFrameworkApplication.uiHostParamName,null);return r.canEdit||r.isReviewer||!r.interactiveViewIsEnabled||(l.add("readOnly","1"),l.add("wdDoNotAutoNavigateToReadingView","1")),this._isTranslatorRedirect&&l.add("translatorRedirect","1"),s.AFrameworkApplication.isControllerServicesQueryParamNeeded&&l.add(s.AFrameworkApplication.controllerServicesParamName,"1"),s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UxBugFixesForCMFScenarioIsEnabled")&&(s.AFrameworkApplication.sessionContext&&l.add("sc",ce.a.urlKeyValueEncode(s.AFrameworkApplication.sessionContext)),s.AFrameworkApplication.hideHeader&&l.add("hh","1"),s.AFrameworkApplication.hideHeaderEmbedded&&l.add("hhdr","1"),s.AFrameworkApplication.isUIEmbedMode&&l.add("uiembed","1")),a&&(l.add("readOnly","1"),this.wordViewerApp.fromReadingView&&l.add(s.AFrameworkApplication.isInteractiveReadOnlyParamName,"1")),l.add("sftc","1"),C.a.generateOWLUrlParameters(l),{wordEditorUrl:o,windowTarget:i,urlParams:l}}constructor(e,t,a){super(e,t),this._isDisposed$4=!1,this._theRibbonUser=null,this._clientEditDocumentUrl=null,this._wordEditorUrl=null,this._hostViewUrl=null,this._hostEditUrl=null,this._editNeedsConversion=!1,this._isTranslatorRedirect=!1,this._ribbonPanel=null,this._theStatusBarUser=null,this._notificationBar=null,this._updateCommandUITask=null,this._isSearchPaneVisible=!1,this._isCommentPaneVisible=!1,this._isSearchPaneTouchMode=!1,this._isCommentPaneTouchMode=!1,this._shouldLoadViewerWarningBusinessBar=!0,this._onEditCommand=0,this._wordViewerApp=null,this._workspace=null,this._postMessenger=null,this._theContextMenu=null,this.thePageInfoCache=null,this.initializeToolbarInternal=(e,t)=>{t&&Te.a.disposeEmptyHeaderAndToolbar(t),this._theRibbonUser=new eo(this,this._ribbonPanel,e,this),this._ribbonPanel.style.height=this._theRibbonUser.theViewerChrome.toolbarWithTopbarHeight+"px"},this.showViewerWarningBusinessBar=e=>{const{App:t}=Be.a.AppInstance;if(null!=this.theFocusManager.currentScope&&null!=this.theFocusManager.currentScope.name&&r.a.documentFocusID===this.theFocusManager.currentScope.name&&"input"!==e.sourceElement.tagName.toLowerCase()){if(!this.businessBar||this.wordViewerApp.translationLanguage||!this._shouldLoadViewerWarningBusinessBar||e.innerEvent.ctrlKey||e.innerEvent.rawEvent.metaKey||e.innerEvent.altKey||e.innerEvent.charCode===f.a.vK_Enter)return!1;const n=this.wordViewerApp.supportsEditing&&(t.canEdit||t.isReviewer);let a;a=n?this.wordViewerApp.isPdfMode?WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ViewerWarningBusinessBarMessagePdf):WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ViewerWarningBusinessBarMessage):this.wordViewerApp.isPdfMode?WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ViewerWarningDisabledEditBusinessBarMessagePdf):WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ViewerWarningDisabledEditBusinessBarMessage);const i=new be.a(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ViewerWarningBusinessBarTitle),a,null);n&&(this.wordViewerApp.isPdfMode?i.addButton(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ViewerWarningBusinessBarButtonPdf),this.navigateToEditor,""):i.addButton(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ViewerWarningBusinessBarButton),this.navigateToEditor,"")),i.closeable=!0,i.image=3,this.businessBar.addEntry(i,!0);const o=this.theFocusManager.getRegion("businessBar");return o&&(o.contained=!0,o.looped=!0),this._shouldLoadViewerWarningBusinessBar=!1,!0}return!1},this.navigateToEditor=e=>{let t=null;if(this.setOnEditCommand(),this._onEditCommand===m.a.copyAndEdit){t={targetWacAction:"Edit"};const e=this.getTopParagraphId();e&&(t.wdparams="wd=pid("+e+")")}s.AFrameworkApplication.theActionManager.processActionWithData(this._onEditCommand,2,t)},this.unsupportedBrowserHandler=e=>{Ie.d(m.a.newBrowserSuggestionClicked);const t=s.AFrameworkApplication.appSettingsManager.getStringAppSetting("IE11SoftBlockCommercialUrlDefault");C.a.safelyOpenWindow(t,"_blank",void 0,"AppFrame.UnsupportedBrowserLink")},this.statusBarScopeSetFocus=(e,t)=>{const n=this.theFocusManager.getRegion(co.statusBarFocusId);n&&n.moveIntoFromTop()},this.hideAllPanes=(e,t,n,a,i)=>(1===n||(s.AFrameworkApplication.theActionManager.processAction(Re.a.hideSearchPane,2),s.AFrameworkApplication.theActionManager.processActionWithData(m.a.hideCommentPane,2,!0),this.theFocusManager.setScope(r.a.documentFocusID)),32),this.onBinaryConvert=(e,t,n,a,i)=>{if(t.contextId!==Qe.a.application)return 2;if(!this.editNeedsConversion)return 8;if(1===n)return 32;const o=(new Date).getTime();return y.a.instance.recordEditClickedInWebApp(o),s.AFrameworkApplication.useEditModePostMessage?Fe(s.AFrameworkApplication.hostPostmessenger,o):(We.launch(),32)},this.onOpenInWordViewer=(e,t,n,a,i)=>{const{App:o}=Be.a.AppInstance;if(t.contextId!==Qe.a.application)return 2;if(!this._hostViewUrl)return 8;if(2===n){let e=this._hostViewUrl;this.wordViewerApp.userMayEnterAccessiblePdfMode&&(e=o.updateUrlForAccessiblePdfMode(e,this.wordViewerApp.isAccessiblePdfMode)),e=o.updateUrlForEmbeddedFullScreen(e),C.a.safelyOpenWindow(e,void 0,void 0,"OpenInWordViewer")}return 32},this.onTranslateDocument=(e,t,n,a,i)=>t.contextId!==Qe.a.application?2:1===n?Be.a.isDocumentEncrypted()?8:32:(oo.a.launchDialog(),32),this.onTranslateBack=(e,t,n,a,i)=>(this._isTranslatorRedirect=!0,1===n?32:this.wordViewerApp.translationFromEditor?this.switchIntoEditMode(n,null,!1):(oo.a.navigateToOriginalDocument(),32)),this.onDownloadATranslatedCopy=(e,t,n,a,i)=>t.contextId!==Qe.a.application?2:(1===n||oo.a.downloadATranslatedCopy(),32),this.onSaveAndEditATranslatedCopy=(e,t,n,a,i)=>t.contextId!==Qe.a.application?2:(1===n||oo.a.saveAndEditDialog(),32),this.onShowPdfConvertAndEditDialog=(e,t,n,a,i)=>t.contextId!==Qe.a.application?2:this.editNeedsConversion?1===n&&this.wordViewerApp.isProtectedPdf?8:(1===n||s.AFrameworkApplication.theActionManager.processAction(Re.a.binaryConvert,2),32):8,this.handleEscKeyDown=(e,t,n,a,i)=>(1===n||(this.isSearchPaneVisible||this.isCommentPaneVisible?s.AFrameworkApplication.theActionManager.processAction(Re.a.hideAllPanes,2):this.propagateEscKeyEventToHost()),32);const{App:i}=Be.a.AppInstance,o=e;if(this.set_wordViewerApp(o||i.instance),!A.a.isInitialized){const e=document.createElement("div");i.InitializeHtmlScratchPadProvider(e),t.appendChild(e)}this.wordViewerApp.isScreenReaderPresent=this.highContrastDetector.isScreenReaderPresent,document.body.setAttribute(b.a.ariaRoleAttribute,b.a.ariaApplicationRole),c.a.enabled=!0,this.theF6Manager.f6KeyInput=T.a.hashKey(f.a.VK_F6,T.a.commandKeyModifier),this.theF6Manager.f6ShiftKeyInput=T.a.hashKey(f.a.VK_F6,4|T.a.commandKeyModifier),this.theF6Manager.bindFocusToBrowser(r.a.appFocusId);const l=[co.headerUiFocusId,"ReactSharedHeaderMeControlFlexPane",co.ribbonFocusId,co.pdfElementOuterDivId,"businessBar",to.a.searchFocusID,r.a.documentFocusID,r.a.commentPaneFocusId,r.a.flexPaneFocusId,"chat_wrapper_pane",co.statusBarFocusId];this.theF6Manager.initializeOrder(l),s.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady&&this.updateFullSettings(a),this.wordEditorUrl=a.WordEditorUrl,this.webServiceBase=a.WebServiceBase;let d=!1;const u=document.getElementById("FirstPageImage");if(u&&u.firstPageDisplayed&&(d=!0),this.wordViewerApp.isSmallView){Sys.UI.DomElement.addCssClass(this.get_element(),"Embed");const e=document.getElementById(s.AFrameworkApplication.externalHeaderPanelId);e&&e.style.setProperty("display","none")}else s.AFrameworkApplication.isNoChrome||(this._ribbonPanel=document.createElement("div"),this._ribbonPanel.id=co.ribbonPanelId,this._ribbonPanel.className="WACRibbonPanel",d&&(this._ribbonPanel.style.top=-this.upperRibbonHeight+"px"),this.get_element().appendChild(this._ribbonPanel),this.tryInitializeToolbar(),this._isSearchPaneTouchMode=this.isStaticUiTouchMode,this._isCommentPaneTouchMode=this.isStaticUiTouchMode);if(this.registerShowViewerWarningBusinessBarElement(document.body),!this.wordViewerApp.isCoreMode){const e=this.statusBarPanel;d&&(e.style.height="0",v.a.setOpacity(e,0)),this._theStatusBarUser=new Vi.a(e,this,i.instance),Vi.a.isReactStatusBarEnabled&&(e.style.height="inherit",Sys.UI.DomElement.addCssClass(e,"reactStatusBar")),w.a.initializeCuiScope(co.statusBarFocusId,this.statusBarScopeSetFocus,e,!1,!0,!0,!0),this.wordViewerApp.isAccessiblePdfMode&&w.a.initializeCuiScope(co.pdfElementOuterDivId,this.pdfElementOuterDivScopeSetFocus.bind(this),document.getElementById(co.pdfElementOuterDivId),!1,!0,!0,!0),window.setTimeout((()=>{F.a.get_instance().executeWhen(17,(()=>{this.ribbonUser.reactRibbonRoot.reactRibbonRootPoller.pollForStateAndUpdateCommands(appChrome.selectors.getActiveControlIds(),0)}))}),0)}if(this.switchToMode(1),this.theActionManager.addActionWithFlags(Re.a.binaryConvert,Qe.a.application,this.onBinaryConvert,96),this.theActionManager.addAction(Re.a.openInWordViewer,Qe.a.application,this.onOpenInWordViewer),this.theActionManager.addActionWithFlags(m.a.alwaysEnabled,Qe.a.application,I.ActionManager.doNothingHandler,96),this.theActionManager.addAction(Re.a.translateDocument,Qe.a.application,this.onTranslateDocument),this.theActionManager.addAction(Re.a.translateBackToOriginal,Qe.a.application,this.onTranslateBack),this.theActionManager.addAction(Re.a.downloadATranslatedCopy,Qe.a.application,this.onDownloadATranslatedCopy),this.theActionManager.addAction(Re.a.saveAndEditATranslatedCopy,Qe.a.application,this.onSaveAndEditATranslatedCopy),this.theActionManager.addAction(Re.a.hideAllPanes,h.a.frame,this.hideAllPanes),this.theActionManager.addAction(Re.a.handleEscKeyDown,h.a.frame,this.handleEscKeyDown),this.theActionManager.addAction(Re.a.showPdfConvertAndEditDialog,Qe.a.application,this.onShowPdfConvertAndEditDialog),(e=>{if(n(6921).App.instance.isAccessiblePdfMode)return;const t=e.getScope(r.a.appFocusId);t.bindAction(T.a.hashKeyString(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.HK_Find)),Re.a.showSearchPane),t.bindAction(T.a.hashKey(f.a.VK_F3,0),Re.a.showSearchPane),v.a.isFirefox&&(t.bindAction(T.a.hashKey(f.a.vK_SingleQuote,0),Re.a.showSearchPane),t.bindAction(T.a.hashKey(f.a.vK_Slash,0),Re.a.showSearchPane),t.bindAction(T.a.hashKey(f.a.VK_F3,4),Re.a.showSearchPane),t.bindAction(T.a.hashKey(f.a.VK_G,4|T.a.commandKeyModifier),Re.a.showSearchPane))})(this.theFocusManager),E.a.application=2,E.a.registerActions(Qe.a.application),this._disableFocus=Boolean.parse(a.WordViewerFocusDisabled||"false"),this._disableFocusOnBoot=Boolean.parse(a.DisableFocusOnBoot||"false"),this._showCommentPaneOnBoot=Boolean.parse(a.ShowCommentsOnBoot||"false"),this.theErrorHandler=new lo.a,this.theErrorHandler.register(this.thePageManager),b.a.registerHelpActionAndShortcut(Qe.a.application,t),d){const e=new M.a(2,1,100,(()=>{ro.a.animateChromeInWordViewer(this.upperRibbonHeight,Vi.a.isReactStatusBarEnabled?ao.a.reactStatusBarHeight:r.a.statusBarHeight)}));0,s.AFrameworkApplication.theTaskManager.addTask(e)}de.a.initSignOutResponseUI(this,this.applicationInstance.onAuthenticationLost.bind(this.applicationInstance),this.applicationInstance.onAuthenticationRestored.bind(this.applicationInstance),this.canUseAppAfterAuthLost)}}co.ribbonPanelId="WACRibbonPanel",co.ribbonFocusId="ribbon",co.statusBarFocusId="statusbar",co.headerUiFocusId="headerui",co.pdfElementOuterDivId="viewerContentsOuter",(0,a.a)(co,"AppFrame",S,[])},5210:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e,t,n){this.page=e,this.data=t,this.source=n}}(0,a.a)(i,"BroadcastActionArgs",null,[])},415:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.application=1,(0,a.a)(i,"ContextIds",null,[])},3152:function(e,t,n){"use strict";n.d(t,{a:function(){return E}});var a=n(100),i=n(3245),o=n(9858),r=n(9224),s=n(5374),l=n(988),c=n(3911),d=n(753);class u extends d.a{constructor(){super(),this.CommandMenuOpen=null,this.CommandMenuClose=null}}(0,a.a)(u,"ContextMenuRootProperties",d.a,[]);var p=n(5149),g=n(3078),h=n(9717),m=n(3455);class _ extends m.a{get x(){return this._x}get y(){return this._y}get launcherHeight(){return this._launcherHeight}get launcherWidth(){return this._launcherWidth}get needsAKeytip(){return!1}get menuDirection(){return 4}setInitialAriaMenuLauncherAttributes(e){}updateAriaMenuLauncherAttributes(e,t){}launchContextMenuAt(e,t,n){this.launchContextMenuAtLauncher(new Sys.UI.Bounds(e,t,0,0),n)}launchContextMenuAtLauncher(e,t){this._x=e.x,this._y=e.y,this._launcherHeight=e.height,this._launcherWidth=e.width,this.launchMenu(t)}constructor(e,t,n,a){super(e,t,n,a),this._x=0,this._y=0,this._launcherHeight=0,this._launcherWidth=0}}(0,a.a)(_,"ContextMenuLauncher",m.a,[]);var S=n(7977),f=n(4710),C=n(6662);class y extends _{get controlType(){return S.a.contextMenuControlType}createComponentDomForDisplayMode(e){return this.m_elmDefault=C.a.createElement("span"),new f.a(e,this.m_elmDefault)}get properties$3(){return this.controlProperties}constructClonedMenuLauncher(e,t,n){return new y(e,this.id,t,n)}constructor(e,t,n,a){super(e,t,n,a),this.m_elmDefault=null,this.addDisplayMode("Menu")}}(0,a.a)(y,"ContextMenuControl",_,[]);var A=n(7183),b=n(1903),T=n(8202);class v extends h.a{get activeMenu(){return this._activeMenu}refreshInternal(){super.refreshInternal(),b.d(this.elementInternal)&&this.ensureDOMElement(),this.elementInternal=C.a.removeChildNodes(this.elementInternal),this.appendChildrenToElement(this.elementInternal),this.dirty=!1}get rootType(){return 19}get contextMenuRootProperties(){return this.properties}ensureCorrectChildType(e){if(!(0,g.a)(T.a,e))throw Error.create("Only children of type StandaloneDock can be added to a ContextMenuRoot")}createContextMenu(e,t,n,a,i){const o=new A.a(this,t,n,a,null);e||(e={}),e.CommandMenuOpen=this.contextMenuRootProperties.CommandMenuOpen,e.CommandMenuClose=this.contextMenuRootProperties.CommandMenuClose;const r=new y(this,t+"Launcher",e,o);this.createdControls[t]=r;const s=new T.a(this,"dock"+t);s.addChild(r.createComponentForDisplayMode("Menu")),this.addChild(s),this.refresh()}showContextMenuAt(e,t,n,a){this.showContextMenuAtLauncher(e,new Sys.UI.Bounds(t,n,0,0),a),p.ULS.sendTraceTag(36497229,207,50,"ContextMenu launched for Id: {0}",e)}showContextMenuAtLauncher(e,t,n){const a=this.createdControls[e];if(b.d(a))throw Error.create('The context menu "'+e+'" does not exist');a.launchContextMenuAtLauncher(t,n),this._activeMenu=a.menu}onMenuStackCleared(){this._activeMenu=null}dispose(){const e=this.createdControls;for(const t in e){({key:t,value:e[t]}).value.dispose()}super.dispose()}constructor(e,t){super(e,t),this.activeFloatie=null,this._activeMenu=null,this.classname="ContextMenuRoot"}}(0,a.a)(v,"ContextMenuRoot",h.a,[]);var w=n(4754);class F{dispose(){this._root&&(this._root.dispose(),this._root=null),this._root=null}get theRoot(){return this._root}executeRootCommand(e,t,n,a=null,o=null){const r=parseInt(e);const s=i.AFrameworkApplication.theActionManager;n&&(s.commandLocation=n.CommandLocation,s.invocationMethod=n.InvocationMethod);let d=t;r===c.a.onZoomChange?d=parseInt(t.MenuItemId):r!==c.a.showSearchPane&&r!==l.a.showCommentPane||(d=new w.a(null,n.InvocationMethod));const u=s.processActionWithData(r,2,d,o);return this._root.refresh(),32===u}isRootCommandEnabled(e,t=null){if(!e)return!0;const n=parseInt(e);return 32===i.AFrameworkApplication.theActionManager.processAction(n,1)}pollForStateAndUpdateInternal(){this.theRoot.root.pollForStateAndUpdate()}showContextMenuAt(e,t,n){this.pollForStateAndUpdateInternal(),this.theRoot.showContextMenuAt(e,t.x,t.y,n)}constructor(e){if(null==e)throw Error.argumentNull("hostingAppFrame");const t=new u;t.ImageSideArrow=i.AFrameworkApplication.imageClusterPath,t.ImageSideArrowClass=s.c("SubmenuFlyoutArrow_13x13x32"),t.TextDirection=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.RibbonOptionTextDirection),this._root=new v("ContextMenuRootName",t),this._root.rootUser=this,this._root.refresh()}}(0,a.a)(F,"AContextMenuUser",null,[2,11]);var I=n(415);class E{show(e){const{App:t}=n(6921);E.ensureContextMenuCreated();let a=e.clientPoint;t.instance.isSmallView&&!E._newEmbedModeIsEnabled?(1===e.inputSource&&(a=new Sys.UI.Point(0,0)),E._contextMenuUser.showContextMenuAt(E._menuId,a,e.inputSource)):i.AFrameworkApplication.theActionManager.processActionWithData(c.a.showContextMenuInDocument,1,e)}dispose(){const{App:e}=n(6921);E._contextMenuUser.dispose(),E._contextMenuUser=null,e.get_activeAppFrame().theContextMenuInputManager.unregisterHandler(window.document,this._contextMenuHandler),this._contextMenuHandler=null}static get contextMenuUser(){return E._contextMenuUser}static createContextMenu(){const{App:e}=n(6921),t=E._contextMenuUser.theRoot,a={PopulateDynamically:"true",PopulateOnlyOnce:"false"};a.PopulateQueryCommand=""+c.a.populateContextMenu,a.Command=""+l.a.alwaysEnabled;const o=i.AFrameworkApplication.theActionManager;e.instance.isSmallView&&!E._newEmbedModeIsEnabled?(E._menuId="mnuEmbedViewer",e.instance.isAccessiblePdfMode||o.addActionWithFlags(c.a.populateContextMenu,I.a.application,E.populateContextMenuEmbedded,96)):(E._menuId="mnuSelectionViewer",o.addActionWithFlags(c.a.populateContextMenu,I.a.application,E.populateContextMenuSelection,96)),t.createContextMenu(a,E._menuId,"","","Menu16")}static populateContextMenuEmbedded(e,t,n,a,o){if(1===n)return 32;const s=o,d=new Sys.StringBuilder;return d.append(String.format('<Menu Id="{0}">',E._menuId)),d.append('<MenuSection Id="msZoomLevel" DisplayMode="Menu"><Controls>'),d.append(r.a("fseaFitHeight",c.a.fitHeight.toString(),WacWordviewerStringsManager.get(WacWordviewerStringsEnum.FitHeight))),d.append(r.a("fseaFitWidth",c.a.fitWidth.toString(),WacWordviewerStringsManager.get(WacWordviewerStringsEnum.FitWidth))),d.append(r.f("100",c.a.onZoomChange.toString(),100)),d.append(r.f("150",c.a.onZoomChange.toString(),150)),d.append("</Controls></MenuSection>"),i.AFrameworkApplication.trimDownloadACopy||(d.append('<MenuSection Id="msDownload" DisplayMode="Menu"><Controls>'),d.append(r.a("fseaDownloadACopy",l.a.downloadACopy.toString(),CommonUiStrings.DownloadACopy)),d.append("</Controls></MenuSection>")),d.append('<MenuSection Id="msFullScreen" DisplayMode="Menu"><Controls>'),d.append(r.a("fseaFullScreen",c.a.openInWordViewer.toString(),WacWordviewerStringsManager.get(WacWordviewerStringsEnum.FullScreen))),d.append("</Controls></MenuSection></Menu>"),s.PopulationXML=d.toString(),32}static populateContextMenuSelection(e,t,a,i,o){const{App:r}=n(6921),s=n(6921).App.instance.copyingEnabled,d=!n(6921).App.instance.accessibleModeEnabled&&n(6921).App.instance.userCanComment&&n(6921).App.instance.fileTypeSupportsCommenting;if(1===a)return r.instance.isAccessiblePdfMode?8:s||d?32:8;const u=o,p=new Sys.StringBuilder;return p.append(String.format('<Menu Id="{0}">',E._menuId)),s&&(p.append('<MenuSection Id="msCopy" DisplayMode="Menu16"><Controls>'),p.append(E.generateButtonWithImageXml("fseaCopy",c.a.copy,"Copy_16x16x32",WacWordviewerStringsManager.get(WacWordviewerStringsEnum.Copy))),p.append("</Controls></MenuSection>")),d&&(p.append('<MenuSection Id="msComment" DisplayMode="Menu16"><Controls>'),p.append(E.generateButtonWithImageXml("fseaComment",l.a.newComment,"CommentComment_16x16x32",WacWordviewerStringsManager.get(WacWordviewerStringsEnum.Comment))),p.append("</Controls></MenuSection>")),p.append("</Menu>"),u.PopulationXML=p.toString(),32}static showFromKey(e){E.ensureContextMenuCreated(),"mnuSelectionViewer"===E._menuId&&i.AFrameworkApplication.theActionManager.processAction(c.a.showContextMenuFromKey,1)}static ensureContextMenuCreated(){E._inited||(E.createContextMenu(),E._inited=!0)}static generateButtonWithImageXml(e,t,n,a){return String.format('<Button Id="{0}" Command="{1}" Image16by16="{2}" Image16by16Class="{3}" LabelText="{4}"/>',e,t,i.AFrameworkApplication.imageClusterPath,s.c(n),o.a.xmlEncode(a))}constructor(e){this.showDefaultContextMenu=e=>(this.show(e),!0);const{App:t}=n(6921);E._contextMenuUser=new F(e),this._contextMenuHandler=this.showDefaultContextMenu,E._newEmbedModeIsEnabled=i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NewEmbedModeIsEnabled"),t.get_activeAppFrame().theContextMenuInputManager.registerHandler(window.document,this._contextMenuHandler,null)}}E._contextMenuUser=null,E._menuId=null,E._inited=!1,E._newEmbedModeIsEnabled=!1,(0,a.a)(E,"ContextMenuControl",null,[])},1507:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e,t){this.scrollTop=e,this.scrollLeft=t}}(0,a.a)(i,"ScrollData",null,[])},3117:function(e,t,n){"use strict";n.r(t),n.d(t,{DownloadATranslatedCopyRequest:function(){return u}});var a=n(100),i=n(9858),o=n(3245),r=n(350),s=n(6921),l=n(7872),c=n(9823),d=n(4763);class u extends r.a{onSuccess(e){window.self.location.href=this._downloadUri}propagateError(e){c.a.propagateError(!1,"TranslationFailed",d.a.itemNotGenerated,e)}get requestUri(){return this._downloadUri}get waitMessage(){return WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrepareTranslationDownload)}get dismissWaitUIOnSuccess(){return!0}getErrorMessage(e){return WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DownloadTranslatedDocumentError)}isDocumentIssue(e){return!1}constructor(){super();const e=l.a.translationLanguages.getLanguages();let t="";for(let n=0;n<e.length;n++)if(e[n].name===s.App.instance.translationLanguage){t=e[n].displayName;break}this._downloadUri=s.App.webServiceBase+"docdatahandler.ashx?"+s.App.instance.theDocument.baseDocQuerySignature+"&language="+i.a.urlKeyValueEncode(s.App.instance.translationLanguage)+"&languagename="+i.a.urlKeyValueEncode(t)+"&type=docx&o15=1",o.AFrameworkApplication.theWsaClient.incrementDw(u.DATAID_WORDWEBAPPTRANSLATIONDOWNLOADCLICKS,1)}}u.DATAID_WORDWEBAPPTRANSLATIONDOWNLOADCLICKS=9988,(0,a.a)(u,"DownloadATranslatedCopyRequest",r.a,[])},4295:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.wordIcon="WordIcon",i.fullScreenButton="fseaFullScreen",i.controlMenu="ControlMenu",i.controlMenuSectionOne="msControlMenu1",i.downloadACopyButton="DownloadACopy",i.printButton="PrintPDF",i.accessibleModeButton="AccessibleMode",i.controlMenuSectionTwo="msControlMenu2",i.documentInformationButton="DocumentInformation",i.controlMenuSectionThree="msControlMenu3",i.privacyButton="Privacy",i.termsOfUseButton="TermsOfUse",i.giveFeedbackButtonEmbed="msControlMenu.Controls.GiveFeedback",(0,a.a)(i,"Embed",null,[])},4951:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(1207),o=n(3245),r=n(9858);class s extends i.a{static pathRefactorIsEnabled(){return o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScriptUrlFromNameNewIsEnabled",!1)}static wordViewerImage(e){let t=i.a.staticContentHost+s.wordViewerImageBase+r.a.escape(e)+i.a.removeBroltiFlightFromStaticContentQueryParameter(i.a.staticContentQueryParameter);return s.pathRefactorIsEnabled()&&(t=o.AFrameworkApplication.scriptUrlFromNameWithFolderPath(r.a.escape(e),5,s.wordViewerImageBase)),t}static wordViewerCss(e){let t=i.a.staticContentHost+s.wordViewerCssBase+r.a.escape(e)+i.a.staticContentQueryParameter;return s.pathRefactorIsEnabled()&&(t=o.AFrameworkApplication.scriptUrlFromNameWithFolderPath(r.a.escape(e),5,s.wordViewerCssBase)),t}static wordViewerScriptLocalized(e){let t=s.wordViewerScriptsLcidBase+r.a.escape(e)+i.a.staticContentQueryParameter;return s.pathRefactorIsEnabled()&&(t=o.AFrameworkApplication.scriptUrlFromNameWithFolderPath(r.a.escape(e),5,s.wordViewerScriptsLcidBase)),t}static wordViewerScript(e){let t=s.wordViewerScriptsBase+r.a.escape(e)+i.a.staticContentQueryParameter;return s.pathRefactorIsEnabled()&&(t=o.AFrameworkApplication.scriptUrlFromNameWithFolderPath(r.a.escape(e),5,s.wordViewerScriptsBase)),t}static ribbonImage(e){let t=i.a.staticContentHost+s.ribbonImageBase+r.a.escape(e)+i.a.removeBroltiFlightFromStaticContentQueryParameter(i.a.staticContentQueryParameter);return s.pathRefactorIsEnabled()&&(t=o.AFrameworkApplication.scriptUrlFromNameWithFolderPath(r.a.escape(e),5,s.ribbonImageBase)),t}static ribbonCss(e){let t=i.a.staticContentHost+s.ribbonCssBase+r.a.escape(e)+i.a.staticContentQueryParameter;return s.pathRefactorIsEnabled()&&(t=o.AFrameworkApplication.scriptUrlFromNameWithFolderPath(r.a.escape(e),5,s.ribbonCssBase)),t}static ribbonScript(e){let t=s.ribbonScriptsBase+r.a.escape(e)+i.a.staticContentQueryParameter;return s.pathRefactorIsEnabled()&&(t=o.AFrameworkApplication.scriptUrlFromNameWithFolderPath(r.a.escape(e),5,s.ribbonScriptsBase)),t}constructor(){super()}}s.wordViewerImageBase=null,s.wordViewerCssBase=null,s.wordViewerScriptsBase=null,s.wordViewerScriptsLcidBase=null,s.ribbonImageBase=null,s.ribbonCssBase=null,s.ribbonScriptsBase=null,(0,a.a)(s,"Path",i.a,[])},9287:function(e,t,n){"use strict";n.r(t),n.d(t,{PDFConvertFailureDialog:function(){return d}});var a=n(100),i=n(3245),o=n(4290),r=n(5120),s=n(5149),l=n(6921),c=n(6004);class d extends r.a{get hasBeenDisposed(){return this._isDisposed}set hasBeenDisposed(e){this._isDisposed=e}get messageString(){return CommonUiStrings.PdfConvertFailureDialogMessage}get linkString(){return CommonUiStrings.PdfConvertFailureDialogLinkSuggestion}get linkId(){return"DownloadPDFCopyLink"}prepareDialog(){this.hasCloseGlyph=i.AFrameworkApplication.isCloseable,super.prepareDialog()}logDialogDisplayed(){s.ULS.sendTraceTag(7660227,301,50,"Download a PDF copy dialog displayed after PDF converter error")}logDownloadLinkClicked(){s.ULS.sendTraceTag(7660228,301,50,"Download a PDF copy dialog clicked after PDF converter error")}dispose(){this.hasBeenDisposed||(super.dispose(),l.App.get_activeAppFrame().ribbonUser&&l.App.get_activeAppFrame().ribbonUser.poll(),o.a.closeAppOnErrorWithFailoverToBlank(),l.App.get_activeAppFrame().workspace.dispose(),this.hasBeenDisposed=!0)}constructor(e){super(e,i.AFrameworkApplication.isCloseable),this._isDisposed=!1,c.a()}}(0,a.a)(d,"PDFConvertFailureDialog",r.a,[])},5562:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e,t,n){this.retryCount=0,this.messageId=e,this.payload=t,this.callback=n}}(0,a.a)(i,"PostMessageRequest",null,[])},4606:function(e,t,n){"use strict";n.d(t,{a:function(){return O}});var a=n(100),i=n(5072),o=n(6127),r=n(3245),s=n(6915),l=n(1057),c=n(629),d=n(4238),u=n(2544),p=n(3696),g=n(7296),h=n(6094),m=n(7531),_=n(1163),S=n(9969),f=n(2280),C=n(5149),y=n(9928),A=n(9800),b=n(8103);class T extends y.a{get iconString(){return null}get messageString(){return this.isEmailLinkInDownloadAsPdfDialogEnabled?(0,b.a)("DownloadAsPdfDialog_EmailALinkText"):r.AFrameworkApplication.dialogClearerStringsIsEnabled?(0,b.a)("DownLoadACopyDialogMessage"):(0,b.a)("PrintDialogDocumentIsPrinting")}get linkString(){return(0,b.a)("DownloadAsPdfDialogLinkSuggestion")}get buttonText(){return(0,b.a)("Download")}get additionalTextBodyContent(){return null}get isEmailLinkInDownloadAsPdfDialogEnabled(){return"VersionHistory"!==this.callSource&&1!==r.AFrameworkApplication.activeFrame.mode&&(!r.AFrameworkApplication.activeFrame.applicationInstance.isBusinessUser&&!r.AFrameworkApplication.activeFrame.applicationInstance.isEduUser)}logDialogDisplayed(){C.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed"),A.a.logUniqueUsage("tshrepdf;tshrepdf2;cshrepdf")}constructor(e,t=null,n=null){super(e,!0,t,!1,void 0,n)}}(0,a.a)(T,"DownloadAsPdfDialog",y.a,[]);var v=n(1333),w=n(1903),F=n(988),I=n(1520),E=n(3911),M=n(415),k=n(9823),P=n(4763),D=n(5120),R=n(5327);class x extends D.a{get iconString(){return null}get messageString(){return WacWordviewerStringsManager.get(WacWordviewerStringsEnum.MoreAccessibleViewDialogDescription)}get linkString(){return WacWordviewerStringsManager.get(WacWordviewerStringsEnum.MoreAccessibleViewDialogLink)}get buttonText(){return null}get additionalTextBodyContent(){return null}get linkId(){return null}logDialogDisplayed(){C.ULS.sendTraceTag(556831685,324,50,"Accessible PDF link dialog displayed")}logDownloadLinkClicked(){C.ULS.sendTraceTag(556831686,324,50,"Accessible PDF link clicked")}constructor(e,t=null){super(e,!0,!1,new R.a(e,!1),t,!1)}}(0,a.a)(x,"MoreAccessibleViewDialog",D.a,[]);var L=n(6534),U=n(4965);class O{directPrintForPdfMode(e,t,a,i,o){const{App:s}=n(6921);if(2===a){if(!this._directPrintManager.shouldUseDirectPrint()&&!w.b(r.AFrameworkApplication.downloadACopyUrl))return s.get_activeAppFrame().navigateToHostUrl(2===a,r.AFrameworkApplication.downloadACopyUrl,!0);this._directPrintManager.shouldUseDirectPrint()&&C.ULS.sendTraceTag(7135491,301,50,"Plugin in installed,Request printable pdf from server."),this.requestPDF(2,!0)}return 32}registerPrintActions(e){this._actionManager.addAction(E.a.printDocument,M.a.application,e?this.handlePrintCommand:l.ActionManager.doNothingHandler);c.FocusManager.instance().getScope(d.a.appFocusId).bindAction(u.a.hashKey(i.a.VK_P,u.a.commandKeyModifier),e?E.a.printDocument:F.a.doNothing)}registerPrintDependentActions(){this._actionManager.addAction(E.a.downloadAsPdf,M.a.application,this.handleDownloadAsPdf),this._actionManager.addAction(E.a.printAccessibilityDocument,M.a.application,this.requestAccessiblePDF)}getRequestTypeParameter(e){switch(e){case 0:return"accesspdf";case 1:return"downloadpdf";case 2:return"printpdf";default:return C.ULS.sendTraceTag(5301274,324,10,"Unknown request PDF type {0}",e),"printpdf"}}handlePrintInPdfMode(e,t,n,a,i){if(C.ULS.sendTraceTag(7135493,301,50,"Handle print command in PDF mode."),w.b(r.AFrameworkApplication.downloadACopyUrl)&&C.ULS.sendTraceTag(4855504,301,50,"PdfModePrint called with no DownloadACopyUrl URL."),this._directPrintManager.directPrintSettings.isEnabled)return this.directPrintForPdfMode(e,t,n,a,i);if(this._showPrintDialogInPdfMode){if(!w.b(r.AFrameworkApplication.downloadACopyUrl))return this._legacyDialogDownloadACopyUrlFactory(),32;C.ULS.sendTraceTag(8709637,301,10,"DirectPrint is disabled and have no DownloadACopyUrl,we show error dialog."),this.showErrorUI(P.a.printPdfNotGenerated),k.a.propagateError(!1,"PrintFailed",P.a.printPdfNotGenerated,this._isPdfMode?WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintPdfError):WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintError))}return this._actionManager.processAction(F.a.downloadACopy,n)}handlePrintInDocxMode(e,t,n,a,i){return this.requestPrintPDF(e,t,n,a,i)}requestPrintPDF(e,t,n,a,i){return this._isCancelled=!1,this.requestPDF(2),32}dismissWaitUI(){this._waitDlg&&(this._waitDlg.close(),this._waitDlg=null)}showErrorUI(e){const{App:t}=n(6921);if(1!==t.get_activeAppFrame().state){const t=new p.StandardDialog;t.buttonsOption=0,t.setButtonText(1,CommonUiStrings.DialogClose),t.showError(e,CommonUiStrings.DefaultDialogTitle,this._isPdfMode?WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintPdfError):WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintError),null)}}getPrintUri(e,t){const{App:a}=n(6921);let i="WordViewer/request.pdf?"+r.AFrameworkApplication.appSettingsManager.getStringAppSetting("BaseDocQueryParam")+"&type="+this.getRequestTypeParameter(e);return t&&(i+="&pdfMode=1"),a.instance.translationLanguage&&(i+="&language="+a.instance.translationLanguage,r.AFrameworkApplication.theWsaClient.incrementDw(9987,1)),2===e&&this._directPrintManager.shouldUseNamedAction()&&(i+="&useNamedAction=1"),i}requestPDF(e,t=!1){const{App:a}=n(6921);switch(e){case 0:C.ULS.sendTraceTag(20820061,301,50,"Sending Accessible PDF conversion request.");break;case 1:C.ULS.sendTraceTag(20820062,301,50,"Sending Download PDF conversion request.");break;case 2:C.ULS.sendTraceTag(20820063,301,50,"Sending Print PDF conversion request.")}const i=this.getPrintUri(e,t),{url:o,headers:s}=k.a.getURLAndHeadersForRequest(i);v.a.doRequestWithBodyAndHeaders(o,null,s,null,((e,t,n)=>{this.onRequestComplete(e,t,n,i)}),a.get_activeAppFrame().notificationBar,!1)&&(this._printWaitTask||(this._printWaitTask=new g.a(2,1,500,this.showWaitUI),this._printWaitTask.customData=e,r.AFrameworkApplication.theTaskManager.addTask(this._printWaitTask)))}requestTypeFromUri(e){return e.indexOf("&type=downloadpdf")>0?1:e.indexOf("&type=printpdf")>0?2:e.indexOf("&type=accesspdf")>0?0:(C.ULS.sendTraceTag(5301276,324,10,"Could not get requestType from uri"),2)}isRequestUriPdfMode(e){return e.indexOf("&pdfMode=1")>-1}logConversionRequestFailure(e,t){const n=e.request.get_url(),a=e.httpStatus,i=e.status;let o=String.format("HTTP Status: {0}, RequestItem Status: {1}",a,i);switch(t&&(o=String.format("{0}, Response Status: {1}",o,t)),this.requestTypeFromUri(n)){case 0:C.ULS.sendTraceTag(20820064,301,10,"Accessible PDF conversion failed. {0}",o);break;case 1:C.ULS.sendTraceTag(20820065,301,10,"Download PDF conversion failed. {0}",o);break;case 2:C.ULS.sendTraceTag(20820066,301,10,"Print PDF conversion failed. {0}",o)}if(this.isRequestUriPdfMode(n))switch(t||""){case"InvalidParameter":C.ULS.sendTraceTag(7170206,301,10,"PdfModePrint, auto print PDF conversion failed. Status: InvalidParameter");break;case"CantOpenDocument":C.ULS.sendTraceTag(7170207,301,10,"PdfModePrint, auto print PDF conversion failed. Status: CantOpenDocument");break;case"DocumentAlreadyOpen":C.ULS.sendTraceTag(7170208,301,10,"PdfModePrint, auto print PDF conversion failed. Status: DocumentAlreadyOpen");break;case"ApplicationServerError":C.ULS.sendTraceTag(7170209,301,10,"PdfModePrint, auto print PDF conversion failed. Status: ApplicationServerError");break;case"DocumentIsEncrypted":C.ULS.sendTraceTag(7170210,301,10,"PdfModePrint, auto print PDF conversion failed. Status: DocumentIsEncrypted"),L.b("WordViewerPdfFailures",void 0,void 0,[{name:"FailureType",string:"WordViewerDocumentIsEncrypted"}]);break;case"InvalidCurrentDocument":C.ULS.sendTraceTag(7170211,301,10,"PdfModePrint, auto print PDF conversion failed. Status: InvalidCurrentDocument");break;default:C.ULS.sendTraceTag(7135494,301,10,"PdfModePrint, auto print PDF conversion failed. Status: "+(t||"null"))}}accessiblePdfRequested(){r.AFrameworkApplication.theWsaClient.incrementDw(9542,1),this._isCancelled=!1,this._isPdfMode?(C.ULS.sendTraceTag(5849884,301,50,"Accessible PDF requested while in PDF mode"),this._actionManager.processAction(F.a.downloadACopy,2)):this._userMayEnterAccessiblePdfMode?this._actionManager.processAction(E.a.toggleViewMode,2):this.requestPDF(0),this.hideAccessibleLink(null)}createAccessibleLink(){if(this._isAccessiblePdfMode){const e=document.getElementById(O.accessibilityLinkId);e&&h.a.removeElement(e)}else this._accessibleLink||(this._accessibleLink=document.getElementById(O.accessibilityLinkId)),this._accessibleLink&&(this.hideAccessibleLink(null),this._RequestAccessibilePDFFromMouseUp=this.requestAccessibilePDFFromMouseUp,this._RequestAccessibilePDFFromEnter=this.requestAccessibilePDFFromEnter,this._ShowAccessibleLink=this.showAccessibleLink,this._HideAccessibleLink=this.hideAccessibleLink,m.a.addHandler(this._accessibleLink,"mouseup",this._RequestAccessibilePDFFromMouseUp),m.a.addHandler(this._accessibleLink,"keydown",this._RequestAccessibilePDFFromEnter),m.a.addHandler(this._accessibleLink,"focus",this._ShowAccessibleLink),m.a.addHandler(this._accessibleLink,"blur",this._HideAccessibleLink))}displayPDF(e,t){const{App:a}=n(6921),i=new I.a;if(i.add("access_token"),i.add("access_token_ttl"),i.add("x-pass"),1!==a.get_activeAppFrame().state)switch(t){case 0:new x(e,i);break;case 1:new T(e,i);break;case 2:{const t=U.a.isPrintUsingOwlFlowEnabledForTeamsDesktopLikeScenario;t&&C.ULS.sendTraceTag(506561761,306,50,"Direct print is not enabled. We will be using the secure flow using OWL");const n=_.a.isElectron||_.a.isWebview2||U.a.enablingOWLBasedPrintOnlyForTeamsDesktop&&_.a.isTeamsDesktop;U.a.hidePasswordParamFromRequestsIsEnabled&&n&&(e=S.a.removeParameter(e,"x-pass")),this._directPrintManager.showPrintDialog(e,!1,i,t);break}default:C.ULS.sendTraceTag(5301277,324,10,"Unknown PdfRequestType:{0}",t)}}dispose(){this._accessibleLink&&this._RequestAccessibilePDFFromMouseUp&&m.a.removeHandler(this._accessibleLink,"mouseup",this._RequestAccessibilePDFFromMouseUp),this._accessibleLink&&this._RequestAccessibilePDFFromEnter&&m.a.removeHandler(this._accessibleLink,"keydown",this._RequestAccessibilePDFFromEnter),this._accessibleLink&&this._ShowAccessibleLink&&m.a.removeHandler(this._accessibleLink,"focus",this._ShowAccessibleLink),this._accessibleLink&&this._HideAccessibleLink&&m.a.removeHandler(this._accessibleLink,"blur",this._HideAccessibleLink),this._accessibleLink=null}static getPrintManagerInstance(){const{App:e}=n(6921);return new O(r.AFrameworkApplication.theActionManager,(()=>new y.a(r.AFrameworkApplication.downloadACopyUrl,!1)),e.instance.isPdfMode,e.instance.showLegacyPrintDialogPdfMode,f.a.instance.resolve("Common.App.DirectPrint.IDirectPrintManager"),c.FocusManager.instance(),e.instance.userMayEnterAccessiblePdfMode,e.instance.isAccessiblePdfMode)}constructor(e,t,a,l,c,d,u,p){this._isAccessibleLinkHidden=!1,this._waitDlg=null,this._printWaitTask=null,this._accessibleLink=null,this._RequestAccessibilePDFFromMouseUp=null,this._RequestAccessibilePDFFromEnter=null,this._ShowAccessibleLink=null,this._HideAccessibleLink=null,this.handlePrintCommand=(e,t,n,a,i)=>1===n?32:this._isPdfMode?(C.ULS.sendTraceTag(7135492,301,50,"Handle PDF print command, actionId: {0}",e),this.handlePrintInPdfMode(e,t,n,a,i)):this.handlePrintInDocxMode(e,t,n,a,i),this.handleDownloadAsPdf=(e,t,n,a,i)=>1===n?32:this._isPdfMode?16:(this._isCancelled=!1,this.requestPDF(1),32),this.requestAccessiblePDF=(e,t,n,a,i)=>(1===n||this.accessiblePdfRequested(),32),this.requestAccessibilePDFFromEnter=e=>{const t=e.keyCode;t===i.a.vK_Enter?this.accessiblePdfRequested():t===i.a.vK_Tab&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),this.hideAccessibleLink(e))},this.requestAccessibilePDFFromMouseUp=e=>{this.accessiblePdfRequested()},this.showWaitUI=e=>{const{App:t}=n(6921);if(1!==t.get_activeAppFrame().state&&!this._waitDlg){const t=new o.a;this._waitDlg=t.create();const n=e.customData;let a;switch(n){case 2:a=this._directPrintManager.shouldUseDirectPrint()?r.AFrameworkApplication.dialogClearerStringsIsEnabled?CommonUiStrings.DirectPrintPreparingPDF:WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DirectPrintWait):WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintPDFWait);break;case 1:a=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintPDFWait);break;case 0:a=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.AccessibilityPDFWait);break;default:C.ULS.sendTraceTag(5301275,324,10,"Unknown PdfRequestType{0}",n),a=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintPDFWait)}this._waitDlg.message=a,this._waitDlg.showProgressDialog(CommonUiStrings.DefaultDialogTitle,this.cancelButton,null)}},this.cancelButton=e=>{this._isCancelled=!0},this.onRequestComplete=(e,t,n,a)=>{if(this.dismissWaitUI(),this._directPrintManager.probeDirectPrintExperience(),!e||t)return this.logConversionRequestFailure(n,t),void(this.isRequestUriPdfMode(a)?w.b(r.AFrameworkApplication.downloadACopyUrl)?(C.ULS.sendTraceTag(8709638,301,10,"have no DownloadACopyUrl and fail to request printable pdf url from server."),this.showErrorUI(P.a.printPdfNotGenerated),k.a.propagateError(!1,"PrintFailed",P.a.printPdfNotGenerated,this._isPdfMode?WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintPdfError):WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintError))):this._legacyDialogDownloadACopyUrlFactory():(this.showErrorUI(P.a.printPdfNotGenerated),k.a.propagateError(!1,"PrintFailed",P.a.printPdfNotGenerated,this._isPdfMode?WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintPdfError):WacWordviewerStringsManager.get(WacWordviewerStringsEnum.PrintError))));if(this._isCancelled)return this._isCancelled=!1,void(this._printWaitTask=null);this._printWaitTask&&r.AFrameworkApplication.theTaskManager.deleteTask(this._printWaitTask),this._printWaitTask=null;const i=this.requestTypeFromUri(a),o=new s.a(a);if(r.AFrameworkApplication.addCommonUrlParameters(o),k.a.isDocumentEncrypted()&&o.addOrReplaceParam("x-pass",n.request.get_headers()["x-pass"]),1===i){const t=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppliedPolicyId"),n={name:"IsLabeled",bool:!!(t&&t.length>0)};L.b("PdfProtectionUsage",e,void 0,[n])}const l=o.toString();this.displayPDF(l,i)},this.showAccessibleLink=e=>{this._accessibleLink&&(this._accessibleLink.className=O.accessibilityLinkShownClass,this._isAccessibleLinkHidden=!1)},this.hideAccessibleLink=e=>{const{AppFrame:t}=n(668);this._accessibleLink&&!this._isAccessibleLinkHidden&&(this._accessibleLink.className=O.accessibilityLinkHiddenClass,this._isAccessibleLinkHidden=!0,e&&this._focusManager.setScopeFromTop(t.ribbonFocusId))};const{App:g}=n(6921);this._actionManager=e,this._directPrintManager=c,this._focusManager=d,this._userMayEnterAccessiblePdfMode=u,this._isAccessiblePdfMode=p,this.registerPrintActions(g.instance.showPrint),g.instance.printingEnabled&&(this._isCancelled=!1,this._legacyDialogDownloadACopyUrlFactory=t,this._showPrintDialogInPdfMode=l,this._isPdfMode=a,this.registerPrintDependentActions(),this.createAccessibleLink())}}O.accessibilityLinkId="WACAccessibilityLink",O.accessibilityLinkShownClass="WACAccessibilityLinkShown",O.accessibilityLinkHiddenClass="WACAccessibilityLinkHidden",(0,a.a)(O,"PrintManager",null,[11])},5825:function(e,t,n){"use strict";n.r(t),n.d(t,{SaveAndEditATranslatedCopyRequest:function(){return p}});var a=n(100),i=n(9858),o=n(3245),r=n(8258),s=n(6921),l=n(3117),c=n(7872),d=n(9823),u=n(4763);class p extends l.DownloadATranslatedCopyRequest{onSuccess(e){const t=e.responseXml.selectSingleNode("/docdata/editUrl");if(t)if(r.b(o.AFrameworkApplication.appSettingsManager))r.d(t.text);else{window.self.location.href=t.text}else{const e="Unexpected null edit url in response!";d.a.propagateError(!1,"SaveAndEditATranslatedDocumentFailed",u.a.itemNotGenerated,e)}}get waitMessage(){return WacWordviewerStringsManager.get(WacWordviewerStringsEnum.SaveAndEditTranslatedDocument)}constructor(){super();const e=c.a.translationLanguages.getLanguages();let t="";for(let n=0;n<e.length;n++)if(e[n].name===s.App.instance.translationLanguage){t=e[n].displayName;break}this._downloadUri=s.App.webServiceBase+"docdatahandler.ashx?"+s.App.instance.theDocument.baseDocQuerySignature+"&language="+i.a.urlKeyValueEncode(s.App.instance.translationLanguage)+"&languagename="+i.a.urlKeyValueEncode(t)+"&type=docx&o15=1&SaveAndEdit=1",o.AFrameworkApplication.theWsaClient.incrementDw(l.DownloadATranslatedCopyRequest.DATAID_WORDWEBAPPTRANSLATIONDOWNLOADCLICKS,1)}}(0,a.a)(p,"SaveAndEditATranslatedCopyRequest",l.DownloadATranslatedCopyRequest,[])},6544:function(e,t,n){"use strict";n.r(t),n.d(t,{SaveAndEditDialog:function(){return s}});var a=n(100),i=n(3563),o=n(8582),r=n(7872);class s extends i.CustomDialog{start(){const e=document.createElement("span"),t=document.createElement("div");t.innerText=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.SaveAndEditTranslatedDocumentDialogMessage),e.appendChild(t),this.dialogHtml=o.b(e),this.buttonsOption=1,this.showDialog(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.EditInBrowser),this.handleClick)}constructor(){super(),this.handleClick=(e,t)=>{1===e&&r.a.saveAndEditATranslatedCopy()}}}(0,a.a)(s,"SaveAndEditDialog",i.CustomDialog,[])},8035:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.searchFocusID="search",(0,a.a)(i,"SearchManagerConstants",null,[])},1676:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.reactStatusBarHeight=25,(0,a.a)(i,"StatusBarConstants",null,[])},3485:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.pageInfoLabel="PageInfoLabel",i.giveFeedbackButton="GiveFeedback",i.presenterPageLabel="PresenterPageLabel",i.buttonShowZoomDialog="buttonShowZoomDialog",i.zoomFlyout="ZoomFlyout",(0,a.a)(i,"Id",null,[])},7109:function(e,t,n){"use strict";n.d(t,{a:function(){return C}});var a=n(100),i=n(3245),o=n(385),r=n(2091),s=n(5122),l=n(4094),c=n(2280),d=n(637),u=n(8315),p=n(1057),g=n(8326),h=n(3911),m=n(4951),_=n(3485),S=n(4295);class f{getTrimmedIds(){const e={};if(e[_.a.zoomFlyout]=this.isAccessiblePdfMode||this.isEmbeddedViewer&&!this.newEmbedModeIsEnabled||this.zoomPopupDialogEnabled,e[_.a.buttonShowZoomDialog]=this.isAccessiblePdfMode||this.isEmbeddedViewer&&!this.newEmbedModeIsEnabled||!this.zoomPopupDialogEnabled,e[_.a.pageInfoLabel]=this.isAccessiblePdfMode,e[_.a.presenterPageLabel]=!this.isBroadcastMode,this.isEmbeddedViewer){e[_.a.giveFeedbackButton]=!0;const t=this.getTrimmedIdsForMenuSectionOne(e),n=this.getTrimmedIdsForMenuSectionTwo(e),a=this.getTrimmedIdsForMenuSectionThree(e);e[S.a.controlMenu]=t&&n&&a}else e[_.a.giveFeedbackButton]=!this.feedbackEnabled,e[S.a.wordIcon]=!0,e[S.a.fullScreenButton]=!0,e[S.a.controlMenu]=!0;return e}getTrimmedIdsForMenuSectionOne(e){let t=!0;return t=(e[S.a.printButton]=!this.printEnabled)&&t,t=(e[S.a.downloadACopyButton]=!this.downloadEnabled)&&t,t=(e[S.a.accessibleModeButton]=!this.userMayEnterAccessiblePdfMode)&&t,e[S.a.controlMenuSectionOne]=t,t}getTrimmedIdsForMenuSectionTwo(e){let t=!0;return t=(e[S.a.documentInformationButton]=!this.showEmbedCode)&&t,e[S.a.controlMenuSectionTwo]=t,t}getTrimmedIdsForMenuSectionThree(e){let t=!0;return t=(e[S.a.privacyButton]=!this.hasPrivacyUrl)&&t,t=(e[S.a.termsOfUseButton]=!this.hasTermsOfUseUrl)&&t,t=(e[S.a.giveFeedbackButtonEmbed]=!this.feedbackEnabled)&&t,e[S.a.controlMenuSectionThree]=t,t}constructor(){this.downloadEnabled=!1,this.feedbackEnabled=!1,this.hasPrivacyUrl=!1,this.hasTermsOfUseUrl=!1,this.isAccessiblePdfMode=!1,this.isEmbeddedViewer=!1,this.isBroadcastMode=!1,this.newEmbedModeIsEnabled=!1,this.printEnabled=!1,this.showEmbedCode=!1,this.userMayEnterAccessiblePdfMode=!1,this.zoomPopupDialogEnabled=!1}}(0,a.a)(f,"StatusBarIdTrimmer",null,[]);class C{initializeReactStatusBar(e,t,n){this._reactCommandDefinitionMapping=c.a.instance.tryResolve("WordViewer.WordViewerReactCommandDefinitionMapping");const a={};for(const e in t){const n={key:e,value:t[e]};a[this.getReactStatusBarControlId(n.key)]=n.value}this._reactStatusBar=new d.a(e,Object.assign(new u.a,{trimmedIds:a,updateRibbonControls:(e,t)=>{n.reactRibbonRootPoller.pollForStateAndUpdateCommands(e,t)},isViewer:!0,statusBarId:"WordViewerStatusBar"}))}getReactStatusBarControlId(e){let t="";if(this._reactCommandDefinitionMapping){const n=this._reactCommandDefinitionMapping.getExternalUxIdsByLegacyControlId(e);n&&n.count>0&&(t=n.get_item(0))}return t&&""!==t?t:e}dispose(){this._theStatusBar&&(this._theStatusBar.dispose(),this._theStatusBar=null)}poll(){this._reactStatusBar?this._reactStatusBar.poll():this._theStatusBar&&this._theStatusBar.pollForStateAndUpdate()}executeRootCommand(e,t,n,a=null,o=null){if(i.AFrameworkApplication.isShuttingDown)return!1;if(i.AFrameworkApplication.theTaskManager.isYielding)return!1;const r=parseInt(e),s=i.AFrameworkApplication.theActionManager;n&&(s.commandLocation=n.CommandLocation,s.invocationMethod=n.InvocationMethod);let l=t;const c=r;if(r===h.a.onZoomChange)l=parseInt(t.MenuItemId);return 32===s.processActionWithData(c,2,l,o)}isRootCommandEnabled(e,t=null){if(i.AFrameworkApplication.isShuttingDown)return!1;if(i.AFrameworkApplication.theTaskManager.isYielding)return!1;const n=parseInt(e);if(!e||n===p.ActionManager.emptyActionId)return!0;const a=n;return 32===i.AFrameworkApplication.theActionManager.processAction(a,1)}setControlVisibility(e,t){this._reactStatusBar?this._reactStatusBar.setControlVisibility(this.getReactStatusBarControlId(e),t):this._theStatusBar&&this._theStatusBar.setControlVisibility(e,t)}setZoomVisibility(e){this.setControlVisibility(this._zoomControlId,e)}pollControl(e){this._reactStatusBar?this._reactStatusBar.pollControl(this.getReactStatusBarControlId(e)):this._theStatusBar&&this._theStatusBar.pollForControlState(e)}pollZoomControl(){this.pollControl(this._zoomControlId)}onComponentBuilt(e,t){}static get isReactStatusBarEnabled(){const{App:e}=n(6921);return!e.instance.isSmallView}constructor(e,t,a){this._theStatusBar=null,this._reactStatusBar=null,this._reactCommandDefinitionMapping=null;const c=i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ZoomPopupDialogIsEnabled");this._zoomControlId=c?_.a.buttonShowZoomDialog:_.a.zoomFlyout;const d=Object.assign(new f,{downloadEnabled:!i.AFrameworkApplication.trimDownloadACopy,feedbackEnabled:i.AFrameworkApplication.showFeedbackButton&&!(i.AFrameworkApplication.mightNeedPrivacyDialog&&a.isSmallView),hasPrivacyUrl:!!i.AFrameworkApplication.privacyUrl,hasTermsOfUseUrl:!!i.AFrameworkApplication.termsUrl,isAccessiblePdfMode:a.isAccessiblePdfMode,isBroadcastMode:a.isBroadcastMode,isEmbeddedViewer:a.isSmallView,newEmbedModeIsEnabled:i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NewEmbedModeIsEnabled"),printEnabled:a.showPrint,showEmbedCode:a.showEmbed,userMayEnterAccessiblePdfMode:a.userMayEnterAccessiblePdfMode,zoomPopupDialogEnabled:c}),u=d.getTrimmedIds();if(C.isReactStatusBarEnabled)window.setTimeout((()=>{o.a.get_instance().executeWhen(7,(()=>{const{App:t}=n(6921);this.initializeReactStatusBar(e,u,t.get_activeAppFrame().ribbonUser.reactRibbonRoot)}))}),0);else{const n=new g.a(m.a.wordViewerImageBase,WacWordviewerStrings,null,null,null),a=Object.assign(new r.a,{clientID:C.clientId,trimmedIds:d.getTrimmedIds()}),i=new s.a(a,e,this,t);i.dataSource=new l.a("WordViewerStatusBarDataV2",n),i.buildToolbar(),this._theStatusBar=i.toolbar,this._theStatusBar.rootUser=this,this.setZoomVisibility(!1),this._theStatusBar.refresh()}}}C.clientId="StatusBar",(0,a.a)(C,"StatusBarUser",null,[2,3])},866:function(e,t,n){"use strict";n.r(t),n.d(t,{TranslateDocumentRequestFromViewer:function(){return S}});var a=n(100),i=n(5149),o=n(350),r=n(3245),s=n(8103);class l extends o.a{start(e){i.ULS.sendTraceTag(23184016,301,50,"Translation started"),super.start(e)}onCancel(e){super.onCancel(e),r.AFrameworkApplication.theWsaClient.incrementDw(9986,1),i.ULS.sendTraceTag(40953793,301,50,"Translation canceled")}onSuccess(e){const t=(new Date).getTime()-this._startTime;r.AFrameworkApplication.theWsaClient.setDw(9985,t),this.redirect(),i.ULS.sendTraceTag(23184017,301,50,"Translation succeeded")}get waitMessage(){return this._pageCount>=10?(0,s.a)("WaitForLongTranslation"):(0,s.a)("WaitForTranslation")}get dismissWaitUIOnSuccess(){return!1}getErrorMessage(e){return"TranslationServiceUnavailable"===e?(0,s.a)("TranslationServiceUnavailable"):"DocumentCannotBeTranslated"===e?(0,s.a)("DocumentCannotBeTranslated"):"DocumentHasOCX"===e?(0,s.a)("DocumentCannotBeTranslatedOCX"):"DocumentTooLong"===e?(0,s.a)("DocumentCannotBeTranslatedLength"):(0,s.a)("GenericTranslationError")}isDocumentIssue(e){return"DocumentCannotBeTranslated"===e||"DocumentHasOCX"===e||"DocumentTooLong"===e}constructor(e,t=0){super(),this._language=e,this._pageCount=t,this._startTime=(new Date).getTime(),r.AFrameworkApplication.theWsaClient.incrementDw(9984,1)}}(0,a.a)(l,"TranslateDocumentRequest",o.a,[]);var c=n(9969),d=n(7958),u=n(8258),p=n(6996),g=n(6921),h=n(9823),m=n(4763),_=n(4965);class S extends l{redirect(){if(u.a(r.AFrameworkApplication.appSettingsManager)){const e=new p.a;e.add("language",this._language),u.e("view",e,u.f)}else{let e=c.a.addOrReplaceParameterValue(window.self.location.href,"language",this._language);_.a.IsPassFromWithinViewerAppParamEnabled&&(e=c.a.addOrReplaceParameterValue(e,g.App.fromWithinViewerAppParamName,"1")),d.a.openWindow(1,e)}}propagateError(e){h.a.propagateError(!1,"TranslationFailed",m.a.itemNotGenerated,e)}get requestUri(){return g.App.instance.getDocDataUri(this._language)}constructor(e){super(e,g.App.instance.theDocument.pageCount)}}(0,a.a)(S,"TranslateDocumentRequestFromViewer",l,[])},9334:function(e,t,n){"use strict";n.r(t),n.d(t,{TranslationDialog:function(){return l}});var a=n(100),i=n(3563),o=n(3245);class r{static get myDialogHtml(){return i.CustomDialog.formatHtml(r.myDialogHtmlFormat,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.TranslationPrivacyWarning),WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ChooseTranslationLanguage))}}r.myDialogHtmlFormat="<div class='WACDialogRow' id='TranslationPrivacyLabelBlock'> <label id='TranslationPrivacyLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='TranslationLabelBlock'> <label id='TranslationLabel' class='WACDialogLabel' for='TranslationLanguageList' >{1}</label> </div> <div class='WACDialogRowNoBreak' id='TranslationLanguageListBlock'> <select class='UIFont WACDialogList' id='TranslationLanguageList'> </select> </div>",(0,a.a)(r,"TranslationDialogHtml",null,[]);var s=n(7872);class l extends i.CustomDialog{start(){this.dialogId="TranslationDialog";const e={TranslationLanguageList:0};this.dialogHtml=r.myDialogHtml,this.buttonsOption=1,this.initializeAndShow(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.TranslateDocument),this.handleClick,e),this.setDescribedByForDialog(this.myId("TranslationPrivacyLabel")),this.populateLanguageList()}populateLanguageList(){this._languages=s.a.translationLanguages.getLanguages(),this._uiLanguageId=1023&o.AFrameworkApplication.lcid,this._languages.sort(this.compareLanguages);const e=document.getElementById("TranslationLanguageList");for(let t=0;t<this._languages.length;t++){const n=document.createElement("OPTION");n.value=this._languages[t].name,n.text=this._languages[t].displayName,e.add(n,null)}}constructor(){super(),this._languages=null,this._uiLanguageId=0,this.compareLanguages=(e,t)=>{const n=e,a=t,i=n.languageId===this._uiLanguageId,o=a.languageId===this._uiLanguageId;return i&&!o?-1:o&&!i?1:n.displayName.localeCompare(a.displayName)},this.handleClick=(e,t)=>{1===e&&s.a.translateDocument(this._languages[t.TranslationLanguageList].name)}}}(0,a.a)(l,"TranslationDialog",i.CustomDialog,[])},7872:function(e,t,n){"use strict";n.d(t,{a:function(){return _}});var a=n(100),i=n(3245),o=n(9969),r=n(7958),s=n(9858),l=n(5149);class c{constructor(){this.languageId=0,this.name=null,this.displayName=null}}(0,a.a)(c,"TranslationLanguageInfo",null,[]);var d=n(965),u=n(5301);class p{requestTranslationLanguagesAppSetting(){if(i.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipTranslationLanguageRequestIfAppShuttingDown",!1)&&i.AFrameworkApplication.isShuttingDown)return;let e=this._requestUri(),t=null;({url:e,headers:t}=o.a.removeAccessTokensFromSource(e,t)),i.AFrameworkApplication.theClientRequestManager.addRequest(e,1,null,t,!1,2,this.onAppSettingsRequestSucceeded,this.onAppSettingsRequestFailed,null)}getLanguages(){const e=(this._translationLanguages||this._defaultLanguages()).split(","),t=this._translationLanguagesLocalized?e.length/3:e.length/2,n=new Array(t);for(let a=0;a<t;a++){n[a]=new c,n[a].name=e[a];const i=parseInt(e[a+t]);n[a].languageId=i,n[a].displayName=this._translationLanguagesLocalized?e[a+2*t]:u.a.get_l_LanguageNames()[i]}return n}updateAppSettings(e){this._translationLanguages=e.TranslationLanguages,this._translationLanguagesLocalized=Boolean.parse(e.TranslationLanguagesLocalized||"false")}constructor(e,t){this._translationLanguages=null,this._translationLanguagesLocalized=!1,this.onAppSettingsRequestFailed=e=>{const t={Status:e.data.status,HttpStatus:e.data.httpStatus,ResponseData:s.a.trimToLength(e.data.responseData,100)};l.ULS.sendTraceTag(42295809,301,10,"Failed to get the supported translation languages. The translation languages from BRS setting will be used. Error: {0}",t)},this.onAppSettingsRequestSucceeded=e=>{let t;l.ULS.sendTraceTag(42295810,301,50,"Retrieved the supported translation languages successfully.");try{const n=e.data.responseData;t=d.b(n)}catch(e){return void l.ULS.sendTraceTag(42295811,301,10,"Failed to deserialize the supported translation languages. The translation languages from BRS setting will be used. Exception: {0}",e)}this.updateAppSettings(t)},this._requestUri=e,this._defaultLanguages=t}}(0,a.a)(p,"TranslationLanguagesManager",null,[]);var g=n(8258),h=n(6996),m=n(4965);class _{static launchDialog(){const{TranslationDialog:e}=n(9334);(new e).start()}static downloadATranslatedCopy(){const{DownloadATranslatedCopyRequest:e}=n(3117),{App:t}=n(6921);(new e).start(t.get_activeAppFrame().notificationBar)}static saveAndEditDialog(){const{SaveAndEditDialog:e}=n(6544);(new e).start()}static saveAndEditATranslatedCopy(){const{SaveAndEditATranslatedCopyRequest:e}=n(5825),{App:t}=n(6921);(new e).start(t.get_activeAppFrame().notificationBar)}static translateDocument(e){const{TranslateDocumentRequestFromViewer:t}=n(866),{App:a}=n(6921);new t(e).start(a.get_activeAppFrame().notificationBar)}static navigateToOriginalDocument(){if(g.a(i.AFrameworkApplication.appSettingsManager)){const e=new h.a;e.add("language",""),g.e("view",e,g.f)}else{let e=o.a.removeParameter(window.self.location.href,"language");if(m.a.IsPassFromWithinViewerAppParamEnabled){const{App:t}=n(6921);e=o.a.addOrReplaceParameterValue(e,t.fromWithinViewerAppParamName,"1")}r.a.openWindow(1,e)}}static getLanguagesRequestUri(){const{App:e}=n(6921);return e.webServiceBase+"translation.ashx?"+e.instance.theDocument.baseDocQuerySignature+"&uilang="+s.a.urlKeyValueEncode(i.AFrameworkApplication.uiCulture)}static getDefaultTranslationLanguages(){const{App:e}=n(6921);return e.instance.translationLanguages}}_.translationLanguages=new p(_.getLanguagesRequestUri,_.getDefaultTranslationLanguages),(0,a.a)(_,"TranslationManager",null,[])},6734:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var a=n(100),i=n(3245),o=n(6094),r=n(7128),s=n(7057);class l extends s.a{constructor(e){super(5,e)}}(0,a.a)(l,"ResizeAnimationEvent",s.a,[]);class c extends s.a{constructor(e){super(7,e)}}(0,a.a)(c,"ScrollAnimationEvent",s.a,[]);var d=n(1489),u=n(681),p=n(2500),g=n(7958);const h="Shared_BasicClass",m="Shared_BasicClass",_="Shared_QuickClass";class S{static get ribbonPanelId(){const{AppFrame:e}=n(668);return i.AFrameworkApplication.activeFrame?e.ribbonPanelId:null}static get statusBarPanel(){return i.AFrameworkApplication.activeFrame?i.AFrameworkApplication.activeFrame.statusBarPanel:null}static animateSize(e,t,n,a){const i=e.style.height,s=e.style.width;let c=o.a.parseCssSize(i),d=o.a.parseCssSize(s);""===i.trim()&&(c=t),""===s.trim()&&(d=n),r.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");const u=new l(e);u.animateHeight(c,t),u.animateWidth(d,n),r.WacAirSpace.animate(u,null,a)}static animateScroll(e,t,n,a){const i=e.scrollLeft,o=e.scrollTop;r.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");const s=new c(e);return isNaN(t)||s.animateScrollLeft(i,t),isNaN(n)||s.animateScrollTop(o,n),r.WacAirSpace.animate(s,null,a)}static animatePosition(e,t,n){let a;a=i.AFrameworkApplication.isRtl?e.style.right:e.style.left;const s=e.style.top;let l=o.a.parseCssSize(a),c=o.a.parseCssSize(s);""===a.trim()&&(l=t),""===s.trim()&&(c=n),r.WacAirSpace.setAnimationClass(e,m);const u=new d.a(e);u.animateX(l,t,i.AFrameworkApplication.isRtl),u.animateY(c,n),r.WacAirSpace.animate(u,null,null)}static animateYPosition(e,t){const n=e.style.top;let a=o.a.parseCssSize(n);""===n.trim()&&(a=t),r.WacAirSpace.setAnimationClass(e,m);const i=new d.a(e);i.animateY(a,t),r.WacAirSpace.animate(i,null,null)}static animateFoundCurrentResultHighlight(e,t){r.WacAirSpace.setAnimationClass(t,_);const n=new u.a(t);n.animateOpacity(0,.4),r.WacAirSpace.animate(n,null,null),r.WacAirSpace.setAnimationClass(e,_);const a=new p.a(e);a.animateOpacity(.4,0),r.WacAirSpace.animate(a,null,S.onAfterCloneFadeOut)}static animateClearCurrentResultHighlight(e,t){r.WacAirSpace.setAnimationClass(t,_);const n=new u.a(t);n.animateOpacity(0,.4),r.WacAirSpace.animate(n,null,null),r.WacAirSpace.setAnimationClass(e,_);const a=new p.a(e);a.animateOpacity(.4,0),r.WacAirSpace.animate(a,null,S.onAfterCloneFadeOut)}static animateFindPane(e,t,n){r.WacAirSpace.setAnimationClass(e,h);const a=new d.a(e);let s;s=i.AFrameworkApplication.isRtl?e.style.right:e.style.left;let l=o.a.parseCssSize(s);t?a.animateX(l,0,i.AFrameworkApplication.isRtl):(i.AFrameworkApplication.isRtl?""===e.style.right.trim()&&(l=-1*e.clientWidth):""===e.style.left.trim()&&(l=-1*e.clientWidth),a.animateX(l,-1*e.clientWidth,i.AFrameworkApplication.isRtl)),r.WacAirSpace.animate(a,null,n)}static animateCommentPane(e,t,n){r.WacAirSpace.setAnimationClass(e,h);const a=new d.a(e);let s;s=i.AFrameworkApplication.isRtl?e.style.left:e.style.right;let l=o.a.parseCssSize(s);if(t)a.animateXRight(l,0,i.AFrameworkApplication.isRtl);else{const t=-1*e.clientWidth;i.AFrameworkApplication.isRtl?""===e.style.left.trim()&&(l=t):""===e.style.right.trim()&&(l=t),a.animateXRight(l,-1*e.clientWidth,i.AFrameworkApplication.isRtl)}r.WacAirSpace.animate(a,null,n)}static resizeContainerAnimation(e,t,n,a){r.WacAirSpace.setAnimationClass(e,h);let i=o.a.parseCssSize(e.style.left);""===e.style.left.trim()&&(i=t);const s=new d.a(e);s.animateX(i,t,!1),S._firstContainerAnimation&&r.WacAirSpace.temporarilyDisableAnimation(1e3),S._firstContainerAnimation=!1,r.WacAirSpace.animate(s,null,null);let c=o.a.parseCssSize(e.style.width);""===e.style.width.trim()&&(c=n);const u=new l(e);u.animateWidth(c,n),r.WacAirSpace.animate(u,null,a)}static animateChromeInWordViewer(e,t){const n=document.getElementById(S.ribbonPanelId);if(n){r.WacAirSpace.setAnimationClass(n,"Shared_BasicClass");const t=new d.a(n);t.animateY(-e,0),r.WacAirSpace.animate(t,null,null)}const a=S.statusBarPanel;if(a){r.WacAirSpace.setAnimationClass(a,"Shared_BasicClass");const e=new l(a);e.animateHeight(0,t),r.WacAirSpace.animate(e,null,null),r.WacAirSpace.setAnimationClass(a,"Shared_BasicClass");const n=new u.a(a);n.animateOpacity(0,1),r.WacAirSpace.animate(n,null,null)}}static animateCommentHintPosition(e,t,n){const a=o.a.parseCssSize(e.style.top),i=o.a.parseCssSize(e.style.left);r.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");const s=new d.a(e);s.animateY(a||t,t),s.animateX(i||n,n,!1),r.WacAirSpace.animate(s,null,null)}static animateHideHighlight(e){g.a.setOpacity(e,0)}static animateShowHighlight(e){const t=g.a.getOpacity(e)/100;r.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");const n=new u.a(e);n.animateOpacity(t,.4),r.WacAirSpace.animate(n,null,null)}static onAfterCloneFadeOut(e){const t=e.element;t&&t.parentNode&&t.parentNode.removeChild(t)}}S._firstContainerAnimation=!0,(0,a.a)(S,"WordViewerAnimator",null,[])},4763:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.accessDenied=5373953,i.cannotFindSourceDocument=5373954,i.serviceBusy=5373955,i.inProgress=5373956,i.noManagerAvailable=5373957,i.documentFileExtensionDisabled=5373958,i.documentIsIRMProtected=5373959,i.documentIsEncrypted=5373960,i.fileTypeBlocked=5373961,i.printPdfNotGenerated=5373962,i.itemNotGenerated=5373963,i.cantCreateDocument=5373964,i.cantOpenDocument=5373965,i.documentHasOcx=5373966,i.documentRejectedByGatekeeper=5373967,i.fileTypeUnsupported=5373968,i.workerException=5373969,i.workerCrashed=5373970,i.workerHung=5373971,i.unexpectedError=5373972,i.unknownError=5373973,i.commentBeginInvalidPropertyData=5373974,i.commentBeginPermissionDenied=5373975,i.commentBeginUnspecifiedFailure=5373976,i.commentBeginOldProductDigitalSignature=5373977,i.commentBeginDocumentProtectionSettings=5373978,i.commentBeginDocumentPasswordEncrypted=5373979,i.commentBeginFileCheckedOut=5373980,i.commentBeginFileRequiresCheckout=5373981,i.commentBeginFileLockedForOfflineCheckout=5373982,i.commentBeginFileLockedByOtherInterface=5373983,i.commentBeginCorruptedFile=5373984,i.commentBeginNumberOfCoauthorsReachedMax=5373985,i.commentBeginDocumentMarkedFinal=5373986,i.commentBeginPreReleaseFile=5373987,i.commentBeginClientServerNormalizationConflict=5373988,i.commentBeginLockExpired=5373989,i.commentBeginWordFileVersionMismatch=5373990,i.commentBeginFileEditedInRichClient=5373991,i.commentBeginRequestCountTooLarge=5373992,i.commentSaveInvalidPropertyData=5373993,i.commentSaveUnspecifiedFailure=5373994,i.commentSavePermissionDenied=5373995,i.commentSaveOldProductDigitalSignature=5373996,i.commentSaveDocumentProtectionSettings=5373997,i.commentSaveDocumentPasswordEncrypted=5373998,i.commentSaveFileCheckedOut=5373999,i.commentSaveFileRequiresCheckout=5374e3,i.commentSaveFileLockedForOfflineCheckout=5374001,i.commentSaveFileLockedByOtherInterface=5374002,i.commentSaveNumberOfCoauthorsReachedMax=5374003,i.commentSaveWordFileVersionMismatch=5374004,i.commentSaveDocxCoherencyFailure=5374005,i.commentSaveCorruptedFile=5374006,i.commentSaveDocumentMarkedFinal=5374007,i.commentSavePreReleaseFile=5374008,i.commentSaveLockExpired=5374009,i.commentSaveFileEditedInRichClient=5374010,i.commentSaveRequestCountTooLarge=5374011,i.commentBeginCanaryFailure=5374012,i.commentSaveCanaryFailure=5374013,i.commentSaveRetryCountExceeded=5374014,i.commentNewSelectSomething=5374015,i.commentNewInvalidContent=5374016,i.commentBeginRefreshVersion=5374017,i.commentBeginRefreshNormalization=5374018,i.commentBeginNetworkError=5374019,i.commentLockRefreshCanaryFailure=5374020,i.stringsFailedToLoadWordViewer=5374021,i.stringsFailedToLoadCommonUI=5374022,i.hostCanaryFailure=5374023,i.unexpectedDocDataResponse=5374024,i.documentCorrupt=5374025,i.applicationServerError=5374026,i.documentAlreadyOpen=5374027,i.documentCannotBeTranslated=5374028,i.documentPasswordProtected=5374029,i.documentTooLong=5374030,i.invalidCurrentDocument=5374031,i.invalidParameter=5374032,i.thirdPartyPDFRendererFailed=5374033,i.thirdPartyXPSRendererFailed=5374034,i.translationServiceUnavailable=5374035,i.userConversionQuotaExceeded=5374036,i.thresholdExceededForIncorrectPasswordAttempt=5374037,i.cannotOpenFile_HostUnauthorized=5374038,i.cannotOpenFile_HostForbidden=5374039,i.cannotOpenFile_HostInternalServerError=5374040,i.cannotOpenFile_HostBadRequest=5374041,i.cannotOpenFile_HostConflict=5374042,i.cannotOpenFile_HostUnused=5374043,i.cannotOpenFile_HostServiceUnavailable=5374044,i.cannotOpenFile_HostTooManyRequests=5374045,i.cannotOpenFile_HostFileNotFound=5374046,i.cannotOpenFile_HostNetwork_KeepAliveFailure=5374047,i.cannotOpenFile_HostNetwork_NameResolutionFailure=5374048,i.cannotOpenFile_HostNetwork_ConnectFailure=5374049,i.cannotOpenFile_HostNetwork_ReceiveFailure=5374050,i.cannotOpenFile_HostNetwork_SendFailure=5374051,i.cannotOpenFile_HostNetwork_ServerProtocolViolation=5374052,i.cannotOpenFile_HostNetwork_TrustFailure=5374053,i.cannotOpenFile_HostNetwork_SecureChannelFailure=5374054,i.cannotOpenFile_HostNetwork_ConnectionClosed=5374055,i.cannotOpenFile_HostNetwork_RequestCanceled=5374056,i.wordEditorBootFailed_RedirectToViewer=5374057,i.documentExportBlocked=5374058,(0,a.a)(i,"WordViewerErrorCode",null,[])},8920:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(4290);class o extends i.a{suppressError(e){return!e.source||super.suppressError(e)}constructor(){super()}}(0,a.a)(o,"WordViewerErrorHandler",i.a,[])},3116:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(2280),o=n(3245);class r{get scrollControl(){return this._scrollControl||(this._scrollControl=i.a.instance.resolve("WordViewer.Controls.IScrollControl"))}getSectionFromPage(e){const{App:t}=n(6921);let a,i=1,o=0,r=n(6921).App.instance.theDocument.sectionCount;if(e<1||e>t.instance.theDocument.pageCount)return null;for(;i<=r;){if(o=i+r>>1,a=t.instance.theDocument.getSection(o),e>=a.startPage&&e<=a.startPage+a.pageCount-1)return a;e<a.startPage?r=o-1:i=o+1}return null}get pageCount(){const{App:e}=n(6921);return e.instance.theDocument.pageCount}get sectionCount(){const{App:e}=n(6921);return e.instance.theDocument.sectionCount}get totalPageHeight(){const{App:e}=n(6921);return e.instance.theDocument.totalPageHeight}get maxPageWidth(){const{App:e}=n(6921);return e.instance.theDocument.maxPageWidth}get minPageHeight(){const{App:e}=n(6921);return e.instance.theDocument.minPageHeight}get totalPageGap(){const{App:e}=n(6921);return e.instance.theConfig.pageGapPixels*e.instance.theDocument.pageCount}get hasComments(){const{App:e}=n(6921);return e.instance.theDocument.hasComments}get isNormalized(){const{App:e}=n(6921);return e.instance.theDocument.isNormalized}getPageFromScrollTop(e,t){const{App:a}=n(6921);let i,o,r,s,l,c=1,d=this.pageCount;if(e<0)return 1;for(;c<=d;){if(o=c+d>>1,i=this.getSectionFromPage(o),l=this.getPageTopAtZoom(o,t),r=l-a.instance.theConfig.pageGapPixels+1,s=Math.round(l+i.pageHeight*t),e>=r&&e<=s)return o;e>s?c=o+1:d=o-1}return Math.max(1,d)}getPageTopAtZoom(e,t){const{App:a}=n(6921);if(this._topPage===e&&this._topZoom===t)return this._top;this._topPage=e,this._topZoom=t;const i=this.getSectionFromPage(e);return this._top=Math.round(i.top*t+(e-i.startPage)*i.pageHeight*t+e*a.instance.theConfig.pageGapPixels-.5*a.instance.theConfig.pageGapPixels),this._top}getPageLeftAtZoom(e,t,a){const{App:i}=n(6921),r=this.scrollControl.futureContainerWidth;if(this._leftPage===e&&this._leftZoom===t&&r===this._viewWidth)return this._left;this._leftPage=e,this._leftZoom=t,this._viewWidth=r;const s=this.getPageWidthAtZoom(e,t),l=t*this.maxPageWidth;if(r<=s+2*i.instance.theConfig.marginPixels)this._left=i.instance.theConfig.marginPixels,a&&o.AFrameworkApplication.isRtl&&(this._left+=l-s);else if(this._left=Math.round((r-(s+2))/2),a&&o.AFrameworkApplication.isRtl){const e=l+2*n(6921).App.instance.theConfig.marginPixels;r<=e&&(this._left=e-(this._left+s))}return this._left}getDistanceOfPageLeftFromScrollerRightEdge(e,t){const a=this.scrollControl.getWidth(),i=t*this.maxPageWidth+2*n(6921).App.instance.theConfig.marginPixels,o=this.getPageLeftAtZoom(e,t,!0);return a<=i?i-o:a-o}getPageHeightAtZoom(e,t){const n=this.getSectionFromPage(e);return Math.round(n.pageHeight*t)}getPageWidthAtZoom(e,t){if(this._widthPage===e&&this._widthZoom===t)return this._width;this._widthPage=e,this._widthZoom=t;const n=this.getSectionFromPage(e);return this._width=Math.round(n.pageWidth*t),this._width}static get instance(){return r._instance||(r._instance=new r)}constructor(){this._topPage=Number.NaN,this._topZoom=Number.NaN,this._top=Number.NaN,this._leftPage=Number.NaN,this._leftZoom=Number.NaN,this._left=Number.NaN,this._widthPage=Number.NaN,this._widthZoom=Number.NaN,this._width=Number.NaN,this._viewWidth=Number.NaN,this._scrollControl=null}}r._instance=null,(0,a.a)(r,"DocumentDataUtils",null,[9])},689:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e,t){this.firstPage=e,this.lastPage=t}}(0,a.a)(i,"PageData",null,[])},4244:function(e,t,n){"use strict";n.d(t,{a:function(){return r},b:function(){return s},c:function(){return o},d:function(){return l}});var a=n(9823),i=n(5149);const o=e=>String.format("/Pages/Page[@id='{0}']/descendant::P[@id='{1}']/T[1]",e,n(6921).App.initialParagraphId.toString(16).toUpperCase()),r=e=>{const t=new Sys.UI.Point(0,0);for(;e;)t.x+=e.offsetLeft,t.y+=e.offsetTop,isNaN(e.clientLeft)||(t.x+=e.clientLeft),isNaN(e.clientTop)||(t.y+=e.clientTop),e=e.offsetParent;return t},s=(e,t,n,a,o,r)=>{if(!r)return null;e>-1&&e<1&&0!==e&&(i.ULS.sendTraceTag(508158921,301,50,"Invalid coordinate value left : {0}",e),e=0),t>-1&&t<1&&0!==t&&(i.ULS.sendTraceTag(508158920,301,50,"Invalid coordinate value right : {0}",t),t=0),n>-1&&n<1&&0!==n&&(i.ULS.sendTraceTag(508158919,301,50,"Invalid coordinate value top : {0}",n),n=0),a>-1&&a<1&&0!==a&&(i.ULS.sendTraceTag(508158918,301,50,"Invalid coordinate value bottom : {0}",a),a=0);const s=String.format("/Pages/Page[@id='{0}']/*{1}/descendant-or-self::P/T[@l<={2} and (@l + @w)>={3} and @t<={4} and (@t + @h)>={5}]",o,"[not(self::Header)][not(self::Footer)][not(self::Footnote)][not(self::EndNote)]",t,e,a,n);return r.selectNodes(s)},l=(e,t)=>(t=parseFloat(a.a.parseXmlAttribute(e,"t")),isNaN(t)?{returnValue:!1,top:t}:{returnValue:!0,top:t})},6004:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(4378),i=n(3429);const o=()=>{a.a.enqueueResourceWithoutEnabling(i.a.create("dll1",null,(()=>n.e(2).then(n.bind(n,6694)))))}},9207:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(7296),o=n(3245),r=n(3989),s=n(1333),l=n(9823);class c{set failureCallback(e){this._failureCallback=e}send(){const{App:e}=n(6921);s.a.doRequestWithBodyAndHeaders(this._url+"&r=1",null,this._headers,null,this.onRequestComplete,e.get_activeAppFrame().notificationBar,!0)}constructor(e,t,n){this._failureCallback=null,this.onRequestComplete=(e,t,n)=>{if(e&&"Success"===t){const e=new i.a(2,1,0,this._successfulRequestHandler);e.name=this._url,o.AFrameworkApplication.theTaskManager.addTask(e)}else if(this._failureCallback)this._failureCallback();else if(e){const e=n.responseXml,t=e.selectSingleNode("/docdata/status"),a=t?t.text:"UnexpectedDocDataResponse",i=l.a.getErrorCodeFromStatus(a),o=e.selectSingleNode("/docdata/dialog/description"),s=r.a.formatSingleString(o?o.text:CommonUiStrings.CannotOpenFile);l.a.showErrorDialogFromResponseXml(e),l.a.propagateError(!1,"StatusRequestFailed",i,s)}else l.a.showErrorDialog(7,CommonUiStrings.DefaultDialogTitle,CommonUiStrings.NetworkProblemDialogDescription),l.a.propagateError(!1,"StatusRequestFailed",7,CommonUiStrings.NetworkProblemDialogDescription)},this._successfulRequestHandler=e,this._url=t,this._headers=n}}(0,a.a)(c,"StatusRequest",null,[])},9823:function(e,t,n){"use strict";n.d(t,{a:function(){return k}});var a=n(100),i=n(2280),o=n(6912),r=n(3245),s=n(3989),l=n(3696),c=n(2246),d=n(4290),u=n(9969),p=n(502),g=n(6534),h=n(965),m=n(5149),_=n(3792),S=n(6677),f=n(657),C=n(7296);n(7442);class y{areReady(){return 32===r.AFrameworkApplication.theActionManager.processAction(this._actionId,1)}waitForReady(e,t=null,n=null){const a=isNaN(t)?0:t,i=r.AFrameworkApplication.theActionManager.processAction(this._actionId,1),o=!!(0,_.j)(S.a);2!==i||o?e(this,null):a<20?(a||this._downloadFirstSlice&&this._downloadFirstSlice(),f.TaskManager.instance.addTask(new C.a(2,1,500,(t=>{this.waitForReady(e,a+1,n)}),127))):n&&n()}invokeOpenInClientHandlerAfterReady(){this.waitForReady(((e,t)=>{r.AFrameworkApplication.theActionManager.processActionWithData(this._actionId,2,!0)}),0,this.onDependenciesTimeout)}onDependenciesTimeout(){m.ULS.sendTraceTag(20711443,211,10,"ShowOpenInClient is not available after timeout");{const e=new l.StandardDialog;this.setupDialog(e)}}setupDialog(e){e.buttonsOption=0,e.showError(33,CommonUiStrings.DefaultDialogTitle,CommonUiStrings.NetworkProblemInitialDialogDescription,null)}constructor(e,t=null){this._actionId=e,this._downloadFirstSlice=t}}(0,a.a)(y,"OpenInClientOperationDependencies",null,[196]);var A=n(3911),b=n(5562),T=n(4763),v=n(6004);const w={0:T.a.cannotOpenFile_HostUnused,400:T.a.cannotOpenFile_HostBadRequest,401:T.a.cannotOpenFile_HostUnauthorized,403:T.a.cannotOpenFile_HostForbidden,404:T.a.cannotOpenFile_HostFileNotFound,409:T.a.cannotOpenFile_HostConflict,429:T.a.cannotOpenFile_HostTooManyRequests,500:T.a.cannotOpenFile_HostInternalServerError,503:T.a.cannotOpenFile_HostServiceUnavailable},F={ItemNotGenerated:T.a.itemNotGenerated,AccessDenied:T.a.accessDenied,CantFindSourceDocument:T.a.cannotFindSourceDocument,ServiceBusy:T.a.serviceBusy,InProgress:T.a.inProgress,NoManagerAvailable:T.a.noManagerAvailable,DocumentFileExtensionDisabled:T.a.documentFileExtensionDisabled,DocumentIsIRMProtected:T.a.documentIsIRMProtected,DocumentIsEncrypted:T.a.documentIsEncrypted,FileTypeBlocked:T.a.fileTypeBlocked,CantCreateDocument:T.a.cantCreateDocument,CantOpenDocument:T.a.cantOpenDocument,DocumentCorrupt:T.a.documentCorrupt,DocumentHasOCX:T.a.documentHasOcx,DocumentRejectedByGatekeeper:T.a.documentRejectedByGatekeeper,FileTypeUnsupported:T.a.fileTypeUnsupported,WorkerException:T.a.workerException,WorkerCrashed:T.a.workerCrashed,WorkerHung:T.a.workerHung,UnexpectedError:T.a.unexpectedError,UnknownError:T.a.unknownError,ApplicationServerError:T.a.applicationServerError,DocumentAlreadyOpen:T.a.documentAlreadyOpen,DocumentCannotBeTranslated:T.a.documentCannotBeTranslated,DocumentPasswordProtected:T.a.documentPasswordProtected,DocumentTooLong:T.a.documentTooLong,InvalidCurrentDocument:T.a.invalidCurrentDocument,InvalidParameter:T.a.invalidParameter,ThirdPartyPDFRendererFailed:T.a.thirdPartyPDFRendererFailed,ThirdPartyXPSRendererFailed:T.a.thirdPartyXPSRendererFailed,TranslationServiceUnavailable:T.a.translationServiceUnavailable,UnexpectedDocDataResponse:T.a.unexpectedDocDataResponse,UserConversionQuotaExceeded:T.a.userConversionQuotaExceeded,ThresholdExceededForIncorrectPasswordAttempt:T.a.thresholdExceededForIncorrectPasswordAttempt,HttpStatusCode_FileNotFound:T.a.cannotOpenFile_HostFileNotFound,HttpStatusCode_Unauthorized:T.a.cannotOpenFile_HostUnauthorized,HttpStatusCode_Forbidden:T.a.cannotOpenFile_HostForbidden,HttpStatusCode_InternalServerError:T.a.cannotOpenFile_HostInternalServerError,HttpStatusCode_BadRequest:T.a.cannotOpenFile_HostBadRequest,HttpStatusCode_Conflict:T.a.cannotOpenFile_HostConflict,HttpStatusCode_Unused:T.a.cannotOpenFile_HostUnused,HttpStatusCode_ServiceUnavailable:T.a.cannotOpenFile_HostServiceUnavailable,HttpStatusCode_TooManyRequests:T.a.cannotOpenFile_HostTooManyRequests,NetworkErrorStatus_KeepAliveFailure:T.a.cannotOpenFile_HostNetwork_KeepAliveFailure,NetworkErrorStatus_NameResolutionFailure:T.a.cannotOpenFile_HostNetwork_NameResolutionFailure,NetworkErrorStatus_ConnectFailure:T.a.cannotOpenFile_HostNetwork_ConnectFailure,NetworkErrorStatus_ReceiveFailure:T.a.cannotOpenFile_HostNetwork_ReceiveFailure,NetworkErrorStatus_SendFailure:T.a.cannotOpenFile_HostNetwork_SendFailure,NetworkErrorStatus_ServerProtocolViolation:T.a.cannotOpenFile_HostNetwork_ServerProtocolViolation,NetworkErrorStatus_TrustFailure:T.a.cannotOpenFile_HostNetwork_TrustFailure,NetworkErrorStatus_SecureChannelFailure:T.a.cannotOpenFile_HostNetwork_SecureChannelFailure,NetworkErrorStatus_ConnectionClosed:T.a.cannotOpenFile_HostNetwork_ConnectionClosed,NetworkErrorStatus_RequestCanceled:T.a.cannotOpenFile_HostNetwork_RequestCanceled},I={InvalidLabelOwner:CommonUiStrings.DecryptSkipReasonInvalidLabelOwner,ContentExpiryLabel:CommonUiStrings.DecryptSkipReasonContentExpiryLabel,DecryptionDefered:CommonUiStrings.DecryptSkipReasonDecryptionDefered,DeletedLabel:CommonUiStrings.DecryptSkipReasonDeletedLabel,DoubleKeyDisabled:CommonUiStrings.DecryptSkipReasonLabelDoubleKeyDisabled,EncryptedOutsideSharepoint:CommonUiStrings.DecryptSkipReasonEncryptedOutsideSharepoint,LabelProtectionChanged:CommonUiStrings.DecryptSkipReasonLabelProtectionChanged,PasswordProtected:CommonUiStrings.DecryptSkipReasonPasswordProtected,UnsupportedLabel:CommonUiStrings.DecryptSkipReasonLabelUnsupportedLabel,UnsupportedMsoDataStore:CommonUiStrings.DecryptSkipReasonUnsupportedMsoDataStore,RmsLabelNotFound:CommonUiStrings.DecryptSkipReasonGeneric,RmsServiceDisabled:CommonUiStrings.DecryptSkipReasonGeneric,RmsTemplateNotFound:CommonUiStrings.DecryptSkipReasonGeneric,Unknown:CommonUiStrings.DecryptSkipReasonGeneric,UnsupportedFileExtension:CommonUiStrings.DecryptSkipReasonGeneric,UnsupportedProtectionType:CommonUiStrings.DecryptSkipReasonGeneric,UnsupportedUser:CommonUiStrings.DecryptSkipReasonGeneric,UserNotFound:CommonUiStrings.DecryptSkipReasonGeneric};var E=n(4965),M=n(6921);class k{static get postMessenger(){return k._postMessenger||(k._postMessenger=i.a.instance.resolve("WordViewer.IWordViewerPostMessenger")),k._postMessenger}static get AppInstance(){return n(6921)}static getPageSetFromPage(e){const{App:t}=k.AppInstance;return Math.ceil(e/t.instance.theConfig.pageSetSize)}static getStartPageFromPageSet(e){const{App:t}=k.AppInstance;return(e-1)*t.instance.theConfig.pageSetSize+1}static getEndPageFromPageSet(e){const{App:t}=k.AppInstance,a=e*n(6921).App.instance.theConfig.pageSetSize;return Math.min(a,t.instance.theDocument.pageCount)}static getPageSetName(e){const t=k.getStartPageFromPageSet(e);return"p_"+t+"_"+(t+n(6921).App.instance.theConfig.pageSetSize-1)+".zip"}static getPageSetXmlFromPage(e){const{App:t}=k.AppInstance;return Math.ceil(e/t.instance.theConfig.pageSetXmlSize)}static getStartPageFromPageSetXml(e){const{App:t}=k.AppInstance;return(e-1)*t.instance.theConfig.pageSetXmlSize+1}static getEndPageFromPageSetXml(e){const{App:t}=k.AppInstance,a=e*n(6921).App.instance.theConfig.pageSetXmlSize;return Math.min(a,t.instance.theDocument.pageCount)}static getPageSetXmlName(e){const t=k.getStartPageFromPageSetXml(e);return"p_"+t+"_"+(t+n(6921).App.instance.theConfig.pageSetXmlSize-1)+".xml"}static getPageFromXmlLine(e){parseInt(e.attributes.getNamedItem("id").nodeValue);const t=e.parentNode;parseInt(t.attributes.getNamedItem("storyId").nodeValue);const n=t.selectSingleNode("ancestor::Page");return parseInt(n.attributes.getNamedItem("id").nodeValue)}static parseXmlAttribute(e,t){if(!e)return null;const n=e.attributes.getNamedItem(t);return n?n.textContent:null}static createWaitImage(){const e=new o.a(WacWordviewerStringsManager.get(WacWordviewerStringsEnum.Progress));return e.isSmall=!1,e.element.style.position="absolute",e.element}static getErrorCodeFromStatus(e){return F[e]??k.getErrorCodeFromHostStatusCode()}static getErrorCodeFromHostStatusCode(){return w[r.AFrameworkApplication.hostOperationHttpStatusCode]??2}static getCannotOpenFileError(e){let t=2;if(e){const n=e.selectSingleNode("/docdata/status");if(n){const e=k.getErrorCodeFromStatus(n.text);e&&(t=e)}else t=k.getErrorCodeFromHostStatusCode()}else t=k.getErrorCodeFromHostStatusCode();return t}static isCannotOpenFileError(e){if(!e)return!0;const t=e.selectSingleNode("/docdata/status");return(t?t.text:"HttpStatusCode").startsWith("HttpStatusCode")}static refineErrorMessage(e){return I[e]??CommonUiStrings.DecryptSkipReasonGeneric}static showErrorDialogFromResponseXml(e){const{App:t}=n(6921),{PDFConvertFailureDialog:a}=n(9287);if(k.isCannotOpenFileError(e)){const t=k.getCannotOpenFileError(e);return m.ULS.sendTraceTag(507586009,301,10,"CannotOpenFileError: {0}",t),void k.showErrorDialog(t,CommonUiStrings.DefaultDialogTitle,CommonUiStrings.CannotOpenFile)}const i=e.selectSingleNode("/docdata/dialog/title"),o=e.selectSingleNode("/docdata/status"),l=e.selectSingleNode("/docdata/dialog/description"),c=e.selectSingleNode("/docdata/dialog/extraErrorHandling"),d=i?i.text:CommonUiStrings.DefaultDialogTitle;let u=l?l.text:CommonUiStrings.CannotOpenFile;const p=o?o.text:"UnexpectedDocDataResponse";"DocumentIsIRMProtected"===p&&r.AFrameworkApplication.decryptSkipReason&&(m.ULS.sendTraceTag(509752860,301,50,"decryptSkipReason: {0}",r.AFrameworkApplication.decryptSkipReason),u=this.refineErrorMessage(r.AFrameworkApplication.decryptSkipReason)),m.ULS.sendTraceTag(17634565,301,10,"Error dialog status: {0}",p);const g=!!c&&Boolean.parse(c.text),h=k.getErrorCodeFromStatus(p);h===T.a.unexpectedDocDataResponse&&m.ULS.sendTraceTag(8462864,301,10,"Unknown docdata response. {0}",k.getUnexpectedDocDataResponse(e));let _=!1;if(h!==T.a.documentRejectedByGatekeeper&&h!==T.a.thresholdExceededForIncorrectPasswordAttempt||(_=!0),r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerPDFConverterFailureDownloadLinkEnabled")&&t.instance.isPdfMode&&s.a.documentType===CommonUiStrings.DocumentType_Pdf&&r.AFrameworkApplication.downloadACopyUrl&&("WorkerException"===p||"WorkerCrashed"===p||"WorkerHung"===p||"CantOpenDocument"===p))r.AFrameworkApplication.reportError(h),k._errorDlg||(k._errorDlg=new a(r.AFrameworkApplication.downloadACopyUrl));else{let e=s.a.formatSingleString(u);0;const t=s.a.formatSingleString(d);g?(m.ULS.sendTraceTag(507254818,301,10,"extraErrorHandling shouldn't be set",p),k.showErrorDialog(h,t,e,!1,_)):k.showErrorDialog(h,t,e,!1,_)}}static showErrorDialog(e,t,n,a=!1,i=!1,o=!1,s=!1){const{App:c}=k.AppInstance;c.instance.status=3,k._errorDlg||1!==c.get_activeAppFrame().state&&(k._errorDlg=new l.StandardDialog,k._errorDlg.hasCloseGlyph=r.AFrameworkApplication.isCloseable,new y(A.a.openInClient,v.a).waitForReady(((l,d)=>{let u=k.errorDialogOkHandler;const p=l.areReady()&&!i;o&&p?(k._errorDlg.buttonsOption=4,k._errorDlg.setButtonText(2,CommonUiStrings.DialogClose),k._errorDlg.setButtonText(1,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.EditInWord)),u=k.errorDialogOICOrDismissHandler):s&&p?(k._errorDlg.buttonsOption=4,k._errorDlg.setButtonText(1,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.OpenInWord)),k._errorDlg.setButtonText(2,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ToggleAccessibilityModeText)),u=k.errorDialogOICOrToggleViewModeHandler):r.AFrameworkApplication.isCloseable&&p?(k._errorDlg.buttonsOption=4,k._errorDlg.setButtonText(2,CommonUiStrings.DialogClose),k._errorDlg.setButtonText(1,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.EditInWord)),u=k.errorHandlerDialogHandler):p?(k._errorDlg.buttonsOption=0,k._errorDlg.setButtonText(1,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.EditInWord)),u=k.errorHandlerDialogHandler):s?(k._errorDlg.buttonsOption=0,k._errorDlg.setButtonText(1,WacWordviewerStringsManager.get(WacWordviewerStringsEnum.ToggleAccessibilityModeText)),u=k.errorDialogToggleToPngHandler):r.AFrameworkApplication.isCloseable?(k._errorDlg.buttonsOption=0,e!==T.a.thresholdExceededForIncorrectPasswordAttempt&&k._errorDlg.setButtonText(1,CommonUiStrings.DialogClose)):(k._errorDlg.hasCloseGlyph=!1,k._errorDlg.buttonsOption=5),e===T.a.documentIsEncrypted&&c.instance.isPdfMode&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerPDFDownloadInErrorDialogIsEnabled")&&k._errorDlg.addDownloadLink(CommonUiStrings.PdfConvertFailureDialogLinkSuggestion,r.AFrameworkApplication.downloadACopyUrl),k._errorDlg.showError(e,t,n,u,a)})))}static propagateError(e,t,n,a,i=null){if(i&&m.ULS.sendTraceTag(50960590,301,50,"PropagateError: [Status: {0}]",i),!r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApi"))return;const o={errorType:t,errorCode:n,message:a};e?r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReturnSuccessOnExpectedErrorIsEnabled")&&k.isExpectedError(i)?(m.ULS.sendTraceTag(50960591,301,15,"PropagateError: Reporting success for expected error.[Status: {0}]",i),k.postMessenger.reportAppCompleted(!0)):r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?k.postMessenger.sendMessageWithRetry("Wac_AppFailed",{Error:o}):k.postMessenger.sendAppFailedWithRetry(new b.a("Wac_AppFailed",{Error:o},(e=>k.postMessenger.sendAppFailedWithRetry(e)))):r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?k.postMessenger.sendErrorWithRetry({Error:o}):k.postMessenger.sendError({Error:o})}static isExpectedError(e){if(!e)return!1;switch(k.getErrorCodeFromStatus(e)){case T.a.documentIsIRMProtected:case T.a.documentCorrupt:case T.a.documentPasswordProtected:case T.a.documentIsEncrypted:case T.a.documentExportBlocked:return!0;default:return!1}}static isDocumentEncrypted(){const e=c.a.getHeaders();if(null!==e){const t=e["x-pass"];if(void 0!==t&&0!==t.length)return!0}return!1}static isDocumentProtected(){return r.AFrameworkApplication.protectedFile||r.AFrameworkApplication.protectFile}static errorHandlerDialogHandler(e,t){1===e?r.AFrameworkApplication.theActionManager.processActionWithData(A.a.openInClient,2,!0):k.errorDialogOkHandler(e,!1),k._errorDlg=null}static errorDialogOICOrDismissHandler(e,t){1===e?r.AFrameworkApplication.theActionManager.processActionWithData(A.a.openInClient,2,!0):k.errorDialogDismissHandler(),k._errorDlg=null}static errorDialogOICOrToggleViewModeHandler(e){1===e?r.AFrameworkApplication.theActionManager.processActionWithData(A.a.openInClient,2,!0):2===e&&r.AFrameworkApplication.theActionManager.processAction(A.a.toggleViewMode,2),k._errorDlg=null}static errorDialogToggleToPngHandler(e){1===e&&r.AFrameworkApplication.theActionManager.processAction(A.a.toggleViewMode,2),k._errorDlg=null}static handleCannotOpenAccessibleModeError(){const{App:e}=k.AppInstance;r.AFrameworkApplication.dismissSplashScreen(),e.reportFirstPageAndRenderTime(),r.AFrameworkApplication.reportDocumentLoadedTime(),this.postMessenger.reportAppCompleted(!0);const t=!r.AFrameworkApplication.trimOICButtons,n=WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DocumentProtectionSettingsAccessibleModeTitle),a=t?WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DocumentProtectionSettingsAccessibleModeOIC):WacWordviewerStringsManager.get(WacWordviewerStringsEnum.DocumentProtectionSettingsAccessibleModeSwitchToPng);k.showErrorDialog(T.a.documentExportBlocked,n,a,!0,!t,!1,!0),g.b("CannotOpenAccessibleModeErrorDialogShown",void 0,void 0,[{name:"isOpenInClientEnabled",bool:t}])}static errorDialogOkHandler(e,t){const{App:n}=k.AppInstance;n.get_activeAppFrame().ribbonUser&&n.get_activeAppFrame().ribbonUser.poll(),d.a.closeAppOnErrorWithFailoverToBlank(),n.get_activeAppFrame().workspace.dispose(),k._errorDlg=null}static errorDialogDismissHandler(){k._errorDlg.hide(),k._errorDlg=null}static getUnexpectedDocDataResponse(e){let t=null;if(e.documentElement)t=e.documentElement.outerHTML,t&&!t.length&&(t=e.documentElement.text);else try{t=h.c(e)}catch(n){t=e.toString()}return t}static getURLAndHeadersForRequest(e,t){return u.a.removeAccessTokensFromSource(e,t||c.a.getHeaders())}static logActivityForTriggeringFloodgateSurvey(e,t){const n=i.a.instance.resolveFuture(p.a);n?n.execute((n=>{n&&n.logActivity(e,t??null)})):m.ULS.sendTraceTag(505966854,301,15,`sif was null - unable to log ${e}`)}static triggerFloodgateSurveyForSwitchingToViewer(){E.a.IsPassFromWithinViewerAppParamEnabled&&!M.App.instance.fromWithinViewerApp&&k.logActivityForTriggeringFloodgateSurvey(M.App.instance.fromReadingView?"SwitchFromIROToReadingView":"SwitchFromEditToClassicViewer",null)}static getRefreshedQueryString(e){if(e&&r.AFrameworkApplication.accessToken&&r.AFrameworkApplication.accessTokenTtl)return e=u.a.addOrReplaceParameterValueInQueryParams(e,r.AFrameworkApplication.accessTokenParamName,r.AFrameworkApplication.accessToken),e=u.a.addOrReplaceParameterValueInQueryParams(e,r.AFrameworkApplication.accessTokenTtlParamName,r.AFrameworkApplication.accessTokenTtl.toString());m.ULS.sendTraceTag(505811423,301,10,"Invalid query string or access token")}}k._errorDlg=null,k._postMessenger=null,(0,a.a)(k,"Utils",null,[])},4965:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(3245),o=n(9800),r=n(1163);class s{static get cookieRefreshForSessionExpirationEnabled(){return null!=s.__cached_cookieRefreshForSessionExpirationEnabled_0_de8a6e64?s.__cached_cookieRefreshForSessionExpirationEnabled_0_de8a6e64:s.__cached_cookieRefreshForSessionExpirationEnabled_0_de8a6e64=i.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.CookieRefreshForSessionExpirationIsEnabled",!0)}static get disableAccessibleModeForProtectedDocs(){return null!=s.__cached_disableAccessibleModeForProtectedDocs_1_de8a6e64?s.__cached_disableAccessibleModeForProtectedDocs_1_de8a6e64:s.__cached_disableAccessibleModeForProtectedDocs_1_de8a6e64=i.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("DocDataHandlerEnableProtections")}static get hidePasswordParamFromRequestsIsEnabled(){return null!=s.__cached_hidePasswordParamFromRequestsIsEnabled_2_de8a6e64?s.__cached_hidePasswordParamFromRequestsIsEnabled_2_de8a6e64:s.__cached_hidePasswordParamFromRequestsIsEnabled_2_de8a6e64=i.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_9205595_RemoveXpassParamForPasswordProtectedDocInTeamsDesktop")}static get enablingOWLBasedPrintOnlyForTeamsDesktop(){return null!=s.__cached_enablingOWLBasedPrintOnlyForTeamsDesktop_3_de8a6e64?s.__cached_enablingOWLBasedPrintOnlyForTeamsDesktop_3_de8a6e64:s.__cached_enablingOWLBasedPrintOnlyForTeamsDesktop_3_de8a6e64=i.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.VSO_9281057_EnablingOWLBasedPrintOnlyForTeamsDesktop")}static get isPrintUsingOwlFlowEnabledForTeamsDesktopLikeScenario(){return null!=s.__cached_isPrintUsingOwlFlowEnabledForTeamsDesktopLikeScenario_4_de8a6e64?s.__cached_isPrintUsingOwlFlowEnabledForTeamsDesktopLikeScenario_4_de8a6e64:s.__cached_isPrintUsingOwlFlowEnabledForTeamsDesktopLikeScenario_4_de8a6e64=(o.a.logUniqueUsage("PrintRedirect-Treatment;PrintRedirect-Control"),i.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.isPrintRedirectEnabled",!1)&&(!s.enablingOWLBasedPrintOnlyForTeamsDesktop||r.a.isTeamsDesktop)&&!i.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("HostSupportDirectPrint"))}static get useReactPdf(){return null!=s.__cached_useReactPdf_5_de8a6e64?s.__cached_useReactPdf_5_de8a6e64:s.__cached_useReactPdf_5_de8a6e64=i.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("WordViewerReactPdfIsEnabled")}static get IsPassFromWithinViewerAppParamEnabled(){return null!=s.__cached_IsPassFromWithinViewerAppParamEnabled_6_de8a6e64?s.__cached_IsPassFromWithinViewerAppParamEnabled_6_de8a6e64:s.__cached_IsPassFromWithinViewerAppParamEnabled_6_de8a6e64=i.AFrameworkApplication.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_9658004_IsPassFromWithinViewerAppParamEnabled")}}(0,a.a)(s,"WordViewerSettings",null,[])},3911:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static getNameFromId(e){switch(e){case 146879195:return"AnimateScrollStarted";case 4038446671:return"BeforeAnimateScroll";case 3614810735:return"BeginSelection";case 940168130:return"BinaryConvert";case 3686078251:return"BroadcastOnScroll";case 2474762090:return"BrowserCopied";case 1041156544:return"BuildClipboard";case 2718896640:return"CommentDownloadCorrupt";case 3383614517:return"Copy";case 482496454:return"DirectPrintForPdfMode";case 3571000895:return"DocumentLoadFinished";case 3082914623:return"DoubleClickSelection";case 1485307652:return"DownloadAsPdf";case 1045098306:return"DownloadATranslatedCopy";case 1074370255:return"EndSelection";case 2719151194:return"FitHeight";case 2289035997:return"FitWidth";case 2268993336:return"HandleEscKeyDown";case 2376600552:return"HideAllPanes";case 2599343072:return"HideSearchPane";case 1925081555:return"LaunchImmersiveReader";case 1548165396:return"NextPage";case 716333338:return"NextSearchResult";case 3346400015:return"OnAppReady";case 2092285007:return"OnContainerResizeForSelection";case 1314702013:return"OnCurrentPageChange";case 1008943434:return"OnLabelPoll";case 2854499422:return"OnScroll";case 3006111724:return"OnZoomChange";case 1381613595:return"OpenAccessibleView";case 3588168074:return"OpenInClient";case 2947452783:return"OpenInWordViewer";case 3870085532:return"OpenSharedNotes";case 2936063169:return"PageCacheChanged";case 2491927299:return"PageSetResized";case 2589737880:return"PopulateContextMenu";case 1568572584:return"PopulateZoomFlyout";case 3940382077:return"PreventWarningsOnAppClose";case 1693292334:return"PreviousSearchResult";case 3537571872:return"PrevPage";case 1480533506:return"PrintAccessibilityDocument";case 3321901940:return"PrintDocument";case 127034278:return"PrintXml";case 310212246:return"QueryAccessibleModeButtonToggledState";case 1122736542:return"QueryCurrentPageLabel";case 936755515:return"QueryPresenterPageLabel";case 1289223352:return"QueryToggleSearchPane";case 495441999:return"QueryZoomLevel";case 433063458:return"QueryZoomText";case 2918606216:return"RebuildCommentHints";case 3838916066:return"RebuildCommentHintsWithoutAnimation";case 702693766:return"RepositionScroller";case 2778760596:return"RepositionScrollerWithoutAnimation";case 569132212:return"ResizeCache";case 541818074:return"ResizeCacheWithoutAnimation";case 2385100972:return"ResizeScroller";case 662384170:return"ResizeScrollerWithoutAnimation";case 2866603464:return"SaveAndEditATranslatedCopy";case 3456074588:return"ScrollDownArrow";case 135979168:return"ScrollEnd";case 3369669304:return"ScrollHome";case 340039443:return"ScrollLeftArrow";case 2180939724:return"ScrollPageDown";case 1783913247:return"ScrollPageUp";case 4117423060:return"ScrollRightArrow";case 3073381345:return"ScrollUpArrow";case 1297807363:return"SelectFromScroll";case 3828858224:return"SetCurrentPage";case 231667503:return"SetZoomLevel";case 3458683028:return"ShowContextMenuFromKey";case 2802067523:return"ShowContextMenuInDocument";case 1725824390:return"ShowFileEmbedInfo";case 3402718245:return"ShowPdfConvertAndEditDialog";case 4205256019:return"ShowPdfCopyAndEditDialog";case 2893474578:return"ShowReembedCode";case 428795035:return"ShowSearchPane";case 2666100903:return"SLPageReady";case 4125937875:return"StatusBarTest";case 329275380:return"SwitchToEditMode";case 1254572192:return"SwitchToUnifiedReadMode";case 3349150556:return"SyncToPresenter";case 2281051331:return"ToggleCommentPane";case 583433745:return"ToggleMenu";case 976411380:return"ToggleSearchPane";case 2680748364:return"ToggleViewMode";case 573791575:return"TranslateBackToOriginal";case 2612243365:return"TranslateDocument";case 3917526816:return"UpdateCommentHighlight";case 851844167:return"UpdateSearchHighlight";case 2195537549:return"UpdateSelection";case 3850825085:return"UpdateZoomOnWindowResize";case 779228655:return"XmlPageDownloaded";case 4224281129:return"XmlPageDownloaded2";case 1495397774:return"XmlPageDownloaded3";case 1281912385:return"ZoomToNextLevel"}return null}}i.animateScrollStarted=146879195,i.beforeAnimateScroll=4038446671,i.beginSelection=3614810735,i.binaryConvert=940168130,i.broadcastOnScroll=3686078251,i.browserCopied=2474762090,i.buildClipboard=1041156544,i.commentDownloadCorrupt=2718896640,i.copy=3383614517,i.directPrintForPdfMode=482496454,i.documentLoadFinished=3571000895,i.doubleClickSelection=3082914623,i.downloadAsPdf=1485307652,i.downloadATranslatedCopy=1045098306,i.endSelection=1074370255,i.fitHeight=2719151194,i.fitWidth=2289035997,i.handleEscKeyDown=2268993336,i.hideAllPanes=2376600552,i.hideSearchPane=2599343072,i.launchImmersiveReader=1925081555,i.nextPage=1548165396,i.nextSearchResult=716333338,i.onAppReady=3346400015,i.onContainerResizeForSelection=2092285007,i.onCurrentPageChange=1314702013,i.onLabelPoll=1008943434,i.onScroll=2854499422,i.onZoomChange=3006111724,i.openAccessibleView=1381613595,i.openInClient=3588168074,i.openInWordViewer=2947452783,i.openSharedNotes=3870085532,i.pageCacheChanged=2936063169,i.pageSetResized=2491927299,i.populateContextMenu=2589737880,i.populateZoomFlyout=1568572584,i.preventWarningsOnAppClose=3940382077,i.previousSearchResult=1693292334,i.prevPage=3537571872,i.printAccessibilityDocument=1480533506,i.printDocument=3321901940,i.printXml=127034278,i.queryAccessibleModeButtonToggledState=310212246,i.queryCurrentPageLabel=1122736542,i.queryPresenterPageLabel=936755515,i.queryToggleSearchPane=1289223352,i.queryZoomLevel=495441999,i.queryZoomText=433063458,i.rebuildCommentHints=2918606216,i.rebuildCommentHintsWithoutAnimation=3838916066,i.repositionScroller=702693766,i.repositionScrollerWithoutAnimation=2778760596,i.resizeCache=569132212,i.resizeCacheWithoutAnimation=541818074,i.resizeScroller=2385100972,i.resizeScrollerWithoutAnimation=662384170,i.saveAndEditATranslatedCopy=2866603464,i.scrollDownArrow=3456074588,i.scrollEnd=135979168,i.scrollHome=3369669304,i.scrollLeftArrow=340039443,i.scrollPageDown=2180939724,i.scrollPageUp=1783913247,i.scrollRightArrow=4117423060,i.scrollUpArrow=3073381345,i.selectFromScroll=1297807363,i.setCurrentPage=3828858224,i.setZoomLevel=231667503,i.showContextMenuFromKey=3458683028,i.showContextMenuInDocument=2802067523,i.showFileEmbedInfo=1725824390,i.showPdfConvertAndEditDialog=3402718245,i.showPdfCopyAndEditDialog=4205256019,i.showReembedCode=2893474578,i.showSearchPane=428795035,i.sLPageReady=2666100903,i.statusBarTest=4125937875,i.switchToEditMode=329275380,i.switchToUnifiedReadMode=1254572192,i.syncToPresenter=3349150556,i.toggleCommentPane=2281051331,i.toggleMenu=583433745,i.toggleSearchPane=976411380,i.toggleViewMode=2680748364,i.translateBackToOriginal=573791575,i.translateDocument=2612243365,i.updateCommentHighlight=3917526816,i.updateSearchHighlight=851844167,i.updateSelection=2195537549,i.updateZoomOnWindowResize=3850825085,i.xmlPageDownloaded=779228655,i.xmlPageDownloaded2=4224281129,i.xmlPageDownloaded3=1495397774,i.zoomToNextLevel=1281912385,(0,a.a)(i,"Commands",null,[])},9838:function(e,t,n){"use strict";n.d(t,{a:function(){return i},b:function(){return o}});let a={};function i(){if(!a)throw new Error("Session config instance not found");return a}function o(e){a=e}},3323:function(e,t,n){"use strict";n.d(t,{a:function(){return f}});var a=n(100),i=n(3245),o=n(4361),r=n(1313),s=n(680),l=n(3792);const c=(0,l.b)("CommonUI.IBusinessBarEntryFactory");var d=n(3949),u=n(1057),p=n(7296),g=n(3696),h=n(9611),m=n(988),_=n(8103);class S{get businessBar(){return this._businessBar||(this._businessBar=(0,l.j)(d.a))}get businessBarEntryFactory(){return this._businessBarEntryFactory||(this._businessBarEntryFactory=(0,l.j)(c))}verifyAuthentication(){this._signoutResponse.isAuthenticated||this.onAuthenticationLost()}registerActions(e,t){const n=i.AFrameworkApplication.theActionManager;n.addActionWithFlags(m.a.authenticationLost,h.a.frame,e,96),n.addActionWithFlags(m.a.authenticationRestored,h.a.frame,t,96),n.addAction(m.a.cancelSigninBusinessBar,h.a.frame,u.ActionManager.doNothingHandler),n.addAction(m.a.cancelSigninDialog,h.a.frame,u.ActionManager.doNothingHandler),n.addAction(m.a.launchSigninWindow,h.a.frame,u.ActionManager.doNothingHandler)}onAuthenticationLost(){this.showDialog((0,_.a)("AuthenticationLostMessage")),i.AFrameworkApplication.theActionManager.processAction(m.a.authenticationLost,2)}onAuthenticationRestored(){this.teardownUI(),i.AFrameworkApplication.theActionManager.processAction(m.a.authenticationRestored,2)}teardownUI(){this._dialog&&(this._dialog.hide(),this._dialog.dispose(),this._dialog=null),this._businessBarEntry&&this.businessBar&&(i.AFrameworkApplication.isShuttingDown||this.businessBar.removeEntry(this._businessBarEntry),this._businessBarEntry.dispose(),this._businessBarEntry=null)}showDialog(e){s.a.safeDispose(this._dialog),this._dialog=new g.StandardDialog,this._showCloseButton||(this._dialog.hasCloseGlyph=!1,this._dialog.buttonsOption=0),this._dialog.setButtonText(1,(0,_.a)("SignIn")),this._dialog.showWarning((0,_.a)("DefaultDialogTitle"),e,this.dialogHandler)}showBusinessBar(){this.businessBar&&this.businessBarEntryFactory&&(this._businessBarEntry=this.businessBarEntryFactory.create((0,_.a)("AuthenticationLostTitle"),(0,_.a)("AuthenticationLostMessage"),null),this._businessBarEntry.closeable=!0,this._businessBarEntry.addButton((0,_.a)("SignIn"),S.businessBarButtonHandler,""),this._businessBarEntry.closeHandler=this.businessBarEntryCloseHandler,this.businessBar.addEntry(this._businessBarEntry,!1))}disableTask(){this._task&&(i.AFrameworkApplication.theTaskManager.deleteTask(this._task),this._task=null)}dispose(){this._businessBarEntry=null,this._dialog=null,this._task=null}static businessBarButtonHandler(e){r.a.performSignIn(),i.AFrameworkApplication.theActionManager.processAction(m.a.launchSigninWindow,2)}constructor(e,t,n,a){this._businessBarEntry=null,this._dialog=null,this._task=null,this._businessBar=null,this._businessBarEntryFactory=null,this.authenticationCheckTask=e=>{this._signoutResponse.authenticationCheck()},this.dialogHandler=(e,t)=>{1===e?(r.a.performSignIn(),this.showDialog((0,_.a)("AuthenticationLostSigninInProgressMessage")),i.AFrameworkApplication.theActionManager.processAction(m.a.launchSigninWindow,2)):(this.showBusinessBar(),i.AFrameworkApplication.theActionManager.processAction(m.a.cancelSigninDialog,2))},this.businessBarEntryCloseHandler=e=>{this.disableTask(),i.AFrameworkApplication.theActionManager.processAction(m.a.cancelSigninBusinessBar,2)},this._signoutResponse=e,this._showCloseButton=a,this._signoutResponse.isAuthenticated&&(this._task=new p.a(3,2,5e3,this.authenticationCheckTask,2),i.AFrameworkApplication.theTaskManager.addTask(this._task),this.registerActions(t,n)),this._signoutResponse.add_authenticationLost(((e,t)=>{this.onAuthenticationLost()})),this._signoutResponse.add_authenticationRestored(((e,t)=>{this.onAuthenticationRestored()}))}}(0,a.a)(S,"SignOutResponseUI",null,[11]);class f{get name(){return"Common.App.UI"}configure(e){}async initializeAsync(){}dispose(){s.a.safeDispose(f._signOutResponse),f._signOutResponse=null}static main(){o.a.instance.registerAsyncPackage(new f)}static initSignOutResponseUI(e,t,n,a){f.shouldUseSignoutResponseUI(e)&&(f._signOutResponse=new S(r.a.instance,t,n,a))}static shouldUseSignoutResponseUI(e){return i.AFrameworkApplication.needsSignOutChecking&&!i.AFrameworkApplication.isEmbedded}}f._signOutResponse=null,(0,a.a)(f,"CommonAppUIPackage",null,[24,1])},8054:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(5149);class o{constructor(){this.ScreenWidth=0,this.ScreenHeight=0,this.WinInnerWidth=0,this.WinInnerHeight=0,this.WinOuterHeight=0,this.WinOuterWidth=0,this.WinDevicePixelRatio=0,this.CalculatedDevicePixelRatio=0,this.ScreenDeviceXdpi=0,this.ScreenDeviceYdpi=0,this.ScreenLogicalXdpi=0,this.ScreenLogicalYdpi=0,this.ScreenAvailHeight=0,this.ScreenAvailWidth=0,this.DocElemOffsetWidth=0,this.DocElemOffsetHeight=0,this.DocElemClientWidth=0,this.DocElemClientHeight=0,this.WinOrientation=0,this.SupportsTouch=!1,this.NavPlugins=null,this.NavUserAgent=null,this.NavPlatform=null,this.NavAppName=null,this.NavAppVersion=null,this.NavLanguage=null,this.Error=null}}(0,a.a)(o,"BrowserInfo",null,[]);class r{constructor(){this.Name=null,this.Version=null}}(0,a.a)(r,"PluginInfo",null,[]);var s=n(3245),l=n(1163);class c{static logInfo(){if(!s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogBrowserInfoIsEnabled"))return void i.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off");const e=c.gatherAllInfo();try{const t=JSON.stringify(e);i.ULS.sendTraceTag(6903563,102,50,t)}catch(e){i.ULS.sendTraceTag(6903564,102,15,e.message)}}static getPlugins(){const e=window.navigator.plugins;if(!e||!e.length)return null;const t=new Array(0);for(let n=0;n<e.length;n++){const a=e[n].name,i=e[n].version;Array.add(t,Object.assign(new r,{Name:a,Version:i}))}return t}static gatherAllInfo(){const e=new o,t=new Sys.StringBuilder;return c.getInfoOrLogError((t=>{e.DocElemClientHeight=t}),(()=>document.documentElement.clientHeight),t),c.getInfoOrLogError((t=>{e.DocElemClientWidth=t}),(()=>document.documentElement.clientWidth),t),c.getInfoOrLogError((t=>{e.DocElemOffsetHeight=t}),(()=>document.documentElement.offsetHeight),t),c.getInfoOrLogError((t=>{e.DocElemOffsetWidth=t}),(()=>document.documentElement.offsetWidth),t),c.getInfoOrLogError((t=>{e.ScreenAvailHeight=t}),(()=>window.screen.availHeight),t),c.getInfoOrLogError((t=>{e.ScreenAvailWidth=t}),(()=>window.screen.availWidth),t),c.getInfoOrLogError((t=>{e.ScreenWidth=t}),(()=>window.screen.width),t),c.getInfoOrLogError((t=>{e.ScreenHeight=t}),(()=>window.screen.height),t),c.getInfoOrLogError((t=>{e.ScreenLogicalXdpi=t}),(()=>window.screen.logicalXDPI),t),c.getInfoOrLogError((t=>{e.ScreenLogicalYdpi=t}),(()=>window.screen.logicalYDPI),t),c.getInfoOrLogError((t=>{e.ScreenDeviceXdpi=t}),(()=>window.screen.deviceXDPI),t),c.getInfoOrLogError((t=>{e.ScreenDeviceYdpi=t}),(()=>window.screen.deviceYDPI),t),c.getInfoOrLogError((t=>{e.WinInnerHeight=t}),(()=>window.self.innerHeight),t),c.getInfoOrLogError((t=>{e.WinInnerWidth=t}),(()=>window.self.innerWidth),t),c.getInfoOrLogError((t=>{e.WinOuterHeight=t}),(()=>window.self.outerHeight),t),c.getInfoOrLogError((t=>{e.WinOuterWidth=t}),(()=>window.self.outerWidth),t),c.getInfoOrLogError((t=>{e.WinOrientation=t}),(()=>window.self.orientation),t),c.getInfoOrLogError((t=>{e.WinDevicePixelRatio=t}),(()=>window.self.devicePixelRatio),t),c.getInfoOrLogError((t=>{e.SupportsTouch=t}),(()=>l.a.supportsTouch),t),c.getInfoOrLogError((t=>{e.NavAppName=t}),(()=>window.navigator.appName),t),c.getInfoOrLogError((t=>{e.NavAppVersion=t}),(()=>window.navigator.appVersion),t),c.getInfoOrLogError((t=>{e.NavLanguage=t}),(()=>window.navigator.browserLanguage||window.navigator.language),t),c.getInfoOrLogError((t=>{e.NavUserAgent=t}),(()=>window.navigator.userAgent),t),c.getInfoOrLogError((t=>{e.NavPlatform=t}),(()=>window.navigator.platform),t),c.getInfoOrLogError((t=>{e.CalculatedDevicePixelRatio=t}),(()=>c.devicePixelRatio),t),e.Error=t.toString(),e}static get devicePixelRatio(){const e=window.devicePixelRatio;return isNaN(e)?window.screen.deviceXDPI/window.screen.logicalXDPI:e}static getInfoOrLogError(e,t,n){try{e(t())}catch(e){n.isEmpty()||n.append(" | "),n.append(e.message||"null")}}}(0,a.a)(c,"BrowserInfoLogger",null,[])},9267:function(e,t,n){"use strict";n.d(t,{a:function(){return A}});var a=n(100),i=n(5149),o=n(625),r=n(3245),s=n(385),l=n(5374),c=n(6012),d=n(5072),u=n(6534),p=n(5434),g=n(6101);class h{constructor(){this.message=null,this.messageTitle=null,this.firstActionButtonProps=null,this.secondActionButtonProps=null,this.isMultiline=!1,this.messageBarType=0,this.closeable=!1,this.onDismiss=null,this.dismissButtonAriaLabel=null,this.linkProps=null,this.secondaryLinkProps=null,this.messageBarIconProps=null,this.giveFeedbackIconButtonProps=null}}(0,a.a)(h,"MessageBarProps",null,[]);class m{constructor(e,t){this.type=null,this.label=null,this.onExecute=null,this.label=e,this.type="AppButtonProps",this.onExecute=t}}(0,a.a)(m,"AppButtonProps",null,[]);var _=n(1307),S=n(7072),f=n(1509),C=n(988),y=n(8103);class A{get htmlElement(){return this._htmlElement}get buttonOne(){return{used:this._buttonOneUsed,text:this._buttonOneText,handler:this._buttonOneHandler,dismissesEntry:this._buttonOneDismissesEntry,screenReaderText:this._buttonOneScreenReaderText}}get buttonTwo(){return{used:this._buttonTwoUsed,text:this._buttonTwoText,handler:this._buttonTwoHandler,dismissesEntry:this._buttonTwoDismissesEntry,screenReaderText:this._buttonTwoScreenReaderText}}get isMultiLine(){return this._isMultiLine}set isMultiLine(e){this._isMultiLine=e}get barType(){return this._barType}set barType(e){this._barType=e}get title(){return this._title}set title(e){this._title!==e&&(this._title=e,this._titleParagraph&&(this._titleParagraph.innerText=this._title))}get message(){return this._message}set message(e){this._message!==e&&(this._message=e,this._bodyParagraph&&(this._bodyParagraph.innerText=this._message))}get image(){return this._image}set image(e){this._image=e,4!==this._image&&(this.imagePath="")}get imageAltText(){return this._imageAltText}set imageAltText(e){this._imageAltText=e}get closeable(){return this._closeable}set closeable(e){this._closeable!==e&&(this._closeable=e,this._closeIconHolder&&(this._closeIconHolder.style.display=this._closeable?"table-cell":"none"))}get reactBusinessBarIsEnabled(){return r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactBusinessBarIsEnabled")}get vNextStylesEnabled(){return r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Fluent2StyleIsEnabled")}get invokeActionIsContextMenu(){return this._invokeWithContextMenu}set invokeActionIsContextMenu(e){this._invokeWithContextMenu=e,this.htmlElement&&(this._invokeWithContextMenu&&!this._isContextMenuHandlerSet?(r.AFrameworkApplication.activeFrame.theContextMenuInputManager.registerHandler(this.htmlElement,(0,o.a)(this,this.onClick,"onClick"),null),this._isContextMenuHandlerSet=!0):!this._invokeWithContextMenu&&this._isContextMenuHandlerSet&&(r.AFrameworkApplication.activeFrame.theContextMenuInputManager.unregisterHandler(this.htmlElement,(0,o.a)(this,this.onClick,"onClick")),this._isContextMenuHandlerSet=!1))}get getPointForContextMenu(){const e=Sys.UI.DomElement.getBounds(this.htmlElement);return new Sys.UI.Point(e.x,e.y)}addButton(e,t,n,a=!1){this._buttonOneText=e,this._buttonOneHandler=t,this._buttonOneUsed=!0,this._buttonOneScreenReaderText=n,this._buttonOneDismissesEntry=a}addSecondButton(e,t,n,a=!1){this._buttonTwoText=e,this._buttonTwoHandler=t,this._buttonTwoUsed=!0,this._buttonTwoScreenReaderText=n,this._buttonTwoDismissesEntry=a}addLink(e,t){this._linkText=e,this._linkHref=t,this._linkUsed=!0}addLinkWithHandler(e,t){this._linkText=e,this._linkHandler=t,this._linkUsed=!0}createReactEntryElement(){const e=this.vNextStylesEnabled;this._htmlElement=document.createElement("div"),this.htmlElement.className=String.format("{0} {1} {2}",A._businessBarClass,A._reactBusinessBarClass,e?A._vNextBusinessBarClass:""),this.htmlElement.setAttribute("UNSELECTABLE","on"),void 0!==this.containerID&&null!==this.containerID&&(this.htmlElement.id=this.containerID);const t=()=>{_.a.getMessageBarAPIAsync().then((e=>{this.businessBar.isReactBusinessBarStoreInitialized||(e.initializeMessageBarInStore(),this.businessBar.isReactBusinessBarStoreInitialized=!0);const t=Object.assign(new h,{message:this._message,messageTitle:this._title,isMultiline:this._isMultiLine,messageBarType:this._barType});if(this._closeable){t.closeable=!0;let e=this._message+". "+(0,y.a)("DialogClose");this._title&&(e=this._title+". "+e),t.dismissButtonAriaLabel=e,t.onDismiss=()=>{this.closeReactBusinessBar(this)}}if(4===this._image&&(t.messageBarIconProps={iconName:this.imagePath}),this._linkUsed&&(t.linkProps={type:"AppLinkProps",text:this._linkText,handler:{href:this._linkHref,target:"_blank"}},this._linkHandler)){const e=this.onMessageBarLinkClicked;t.linkProps.handler=e}return this._buttonOneUsed&&(t.firstActionButtonProps=new m(this._buttonOneText,(()=>{this.buttonOneReactClickHandler(this)}))),this._buttonTwoUsed&&(t.secondActionButtonProps=new m(this._buttonTwoText,(()=>{this.buttonTwoReactClickHandler(this)}))),e.createNewMessageBarWithCallback?e.createNewMessageBarWithCallback(this.htmlElement,t,(()=>{r.AFrameworkApplication.activeFrame.notifyResize()})):e.createNewMessageBar(this.htmlElement,t),this._reactMessageBarAPI=e,null})).catch((e=>(i.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API"),null)))};return s.a.get_instance().isCompleted(7)?t():s.a.get_instance().executeWhen(7,t),this.invokeHandler&&(r.AFrameworkApplication.activeFrame.theClickInputManager.registerHandler(c.a.click,this.htmlElement,(0,o.a)(this,this.onClick,"onClick")),r.AFrameworkApplication.activeFrame.theKeyInputManager.registerHandlerWithData(c.a.keyUp,this.htmlElement,this.onBodyKeyUp,this),this._invokeWithContextMenu&&!this._isContextMenuHandlerSet&&(r.AFrameworkApplication.activeFrame.theContextMenuInputManager.registerHandler(this.htmlElement,(0,o.a)(this,this.onClick,"onClick"),null),this._isContextMenuHandlerSet=!0)),this.htmlElement}setReactEntryBackgroundColor(){if(!g.a("getTheme"))return void i.ULS.sendTraceTag(528597013,324,15,"AppChrome API is not ready when setting entry element background color");const e=appChrome.api.getTheme().semanticColors;let t;switch(this._barType){case 1:case 2:t=e.errorBackground.toString();break;case 3:t=e.blockingBackground.toString();break;case 4:t=e.successBackground.toString();break;case 5:t=e.warningBackground.toString();break;default:t=e.infoBackground.toString()}this.htmlElement.style.backgroundColor=t}createElement(){if(this.reactBusinessBarIsEnabled)return this.createReactEntryElement();if(this._htmlElement=document.createElement("div"),this.htmlElement.className=A._businessBarClass,this.htmlElement.setAttribute("UNSELECTABLE","on"),void 0!==this.containerID&&null!==this.containerID&&(this.htmlElement.id=this.containerID),this._imageHolder=null,0!==this._image){this._imageHolder=document.createElement("span"),this._imageHolder.className="WACBusinessBarIcon",this.htmlElement.appendChild(this._imageHolder);let e=null,t=null;switch(this._image){case 2:e=A._errorIconName,t=(0,y.a)("DialogError");break;case 1:e=A._warningIconName,t=(0,y.a)("DialogWarning");break;case 3:e=A._infoIconName,t=(0,y.a)("DialogInfo");break;case 4:e=this.imagePath,t=this._imageAltText}this._imageHolder.title=t,this._imageHolder.setAttribute(S.a.ariaRoleAttribute,S.a.ariaImageRole),this._imageHolder.appendChild(l.a(24,24,e,A._imageClass,!0,""))}const e=f.a.create().toString();this._titleAndBodyHolder=document.createElement("div"),this._titleAndBodyHolder.id="BBTitleAndBody"+e,this._titleAndBodyHolder.className=A._businessBarTitleBodyHolderClass,this._titleAndBodyHolder.tabIndex=0,this._title&&(this._titleParagraph=document.createElement("p"),this._titleParagraph.innerText=this._title,this._titleParagraph.className=A._businessBarTitleClass+" UIFontBold",this._titleParagraph.id="BBTitle"+e,this._titleParagraph.setAttribute("UNSELECTABLE","on"),this._titleAndBodyHolder.setAttribute(S.a.ariaLabelledByAttribute,this._titleParagraph.id),this._titleAndBodyHolder.appendChild(this._titleParagraph)),this._bodyParagraph=document.createElement("p"),this._bodyParagraph.className=A._businessBarBodyClass,this._bodyParagraph.innerText=this._message,this._bodyParagraph.id="BBBody"+e,this._bodyParagraph.setAttribute("UNSELECTABLE","on"),this._bodyParagraph.style.width="100%",this._titleAndBodyHolder.setAttribute(S.a.ariaDescribedByAttribute,this._bodyParagraph.id),this._buttonOneUsed&&this.addContentAvailableOnlyToScreenReader(this._bodyParagraph,this._buttonOneScreenReaderText),this._buttonTwoUsed&&this.addContentAvailableOnlyToScreenReader(this._bodyParagraph,this._buttonTwoScreenReaderText),this._titleAndBodyHolder.appendChild(this._bodyParagraph);const t=document.createElement("div");return t.setAttribute(S.a.ariaRoleAttribute,S.a.ariaAlertRole),t.appendChild(this._titleAndBodyHolder),this.htmlElement.appendChild(t),this._buttonOneUsed&&(this._buttonOneHolder=document.createElement("span"),this._buttonOne=document.createElement("button"),this.createButton(this._buttonOneHolder,this._buttonOne,this._buttonOneText,this.buttonOneClickHandler)),this._buttonTwoUsed&&(this._buttonTwoHolder=document.createElement("span"),this._buttonTwo=document.createElement("button"),this.createButton(this._buttonTwoHolder,this._buttonTwo,this._buttonTwoText,this.buttonTwoClickHandler)),this._linkUsed&&(this._linkHolder=document.createElement("span"),this._linkHolder.className=A._businessBarLinkHolderClass,this._link=document.createElement("a"),this._link.className="WACBusinessBarLink",this._link.innerText=this._linkText,this._linkHandler?(this._link.tabIndex=0,r.AFrameworkApplication.activeFrame.theClickInputManager.registerHandlerWithData(c.a.click,this._link,this.linkClickHandler,this),r.AFrameworkApplication.activeFrame.theKeyInputManager.registerHandlerWithData(c.a.keyUp,this._link,this.onLinkKeyUp,this)):(this._link.href=this._linkHref,this._link.target="_blank"),this._linkHolder.appendChild(this._link),this.htmlElement.appendChild(this._linkHolder)),r.AFrameworkApplication.activeFrame.theClickInputManager.registerHandler(c.a.click,this.htmlElement,(0,o.a)(this,this.onClick,"onClick")),r.AFrameworkApplication.activeFrame.theKeyInputManager.registerHandlerWithData(c.a.keyUp,this._titleAndBodyHolder,this.onBodyKeyUp,this),this._invokeWithContextMenu&&!this._isContextMenuHandlerSet&&(r.AFrameworkApplication.activeFrame.theContextMenuInputManager.registerHandler(this.htmlElement,(0,o.a)(this,this.onClick,"onClick"),null),this._isContextMenuHandlerSet=!0),this._closeable&&(this._closeIconHolder=document.createElement("span"),this._closeIconHolder.className=A._closeHolderClass,this._closeAnchor=document.createElement("a"),this._closeAnchor.className=A._closeIconClass,this._closeAnchor.tabIndex=0,this._closeAnchor.title=(0,y.a)("DialogClose"),this._closeAnchor.setAttribute(S.a.ariaRoleAttribute,S.a.ariaButtonRole),this._closeIconElement=l.a(16,16,A._closeIconFileName,"",!0,""),this._closeAnchor.appendChild(this._closeIconElement),this._closeIconHolder.style.display="table-cell",this._closeIconHolder.appendChild(this._closeAnchor),this.htmlElement.appendChild(this._closeIconHolder),r.AFrameworkApplication.activeFrame.theClickInputManager.registerHandlerWithData(c.a.click,this._closeAnchor,(0,o.a)(this,this.onCloseClick,"onCloseClick"),this),r.AFrameworkApplication.activeFrame.theKeyInputManager.registerHandlerWithData(c.a.keyUp,this._closeAnchor,(0,o.a)(this,this.onCloseKeyUp,"onCloseKeyUp"),this)),this.htmlElement}showEntryForScreenReader(){this._titleAndBodyHolder&&this._titleAndBodyHolder.setAttribute(S.a.ariaHiddenAttribute,S.a.ariaFalseValue)}addContentAvailableOnlyToScreenReader(e,t){if(!t||""===t)return;const n=document.createElement("span");n.className=A._screenReaderOnlyClass,n.innerText=t,e.appendChild(n)}createButton(e,t,n,a){e.className=A._businessBarButtonHolderClass,t.setAttribute("type","button"),t.className=A._businessBarButtonClass,t.innerText=n,e.appendChild(t),this.htmlElement.appendChild(e),r.AFrameworkApplication.activeFrame.theClickInputManager.registerHandlerWithData(c.a.click,t,a,this)}resizeToFit(){if(this.reactBusinessBarIsEnabled)return;this._titleAndBodyHolder.style.whiteSpace="nowrap",this.closeable?this._closeIconHolder.style.width="auto":this._linkUsed?this._linkHolder.style.width="auto":this._buttonTwoUsed?this._buttonTwoHolder.style.width="auto":this._buttonOneUsed?this._buttonOneHolder.style.width="auto":this._titleAndBodyHolder.style.width="auto";this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this._titleAndBodyHolder.style.whiteSpace="normal":this.closeable?this._closeIconHolder.style.width="100%":this._linkUsed?this._linkHolder.style.width="100%":this._buttonTwoUsed?this._buttonTwoHolder.style.width="100%":this._buttonOneUsed?this._buttonOneHolder.style.width="100%":this._titleAndBodyHolder.style.width="100%"}ulsLogTelemetryInfo(e,t){if(!p.a.oldActionsPipelineIsEnabled())return;const n={};n.WacSessionId=r.AFrameworkApplication.userSessionId,n.ActionName="BusinessBar"+e,n.InputMethod=t,i.ULS.sendTraceTag(35489761,207,50,JSON.stringify(n))}logTelemetryInfo(e,t,n,a){this.ulsLogTelemetryInfo(e,n),p.a.isUserActionLoggingToOtelEnabled()&&u.d(t,!0,u.e,a,10)}buttonOneReactClickHandler(e){return this._buttonOneHandler(e),this.logTelemetryInfo("ButtonOne",C.a.businessBarButtonOne,"Mouse",2),this._buttonOneDismissesEntry&&(this.logTelemetryInfo("Close",C.a.businessBarClose,"Mouse_ButtonOne",2),this.closeReactBusinessBar(e)),!0}buttonTwoReactClickHandler(e){return this._buttonTwoHandler(e),this.logTelemetryInfo("ButtonTwo",C.a.businessBarButtonTwo,"Mouse",2),this._buttonTwoDismissesEntry&&(this.logTelemetryInfo("Close",C.a.businessBarClose,"Mouse_ButtonTwo",2),this.closeReactBusinessBar(e)),!0}dispose(){this.htmlElement&&(r.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(c.a.click,this.htmlElement,(0,o.a)(this,this.onClick,"onClick")),this._isContextMenuHandlerSet&&r.AFrameworkApplication.activeFrame.theContextMenuInputManager.unregisterHandler(this.htmlElement,(0,o.a)(this,this.onClick,"onClick"))),this._closeAnchor&&(r.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(c.a.click,this._closeAnchor,(0,o.a)(this,this.onCloseClick,"onCloseClick")),r.AFrameworkApplication.activeFrame.theKeyInputManager.unregisterHandler(c.a.keyUp,this._closeAnchor,(0,o.a)(this,this.onCloseKeyUp,"onCloseKeyUp"))),this._buttonOne&&r.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(c.a.click,this._buttonOne,this.buttonOneClickHandler),this._buttonTwo&&r.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(c.a.click,this._buttonTwo,this.buttonTwoClickHandler),this._link&&this._linkHandler&&(r.AFrameworkApplication.activeFrame.theClickInputManager.unregisterHandler(c.a.click,this._link,this.linkClickHandler),r.AFrameworkApplication.activeFrame.theKeyInputManager.unregisterHandler(c.a.keyUp,this._link,this.onLinkKeyUp)),this._titleAndBodyHolder&&r.AFrameworkApplication.activeFrame.theKeyInputManager.unregisterHandler(c.a.keyUp,this._titleAndBodyHolder,this.onBodyKeyUp),this._imageAltText=null,this._imageHolder=null,this._titleParagraph=null,this._htmlElement=null,this._bodyParagraph=null,this._titleAndBodyHolder=null,this._buttonOne=null,this._buttonOneHolder=null,this._buttonTwo=null,this._buttonTwoHolder=null,this._link=null,this._linkHolder=null,this._closeIconElement=null,this._closeIconHolder=null,this._closeAnchor=null,this.businessBar=null}onClick(e){return this.logTelemetryInfo("Invoke",C.a.businessBarInvoke,"Mouse",2),!!this.invokeHandler&&this.invokeHandler(this,e)}onCloseClick(e){return this.logTelemetryInfo("Close",C.a.businessBarClose,"Mouse",2),this.close(e),!0}onCloseKeyUp(e){return e.innerEvent.keyCode===d.a.vK_Enter&&!e.innerEvent.altKey&&(this.logTelemetryInfo("Close",C.a.businessBarClose,"Keyboard",1),this.close(e),!0)}close(e){const t=e.userData;this.businessBar.removeEntry(t),this.invokeCloseHandler(t,e.inputSource)}invokeCloseHandler(e,t){if(e.closeHandler){const n=r.AFrameworkApplication.theActionManager;n.commandLocation=10,n.invocationMethod=t,e.closeHandler(e),n.commandLocation=0,n.invocationMethod=0}}closeReactBusinessBar(e){e&&this.businessBar&&(this.businessBar.removeEntry(e),this.invokeCloseHandler(e,0))}constructor(e,t,n){this._title=null,this._message=null,this._closeable=!1,this._isMultiLine=!1,this._barType=0,this._imageAltText="",this._image=0,this._imageHolder=null,this._titleParagraph=null,this._bodyParagraph=null,this._titleAndBodyHolder=null,this._buttonOne=null,this._buttonOneHolder=null,this._buttonTwo=null,this._buttonTwoHolder=null,this._linkHolder=null,this._link=null,this._closeIconHolder=null,this._closeAnchor=null,this._closeIconElement=null,this._buttonOneUsed=!1,this._buttonTwoUsed=!1,this._buttonOneText="",this._buttonOneScreenReaderText="",this._buttonOneDismissesEntry=!1,this._buttonTwoText="",this._buttonTwoScreenReaderText="",this._buttonTwoDismissesEntry=!1,this._buttonOneHandler=null,this._buttonTwoHandler=null,this._linkUsed=!1,this._linkText="",this._linkHref="",this._linkHandler=null,this._invokeWithContextMenu=!1,this._isContextMenuHandlerSet=!1,this._reactMessageBarAPI=null,this.businessBar=null,this._htmlElement=null,this.imagePath=null,this.closeHandler=null,this.containerID=null,this.errorCode=0,this.visible=!1,this.animationDisabled=!1,this.buttonOneClickHandler=e=>(this._buttonOneHandler(e.userData),this.logTelemetryInfo("ButtonOne",C.a.businessBarButtonOne,"Mouse",2),this._buttonOneDismissesEntry&&(this.logTelemetryInfo("Close",C.a.businessBarClose,"Mouse_ButtonOne",2),this.close(e)),!0),this.buttonTwoClickHandler=e=>(this._buttonTwoHandler(e.userData),this.logTelemetryInfo("ButtonTwo",C.a.businessBarButtonTwo,"Mouse",2),this._buttonTwoDismissesEntry&&(this.logTelemetryInfo("Close",C.a.businessBarClose,"Mouse_ButtonTwo",2),this.close(e)),!0),this.linkClickHandler=e=>(this._linkHandler(e.userData),this.logTelemetryInfo("Link",C.a.businessBarLink,"Mouse",2),!0),this.onMessageBarLinkClicked=e=>{this._linkHandler(null)},this.onLinkKeyUp=e=>e.innerEvent.keyCode===d.a.vK_Enter&&!e.innerEvent.altKey&&(this._linkHandler(e.userData),this.logTelemetryInfo("Link",C.a.businessBarLink,"Keyboard",1),!0),this.onBodyKeyUp=e=>!(e.innerEvent.keyCode!==d.a.vK_Enter||e.innerEvent.altKey||!this.invokeHandler)&&(this.invokeHandler(e.userData,e),this.logTelemetryInfo("Invoke",C.a.businessBarInvoke,"Keyboard",1),!0),this.title=e,this.message=t,this.invokeHandler=n,this.id=0,this.image=1,this.isMultiLine=!0,this.barType=5}}A._businessBarClass="WACBusinessBarEntry",A._businessBarTitleClass="WACBusinessBarTitle",A._businessBarBodyClass="WACBusinessBarBody",A._businessBarTitleBodyHolderClass="WACBusinessBarTitleBodyHolder",A._businessBarButtonHolderClass="WACBusinessBarButtonHolder",A._businessBarButtonClass="WACBusinessBarButton",A._businessBarLinkHolderClass="WACBusinessBarLinkHolder",A._closeIconClass="WACBusinessBarClose",A._closeHolderClass="WACBusinessBarCloseHolder",A._closeIconFileName="BusinessBarClose_16x16x32",A._imageClass="WACBusinessBarImage",A._screenReaderOnlyClass="WACScreenReaderOnly",A._errorIconName="CancelRequest_24x24x32",A._warningIconName="Risks_24x24x32",A._infoIconName="Info_24x24x32",A._reactBusinessBarClass="ReactBusinessBarEntry",A._vNextBusinessBarClass="VNextBusinessBarEntry",A._margin=30,A.linkMargin=20,(0,a.a)(A,"BusinessBarEntry",null,[10,11])},1198:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.ConsentNoticeDialog.IConsentNoticeManager")},3332:function(e,t,n){"use strict";n.d(t,{a:function(){return u},b:function(){return c},c:function(){return s},d:function(){return l},e:function(){return d},f:function(){return r}});var a=n(100),i=n(5149),o=n(3245);const r=2155,s=2158,l=2157,c=2156,d=2159;class u{static getUserInitiatedSurvey(e,t){let n=null;if(e&&e.length>0&&t&&t.length>0){const a=window[t];if(a){a&&e in a?n=a[e]:i.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+e+" from dictionary "+t)}else i.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+t)}return n}static isFloodgateLatestVersionEnabled(){const e=o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",!1);return e?i.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):i.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version"),e}static isFloodgateEcsLatestVersionEnabled(){const e=o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateEcsLatestVersionIsEnabled",!1);return e?i.ULS.sendTraceTag(507914397,356,50,"Using floodgate ECS latest version "):i.ULS.sendTraceTag(507914396,356,50,"Using floodgate ECS stable version"),e}static isFloodgateEcsDelayLoadEnabled(){const e=o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateEcsDelayLoadEnabled",!1);return e?i.ULS.sendTraceTag(507914395,356,50,"Using floodgate ECS delay load"):i.ULS.sendTraceTag(507914394,356,50,"Using floodgate ECS dependency load"),e}static isFloodgateWhiteListDomainsEnabled(){return o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateWhiteListDomainsDisabled",!0)}static getCommonActiveSurveysThreshold(){return o.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.CommonActiveSurveysThreshold","0")}static getActiveSurveysThreshold(){return o.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.GetActiveSurveysThreshold","0")}static isFloodgateDebugLoggingEnabled(){return o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDebugLoggingEnabled",!1)}static isFloodgateDynamicCampaignEnabled(){return o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignEnabled",!1)}static isFloodgateSurveyDynamicUxEnabled(){return o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateSurveyDynamicUxEnabled",!1)}}u.latestPackageName="officebrowserfeedback-latest",u.stablePackageName="officebrowserfeedback-stable",u.latestDynamicExtPackageName="officebrowserfeedback-ext-dynamic-campaign-latest",u.stableDynamicExtPackageName="officebrowserfeedback-ext-dynamic-campaign-stable",(0,a.a)(u,"CommonUtils",null,[])},2328:function(e,t,n){"use strict";n.d(t,{a:function(){return Ze}});var a=n(100),i=n(5149),o=n(3792);var r=n(3245),s=n(4153);const l=(0,o.b)("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");var c=n(502),d=n(4182),u=n(625),p=n(8555),g=n(1307),h=n(311),m=n(9317),_=n(9611),S=n(988);const f="ErrorCode";class C{get dataPlumber(){return this._dataPlumber||(r.AFrameworkApplication.dataPlumber||(r.AFrameworkApplication.dataPlumber=new h.a),this._dataPlumber=r.AFrameworkApplication.dataPlumber),this._dataPlumber}set dataPlumber(e){this._dataPlumber=e}registerActions(){this._actionManager.addActionWithFlags(S.a.giveFeedback,_.a.frame,(0,u.a)(this,this.giveFeedbackHandler,"giveFeedbackHandler"),65536),this._actionManager.addAction(S.a.triggerFloodgateSurvey,_.a.frame,(0,u.a)(this,this.triggerFloodgateSurvey,"triggerFloodgateSurvey")),this._activeFrame.updateCommandUI()}triggerFloodgateSurvey(e,t,n,a,i){if(1===n)return 32;if(2===n&&!i)return 8;const r=i;return(0,o.h)(c.a).execute((e=>{e.logActivity((0,p.a)(String,r.ActivityName),(0,p.a)(String,r.BRSName))})),32}giveFeedbackHandler(e,t,n,a,s){if(1===n)return r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsFeedbackExperiencesAvailable")||(this._isFeedbackEnabled=!1),this._isFeedbackEnabled&&m.a.instance.isNetworkConnected?32:8;if(2===n){i.ULS.sendTraceTag(8405838,356,50,""),this.dataPlumber.Feedback|=1;const e=s||{};e.invocationTimestamp||(e.invocationTimestamp=Date.now()),void 0!==e[f]&&null!==e[f]||null==this._mostRecentError||(e[f]=this._mostRecentError),r.AFrameworkApplication.appSettingsManager.addInfoForULS(e),this._customerFeedbackFormManagerFuture&&(this._customerFeedbackFormManagerFuture.instance||(0,o.j)(l),this._customerFeedbackFormManagerFuture.execute((t=>{g.a.getOcvFeedbackAPI().then((n=>(null!=n?(i.ULS.sendTraceTag(8405838,356,100,"OCV vNext Modal: GiveFeedbackHandler command invoked"),t.launchModalDialogue(e,n)):(i.ULS.sendTraceTag(520626707,356,15,"FeedbackAPI not retrieved"),t.launchFeedbackFormWhenAvailable(e)),n)),(n=>(i.ULS.sendTraceTag(520626706,356,15,"Error while retrieving feedbackAPI"),t.launchFeedbackFormWhenAvailable(e),null)))})))}return 32}constructor(e,t,n,a,i){this._mostRecentError=null,this._isFeedbackEnabled=!0,this._dataPlumber=null,this.updateLastError=(e,t)=>{if(null!=t){const e=t;e&&(this._mostRecentError=e.errorCode)}},this._actionManager=e,this._activeFrame=t,this._customerFeedbackFormManagerFuture=n,this._settingsManager=a,this.dataPlumber=i,r.AFrameworkApplication.add_errorDialogDisplayed(this.updateLastError),this._isFeedbackEnabled=r.AFrameworkApplication.showFeedbackButton,(0,o.h)(d.a).execute((e=>{e.isFeatureEnabled("mso_sendASmile",!0).then((e=>(this._isFeedbackEnabled=r.AFrameworkApplication.showFeedbackButton&&e,this._activeFrame&&this._activeFrame.updateCommandUI(),null)),(e=>null))}))}}(0,a.a)(C,"CustomerFeedbackActor",null,[438]);const y=(0,o.b)("Common.ICustomerFeedbackActor"),A=(0,o.e)(y,{onDemandSingleton:e=>new C(r.AFrameworkApplication.theActionManager,r.AFrameworkApplication.activeFrame,(0,o.h)(l),r.AFrameworkApplication.appSettingsManager,r.AFrameworkApplication.dataPlumber)});var b=n(4361);const T=(0,o.b)("Common.App.ICustomerFeedbackUiWrapper");var v=n(7096),w=n(3332);class F{isProd(){return!this.ocvEnvironment}constructor(){this.audienceGroup=null,this.ringId=0,this.ocvEnvironment=0}}(0,a.a)(F,"OCVData",null,[]);var I=n(4238),E=n(1207),M=n(5278),k=n(6534);class P extends Sys.EventArgs{constructor(e){super(),this.submitted=e}}(0,a.a)(P,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var D=n(5434),R=n(6101),x=n(2469),L=n(965),U=n(1493),O=n(5301),B=n(8349),N=n(9858),W=n(1509),H=n(1520),V=n(4378),G=n(576),Q=n(7146),q=n(8444);class K{downloadJsResource(e){K.isWordEditor()?this._onJsDownloadFinishedList.add(e):this._onJsDownloadFinished=e;let t,n="Feedback/officebrowserfeedback_floodgate.js";w.a.isFloodgateLatestVersionEnabled()&&(n="Feedback/latest/officebrowserfeedback_floodgate.js"),Q.a.instance.isShippingFrom1JSEnabled&&(t=q.a.instance.getVersionedResourceUrl(w.a.isFloodgateEcsLatestVersionEnabled()?w.a.latestPackageName:w.a.stablePackageName,null,"scripts/officebrowserfeedback_floodgate.min.js")),t||(r.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WD1JSUrlFixes")?t=r.AFrameworkApplication.scriptUrlFromName(E.a.commonScriptsBase+n,9):(t=E.a.commonScripts(n),r.AFrameworkApplication.wd1jsIsEnabled&&(t=r.AFrameworkApplication.scriptUrlFromName(n,5))));let a=null;if(r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignEnabled",!1)&&!w.a.isFloodgateEcsDelayLoadEnabled()){a=[];let e,t="Feedback/officebrowserfeedback_ecs_client.js";w.a.isFloodgateEcsLatestVersionEnabled()&&(t="Feedback/latest/officebrowserfeedback_ecs_client.js"),Q.a.instance.isShippingFrom1JSEnabled&&(e=q.a.instance.getVersionedResourceUrl(w.a.isFloodgateEcsLatestVersionEnabled()?w.a.latestDynamicExtPackageName:w.a.stableDynamicExtPackageName,null,"dist/bundles/floodgate_ecs_client_es5.min.js")),e||(r.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WD1JSUrlFixes")?e=r.AFrameworkApplication.scriptUrlFromName(E.a.commonScriptsBase+t,9):(e=E.a.commonScripts(t),r.AFrameworkApplication.wd1jsIsEnabled&&(e=r.AFrameworkApplication.scriptUrlFromName(t,5))));const n=G.a.create(e);a.push(n)}const o=G.a.create(t,a,null);o.add_loadFinished(this.onJsDownloadFinished),V.a.enqueueResourceWithoutEnabling(o),i.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",t)}setCallerData(e){this._callbackData?e&&this._callbackData.add(e):this._callbackData=e}downloadFloodgateEcsJsResource(e,t){this._onFloodgateEcsJsDownloadFinished=e,this._ecsCallbackData=t;let n,a="Feedback/officebrowserfeedback_ecs_client.js";w.a.isFloodgateEcsLatestVersionEnabled()&&(a="Feedback/latest/officebrowserfeedback_ecs_client.js"),Q.a.instance.isShippingFrom1JSEnabled&&(n=q.a.instance.getVersionedResourceUrl(w.a.isFloodgateEcsLatestVersionEnabled()?w.a.latestDynamicExtPackageName:w.a.stableDynamicExtPackageName,null,"dist/bundles/floodgate_ecs_client_es5.min.js")),n||(r.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WD1JSUrlFixes")?n=r.AFrameworkApplication.scriptUrlFromName(E.a.commonScriptsBase+a,9):(n=E.a.commonScripts(a),r.AFrameworkApplication.wd1jsIsEnabled&&(n=r.AFrameworkApplication.scriptUrlFromName(a,5))));const o=G.a.create(n);o.add_loadFinished(this.onFloodgateEcsJsDownloadFinished),V.a.enqueueResourceWithoutEnabling(o),i.ULS.sendTraceTag(507914458,356,100,"CF - Downloading JS from: {0}",n)}static isWordEditor(){return!!r.AFrameworkApplication.activeFrame&&!!r.AFrameworkApplication.activeFrame.applicationInstance&&3===r.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&1===r.AFrameworkApplication.activeFrame.applicationInstance.officeAppMode}constructor(e=null){this._onJsDownloadFinished=null,this._onJsDownloadFinishedList=new H.a,this._onFloodgateEcsJsDownloadFinished=null,this.onJsDownloadFinished=(e,t)=>{if(K.isWordEditor()){for(let e=0;e<this._onJsDownloadFinishedList.count;e++)this._onJsDownloadFinishedList.get_item(e)(t.succeeded,this._callbackData);this._onJsDownloadFinishedList.clear()}else this._onJsDownloadFinished(t.succeeded,this._callbackData)},this.onFloodgateEcsJsDownloadFinished=(e,t)=>{this._onFloodgateEcsJsDownloadFinished(t.succeeded,this._ecsCallbackData)},this._callbackData=e}}(0,a.a)(K,"CustomerFeedbackResourceDownloadManager",null,[372]);const z=(0,o.b)("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),j=(0,o.e)(z,{onDemandRegister:(e,t)=>e.register(K,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as(t).singleInstance()});var Z=n(8599),X=n(1779),J=n(4934),Y=n(3225),$=n(629),ee=n(2217),te=n(4706),ne=n(1163);class ae{constructor(){this.productName=null,this.uiHost=null,this.cvFlights=null,this.isCVSurveyEnabled=!1,this.isCopilotLicenseEnabled=!1}}(0,a.a)(ae,"CustomerVoiceSurveyParams",null,[]);var ie=n(5665);class oe{sendTelemetryEvent(e){const t={otelEvent:e};ie.a.sendOtelEvent(t)}}(0,a.a)(oe,"OtelTelemetrySink",null,[]);class re{constructor(){this.dedupIntervalSeconds=null,this.props=null,this.userFactName=null}}(0,a.a)(re,"UserFactManifestParams",null,[]);class se{static enableSendUserFacts(){const e=se.isOneDriveConsumerHost();return r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser")?(i.ULS.sendTraceTag(508076301,383,50,"AnonymousUser"),!1):!!e||(i.ULS.sendTraceTag(508076300,383,50,"NonConsumerOneDriveHost"),!1)}static isOneDriveConsumerHost(){var e=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost"),t="onedrivecom"==r.AFrameworkApplication.appSettingsManager.getStringAppSetting(r.AFrameworkApplication.uiHostSettingName)?.toLowerCase();return e&&t}}(0,a.a)(se,"CustomerFeedbackUiWrapperStatic",null,[]);class le{setEcsClient(e){this.ecsClient=e}getConfig(){let e;try{e=this.ecsClient?this.ecsClient.getConfig():JSON.parse(this.floodgateStorageProvider.read(13)),w.a.isFloodgateDebugLoggingEnabled()&&i.ULS.sendTraceTag(507548322,356,50,"FloodgateEcsClientWrapper getConfig:"+JSON.stringify(e))}catch(t){i.ULS.sendExceptionTraceTag(507914398,356,15,t,"FloodgateEcsClientWrapper Error: "+t.toString()),e=void 0}return e}constructor(e){this.floodgateStorageProvider=e}}(0,a.a)(le,"FloodgateEcsClientWrapper",null,[]);var ce=n(9800),de=n(4990);class ue{static init(e,t,n,a,o){o.onDismiss=e,o.onError=t;let r=null;OfficeBrowserFeedback.initOptions?("screenshot"in o&&(OfficeBrowserFeedback.initOptions.screenshot=o.screenshot),"showEmailAddress"in o&&(OfficeBrowserFeedback.initOptions.showEmailAddress=o.showEmailAddress),"feedbackForumUrl"in o&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=o.feedbackForumUrl),r=o):OfficeBrowserFeedback.initOptions=o,OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=ue.createOtelTelemetrySinkForFeedbackSDK()),OfficeBrowserFeedback.multiFeedback(r).then((()=>{i.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")})).catch((e=>i.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+e.toString())))}static initSIFeedback(e,t,n,a,s){if(i.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback"),ue._initState===ue.initialized)return Promise.resolve(1);if(ue._initState===ue.initializing)return ue.initializingMsgLogged||(ue.initializingMsgLogged=!0,i.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(ue._initState!==ue.error){if(ue._initState=ue.initializing,i.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check"),ue.initSIContext(t,n,a,s)){if(w.a.isFloodgateDynamicCampaignEnabled()){const t=r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateEcsDynCDelayLoadTime",1e4);return w.a.isFloodgateEcsDelayLoadEnabled()?(setTimeout((()=>{const e=(0,o.a)(j);e?e.downloadFloodgateEcsJsResource(ue.onFloodgateEcsDonwloadCallback,a):i.ULS.sendTraceTag(507914393,356,15,"ICustomerFeedbackResourceDownloadManager is not available")}),t),this.initEcsClientWrapper(a),ue.initFloodgate(e)):ue.initEcsClient(a).then((t=>ue.initFloodgate(e)))}return ue.initFloodgate(e)}ue._initState=ue.error,Promise.reject(ue.ofbUndefinedMsg)}return Promise.reject(0)}static initFloodgate(e){try{return J.a.recordKpiHealthPromise(ue.getKpiConfig(),"InitFloodgate",(()=>OfficeBrowserFeedback.floodgate.initialize().then((t=>ue.startFloodgate(e))))).catch((e=>{let t=10;e&&e.toString()&&U.a(e.toString(),ue.localStorageNotAvailable)&&(t=15),i.ULS.sendTraceTag(36546402,356,t,"BFCOCV Floodgate initialize error:"+e.toString())}))}catch(e){return i.ULS.sendExceptionTraceTag(590975881,356,15,e,"BFCOCV Floodgate initialize error:"+e.toString()),Promise.reject(ue.ofbFloodgateInitializeUndefinedMsg)}}static getKpiConfig(){return{featureName:"Floodgate",crewAlias:"floodgatecrew",vetoPillar:"OfficeBrowserFeedback"}}static startFloodgate(e){return OfficeBrowserFeedback.floodgate.start().then((()=>{ue.floodgateInitCompleted(e)})).catch((e=>{i.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+e.toString())}))}static floodgateInitCompleted(e){ue._initState=ue.initialized,r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateEnabledConfigAvailable",!1)?i.ULS.sendTraceTag(507058329,356,50,"BFCOCV.Started floodgate"):i.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate"),se.enableSendUserFacts()&&ie.a.addSink(e);try{const e=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const t of e.split("|"))t&&ue.logActivity(t,null)}catch(e){i.ULS.sendTraceTag(539015366,356,50,"Error triggering test activity")}}static isTeams(){let e=!1;const t=r.AFrameworkApplication.appSettingsManager;if(t){e="teams"===(t.getStringAppSetting(r.AFrameworkApplication.uiHostSettingName)||"").toLowerCase()}return ne.a.isTeamsElectron||e}static async isCopilotLicenseConfigurationSuccessful(){try{if(await ue.waitFullAppSettingReady(),!await ue.adminControlCopilotPolicyEnabled())return!1;try{return await ue.hasLicense()?(ue.isCoplilotLicenseEnabled=!0,i.ULS.sendTraceTag(508368331,356,50,"Promise - hasLicense resolved succesfully - true"),!0):(i.ULS.sendTraceTag(508368330,356,50,"Promise - hasLicense resolved succesfully - false"),!1)}catch(e){return i.ULS.sendTraceTag(508368329,356,10,"Error resolving Promise for hasLicense "+(e?e.toString():"")),!1}}catch(e){i.ULS.sendTraceTag(508368328,356,10,"Error resolving Promise for isCopilotLicenseConfigurationSuccessful "+(e?e.toString():""))}}static async waitFullAppSettingReady(){return new Promise(((e,t)=>{try{r.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((()=>{e(!0),i.ULS.sendTraceTag(508368327,356,50,"Promise - waitFullAppSettingReady resolved succesfully")}))}catch(e){i.ULS.sendTraceTag(508368326,356,10,"Error resolving Promise for waitFullAppSettingReady "+(e?e.toString():"")),t(e)}}))}static async adminControlCopilotPolicyEnabled(){try{const e=(0,o.h)(v.a),t=await ue.promisifyFuture(e),n=await t.getBooleanPolicySetting("CopilotContentGeneration",!0);return i.ULS.sendTraceTag(508368325,356,50,"Promise - adminControlCopilotPolicyEnabled resolved succesfully"),!n}catch(e){i.ULS.sendTraceTag(508368324,356,10,"Error resolving Promise for adminControlCopilotPolicyEnabled "+(e?e.toString():""))}}static async hasLicense(){const e=(0,o.h)(d.a);return(await ue.promisifyFuture(e)).isFeatureEnabled(this.licenseName,!1)}static promisifyFuture(e){return new Promise(((t,n)=>{try{e.execute((e=>t(e))),i.ULS.sendTraceTag(508368323,356,50,"Promise - promisifyFuture resolved succesfully")}catch(e){i.ULS.sendTraceTag(508368322,356,10,"Error resolving Promise for promisifyFuture "+(e?e.toString():"")),n(e)}}))}static officeBrowserFeedbackIsUndefined(){return"undefined"==typeof OfficeBrowserFeedback}static initSIContext(e,t,n,a){let o=!0;try{if(ue.officeBrowserFeedbackIsUndefined())return i.ULS.sendTraceTag(39900617,356,15,ue.ofbUndefinedMsg),!1;OfficeBrowserFeedback.initOptions||(n.onDismiss=a,n.onError=t,n=ue.appendConfigsToAppData(n),OfficeBrowserFeedback.initOptions=n),OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=ue.createOtelTelemetrySinkForFeedbackSDK()),ue.isProduction=0===n.environment;const o=ue.onSurveyActivated,s=ue.logExperimentTrigger,l={},c={},d={};c.onSurveyActivated=o,c.onTeachingCampaignRender=n.onTeachingCampaignRender,d.LogExperimentTrigger=s,l.onSurveyActivatedCallback=c,l.onDismiss=e,l.autoDismiss=n.FloodgateUIAutoDismissTimeEnum,l.telemetryGroup=n.telemetryGroup,l.uIStringGetter=n.uIStringGetter,l.authTokenCallback=n.authTokenCallback,l.augLoopCallback=n.augLoopCallback,l.featureStatusCallback=n.featureStatusCallback,l.campaignFlights="",l.governanceServiceEnabled=n.governanceServiceEnabled,l.governanceServiceConfig=n.governanceServiceConfig,l.personalizerEnabled=n.personalizerEnabled,l.messagingServiceSettings=n.messagingServiceSettings,l.isPriorityEnabled=n.isPriorityEnabled,l.enableWebCampaignGovernance=n.enableWebCampaignGovernance,l.logExperimentTrigger=d,l.userFactsReadConfig=n.userFactsReadConfig,l.campaignTelemetrySamplingConfig=n.campaignTelemetrySamplingConfig,l.userInsightsProviderPromise=n.userInsightsProviderPromise,(0,de.a)()?(window.location?.search?.match(/wdlpp=1/gi)&&ue.filterTags.add(ue.filterTagForAutomation),ue.addAppGovernanceProviderToContext(l)):r.AFrameworkApplication.isMeetingLiveSession&&(ue.filterTags.add(ue.filterTagForOfficeLiveSurvey),ue.addAppGovernanceProviderToContext(l)),"surveyEnabled"in n&&(l.surveyEnabled=n.surveyEnabled),"messagingEnabled"in n&&(l.messagingEnabled=n.messagingEnabled),"showEmailAddress"in n&&(l.showEmailAddress=n.showEmailAddress),l.isEudbUxEnabled=!1,r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",!1)&&(l.isEudbUxEnabled=!0);const u=ue.getCurrentFlights(n),p=ue.getFloodgateFlightParameters(u);let g=ue.getDefaultCampaignQueryParameters(n);for(const e in p){const t={key:e,value:p[e]};-1!==t.key.toLowerCase().indexOf("flight")?l.campaignFlights+=t.value+";":g=g+t.key+"="+t.value+"&"}i.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+l.campaignFlights+" campaignQueryParameters: "+g),l.campaignQueryParameters=g;const h=ue.isCoplilotLicenseEnabled;i.ULS.sendTraceTag(508368321,356,50,"isCopilotLicenseEnabled= "+h.toString());const m=n.Application.toString(),_="",S=ue.isTeams()?ue.teamsStr:"";l.customerVoiceSurveyParams=ue.getCustomerVoiceSurveyParams(_,m,S,h),l.dynamicUxConfig=ue.getDynamicVariables(),w.a.isFloodgateSurveyDynamicUxEnabled()&&(l.dynamicUxConfig={...n.dynamicUxConfig,...l.dynamicUxConfig}),OfficeBrowserFeedback.floodgate.initOptions=l}catch(e){o=!1,i.ULS.sendTraceTag(39900618,356,15,e.toString())}return o}static addAppGovernanceProviderToContext(e){const t={};t.getDecision=ue.getDecision,e.appGovernanceProvider=t}static getDecision(e){const t=e.getTags();if(t)for(const e of t)if(ue.filterTags.has(e))return!0;return!1}static appendConfigsToAppData(e){try{const t=e.applicationGroup?e.applicationGroup:{},n=t.appData,a=n?L.a(L.a('"'+n+'"')):{};a.fgUIAutoDismiss=e.FloodgateUIAutoDismissTimeEnum,a.isCopilotLicenseEnabled=ue.isCoplilotLicenseEnabled,t.appData=L.c(a),e.applicationGroup=t}catch(e){i.ULS.sendTraceTag(588842831,356,10,"Failed to parse applicationGroup.appData",e.toString())}return e}static getCurrentFlights(e){let t=Array.isArray(e.Flights)?e.Flights:null;if(!t){const e=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("FlightId");t=e?e.toString().split(";"):null}if(r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",!0)){const e=r.AFrameworkApplication.appSettingsManager.flightingTreatmentVariables;if(e)for(const n in e){const a={key:n,value:e[n]};if(-1===(a&&a.key?a.key.toLowerCase():"").indexOf("floodgateflight"))continue;"unset"!==(a&&a.value?a.value.toString().toLowerCase():"")&&t.push(a.key)}}return t}static getFloodgateFlightParameters(e){const t="AppFlights",n="SelfTriggerActivity",a={};if(a[n]="",!e||!e.length)return a;try{for(let o=0;o<e.length;o++){let s=e[o]?e[o].toLowerCase():"";if(-1===s.indexOf("floodgateflight"))continue;const l=s.lastIndexOf(".");-1!==l&&(s=s.substring(l+1,s.length));if(-1!==(t in a?a[t]:"").indexOf(s))continue;t in a?a[t]+=";"+s:a[t]=s;const c=N.a.replaceAll(s,"-",""),d=r.AFrameworkApplication.appSettingsManager.getStringAppSetting(c);if(d)try{const e=L.a(d);if((e?e[n]:null)||(a[n]+=";"+c),e)for(const t in e){const n={key:t,value:e[t]};n.key in a?a[n.key]!==n.value&&(a[n.key]=a[n.key]+";"+n.value):a[n.key]=n.value}}catch(e){i.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+c+" json data",e.toString())}else a[n]+=";"+c}}catch(e){i.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",e.toString())}return a}static getDefaultCampaignQueryParameters(e){let t="";const n={OFC_Audience:"AudienceGroup",Datacenter:"WACDatacenter",TenantId:"TenantId"};for(const a in n){const i={key:a,value:n[a]};let o=e[(0,p.a)(String,i.value)];o||(o=r.AFrameworkApplication.appSettingsManager.getStringAppSetting((0,p.a)(String,i.value))),o&&(t+=i.key+"="+encodeURIComponent(o)+"&")}return t}static setCustomTriggerEventCallback(e){ue.customTriggerEventCallback=e}static onSurveyActivated(e,t,n){if(e)try{const a=t?t.getCampaignId():"",o=t?t.getLauncherType():"",s=n?n.contextInfo:null,l=t?t.getSurveyInfo():null,c=l?l.getPreferredLaunchType():null,d=l?l.getMetadata():null,u=d?d.getContentMetadata():null,p=u?u.customSurveyName:null,g=u?u.telemetryEventName:null;if(ue.isCampaignDisabled(a))return void i.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+a);r.AFrameworkApplication.isMeetingLiveSession&&i.ULS.sendTraceTag(512312960,356,50,"BFCOCV.onSurveyActivated Initiated survey activation for campaign - {0} during Live session",a);const h={};if(h.campaignId=a,h.surveyName=p,h.launcherType=o,h.contextInfoLength=s?s.length.toString():"-1",h.preferredLaunchType=c,h.telemetryEventName=g,i.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(h)),o&&"dialog"===o.toLowerCase())return i.ULS.sendTraceTag(506316254,356,50,"BFCOCV.onSurveyActivated. Dialog survey activation successful - "+JSON.stringify(h)),void ue.handleSurveyActivationCallback(u,t,n);if(o&&"coachingux"===o.toLowerCase()&&c&&"default"!==c.toLowerCase()&&ue.handleSurveyActivationCallback(u,t,n))return void i.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(h));e.launch(n),ue.setupEventHandlersOnSurveyUI()}catch(e){i.ULS.sendTraceTag(555071514,356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(e?e.toString():""))}else i.ULS.sendTraceTag(36706400,356,10,"BFCOCV.onSurveyActivated given a null launcher")}static getFlightId(e){if(!e||r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableFloodgateTriggerFlightIdLog",!1))return null;try{const t=(r.AFrameworkApplication.appSettingsManager.getStringAppSetting("FlightId")||"").toLocaleLowerCase(),n=e.toString().toLocaleLowerCase().split(";");for(const e of n)if(-1!==t.indexOf(e))return e}catch(e){i.ULS.sendTraceTag(508961430,306,50,"Error retrieving flightId of campaign event -"+(e?e.toString():""))}return null}static logExperimentTrigger(e){for(const t of e){const e=t.eventInfo;if(t.triggerEvent){const n=ue.getFlightId(t.triggerEvent);n&&(e.flightId=n),ce.a.logUniqueUsage(t.triggerEvent)}i.ULS.sendTraceTag(509100380,306,50,"Web Campaign UI launched. "+JSON.stringify(e))}}static registerActivationCallback(e,t){ue.activationCallbacks.containsKey(e)?i.ULS.sendTraceTag(555071515,356,50,"Activation callback already exists - "+e):ue.activationCallbacks.set_item(e,t)}static getRegisteredActivationCallback(e){return ue.activationCallbacks.containsKey(e)?ue.activationCallbacks.get_item(e):null}static handleTeachingUxActivationCallback(e){const t=e?e.surfaceContext:null;if(!t||!t.surveyForm)return i.ULS.sendTraceTag(555071516,356,10,"Missing activation arguments"),!1;try{const e=t.surveyForm.getSurveyInfo(),n=e?e.getMetadata():null,a=n?n.getContentMetadata():null;return ue.handleSurveyActivationCallback(a,t.surveyForm,t.surveyParams)}catch(e){i.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(e?e.toString():""))}return!1}static handleSurveyActivationCallback(e,t,n){if(!e||!e.customSurveyName||!t)return i.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(e?e.customSurveyName:null)),!1;const a=t.getCampaignId();if(e.telemetryEventName){const t={action:"Opened",id:a,success:"true",triggerType:"custom",customSurveyName:e.customSurveyName,telemetryEventName:e.telemetryEventName};ue.customTriggerEventCallback?ue.customTriggerEventCallback(e.telemetryEventName,t):(ce.a.logUsage(e.telemetryEventName),i.ULS.sendTraceTag(512505554,356,50,"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(t)))}const o=ue.activationCallbacks.containsKey(e.customSurveyName)?ue.activationCallbacks.get_item(e.customSurveyName):null;if(!o)return i.ULS.sendTraceTag(555071519,356,50,"Activation callback not found - "+e.customSurveyName+", "+a),!1;const r=o(t,n);return r&&r.then((e=>{i.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(e))})).catch((e=>{i.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(e?e.toString():""))})),!0}static getDynamicVariables(){const e={};e.uiHost=ue.isTeams()?ue.teamsStr:"",e.isCopilotLicenseEnabled=ue.isCoplilotLicenseEnabled;const t={};return t.dynamicVariables=e,t}static isCampaignDisabled(e){try{return-1!==r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((e||"").toLowerCase())}catch(t){i.ULS.sendTraceTag(539015368,356,10,"Error checking if campaign is disabled - "+e)}return!1}static logActivity(e,t=null){if(!ue.checkParams(e,"LogActivity"))return;const n=ue.getFloodgateListener();n&&(i.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+e),n.logActivity(e,1,t))}static showUserInitiatedSurvey(e){e?(i.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),OfficeBrowserFeedback.floodgate.showCustomSurvey(e),ue.setupEventHandlersOnSurveyUI()):i.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static setupEventHandlersOnSurveyUI(){if(ue.addFocusScope(ue.floodgateContainerID),w.a.isFloodgateSurveyDynamicUxEnabled()){null===document.getElementById(ue.floodgateContainerID)&&ue.initializeFocusDynamicSurvey(ue.floodgateDynamicUxContainerID)}}static initializeFocusSettings(e,t,n,a,i,o,r,s,l,c=!0,d=!1,u=!1){const p=$.FocusManager.instance(),g=p.getScope(e);if(g.parent=I.a.mainAppFocusId,g.keyDownHandledExternally=u,Y.a.instance.addF6(e,c),t&&g.addSetFocus(t),n&&g.addOnFocus(n),a&&g.addOnBlur(a),i&&(ee.a.instance.addControlFocus(e,i,o,d),te.a.instance.addControlFocus(e,i,o,d),r)){const e=new M.a((()=>i));for(let t=0;t<s.length;++t)e.addValidTag(s[t]);p.buildRegionWithDelegate((()=>i),g,e).looped=l}return g}static addFocusScope(e){const t=document.getElementById(e);if(t){const n=[3,2,5,1];ue.initializeFocusSettings(e,null,ue.onFocusAction,null,t,false,true,n,true,true,true,true)}else i.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+e)}static onFocusAction(e,t){if(i.ULS.sendTraceTag(37107265,356,100,"BFCOCV.OnFocusAction. PrevScopeName "+(e?e.name:"")+" NextScopeName "+(t?t.name:"")),t){const e=$.FocusManager.instance().getRegion(t.name);e&&e.moveIntoFromTop()}}static initializeFocusDynamicSurvey(e){ue.checkSurveyDynamicUxIntervalId=ue.clearInterval(ue.checkSurveyDynamicUxIntervalId),ue.isDynamicUxFocusSetupDone=!1,ue.dynamicUxSetupRetryLimit=10,ue.checkSurveyDynamicUxIntervalId=window.setInterval((()=>{ue.setDynamicUxFocusTimerHandler(e)}),ue.dynamicUxSetupTimeInterval)}static setDynamicUxFocusTimerHandler(e){null!==document.getElementById(e)&&(ue.addFocusScope(e),ue.isDynamicUxFocusSetupDone=!0),ue.dynamicUxSetupRetryLimit--,(ue.isDynamicUxFocusSetupDone||ue.dynamicUxSetupRetryLimit<=0)&&(ue.checkSurveyDynamicUxIntervalId=ue.clearInterval(ue.checkSurveyDynamicUxIntervalId),ue.dynamicUxSetupRetryLimit<=0&&i.ULS.sendTraceTag(508384545,356,15,"BFCOCV.Could not find dynamic ux container "+e))}static clearInterval(e){return e!==ue.ResetIntervalId&&window.clearInterval(e),ue.ResetIntervalId}static logActivityStart(e,t=null){if(!ue.checkParams(e,"LogActivityStart"))return;const n=ue.getFloodgateListener();n&&(i.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+e),n.logActivityStartTime(e))}static logActivityEnd(e){if(!ue.checkParams(e,"LogActivityEnd"))return;const t=ue.getFloodgateListener();t&&(i.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+e),t.logActivityStopTime(e,new Date))}static floodgateStart(){OfficeBrowserFeedback.floodgate.start()}static floodgateStop(){OfficeBrowserFeedback.floodgate.stop()}static initEcsClient(e){try{const t=e.telemetryGroup,n=new Map;if(n.set("Agent",ue.ecsTeam),n.set("Platform","Web"),n.set("Host",e.Host||""),n.set("Audience",t.audienceGroup||""),n.set("TenantId",t.tenantId||""),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignTestEnabled",!1)){const e=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignTestAudience","Dogfood");n.set("Audience",e),n.set("SurveyValidation","true")}const a={};return a.appName=e.Application||"",a.language=e.locale||"",a.appVersion=t.officeBuild||"",a.host=ue.ecsHost,a.filters=n,a.localStorageProvider=OfficeBrowserFeedback.floodgate.getStorageProvider(),a.fetchAttemptMax=r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynCFetchAttemptMax",10),w.a.isFloodgateDebugLoggingEnabled()&&i.ULS.sendTraceTag(507548320,356,50,"BrowserFeedbackControl EcsConfig:"+JSON.stringify(a)+", EcsFilters: "+JSON.stringify(Array.from(n))),this.ecsClient=new FloodgateDynamicCampaign.Client(a),this.ecsClient.telemetryEvents.subscribe(((e,t)=>{i.ULS.sendTraceTag(508912419,356,50,"Floodgate Ecs Telemetry Event: "+e+", details: "+JSON.stringify(t))})),this.ecsClient.start().then((()=>{const e={enabled:!0};e.ecsClient=ue.ecsClient,OfficeBrowserFeedback.floodgate.initOptions.dynamicCampaignConfig=e,this.ecsClientWrapper&&this.ecsClientWrapper.setEcsClient(this.ecsClient),w.a.isFloodgateDebugLoggingEnabled()&&i.ULS.sendTraceTag(507548319,356,50,"BrowserFeedbackControl ECS Client started.:")})).catch((e=>{i.ULS.sendTraceTag(508912418,356,10,"EcsClient starts with Error: "+(e?e.toString():""))}))}catch(e){return i.ULS.sendTraceTag(508912417,356,15,"Initialized EcsClient failed with error: "+e.toString()),Promise.resolve(0)}}static initEcsClientWrapper(e){try{this.ecsClientWrapper=new le(OfficeBrowserFeedback.floodgate.getStorageProvider());const e={enabled:!0};e.ecsClient=this.ecsClientWrapper,OfficeBrowserFeedback.floodgate.initOptions.dynamicCampaignConfig=e}catch(e){i.ULS.sendTraceTag(507914392,356,15,"Initialized EcsClientWrapper failed with error: "+e.toString())}}static onFloodgateEcsDonwloadCallback(e,t){e?ue.initEcsClient(t):i.ULS.sendTraceTag(507914391,356,15,"Download FloodgateEcs failed with error")}static checkParams(e,t){return e||i.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+t),!!e}static getFloodgateListener(){let e=null;const t=OfficeBrowserFeedback.floodgate.getEngine();return t?(e=t.getActivityListener(),e||i.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null")):ue.nullFloodgateEngineMsgLogged||(ue.nullFloodgateEngineMsgLogged=!0,i.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null")),e}static createOtelTelemetrySinkForFeedbackSDK(){return new oe}static getCustomerVoiceSurveyParams(e,t,n,a){return Object.assign(new ae,{productName:t,uiHost:n,cvFlights:e,isCVSurveyEnabled:!0,isCopilotLicenseEnabled:a})}static getUserFactManifestParams(e,t,n){return Object.assign(new re,{dedupIntervalSeconds:e,props:t,userFactName:n})}static processTelemetrySinkEvent(e){ue._initState===ue.initialized&&OfficeBrowserFeedback.processTelemetryEvent(e)}}ue.notInitialized=0,ue.initializing=1,ue.initialized=2,ue._initState=ue.notInitialized,ue.floodgateContainerID="obf-ToastContainer",ue.floodgateDynamicUxContainerID="obf-FloodgateDynamicUxContainer",ue.error=-1,ue.nullFloodgateEngineMsgLogged=!1,ue.initializingMsgLogged=!1,ue.localStorageNotAvailable="window.localStorage is not available",ue.ofbUndefinedMsg="OFB still undefined",ue.ofbFloodgateInitializeUndefinedMsg="OFB Floodgate is undefined or does not contain initialize function",ue.isProduction=!1,ue.teamsStr="Teams",ue.filterTagForOfficeLiveSurvey="Live",ue.ecsHost="https://ecs.office.com",ue.ecsTeam="ChillWAC",ue.filterTagForAutomation="Automation",ue.filterTags=new Set,ue.activationCallbacks=new Z.a(X.a.get_ordinalIgnoreCase()),ue.customTriggerEventCallback=null,ue.licenseName="Copilot",ue.isCoplilotLicenseEnabled=!1,ue.dynamicUxSetupTimeInterval=1e3,ue.ResetIntervalId=-1,ue.checkSurveyDynamicUxIntervalId=ue.ResetIntervalId,ue.isDynamicUxFocusSetupDone=!1,ue.dynamicUxSetupRetryLimit=10,(0,a.a)(ue,"BrowserFeedbackControlOCV",null,[]);var pe=n(5018);class ge extends se{get dataPlumber(){return this._dataPlumber||(r.AFrameworkApplication.dataPlumber||(r.AFrameworkApplication.dataPlumber=new h.a),this._dataPlumber=r.AFrameworkApplication.dataPlumber),this._dataPlumber}set dataPlumber(e){this._dataPlumber=e}get submitButton(){return this._submitButton||(this._submitButton=document.getElementById(this.submitButtonId))}get likeButton(){return this._likeButton||(this._likeButton=document.getElementById(this.likeButtonId))}get commentBox(){return this._commentBox||(this._commentBox=document.getElementById(this.commentBoxId))}get suggestionButton(){return this._suggestionButton||(this._suggestionButton=document.getElementById(this.suggestionButtonId))}get contactFormContainer(){return this._contactFormContainer||(this._contactFormContainer=document.getElementById(this.contactFormContainerId))}get privacyStatementLink(){return this._privacyStatementLink||(this._privacyStatementLink=document.getElementById(this.privacyStatementLinkId))}get mainContentHolder(){return this._mainContentHolder||(this._mainContentHolder=document.getElementById(this.mainContentHolderId))}add_onFeedbackUiDismissed(e){this._eventSource.addHandler(ge.onFeedbackUiDismissedEventId,e)}remove_onFeedbackUiDismissed(e){this._eventSource.removeHandler(ge.onFeedbackUiDismissedEventId,e)}clearCachedElements(){this._submitButton=null,this._likeButton=null,this._commentBox=null,this._suggestionButton=null,this._contactFormContainer=null,this._privacyStatementLink=null,this._mainContentHolder=null}isElementVisible(e){return!!e&&e.className.toLowerCase().indexOf(this.visibleClassName.toLowerCase())>=0}showFeedbackModalDialogue(e,t){r.AFrameworkApplication.showFeedbackButton?this._isFeedbackEnabled&&(i.ULS.sendTraceTag(508952780,356,50,"Feedback api retrieved"),this.delayOpenFeedback((()=>{this.openFeedbackWithPolicies(e,t)}))):i.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible")}openFeedbackWithPolicies(e,t){this._checkMainContentHolderIntervalId=this.clearInterval(this._checkMainContentHolderIntervalId);const n=e||{};this.getContext(n),t.initializeFeedbackModal(n,(0,u.a)(this,this.onDismiss,"onDismiss"),(0,u.a)(this,this.onError,"onError")),i.ULS.sendTraceTag(508952779,356,50,"Successfully opened feedback form and set focus."),this.dataPlumber.Feedback|=8}delayOpenFeedback(e){let t=ge.initialTimeDelayInMs;this._checkMainContentHolderIntervalId=this.clearInterval(this._checkMainContentHolderIntervalId),this._checkMainContentHolderIntervalId=window.setInterval((()=>{this.areFeedbackOCPSPoliciesSet()&&e(),t*=2,t>ge.maxTimeDelayInMs&&(e(),i.ULS.sendTraceTag(508952778,356,10,"Failed to retrieve correct OCPS policies due to timeout in delayOpenFeedback"))}),t)}showUi(e){if(!r.AFrameworkApplication.showFeedbackButton)return void i.ULS.sendTraceTag(520626704,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");if(!this._isFeedbackEnabled)return;const t=e||{};this.getContext(t);const n=ge.determineFeedbackUlsCategory(t.AppMode||"Unknown");ue.init((0,u.a)(this,this.onDismiss,"onDismiss"),(0,u.a)(this,this.onError,"onError"),356,n,t),this.initializeFocus(),ge.allowKeytips(!1),i.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus."),this.dataPlumber.Feedback|=8}fillUserEmail(e,t){t&&t.ringId<=2&&(e.userEmailConsentDefault=!0);const n=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName");n&&n.length>0?e.userEmail=n:e.userEmail=""}getAppData(e){const t={};if(void 0!==e.appData&&null!==e.appData){const n=e.appData;for(const e in n){const a={key:e,value:n[e]};t[a.key]=a.value}}if(t.App=e.Application||"",t.AppMode=e.AppMode||"",t.AppModeExt=e.ApplicationMode||"",t.Host=e.Host||"",t.Language=e.locale,t.IsError=e.Error||!1,t.IsCrash=e.Crash||!1,t.ServerDocId=e.ServerDocId||"",e.ErrorCode&&""!==e.ErrorCode.toString()&&(t.IsError=!0),"Origin"in e&&(t.Origin=e.Origin),t.ClientThrottlingProtection=this.dataPlumber.ClientThrottlingProtection||"",t.HostServiceLevel=this.dataPlumber.HostServiceLevel||"",t.RequestedCallThrottling=this.dataPlumber.RequestedCallThrottling||"",t.WacServiceLevel=this.dataPlumber.WacServiceLevel||"",this.dataPlumber.HostResponseStats){const e=this.dataPlumber.HostResponseStats.Label;e&&(t.HostFarmHint=e)}const n=r.AFrameworkApplication.appSettingsManager,a=n.getStringAppSetting(r.AFrameworkApplication.uiHostSettingName);a&&""!==a&&(t.UiHost=a);const o=n.getStringAppSetting(r.AFrameworkApplication.uiHostIntegrationTypeSettingName);if(o&&""!==o&&(t.UiHostIntegrationType=o),n.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OcvFeedbackIncludesSessionOrigin")){let n=e.SessionOrigin;if(!n){const t=e.SourceControlId;if(t&&U.a(t.toLowerCase(),"feedback")){n=this.getContextFromAppSettings().SessionOrigin}}n&&""!==n&&(t.SessionOrigin=n)}let s=null;try{s=L.c(t),s=N.a.encodeString(s,N.a.jsonEscapedCharacters)}catch(e){s="",i.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData: {0}",e.message)}return{appData:s||""}}getCustomAppSettings(e){const t={};for(const n in e){const a={key:n,value:e[n]};t[a.key]=a.value}return t.IsFreemiumUpsellEnabled=this._isFreemiumUpsellEnabled,t.IsAadcEnabled=this._isAadcEnabled,t.IsFeedbackEnabled=this._isFeedbackEnabled,t}getCustomWebSurfacesSettings(){let e=null;try{const t=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",null);t&&(e=L.b(t))}catch(e){i.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return e||{}}getCommonContext(e,t){if(!e||!t)return null;e.LanguageID?e.locale=O.a.getCultureInfo(e.LanguageID).name||"":e.ApplicationLCID&&(e.locale=e.ApplicationLCID),e.applicationGroup=this.getAppData(e),e.applicationSettings=this.getCustomAppSettings(r.AFrameworkApplication.appSettingsManager.appSettings),e.webSurfacesSettings=this.getCustomWebSurfacesSettings(),e.userfactConfig=ge.getUserFactConfig(),ge.determineOCVData(t,e),e.appId=ge.determineOCVFeedbackAppId(),e.environment=t.ocvEnvironment,e.stylesUrl=this._stylesUrl,e.intlUrl=this._intlUrl,w.a.isFloodgateWhiteListDomainsEnabled()&&(e.allowedDomains=[this.extractUrlDomain(this._intlUrl),this.extractUrlDomain(this._stylesUrl)]),e.rtl=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Rtl")?"rtl":"ltr";const n=ge.determineOCVFeedbackAppColor();e.primaryColour=n.primaryColour,e.secondaryColour=n.secondaryColour,e.sessionId=e.SessionID||e.WACSessionID||"",e.build=e.ApplicationVersion||e.WFEVersion||"";const a=e.FlightIDs?e.FlightIDs.toString():e.Flights?e.Flights.toString():"";let o="";e.ErrorCode&&(o=e.ErrorCode.toString());const s=this.getPlatform(e);let l=t.isProd()?r.AFrameworkApplication.appSettingsManager.getStringAppSetting("TenantId"):"";l&&"0"!==l||(l="");const c=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("LoggableUserIdSpace");let d=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("LoggableUserId")||"";switch(c){case"MsaPuid":d="p:"+d;break;case"MsaCid":d="m:"+d;break;case"OrgIdPuid":d="a:"+(r.AFrameworkApplication.appSettingsManager.getStringAppSetting("AADUserObjectId")||d);break;default:i.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: {0}, LoggableUserIdSpace: {1}",d,c),d=""}const u={};if(void 0!==e.telemetryGroup&&null!==e.telemetryGroup){const t=e.telemetryGroup;for(const e in t){const n={key:e,value:t[e]};u[n.key]=n.value}}return u.audienceGroup=t.audienceGroup,u.audience=t.audienceGroup,u.flights=a,u.platform=s,u.ringId=t.ringId,u.officeUILang=r.AFrameworkApplication.lcid,u.errorCode=o,u.loggableUserId=d,u.processSessionId=e.SessionID||e.WACSessionID||"",u.officeBuild=e.ApplicationVersion||e.WFEVersion||"",l.length>0&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==l&&(u.tenantId=l),e.telemetryGroup=u,e.webGroup={browser:e.Browser||"",browserVersion:(e.BrowserMajorVersion||"")+"."+(e.BrowserMinorVersion||""),dataCenter:e.Datacenter||e.WACDatacenter||""},e.isCommercialHost=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost"),this.determineFeedbackForumContext(e),e.disableIncludeScreenshot=!this._isScreenshotEnabled,e.screenshot=this._isScreenshotEnabled,e.showEmailAddress=this._isEmailEnabled,e.emailPolicyValue=this._emailPolicy,e.policyAllowContact=this._emailPolicy,e.policyAllowContent=this._feedbackIncludeLogPolicy,e.policyAllowFeedback=this._feedbackPolicy,e.policyAllowSurvey=this._surveyPolicy,e.screenshotPolicyValue=this._screenshotPolicy,e.policyAllowScreenshot=this._screenshotPolicy,e.policyEmailCollectionDefault=this._feedbackOptionsDefaultsEmailPolicy,e.policyContentSamplesDefault=this._feedbackOptionsDefaultsContentSamplesPolicy,e.policyScreenshotDefault=this._feedbackOptionsDefaultsScreenshotPolicy,e.policyAllowCopilotFeedback=this._copilotFeedbackPolicy,r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost")||(e.disableIncludeScreenshot=!1,e.showEmailAddress=!0,e.screenshot=!0),e.surveyEnabled=this._isSurveyEnabled,r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost")&&(e.showEmailAddress=!0,e.surveyEnabled=!0),this.fillUserEmail(e,t),e.DismissHandler?this.onDismissedCallback=e.DismissHandler:this.onDismissedCallback=null,this.determineComplianceChecks(e),e.eventSampling=this.getEventSamplingConfig(),e.sovereignEnvironmentName=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("SovereignEnvironmentName"),e}getEventSamplingConfig(){const e=[];return e.push(this.getEventSamplingFeatureGate("FloodgateCore_FloodgateEngine_GetActiveSurveys",w.a.getActiveSurveysThreshold())),e.push(this.getEventSamplingFeatureGate("FloodgateCore_FloodgateEngine_Common_ActiveSurveys",w.a.getCommonActiveSurveysThreshold())),e}getEventSamplingFeatureGate(e,t){const n={type:"Event"};return n.sampleRate=parseFloat(t),n.name=e,n}areFeedbackOCPSPoliciesSet(){return this._flagIsEmailEnabledSet&&this._flagIsSurveyEnabledSet&&this._flagIsFeedbackIncludeLogEnabledSet}getContext(e){const t=e||this.getContextFromAppSettings(),n=new F;return t.clientFeedbackId||(t.clientFeedbackId=W.a.create().toString()),t.invocationTimestamp||(t.invocationTimestamp=Date.now()),this.getCommonContext(t,n),t}async getFeedbackData(e){await this.delayFunctionCallTillPoliciesAreSet();const t=e||this.getContextFromAppSettings(),n=new F,a=this.getCommonContext(t,n);return g.a.getOcvFeedbackAPI().then((e=>e.convertCustomerUiWrapperFeedbackDataToHvcFormat(a)))}getPlatform(e){let t="";return e.Platform&&(t=e.Platform.toString()),e.PlatformMajorVersion&&(t.length>0&&(t+=" "),t+=e.PlatformMajorVersion.toString()+"."),e.PlatformMinorVersion&&(t+=e.PlatformMinorVersion.toString()),t}standardizeKeyNames(e){e.ApplicationMode&&(e.AppMode=e.ApplicationMode),e.ApplicationModeExtended&&(e.ApplicationMode=e.ApplicationModeExtended)}getContextFromAppSettings(){let e;try{e=L.b(r.AFrameworkApplication.appSettingsManager.appSettings.SessionStartInfoJson.toString()),this.standardizeKeyNames(e)}catch(t){i.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),e={}}return e}onError(e){const t=B.a.getScrubbedHttpErrorDetails(e);i.ULS.sendTraceTag(37259477,356,10,"FB submit error: {0}",t),this.dataPlumber.Feedback|=64,ge.allowKeytips(!0)}doNPSTestAction(){if(!ge.isNPSLocalizationTestingSession())return;i.ULS.sendTraceTag(40112215,356,50,ge.npsTestActivityFlightBRS);const e=(0,o.j)(c.a);e&&e.logActivity("AppUsageNPSLocalizationTest",null)}onDismiss(e){this.removeFocus(),this.clearCachedElements(),D.a.oldActionsPipelineIsEnabled()&&i.ULS.sendTraceTag(34936718,356,50,"FB dismiss"),D.a.isUserActionLoggingToOtelEnabled()&&k.d(e?S.a.feedbackSubmit:S.a.feedbackCancel,!0,null,2,8),e?(D.a.oldActionsPipelineIsEnabled()&&i.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.dataPlumber.Feedback|=32):(this.dataPlumber.Feedback|=16,this.doNPSTestAction()),this._eventSource.raiseEvent(ge.onFeedbackUiDismissedEventId,new P(e)),ge.allowKeytips(!0),this.onDismissedCallback&&(this.onDismissedCallback(),this.onDismissedCallback=null)}initializeFocus(){if(this._focusManager){let e=!1,t=5,n=!1;this._checkMainContentHolderIntervalId=this.clearInterval(this._checkMainContentHolderIntervalId),this._checkLikeButtonIntervalId=this.clearInterval(this._checkLikeButtonIntervalId),this._checkLikeButtonIntervalId=window.setInterval((()=>{if(this.likeButton){0,n=!0;const t=this._focusManager.getScope(ge.customerFeedbackFocusId);if(t.keyDownHandledExternally=!0,t.parent=I.a.mainAppFocusId,t.addDispose(ge.customerFeedbackScopeDispose),t.addSetFocus((()=>{let e=this._focusManager.getRegion(ge.customerFeedbackFocusId),t=null,n=5,a=!1;this._checkMainContentHolderIntervalId=window.setInterval((()=>{this.isElementVisible(this.mainContentHolder)&&(a=!0,this.likeButton.focus(),e||(e=this._focusManager.getRegion(ge.customerFeedbackFocusId)),e&&!t&&(t=e.listing),t&&t.trySetCurrentElement(this.likeButton)),n--,!a&&n||(this._checkMainContentHolderIntervalId=this.clearInterval(this._checkMainContentHolderIntervalId))}),1e3)})),e||(this._focusManager.pushScope(ge.customerFeedbackFocusId,!0),e=!0),this._feedbackTabHandlerEnabled&&this.mainContentHolder){const e=new M.a((()=>this.mainContentHolder));e.addValidTag(1),e.addValidTag(2),e.addValidTag(3),e.addValidTag(5);const t=this._focusManager.buildRegionWithDelegate((()=>this.mainContentHolder),this._focusManager.getScope(ge.customerFeedbackFocusId),e);t.rememberFocusStealers(),t.looped=!0,t.contained=!0,t.moveIntoRestore()}}t--,!n&&t||(this._checkLikeButtonIntervalId=this.clearInterval(this._checkLikeButtonIntervalId))}),1e3)}}clearInterval(e){return e!==ge.resetIntervalId&&(window.clearInterval(e),e=ge.resetIntervalId),e}removeFocus(){this._focusManager&&(this._focusManager.popScope(ge.customerFeedbackFocusId),this._focusManager.removeScope(ge.customerFeedbackFocusId))}determineComplianceChecks(e){this._isFeedbackComplianceCannotConsent?this._isFeedbackComplianceCannotPartialConsent||(e.ageGroup=4):e.ageGroup=3,r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser")?e.authenticationType=2:"aad"===r.AFrameworkApplication.appSettingsManager.getStringAppSetting("HostAuthType")?e.authenticationType=1:e.authenticationType=0}determineFeedbackForumContext(e){if(this._isFeedbackForumByConsentEnabled){const t="https://go.microsoft.com/fwlink/?linkid=2171883";e.myFeedbackForumUrl=t,e.MyFeedbackPortalUrl=t}if(this._isFeedbackForumByConsentEnabled){const t=ge.determineFeedbackForumUrl();null!=t&&(e.feedbackPortalUrl=t,e.feedbackForumUrl=t)}}static allowKeytips(e){r.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&R.a("allowKeytips")&&appChrome.api.allowKeytips(e)}static disabledUserFacts(){let e=null;try{const t=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.DisabledUserFacts","");t&&""!==t&&(e=t.split(","))}catch(e){i.ULS.sendTraceTag(509104515,356,10,"Could not parse DisabledUserFacts")}return e||new Array(0)}static getUserFactConfig(){const e={};return e.enableSendUserFacts=ge.enableSendUserFacts(),e.disabledUserFacts=ge.disabledUserFacts(),e.userFactRules=ge.createStaticUserFactRules(),e.personalizationEventSamplingRate=r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.PersonalizationEventSamplingRate",1),e.environment=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.PersonalizationEnvironment","Prod"),e}static createStaticUserFactRules(){const e=86400,t={};return t["Office.Excel.Online.UserAction.FormatAsTable"]=ue.getUserFactManifestParams(0,[],"FormatAsTableTried"),t["Office.Graphics.M365ContentPicker.GeneralInfo"]=ue.getUserFactManifestParams(0,[],"CreativeContentSeen"),t["Office.Graphics.M365ContentPicker.Insert"]=ue.getUserFactManifestParams(0,[],"CreativeContentTried"),t.ExcelWebLastUsed=ue.getUserFactManifestParams(e,[],"ExcelWebLastUsed"),t.PowerPointWebLastUsed=ue.getUserFactManifestParams(e,[],"PowerPointWebLastUsed"),t.WordWebLastUsed=ue.getUserFactManifestParams(e,[],"WordWebLastUsed"),t}static determineOCVData(e,t){if(!t)return;if(e.ringId=parseInt(t.Ring),isNaN(e.ringId))e.audienceGroup="Unknown",e.ringId=-2;else switch(e.ringId){case 0:case 1:e.audienceGroup="Dogfood";break;case 2:e.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:e.audienceGroup="Production";break;default:e.audienceGroup="Unknown"}let n=!0;t.Host&&(n="MsInternal"!==t.Host&&"Blue Chicken"!==t.Host),e.ocvEnvironment=n?0:1}static determineOCVFeedbackAppId(){let e=0;switch(x.a.application){case 2:e=w.f;break;case 4:e=w.c;break;case 3:e=w.d;break;case 1:e=w.b;break;case 5:e=w.e;break;default:i.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",x.a.application.toString())}return e}static determineOCVFeedbackAppColor(){const e={};let t="#2B579A",n="#3C65A4";switch(x.a.application){case 2:r.AFrameworkApplication.appSettingsManager&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")?(t="#185ABD",n="#2E6AC5"):(t="#2B579A",n="#3C65A4");break;case 4:t="#7719AA",n="#9953C0";break;case 3:t="#B7472A",n="#C75033";break;case 1:t="#217346",n="#3F8159";break;case 5:t="#3955A3",n="#4D6AB8";break;default:i.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",x.a.application.toString())}return e.primaryColour=t,e.secondaryColour=n,e}static determineFeedbackForumUrl(){let e=null;switch(x.a.application){case 2:e="https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";break;case 4:e="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";break;case 3:e="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";break;case 1:e="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";break;case 5:e="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:i.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",x.a.application.toString())}return e}static determineFeedbackUlsCategory(e){let t=356;switch(x.a.application){case 2:switch(e){case"Edit":t=364;break;case"View":case"Attendee":case"Presenter":t=363;break;default:0,i.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",r.AFrameworkApplication.activeFrame.modeName),t=363}break;case 4:t=362;break;case 3:switch(e){case"Edit":t=361;break;case"View":case"Attendee":case"Presenter":case"Outline":case"":t=360;break;default:0,i.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",r.AFrameworkApplication.activeFrame.modeName),t=360}break;case 1:switch(e){case"Edit":t=358;break;case"View":t=357;break;case"Survey":t=359;break;default:0,i.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",r.AFrameworkApplication.activeFrame.modeName),t=357}break;case 5:switch(e){case"View":t=373;break;case"Edit":t=374;break;default:0,i.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",r.AFrameworkApplication.activeFrame.modeName),t=373}break;default:i.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",x.a.application.toString())}return t}static customerFeedbackScopeDispose(){i.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static isNPSLocalizationTestingSession(){if(!ge.npsLocalizationTestingSession){const e=!!r.AFrameworkApplication.appSettingsManager&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(ge.npsTestActivityFlightBRS);ge.npsLocalizationTestingSession=e?2:1}return 2===ge.npsLocalizationTestingSession}extractUrlDomain(e){try{return new URL(e).origin.split(".").slice(-2).join(".")}catch(e){return i.ULS.sendTraceTag(507900614,356,10,e.toString()),""}}constructor(e,t){super(),this.mainContentHolderId="obf-MainContentHolder",this.likeButtonId="obf-OverallSmileAnchor",this.privacyStatementLinkId="obf-PrivacyStatementLink",this.contactFormContainerId="obf-MiddleFormContainer",this.commentBoxId="obf-BasicFormComment",this.submitButtonId="obf-BasicFormSubmitButton",this.suggestionButtonId="officeBrowserFeedbackOverallSuggestDiv",this.visibleClassName="obf-visible",this._checkLikeButtonIntervalId=ge.resetIntervalId,this._checkMainContentHolderIntervalId=ge.resetIntervalId,this._isFeedbackEnabled=!0,this._isFeedbackComplianceCannotConsent=!0,this._isFeedbackComplianceCannotPartialConsent=!0,this._isScreenshotEnabled=!1,this._isEmailEnabled=!1,this._isFeedbackIncludeLogEnabled=!1,this._isSurveyEnabled=!1,this._flagIsEmailEnabledSet=!1,this._flagIsFeedbackIncludeLogEnabledSet=!1,this._flagIsSurveyEnabledSet=!1,this._isFreemiumUpsellEnabled=!1,this._isAadcEnabled=!1,this._isFeedbackForumByConsentEnabled=!0,this._stylesUrl=null,this._intlUrl=null,this.onDismissedCallback=null,this._screenshotPolicy=0,this._feedbackPolicy=0,this._emailPolicy=0,this._feedbackIncludeLogPolicy=0,this._surveyPolicy=0,this._feedbackOptionsDefaultsEmailPolicy=0,this._feedbackOptionsDefaultsContentSamplesPolicy=0,this._feedbackOptionsDefaultsScreenshotPolicy=0,this._copilotFeedbackPolicy=0,this._dataPlumber=null,this._submitButton=null,this._likeButton=null,this._commentBox=null,this._suggestionButton=null,this._contactFormContainer=null,this._privacyStatementLink=null,this._mainContentHolder=null,this.delayFunctionCallTillPoliciesAreSet=async()=>{let e=0,t=ge.initialTimeDelayInMs;for(;!this.areFeedbackOCPSPoliciesSet();){if(e>ge.maxTimeDelayInMs)return void i.ULS.sendTraceTag(506017427,356,10,"Failed to retrieve correct OCPS policies due to timeout in delayFunctionCallTillPoliciesAreSet");await new Promise((e=>setTimeout(e,t))),t*=2,e+=t}},this._feedbackTabHandlerEnabled=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FeedbackTabHandlerEnabled"),this._focusManager=e,this.dataPlumber=t,this._eventSource=new pe.a;const n=this;(0,o.h)(d.a).execute((e=>{e.isFeatureEnabled("mso_sendASmile",n._isFeedbackEnabled).then((e=>(n._isFeedbackEnabled=e,null)),(e=>null)),e.isFeatureEnabled("FloodgateSurvey",n._isSurveyEnabled).then((e=>(n._isSurveyEnabled=e,n._flagIsSurveyEnabledSet=!0,null)),(e=>(n._flagIsSurveyEnabledSet=!0,null)))}));const a=this;if((0,o.h)(v.a).execute((e=>{e.getBooleanPolicySetting("IncludeScreenshot",!0,!1).then((e=>(a._isScreenshotEnabled=e,a._screenshotPolicy=e?1:2,null)),(e=>(a._isScreenshotEnabled="PolicyNotConfigured"===e,a._screenshotPolicy="PolicyNotConfigured"===e?0:2,null))),e.getBooleanPolicySetting("IncludeEmail",!0,!1).then((e=>(a._isEmailEnabled=e,a._flagIsEmailEnabledSet=!0,a._emailPolicy=e?1:2,null)),(e=>(a._flagIsEmailEnabledSet=!0,a._isEmailEnabled="PolicyNotConfigured"===e,a._emailPolicy="PolicyNotConfigured"===e?0:2,null))),e.getBooleanPolicySetting("FeedbackIncludeLog",!0,!1).then((e=>(a._isFeedbackIncludeLogEnabled=e,a._flagIsFeedbackIncludeLogEnabledSet=!0,a._feedbackIncludeLogPolicy=e?1:2,null)),(e=>(a._flagIsFeedbackIncludeLogEnabledSet=!0,a._isFeedbackIncludeLogEnabled="PolicyNotConfigured"===e,a._feedbackIncludeLogPolicy="PolicyNotConfigured"===e?0:2,null))),e.getBooleanPolicySetting("Enabled",!0,!1).then((e=>(a._feedbackPolicy=e?1:2,null)),(e=>(a._feedbackPolicy="PolicyNotConfigured"===e?0:2,null))),e.getBooleanPolicySetting("SurveyEnabled",!0,!1).then((e=>(a._surveyPolicy=e?1:2,null)),(e=>(a._surveyPolicy="PolicyNotConfigured"===e?0:2,null))),e.getBooleanPolicySetting("EmailDefault",!0,!1).then((e=>(a._feedbackOptionsDefaultsEmailPolicy=e?1:2,null)),(e=>(a._feedbackOptionsDefaultsEmailPolicy="PolicyNotConfigured"===e?0:2,null))),e.getBooleanPolicySetting("ContentSamplesDefault",!0,!1).then((e=>(a._feedbackOptionsDefaultsContentSamplesPolicy=e?1:2,null)),(e=>(a._feedbackOptionsDefaultsContentSamplesPolicy="PolicyNotConfigured"===e?0:2,null))),e.getBooleanPolicySetting("ScreenshotDefault",!0,!1).then((e=>(a._feedbackOptionsDefaultsScreenshotPolicy=e?1:2,null)),(e=>(a._feedbackOptionsDefaultsScreenshotPolicy="PolicyNotConfigured"===e?0:2,null))),e.getBooleanPolicySetting("sendcopilotfeedback",!0,!1).then((e=>(a._copilotFeedbackPolicy=e?1:2,null)),(e=>(a._copilotFeedbackPolicy="PolicyNotConfigured"===e?0:2,null)))})),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",!0)){this._isFreemiumUpsellEnabled=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PremiumUpsellIsEnabled");const e=this;(0,o.h)(d.a).execute((t=>{e._isFreemiumUpsellEnabled=t.isFreemiumUpsellEnabled(),t.isFeatureEnabled("mso_sendASmile",!1).then((t=>(e._isAadcEnabled=t,null)),(e=>null))}))}const s=this;(0,o.h)(d.a).execute((e=>{e.isFeatureEnabled("FeedbackForum",s._isFeedbackForumByConsentEnabled).then((e=>(s._isFeedbackForumByConsentEnabled=e,null)),(e=>null))}));const l=this;(0,o.h)(d.a).execute((e=>{e.isFeatureEnabled("FeedbackComplianceCannotConsent",l._isFeedbackComplianceCannotConsent).then((e=>(l._isFeedbackComplianceCannotConsent=e,null)),(e=>null))}));const c=this;(0,o.h)(d.a).execute((e=>{e.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",c._isFeedbackComplianceCannotPartialConsent).then((e=>(c._isFeedbackComplianceCannotPartialConsent=e,null)),(e=>null))}));const u=w.a.isFloodgateLatestVersionEnabled()?"latest/":"",p=`Feedback/${u}officebrowserfeedback.css`,g=`Feedback/${u}Intl/`;Q.a.instance.isShippingFrom1JSEnabled&&(this._stylesUrl=q.a.instance.getVersionedResourceUrl(w.a.isFloodgateEcsLatestVersionEnabled()?w.a.latestPackageName:w.a.stablePackageName,null,"styles/officebrowserfeedback.css"),this._intlUrl=q.a.instance.getVersionedResourceUrl(w.a.isFloodgateEcsLatestVersionEnabled()?w.a.latestPackageName:w.a.stablePackageName,null,"intl/")),this._stylesUrl&&this._intlUrl||(r.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WD1JSUrlFixes")?(this._stylesUrl=r.AFrameworkApplication.scriptUrlFromName(E.a.commonScriptsBase+p,9),this._intlUrl=r.AFrameworkApplication.scriptUrlFromName(E.a.commonScriptsBase+g,9)):(this._stylesUrl=E.a.commonScripts(p),r.AFrameworkApplication.wd1jsIsEnabled&&(this._stylesUrl=r.AFrameworkApplication.scriptUrlFromName(p,5)),this._intlUrl=E.a.commonScriptsPath(g),r.AFrameworkApplication.wd1jsIsEnabled&&(this._intlUrl=r.AFrameworkApplication.scriptUrlFromName(g,5,!1))))}}ge.customerFeedbackFocusId="CustomerFeedbackFocusId",ge.onFeedbackUiDismissedEventId="FUID",ge.resetIntervalId=-1,ge.npsLocalizationTestingSession=0,ge.npsTestActivityFlightBRS="NPSLocalizationTestingIsEnabled",ge.maxTimeDelayInMs=1e5,ge.initialTimeDelayInMs=300,(0,a.a)(ge,"CustomerFeedbackUiWrapper",se,[442]);const he=(0,o.e)(T,{onDemandRegister:(e,t)=>{e.register(ge,t).singleInstance().usingFactory((()=>new ge($.FocusManager.instance(),r.AFrameworkApplication.dataPlumber)))},_ignoreOnDemandRegister:()=>!r.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.9300847_CustomerFeedbackOnDemandTokenIsEnabled")});var me=n(4051);class _e{get dataPlumber(){return this._dataPlumber||(r.AFrameworkApplication.dataPlumber||(r.AFrameworkApplication.dataPlumber=new h.a),this._dataPlumber=r.AFrameworkApplication.dataPlumber),this._dataPlumber}set dataPlumber(e){this._dataPlumber=e}launchFeedbackFormWhenAvailable(e){this._contextData=e,this.initOFeedbackIfDepsReady()||this.loadResources()}launchModalDialogue(e,t){this._uiWrapper.showFeedbackModalDialogue(e,t)}loadResources(){this._loadingJs||(this._loadingJs=!0,this._resourceDownloadManager.downloadJsResource(this.oFeedbackJsDownloadFinished))}initOFeedbackIfDepsReady(){return!!this._jsDownloaded&&(this._uiWrapper.showUi(this._contextData),!0)}jsDownloaded(e){this._jsDownloaded=e}getJSDownloaded(){return this._jsDownloaded}constructor(e,t,n){this._loadingJs=!1,this._jsDownloaded=!1,this._contextData=null,this._dataPlumber=null,this.oFeedbackJsDownloadFinished=(e,t)=>{e?(this._jsDownloaded=!0,this.dataPlumber.Feedback|=2,this.initOFeedbackIfDepsReady(),i.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.dataPlumber.Feedback|=4,i.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed")),this._loadingJs=!1},this._uiWrapper=e,this._resourceDownloadManager=t,this.dataPlumber=n}}(0,a.a)(_e,"CustomerFeedbackC3FormManager",null,[370]);const Se=(0,o.e)(l,{onDemandRegister:(e,t)=>e.register(_e,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as(t).singleInstance().usingFactory((()=>new _e((0,o.a)(he),(0,o.a)(j),r.AFrameworkApplication.dataPlumber))),_ignoreOnDemandRegister:(0,me.a)(9373466)}),fe=(0,o.b)("Common.IUserInsights");var Ce=n(5737);class ye{callBackWithString(){return this._callbackWithString}callBackWithObject(){return this._callbackWithObject}activityName(){return this._activityName}object(){return this._obj}constructor(e,t,n,a,i=null){this._callbackWithString=e,this._activityName=t,this._callbackWithObject=n,this._obj=a}}(0,a.a)(ye,"OneCallBackData",null,[]);class Ae{add(e){e&&Array.addRange(this._callbacksData,e._callbacksData)}getCallbacksData(){return this._callbacksData}clearCallbacksData(){Array.clear(this._callbacksData)}constructor(e,t,n,a){this._callbacksData=[],Array.add(this._callbacksData,new ye(e,t,n,a))}}(0,a.a)(Ae,"CallBackData",null,[]);var be=n(6166);class Te extends be.a{constructor(e,t,n=null,a=!1,i=!1,o=null,r=null,s=null,l=!1,c=null,d=null,u=!1,p=null,g=null){super("FloodgateTeachingCallout"),this.title=null,this.smallHeadline=null,this.message=null,this.footer=null,this.image=null,this.positionImageAtLeft=!1,this.primaryButtonProps=null,this.secondaryButtonProps=null,this.showFeedbackBar=!1,this.positiveFeedbackAction=null,this.negativeFeedbackAction=null,this.showLearnMoreHref=!1,this.learnMoreDisplayText=null,this.learnMoreHref=null,this.footer=e,this.message=t,this.image=n,this.positionImageAtLeft=a,this.smallHeadline=i,this.title=o,this.primaryButtonProps=r,this.secondaryButtonProps=s,this.showFeedbackBar=l,this.positiveFeedbackAction=c,this.negativeFeedbackAction=d,this.showLearnMoreHref=u,this.learnMoreDisplayText=p,this.learnMoreHref=g}}(0,a.a)(Te,"FloodgateCalloutContent",be.a,[]);class ve{constructor(){this.options=null,this.props=null}}(0,a.a)(ve,"Notification",null,[]);class we{constructor(){this.label=null,this.onExecute=null,this.ariaDescription=null}}(0,a.a)(we,"CalloutButtonProps",null,[]);var Fe=n(5965),Ie=n(5970);class Ee extends be.a{constructor(e,t,n=null,a=null){super("PremiumUpsellCallout"),this.title=null,this.content=null,this.imageProps=null,this.imageHeight=null,this.title=e,this.content=t,this.imageProps=n,this.imageHeight=a}}(0,a.a)(Ee,"PremiumUpsellCalloutContentProps",be.a,[]);var Me=n(3263),ke=n(9557);class Pe{static convertAndShowTeachingUx(e){return Pe.getReactFloodgateNotificationsEnabled().then((t=>{try{const n=new Array(0);for(let a=0;a<e.length;a++){const i=e[a],o=Pe.isSupportedSurface(i.surfaceType),r=new ve;r.options=Pe.getNotificationOptions(i,!o),r.props=o?t.callout(Pe.makeOneCallout(e[a])):t.externalNotification(),n.push(r)}return Pe.showFloodgateTeachingUx(t,n)}catch(e){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+e.message)}}))}static isSupportedSurface(e){switch(e.toLowerCase()){case"teaching":case"coachmark":case"sequence":case"premiumupsell":return!0;default:return!1}}static getNotificationOptions(e,t){const n=new Ie.a;t&&(n.onShow=e.onUnsupportedSurfaceType);const a=e.surfaceContext?e.surfaceContext:null;return n.telemetryId="FloodgateTeachingUx-Surface "+(a&&a.surveyForm?a.surveyForm.getCampaignId():"Unknown"),n}static makeOneCallout(e){let t;"premiumupsell"!==e.surfaceType.toLowerCase()?(r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowTUIFeedbackBar",!1)?e.showFeedbackBar=!0:e.showFeedbackBar=!1,t=new Te(e.footer,e.description,e.illustrationImage?Object.assign(new ke.a(e.illustrationImage),{ariaLabel:e.imageAriaLabel}):null,"left"===e.position,e.smallHeadline,e.title,Pe.getCalloutButton(e.primaryButtonText,e.primaryButtonAction),Pe.getCalloutButton(e.secondaryButtonText,e.secondaryButtonAction),e.showFeedbackBar,e.feedbackPositiveButtonAction,e.feedbackNegativeButtonAction,e.showLearnMoreHref,e.learnMoreDisplayText,e.learnMoreHref)):t=new Ee(e.title,e.description,e.illustrationImage?Object.assign(new ke.a(e.illustrationImage),{ariaLabel:e.imageAriaLabel}):null);const n=r.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.AvoidInitialTUIFocus"),a=Object.assign(new Fe.a,{target:e.selector,content:t,showCloseIcon:null==e.hasCloseButton||e.hasCloseButton,preventLightDismiss:null!=e.preventAutoDismiss&&e.preventAutoDismiss,useTeachingStyles:!0,calloutProps:Object.assign(new Me.a,{onDismiss:t=>{e.onClosed&&(t?e.onClosed("close"):e.onClosed("auto dismiss"))},directionalHint:e.anchorHint,setInitialFocus:!n})});return"coachmark"===e.surfaceType.toLowerCase()?(a.hasDynamicSizing=!1,a.useCoachmark=!0,a.calloutProps.setInitialFocus=!1):"premiumupsell"===e.surfaceType.toLowerCase()&&(a.primaryButtonProps=Pe.getCalloutButton(e.primaryButtonText,e.primaryButtonAction),a.secondaryButtonProps=Pe.getCalloutButton(e.secondaryButtonText,e.secondaryButtonAction),a.showCloseIcon=!1,a.useTeachingStyles=!1,a.calloutProps.preventDismissOnLostFocus=!1),a}static getCalloutButton(e,t){return e&&""!==e&&t?Object.assign(new we,{label:e,onExecute:t}):(i.ULS.shipAssertTag(594569111,356,!(e&&""!==e||t),"A callout button needs both a caption and an action."),null)}static getReactFloodgateNotificationsEnabled(){return Pe.floodgateUxEnabledPromise||(r.AFrameworkApplication.activeFrame.applicationInstance.isReactNotificationsEnabled&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacFloodgateNotificationsIntegrationIsEnabled")?Pe.floodgateUxEnabledPromise=g.a.getNotificationsAPIAsync().then((e=>{const t=new Te(null,null);if(e.isCustomContentSupported&&e.isCustomContentSupported(t))return e;throw Error.create("Custom Content not supported: "+t.type)}),(e=>(i.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",e),null))):Pe.floodgateUxEnabledPromise=Promise.reject("React Notifications not enabled")),Pe.floodgateUxEnabledPromise}static showFloodgateTeachingUx(e,t){if(!t||!t.length)return new Array(0);const n=new Array(0);for(let a=0;a<t.length;a++){const i=t[a],o=Pe.showOneNotification(e,i);n.push(o)}return n}static showOneNotification(e,t){const n=e.addNotification(t.props,t.options);return()=>{e.removeNotification(n)}}}Pe.floodgateUxEnabledPromise=null,(0,a.a)(Pe,"FloodgateNotifications",null,[]);var De=n(5115);class Re{static getPersonalizationOAuthUri(){switch(r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.PersonalizationEnvironment","Prod")){case"Edog":return Re.edogPersonalizationOAuthUri;case"Int":return Re.intPersonalizationOAuthUri;default:return Re.defaultProductionPersonalizationOAuthUri}}static requestPersonalizationAuthToken(){const e=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost"),t=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser");return!e||t?(i.ULS.sendTraceTag(508641601,356,50,"PersonalizationAuthManager - Invalid user isConsumerHost={0}, isAnonymousUser={1}",e,t),Promise.resolve(null)):new Promise(((e,t)=>{(0,o.h)(De.a).execute((n=>{n||(i.ULS.sendTraceTag(508905243,356,15,"PersonalizationAuthManager oauthManager not valid"),t("PersonalizationAuthManager oauthManager not valid or auth is not supported in session"));const a=Re.getPersonalizationOAuthUri();n.tryGetToken("Tulips",a).then((n=>(n&&n.IsSuccess?(i.ULS.sendTraceTag(508905242,356,50,"PersonalizationAuthManager got auth token"),e(n.Token)):(i.ULS.sendTraceTag(508905241,356,15,"PersonalizationAuthManager Error - "+(n?n.ErrorMessage:"")),t("PersonalizationAuthManager oauthManager auth token Error - "+(n?n.ErrorMessage:""))),null)))}))}))}}Re.defaultProductionPersonalizationOAuthUri="https://attributes.engagement.office.com",Re.edogPersonalizationOAuthUri="https://attributes.engagement.officeppe.com",Re.intPersonalizationOAuthUri="https://attributes.engagement.office-int.com",(0,a.a)(Re,"PersonalizationAuthManager",null,[]);const xe=(e,t)=>{const n=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName");return!!t.ocvData&&2===t.ocvData.ringId&&Le(n)},Le=e=>!!(e=e.toLowerCase())&&(e.indexOf("linkedin.com")>0||e.indexOf("linkedin.biz")>0);class Ue{constructor(e,t){this.ocvData=e,this.context=t}}(0,a.a)(Ue,"SurveyMetadata",null,[]);var Oe=n(6012),Be=n(7531),Ne=n(7296),We=n(8103);class He{sendTelemetryEvent(e){try{e&&ue.processTelemetrySinkEvent(e)}catch(e){i.ULS.sendExceptionTraceTag(508871177,356,15,e,"Telemetry Listener Error: "+e.toString())}}}(0,a.a)(He,"OCVTelemetryListener",null,[]);var Ve=n(956);const Ge="obf-DynamicWebSurfaces";class Qe{initializeWACAppParameters(e){if(this.isInitialized&&this._appSpecificFeedbackData||this.isError)return i.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."),!1;if(null===e)return i.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"),!1;this.useCustomizedAppFloodgateStartStop=e.useCustomizedAppFloodgateStartStop;const t=e.getAppSpecificFeedbackData();return null===t?(i.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"),!1):this._appSpecificFeedbackData?(i.ULS.sendTraceTag(595142227,356,10,"SIFB: _appSpecificFeedbackData was already set. Not setting it again"),!1):(this._appSpecificFeedbackData=t,i.ULS.sendTraceTag(595142226,356,50,"SIFB: _appSpecificFeedbackData successfully set via call to InitializeWACAppParameters"),!0)}initializeSurveyRestrictions(){const e=this.customerFeedbackUiWrapperObject.getContext(null),t=new F;ge.determineOCVData(t,e),this.surveyMetadata=new Ue(t,e),this.restrictedSurveyActivityMap=new Ce.a,this.restrictedSurveyActivityMap.set_item("LinkedInWACUsage",xe),r.AFrameworkApplication.restrictedActivitiesInInteractiveReadOnlyMode.forEach((e=>{this.restrictedSurveyActivityMap.set_item(e,(()=>!r.AFrameworkApplication.isInteractiveReadOnlyMode))}))}get appSpecificFeedbackData(){return this._appSpecificFeedbackData||(this._appSpecificFeedbackData=(0,o.j)(s.a)),this._appSpecificFeedbackData}logActivity(e,t,n=null){e&&this.floodgateEnabled(e,Qe.mainSIFBBrs,t)&&(this.isInitialized?(i.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+e),ue.logActivity(e,n)):(i.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+e),this.initializeFloodgateThenDoAction(new Ae(ue.logActivity,e,null,n))))}logActivityDeferred(e,t){try{if(r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",!1)&&i.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+e),-1===this.deferredActivityDelayInMilliSeconds&&(this.deferredActivityDelayInMilliSeconds=r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",Qe.defaultDeferredActivityDelayInMilliSeconds)),!this.deferredActivityAllowedList){const e=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList"," ");this.deferredActivityAllowedList=e.toString().toLowerCase()}if(!r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.deferredActivityAllowedList&&e&&e.startsWith("Ribbon_")&&-1===this.deferredActivityAllowedList.indexOf(e.toLowerCase()))return void i.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored");if(!this.isInitialized)return void i.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+e);this.deferredActivityTimeoutId>0&&r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",!1)&&(window.clearTimeout(this.deferredActivityTimeoutId),i.ULS.sendTraceTag(592217693,356,50,"SIFB: LogActivityDeferred cancelled "+e)),this.deferredActivityTimeoutId=window.setTimeout((()=>{this.deferredActivityTimeoutId=0,this.logActivity(e,t)}),Qe.defaultDeferredActivityDelayInMilliSeconds)}catch(e){i.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+(e?e.toString():""))}}logActivityStart(e,t){e&&this.floodgateEnabled(e,Qe.mainSIFBBrs,t)&&(this.logActivityStartInternal(e,t),this.timeBasedSurveyActivityNames[e]=t)}logActivityStartInternal(e,t){this.floodgateEnabled(e,Qe.mainSIFBBrs,t)&&(this.isInitialized?(i.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+e),ue.logActivityStart(e,null)):(i.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+e),this.initializeFloodgateThenDoAction(new Ae(ue.logActivityStart,e,null,null))))}logActivityEnd(e,t){e&&this.isInitialized&&this.floodgateEnabled(e,Qe.mainSIFBBrs,t)&&(e in this.timeBasedSurveyActivityNames&&delete this.timeBasedSurveyActivityNames[e],this.logActivityEndInternal(e,t))}logActivityEndInternal(e,t){this.isInitialized&&this.floodgateEnabled(e,Qe.mainSIFBBrs,t)&&(i.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+e),ue.logActivityEnd(e))}showUserInitiatedSurvey(e,t,n){if(!r.AFrameworkApplication.showFeedbackButton)return void i.ULS.sendTraceTag(506574979,356,50,"SIFB: Feedback is disabled, preventing UserInitiatedSurvey '"+e+"' from showing");if(!this.isSurveyEnabled(Qe.mainSIFBBrs))return;if(!this.floodgateEnabled(e,Qe.mainSIFBBrs,t))return;if(!this.appSpecificFeedbackData)return void i.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null");const a=this.appSpecificFeedbackData.getUserInitiatedSurvey(e);a&&(this.isInitialized?(i.ULS.sendTraceTag(38605911,356,50,"SIFB:ShowUserInitiatedSurvey "+e),ue.showUserInitiatedSurvey(a),n?.()):(i.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+e),this.initializeFloodgateThenDoAction(new Ae(null,null,(e=>{ue.showUserInitiatedSurvey(e),n?.()}),a))))}floodgateEnabled(e,t,n){return!this.isError&&(r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateEnabledConfigAvailable",!1)?(this.messagingEnabled=this.isMessagingEnabled(),this.surveyEnabled=this.isSurveyEnabled(t),this.messagingEnabled||this.surveyEnabled?(this.createAppSpecificFeedbackDataIfRequired(),!!this.validateFCBRSandActivityNameRestrictions(e,n)&&(this.isFloodgateEnabledCheck||(this.isFloodgateEnabledCheck=!0,i.ULS.sendTraceTag(507250777,356,50,"SIFB: Floodgate is enabled, messagingEnabled: "+this.messagingEnabled+", surveyEnabled: "+this.surveyEnabled)),!0)):(this.isFloodgateEnabledCheck||(this.isFloodgateEnabledCheck=!0,i.ULS.sendTraceTag(507250778,356,15,"SIFB: floodgate is disabled for messaging and surveys")),!1)):!!this.isFloodgateEnabledInEnvironment()&&(this.createAppSpecificFeedbackDataIfRequired(),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnabledCampaignInAllLanguages",!1)?this.brSesEnabled(t,n)&&this.surveyRestrictionsSatisfied(e):(this.isDynamicWebCampaignActivity(e)||this.currentLanguageEnabled(e)||this.isAllowedCampaignActivity(e))&&this.brSesEnabled(t,n)&&this.surveyRestrictionsSatisfied(e)))}isMessagingEnabled(){return!!this.isFloodgateEnabledInEnvironment()}isSurveyEnabled(e){return!!this.isFloodgateEnabledInEnvironment()&&(!!r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e)||(i.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+e+") is off"),!1))}createAppSpecificFeedbackDataIfRequired(){if(!this._appSpecificFeedbackData){const e=(0,o.j)(s.a);e?this._appSpecificFeedbackData=e:i.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}return this._appSpecificFeedbackData}isFloodgateEnabledInRing(e){return 6!==e&&7!==e}isFloodgateEnabledInEnvironment(){if(0===this.floodgateEnabledInEnvironment){const e=this.customerFeedbackUiWrapperObject.getContext(null);this.floodgateEnabledInEnvironment=this.isFloodgateEnabledInRing(parseInt(e.Ring))?1:2,2===this.floodgateEnabledInEnvironment&&i.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.floodgateEnabledInEnvironment}surveyRestrictionsSatisfied(e){return null===this.restrictedSurveyActivityMap&&this.initializeSurveyRestrictions(),!(e&&this.restrictedSurveyActivityMap&&this.restrictedSurveyActivityMap.containsKey(e))||this.restrictedSurveyActivityMap.get_item(e)(e,this.surveyMetadata)}validateFCBRSandActivityNameRestrictions(e,t){return t&&!r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(t)?(i.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+t+") is off"),!1):this.surveyRestrictionsSatisfied(e)}getCurrentLocaleLowerCase(){if(!this.currentLocaleLowerCase&&!this.attemptedGettingCurrentLocale){this.attemptedGettingCurrentLocale=!0;const e=this.customerFeedbackUiWrapperObject.getContext(null);this.currentLocaleLowerCase="locale"in e?e.locale:"",this.currentLocaleLowerCase=this.currentLocaleLowerCase.toLowerCase()}return this.currentLocaleLowerCase}currentLanguageEnabled(e){return this.currentLocaleLowerCase||(this.currentLocaleLowerCase=this.getCurrentLocaleLowerCase()),!!(this.currentLocaleLowerCase&&this.currentLocaleLowerCase.length&&e&&e.length)&&("en-us"===this.currentLocaleLowerCase||this.isNlqsCampaignActivity(e)||ge.isNPSLocalizationTestingSession()||this.isNPSActivity(e))}isNPSActivity(e){return this.appSpecificFeedbackData?e===this.appSpecificFeedbackData.getNPSUsageActivityName()||e===this.appSpecificFeedbackData.getNPSFollowupActivityName()||"SuiteUsageNPS"===e||"SuiteUsageTimeSatisfiedNPS"===e:(i.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+e),!1)}isDynamicWebCampaignActivity(e){return!!e&&-1!==e.toLowerCase().indexOf("floodgateflight")}isNlqsCampaignActivity(e){return!!e&&-1!==e.toLowerCase().indexOf("nlqs")}brSesEnabled(e,t){return r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e)?!(t&&!r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(t))||(i.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+t+") is off"),!1):(i.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+e+") is off"),!1)}isAllowedCampaignActivity(e){const t=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!e&&!!t&&-1!==t.toLowerCase().indexOf(e.toLowerCase())}initializeFloodgateThenDoAction(e){r.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((()=>{try{this.downloadResources(e)}catch(e){i.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+e)}}))}trySetCampaignTriggerData(e,t){const n=this.getLocalStorage();if(n)try{n.setItem(this.constructKey(e),t)}catch(e){}else i.ULS.sendTraceTag(36546387,356,10,"SIFB.Error:Trigger data !set, Storage.Local null");return!!n}getCampaignTriggerData(e){const t=this.getLocalStorage();if(t)try{return t.getItem(this.constructKey(e))}catch(e){}return null}removeCampaignTriggerData(e){const t=this.getLocalStorage();if(t)try{t.removeItem(this.constructKey(e))}catch(e){}}registerActivationCallback(e,t){ue.registerActivationCallback(e,t)}startFloodgate(){this.useCustomizedAppFloodgateStartStop&&this.start()}stopFloodgate(){this.useCustomizedAppFloodgateStartStop&&this.stop()}start(){if(i.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized),this.isInitialized)if(r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",!1)){const e=Ne.a.createOnIdle(1,r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateAfterIdleCallbackDelayMs",10),this.startSurvey,r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1e3));r.AFrameworkApplication.theTaskManager.addTask(e)}else this.startSurvey(null)}stop(){i.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized),this.isInitialized&&(this.timeBasedSurveysEnd(),ue.floodgateStop())}timeBasedSurveysStart(){const e=this.timeBasedSurveyActivityNames;for(const t in e){const n={key:t,value:e[t]};this.logActivityStartInternal(n.key,n.value)}}timeBasedSurveysEnd(){const e=this.timeBasedSurveyActivityNames;for(const t in e){const n={key:t,value:e[t]};this.logActivityEndInternal(n.key,n.value)}}constructKey(e){return x.a.application.toString()+e}downloadResources(e){i.ULS.sendTraceTag(36546388,356,100,"SIFB: Entered DownloadResources");const t=(0,o.a)(Se);if(t)if(t.getJSDownloaded())this.floodgateJsDownloadFinished(!0,e);else{const t=(0,o.a)(j);t.setCallerData(e),t.downloadJsResource(this.floodgateJsDownloadFinished)}}postDownloadJsInitFailure(e,t){this.isError=!0,i.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+e+". "+t.toString())}async postDownloadJsInit(){const e=(0,o.a)(Se);e&&e.jsDownloaded(!0),this.setupCampaigns(),this.setWindowEvents();try{await ue.isCopilotLicenseConfigurationSuccessful()}catch(e){i.ULS.sendTraceTag(508368320,356,10,"Error in call for BrowserFeedbackControlOCV.isCopilotLicenseConfigurationSuccessful "+(e?e.toString():" "))}if(r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost"))return this.getAllContextForFloodgatePromise().then((e=>(this.logFloodgateInitState(e),e))).then((e=>ue.initSIFeedback(new He,this.onSIFeedbackDismiss,(0,u.a)(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onError,"onError"),e,(0,u.a)(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onDismiss,"onDismiss"))));if(r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost")&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled"))return Qe.delayCustomMs(this.getInitDelayTimeInMs()).then((e=>{const t=this.getAllContextForFloodgate();return this.logFloodgateInitState(t),t})).then((e=>ue.initSIFeedback(new He,this.onSIFeedbackDismiss,(0,u.a)(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onError,"onError"),e,(0,u.a)(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onDismiss,"onDismiss"))));{const e=this.getAllContextForFloodgate();return this.logFloodgateInitState(e),ue.initSIFeedback(new He,this.onSIFeedbackDismiss,(0,u.a)(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onError,"onError"),e,(0,u.a)(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onDismiss,"onDismiss"))}}getAllContextForFloodgatePromise(){return new Promise(((e,t)=>{(0,o.h)(d.a).execute((t=>{const n=this.getAllContextForFloodgate();t.isFeatureEnabled("FloodgateSurvey",!0).then((t=>(n.surveyEnabled="surveyEnabled"in n?t&&n.surveyEnabled:t,e(n),null)),(t=>(i.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",t.toString()),e(n),null)))}))}))}getCustomMessagingServiceSettings(){let e=null;try{const t=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",null);t&&(e=L.b(t))}catch(e){i.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return e||{}}getAllContextForFloodgate(){const e=this.customerFeedbackUiWrapperObject.getContext(null);return e.FloodgateUIAutoDismissTimeEnum=this.getAutoDismissTimeEnum(),e.uIStringGetter=this.floodgateUIStringGetter,e.authTokenCallback=Qe.createAuthTokenHandler((0,p.a)(String,e.AudienceGroup)),e.featureStatusCallback=Qe.createFeatureStatusCallback(),e.userFactsReadConfig=Qe.createPersonalizationUserFactsReadConfig(),e.personalizationSettings=Qe.createPersonalizationSettings(),e.onTeachingCampaignRender=Qe.convertAndShowTeachingUx,e.governanceServiceEnabled=Qe.getGovernanceServiceIsEnabled(),e.governanceServiceConfig=Qe.getGovernanceServiceConfig(),e.personalizerEnabled=r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1),e.messagingServiceSettings=this.getCustomMessagingServiceSettings(),e.isPriorityEnabled=Qe.getPrioritySurveySettings(),e.enableWebCampaignGovernance=Qe.enableWebCampaignGovernance(),e.enableOutOfScopeTelemetry=Qe.enableOutOfScopeTelemetry(),e.campaignTelemetrySamplingConfig=Qe.getCampaignTelemetrySamplingConfig(),w.a.isFloodgateSurveyDynamicUxEnabled()&&(e.dynamicUxConfig=Qe.getDynamicUxConfig(e.Application,e.appId)),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateEnabledConfigAvailable",!1)&&(e.messagingEnabled=this.messagingEnabled,e.surveyEnabled="surveyEnabled"in e?e.surveyEnabled&&this.surveyEnabled:this.surveyEnabled),(()=>{if(!r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsUserInsightsEnabled",!1))return!1;const e=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost"),t=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser");return!(!e||t||!r.AFrameworkApplication.isSkyDrive)})()&&(e.userInsightsProviderPromise=new Promise(((e,t)=>{(0,o.h)(fe).execute((t=>e(t)))}))),e}logFloodgateInitState(e){const t=this.customerFeedbackUiWrapperObject.areFeedbackOCPSPoliciesSet(),n=this.getInitDelayTimeInMs(),a=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost"),o=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost"),s=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled"),l="surveyEnabled"in e?e.surveyEnabled:"null or undefined",c="showEmailAddress"in e?e.showEmailAddress:"null or undefined",d=Qe.getGovernanceServiceIsEnabled(),u=r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1),p=w.a.isFloodgateDynamicCampaignEnabled(),g=w.a.isFloodgateEcsLatestVersionEnabled(),h=w.a.isFloodgateSurveyDynamicUxEnabled();if(w.a.isFloodgateDebugLoggingEnabled()){const e=Ve.a.instance.getItem("obf-DynamicCampaignDefinitions");i.ULS.sendTraceTag(507548321,356,50,"SIFB DynamicCampaignItems:"+JSON.stringify(e))}const m="messagingEnabled"in e?e.messagingEnabled:"null or undefined";i.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "IsO365CommercialHost": "{1}", "IsO365ConsumerHost": "{2}", "OcpsIsEnabled": "{3}", "FGInitDelayTime": "{4}", "ShowEmailAddress": "{5}", "surveyEnabled": "{6}", "governanceServiceEnabled": "{7}", "governanceServiceConfig": "{8}", "personalizerEnabled": "{9}", "dynamicCampaignEnabled": "{10}", "dynamicCampaignLatestVersionEnabled": "{11}", "dynamicUxEnabled": "{12}", "messagingEnabled": "{13}"',t,a,o,s,n,c,l,d,L.c(e.governanceServiceConfig),u,p,g,h,m)}getAutoDismissTimeEnum(){return xe(0,this.surveyMetadata)?(i.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):r.AFrameworkApplication.appSettingsManager.getIntAppSetting("FloodgateUIAutoDismissTimeEnum",4)}getInitDelayTimeInMs(){return r.AFrameworkApplication.appSettingsManager.getIntAppSetting("FloodgateContextAndInitDelayInMilliSeconds",Qe.defaultPostDownloadJsInitDelayInMilliSeconds)}doPostInitializationWork(e){if(this.isInitialized=!0,this.addWebCampaignUIEventListener(),ue.setCustomTriggerEventCallback((0,u.a)(this,this.logTriggerTelemetry,"logTriggerTelemetry")),e){for(const t of e.getCallbacksData())t.callBackWithString()?t.callBackWithString()(t.activityName(),t.object()):t.callBackWithObject()?t.callBackWithObject()(t.object()):i.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");e.clearCallbacksData()}else i.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const e=this.customerFeedbackUiWrapperObject.getContext(null),t=ue.getFloodgateFlightParameters(Array.isArray(e.Flights)?e.Flights:null),n=t?(0,p.a)(String,t.SelfTriggerActivity):null;if(n)for(const e of n.split(";"))e&&""!==e&&this.logActivity(e,null)}catch(e){i.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+(e?e.toString():""))}}addWebCampaignUIEventListener(){if(!this.isEventListenerAdded&&window.addEventListener){const e=this.onWebCampaignEvent;window.addEventListener("FGWebSurfaceEvent",e,!0),this.isEventListenerAdded=!0}}logCampaignTriggerEvent(e,t){i.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+t)}logTriggerTelemetry(e,t){if(t=t||{},e){const n=Qe.getFlightId(e);n&&(t.flightId=n)}this.logCampaignTriggerEvent(e,JSON.stringify(t))}removeDisabledCampaigns(e){if(!e)return null;try{const t=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase();if(!t||""===t)return e;const n=L.b(e),a=new H.a;let o=0;for(const e of n){const n=e.CampaignId;n&&-1!==t.indexOf(n.toLowerCase())?(i.ULS.sendTraceTag(509167254,356,50,"Ignoring disabled campaign -"+n),o++):a.add(e)}return o?L.c(a.toArray()):e}catch(t){return i.ULS.sendTraceTag(509167253,356,10,"Error filtering out disabled campaigns"),e}}setupCampaigns(){let e=!1,t=null;const n=this.getLocalStorage();if(n&&this.appSpecificFeedbackData)try{let a=this.appSpecificFeedbackData.getCampaignDefinitions();r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FilterDisabledCampaigns",!0)&&(a=this.removeDisabledCampaigns(a)),a?(n.setItem(Qe.campaignDefinitionKey,a),e=!0):(t="SIFB.campaign str was null",i.ULS.sendTraceTag(594143442,356,10,t))}catch(e){t="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+e,i.ULS.sendTraceTag(594143441,356,50,t)}else this.appSpecificFeedbackData?(t="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",i.ULS.sendTraceTag(594143440,356,50,t)):(t="SIFB.Floodgate surveys not available. App Specific Feedback data was null",i.ULS.sendTraceTag(556896920,356,50,t));return i.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+e+" errorString: "+(t||"null")),e}setWindowEvents(){this.useCustomizedAppFloodgateStartStop||(Be.a.addHandler(window.self,Oe.a.focus,this.onWindowFocus),Be.a.addHandler(window.self,Oe.a.blur,this.onWindowBlur))}getLocalStorage(){if(!this.haveAccessToLocalStorage)return null;let e=null;try{e=localStorage}catch(t){this.haveAccessToLocalStorage=!1,e=null,i.ULS.sendTraceTag(594052320,356,50,"SIFB.GetLocalStorage error "+(t?t.toString():""))}return e}initializeUIStringGetter(){i.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.floodgateUIStringMap=new Z.a(X.a.get_ordinalIgnoreCase()),this.floodgateUIStringMap.set_item("nps_Title",(0,We.a)("WAC_NPS_Title")),this.floodgateUIStringMap.set_item("nps_PromptQuestion",(0,We.a)("WAC_NPS_PromptQuestion")),this.floodgateUIStringMap.set_item("nps_RatingQuestion",(0,We.a)("WAC_NPS_RatingQuestion")),this.floodgateUIStringMap.set_item("nps_RatingQuestion_Word",Qe.get_Nps_RatingQuestion_Word()),this.floodgateUIStringMap.set_item("nps_RatingQuestion_OneNote",Qe.get_Nps_RatingQuestion_OneNote()),this.floodgateUIStringMap.set_item("nps_OneClickPromptQuestion_PPT",(0,We.a)("WAC_NPS_OneClickPromptQuestion_PPT")),this.floodgateUIStringMap.set_item("nps_OneClickPromptQuestion_Excel",(0,We.a)("WAC_NPS_OneClickPromptQuestion_Excel")),this.floodgateUIStringMap.set_item("nps_OneClickRatingQuestion_Excel",Qe.get_Nps_RatingQuestion_Excel()),this.floodgateUIStringMap.set_item("nps_OneClickRatingQuestion_PowerPoint",Qe.get_Nps_RatingQuestion_PowerPoint()),this.floodgateUIStringMap.set_item("nps_RatingQuestion_PowerPoint",Qe.get_Nps_RatingQuestion_PowerPoint()),this.floodgateUIStringMap.set_item("nps_RatingQuestion_Excel",Qe.get_Nps_RatingQuestion_Excel()),this.floodgateUIStringMap.set_item("nps_RatingQuestion_Visio",(0,We.a)("WAC_NPS_RatingQuestion_Visio")),this.floodgateUIStringMap.set_item("nps_Rating_Values_1",(0,We.a)("WAC_NPS_Rating_Values_1")),this.floodgateUIStringMap.set_item("nps_Rating_Values_2",(0,We.a)("WAC_NPS_Rating_Values_2")),this.floodgateUIStringMap.set_item("nps_Rating_Values_3",(0,We.a)("WAC_NPS_Rating_Values_3")),this.floodgateUIStringMap.set_item("nps_Rating_Values_4",(0,We.a)("WAC_NPS_Rating_Values_4")),this.floodgateUIStringMap.set_item("nps_Rating_Values_5",(0,We.a)("WAC_NPS_Rating_Values_5")),this.floodgateUIStringMap.set_item("nps_QuestionQuestion",(0,We.a)("WAC_NPS_Rating_QuestionQuestion")),this.floodgateUIStringMap.set_item("nps_OneClickPromptQuestion",(0,We.a)("WAC_NPS_OneClickPromptQuestion")),this.floodgateUIStringMap.set_item("nps_OneClickRatingQuestion_Word",Qe.get_Nps_RatingQuestion_Word()),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_1",(0,We.a)("WAC_NPS_OneClickRating_Values_1")),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_2",(0,We.a)("WAC_NPS_OneClickRating_Values_2")),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_3",(0,We.a)("WAC_NPS_OneClickRating_Values_3")),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_4",(0,We.a)("WAC_NPS_OneClickRating_Values_4")),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_5",(0,We.a)("WAC_NPS_OneClickRating_Values_5")),this.floodgateUIStringMap.set_item("nps_Suite_RatingQuestion","How likely are you to recommend Microsoft 365 to others, if asked?"),this.floodgateUIStringMap.set_item("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.floodgateUIStringMap.set_item("NSVPromptTitle",(0,We.a)("Excel_NSV_Prompt")),this.floodgateUIStringMap.set_item("NSVTimedSurvey_Question",(0,We.a)("Excel_NSV_Overview_Question")),this.floodgateUIStringMap.set_item("SatisfactionRating_1",(0,We.a)("Excel_Rating_1_Satisfied")),this.floodgateUIStringMap.set_item("SatisfactionRating_2",(0,We.a)("Excel_Rating_2_Satisfied")),this.floodgateUIStringMap.set_item("SatisfactionRating_3",(0,We.a)("Excel_Rating_3_Satisfied")),this.floodgateUIStringMap.set_item("SatisfactionRating_4",(0,We.a)("Excel_Rating_4_Satisfied")),this.floodgateUIStringMap.set_item("SatisfactionRating_5",(0,We.a)("Excel_Rating_5_Satisfied")),this.floodgateUIStringMap.set_item("NSV_Timed_Feedback_Freeform_Question",(0,We.a)("Excel_NSV_Timed_Feedback_Freeform_Question")),this.floodgateUIStringMap.set_item("NSV_Prompt_Title_Feedback",(0,We.a)("Title_For_NSV_Floodgate_Prompt")),this.floodgateUIStringMap.set_item("NSVDidntCreateSheetViewQuestion",(0,We.a)("NSV_Didnt_Create_NSV_Survey_Question")),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_1",(0,We.a)("NSV_Didnt_Create_NSV_Option_1")),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_2",(0,We.a)("NSV_Didnt_Create_NSV_Option_2")),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_3",(0,We.a)("NSV_Didnt_Create_NSV_Option_3")),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_4",(0,We.a)("NSV_Didnt_Create_NSV_Option_4")),this.floodgateUIStringMap.set_item("NSVFreeformDidntCreateSheetView",(0,We.a)("NSV_Freeform_Reason_Didnt_Create_SheetView")),this.floodgateUIStringMap.set_item("NSVDidntCreatePrompt",(0,We.a)("NSV_Didnt_Create_SheetView_Prompt")),this.floodgateUIStringMap.set_item("NSVPromptQuestion",(0,We.a)("NSV_PromptQuestion")),this.floodgateUIStringMap.set_item("CatchUpFPS_Title",(0,We.a)("WAC_CatchUpFPS_Title")),this.floodgateUIStringMap.set_item("CatchUpFPS_Question",(0,We.a)("WAC_CatchUpFPS_Question")),this.floodgateUIStringMap.set_item("CatchUpFPS_YesLabel",(0,We.a)("WAC_CatchUpFPS_YesLabel")),this.floodgateUIStringMap.set_item("CatchUpFPS_NoLabel",(0,We.a)("WAC_CatchUpFPS_NoLabel")),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingQuestion",(0,We.a)("WAC_CatchUpFPS_RatingQuestion")),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_1",(0,We.a)("WAC_CatchUpFPS_RatingValue_1")),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_2",(0,We.a)("WAC_CatchUpFPS_RatingValue_2")),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_3",(0,We.a)("WAC_CatchUpFPS_RatingValue_3")),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_4",(0,We.a)("WAC_CatchUpFPS_RatingValue_4")),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_5",(0,We.a)("WAC_CatchUpFPS_RatingValue_5")),this.floodgateUIStringMap.set_item("CatchUpFPS_WhyQuestion",(0,We.a)("WAC_CatchUpFPS_WhyQuestion")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePromptTitle",(0,We.a)("WAC_ReviewMode_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePromptQuestion",(0,We.a)("WAC_ReviewMode_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePrompt_YesLabel",(0,We.a)("WAC_ReviewMode_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePrompt_NoLabel",(0,We.a)("WAC_ReviewMode_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRatingQuestion",(0,We.a)("WAC_ReviewMode_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_1",(0,We.a)("WAC_ReviewMode_FloodgateRating_1")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_2",(0,We.a)("WAC_ReviewMode_FloodgateRating_2")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_3",(0,We.a)("WAC_ReviewMode_FloodgateRating_3")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_4",(0,We.a)("WAC_ReviewMode_FloodgateRating_4")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_5",(0,We.a)("WAC_ReviewMode_FloodgateRating_5")),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateQuestion",(0,We.a)("WAC_ReviewMode_FloodgateQuestion")),this.floodgateUIStringMap.set_item("collab_RatingQuestion_Visio",(0,We.a)("Visio_Collab_RatingQuestion")),this.floodgateUIStringMap.set_item("collab_Title_Visio",(0,We.a)("Visio_Collab_Title")),this.floodgateUIStringMap.set_item("collab_Prompt_Question_Visio",(0,We.a)("Visio_Collab_Prompt_Question")),this.floodgateUIStringMap.set_item("collab_Rating_Values_1",(0,We.a)("Visio_Collab_FPS_Rating_Values_1")),this.floodgateUIStringMap.set_item("collab_Rating_Values_2",(0,We.a)("Visio_Collab_FPS_Rating_Values_2")),this.floodgateUIStringMap.set_item("collab_Rating_Values_3",(0,We.a)("Visio_Collab_FPS_Rating_Values_3")),this.floodgateUIStringMap.set_item("collab_Rating_Values_4",(0,We.a)("Visio_Collab_FPS_Rating_Values_4")),this.floodgateUIStringMap.set_item("collab_Rating_Values_5",(0,We.a)("Visio_Collab_FPS_Rating_Values_5")),this.floodgateUIStringMap.set_item("collab_Question_Visio",(0,We.a)("Visio_Collab_Question")),this.floodgateUIStringMap.set_item("connector_campaign_Survey_Question",(0,We.a)("VisioWeb_ConnectorCampaign_Survey_Question")),this.floodgateUIStringMap.set_item("connector_campaign_Title",(0,We.a)("VisioWeb_ConnectorCampaign_Title")),this.floodgateUIStringMap.set_item("connector_campaign_Prompt_Question",(0,We.a)("VisioWeb_ConnectorCampaign_Prompt_Question")),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_1",(0,We.a)("VisioWeb_ConnectorCampaign_Rating_Values_1")),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_2",(0,We.a)("VisioWeb_ConnectorCampaign_Rating_Values_2")),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_3",(0,We.a)("VisioWeb_ConnectorCampaign_Rating_Values_3")),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_4",(0,We.a)("VisioWeb_ConnectorCampaign_Rating_Values_4")),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_5",(0,We.a)("VisioWeb_ConnectorCampaign_Rating_Values_5")),this.floodgateUIStringMap.set_item("connector_campaign_Verbatim_Question",(0,We.a)("VisioWeb_ConnectorCampaign_Verbatim_Question")),this.floodgateUIStringMap.set_item("DictationV2_Title",(0,We.a)("WAC_DictationV2_FloodgateSurvey_Title")),this.floodgateUIStringMap.set_item("DictationV2_GreetingQuestion",(0,We.a)("WAC_DictationV2_FloodgateSurvey_GreetingQuestion")),this.floodgateUIStringMap.set_item("DictationV2_GreetingAnswer_Sure",(0,We.a)("WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure")),this.floodgateUIStringMap.set_item("DictationV2_GreetingAnswer_Notnow",(0,We.a)("WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow")),this.floodgateUIStringMap.set_item("DictationV2_RatingQuestion",(0,We.a)("WAC_DictationV2_FloodgateSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_1",(0,We.a)("WAC_DictationV2_FloodgateSurvey_RatingAnswer_1")),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_2",(0,We.a)("WAC_DictationV2_FloodgateSurvey_RatingAnswer_2")),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_3",(0,We.a)("WAC_DictationV2_FloodgateSurvey_RatingAnswer_3")),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_4",(0,We.a)("WAC_DictationV2_FloodgateSurvey_RatingAnswer_4")),this.floodgateUIStringMap.set_item("DictationV2_RatingAnswer_5",(0,We.a)("WAC_DictationV2_FloodgateSurvey_RatingAnswer_5")),this.floodgateUIStringMap.set_item("DictationV2_PromptQuestion",(0,We.a)("WAC_DictationV2_FloodgateSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_Title",(0,We.a)("WAC_OfficeScriptsFPS_Title")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_Question",(0,We.a)("WAC_OfficeScriptsFPS_Question")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_YesLabel",(0,We.a)("WAC_OfficeScriptsFPS_YesLabel")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_NoLabel",(0,We.a)("WAC_OfficeScriptsFPS_NoLabel")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingQuestion",(0,We.a)("WAC_OfficeScriptsFPS_RatingQuestion")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_1",(0,We.a)("WAC_OfficeScriptsFPS_RatingValue_1")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_2",(0,We.a)("WAC_OfficeScriptsFPS_RatingValue_2")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_3",(0,We.a)("WAC_OfficeScriptsFPS_RatingValue_3")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_4",(0,We.a)("WAC_OfficeScriptsFPS_RatingValue_4")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_RatingValue_5",(0,We.a)("WAC_OfficeScriptsFPS_RatingValue_5")),this.floodgateUIStringMap.set_item("OfficeScriptsFPS_WhyQuestion",(0,We.a)("WAC_OfficeScriptsFPS_WhyQuestion")),this.floodgateUIStringMap.set_item("OfficeScriptsFloodGate_Title",(0,We.a)("WAC_OfficeScriptsFloodGate_Title")),this.floodgateUIStringMap.set_item("OfficeScriptsFloodGate_Question",(0,We.a)("WAC_OfficeScriptsFloodGate_Question")),this.floodgateUIStringMap.set_item("OfficeScriptsFloodGate_RatingQuestion",(0,We.a)("WAC_OfficeScriptsFloodGate_RatingQuestion")),this.floodgateUIStringMap.set_item("OfficeScriptsFloodGate_RatingValue_1",(0,We.a)("WAC_OfficeScriptsFloodGate_RatingValue_1")),this.floodgateUIStringMap.set_item("OfficeScriptsFloodGate_RatingValue_2",(0,We.a)("WAC_OfficeScriptsFloodGate_RatingValue_2")),this.floodgateUIStringMap.set_item("OfficeScriptsFloodGate_RatingValue_3",(0,We.a)("WAC_OfficeScriptsFloodGate_RatingValue_3")),this.floodgateUIStringMap.set_item("OfficeScriptsFloodGate_HowQuestion",(0,We.a)("WAC_OfficeScriptsFloodGate_HowQuestion")),this.floodgateUIStringMap.set_item("ExcelAddins_Prompt",(0,We.a)("Excel_Addins_Prompt")),this.floodgateUIStringMap.set_item("ExcelAddins_PromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("ExcelAddins_Rating_Question",(0,We.a)("Excel_Addins_Rating_Question")),this.floodgateUIStringMap.set_item("ExcelAddins_QuestionQuestion",(0,We.a)("Excel_Addins_QuestionQuestion")),this.floodgateUIStringMap.set_item("ExcelAddins_Rating_1_Expectations",(0,We.a)("Excel_Addins_Choice_1")),this.floodgateUIStringMap.set_item("ExcelAddins_Rating_2_Expectations",(0,We.a)("Excel_Addins_Choice_2")),this.floodgateUIStringMap.set_item("ExcelAddins_Rating_3_Expectations",(0,We.a)("Excel_Addins_Choice_3")),this.floodgateUIStringMap.set_item("ExcelAddins_Rating_4_Expectations",(0,We.a)("Excel_Addins_Choice_4")),this.floodgateUIStringMap.set_item("ExcelAddins_Rating_5_Expectations",(0,We.a)("Excel_Addins_Choice_5")),this.floodgateUIStringMap.set_item("ExcelIdeas_Prompt",(0,We.a)("Excel_Ideas_Prompt")),this.floodgateUIStringMap.set_item("ExcelIdeas_PromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_Question",(0,We.a)("Excel_Ideas_Rating_Question")),this.floodgateUIStringMap.set_item("ExcelIdeas_ExpectationsQuestion",(0,We.a)("Excel_Ideas_ExpectationsQuestion")),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_1_Expectations",(0,We.a)("Excel_Rating_1_Expectations")),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_2_Expectations",(0,We.a)("Excel_Rating_2_Expectations")),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_3_Expectations",(0,We.a)("Excel_Rating_3_Expectations")),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_4_Expectations",(0,We.a)("Excel_Rating_4_Expectations")),this.floodgateUIStringMap.set_item("ExcelIdeas_Rating_5_Expectations",(0,We.a)("Excel_Rating_5_Expectations")),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Prompt",(0,We.a)("Excel_RecommendedCharts_Prompt")),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_PromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_Question",(0,We.a)("Excel_RecommendedCharts_Rating_Question")),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_WhyQuestion",(0,We.a)("Excel_RecommendedCharts_WhyQuestion")),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_1_Satisfied",(0,We.a)("ExcelRecommendedCharts_Rating_1_Satisfied")),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_2_Satisfied",(0,We.a)("ExcelRecommendedCharts_Rating_2_Satisfied")),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_3_Satisfied",(0,We.a)("ExcelRecommendedCharts_Rating_3_Satisfied")),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_4_Satisfied",(0,We.a)("ExcelRecommendedCharts_Rating_4_Satisfied")),this.floodgateUIStringMap.set_item("ExcelRecommendedCharts_Rating_5_Satisfied",(0,We.a)("ExcelRecommendedCharts_Rating_5_Satisfied")),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Prompt",(0,We.a)("Excel_RecommendedPivotTable_Prompt")),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_PromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_Question",(0,We.a)("Excel_RecommendedPivotTable_Rating_Question")),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_ExpectationsQuestion",(0,We.a)("Excel_RecommendedPivotTable_ExpectationsQuestion")),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_1_Expectations",(0,We.a)("Excel_Rating_1_Expectations")),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_2_Expectations",(0,We.a)("Excel_Rating_2_Expectations")),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_3_Expectations",(0,We.a)("Excel_Rating_3_Expectations")),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_4_Expectations",(0,We.a)("Excel_Rating_4_Expectations")),this.floodgateUIStringMap.set_item("ExcelRecommendedPivotTable_Rating_5_Expectations",(0,We.a)("Excel_Rating_5_Expectations")),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Question",(0,We.a)("Visio_Download_As_Image_Rating_Question")),this.floodgateUIStringMap.set_item("Download_as_Image_Title",(0,We.a)("Visio_Download_As_Image_Title")),this.floodgateUIStringMap.set_item("Download_as_Image_Prompt_Question",(0,We.a)("Visio_FPS_Prompt_Question")),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_1",(0,We.a)("Visio_FPS_Rating_Values_1")),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_2",(0,We.a)("Visio_FPS_Rating_Values_2")),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_3",(0,We.a)("Visio_FPS_Rating_Values_3")),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_4",(0,We.a)("Visio_FPS_Rating_Values_4")),this.floodgateUIStringMap.set_item("Download_as_Image_Rating_Values_5",(0,We.a)("Visio_FPS_Rating_Values_5")),this.floodgateUIStringMap.set_item("Download_as_Image_Question",(0,We.a)("Visio_FPS_General_Question")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgatePromptTitle",(0,We.a)("WAC_TextPredictions_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgatePromptQuestion",(0,We.a)("WAC_TextPredictions_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgatePrompt_YesLabel",(0,We.a)("WAC_TextPredictions_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgatePrompt_NoLabel",(0,We.a)("WAC_TextPredictions_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRatingQuestion",(0,We.a)("WAC_TextPredictions_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_1",(0,We.a)("WAC_TextPredictions_FloodgateRating_1")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_2",(0,We.a)("WAC_TextPredictions_FloodgateRating_2")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_3",(0,We.a)("WAC_TextPredictions_FloodgateRating_3")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_4",(0,We.a)("WAC_TextPredictions_FloodgateRating_4")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateRating_5",(0,We.a)("WAC_TextPredictions_FloodgateRating_5")),this.floodgateUIStringMap.set_item("TextPredictions_FloodgateQuestion",(0,We.a)("WAC_TextPredictions_FloodgateQuestion")),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Title",(0,We.a)("Visio_SoftwareITDiagrams_Title")),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Survey_Question",(0,We.a)("VisioWeb_SoftwareITDiagrams_Survey_Question")),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Prompt_Question",(0,We.a)("Visio_FPS_Prompt_Question1")),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_1",(0,We.a)("Visio_FPS_Rating_Values_1a")),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_2",(0,We.a)("Visio_FPS_Rating_Values_2")),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_3",(0,We.a)("Visio_FPS_Rating_Values_3")),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_4",(0,We.a)("Visio_FPS_Rating_Values_4")),this.floodgateUIStringMap.set_item("SoftwareITDiagrams_Rating_Values_5",(0,We.a)("Visio_FPS_Rating_Values_5")),this.floodgateUIStringMap.set_item("SofwareITDiagrams_Question",(0,We.a)("Visio_FPS_General_Question")),this.floodgateUIStringMap.set_item("TeamsOpen_GreetingQuestion",(0,We.a)("WAC_NPS_Title")),this.floodgateUIStringMap.set_item("TeamsOpen_PromptTitle",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("TeamsOpen_GreetingAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("TeamsOpen_GreetingAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("TeamsOpen_RatingQuestion_Excel",(0,We.a)("WAC_NPS_TeamsFileOpenFloodgate_Excel")),this.floodgateUIStringMap.set_item("TeamsOpen_RatingQuestion_PowerPoint",(0,We.a)("WAC_NPS_TeamsFileOpenFloodgate_PowerPoint")),this.floodgateUIStringMap.set_item("TeamsOpen_Rating_Browser",(0,We.a)("WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser")),this.floodgateUIStringMap.set_item("TeamsOpen_Rating_Teams",(0,We.a)("WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams")),this.floodgateUIStringMap.set_item("TeamsOpen_PromptQuestion",(0,We.a)("WAC_NPS_Rating_QuestionQuestion")),this.floodgateUIStringMap.set_item("LinkedIn_Title",(0,We.a)("LinkedIn_Title")),this.floodgateUIStringMap.set_item("LinkedIn_PromptQuestion",(0,We.a)("LinkedIn_PromptQuestion")),this.floodgateUIStringMap.set_item("LinkedIn_QuestionQuestion",(0,We.a)("LinkedIn_QuestionQuestion")),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_1",(0,We.a)("LinkedIn_Rating_Values_1")),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_2",(0,We.a)("LinkedIn_Rating_Values_2")),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_3",(0,We.a)("LinkedIn_Rating_Values_3")),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_4",(0,We.a)("LinkedIn_Rating_Values_4")),this.floodgateUIStringMap.set_item("LinkedIn_Rating_Values_5",(0,We.a)("LinkedIn_Rating_Values_5")),this.floodgateUIStringMap.set_item("Excel_LinkedIn_RatingQuestion",(0,We.a)("Excel_LinkedIn_RatingQuestion")),this.floodgateUIStringMap.set_item("ShowChanges_Prompt",(0,We.a)("Excel_ShowChanges_Prompt")),this.floodgateUIStringMap.set_item("ShowChanges_PromptQuestion",(0,We.a)("Excel_ShowChanges_PromptQuestion")),this.floodgateUIStringMap.set_item("ShowChanges_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ShowChanges_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ShowChanges_RatingQuestion",(0,We.a)("Excel_ShowChanges_RatingQuestion")),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_1",(0,We.a)("Excel_ShowChanges_RatingValue_1")),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_2",(0,We.a)("Excel_ShowChanges_RatingValue_2")),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_3",(0,We.a)("Excel_ShowChanges_RatingValue_3")),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_4",(0,We.a)("Excel_ShowChanges_RatingValue_4")),this.floodgateUIStringMap.set_item("ShowChanges_RatingValue_5",(0,We.a)("Excel_ShowChanges_RatingValue_5")),this.floodgateUIStringMap.set_item("ShowChanges_WhyQuestion",(0,We.a)("Excel_ShowChanges_WhyQuestion")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgatePromptTitle",(0,We.a)("FileBackedLoopComponents_Floodgate_PromptTitle")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgateRatingQuestion",(0,We.a)("FileBackedLoopComponents_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgateRatingValue_1",(0,We.a)("FileBackedLoopComponents_Floodgate_RatingValue_1")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgateRatingValue_2",(0,We.a)("FileBackedLoopComponents_Floodgate_RatingValue_2")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgateRatingValue_3",(0,We.a)("FileBackedLoopComponents_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgateRatingValue_4",(0,We.a)("FileBackedLoopComponents_Floodgate_RatingValue_4")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgateRatingValue_5",(0,We.a)("FileBackedLoopComponents_Floodgate_RatingValue_5")),this.floodgateUIStringMap.set_item("FileBackedLoopComponents_FloodgateWhyQuestion",(0,We.a)("FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgatePromptTitle",(0,We.a)("PollLoopComponent_Floodgate_PromptTitle")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgatePromptAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgatePromptAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgateRatingQuestion",(0,We.a)("PollLoopComponent_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgateRatingValue_1",(0,We.a)("PollLoopComponent_Floodgate_RatingValue_1")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgateRatingValue_2",(0,We.a)("PollLoopComponent_Floodgate_RatingValue_2")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgateRatingValue_3",(0,We.a)("PollLoopComponent_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgateRatingValue_4",(0,We.a)("PollLoopComponent_Floodgate_RatingValue_4")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgateRatingValue_5",(0,We.a)("PollLoopComponent_Floodgate_RatingValue_5")),this.floodgateUIStringMap.set_item("PollLoopComponent_FloodgateWhyQuestion",(0,We.a)("PollLoopComponent_Floodgate_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgatePromptTitle",(0,We.a)("RemoveLoopComponents_Floodgate_PromptTitle")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgatePromptAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgatePromptAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgateRatingQuestion",(0,We.a)("RemoveLoopComponents_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgateRatingValue_1",(0,We.a)("RemoveLoopComponents_Floodgate_RatingValue_1")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgateRatingValue_2",(0,We.a)("RemoveLoopComponents_Floodgate_RatingValue_2")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgateRatingValue_3",(0,We.a)("RemoveLoopComponents_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgateRatingValue_4",(0,We.a)("RemoveLoopComponents_Floodgate_RatingValue_4")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgateRatingValue_5",(0,We.a)("RemoveLoopComponents_Floodgate_RatingValue_5")),this.floodgateUIStringMap.set_item("RemoveLoopComponents_FloodgateWhyQuestion",(0,We.a)("RemoveLoopComponents_Floodgate_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("NotUseLoopComponents_FloodgateCommentQuestion",(0,We.a)("NotUseLoopComponents_Floodgate_CommentQuestion")),this.floodgateUIStringMap.set_item("NotUseLoopComponents_FloodgateRatingQuestion",(0,We.a)("NotUseLoopComponents_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("NotUseLoopComponents_FloodgateRatingValue_1",(0,We.a)("NotUseLoopComponents_Floodgate_RatingValue_1")),this.floodgateUIStringMap.set_item("NotUseLoopComponents_FloodgateRatingValue_2",(0,We.a)("NotUseLoopComponents_Floodgate_RatingValue_2")),this.floodgateUIStringMap.set_item("NotUseLoopComponents_FloodgateRatingValue_3",(0,We.a)("NotUseLoopComponents_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("NotUseLoopComponents_FloodgateRatingValue_4",(0,We.a)("NotUseLoopComponents_Floodgate_RatingValue_4")),this.floodgateUIStringMap.set_item("NotUseLoopComponents_FloodgateRatingValue_5",(0,We.a)("NotUseLoopComponents_Floodgate_RatingValue_5")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgatePromptTitle",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_PromptTitle")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_PromptQuestion")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_RatingValue_1")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_RatingValue_2")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_RatingValue_4")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_RatingValue_5")),this.floodgateUIStringMap.set_item("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",(0,We.a)("TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgatePromptTitle",(0,We.a)("TabSwitchControlExperiment_Floodgate_PromptTitle")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgatePromptQuestion",(0,We.a)("TabSwitchControlExperiment_Floodgate_PromptQuestion")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",(0,We.a)("TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",(0,We.a)("TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgateRatingQuestion",(0,We.a)("TabSwitchControlExperiment_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgateRatingValue_1",(0,We.a)("TabSwitchControlExperiment_Floodgate_RatingValue_1")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgateRatingValue_2",(0,We.a)("TabSwitchControlExperiment_Floodgate_RatingValue_2")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgateRatingValue_3",(0,We.a)("TabSwitchControlExperiment_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgateRatingValue_4",(0,We.a)("TabSwitchControlExperiment_Floodgate_RatingValue_4")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgateRatingValue_5",(0,We.a)("TabSwitchControlExperiment_Floodgate_RatingValue_5")),this.floodgateUIStringMap.set_item("TabSwitchControlExperiment_FloodgateHearMoreQuestion",(0,We.a)("TabSwitchControlExperiment_Floodgate_HearMoreQuestion")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_PromptTitle",(0,We.a)("ShortcutDiscovery_PromptTitle")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_PromptQuestion",(0,We.a)("ShortcutDiscovery_PromptQuestion")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_PromptAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_PromptAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_RatingQuestion",(0,We.a)("ShortcutDiscovery_RatingQuestion")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_RatingValue_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_RatingValue_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_2")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_RatingValue_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_3")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_RatingValue_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_4")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_RatingValue_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5")),this.floodgateUIStringMap.set_item("ShortcutDiscovery_WhyQuestion",(0,We.a)("ShortcutDiscovery_WhyQuestion")),this.floodgateUIStringMap.set_item("Fonts_PromptTitle",(0,We.a)("FontExperience_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("Fonts_PromptQuestion",(0,We.a)("FontExperience_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("Fonts_PromptAnswer_NotNow",(0,We.a)("FontExperience_FloodgatePromptAnswer_NotNow")),this.floodgateUIStringMap.set_item("Fonts_PromptAnswer_Sure",(0,We.a)("FontExperience_FloodgatePromptAnswer_Sure")),this.floodgateUIStringMap.set_item("Fonts_RatingQuestion",(0,We.a)("FontExperience_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("Fonts_RatingValue_1",(0,We.a)("FontExperience_FloodgateRatingValue_1")),this.floodgateUIStringMap.set_item("Fonts_RatingValue_2",(0,We.a)("FontExperience_FloodgateRatingValue_2")),this.floodgateUIStringMap.set_item("Fonts_RatingValue_3",(0,We.a)("FontExperience_FloodgateRatingValue_3")),this.floodgateUIStringMap.set_item("Fonts_RatingValue_4",(0,We.a)("FontExperience_FloodgateRatingValue_4")),this.floodgateUIStringMap.set_item("Fonts_RatingValue_5",(0,We.a)("FontExperience_FloodgateRatingValue_5")),this.floodgateUIStringMap.set_item("Fonts_WhyQuestion",(0,We.a)("FontExperience_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("Ruler_PromptTitle",(0,We.a)("WordRuler_PromptTitle")),this.floodgateUIStringMap.set_item("Ruler_PromptQuestion",(0,We.a)("WordRuler_PromptQuestion")),this.floodgateUIStringMap.set_item("Ruler_PromptAnswer_NotNow",(0,We.a)("WordRuler_PromptAnswer_NotNow")),this.floodgateUIStringMap.set_item("Ruler_PromptAnswer_Sure",(0,We.a)("WordRuler_PromptAnswer_Sure")),this.floodgateUIStringMap.set_item("Ruler_RatingQuestion",(0,We.a)("WordRuler_RatingQuestion")),this.floodgateUIStringMap.set_item("Ruler_RatingValue_1",(0,We.a)("WordRuler_RatingValue_1")),this.floodgateUIStringMap.set_item("Ruler_RatingValue_2",(0,We.a)("WordRuler_RatingValue_2")),this.floodgateUIStringMap.set_item("Ruler_RatingValue_3",(0,We.a)("WordRuler_RatingValue_3")),this.floodgateUIStringMap.set_item("Ruler_RatingValue_4",(0,We.a)("WordRuler_RatingValue_4")),this.floodgateUIStringMap.set_item("Ruler_RatingValue_5",(0,We.a)("WordRuler_RatingValue_5")),this.floodgateUIStringMap.set_item("Ruler_WhyQuestion",(0,We.a)("WordRuler_WhyQuestion")),this.floodgateUIStringMap.set_item("CustomTabDialog_PromptTitle",(0,We.a)("CustomTabDialog_PromptTitle")),this.floodgateUIStringMap.set_item("CustomTabDialog_PromptQuestion",(0,We.a)("CustomTabDialog_PromptQuestion")),this.floodgateUIStringMap.set_item("CustomTabDialog_PromptAnswer_NotNow",(0,We.a)("CustomTabDialog_PromptAnswer_NotNow")),this.floodgateUIStringMap.set_item("CustomTabDialog_PromptAnswer_Sure",(0,We.a)("CustomTabDialog_PromptAnswer_Sure")),this.floodgateUIStringMap.set_item("CustomTabDialog_RatingQuestion",(0,We.a)("CustomTabDialog_RatingQuestion")),this.floodgateUIStringMap.set_item("CustomTabDialog_RatingValue_1",(0,We.a)("CustomTabDialog_RatingValue_1")),this.floodgateUIStringMap.set_item("CustomTabDialog_RatingValue_2",(0,We.a)("CustomTabDialog_RatingValue_2")),this.floodgateUIStringMap.set_item("CustomTabDialog_RatingValue_3",(0,We.a)("CustomTabDialog_RatingValue_3")),this.floodgateUIStringMap.set_item("CustomTabDialog_RatingValue_4",(0,We.a)("CustomTabDialog_RatingValue_4")),this.floodgateUIStringMap.set_item("CustomTabDialog_RatingValue_5",(0,We.a)("CustomTabDialog_RatingValue_5")),this.floodgateUIStringMap.set_item("CustomTabDialog_WhyQuestion",(0,We.a)("CustomTabDialog_WhyQuestion")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgatePromptTitle",(0,We.a)("WordPenNSAT_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgatePromptQuestion",(0,We.a)("WordPenNSAT_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgateRatingQuestion",(0,We.a)("WordPenNSAT_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgateRating_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgateRating_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgateRating_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_3_Neutral")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgateRating_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgateRating_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5_VerySatisfied")),this.floodgateUIStringMap.set_item("WordPenNSAT_FloodgateWhyQuestion",(0,We.a)("WordPenNSAT_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("ShyRibbon_FloodgatePromptTitle",(0,We.a)("ShyRibbon_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("ShyRibbon_FloodgatePromptQuestion",(0,We.a)("ShyRibbon_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("ShyRibbon_FloodgatePrompt_YesLabel",(0,We.a)("ShyRibbon_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("ShyRibbon_FloodgatePrompt_NoLabel",(0,We.a)("ShyRibbon_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("ShyRibbon_Floodgate_Question",(0,We.a)("ShyRibbon_Floodgate_Question")),this.floodgateUIStringMap.set_item("ShyRibbon_Floodgate_Option_1",(0,We.a)("ShyRibbon_Floodgate_Option_1")),this.floodgateUIStringMap.set_item("ShyRibbon_Floodgate_Option_2",(0,We.a)("ShyRibbon_Floodgate_Option_2")),this.floodgateUIStringMap.set_item("ShyRibbon_Floodgate_Option_3",(0,We.a)("ShyRibbon_Floodgate_Option_3")),this.floodgateUIStringMap.set_item("ShyRibbon_Floodgate_Option_4",(0,We.a)("ShyRibbon_Floodgate_Option_4")),this.floodgateUIStringMap.set_item("ShyRibbon_Floodgate_Option_5",(0,We.a)("ShyRibbon_Floodgate_Option_5")),this.floodgateUIStringMap.set_item("ShyRibbon_FloodgateTellusMore",(0,We.a)("ShyRibbon_Floodgate_TellMore")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgatePromptTitle",(0,We.a)("WordAutoCorrect_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgatePromptQuestion",(0,We.a)("WordAutoCorrect_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgatePrompt_YesLabel",(0,We.a)("WordAutoCorrect_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgatePrompt_NoLabel",(0,We.a)("WordAutoCorrect_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgateRatingQuestion",(0,We.a)("WordAutoCorrect_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgateRating_1",(0,We.a)("WordAutoCorrect_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgateRating_2",(0,We.a)("WordAutoCorrect_FloodgateRating_2")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgateRating_3",(0,We.a)("WordAutoCorrect_FloodgateRating_3")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgateRating_4",(0,We.a)("WordAutoCorrect_FloodgateRating_4")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgateRating_5",(0,We.a)("WordAutoCorrect_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordAutoCorrect_FloodgateWhyQuestion",(0,We.a)("WordAutoCorrect_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("PremiumPreviewFloodgateTitle",(0,We.a)("PremiumPreview_FeedbackTitle")),this.floodgateUIStringMap.set_item("PremiumPreviewFloodgatePrompt",(0,We.a)("PremiumPreview_FeedbackPrompt")),this.floodgateUIStringMap.set_item("PremiumPreviewFloodgateRatingQuestion",(0,We.a)("PremiumPreview_FeedbackRatingQuestion")),this.floodgateUIStringMap.set_item("PremiumPreviewFloodgateQuestion",(0,We.a)("PremiumPreview_FeedbackQuestion1")),this.floodgateUIStringMap.set_item("PremiumPreviewFloodgateMinRating",(0,We.a)("PremiumPreview_FeedbackMinRating")),this.floodgateUIStringMap.set_item("PremiumPreviewFloodgateMaxRating",(0,We.a)("PremiumPreview_FeedbackMaxRating")),this.floodgateUIStringMap.set_item("FloodgateNLQSPromptTitle",(0,We.a)("FloodgateNLQSPromptTitle")),this.floodgateUIStringMap.set_item("FloodgateNLQSPromptSubtitle",(0,We.a)("FloodgateNLQSPromptSubtitle")),this.floodgateUIStringMap.set_item("FloodgateNLQSPromptYes",(0,We.a)("FloodgateNLQSPromptYes")),this.floodgateUIStringMap.set_item("FloodgateNLQSPromptNo",(0,We.a)("FloodgateNLQSPromptNo")),this.floodgateUIStringMap.set_item("FloodgateNLQSRatingQuestion",(0,We.a)("FloodgateNLQSRatingQuestion")),this.floodgateUIStringMap.set_item("FloodgateNLQSRating1",(0,We.a)("FloodgateNLQSRating1")),this.floodgateUIStringMap.set_item("FloodgateNLQSRating2",(0,We.a)("FloodgateNLQSRating2")),this.floodgateUIStringMap.set_item("FloodgateNLQSRating3",(0,We.a)("FloodgateNLQSRating3")),this.floodgateUIStringMap.set_item("FloodgateNLQSRating4",(0,We.a)("FloodgateNLQSRating4")),this.floodgateUIStringMap.set_item("FloodgateNLQSRating5",(0,We.a)("FloodgateNLQSRating5")),this.floodgateUIStringMap.set_item("FloodgateNLQSDetailsQuestion",(0,We.a)("FloodgateNLQSDetailsQuestion")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_Prompt",(0,We.a)("ExcelWeb_EaseOfUse_Prompt")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_PromptQuestion",(0,We.a)("ExcelWeb_EaseOfUse_PromptQuestion")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_RatingQuestion",(0,We.a)("ExcelWeb_EaseOfUse_RatingQuestion")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_RatingValue_1",(0,We.a)("ExcelWeb_EaseOfUse_RatingValue_1")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_RatingValue_2",(0,We.a)("ExcelWeb_EaseOfUse_RatingValue_2")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_RatingValue_3",(0,We.a)("ExcelWeb_EaseOfUse_RatingValue_3")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_RatingValue_4",(0,We.a)("ExcelWeb_EaseOfUse_RatingValue_4")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_RatingValue_5",(0,We.a)("ExcelWeb_EaseOfUse_RatingValue_5")),this.floodgateUIStringMap.set_item("ExcelWebEaseOfUse_WhyQuestion",(0,We.a)("ExcelWeb_EaseOfUse_WhyQuestion")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_Prompt",(0,We.a)("ExcelWeb_PrintSurvey_Prompt")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_PromptQuestion",(0,We.a)("ExcelWeb_PrintSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_RatingQuestion",(0,We.a)("ExcelWeb_PrintSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_RatingValue_1",(0,We.a)("ExcelWeb_PrintSurvey_RatingValue_1")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_RatingValue_2",(0,We.a)("ExcelWeb_PrintSurvey_RatingValue_2")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_RatingValue_3",(0,We.a)("ExcelWeb_PrintSurvey_RatingValue_3")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_RatingValue_4",(0,We.a)("ExcelWeb_PrintSurvey_RatingValue_4")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_RatingValue_5",(0,We.a)("ExcelWeb_PrintSurvey_RatingValue_5")),this.floodgateUIStringMap.set_item("ExcelWebPrintSurvey_WhyQuestion",(0,We.a)("ExcelWeb_PrintSurvey_WhyQuestion")),this.floodgateUIStringMap.set_item("ReactAutoFilter_PromptLine_1",(0,We.a)("Excel_ReactAutoFilter_PromptLine_1")),this.floodgateUIStringMap.set_item("ReactAutoFilter_PromptLine_2",(0,We.a)("Excel_ReactAutoFilter_PromptLine_2")),this.floodgateUIStringMap.set_item("ReactAutoFilter_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ReactAutoFilter_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ReactAutoFilter_RatingQuestion",(0,We.a)("Excel_ReactAutoFilter_RatingQuestion")),this.floodgateUIStringMap.set_item("ReactAutoFilter_RatingValue_1",(0,We.a)("Excel_ReactAutoFilter_RatingValue_1")),this.floodgateUIStringMap.set_item("ReactAutoFilter_RatingValue_2",(0,We.a)("Excel_ReactAutoFilter_RatingValue_2")),this.floodgateUIStringMap.set_item("ReactAutoFilter_RatingValue_3",(0,We.a)("Excel_ReactAutoFilter_RatingValue_3")),this.floodgateUIStringMap.set_item("ReactAutoFilter_RatingValue_4",(0,We.a)("Excel_ReactAutoFilter_RatingValue_4")),this.floodgateUIStringMap.set_item("ReactAutoFilter_RatingValue_5",(0,We.a)("Excel_ReactAutoFilter_RatingValue_5")),this.floodgateUIStringMap.set_item("ReactAutoFilter_CommentQuestion",(0,We.a)("Excel_ReactAutoFilter_CommentQuestion")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_PromptLine_1",(0,We.a)("Excel_NewOfficeDefaultTheme_PromptLine_1")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_PromptLine_2",(0,We.a)("Excel_NewOfficeDefaultTheme_PromptLine_2")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_RatingQuestion",(0,We.a)("Excel_NewOfficeDefaultTheme_RatingQuestion")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_RatingValue_1",(0,We.a)("Excel_NewOfficeDefaultTheme_RatingValue_1")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_RatingValue_2",(0,We.a)("Excel_NewOfficeDefaultTheme_RatingValue_2")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_RatingValue_3",(0,We.a)("Excel_NewOfficeDefaultTheme_RatingValue_3")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_RatingValue_4",(0,We.a)("Excel_NewOfficeDefaultTheme_RatingValue_4")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_RatingValue_5",(0,We.a)("Excel_NewOfficeDefaultTheme_RatingValue_5")),this.floodgateUIStringMap.set_item("NewOfficeDefaultTheme_CommentQuestion",(0,We.a)("Excel_NewOfficeDefaultTheme_CommentQuestion")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgatePromptTitle",(0,We.a)("NavPaneExperience_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgatePromptQuestion",(0,We.a)("NavPaneExperience_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgatePrompt_YesLabel",(0,We.a)("NavPaneExperience_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgatePrompt_NoLabel",(0,We.a)("NavPaneExperience_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgateRatingQuestion",(0,We.a)("NavPaneExperience_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgateRating_1",(0,We.a)("NavPaneExperience_FloodgateRating_1")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgateRating_2",(0,We.a)("NavPaneExperience_FloodgateRating_2")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgateRating_3",(0,We.a)("NavPaneExperience_FloodgateRating_3")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgateRating_4",(0,We.a)("NavPaneExperience_FloodgateRating_4")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgateRating_5",(0,We.a)("NavPaneExperience_FloodgateRating_5")),this.floodgateUIStringMap.set_item("NavPaneExperience_FloodgateWhyQuestion",(0,We.a)("NavPaneExperience_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgatePromptTitle",(0,We.a)("BookmarksExperience_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgatePromptQuestion",(0,We.a)("BookmarksExperience_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgatePrompt_YesLabel",(0,We.a)("BookmarksExperience_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgatePrompt_NoLabel",(0,We.a)("BookmarksExperience_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgateRatingQuestion",(0,We.a)("BookmarksExperience_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgateRating_1",(0,We.a)("BookmarksExperience_FloodgateRating_1")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgateRating_2",(0,We.a)("BookmarksExperience_FloodgateRating_2")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgateRating_3",(0,We.a)("BookmarksExperience_FloodgateRating_3")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgateRating_4",(0,We.a)("BookmarksExperience_FloodgateRating_4")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgateRating_5",(0,We.a)("BookmarksExperience_FloodgateRating_5")),this.floodgateUIStringMap.set_item("BookmarksExperience_FloodgateWhyQuestion",(0,We.a)("BookmarksExperience_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordComment_FloodgatePromptTitle",(0,We.a)("WordComment_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordComment_FloodgatePromptQuestion",(0,We.a)("WordComment_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("WordComment_FloodgatePrompt_YesLabel",(0,We.a)("WordComment_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("WordComment_FloodgatePrompt_NoLabel",(0,We.a)("WordComment_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("WordComment_FloodgateRatingQuestion",(0,We.a)("WordComment_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordComment_FloodgateRating_1",(0,We.a)("WordComment_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordComment_FloodgateRating_2",(0,We.a)("WordComment_FloodgateRating_2")),this.floodgateUIStringMap.set_item("WordComment_FloodgateRating_3",(0,We.a)("WordComment_FloodgateRating_3")),this.floodgateUIStringMap.set_item("WordComment_FloodgateRating_4",(0,We.a)("WordComment_FloodgateRating_4")),this.floodgateUIStringMap.set_item("WordComment_FloodgateRating_5",(0,We.a)("WordComment_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordComment_FloodgateWhyQuestion",(0,We.a)("WordComment_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgatePromptTitle",(0,We.a)("WordTrackChanges_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgatePromptQuestion",(0,We.a)("WordTrackChanges_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgatePrompt_YesLabel",(0,We.a)("WordTrackChanges_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgatePrompt_NoLabel",(0,We.a)("WordTrackChanges_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgateRatingQuestion",(0,We.a)("WordTrackChanges_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgateRating_1",(0,We.a)("WordTrackChanges_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgateRating_2",(0,We.a)("WordTrackChanges_FloodgateRating_2")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgateRating_3",(0,We.a)("WordTrackChanges_FloodgateRating_3")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgateRating_4",(0,We.a)("WordTrackChanges_FloodgateRating_4")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgateRating_5",(0,We.a)("WordTrackChanges_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordTrackChanges_FloodgateWhyQuestion",(0,We.a)("WordTrackChanges_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",(0,We.a)("CollabCorner_Survey_DownloadCopies_Prompt_Line_1")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",(0,We.a)("CollabCorner_Survey_DownloadCopies_Prompt_Line_2")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",(0,We.a)("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",(0,We.a)("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Rating_Question",(0,We.a)("CollabCorner_Survey_DownloadCopies_Rating_Question")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",(0,We.a)("CollabCorner_Survey_DownloadCopies_Rating_Scale_1")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",(0,We.a)("CollabCorner_Survey_DownloadCopies_Rating_Scale_2")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",(0,We.a)("CollabCorner_Survey_DownloadCopies_Rating_Scale_3")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",(0,We.a)("CollabCorner_Survey_DownloadCopies_Rating_Scale_4")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",(0,We.a)("CollabCorner_Survey_DownloadCopies_Rating_Scale_5")),this.floodgateUIStringMap.set_item("CollabCorner_Survey_DownloadCopies_Comment_Question",(0,We.a)("CollabCorner_Survey_DownloadCopies_Comment_Question")),this.floodgateUIStringMap.set_item("WordListsExperience_FloodgatePromptTitle",(0,We.a)("WordListsExperience_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordListsExperience_FloodgatePromptQuestion",(0,We.a)("WordListsExperience_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("WordListsExperience_FloodgatePrompt_YesLabel",(0,We.a)("WordListsExperience_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("WordListsExperience_FloodgatePrompt_NoLabel",(0,We.a)("WordListsExperience_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("WordListsExperience_FloodgateRatingQuestion",(0,We.a)("WordListsExperience_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordListsExperience_FloodgateRating_1",(0,We.a)("WordListsExperience_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordListsExperience_FloodgateRating_5",(0,We.a)("WordListsExperience_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordListsExperience_FloodgateAdditionalThoughts",(0,We.a)("WordListsExperience_FloodgateAdditionalThoughts")),this.floodgateUIStringMap.set_item("ModernPresence_PromptLine_1",(0,We.a)("Excel_ModernPresence_PromptLine_1")),this.floodgateUIStringMap.set_item("ModernPresence_PromptLine_2",(0,We.a)("Excel_ModernPresence_PromptLine_2")),this.floodgateUIStringMap.set_item("ModernPresence_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ModernPresence_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ModernPresence_RatingQuestion",(0,We.a)("Excel_ModernPresence_RatingQuestion")),this.floodgateUIStringMap.set_item("ModernPresence_RatingValue_1",(0,We.a)("Excel_ModernPresence_RatingValue_1")),this.floodgateUIStringMap.set_item("ModernPresence_RatingValue_2",(0,We.a)("Excel_ModernPresence_RatingValue_2")),this.floodgateUIStringMap.set_item("ModernPresence_RatingValue_3",(0,We.a)("Excel_ModernPresence_RatingValue_3")),this.floodgateUIStringMap.set_item("ModernPresence_RatingValue_4",(0,We.a)("Excel_ModernPresence_RatingValue_4")),this.floodgateUIStringMap.set_item("ModernPresence_RatingValue_5",(0,We.a)("Excel_ModernPresence_RatingValue_5")),this.floodgateUIStringMap.set_item("ModernPresence_CommentQuestion",(0,We.a)("Excel_ModernPresence_CommentQuestion")),this.floodgateUIStringMap.set_item("FontPicker_FloodgatePromptTitle",(0,We.a)("FontPicker_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("FontPicker_FloodgatePromptQuestion",(0,We.a)("FontPicker_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("FontPicker_FloodgatePromptYesLabel",(0,We.a)("FontPicker_FloodgatePromptYesLabel")),this.floodgateUIStringMap.set_item("FontPicker_FloodgatePromptNoLabel",(0,We.a)("FontPicker_FloodgatePromptNoLabel")),this.floodgateUIStringMap.set_item("FontPicker_FloodgateRatingQuestion",(0,We.a)("FontPicker_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("FontPicker_FloodgateRating1",(0,We.a)("FontPicker_FloodgateRating1")),this.floodgateUIStringMap.set_item("FontPicker_FloodgateRating2",(0,We.a)("FontPicker_FloodgateRating2")),this.floodgateUIStringMap.set_item("FontPicker_FloodgateRating3",(0,We.a)("FontPicker_FloodgateRating3")),this.floodgateUIStringMap.set_item("FontPicker_FloodgateRating4",(0,We.a)("FontPicker_FloodgateRating4")),this.floodgateUIStringMap.set_item("FontPicker_FloodgateRating5",(0,We.a)("FontPicker_FloodgateRating5")),this.floodgateUIStringMap.set_item("FontPicker_FloodgateCommentQuestion",(0,We.a)("FontPicker_FloodgateCommentQuestion")),this.floodgateUIStringMap.set_item("FormulasMenu_PromptLine_1",(0,We.a)("Excel_FormulasMenu_PromptLine_1")),this.floodgateUIStringMap.set_item("FormulasMenu_PromptLine_2",(0,We.a)("Excel_FormulasMenu_PromptLine_2")),this.floodgateUIStringMap.set_item("FormulasMenu_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("FormulasMenu_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("FormulasMenu_RatingQuestion",(0,We.a)("Excel_FormulasMenu_RatingQuestion")),this.floodgateUIStringMap.set_item("FormulasMenu_RatingValue_1",(0,We.a)("Excel_FormulasMenu_RatingValue_1")),this.floodgateUIStringMap.set_item("FormulasMenu_RatingValue_2",(0,We.a)("Excel_FormulasMenu_RatingValue_2")),this.floodgateUIStringMap.set_item("FormulasMenu_RatingValue_3",(0,We.a)("Excel_FormulasMenu_RatingValue_3")),this.floodgateUIStringMap.set_item("FormulasMenu_RatingValue_4",(0,We.a)("Excel_FormulasMenu_RatingValue_4")),this.floodgateUIStringMap.set_item("FormulasMenu_RatingValue_5",(0,We.a)("Excel_FormulasMenu_RatingValue_5")),this.floodgateUIStringMap.set_item("FormulasMenu_CommentQuestion",(0,We.a)("Excel_FormulasMenu_CommentQuestion")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgateRatingQuestion",(0,We.a)("WordWebEditorSeen_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgatePromptTitle",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgatePromptQuestion",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_YesLabel",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_NoLabel",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgateRatingQuestion",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgateRating_1",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgateRating_1")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgateRating_2",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgateRating_2")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgateRating_3",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgateRating_3")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgateRating_4",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgateRating_4")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgateRating_5",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgateRating_5")),this.floodgateUIStringMap.set_item("FluidOnWebCoauthSentimentSurvey_FloodgateWhyQuestion",(0,We.a)("FluidOnWebCoauthSentimentSurvey_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgateRating_1",(0,We.a)("WAC_GenericSurvey_RaitingValue_ExtremelyNegative")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgateRating_2",(0,We.a)("WAC_GenericSurvey_RaitingValue_SomewhatNegative")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgateRating_3",(0,We.a)("WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgateRating_4",(0,We.a)("WAC_GenericSurvey_RaitingValue_SomewhatPositive")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgateRating_5",(0,We.a)("WAC_GenericSurvey_RaitingValue_ExtremelyPositive")),this.floodgateUIStringMap.set_item("WordWebEditorSeen_FloodgateWhyQuestion",(0,We.a)("WordWebEditorSeen_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgatePromptTitle",Qe.get_Perf_Fps_PromptTitle_OneNote()),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgatePromptQuestion",(0,We.a)("OnenotePerf_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgatePrompt_YesLabel",(0,We.a)("OnenotePerf_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgatePrompt_NoLabel",(0,We.a)("OnenotePerf_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgateRatingQuestion",Qe.get_Perf_Fps_RatingQuestion_OneNote()),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgateRatingQuestionChoice_1",(0,We.a)("OnenotePerf_FloodgateRatingQuestionChoice_1")),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgateRatingQuestionChoice_2",(0,We.a)("OnenotePerf_FloodgateRatingQuestionChoice_2")),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgateRatingQuestionChoice_3",(0,We.a)("OnenotePerf_FloodgateRatingQuestionChoice_3")),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgateRatingQuestionChoice_4",(0,We.a)("OnenotePerf_FloodgateRatingQuestionChoice_4")),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgateRatingQuestionChoice_5",(0,We.a)("OnenotePerf_FloodgateRatingQuestionChoice_5")),this.floodgateUIStringMap.set_item("OnenotePerf_FloodgateWhyQuestion",(0,We.a)("OnenotePerf_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_Prompt",(0,We.a)("OnenoteInkSurvey_Prompt")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_PromptQuestion",(0,We.a)("InkSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_Prompt_Sure",(0,We.a)("InkSurvey_Prompt_Sure")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_Prompt_NoNow",(0,We.a)("InkSurvey_Prompt_NoNow")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_RatingQuestion",(0,We.a)("OnenoteInkSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_QuestionChoice_1",(0,We.a)("InkSurvey_QuestionChoice_1")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_QuestionChoice_2",(0,We.a)("InkSurvey_QuestionChoice_2")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_QuestionChoice_3",(0,We.a)("InkSurvey_QuestionChoice_3")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_QuestionChoice_4",(0,We.a)("InkSurvey_QuestionChoice_4")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_QuestionChoice_5",(0,We.a)("InkSurvey_QuestionChoice_5")),this.floodgateUIStringMap.set_item("OnenoteInkSurvey_WhyQuestion",(0,We.a)("InkSurvey_WhyQuestion")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_Prompt",(0,We.a)("OnenotePenInkSurvey_Prompt")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_PromptQuestion",(0,We.a)("PenInkSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_Prompt_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_Prompt_NoNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_RatingQuestion",(0,We.a)("OnenotePenInkSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_QuestionChoice_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5_VerySatisfied")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_QuestionChoice_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_QuestionChoice_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_3_Neutral")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_QuestionChoice_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_QuestionChoice_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied")),this.floodgateUIStringMap.set_item("OnenotePenInkSurvey_WhyQuestion",(0,We.a)("PenInkSurvey_WhyQuestion")),this.floodgateUIStringMap.set_item("PenInkSurvey_Prompt",(0,We.a)("PenInkSurvey_Prompt")),this.floodgateUIStringMap.set_item("PenInkSurvey_RatingQuestion",(0,We.a)("PenInkSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("PenInkSurvey_PromptQuestion",(0,We.a)("PenInkSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("PenInkSurvey_Prompt_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("PenInkSurvey_Prompt_NoNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("PenInkSurvey_QuestionChoice_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5_VerySatisfied")),this.floodgateUIStringMap.set_item("PenInkSurvey_QuestionChoice_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied")),this.floodgateUIStringMap.set_item("PenInkSurvey_QuestionChoice_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_3_Neutral")),this.floodgateUIStringMap.set_item("PenInkSurvey_QuestionChoice_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied")),this.floodgateUIStringMap.set_item("PenInkSurvey_QuestionChoice_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied")),this.floodgateUIStringMap.set_item("PenInkSurvey_WhyQuestion",(0,We.a)("PenInkSurvey_WhyQuestion")),this.floodgateUIStringMap.set_item("WordDocumentModes_FloodgatePromptTitle",(0,We.a)("WordDocumentModes_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordDocumentModes_FloodgatePromptQuestion",(0,We.a)("WordDocumentModes_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("WordDocumentModes_FloodgatePrompt_YesLabel",(0,We.a)("WordDocumentModes_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("WordDocumentModes_FloodgatePrompt_NoLabel",(0,We.a)("WordDocumentModes_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("WordDocumentModes_FloodgateRatingQuestion",(0,We.a)("WordDocumentModes_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordDocumentModes_FloodgateRating_1",(0,We.a)("WordDocumentModes_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordDocumentModes_FloodgateRating_5",(0,We.a)("WordDocumentModes_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordDocumentModes_FloodgateWhyQuestion",(0,We.a)("WordDocumentModes_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordDesignerFloodgateTitle",(0,We.a)("WordDesigner_FeedbackTitle")),this.floodgateUIStringMap.set_item("WordDesignerFloodgatePrompt",(0,We.a)("WordDesigner_FeedbackPrompt")),this.floodgateUIStringMap.set_item("WordDesignerFloodgatePromptYesLabel",(0,We.a)("WordDesigner_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("WordDesignerFloodgatePromptNoLabel",(0,We.a)("WordDesigner_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("WordDesignerFloodgateRatingQuestion",(0,We.a)("WordDesigner_FeedbackRatingQuestion")),this.floodgateUIStringMap.set_item("WordDesignerFloodgateMinRating",(0,We.a)("WordDesigner_FeedbackMinRating")),this.floodgateUIStringMap.set_item("WordDesignerFloodgateMaxRating",(0,We.a)("WordDesigner_FeedbackMaxRating")),this.floodgateUIStringMap.set_item("WordDesignerFloodgateQuestion",(0,We.a)("WordDesigner_FeedbackQuestion1")),this.floodgateUIStringMap.set_item("WordDesignerBlankDocumentExperienceTitle",(0,We.a)("WordDesigner_BlankDocumentExperience_UserInitiatedTitle")),this.floodgateUIStringMap.set_item("WordDesignerBlankDocumentExperienceRatingQuestion",(0,We.a)("WordDesigner_BlankDocumentExperience_UserInitiatedRatingQuestion")),this.floodgateUIStringMap.set_item("WordDesignerBlankDocumentExperienceCommentQuestion",(0,We.a)("WordDesigner_BlankDocumentExperience_UserInitiatedCommentQuestion")),this.floodgateUIStringMap.set_item("WordDesignerT2ISurveyQuestion",(0,We.a)("WordDesigner_T2ISurveyQuestion")),this.floodgateUIStringMap.set_item("WordDesignerPQSurveyQuestion",(0,We.a)("WordDesigner_PQSurveyQuestion")),this.floodgateUIStringMap.set_item("WordDesignerFormattingSuggestionsSurveyQuestion",(0,We.a)("WordDesigner_FormattingSuggestionsSurveyQuestion")),this.floodgateUIStringMap.set_item("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",(0,We.a)("WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion")),this.floodgateUIStringMap.set_item("WordDesignerDesignerPasteFeedbackRatingQuestion",Qe.get_WordDesigner_DesignerPaste_Question_Word()),this.floodgateUIStringMap.set_item("WordDesignerHideSuggestionsQuestion",(0,We.a)("WordDesigner_HideSuggestionsQuestion")),this.floodgateUIStringMap.set_item("WordDesignerHideSuggestionsAnswer1",(0,We.a)("WordDesigner_HideSuggestionsAnswer_1")),this.floodgateUIStringMap.set_item("WordDesignerHideSuggestionsAnswer2",(0,We.a)("WordDesigner_HideSuggestionsAnswer_2")),this.floodgateUIStringMap.set_item("WordDesignerHideSuggestionsAnswer3",(0,We.a)("WordDesigner_HideSuggestionsAnswer_3")),this.floodgateUIStringMap.set_item("WordDesignerHideSuggestionsAnswer4",(0,We.a)("WordDesigner_HideSuggestionsAnswer_4")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgatePromptTitle",(0,We.a)("FpsInDocSearch_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgatePromptQuestion",(0,We.a)("FpsInDocSearch_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgateRatingQuestion",(0,We.a)("FpsInDocSearch_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgateRating_1",(0,We.a)("FpsInDocSearch_FloodgateRating_1")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgateRating_2",(0,We.a)("FpsInDocSearch_FloodgateRating_2")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgateRating_3",(0,We.a)("FpsInDocSearch_FloodgateRating_3")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgateRating_4",(0,We.a)("FpsInDocSearch_FloodgateRating_4")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgateRating_5",(0,We.a)("FpsInDocSearch_FloodgateRating_5")),this.floodgateUIStringMap.set_item("FpsInDocSearch_FloodgateWhyQuestion",(0,We.a)("FpsInDocSearch_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_Title",(0,We.a)("WAC_CIQAtInvokeFPS_Title")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_Question",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_RatingQuestion",(0,We.a)("WAC_CIQAtInvokeFPS_RatingQuestion")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_RatingValue_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_RatingValue_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_2")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_RatingValue_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_3")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_RatingValue_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_4")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_RatingValue_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5")),this.floodgateUIStringMap.set_item("CIQAtInvokeFPS_WhyQuestion",(0,We.a)("WAC_CIQAtInvokeFPS_WhyQuestion")),this.floodgateUIStringMap.set_item("InAppNotification_Title",(0,We.a)("WAC_InAppNotification_Title")),this.floodgateUIStringMap.set_item("InAppNotification_Description",(0,We.a)("WAC_InAppNotification_Description")),this.floodgateUIStringMap.set_item("InAppNotification_Button1_AddinTab",(0,We.a)("WAC_InAppNotification_Button1_AddinTab")),this.floodgateUIStringMap.set_item("InAppNotification_Button1_AddinButton",(0,We.a)("WAC_InAppNotification_Button1_AddinButton")),this.floodgateUIStringMap.set_item("InAppNotification_Button2",(0,We.a)("WAC_InAppNotification_Button2")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgatePromptTitle",(0,We.a)("WAC_GuestCoauthSurvey_PromptTitle")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgatePromptQuestion",(0,We.a)("WAC_GuestCoauthSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GuestCoauthSurvey_YesLabel")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GuestCoauthSurvey_NoLabel")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgateQuestion",(0,We.a)("WAC_GuestCoauthSurvey_FloodgateQuestion")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgateRatingValue_1",(0,We.a)("WAC_GuestCoauthSurvey_RatingValue_1")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgateRatingValue_2",(0,We.a)("WAC_GuestCoauthSurvey_RatingValue_2")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgateRatingValue_3",(0,We.a)("WAC_GuestCoauthSurvey_RatingValue_3")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgateRatingValue_4",(0,We.a)("WAC_GuestCoauthSurvey_RatingValue_4")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgateRatingValue_5",(0,We.a)("WAC_GuestCoauthSurvey_RatingValue_5")),this.floodgateUIStringMap.set_item("GuestCoauthoring_FloodgateRatingQuestion",(0,We.a)("WAC_GuestCoauthSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgatePromptTitle",(0,We.a)("CtrlClickExperience_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgatePromptQuestion",(0,We.a)("CtrlClickExperience_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgatePrompt_YesLabel",(0,We.a)("CtrlClickExperience_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgatePrompt_NoLabel",(0,We.a)("CtrlClickExperience_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgateRatingQuestion",(0,We.a)("CtrlClickExperience_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgateRating_1",(0,We.a)("CtrlClickExperience_FloodgateRating_1")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgateRating_2",(0,We.a)("CtrlClickExperience_FloodgateRating_2")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgateRating_3",(0,We.a)("CtrlClickExperience_FloodgateRating_3")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgateRating_4",(0,We.a)("CtrlClickExperience_FloodgateRating_4")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgateRating_5",(0,We.a)("CtrlClickExperience_FloodgateRating_5")),this.floodgateUIStringMap.set_item("CtrlClickExperience_FloodgateWhyQuestion",(0,We.a)("CtrlClickExperience_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgatePromptTitle",(0,We.a)("WordTypingResponsiveness_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgatePromptQuestion",(0,We.a)("WordTypingResponsiveness_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgatePrompt_YesLabel",(0,We.a)("WordTypingResponsiveness_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgatePrompt_NoLabel",(0,We.a)("WordTypingResponsiveness_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgateRatingQuestion",(0,We.a)("WordTypingResponsiveness_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgateRating_1",(0,We.a)("WordTypingResponsiveness_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgateRating_2",(0,We.a)("WordTypingResponsiveness_FloodgateRating_2")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgateRating_3",(0,We.a)("WordTypingResponsiveness_FloodgateRating_3")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgateRating_4",(0,We.a)("WordTypingResponsiveness_FloodgateRating_4")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgateRating_5",(0,We.a)("WordTypingResponsiveness_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordTypingResponsiveness_FloodgateWhyQuestion",(0,We.a)("WordTypingResponsiveness_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("ShareSection_PromptLine_1",(0,We.a)("Excel_ShareSection_PromptLine_1")),this.floodgateUIStringMap.set_item("ShareSection_PromptLine_2",(0,We.a)("Excel_ShareSection_PromptLine_2")),this.floodgateUIStringMap.set_item("ShareSection_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ShareSection_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ShareSection_RatingQuestion",(0,We.a)("Excel_ShareSection_RatingQuestion")),this.floodgateUIStringMap.set_item("ShareSection_RatingValue_1",(0,We.a)("Excel_Rating_1_Satisfied")),this.floodgateUIStringMap.set_item("ShareSection_RatingValue_2",(0,We.a)("Excel_Rating_2_Satisfied")),this.floodgateUIStringMap.set_item("ShareSection_RatingValue_3",(0,We.a)("Excel_Rating_3_Satisfied")),this.floodgateUIStringMap.set_item("ShareSection_RatingValue_4",(0,We.a)("Excel_Rating_4_Satisfied")),this.floodgateUIStringMap.set_item("ShareSection_RatingValue_5",(0,We.a)("Excel_Rating_5_Satisfied")),this.floodgateUIStringMap.set_item("ShareSection_CommentQuestion",(0,We.a)("Excel_ShareSection_CommentQuestion")),this.floodgateUIStringMap.set_item("ShareSection_LinkCreation_PromptLine_1",(0,We.a)("Excel_ShareSection_LinkGeneration_PromptLine_1")),this.floodgateUIStringMap.set_item("SmartViewFormatAsTable_Prompt",(0,We.a)("Excel_SmartViewFormatAsTable_Prompt")),this.floodgateUIStringMap.set_item("SmartViewFormatAsTable_PromptQuestion",(0,We.a)("Excel_SmartViewFormatAsTable_PromptQuestion")),this.floodgateUIStringMap.set_item("SmartViewFormatAsTable_Rating_Question",(0,We.a)("Excel_SmartViewFormatAsTable_Rating_Question")),this.floodgateUIStringMap.set_item("SmartViewFormatAsTable_RatingValue_1",(0,We.a)("Excel_SmartViewFormatAsTable_RatingValue_1")),this.floodgateUIStringMap.set_item("SmartViewFormatAsTable_RatingValue_2",(0,We.a)("Excel_SmartViewFormatAsTable_RatingValue_2")),this.floodgateUIStringMap.set_item("SmartViewFormatAsTable_RatingValue_3",(0,We.a)("Excel_SmartViewFormatAsTable_RatingValue_3")),this.floodgateUIStringMap.set_item("SmartViewFormatAsTable_RatingValue_4",(0,We.a)("Excel_SmartViewFormatAsTable_RatingValue_4")),this.floodgateUIStringMap.set_item("SmartViewFormatAsTable_RatingValue_5",(0,We.a)("Excel_SmartViewFormatAsTable_RatingValue_5")),this.floodgateUIStringMap.set_item("SmartViewFormatAsTable_WhyQuestion",(0,We.a)("Excel_SmartViewFormatAsTable_WhyQuestion")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_PromptTitle",(0,We.a)("EaseOfDiscoveringCommand_Floodgate_PromptTitle")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",(0,We.a)("EaseOfDiscoveringCommand_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",(0,We.a)("EaseOfDiscoveringCommand_Floodgate_RatingValue_1")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",(0,We.a)("EaseOfDiscoveringCommand_Floodgate_RatingValue_2")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",(0,We.a)("EaseOfDiscoveringCommand_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",(0,We.a)("EaseOfDiscoveringCommand_Floodgate_RatingValue_4")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",(0,We.a)("EaseOfDiscoveringCommand_Floodgate_RatingValue_5")),this.floodgateUIStringMap.set_item("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",(0,We.a)("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_PromptTitle",(0,We.a)("EaseOfEditingAndFormatting_Floodgate_PromptTitle")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",(0,We.a)("EaseOfEditingAndFormatting_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",(0,We.a)("EaseOfEditingAndFormatting_Floodgate_RatingValue_1")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",(0,We.a)("EaseOfEditingAndFormatting_Floodgate_RatingValue_2")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",(0,We.a)("EaseOfEditingAndFormatting_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",(0,We.a)("EaseOfEditingAndFormatting_Floodgate_RatingValue_4")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",(0,We.a)("EaseOfEditingAndFormatting_Floodgate_RatingValue_5")),this.floodgateUIStringMap.set_item("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",(0,We.a)("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Prompt_Line1",(0,We.a)("EaseOfUse_Floodgate_Prompt_Line1")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Prompt_Line2",(0,We.a)("EaseOfUse_Floodgate_Prompt_Line2")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",(0,We.a)("EaseOfUse_Floodgate_Prompt_Affirmative_Answer")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Prompt_Negative_Answer",(0,We.a)("EaseOfUse_Floodgate_Prompt_Negative_Answer")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Rating_Question",(0,We.a)("EaseOfUse_Floodgate_Rating_Question")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Rating_Scale_1",(0,We.a)("EaseOfUse_Floodgate_Rating_Scale_1")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Rating_Scale_2",(0,We.a)("EaseOfUse_Floodgate_Rating_Scale_2")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Rating_Scale_3",(0,We.a)("EaseOfUse_Floodgate_Rating_Scale_3")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Rating_Scale_4",(0,We.a)("EaseOfUse_Floodgate_Rating_Scale_4")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Rating_Scale_5",(0,We.a)("EaseOfUse_Floodgate_Rating_Scale_5")),this.floodgateUIStringMap.set_item("EaseOfUse_Floodgate_Comment_Question",(0,We.a)("EaseOfUse_Floodgate_Comment_Question")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Prompt_Line1",(0,We.a)("Toolbar_Floodgate_Prompt_Line1")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Prompt_Line2",(0,We.a)("Toolbar_Floodgate_Prompt_Line2")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Prompt_Affirmative_Answer",(0,We.a)("Toolbar_Floodgate_Prompt_Affirmative_Answer")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Prompt_Negative_Answer",(0,We.a)("Toolbar_Floodgate_Prompt_Negative_Answer")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Rating_Question",(0,We.a)("Toolbar_Floodgate_Rating_Question")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Rating_Scale_1",(0,We.a)("Toolbar_Floodgate_Rating_Scale_1")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Rating_Scale_2",(0,We.a)("Toolbar_Floodgate_Rating_Scale_2")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Rating_Scale_3",(0,We.a)("Toolbar_Floodgate_Rating_Scale_3")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Rating_Scale_4",(0,We.a)("Toolbar_Floodgate_Rating_Scale_4")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Rating_Scale_5",(0,We.a)("Toolbar_Floodgate_Rating_Scale_5")),this.floodgateUIStringMap.set_item("Toolbar_Floodgate_Comment_Question",(0,We.a)("Toolbar_Floodgate_Comment_Question")),this.floodgateUIStringMap.set_item("ToolbarOptOut_Floodgate_Prompt_Line1",(0,We.a)("ToolbarOptOut_Floodgate_Prompt_Line1")),this.floodgateUIStringMap.set_item("ToolbarOptOut_Floodgate_Prompt_Line2",(0,We.a)("ToolbarOptOut_Floodgate_Prompt_Line2")),this.floodgateUIStringMap.set_item("ToolbarOptOut_Floodgate_Prompt_Affirmative_Answer",(0,We.a)("ToolbarOptOut_Floodgate_Prompt_Affirmative_Answer")),this.floodgateUIStringMap.set_item("ToolbarOptOut_Floodgate_Prompt_Negative_Answer",(0,We.a)("ToolbarOptOut_Floodgate_Prompt_Negative_Answer")),this.floodgateUIStringMap.set_item("ToolbarOptOut_Floodgate_Rating_Question",(0,We.a)("ToolbarOptOut_Floodgate_Rating_Question")),this.floodgateUIStringMap.set_item("ToolbarOptOut_Floodgate_Rating_Scale_1",(0,We.a)("ToolbarOptOut_Floodgate_Rating_Scale_1")),this.floodgateUIStringMap.set_item("ToolbarOptOut_Floodgate_Rating_Scale_2",(0,We.a)("ToolbarOptOut_Floodgate_Rating_Scale_2")),this.floodgateUIStringMap.set_item("ToolbarOptOut_Floodgate_Comment_Question",(0,We.a)("ToolbarOptOut_Floodgate_Comment_Question")),this.floodgateUIStringMap.set_item("PerformanceExperience_PromptLine_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("PerformanceExperience_PromptLine_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingQuestion",Qe.get_PerformanceExperience_RatingQuestion_Excel(0)),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingQuestion_OpenFile",Qe.get_PerformanceExperience_RatingQuestion_Excel(1)),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingQuestion_Responsivness",Qe.get_PerformanceExperience_RatingQuestion_Excel(2)),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",Qe.get_PerformanceExperience_RatingQuestion_Excel(3)),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",Qe.get_PerformanceExperience_RatingQuestion_Excel(4)),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingValue_1",(0,We.a)("Excel_Rating_1_Satisfied")),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingValue_2",(0,We.a)("Excel_Rating_2_Satisfied")),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingValue_3",(0,We.a)("Excel_Rating_3_Satisfied")),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingValue_4",(0,We.a)("Excel_Rating_4_Satisfied")),this.floodgateUIStringMap.set_item("PerformanceExperience_RatingValue_5",(0,We.a)("Excel_Rating_5_Satisfied")),this.floodgateUIStringMap.set_item("PerformanceExperience_CommentQuestion",(0,We.a)("Excel_PerformanceExperience_CommentQuestion")),this.floodgateUIStringMap.set_item("DarkModeSurvey_Title",(0,We.a)("WAC_DarkModeSurvey_Title")),this.floodgateUIStringMap.set_item("DarkModeSurvey_Question",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("DarkModeSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("DarkModeSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("DarkModeSurvey_RatingQuestion",(0,We.a)("WAC_DarkModeSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("DarkModeSurvey_RatingValue_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied")),this.floodgateUIStringMap.set_item("DarkModeSurvey_RatingValue_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied")),this.floodgateUIStringMap.set_item("DarkModeSurvey_RatingValue_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_3_Neutral")),this.floodgateUIStringMap.set_item("DarkModeSurvey_RatingValue_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied")),this.floodgateUIStringMap.set_item("DarkModeSurvey_RatingValue_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5_VerySatisfied")),this.floodgateUIStringMap.set_item("DarkModeSurvey_WhyQuestion",(0,We.a)("WAC_GenericSurvey_WhyThatRatingQuestion")),this.floodgateUIStringMap.set_item("Fluent2Survey_Title",(0,We.a)("Fluent2StyleFloodgateSurvey_Prompt_Line_1")),this.floodgateUIStringMap.set_item("Fluent2Survey_Question",(0,We.a)("Fluent2StyleFloodgateSurvey_Prompt_Line_2")),this.floodgateUIStringMap.set_item("Fluent2Survey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("Fluent2Survey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("Fluent2Survey_RatingQuestion",(0,We.a)("Fluent2StyleFloodgateSurvey_Rating_Question")),this.floodgateUIStringMap.set_item("Fluent2Survey_RatingValue_1",(0,We.a)("Fluent2StyleFloodgateSurvey_Rating_Question_Option_1")),this.floodgateUIStringMap.set_item("Fluent2Survey_RatingValue_2",(0,We.a)("Fluent2StyleFloodgateSurvey_Rating_Question_Option_2")),this.floodgateUIStringMap.set_item("Fluent2Survey_RatingValue_3",(0,We.a)("Fluent2StyleFloodgateSurvey_Rating_Question_Option_3")),this.floodgateUIStringMap.set_item("Fluent2Survey_RatingValue_4",(0,We.a)("Fluent2StyleFloodgateSurvey_Rating_Question_Option_4")),this.floodgateUIStringMap.set_item("Fluent2Survey_RatingValue_5",(0,We.a)("Fluent2StyleFloodgateSurvey_Rating_Question_Option_5")),this.floodgateUIStringMap.set_item("Fluent2Survey_WhyQuestion",(0,We.a)("Fluent2StyleFloodgateSurvey_CommentQuestion")),this.floodgateUIStringMap.set_item("Fluent2OptOutSurvey_Title",(0,We.a)("Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1")),this.floodgateUIStringMap.set_item("Fluent2OptOutSurvey_Question",(0,We.a)("Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2")),this.floodgateUIStringMap.set_item("Fluent2OptOutSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("Fluent2OptOutSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("Fluent2OptOutSurvey_RatingQuestion",(0,We.a)("Fluent2StyleOptOutFloodgateSurvey_Rating_Question")),this.floodgateUIStringMap.set_item("Fluent2OptOutSurvey_RatingValue_1",(0,We.a)("Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1")),this.floodgateUIStringMap.set_item("Fluent2OptOutSurvey_RatingValue_2",(0,We.a)("Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2")),this.floodgateUIStringMap.set_item("Fluent2OptOutSurvey_WhyQuestion",(0,We.a)("Fluent2StyleFloodgateSurvey_CommentQuestion")),this.floodgateUIStringMap.set_item("ConsumerExperiment_PromptTitle",(0,We.a)("ConsumerExperiment_Floodgate_PromptTitle")),this.floodgateUIStringMap.set_item("ConsumerExperiment_PromptQuestion",(0,We.a)("ConsumerExperiment_Floodgate_PromptQuestion")),this.floodgateUIStringMap.set_item("ConsumerExperiment_RatingQuestion",(0,We.a)("ConsumerExperiment_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("ConsumerExperiment_RatingValue1",(0,We.a)("ConsumerExperiment_Floodgate_RatingValue_1")),this.floodgateUIStringMap.set_item("ConsumerExperiment_RatingValue2",(0,We.a)("ConsumerExperiment_Floodgate_RatingValue_2")),this.floodgateUIStringMap.set_item("ConsumerExperiment_RatingValue3",(0,We.a)("ConsumerExperiment_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("ConsumerExperiment_RatingValue4",(0,We.a)("ConsumerExperiment_Floodgate_RatingValue_4")),this.floodgateUIStringMap.set_item("ConsumerExperiment_RatingValue5",(0,We.a)("ConsumerExperiment_Floodgate_RatingValue_5")),this.floodgateUIStringMap.set_item("ConsumerExperiment_VerbatimQuestion",(0,We.a)("ConsumerExperiment_Floodgate_Verbatim_Question")),this.floodgateUIStringMap.set_item("ConsumerExperiment_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ConsumerExperiment_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("AIMakerSurvey_Title",(0,We.a)("AIMakerSurvey_Title")),this.floodgateUIStringMap.set_item("AIMakerSurvey_Question",(0,We.a)("AIMakerSurvey_Question")),this.floodgateUIStringMap.set_item("AIMakerSurvey_YesLabel",(0,We.a)("AIMakerSurvey_YesLabel")),this.floodgateUIStringMap.set_item("AIMakerSurvey_NoLabel",(0,We.a)("AIMakerSurvey_NoLabel")),this.floodgateUIStringMap.set_item("AIMakerSurvey_RatingQuestion",(0,We.a)("AIMakerSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("AIMakerSurvey_MinRating",(0,We.a)("AIMakerSurvey_MinRating")),this.floodgateUIStringMap.set_item("AIMakerSurvey_MaxRating",(0,We.a)("AIMakerSurvey_MaxRating")),this.floodgateUIStringMap.set_item("AIMakerSurvey_CommentQuestion",(0,We.a)("AIMakerSurvey_CommentQuestion")),this.floodgateUIStringMap.set_item("CheckPerformance_Prompt",(0,We.a)("Excel_CheckPerformance_Prompt")),this.floodgateUIStringMap.set_item("CheckPerformance_PromptQuestion",(0,We.a)("Excel_CheckPerformance_PromptQuestion")),this.floodgateUIStringMap.set_item("CheckPerformance_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("CheckPerformance_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("CheckPerformance_RatingQuestion",(0,We.a)("Excel_CheckPerformance_RatingQuestion")),this.floodgateUIStringMap.set_item("CheckPerformance_RatingValue_1",(0,We.a)("Excel_CheckPerformance_RatingValue_1"));this.floodgateUIStringMap.set_item("CheckPerformance_RatingValue_2",(0,We.a)("Excel_CheckPerformance_RatingValue_2")),this.floodgateUIStringMap.set_item("CheckPerformance_RatingValue_3",(0,We.a)("Excel_CheckPerformance_RatingValue_3")),this.floodgateUIStringMap.set_item("CheckPerformance_RatingValue_4",(0,We.a)("Excel_CheckPerformance_RatingValue_4")),this.floodgateUIStringMap.set_item("CheckPerformance_RatingValue_5",(0,We.a)("Excel_CheckPerformance_RatingValue_5")),this.floodgateUIStringMap.set_item("CheckPerformance_CommentQuestion",(0,We.a)("Excel_CheckPerformance_CommentQuestion")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgateRatingQuestion",(0,We.a)("PPTO_Picture_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgateRating_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgateRating_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgateRating_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_3_Neutral")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgateRating_4",(0,We.a)("PPTO_Picture_FloodgateRating_4_SomewhatSatisfied")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgateRating_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5_VerySatisfied")),this.floodgateUIStringMap.set_item("PPTO_Picture_FloodgateWhyQuestion",(0,We.a)("PPTO_Picture_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgatePromptTitle",(0,We.a)("CCPExperience_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgatePromptQuestion",(0,We.a)("CCPExperience_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgatePrompt_YesLabel",(0,We.a)("CCPExperience_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgatePrompt_NoLabel",(0,We.a)("CCPExperience_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgateRatingQuestion",(0,We.a)("CCPExperience_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgateRating_1",(0,We.a)("CCPExperience_FloodgateRating_1")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgateRating_2",(0,We.a)("CCPExperience_FloodgateRating_2")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgateRating_3",(0,We.a)("CCPExperience_FloodgateRating_3")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgateRating_4",(0,We.a)("CCPExperience_FloodgateRating_4")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgateRating_5",(0,We.a)("CCPExperience_FloodgateRating_5")),this.floodgateUIStringMap.set_item("CCPExperience_FloodgateWhyQuestion",(0,We.a)("CCPExperience_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("FRE_FirstTeachingCalloutTitle",(0,We.a)("FRE_FirstTeachingCalloutTitle")),this.floodgateUIStringMap.set_item("FRE_FirstTeachingCalloutDescription",(0,We.a)("FRE_FirstTeachingCalloutDescription")),this.floodgateUIStringMap.set_item("FRE_TeachingCalloutNextButtonText",(0,We.a)("FRE_TeachingCalloutNextButtonText")),this.floodgateUIStringMap.set_item("FRE_SecondTeachingCalloutTitle",(0,We.a)("FRE_SecondTeachingCalloutTitle")),this.floodgateUIStringMap.set_item("FRE_SecondTeachingCalloutDescription",(0,We.a)("FRE_SecondTeachingCalloutDescription")),this.floodgateUIStringMap.set_item("FRE_ThirdTeachingCalloutTitle",(0,We.a)("FRE_ThirdTeachingCalloutTitle")),this.floodgateUIStringMap.set_item("FRE_ThirdTeachingCalloutDescription",(0,We.a)("FRE_ThirdTeachingCalloutDescription")),this.floodgateUIStringMap.set_item("FRE_TeachingCalloutGotItButtonText",(0,We.a)("FRE_TeachingCalloutGotItButtonText")),this.floodgateUIStringMap.set_item("FormulaByExample_PromptTitle",(0,We.a)("Excel_FormulaByExample_Survey_PromptTitle")),this.floodgateUIStringMap.set_item("FormulaByExample_PromptQuestion",(0,We.a)("Excel_FormulaByExample_Survey_PromptQuestion")),this.floodgateUIStringMap.set_item("FormulaByExample_PromptAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("FormulaByExample_PromptAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("FormulaByExample_RatingQuestion",(0,We.a)("Excel_FormulaByExample_Survey_RatingQuestion")),this.floodgateUIStringMap.set_item("FormulaByExampleIgnored_RatingQuestion",(0,We.a)("Excel_FormulaByExampleIgnored_Survey_RatingQuestion")),this.floodgateUIStringMap.set_item("FormulaByExample_RatingValue_1",(0,We.a)("Excel_FormulaByExample_Survey_RatingValue_1")),this.floodgateUIStringMap.set_item("FormulaByExample_RatingValue_2",(0,We.a)("Excel_FormulaByExample_Survey_RatingValue_2")),this.floodgateUIStringMap.set_item("FormulaByExample_RatingValue_3",(0,We.a)("Excel_FormulaByExample_Survey_RatingValue_3")),this.floodgateUIStringMap.set_item("FormulaByExample_RatingValue_4",(0,We.a)("Excel_FormulaByExample_Survey_RatingValue_4")),this.floodgateUIStringMap.set_item("FormulaByExample_RatingValue_5",(0,We.a)("Excel_FormulaByExample_Survey_RatingValue_5")),this.floodgateUIStringMap.set_item("FormulaByExample_CommentQuestion",(0,We.a)("Excel_FormulaByExample_Survey_CommentQuestion")),this.floodgateUIStringMap.set_item("FormulaByExampleDeclined_CommentQuestion",(0,We.a)("Excel_FormulaByExampleDeclined_Survey_CommentQuestion")),this.floodgateUIStringMap.set_item("CIQSeenNotKeptFPS_Title",(0,We.a)("WAC_CIQSeenNotKeptFPS_Title")),this.floodgateUIStringMap.set_item("CIQSeenNotKeptFPS_Question",(0,We.a)("WAC_CIQSeenNotKeptFPS_Question")),this.floodgateUIStringMap.set_item("CIQSeenNotKeptFPS_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("CIQSeenNotKeptFPS_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("CIQSeenNotKeptFPS_RatingQuestion",(0,We.a)("WAC_CIQSeenNotKeptFPS_RatingQuestion")),this.floodgateUIStringMap.set_item("CIQSeenNotKeptFPS_RatingValue_Yes",(0,We.a)("DialogYes")),this.floodgateUIStringMap.set_item("CIQSeenNotKeptFPS_RatingValue_No",(0,We.a)("DialogNo")),this.floodgateUIStringMap.set_item("CIQSeenNotKeptFPS_WhyQuestion",(0,We.a)("WAC_CIQSeenNotKeptFPS_WhyQuestion")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_PromptTitle",(0,We.a)("FloodgateSurveyProofingSuggestionsPromptTitle")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_PromptQuestion",(0,We.a)("FloodgateSurveyProofingSuggestionsPromptQuestion")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_WhyQuestion",(0,We.a)("FloodgateSurveyProofingSuggestionsPromptQuestion1")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_Option_1",(0,We.a)("FloodgateSurveyProofingSuggestionsOption1")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_Option_2",(0,We.a)("FloodgateSurveyProofingSuggestionsOption2")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_Option_3",(0,We.a)("FloodgateSurveyProofingSuggestionsOption3")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_Option_4",(0,We.a)("FloodgateSurveyProofingSuggestionsOption4")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_Option_5",(0,We.a)("FloodgateSurveyProofingSuggestionsOption5")),this.floodgateUIStringMap.set_item("FloodgateSurveyProofingSuggestions_AdditionalDetailsQuestion",(0,We.a)("FloodgateSurveyProofingSuggestionsPromptQuestion2")),this.floodgateUIStringMap.set_item("MultiColumnsSurvey_Title",(0,We.a)("WAC_MultiColumnsSurvey_Title")),this.floodgateUIStringMap.set_item("MultiColumnsSurvey_Question",(0,We.a)("WAC_MultiColumnsSurvey_Question")),this.floodgateUIStringMap.set_item("MultiColumnsSurvey_YesLabel",(0,We.a)("WAC_MultiColumnsSurvey_YesLabel")),this.floodgateUIStringMap.set_item("MultiColumnsSurvey_NoLabel",(0,We.a)("WAC_MultiColumnsSurvey_NoLabel")),this.floodgateUIStringMap.set_item("MultiColumnsSurvey_RatingQuestion",(0,We.a)("WAC_MultiColumnsSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("MultiColumnsSurvey_RatingValue_1",(0,We.a)("WAC_MultiColumnsSurvey_RatingValue_1")),this.floodgateUIStringMap.set_item("MultiColumnsSurvey_RatingValue_5",(0,We.a)("WAC_MultiColumnsSurvey_RatingValue_5")),this.floodgateUIStringMap.set_item("MultiColumnsSurvey_ImproveQuestion",(0,We.a)("WAC_MultiColumnsSurvey_ImproveQuestion")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgatePromptTitle",(0,We.a)("WordOnlineShare_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgatePromptQuestion",(0,We.a)("WordOnlineShare_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgatePrompt_YesLabel",(0,We.a)("WordOnlineShare_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgatePrompt_NoLabel",(0,We.a)("WordOnlineShare_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgateRatingQuestion",(0,We.a)("WordOnlineShare_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgateRating_1",(0,We.a)("WordOnlineShare_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgateRating_2",(0,We.a)("WordOnlineShare_FloodgateRating_2")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgateRating_3",(0,We.a)("WordOnlineShare_FloodgateRating_3")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgateRating_4",(0,We.a)("WordOnlineShare_FloodgateRating_4")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgateRating_5",(0,We.a)("WordOnlineShare_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordOnlineShare_FloodgateWhyQuestion",(0,We.a)("WordOnlineShare_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("DataCleansing_PromptTitle",(0,We.a)("Excel_DataCleansing_Web_Survey_PromptTitle")),this.floodgateUIStringMap.set_item("DataCleansing_PromptQuestion",(0,We.a)("Excel_DataCleansing_Web_Survey_PromptQuestion")),this.floodgateUIStringMap.set_item("DataCleansing_PromptAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("DataCleansing_PromptAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("DataCleansing_RatingQuestion",(0,We.a)("Excel_DataCleansing_Web_Survey_RatingQuestion")),this.floodgateUIStringMap.set_item("DataCleansing_RatingValue_1",(0,We.a)("Excel_DataCleansing_Web_Survey_RatingValue_1")),this.floodgateUIStringMap.set_item("DataCleansing_RatingValue_2",(0,We.a)("Excel_DataCleansing_Web_Survey_RatingValue_2")),this.floodgateUIStringMap.set_item("DataCleansing_RatingValue_3",(0,We.a)("Excel_DataCleansing_Web_Survey_RatingValue_3")),this.floodgateUIStringMap.set_item("DataCleansing_RatingValue_4",(0,We.a)("Excel_DataCleansing_Web_Survey_RatingValue_4")),this.floodgateUIStringMap.set_item("DataCleansing_RatingValue_5",(0,We.a)("Excel_DataCleansing_Web_Survey_RatingValue_5")),this.floodgateUIStringMap.set_item("DataCleansing_CommentQuestion",(0,We.a)("Excel_DataCleansing_Web_Survey_CommentQuestion")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgatePromptTitle",(0,We.a)("ExcelForms_DataSync_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgatePromptQuestion",(0,We.a)("ExcelForms_DataSync_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgatePrompt_YesLabel",(0,We.a)("ExcelForms_DataSync_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgatePrompt_NoLabel",(0,We.a)("ExcelForms_DataSync_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgateQuestion_1",(0,We.a)("ExcelForms_DataSync_FloodgateQuestion_1")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgateOption_1",(0,We.a)("_ExcelForms_DataSync_FloodgateOption_1")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgateOption_2",(0,We.a)("_ExcelForms_DataSync_FloodgateOption_2")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgateOption_3",(0,We.a)("_ExcelForms_DataSync_FloodgateOption_3")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgateOption_4",(0,We.a)("_ExcelForms_DataSync_FloodgateOption_4")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgateOption_5",(0,We.a)("_ExcelForms_DataSync_FloodgateOption_5")),this.floodgateUIStringMap.set_item("ExcelForms_DataSync_FloodgateQuestion_2",(0,We.a)("ExcelForms_DataSync_FloodgateQuestion_2")),this.floodgateUIStringMap.set_item("Excel_NSV_PromptLine_1",(0,We.a)("Excel_NSV_PromptLine_1")),this.floodgateUIStringMap.set_item("Excel_NSV_PromptLine_2",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("Excel_NSV_PromptLabel_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("Excel_NSV_PromptLabel_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("Excel_NSV_RatingQuestion",(0,We.a)("Excel_NSV_RatingQuestion")),this.floodgateUIStringMap.set_item("Excel_NSV_RatingValue_1",(0,We.a)("Excel_NSV_RatingValue_1")),this.floodgateUIStringMap.set_item("Excel_NSV_RatingValue_2",(0,We.a)("Excel_NSV_RatingValue_2")),this.floodgateUIStringMap.set_item("Excel_NSV_RatingValue_3",(0,We.a)("Excel_NSV_RatingValue_3")),this.floodgateUIStringMap.set_item("Excel_NSV_RatingValue_4",(0,We.a)("Excel_NSV_RatingValue_4")),this.floodgateUIStringMap.set_item("Excel_NSV_RatingValue_5",(0,We.a)("Excel_NSV_RatingValue_5")),this.floodgateUIStringMap.set_item("Excel_NSV_CommentQuestion",(0,We.a)("Excel_NSV_CommentQuestion")),this.floodgateUIStringMap.set_item("UploadFileSurvey_PromptLine1",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("UploadFileSurvey_PromptLine2",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("UploadFileSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("UploadFileSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("UploadFileSurvey_RatingQuestion",(0,We.a)("UploadFileSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("UploadFileSurvey_RatingValue1",(0,We.a)("UploadFileSurvey_RatingValue_1")),this.floodgateUIStringMap.set_item("UploadFileSurvey_RatingValue2",(0,We.a)("UploadFileSurvey_RatingValue_2")),this.floodgateUIStringMap.set_item("UploadFileSurvey_RatingValue3",(0,We.a)("UploadFileSurvey_RatingValue_3")),this.floodgateUIStringMap.set_item("UploadFileSurvey_RatingValue4",(0,We.a)("UploadFileSurvey_RatingValue_4")),this.floodgateUIStringMap.set_item("UploadFileSurvey_RatingValue5",(0,We.a)("UploadFileSurvey_RatingValue_5")),this.floodgateUIStringMap.set_item("UploadFileSurvey_CommentQuestion",(0,We.a)("UploadFileSurvey_CommentQuestion")),this.floodgateUIStringMap.set_item("NewTheme_PromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("NewTheme_PromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("NewTheme_RatingQuestion",(0,We.a)("NewTheme_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("NewTheme_PPT_RatingQuestion",(0,We.a)("NewTheme_PPT_Floodgate_RatingQuestion")),this.floodgateUIStringMap.set_item("NewTheme_RatingValue1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied")),this.floodgateUIStringMap.set_item("NewTheme_RatingValue2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied")),this.floodgateUIStringMap.set_item("NewTheme_RatingValue3",(0,We.a)("NewTheme_Floodgate_RatingValue_3")),this.floodgateUIStringMap.set_item("NewTheme_RatingValue4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied")),this.floodgateUIStringMap.set_item("NewTheme_RatingValue5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5_VerySatisfied")),this.floodgateUIStringMap.set_item("NewTheme_VerbatimQuestion",(0,We.a)("NewTheme_Floodgate_Verbatim_Question")),this.floodgateUIStringMap.set_item("NewTheme_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("NewTheme_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgatePromptTitle",(0,We.a)("WordCommentFiltering_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgatePromptQuestion",(0,We.a)("WordCommentFiltering_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgatePrompt_YesLabel",(0,We.a)("WordCommentFiltering_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgatePrompt_NoLabel",(0,We.a)("WordCommentFiltering_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgateRatingQuestion",(0,We.a)("WordCommentFiltering_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgateRating_1",(0,We.a)("WordCommentFiltering_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgateRating_2",(0,We.a)("WordCommentFiltering_FloodgateRating_2")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgateRating_3",(0,We.a)("WordCommentFiltering_FloodgateRating_3")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgateRating_4",(0,We.a)("WordCommentFiltering_FloodgateRating_4")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgateRating_5",(0,We.a)("WordCommentFiltering_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordCommentFiltering_FloodgateWhyQuestion",(0,We.a)("WordCommentFiltering_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgateRatingQuestion",(0,We.a)("WordDocumentAutoRename_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgateRating_1",(0,We.a)("WordDocumentAutoRename_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgateRating_2",(0,We.a)("WordDocumentAutoRename_FloodgateRating_2")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgateRating_3",(0,We.a)("WordDocumentAutoRename_FloodgateRating_3")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgateRating_4",(0,We.a)("WordDocumentAutoRename_FloodgateRating_4")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgateRating_5",(0,We.a)("WordDocumentAutoRename_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordDocumentAutoRename_FloodgateWhyQuestion",(0,We.a)("WordDocumentAutoRename_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgatePromptTitle",(0,We.a)("WordDocumentFindReplace_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgatePromptQuestion",(0,We.a)("WordDocumentFindReplace_PromptQuestion")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgateRatingQuestion",(0,We.a)("WordDocumentFindReplace_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgateRating_1",(0,We.a)("WordDocumentFindReplace_FloodgateRating_1")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgateRating_2",(0,We.a)("WordDocumentFindReplace_FloodgateRating_2")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgateRating_3",(0,We.a)("WordDocumentFindReplace_FloodgateRating_3")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgateRating_4",(0,We.a)("WordDocumentFindReplace_FloodgateRating_4")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgateRating_5",(0,We.a)("WordDocumentFindReplace_FloodgateRating_5")),this.floodgateUIStringMap.set_item("WordDocumentFindReplace_FloodgateWhyQuestion",(0,We.a)("WordDocumentFindReplace_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgateRatingQuestion",(0,We.a)("WordCopilot_Create_FeelingsSurvey_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgateRating_0",(0,We.a)("WordCopilot_Create_FeelingsSurvey_RatingValue_NotSure")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgateRating_1",(0,We.a)("WordCopilot_Create_FeelingsSurvey_RatingValue_ExtremelyNegative")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgateRating_2",(0,We.a)("WordCopilot_Create_FeelingsSurvey_RatingValue_SomewhatNegative")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgateRating_3",(0,We.a)("WordCopilot_Create_FeelingsSurvey_RatingValue_Neutral")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgateRating_4",(0,We.a)("WordCopilot_Create_FeelingsSurvey_RatingValue_SomewhatPositive")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgateRating_5",(0,We.a)("WordCopilot_Create_FeelingsSurvey_RatingValue_ExtremelyPositive")),this.floodgateUIStringMap.set_item("WordCopilotCreateFeelings_FloodgateWhyQuestion",(0,We.a)("WordCopilot_Create_FeelingsSurvey_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgateRatingQuestion",(0,We.a)("WordCopilot_Create_TimeSavedSurvey_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgateRating_0",(0,We.a)("WordCopilot_Create_TimeSavedSurvey_RatingValue_NotSure")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgateRating_1",(0,We.a)("WordCopilot_Create_TimeSavedSurvey_RatingValue_StronglyDisagree")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgateRating_2",(0,We.a)("WordCopilot_Create_TimeSavedSurvey_RatingValue_SomewhatDisagree")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgateRating_3",(0,We.a)("WordCopilot_Create_TimeSavedSurvey_RatingValue_Neutral")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgateRating_4",(0,We.a)("WordCopilot_Create_TimeSavedSurvey_RatingValue_SomewhatAgree")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgateRating_5",(0,We.a)("WordCopilot_Create_TimeSavedSurvey_RatingValue_StronglyAgree")),this.floodgateUIStringMap.set_item("WordCopilotCreateTimeSaved_FloodgateWhyQuestion",(0,We.a)("WordCopilot_Create_TimeSavedSurvey_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgateRatingQuestion",(0,We.a)("WordCopilot_Ask_FeelingsSurvey_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgateRating_0",(0,We.a)("Copilot_AllSurveys_RatingValue_NotSureDidntUse")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgateRating_1",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_ExtremelyNegative")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgateRating_2",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_SomewhatNegative")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgateRating_3",(0,We.a)("Copilot_AllSurveys_RatingValue_Neutral")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgateRating_4",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_SomewhatPositive")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgateRating_5",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_ExtremelyPositive")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_FeelingsSurvey_FloodgateWhyQuestion",(0,We.a)("WordCopilot_Ask_FeelingsSurvey_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgateRatingQuestion",(0,We.a)("WordCopilot_Ask_TimeSavedSurvey_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_0",(0,We.a)("Copilot_AllSurveys_RatingValue_NotSureDidntUse")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_1",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_StronglyDisagree")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_2",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_SomewhatDisagree")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_3",(0,We.a)("Copilot_AllSurveys_RatingValue_Neutral")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_4",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_SomewhatAgree")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_5",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_StronglyAgree")),this.floodgateUIStringMap.set_item("WordCopilot_Ask_TimeSavedSurvey_FloodgateWhyQuestion",(0,We.a)("Copilot_AllSurveys_FloodgateWhyQuestion_PleaseTellUsMore")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgateRatingQuestion",(0,We.a)("WordCopilot_Command_FeelingsSurvey_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgateRating_0",(0,We.a)("Copilot_AllSurveys_RatingValue_NotSureDidntUse")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgateRating_1",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_ExtremelyNegative")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgateRating_2",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_SomewhatNegative")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgateRating_3",(0,We.a)("Copilot_AllSurveys_RatingValue_Neutral")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgateRating_4",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_SomewhatPositive")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgateRating_5",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_ExtremelyPositive")),this.floodgateUIStringMap.set_item("WordCopilot_Command_FeelingsSurvey_FloodgateWhyQuestion",(0,We.a)("WordCopilot_Command_FeelingsSurvey_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgateRatingQuestion",(0,We.a)("WordCopilot_Command_TimeSavedSurvey_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgateRating_0",(0,We.a)("Copilot_AllSurveys_RatingValue_NotSureDidntUse")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgateRating_1",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_StronglyDisagree")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgateRating_2",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_SomewhatDisagree")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgateRating_3",(0,We.a)("Copilot_AllSurveys_RatingValue_Neutral")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgateRating_4",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_SomewhatAgree")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgateRating_5",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_StronglyAgree")),this.floodgateUIStringMap.set_item("WordCopilot_Command_TimeSavedSurvey_FloodgateWhyQuestion",(0,We.a)("Copilot_AllSurveys_FloodgateWhyQuestion_PleaseTellUsMore")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgateRatingQuestion",(0,We.a)("WordCopilot_Summary_FeelingsSurvey_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_0",(0,We.a)("Copilot_AllSurveys_RatingValue_NotSureDidntUse")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_1",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_ExtremelyNegative")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_2",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_SomewhatNegative")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_3",(0,We.a)("Copilot_AllSurveys_RatingValue_Neutral")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_4",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_SomewhatPositive")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_5",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_ExtremelyPositive")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_FeelingsSurvey_FloodgateWhyQuestion",(0,We.a)("WordCopilot_Summary_FeelingsSurvey_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgatePromptTitle",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgatePromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgatePrompt_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgatePrompt_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgateRatingQuestion",(0,We.a)("WordCopilot_Summary_TimeSavedSurvey_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_0",(0,We.a)("Copilot_AllSurveys_RatingValue_NotSureDidntUse")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_1",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_StronglyDisagree")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_2",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_SomewhatDisagree")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_3",(0,We.a)("Copilot_AllSurveys_RatingValue_Neutral")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_4",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_SomewhatAgree")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_5",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_StronglyAgree")),this.floodgateUIStringMap.set_item("WordCopilot_Summarize_TimeSavedSurvey_FloodgateWhyQuestion",(0,We.a)("Copilot_AllSurveys_FloodgateWhyQuestion_PleaseTellUsMore")),this.floodgateUIStringMap.set_item("CopilotSurvey_PromptTitle",(0,We.a)("Excel_Copilot_Survey_PromptTitle")),this.floodgateUIStringMap.set_item("CopilotSurvey_PromptQuestion",(0,We.a)("Excel_Copilot_Survey_PromptQuestion")),this.floodgateUIStringMap.set_item("CopilotFeelingAnalyzeDataSurvey_RatingQuestion",(0,We.a)("Excel_Copilot_Survey_RatingQuestion_Feeling_AnalyzeData")),this.floodgateUIStringMap.set_item("CopilotTimeSavingAnalyzeDataSurvey_RatingQuestion",(0,We.a)("Excel_Copilot_Survey_RatingQuestion_TimeSaving_AnalyzeData")),this.floodgateUIStringMap.set_item("CopilotFeelingAnalyzeDataSurvey_Verbatim",(0,We.a)("Excel_Copilot_Survey_Verbatim_Feeling_AnalyzeData")),this.floodgateUIStringMap.set_item("CopilotFeelingGenerateDataSurvey_Verbatim",(0,We.a)("Excel_Copilot_Survey_Verbatim_Feeling_FormulaColumn")),this.floodgateUIStringMap.set_item("CopilotFeelingCommandingSurvey_Verbatim",(0,We.a)("Excel_Copilot_Survey_Verbatim_Feeling_FormatTable")),this.floodgateUIStringMap.set_item("CopilotSurvey_Verbatim",(0,We.a)("Excel_Copilot_Survey_Verbatim")),this.floodgateUIStringMap.set_item("CopilotFeelingGenerateDataSurvey_RatingQuestion",(0,We.a)("Excel_Copilot_Survey_RatingQuestion_Feeling_FormulaColumn")),this.floodgateUIStringMap.set_item("CopilotTimeSavingGenerateDataSurvey_RatingQuestion",(0,We.a)("Excel_Copilot_Survey_RatingQuestion_TimeSaving_FormulaColumn")),this.floodgateUIStringMap.set_item("CopilotFeelingCommandingSurvey_RatingQuestion",(0,We.a)("Excel_Copilot_Survey_RatingQuestion_Feeling_FormatTable")),this.floodgateUIStringMap.set_item("CopilotTimeSavingCommandingSurvey_RatingQuestion",(0,We.a)("Excel_Copilot_Survey_RatingQuestion_TimeSaving_FormatTable")),this.floodgateUIStringMap.set_item("CopilotAppSurvey_RatingQuestion",(0,We.a)("Excel_Copilot_Survey_RatingQuestion_App_Survey")),this.floodgateUIStringMap.set_item("CopilotExpectationSurvey_RatingQuestion",(0,We.a)("Excel_Copilot_Survey_RatingQuestion_Expectation_Survey")),this.floodgateUIStringMap.set_item("CopilotFeelingSurvey_RatingOption5",(0,We.a)("Excel_Copilot_Survey_RatingOption5_Feeling")),this.floodgateUIStringMap.set_item("CopilotFeelingSurvey_RatingOption4",(0,We.a)("Excel_Copilot_Survey_RatingOption4_Feeling")),this.floodgateUIStringMap.set_item("CopilotFeelingSurvey_RatingOption3",(0,We.a)("Excel_Copilot_Survey_RatingOption3_Feeling")),this.floodgateUIStringMap.set_item("CopilotFeelingSurvey_RatingOption2",(0,We.a)("Excel_Copilot_Survey_RatingOption2_Feeling")),this.floodgateUIStringMap.set_item("CopilotFeelingSurvey_RatingOption1",(0,We.a)("Excel_Copilot_Survey_RatingOption1_Feeling")),this.floodgateUIStringMap.set_item("CopilotSurvey_RatingOption0",(0,We.a)("Excel_Copilot_Survey_RatingOption0")),this.floodgateUIStringMap.set_item("CopilotTimeSavingSurvey_RatingOption5",(0,We.a)("Excel_Copilot_Survey_RatingOption5_TimeSaving")),this.floodgateUIStringMap.set_item("CopilotTimeSavingSurvey_RatingOption4",(0,We.a)("Excel_Copilot_Survey_RatingOption4_TimeSaving")),this.floodgateUIStringMap.set_item("CopilotTimeSavingSurvey_RatingOption3",(0,We.a)("Excel_Copilot_Survey_RatingOption3_TimeSaving")),this.floodgateUIStringMap.set_item("CopilotTimeSavingSurvey_RatingOption2",(0,We.a)("Excel_Copilot_Survey_RatingOption2_TimeSaving")),this.floodgateUIStringMap.set_item("CopilotTimeSavingSurvey_RatingOption1",(0,We.a)("Excel_Copilot_Survey_RatingOption1_TimeSaving")),this.floodgateUIStringMap.set_item("CopilotAppSurvey_RatingOption3",(0,We.a)("Excel_Copilot_Survey_RatingOption3_App")),this.floodgateUIStringMap.set_item("CopilotAppSurvey_RatingOption2",(0,We.a)("Excel_Copilot_Survey_RatingOption2_App")),this.floodgateUIStringMap.set_item("CopilotAppSurvey_RatingOption1",(0,We.a)("Excel_Copilot_Survey_RatingOption1_App")),this.floodgateUIStringMap.set_item("CopilotExpectationSurvey_RatingOption3",(0,We.a)("Excel_Copilot_Survey_RatingOption3_Expectation")),this.floodgateUIStringMap.set_item("CopilotExpectationSurvey_RatingOption2",(0,We.a)("Excel_Copilot_Survey_RatingOption2_Expectation")),this.floodgateUIStringMap.set_item("CopilotExpectationSurvey_RatingOption1",(0,We.a)("Excel_Copilot_Survey_RatingOption1_Expectation")),this.floodgateUIStringMap.set_item("CopilotExpectationSurvey_Verbatim",(0,We.a)("Excel_Copilot_Survey_Verbatim_Expectation")),this.floodgateUIStringMap.set_item("CopilotSurvey_PromptAnswer_Sure",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("CopilotSurvey_PromptAnswer_NotNow",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_PromptLine1",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_PromptLine2",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_RatingQuestion",(0,We.a)("TableCellResizeSurvey_RatingQuestion")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_RatingValue1",(0,We.a)("WAC_GenericSurvey_RaitingValue_VeryPoor")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_RatingValue2",(0,We.a)("WAC_GenericSurvey_RaitingValue_Poor")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_RatingValue3",(0,We.a)("WAC_GenericSurvey_RaitingValue_Average")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_RatingValue4",(0,We.a)("WAC_GenericSurvey_RaitingValue_Good")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_RatingValue5",(0,We.a)("WAC_GenericSurvey_RaitingValue_VeryGood")),this.floodgateUIStringMap.set_item("TableCellResizeSurvey_CommentQuestion",(0,We.a)("WAC_GenericSurvey_CommentQuestion")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_Title",(0,We.a)("WordDocumentParagraphBorders_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_Question",(0,We.a)("WordDocumentParagraphBorders_PromptQuestion")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_RatingQuestion",(0,We.a)("WordDocumentParagraphBorders_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_RatingValue_1",(0,We.a)("WordDocumentParagraphBorders_FloodgateRating_1")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_RatingValue_2",(0,We.a)("WordDocumentParagraphBorders_FloodgateRating_2")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_RatingValue_3",(0,We.a)("WordDocumentParagraphBorders_FloodgateRating_3")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_RatingValue_4",(0,We.a)("WordDocumentParagraphBorders_FloodgateRating_4")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_RatingValue_5",(0,We.a)("WordDocumentParagraphBorders_FloodgateRating_5")),this.floodgateUIStringMap.set_item("ParagraphBordersSurvey_WhyQuestion",(0,We.a)("WordDocumentParagraphBorders_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("FileMenuSurvey_Title",(0,We.a)("WordDocumentFileMenu_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("FileMenuSurvey_Question",(0,We.a)("WordDocumentFileMenu_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("FileMenuSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("FileMenuSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("FileMenuSurvey_RatingQuestion",(0,We.a)("WordDocumentFileMenu_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("FileMenuSurvey_RatingValue_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VeryDissatisfied")),this.floodgateUIStringMap.set_item("FileMenuSurvey_RatingValue_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Dissatisfied")),this.floodgateUIStringMap.set_item("FileMenuSurvey_RatingValue_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Neutral")),this.floodgateUIStringMap.set_item("FileMenuSurvey_RatingValue_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Satisfied")),this.floodgateUIStringMap.set_item("FileMenuSurvey_RatingValue_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VerySatisfied")),this.floodgateUIStringMap.set_item("FileMenuSurvey_WhyQuestion",(0,We.a)("WAC_GenericSurvey_WhyThatRatingQuestion")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_Title",(0,We.a)("WordDocumentTableBorderUx_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_Question",(0,We.a)("WordDocumentTableBorderUx_PromptQuestion")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_RatingQuestion",(0,We.a)("WordDocumentTableBorderUx_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_RatingValue_1",(0,We.a)("WordDocumentTableBorderUx_FloodgateRating_1")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_RatingValue_2",(0,We.a)("WordDocumentTableBorderUx_FloodgateRating_2")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_RatingValue_3",(0,We.a)("WordDocumentTableBorderUx_FloodgateRating_3")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_RatingValue_4",(0,We.a)("WordDocumentTableBorderUx_FloodgateRating_4")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_RatingValue_5",(0,We.a)("WordDocumentTableBorderUx_FloodgateRating_5")),this.floodgateUIStringMap.set_item("TableBorderUxSurvey_WhyQuestion",(0,We.a)("WordDocumentTableBorderUx_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_Title",(0,We.a)("WordDocumentParagraphShading_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_Question",(0,We.a)("WordDocumentParagraphShading_PromptQuestion")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_RatingQuestion",(0,We.a)("WordDocumentParagraphShading_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_RatingValue_1",(0,We.a)("WordDocumentParagraphShading_FloodgateRating_1")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_RatingValue_2",(0,We.a)("WordDocumentParagraphShading_FloodgateRating_2")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_RatingValue_3",(0,We.a)("WordDocumentParagraphShading_FloodgateRating_3")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_RatingValue_4",(0,We.a)("WordDocumentParagraphShading_FloodgateRating_4")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_RatingValue_5",(0,We.a)("WordDocumentParagraphShading_FloodgateRating_5")),this.floodgateUIStringMap.set_item("ParagraphShadingSurvey_WhyQuestion",(0,We.a)("WordDocumentParagraphShading_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("Copilot_AllSurveys_RatingValue_NotSureDidntUse",(0,We.a)("Copilot_AllSurveys_RatingValue_NotSureDidntUse")),this.floodgateUIStringMap.set_item("Copilot_FeelingsSurvey_RatingValue_ExtremelyNegative",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_ExtremelyNegative")),this.floodgateUIStringMap.set_item("Copilot_FeelingsSurvey_RatingValue_SomewhatNegative",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_SomewhatNegative")),this.floodgateUIStringMap.set_item("Copilot_AllSurveys_RatingValue_Neutral",(0,We.a)("Copilot_AllSurveys_RatingValue_Neutral")),this.floodgateUIStringMap.set_item("Copilot_FeelingsSurvey_RatingValue_SomewhatPositive",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_SomewhatPositive")),this.floodgateUIStringMap.set_item("Copilot_FeelingsSurvey_RatingValue_ExtremelyPositive",(0,We.a)("Copilot_FeelingsSurvey_RatingValue_ExtremelyPositive")),this.floodgateUIStringMap.set_item("Copilot_TimeSavedSurvey_RatingValue_StronglyDisagree",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_StronglyDisagree")),this.floodgateUIStringMap.set_item("Copilot_TimeSavedSurvey_RatingValue_SomewhatDisagree",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_SomewhatDisagree")),this.floodgateUIStringMap.set_item("Copilot_TimeSavedSurvey_RatingValue_SomewhatAgree",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_SomewhatAgree")),this.floodgateUIStringMap.set_item("Copilot_TimeSavedSurvey_RatingValue_StronglyAgree",(0,We.a)("Copilot_TimeSavedSurvey_RatingValue_StronglyAgree")),this.floodgateUIStringMap.set_item("Copilot_AllSurveys_FloodgateWhyQuestion_PleaseTellUsMore",(0,We.a)("Copilot_AllSurveys_FloodgateWhyQuestion_PleaseTellUsMore")),this.floodgateUIStringMap.set_item("Copilot_PMFSurvey_RatingValue_NotDisappointed",(0,We.a)("Copilot_PMFSurvey_RatingValue_NotDisappointed")),this.floodgateUIStringMap.set_item("Copilot_PMFSurvey_RatingValue_SomewhatDisappointed",(0,We.a)("Copilot_PMFSurvey_RatingValue_SomewhatDisappointed")),this.floodgateUIStringMap.set_item("Copilot_PMFSurvey_RatingValue_VeryDisappointed",(0,We.a)("Copilot_PMFSurvey_RatingValue_VeryDisappointed")),this.floodgateUIStringMap.set_item("Copilot_ExpectationsSurvey_RatingValue_DidNotMeetExpectations",(0,We.a)("Copilot_ExpectationsSurvey_RatingValue_DidNotMeetExpectations")),this.floodgateUIStringMap.set_item("Copilot_ExpectationsSurvey_RatingValue_MetExpectations",(0,We.a)("Copilot_ExpectationsSurvey_RatingValue_MetExpectations")),this.floodgateUIStringMap.set_item("Copilot_ExpectationsSurvey_RatingValue_ExceededExpectations",(0,We.a)("Copilot_ExpectationsSurvey_RatingValue_ExceededExpectations")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FloodgatePromptTitle",(0,We.a)("PPTO_Copilot_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FloodgatePromptQuestion",(0,We.a)("PPTO_Copilot_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FloodgatePrompt_YesLabel",(0,We.a)("PPTO_Copilot_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FloodgatePrompt_NoLabel",(0,We.a)("PPTO_Copilot_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FeelingCreateRatingQuestion",(0,We.a)("PPTO_Copilot_FeelingCreateRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FeelingEditRatingQuestion",(0,We.a)("PPTO_Copilot_FeelingEditRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FeelingComprehendRatingQuestion",(0,We.a)("PPTO_Copilot_FeelingComprehendRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_TimeSavedCreateRatingQuestion",(0,We.a)("PPTO_Copilot_TimeSavedCreateRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_TimeSavedEditRatingQuestion",(0,We.a)("PPTO_Copilot_TimeSavedEditRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_TimeSavedComprehendRatingQuestion",(0,We.a)("PPTO_Copilot_TimeSavedComprehendRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FeelingCreateRatingWhyQuestion",(0,We.a)("PPTO_Copilot_FeelingCreateRatingWhyQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FeelingEditRatingWhyQuestion",(0,We.a)("PPTO_Copilot_FeelingEditRatingWhyQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_FeelingComprehendRatingWhyQuestion",(0,We.a)("PPTO_Copilot_FeelingComprehendRatingWhyQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_TimeSavedCreateRatingWhyQuestion",(0,We.a)("PPTO_Copilot_TimeSavedCreateRatingWhyQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_TimeSavedEditRatingWhyQuestion",(0,We.a)("PPTO_Copilot_TimeSavedEditRatingWhyQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_TimeSavedComprehendRatingWhyQuestion",(0,We.a)("PPTO_Copilot_TimeSavedComprehendRatingWhyQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_PMFRatingQuestion",(0,We.a)("PPTO_Copilot_PMFRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_ExpectationsRatingQuestion",(0,We.a)("PPTO_Copilot_ExpectationsRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_Copilot_ExpectationsRatingWhyQuestion",(0,We.a)("PPTO_Copilot_ExpectationsRatingWhyQuestion")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_Title",(0,We.a)("PPTOFileRename_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_Question",(0,We.a)("PPTOFileRename_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_RatingQuestion",(0,We.a)("PPTOFileRename_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_RatingValue_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VeryDissatisfied")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_RatingValue_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Dissatisfied")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_RatingValue_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Neutral")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_RatingValue_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Satisfied")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_RatingValue_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VerySatisfied")),this.floodgateUIStringMap.set_item("PPTOFileRenameSurvey_WhyQuestion",(0,We.a)("WAC_GenericSurvey_WhyThatRatingQuestion")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_Title",(0,We.a)("PPTOFileMenu_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_Question",(0,We.a)("PPTOFileMenu_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_RatingQuestion",(0,We.a)("PPTOFileMenu_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_RatingValue_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VeryDissatisfied")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_RatingValue_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Dissatisfied")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_RatingValue_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Neutral")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_RatingValue_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Satisfied")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_RatingValue_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VerySatisfied")),this.floodgateUIStringMap.set_item("PPTOFileMenuSurvey_WhyQuestion",(0,We.a)("WAC_GenericSurvey_WhyThatRatingQuestion")),this.floodgateUIStringMap.set_item("PPTO_InteractivePerf_PromptLine1",(0,We.a)("WAC_GenericSurvey_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("PPTO_InteractivePerf_PromptLine2",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("PPTO_InteractivePerf_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("PPTO_InteractivePerf_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("PPTOInteractivePerf_RatingQuestion",(0,We.a)("PPTO_InteractivePerf_RatingQuestion")),this.floodgateUIStringMap.set_item("PPTOInteractivePerf_RatingValue_1",(0,We.a)("PPTO_InteractivePerf_RatingValue_1")),this.floodgateUIStringMap.set_item("PPTOInteractivePerf_RatingValue_2",(0,We.a)("PPTO_InteractivePerf_RatingValue_2")),this.floodgateUIStringMap.set_item("PPTOInteractivePerf_RatingValue_3",(0,We.a)("PPTO_InteractivePerf_RatingValue_3")),this.floodgateUIStringMap.set_item("PPTOInteractivePerf_CommentQuestion",(0,We.a)("PPTO_InteractivePerf_CommentQuestion")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgatePromptTitle",(0,We.a)("ExcelComment_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgatePromptQuestion",(0,We.a)("ExcelComment_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgatePrompt_YesLabel",(0,We.a)("ExcelComment_FloodgatePrompt_YesLabel")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgatePrompt_NoLabel",(0,We.a)("ExcelComment_FloodgatePrompt_NoLabel")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgateRatingQuestion",(0,We.a)("ExcelComment_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgateRating_1",(0,We.a)("ExcelComment_FloodgateRating_1")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgateRating_2",(0,We.a)("ExcelComment_FloodgateRating_2")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgateRating_3",(0,We.a)("ExcelComment_FloodgateRating_3")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgateRating_4",(0,We.a)("ExcelComment_FloodgateRating_4")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgateRating_5",(0,We.a)("ExcelComment_FloodgateRating_5")),this.floodgateUIStringMap.set_item("ExcelComment_FloodgateWhyQuestion",(0,We.a)("ExcelComment_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("ExcelFOInteraction_Prompt",(0,We.a)("Excel_FOInteraction_Prompt")),this.floodgateUIStringMap.set_item("ExcelFOInteraction_PromptQuestion",(0,We.a)("Excel_FOInteraction_PromptQuestion")),this.floodgateUIStringMap.set_item("ExcelFOInteraction_RatingQuestion",(0,We.a)("Excel_FOInteraction_RatingQuestion")),this.floodgateUIStringMap.set_item("ExcelFOInteraction_RatingValue_1",(0,We.a)("Excel_FOInteraction_RatingValue_1")),this.floodgateUIStringMap.set_item("ExcelFOInteraction_RatingValue_2",(0,We.a)("Excel_FOInteraction_RatingValue_2")),this.floodgateUIStringMap.set_item("ExcelFOInteraction_RatingValue_3",(0,We.a)("Excel_FOInteraction_RatingValue_3")),this.floodgateUIStringMap.set_item("ExcelFOInteraction_RatingValue_4",(0,We.a)("Excel_FOInteraction_RatingValue_4")),this.floodgateUIStringMap.set_item("ExcelFOInteraction_RatingValue_5",(0,We.a)("Excel_FOInteraction_RatingValue_5")),this.floodgateUIStringMap.set_item("ExcelFOInteraction_WhyQuestion",(0,We.a)("Excel_FOInteraction_WhyQuestion")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_Title",(0,We.a)("Excel_FileMenu_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_Question",(0,We.a)("Excel_FileMenu_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_RatingQuestion",(0,We.a)("Excel_FileMenu_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_RatingValue_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VeryDissatisfied")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_RatingValue_2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Dissatisfied")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_RatingValue_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Neutral")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_RatingValue_4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Satisfied")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_RatingValue_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VerySatisfied")),this.floodgateUIStringMap.set_item("Excel_FileMenuSurvey_WhyQuestion",(0,We.a)("WAC_GenericSurvey_WhyThatRatingQuestion")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEditPromptTitle",(0,We.a)("Excel_FloodgateSurveyNoRealEditPromptTitle")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEditPromptQuestion",(0,We.a)("Excel_FloodgateSurveyNoRealEditPromptQuestion")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEditQuestion1",(0,We.a)("Excel_FloodgateSurveyNoRealEditQuestion1")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEdit_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEdit_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEditOption1",(0,We.a)("Excel_FloodgateSurveyNoRealEditOption1")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEditOption2",(0,We.a)("Excel_FloodgateSurveyNoRealEditOption2")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEditOption3",(0,We.a)("Excel_FloodgateSurveyNoRealEditOption3")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEditOption4",(0,We.a)("Excel_FloodgateSurveyNoRealEditOption4")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEditOption5",(0,We.a)("Excel_FloodgateSurveyNoRealEditOption5")),this.floodgateUIStringMap.set_item("Excel_FloodgateSurveyNoRealEditQuestion2",(0,We.a)("Excel_FloodgateSurveyNoRealEditQuestion2")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_PromptTitle",(0,We.a)("Excel_NewContextualCommanding_PromptLine_1")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_PromptQuestion",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_SureLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_RatingQuestion",(0,We.a)("Excel_NewContextualCommanding_Rating_Question")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_RatingValue1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VeryDissatisfied")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_RatingValue2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Dissatisfied")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_RatingValue3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Neutral")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_RatingValue4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_Satisfied")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_RatingValue5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_VerySatisfied")),this.floodgateUIStringMap.set_item("Excel_NewContextualCommanding_CommentQuestion",(0,We.a)("Excel_NewContextualCommanding_Comment_Question")),this.floodgateUIStringMap.set_item("WordChecklist_PromptLine1",(0,We.a)("Word_Checklist_PromptLine_1")),this.floodgateUIStringMap.set_item("WordChecklist_PromptLine2",(0,We.a)("Word_Checklist_PromptLine_2")),this.floodgateUIStringMap.set_item("WordChecklist_RatingQuestion",(0,We.a)("Word_Checklist_RatingQuestion")),this.floodgateUIStringMap.set_item("WordChecklist_RatingValue_1",(0,We.a)("Word_Checklist_RatingValue_1")),this.floodgateUIStringMap.set_item("WordChecklist_RatingValue_2",(0,We.a)("Word_Checklist_RatingValue_2")),this.floodgateUIStringMap.set_item("WordChecklist_RatingValue_3",(0,We.a)("Word_Checklist_RatingValue_3")),this.floodgateUIStringMap.set_item("WordChecklist_RatingValue_4",(0,We.a)("Word_Checklist_RatingValue_4")),this.floodgateUIStringMap.set_item("WordChecklist_RatingValue_5",(0,We.a)("Word_Checklist_RatingValue_5")),this.floodgateUIStringMap.set_item("WordChecklist_CommentQuestion",(0,We.a)("Word_Checklist_CommentQuestion")),this.floodgateUIStringMap.set_item("WordCitations_PromptLine1",(0,We.a)("Word_Citations_PromptLine_1")),this.floodgateUIStringMap.set_item("WordCitations_PromptLine2",(0,We.a)("Word_Citations_PromptLine_2")),this.floodgateUIStringMap.set_item("WordCitations_RatingQuestion",(0,We.a)("Word_Citations_RatingQuestion")),this.floodgateUIStringMap.set_item("WordCitations_RatingValue_1",(0,We.a)("Word_Citations_RatingValue_1")),this.floodgateUIStringMap.set_item("WordCitations_RatingValue_2",(0,We.a)("Word_Citations_RatingValue_2")),this.floodgateUIStringMap.set_item("WordCitations_RatingValue_3",(0,We.a)("Word_Citations_RatingValue_3")),this.floodgateUIStringMap.set_item("WordCitations_RatingValue_4",(0,We.a)("Word_Citations_RatingValue_4")),this.floodgateUIStringMap.set_item("WordCitations_RatingValue_5",(0,We.a)("Word_Citations_RatingValue_5")),this.floodgateUIStringMap.set_item("WordCitations_CommentQuestion",(0,We.a)("Word_Citations_CommentQuestion")),this.floodgateUIStringMap.set_item("WordFluentIcons_Prompt",(0,We.a)("Word_FluentIcons_Prompt")),this.floodgateUIStringMap.set_item("WordFluentIcons_PromptQuestion",(0,We.a)("Word_FluentIcons_PromptQuestion")),this.floodgateUIStringMap.set_item("WordFluentIcons_RatingQuestion",(0,We.a)("Word_FluentIcons_RatingQuestion")),this.floodgateUIStringMap.set_item("WordFluentIcons_RatingValue_1",(0,We.a)("Word_FluentIcons_RatingValue_1")),this.floodgateUIStringMap.set_item("WordFluentIcons_RatingValue_2",(0,We.a)("Word_FluentIcons_RatingValue_2")),this.floodgateUIStringMap.set_item("WordFluentIcons_RatingValue_3",(0,We.a)("Word_FluentIcons_RatingValue_3")),this.floodgateUIStringMap.set_item("WordFluentIcons_RatingValue_4",(0,We.a)("Word_FluentIcons_RatingValue_4")),this.floodgateUIStringMap.set_item("WordFluentIcons_RatingValue_5",(0,We.a)("Word_FluentIcons_RatingValue_5")),this.floodgateUIStringMap.set_item("WordFluentIcons_WhyQuestion",(0,We.a)("Word_FluentIcons_WhyQuestion")),this.floodgateUIStringMap.set_item("WordFluentIcons_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("WordFluentIcons_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_Prompt",(0,We.a)("PPT_FluentIcons_Prompt")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_PromptQuestion",(0,We.a)("PPT_FluentIcons_PromptQuestion")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_RatingQuestion",(0,We.a)("PPT_FluentIcons_RatingQuestion")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_RatingValue_1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_RatingValue_2",(0,We.a)("PPT_FluentIcons_RatingValue_2")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_RatingValue_3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_3_Neutral")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_RatingValue_4",(0,We.a)("PPT_FluentIcons_RatingValue_4")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_RatingValue_5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5_VerySatisfied")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_WhyQuestion",(0,We.a)("PPT_FluentIcons_WhyQuestion")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("PPTOFluentIcons_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgatePromptTitle",(0,We.a)("Word_Generic_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgatePromptQuestion",(0,We.a)("Word_Generic_FloodgatePromptQuestion")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgatePrompt_SureLabel",(0,We.a)("Word_Generic_FloodgatePrompt_SureLabel")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgatePrompt_NotNowLabel",(0,We.a)("Word_Generic_FloodgatePrompt_NotNowLabel")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgateRating_VeryDissatisfied_Scale_1",(0,We.a)("Word_Generic_FloodgateRating_VeryDissatisfied_Scale_1")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgateRating_SomewhatDissatisfied_Scale_2",(0,We.a)("Word_Generic_FloodgateRating_SomewhatDissatisfied_Scale_2")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgateRating_Neutral_Scale_3",(0,We.a)("Word_Generic_FloodgateRating_Neutral_Scale_3")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgateRating_SomewhatSatisfied_Scale_4",(0,We.a)("Word_Generic_FloodgateRating_SomewhatSatisfied_Scale_4")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgateRating_VerySatisfied_Scale_5",(0,We.a)("Word_Generic_FloodgateRating_VerySatisfied_Scale_5")),this.floodgateUIStringMap.set_item("Word_Generic_FloodgateWhyQuestion",(0,We.a)("Word_Generic_FloodgateWhyQuestion")),this.floodgateUIStringMap.set_item("WordPinRowsFeature_FloodgateRatingQuestion",(0,We.a)("WordPinRowsFeature_FloodgateRatingQuestion")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_Title",(0,We.a)("Word_ExpandCollapseHeadings_FPS_FloodgatePromptTitle")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_Question",(0,We.a)("WAC_GenericSurvey_PromptQuestion")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_YesLabel",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_NoLabel",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_RatingQuestion",(0,We.a)("Word_ExpandCollapseHeadings_FPS_RatingQuestion")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_RatingValue_1",(0,We.a)("WAC_CatchUpFPS_RatingValue_1")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_RatingValue_2",(0,We.a)("WAC_CatchUpFPS_RatingValue_2")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_RatingValue_3",(0,We.a)("WAC_CatchUpFPS_RatingValue_3")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_RatingValue_4",(0,We.a)("WAC_CatchUpFPS_RatingValue_4")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_RatingValue_5",(0,We.a)("WAC_CatchUpFPS_RatingValue_5")),this.floodgateUIStringMap.set_item("ExpandCollapseFPS_WhyQuestion",(0,We.a)("Word_ExpandCollapseHeadings_FPS_WhyQuestion")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_Word_PromptTitle",(0,We.a)("OcdiUrlFloodgate_Word_PromptTitle")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_Word_RatingQuestion",(0,We.a)("OcdiUrlFloodgate_Word_RatingQuestion")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_Excel_PromptTitle",(0,We.a)("OcdiUrlFloodgate_Excel_PromptTitle")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_Excel_RatingQuestion",(0,We.a)("OcdiUrlFloodgate_Excel_RatingQuestion")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_PowerPoint_PromptTitle",(0,We.a)("OcdiUrlFloodgate_PowerPoint_PromptTitle")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_PowerPoint_RatingQuestion",(0,We.a)("OcdiUrlFloodgate_PowerPoint_RatingQuestion")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_WXP_PromptQuestion_Yes",(0,We.a)("WAC_GenericSurvey_SureLabel")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_WXP_PromptQuestion_No",(0,We.a)("WAC_GenericSurvey_NoLabel")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_WXP_Rating1",(0,We.a)("WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_WXP_Rating2",(0,We.a)("WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_WXP_Rating3",(0,We.a)("WAC_GenericSurvey_FloodgateRating_3_Neutral")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_WXP_Rating4",(0,We.a)("WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_WXP_Rating5",(0,We.a)("WAC_GenericSurvey_FloodgateRating_5_VerySatisfied")),this.floodgateUIStringMap.set_item("OcdiUrlFloodgate_WXP_WhyQuestion",(0,We.a)("OcdiUrlFloodgate_WXP_WhyQuestion"))}catch(e){i.ULS.sendTraceTag(594052319,356,15,"SIFB.InitializeUIStringGetter error "+(e?e.toString():""))}}static delayCustomMs(e){try{return new Promise(((t,n)=>{window.setTimeout((()=>{t(null)}),e)}))}catch(e){return i.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),Promise.resolve(null)}}static getGovernanceServiceIsEnabled(){return!r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateGovernanceServiceIsDisabled")}static getPrioritySurveySettings(){return r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",!1)}static enableWebCampaignGovernance(){return r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableWebCampaignGovernance",!0)}static enableOutOfScopeTelemetry(){return r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOutOfScopeTelemetry",!1)}static getCampaignTelemetrySamplingConfig(){let e=null;try{const t=r.AFrameworkApplication.appSettingsManager.getStringFeatureGate("Microsoft.Office.SharedOnline.CampaignTelemetrySamplingConfig",null);t&&(e=L.b(t))}catch(e){i.ULS.sendTraceTag(508118987,356,50,"Could not deserialize CampaignTelemetrySamplingConfig json"+(e?e.toString():""))}return e}static convertAndShowTeachingUx(e){const t=e?e[0]:null;if(i.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+(t?t.surfaceId:"")),t){if("customsurface"===(t&&t.surfaceType?t.surfaceType.toLocaleLowerCase():null)){const e=ue.handleTeachingUxActivationCallback(t);if(e)return i.ULS.sendTraceTag(555071522,356,50,"SIFB Info:Floodgate activation result - "+e+", "+t.surfaceId),null}}return Pe.convertAndShowTeachingUx(e)}static getGovernanceServiceConfig(){const e={};return e.retry=r.AFrameworkApplication.appSettingsManager.getIntAppSetting("FloodgateGovernanceServiceRetryCount",0),e.timeout=r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",1e4),e.forceServicelessSurveyDisplay=r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",!1),e.isSurveyLevelGovernanceEnabled=r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateSurveyLevelGovernanceEnabled",!1),e}static getDynamicUxConfig(e,t){const n={};return n.enabled=w.a.isFloodgateSurveyDynamicUxEnabled(),n.delayLoadingTimeout=r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicUxDelayInMs",0),n.theme=Qe.getCentroTheme(t),t&&(n.hostName=`wac-${t}-floodgate-sdk`),n.cdnStringConfig=Qe.getDynamicUxCdnConfig(),n}static getDynamicUxCdnConfig(){const e={};return e.uiStringsCdnEnabled=r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateSurveyStringsCdnEnabled",!1),e.fetchCdnConcurrently=r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateSurveyStringsCdnFetchConcurrently",!0),e.uiStringsLoadingTimeout=r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateSurveyStringsCdnTimeout",3e3),e.uiStringCdnRetryLimit=r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateSurveyStringsCdnRetryLimit",0),e}static getCentroTheme(e){const t=(0,R.a)("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn();switch(e){case w.f:return t?"WordDarkTheme":"WordLightTheme";case w.b:return t?"ExcelDarkTheme":"ExcelLightTheme";case w.d:return t?"PowerPointDarkTheme":"PowerPointLightTheme";case w.e:return t?"VisioDarkTheme":"VisioLightTheme";case w.c:return t?"OneNoteDarkTheme":"OneNoteLightTheme";default:return t?"OfficeDarkTheme":"OfficeLightTheme"}}static createAuthTokenHandler(e){if(!("Unknown"!==e&&"Automation"!==e&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateAuthCallbackIsEnabled")||r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",!1)))return i.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+e),null;const t={};t.getUserPuid=Qe.getUserPuid;return se.isOneDriveConsumerHost()&&(t.getAuthToken=Qe.getAuthToken),t}static createFeatureStatusCallback(){const e={};return e.getStringFeatureStatus=Qe.getStringFeatureStatus,e.getBoolFeatureStatus=Qe.getBooleanFeatureStatus,e.getIntFeatureStatus=Qe.getIntFeatureStatus,e}static getStringFeatureStatus(e,t){const n="Microsoft.Office.SharedOnline."+e;return r.AFrameworkApplication.appSettingsManager.getStringFeatureGate(n,t)}static getBooleanFeatureStatus(e,t){const n="Microsoft.Office.SharedOnline."+e;return r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate(n,t)}static getIntFeatureStatus(e,t){const n="Microsoft.Office.SharedOnline."+e;return r.AFrameworkApplication.appSettingsManager.getIntFeatureGate(n,t)}static createPersonalizationUserFactsReadConfig(){const e=se.isOneDriveConsumerHost(),t={};return t.enabled=e,t}static createPersonalizationSettings(){const e={};return e.userFactsCacheExpiration=r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.PersonalizationUserFactsCacheExpiration",36e5),e}static getAuthToken(e){if(!e||!e.scenario)return i.ULS.sendTraceTag(508905240,356,50,"SIFB Invalid authCallback params"),null;return"tulips"===e.scenario.toLowerCase()?Re.requestPersonalizationAuthToken():null}static getUserPuid(){return r.AFrameworkApplication.appSettingsManager.getStringAppSetting("Puid")}static getFlightId(e){if(!e||r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableFloodgateTriggerFlightIdLog",!1))return null;try{const t=(r.AFrameworkApplication.appSettingsManager.getStringAppSetting("FlightId")||"").toLocaleLowerCase(),n=e.toString().toLocaleLowerCase().split(";");for(const e of n)if(-1!==t.indexOf(e))return e}catch(e){i.ULS.sendTraceTag(508961431,306,50,"Error retrieving flightId of campaign event -"+(e?e.toString():""))}return null}static get_Nps_RatingQuestion_Word(){return ue.isTeams()?(0,We.a)("WAC_NPS_RatingQuestion_WordForTeams"):(0,We.a)("WAC_NPS_RatingQuestion_Word")}static get_Nps_RatingQuestion_PowerPoint(){return ue.isTeams()?(0,We.a)("WAC_NPS_RatingQuestion_PowerPointForTeams"):(0,We.a)("WAC_NPS_RatingQuestion_PowerPoint")}static get_Nps_RatingQuestion_Excel(){return ue.isTeams()&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelNpsForTeamsQuestionIsEnabled")?(0,We.a)("WAC_NPS_RatingQuestion_ExcelForTeams"):(0,We.a)("WAC_NPS_RatingQuestion_Excel")}static get_PerformanceExperience_RatingQuestion_Excel(e){if(ue.isTeams())switch(e){case 1:return(0,We.a)("ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile");case 2:return(0,We.a)("ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness");case 3:return(0,We.a)("ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession");case 4:return(0,We.a)("ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession");default:return(0,We.a)("ExcelForTeams_PerformanceExperience_RatingQuestion")}switch(e){case 1:return(0,We.a)("Excel_PerformanceExperience_RatingQuestion_OpenFile");case 2:return(0,We.a)("Excel_PerformanceExperience_RatingQuestion_Responsivness");case 3:return(0,We.a)("Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession");case 4:return(0,We.a)("Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession");default:return(0,We.a)("Excel_PerformanceExperience_RatingQuestion")}}static get_Nps_RatingQuestion_OneNote(){return ue.isTeams()&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NpsOneNoteForTeamsQuestionIsEnabled")?(0,We.a)("WAC_NPS_RatingQuestion_OneNoteForTeams"):(0,We.a)("WAC_NPS_RatingQuestion_OneNote")}static get_Perf_Fps_RatingQuestion_OneNote(){return ue.isTeams()?(0,We.a)("OnenotePerf_FloodgateRatingQuestionForTeams"):(0,We.a)("OnenotePerf_FloodgateRatingQuestion")}static get_Perf_Fps_PromptTitle_OneNote(){return ue.isTeams()?(0,We.a)("OnenotePerf_FloodgatePromptTitleForTeams"):(0,We.a)("OnenotePerf_FloodgatePromptTitle")}static get_WordDesigner_DesignerPaste_Question_Word(){switch(r.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return(0,We.a)("WordDesigner_FormatWithDesignerFeedbackRatingQuestion");case 2:return(0,We.a)("WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion");case 3:return(0,We.a)("WordDesigner_UseSmartPasteFeedbackRatingQuestion");default:return""}}constructor(e){this.isInitialized=!1,this.isError=!1,this._appSpecificFeedbackData=null,this.currentLocaleLowerCase=null,this.useCustomizedAppFloodgateStartStop=!1,this.surveyMetadata=null,this.isEventListenerAdded=!1,this.surveyEnabled=!0,this.messagingEnabled=!0,this.isFloodgateEnabledCheck=!1,this.deferredActivityTimeoutId=0,this.deferredActivityDelayInMilliSeconds=-1,this.deferredActivityAllowedList=null,this.postDownloadJsInitPromise=null,this.haveAccessToLocalStorage=!0,this.onWindowFocus=e=>{this.useCustomizedAppFloodgateStartStop||this.start()},this.onWindowBlur=e=>{this.useCustomizedAppFloodgateStartStop||this.stop()},this.startSurvey=(e=null)=>{ue.floodgateStart(),this.timeBasedSurveysStart()},this.floodgateJsDownloadFinished=(e,t)=>{i.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+e);let n="";if(t&&t.getCallbacksData()&&t.getCallbacksData().length>0&&(n=t.getCallbacksData()[0].activityName()),e)if(w.a.isFloodgateLatestVersionEnabled()){if(this.isInitialized)return void this.doPostInitializationWork(t);!this.isError&&this.postDownloadJsInitPromise||(this.postDownloadJsInitPromise=this.postDownloadJsInit()),this.postDownloadJsInitPromise.then((()=>{this.doPostInitializationWork(t)})).catch((e=>this.postDownloadJsInitFailure(n,e)))}else this.postDownloadJsInit().then((()=>{this.doPostInitializationWork(t)})).catch((e=>this.postDownloadJsInitFailure(n,e)));else this.isError=!0,i.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+n)},this.floodgateUIStringGetter=e=>{this.floodgateUIStringMap||this.initializeUIStringGetter();let t=e;return e&&e.length>0&&(t=this.floodgateUIStringMap&&this.floodgateUIStringMap.containsKey(e)?this.floodgateUIStringMap.get_item(e):e),t||""},this.onWebCampaignEvent=e=>{const t=e?e.detail:null;if(!t)return;const n=!r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacFloodgateNotificationsIntegrationIsEnabled"),a=(t.action||"").toLowerCase();switch(a){case"dismissed":n&&Y.a.instance.deactivateFocus(Ge);break;case"updated":n&&ue.addFocusScope(Ge);break;case"opened":case"":{const e=t.telemetryEventName;let a;try{a=JSON.stringify(t)}catch(n){a="id : "+t.id+" telemetryEventName: "+e,i.ULS.sendTraceTag(51131789,306,50,"Error serializing campaign event. "+a+" Error: "+(n?n.toString():""))}t.success?this.logCampaignTriggerEvent(e,a):i.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+a);!(t.isHidden||t.isAA)&&n&&ue.addFocusScope(Ge);break}default:i.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+a)}},this.onSIFeedbackDismiss=(e,t)=>{D.a.oldActionsPipelineIsEnabled()&&i.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",t,e),D.a.isUserActionLoggingToOtelEnabled()&&k.d(t?S.a.userSurveySubmit:S.a.userSurveyCancel,!0,null,2,8),Y.a.instance.deactivateFocus(ue.floodgateContainerID)},this.customerFeedbackUiWrapperObject=e,this.timeBasedSurveyActivityNames={},this.attemptedGettingCurrentLocale=!1,this.floodgateUIStringMap=null,this.restrictedSurveyActivityMap=null,this.floodgateEnabledInEnvironment=0}}Qe.mainSIFBBrs="SystemInitiatedFeedbackIsEnabled",Qe.campaignDefinitionKey="obf-CampaignDefinitions",Qe.defaultDeferredActivityDelayInMilliSeconds=100,Qe.defaultPostDownloadJsInitDelayInMilliSeconds=8002,(0,a.a)(Qe,"SystemInitiatedFeedback",null,[221]);const qe=(0,o.e)(c.a,{onDemandRegister:(e,t)=>e.register(Qe,t).singleInstance().usingFactory((()=>new Qe((0,o.a)(he)))),_ignoreOnDemandRegister:(0,me.a)(9709177)}),Ke=(0,o.b)("Common.ISystemInitiatedFeedbackWithTimeLapse");class ze{logActivityWithThreshold(e,t,n,a){return this.getActivityLoggedCount(e)<a&&this.logActivity(e,t,n)}logActivity(e,t,n){const a=new Date;if(!e||!this._sif.floodgateEnabled(e,Qe.mainSIFBBrs,t))return!1;let o=null;e in this._activityTimestamps&&(o=this._activityTimestamps[e]);const r=this.getActivitySkipCount(e),s=this.getActivityLoggedCount(e);return this.enoughTimeHasLapsed(o,a,n)?(i.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",r,e),this._sif.logActivity(e,t),this._activityTimestamps[e]=a,this._activitySkipCounts[e]=0,this._activityLoggedCounts[e]=s+1,!0):(this._activitySkipCounts[e]=r+1,!1)}enoughTimeHasLapsed(e,t,n){return!e||t.getTime()-e.getTime()>=1e3*n}getActivitySkipCount(e){let t=0;return e in this._activitySkipCounts&&(t=this._activitySkipCounts[e]),t}getActivityLoggedCount(e){let t=0;return e in this._activityLoggedCounts&&(t=this._activityLoggedCounts[e]),t}constructor(e){if(!e)throw Error.argumentNull("SystemInitiatedFeedback is null");this._sif=e,this._activityTimestamps={},this._activitySkipCounts={},this._activityLoggedCounts={}}}(0,a.a)(ze,"SystemInitiatedFeedbackWithTimeLapse",null,[371]);const je=(0,o.e)(Ke,{onDemandRegister:(e,t)=>e.register(ze,t).singleInstance().usingFactory((()=>new ze((0,o.a)(qe)))),_ignoreOnDemandRegister:(0,me.a)(9709177)});class Ze{get name(){return"Common.App.CustomerFeedback"}configure(e){r.AFrameworkApplication.dataPlumber||(i.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),r.AFrameworkApplication.dataPlumber=new h.a),e.registerOnDemandResolveToken(he),e.registerOnDemandResolveToken(Se,[l]),e.registerOnDemandResolveToken(qe),e.registerOnDemandResolveToken(je),this._container=e}init(){if(!Ze._initialized){this._customerFeedbackActor=(0,o.a)(A),this._customerFeedbackActor.registerActions(),r.AFrameworkApplication.activeFrame.updateCommandUI();(0,o.h)(s.a).execute((e=>{(0,o.a)(qe),(0,o.a)(je)})),Ze._initialized=!0}}dispose(){}static main(){b.a.instance.registerPackage(new Ze)}constructor(){this._container=null,this._customerFeedbackActor=null}}Ze._initialized=!1,(0,a.a)(Ze,"CustomerFeedbackPackage",null,[7,1])},5120:function(e,t,n){"use strict";n.d(t,{a:function(){return C}});var a=n(100),i=n(1520),o=n(625),r=n(3696),s=n(5327),l=n(4238),c=n(3245),d=n(6012),u=n(9969),p=n(1163),g=n(988),h=n(8103),m=n(8510),_=n(5149);const S="message",f="LearnMoreLinkId";class C extends r.StandardDialog{set iframeForPostForm(e){this._iframeForPostForm=e}get iconString(){return null}get titleString(){return null}get messageString(){return null}get callSource(){return this._callSource}get learnMoreLinkUrl(){return null}get learnMoreLinkText(){return null}get messageAndLinkOnOneLine(){return!1}get buttonText(){return(0,h.a)("Open")}get cssClassName(){return null}get additionalTextBodyContent(){return null}get additionalLinksBodyContent(){return null}launchOIC(){}get isEmailLinkInDownloadAsPdfDialogEnabled(){return!1}get isEmailLinkInDownloadACopyDialogEnabled(){return!1}copyLink(){const e={SourceControlId:"CopyLink"},t={ControlId:"CopyLink"};this.fileSharing(e,t)}emailLink(){const e={SourceControlId:"Share"};this.isEmailLinkInDownloadAsPdfDialogEnabled&&(e.shareOverrideDefaultPermission=!0);const t={ControlId:"Share"};this.fileSharing(e,t)}fileSharing(e,t){const n=c.AFrameworkApplication.theActionManager;n.commandLocation=8,n.processActionWithData(g.a.fileSharing,2,e,t)}attachDialogEvents(){this._printPreviewPostForm&&(this._formSubmitClickHandler||(this._formSubmitClickHandler=this.onActionButtonClicked,this._clickManager.registerHandler(d.a.click,this._btnAction,this._formSubmitClickHandler)),this._formSubmitKeyHandler||(this._formSubmitKeyHandler=this.onActionButtonKeyUp,this._keyInputManager.registerHandler(d.a.keyUp,this._btnAction,this._formSubmitKeyHandler))),super.attachDialogEvents()}logSecondaryButtonClicked(){}logCancelButtonClicked(){}logDownloadButtonClicked(){}downloadLinkClicked(e){return this.logDownloadLinkClicked(),this._printPreviewPostForm?this._printPreviewPostForm.submit():this._downloadBehavior.doDownload(),!0}learnMoreLinkClicked(e=null){return!1}dispose(){this._downloadBehavior.dispose(),this._downloadLink$4&&(c.AFrameworkApplication.activeFrame.theMouseInputManager.unregisterHandler(d.a.click,this._downloadLink$4,(0,o.a)(this,this.downloadLinkClicked,"downloadLinkClicked")),this._downloadLink$4=null),this._learnMoreLink&&(c.AFrameworkApplication.activeFrame.theMouseInputManager.unregisterHandler(d.a.click,this._learnMoreLink,(0,o.a)(this,this.learnMoreLinkClicked,"learnMoreLinkClicked")),this._learnMoreLink=null),this._clickManager&&this._formSubmitClickHandler&&(this._clickManager.unregisterHandler(d.a.click,this._btnAction,this._formSubmitClickHandler),this._formSubmitClickHandler=null),this._keyInputManager&&this._formSubmitKeyHandler&&(this._keyInputManager.unregisterHandler(d.a.keyUp,this._btnAction,this._formSubmitKeyHandler),this._formSubmitKeyHandler=null),super.dispose()}reactDialogSubmitForm(){this._printPreviewPostForm&&(this._iframeForPostForm&&(this._printPreviewPostForm.target=this._iframeForPostForm.name),document.body.appendChild(this._printPreviewPostForm),this._printPreviewPostForm.submit(),document.body.removeChild(this._printPreviewPostForm))}static get useReactDialog(){return c.AFrameworkApplication.activeFrame.applicationInstance.isReactDialogEnabled&&c.AFrameworkApplication.activeFrame.applicationInstance.isReactDialogWithLinkToResourceEnabled}static get hideLink(){return C._hideLink}static set hideLink(e){C._hideLink=e}constructor(e,t=!0,n=!1,a=null,r=null,g=!1,y=null,A=!1){super(),this._learnMoreLink=null,this._printPreviewPostForm=null,this._serviceEndpointUrl=null,this._formSubmitClickHandler=null,this._formSubmitKeyHandler=null,this._iframeForPostForm=null,this.onActionButtonClicked=e=>(this.executeDismissActionButtonFromArgs(e),!0),this.onActionButtonKeyUp=e=>this.keyHandlerWithAction(e,this.executeDismissActionButtonFromArgs),this.executeDismissActionButtonFromArgs=e=>{this._printPreviewPostForm&&this._printPreviewPostForm.submit(),this.executeDismissButton(e.sourceElement)},this.postMessageToOwlToInitiateSecurePrintFlow=e=>{const t={};t.redirectTime=Date.now().toString(),t.serviceEndpoint=e;const n=m.a.createMessage("App_PrintRedirect",t,c.AFrameworkApplication.userSessionId);c.AFrameworkApplication.get_hostPostmessengerFuture().execute((e=>{_.ULS.sendTraceTag(506581532,306,50,"Trying to send Post message(printRedirect) sent to OWL to initiate secure print flow.");e.postMessage(n)?_.ULS.sendTraceTag(506581531,306,50,"Post message to OWL to initiate secure print flow succeeded."):_.ULS.sendTraceTag(506581530,306,10,"Post message to OWL to initiate secure print flow failed.")}))},this.dialogHandler=(e,t)=>{1===e?(this.logDownloadButtonClicked(),this._printPreviewPostForm?C.useReactDialog&&this.reactDialogSubmitForm():this._serviceEndpointUrl&&void 0!==this._serviceEndpointUrl?this.postMessageToOwlToInitiateSecurePrintFlow(this._serviceEndpointUrl):this._downloadBehavior.doDownload()):2===e?(this.logSecondaryButtonClicked(),(this.isEmailLinkInDownloadACopyDialogEnabled||this.isEmailLinkInDownloadAsPdfDialogEnabled)&&this.emailLink()):0==e&&this.logCancelButtonClicked(),this.dispose()};const b=this.titleString?this.titleString:(0,h.a)("DefaultDialogTitle");C.hideLink=g,this._callSource=y,this._downloadBehavior=a||new s.a(e,!0),this._downloadBehavior.attachDialog(this);const T=[],v=[];C.useReactDialog&&(this.additionalTextBodyContent&&this.additionalTextBodyContent.forEach((e=>{Array.add(T,e)})),this.additionalLinksBodyContent&&this.additionalLinksBodyContent.forEach((e=>{Array.add(v,e)}))),t?n?this.isEmailLinkInDownloadAsPdfDialogEnabled?(this.buttonsOption=12,this.setButtonText(1,this.buttonText),this.setButtonText(2,(0,h.a)("DownloadAsPdfDialog_EmailALinkButton")),this.setButtonText(3,(0,h.a)("DialogClose"))):this.isEmailLinkInDownloadACopyDialogEnabled?(this.buttonsOption=12,this.setButtonText(1,this.buttonText),this.setButtonText(2,(0,h.a)("DownloadACopyDialog_EmailALinkButton")),this.setButtonText(3,(0,h.a)("DialogClose"))):(this.buttonsOption=4,this.setButtonText(1,this.buttonText),this.setButtonText(2,(0,h.a)("DialogClose"))):(this.buttonsOption=6,this.setButtonText(0,(0,h.a)("DialogClose"))):this.buttonsOption=5;const w=document.createElement("span");this.cssClassName&&(w.className=this.cssClassName);const F=document.createElement("a");F.innerText=this.linkString,F.href=e,F.target="_blank",F.id=this.linkId,F.className=l.a.allowBrowserClickClassname;const I=c.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("SharedOnline.ChangeGate.VSO_9281057_TeamsCheckFixEnabled"),E=!(p.a.isElectron||p.a.isWebview2||I&&p.a.isTeamsDesktop||!r||!(r.count>0));if(E){const t=u.a.getParametersFromUrl(e,r),n=u.a.removeParameters(e,r);F.href="#",F.target="_self",this._printPreviewPostForm=document.createElement("form"),this._printPreviewPostForm.id="printPreviewPostForm1",this._printPreviewPostForm.method="post",this._printPreviewPostForm.target="_blank",this._printPreviewPostForm.action=n;for(const e of t){const t=document.createElement("input");t.type="hidden",t.name=e.key,t.value=e.value,this._printPreviewPostForm.appendChild(t)}}else{if(A){const t=new i.a([...r??[]]);t.contains("WOPIsrc")||t.add("WOPIsrc"),t.contains("access_token")||t.add("access_token"),t.contains("access_token_ttl")||t.add("access_token_ttl");const n=u.a.removeParameters(e,t);try{this._serviceEndpointUrl=new URL(n,window.location.href).href}catch(e){_.ULS.sendTraceTag(506581533,306,10,`Failed to create service endpoint url, will fallback to old flow, Error: ${e}`),this._serviceEndpointUrl=null}}this._printPreviewPostForm=null}if(this._printPreviewPostForm||C.hideLink){if(!C.hideLink){const e=e=>{this.reactDialogSubmitForm()};Array.add(v,{type:"AppLinkProps",id:this.linkId,text:this.linkString,onExecute:e})}}else Array.add(v,{type:"AppLinkProps",id:this.linkId,text:this.linkString,handler:{href:E?"#":e,target:E?"_self":"_blank"}});if(this.messageString&&Array.add(T,this.messageString),n){0;const e=document.createElement("span");e.innerText=this.messageString.replace("{0}",""),w.appendChild(e)}else if(this.messageAndLinkOnOneLine){const e=document.createElement("span");e.id=this.myId(S);const t=document.createElement("span"),n=document.createElement("span"),a=this.messageString.split("{0}");t.innerText=a[0],n.innerText=a[1],e.appendChild(t),e.appendChild(F),e.appendChild(n),w.appendChild(e)}else{const e=document.createElement("span");e.innerText=this.messageString,w.appendChild(e),w.appendChild(document.createElement("br")),w.appendChild(document.createElement("br")),w.appendChild(F),C.hideLink||Array.add(T,"{0}")}if(this._printPreviewPostForm&&w.appendChild(this._printPreviewPostForm),C.useReactDialog){if(this.learnMoreLinkText)if(this.learnMoreLinkUrl)this.addExtraLink(this.learnMoreLinkText,this.learnMoreLinkUrl);else{Array.add(T,"{0}");const e=e=>{this.learnMoreLinkClicked()};Array.add(v,{type:"AppLinkProps",id:f,text:this.learnMoreLinkText,onExecute:e})}this.addAdditionalTextBodyContent(T,v)}if(this.messageBoxImpl(b,null,this.iconString,null,this.dialogHandler,C.useReactDialog?null:w),this.setDescribedByForDialog(this.myId(S)),!C.useReactDialog&&this.learnMoreLinkUrl&&this.learnMoreLinkText){const e=document.createElement("div");e.className="WACDialogLearnMoreLinkContainer",this._learnMoreLink=document.createElement("a"),this._learnMoreLink.innerText=this.learnMoreLinkText,this._learnMoreLink.href=this.learnMoreLinkUrl,this._learnMoreLink.target="_blank",this._learnMoreLink.id=this.myId(f),this._learnMoreLink.className=l.a.allowBrowserClickClassname,e.appendChild(this._learnMoreLink),t?this._divMessageBox.insertBefore(e,this._divMessageBox.lastChild):this._divMessageBox.appendChild(e),this.setDescribedByForDialog(String.format("{0} {1}",this.myId(S),this.myId(f)))}this._downloadLink$4=F,n?this.setFocusOnElement(this._btnAction):this.setFocusOnElement(this._downloadLink$4),this.logDialogDisplayed(),c.AFrameworkApplication.activeFrame.theMouseInputManager.registerHandler(d.a.click,this._downloadLink$4,(0,o.a)(this,this.downloadLinkClicked,"downloadLinkClicked"),null),this._learnMoreLink&&c.AFrameworkApplication.activeFrame.theMouseInputManager.registerHandler(d.a.click,this._learnMoreLink,(0,o.a)(this,this.learnMoreLinkClicked,"learnMoreLinkClicked"),null),this._disposeOnHide=!1}}C._hideLink=!1,(0,a.a)(C,"ADialogWithLinkToResource",r.StandardDialog,[])},5327:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(7958);class o{attachDialog(e){}doDownload(){this.openInCurrentTab?i.a.downloadFile(this.url):this.postParams?i.a.postToWindow("_blank",this.url,this.postParams):i.a.safelyOpenWindow(this.url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}constructor(e,t,n){this.url=e,this.openInCurrentTab=t,this.postParams=n}}(0,a.a)(o,"OpenUrlInTabDialogDownloadBehavior",null,[222,11])},9928:function(e,t,n){"use strict";n.d(t,{a:function(){return g}});var a=n(100),i=n(5149),o=n(5120),r=n(5327),s=n(3245),l=n(7072),c=n(9969),d=n(1163),u=n(8103),p=n(6534);class g extends o.a{get iconString(){return"Print_32x32x32"}get titleString(){return g.useNativeBrowserPrintUx?(0,u.a)("PrintDialogDocumentIsReadyToPrint"):null}get messageString(){return g.useNativeBrowserPrintUx?null:(0,u.a)("PrintDialogDocumentIsReadyToPrint")}get additionalTextBodyContent(){const e=[];if(Array.add(e,(0,u.a)("PrintDialogCanCloseDocument")),o.a.hideLink){let t=(0,u.a)("DirectPrintDialogFallbackSuggestion");""!==s.AFrameworkApplication.activeFrame.applicationInstance.customFallbackMessageForPrintDialog&&(t=s.AFrameworkApplication.activeFrame.applicationInstance.customFallbackMessageForPrintDialog),Array.add(e,t)}return g.useNativeBrowserPrintUx?e:null}get linkString(){return(0,u.a)("DirectPrintDialogDownloadPDFLink")}get linkId(){return"PrintPDFLink"}get buttonText(){return(0,u.a)("PrintDialogOpenPDF")}get cssClassName(){return s.AFrameworkApplication.dialogClearerStringsIsEnabled?"UIFontDialogTextLarge":null}logDialogDisplayed(){i.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}logDownloadLinkClicked(){s.AFrameworkApplication.theWsaClient.incrementDw(9540,1),i.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}logSecondaryButtonClicked(){(0,p.b)("PrintDialogSecondaryButtonClicked",!0)}logCancelButtonClicked(){(0,p.b)("PrintDialogCancelButtonClicked",!0)}logDownloadButtonClicked(){i.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get useNativeBrowserPrintUx(){return!!s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isReactDialogEnabled&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")&&!(d.a.isElectron||d.a.isFirefox||d.a.isSafari)&&!s.AFrameworkApplication.isUnifiedHostMode&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ShouldHostDefaultToNativeBrowserPrintExperience")&&g._useNativeBrowserPrintUx}static set useNativeBrowserPrintUx(e){g._useNativeBrowserPrintUx=e}constructor(e,t,n=null,a=!0,i=!1,o=null,s=!1){if(super(e,!0,!(g.useNativeBrowserPrintUx&&a),new r.a(e,t),n,i,o,s),g.useNativeBrowserPrintUx=g.useNativeBrowserPrintUx&&a,g.useNativeBrowserPrintUx){const t=document.createElement("iframe");let a=null;const i=this.dialogOuterContainer;if(t.name="pdfObjectFrame",t.id="pdfObjectIFrame",n&&n.count>0){const i=c.a.getParametersFromUrl(e,n),o=c.a.removeParameters(e,n);a=document.createElement("form"),a.id="printPreviewPostForm",a.method="POST",a.target=t.name,a.action=o;for(const e of i){const t=document.createElement("input");t.type="hidden",t.name=e.key,t.value=e.value,a.appendChild(t)}}else t.src=e;i.appendChild(t),a&&(i.appendChild(a),a.submit()),Sys.UI.DomElement.addCssClass(t,"DirectPrintPdfObjectHidden"),l.a.setAriaAttribute(t,l.a.ariaHiddenAttribute,l.a.ariaTrueValue)}}}g._useNativeBrowserPrintUx=!1,(0,a.a)(g,"PrintDialogWithLinkToPdf",o.a,[])},8326:function(e,t,n){"use strict";n.d(t,{a:function(){return G}});var a=n(100),i=n(3792),o=n(4182),r=n(5018);const s="OnTopRowControlsCreatedEvent",l="OnTopRowControlsDisposingEvent",c="OnRenameTextboxStatusChangedEventKey";class d{add_onTopRowControlsCreated(e){this._eventSource.addHandler(s,e)}remove_onTopRowControlsCreated(e){this._eventSource.removeHandler(s,e)}add_onTopRowControlsDisposing(e){this._eventSource.addHandler(l,e)}remove_onTopRowControlsDisposing(e){this._eventSource.removeHandler(l,e)}add_onRenameTextboxStatusChanged(e){this._eventSource.addHandler(c,e)}remove_onRenameTextboxStatusChanged(e){this._eventSource.removeHandler(c,e)}get topRowControlsCreated(){return this._topRowControlsCreated}get standaloneRootControlManager(){return this._standaloneRootControlManager}raiseTopRowControlsCreatedEvent(e,t=null){this._topRowControlsCreated=!0,this._standaloneRootControlManager=e,this._eventSource.raiseEvent(s,t)}raiseOnTopRowControlsDisposingEvent(){this._topRowControlsCreated=!1,this._eventSource.raiseEvent(l)}raiseRenameTextboxStatusChangedEvent(e){this._eventSource.raiseEvent(c,e?"true":"false")}constructor(){this._eventSource=new r.a,this._topRowControlsCreated=!1,this._standaloneRootControlManager=null}}(0,a.a)(d,"HeaderEventSource",null,[]);const u=(0,i.b)("Common.App.Header.HeaderEventSource"),p=(0,i.e)(u,{onDemandRegister:(e,t)=>e.register(d,t).singleInstance()});var g=n(5149),h=n(4401),m=n(3245),_=n(6094),S=n(988),f=n(8103);class C{static createRibbonUpsellButton(e,t,a){if(!t||!e||C.hideButton)return;let i="1274543852";switch(m.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FreemiumUpsellShowDialogIsEnabled")&&(i="4180531998"),a){case 1:{const a=n(4941).a.addButton(C.freemiumUpsellEligibleButtonId+C.buttonCount.toString(),i,(0,f.a)("FreemiumUpsell"),C.freemiumUpsellButtonImageName,null,"Medium20",t,e);Sys.UI.DomElement.addCssClass(a,"FreemiumUpsellButton"),t.appendChild(a),C.registerRemoveCallback(a),m.AFrameworkApplication.theActionManager.processAction(S.a.reportFreemiumUpsellEligibleDisplayed,2),g.ULS.sendTraceTag(40739802,340,50,"Go Premium Upsell button created"),C.buttonCount++;break}}}static registerRemoveCallback(e){e&&(0,i.h)(o.a).execute((t=>{t.registerFeatureStateChangeCallback("MsoPremiumBadge",(t=>{e&&t.isEnabled&&(_.a.removeElement(e),C.hideButton=!0)}))}))}}C.freemiumUpsellButtonImageName="UpgradeProductGlyph_20x20x32",C.freemiumUpsellEligibleButtonId="btnFreemiumUpsellEligible",C.freemiumUpsellBadgeButtonId="btnFreemiumUpsellBadge",C.buttonCount=0,C.hideButton=!1,(0,a.a)(C,"RibbonUpsellButtonCreator",null,[]);class y extends Sys.EventArgs{constructor(e){super(),this.withoutSaveStatus=e}}(0,a.a)(y,"TopRowCreatedEventArgs",Sys.EventArgs,[]);var A=n(8979),b=n(2378),T=n(1207),v=n(9224),w=n(884),F=n(5374),I=n(8585),E=n(9865),M=n(6012);class k{constructor(e,t){this.cluster=e,this.css=t}}(0,a.a)(k,"ImageInfo",null,[]);class P{constructor(e,t,n,a,i,o,r,s,l,c,d,u,p,g,h=null,m=null){this.groupChatButtonGlyph32=null,this.id=e,this.actionIdCommand=t,this.actionIdQueryStatus=n,this.actionIdPopulateFlyout=a,this.actionIdCommandMenuOpen=i,this.actionIdCommandMenuClose=o,this.actionIdUserButtonClick=r,this.actionIdRefreshControl=s,this.singleUserCollabGlyph16=new k(l,c),this.singleUserCollabGlyph32=new k(d,u),this.multipleUserCollabGlyph16=new k(p,g),h&&m&&(this.groupChatButtonGlyph32=new k(h,m))}}(0,a.a)(P,"PeoplesWellBaseSettings",null,[]);class D{constructor(){this.breadcrumbContainer=null,this.breadcrumbItems=null}}(0,a.a)(D,"BreadcrumbControls",null,[]);class R{static getChatButtonSettings(){return R.swxDocChatSettings}constructor(e,t=S.a.toggleChatPane,n=S.a.queryDocChatButtonStatus,a=S.a.refreshChatControl,i=S.a.joinChatThread,o=null,r=null,s=!1){this.id=e,this.togglePaneActionId=t,this.queryStatusActionId=n,this.refreshControlActionId=a,this.joinChatActionId=i,this.imageName=o,this.unreadImageName=r,this.hideUnreadMessageCount=s}}R.swxDocChatSettings=new R("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32"),(0,a.a)(R,"ChatButtonSettings",null,[]);class x{constructor(){this.command=null,this.label=null,this.image=null,this.id=null,this.swxExperience=0}}(0,a.a)(x,"SkypeButtonInfo",null,[]);class L{constructor(){this.breadcrumb=null,this.titleSection=null,this.userControl=null}}(0,a.a)(L,"TopRowControls",null,[]);var U=n(7689),O=n(9858);const B="STR@",N="IMAGEPATH@",W="EmptyHeaderTopBars",H="BottomRowCenterSeparator",V="DocumentActionButton";class G{buildHeaderStringsDictionary(){G._headerStrings={SignoutLink:(0,f.a)("SignoutLink"),SignInLink:(0,f.a)("SignIn")}}updateData(e){const t={},n=G.getNodeAttributes(e);for(const e in n){const a={key:e,value:n[e]};if(void 0===a.value||null===a.value){g.ULS.sendTraceTag(559724060,207,10,"Entry : {0} and its Key : {1} ",a,a.key);continue}const i=a.value.toString();i&&(this.replaceIntlString(n,a.key,i),this.replaceImagePath(n,a.key,i),this.replaceImageMap(n,a.key,i,t))}for(const e in t){const a={key:e,value:t[e]};n[a.key+"Class"]=a.value}const a=G.getNodeChildren(e);for(let e=0;e<a.length;e++)this.updateData(a[e])}replaceIntlString(e,t,n){if(-1===n.indexOf(B))return;const a=n.replace(B,"");e[t]=this.getIntlString(a)}replaceImagePath(e,t,n){-1!==n.indexOf(N)&&(e[t]=T.a.staticContentHost+n.replace(N,this._imagePath)+T.a.staticContentQueryParameter)}replaceImageMap(e,t,n,a){if(-1===n.indexOf("IMGMAP@"))return;const i=n.split("@");if(3!==i.length)return;let o=m.AFrameworkApplication.imageClusterPath,r=F.c(i[2]);const s=i[1],l=m.AFrameworkApplication.imageClusterName;m.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordClusterPngRenameIsEnabled")&&"we"===s||s===l||(g.ULS.sendTraceTag(542971230,207,50,"imageMap and imageClusterName mismatch. imageMap : {0} and imageClusterName : {1}",s,l),o=m.AFrameworkApplication.versionedPathToClusterImages&&""!==m.AFrameworkApplication.versionedPathToClusterImages&&w.a.instance&&w.a.instance.isEnabled?w.a.instance.getHashedUrlFromVersionedUrl(m.AFrameworkApplication.versionedPathToClusterImages+s+".png"):o.replace(l+".png",s+".png"),r=r.replace(l,s)),e[t]=o,a[t]=r}getIntlString(e){for(const t of this._intlStringClasses){let n=t[e];if(null!=n)return n;if(n=t[e.replace(G._intlStringOptionalPrefix,"")],null!=n)return n}return""}createTopRowControls(e,t,n,a,i=!1,o=!1,r=!1){return this.createTopRowControlsInternal(e,t,n,a,!i,!i,o,r)}createTopRowControlsInternal(e,t,n,a,i,o,r,s){const l=new L,c=this.createTopLeftControls(e,i&&!this._isOfficePresentationAttendeeMode);c&&(l.breadcrumb=c,t.appendChild(c.breadcrumbContainer));const d=G.createGenericPeripheralSection(e,"QATRowCenter"),u=!!m.AFrameworkApplication.activeFrame.applicationInstance&&4===m.AFrameworkApplication.activeFrame.applicationInstance.officeAppType||!this._isOfficePresentationAttendeeMode;m.AFrameworkApplication.docPropertiesProvider.breadcrumbDocName&&o&&u&&G.createDocumentTitleElement(d),l.titleSection=d,t.appendChild(d),G.headerDocumentTitleSpanId=d.id;const p=G.createGenericPeripheralSection(e,"QATRowRight");if(p){if(n&&this.createActionButton(a,n,p,G.actionButtonDisplayModeInHeader),a&&h.h()&&C.createRibbonUpsellButton(a,p,m.AFrameworkApplication.freemiumUpsellMode),a&&h.c()){const e=G.getTopRightSkypeButtonInfo(),t=e.id+(G._topRowControlsCount>0?G._topRowControlsCount.toString():""),n=G.addButton(t,e.command,e.label,e.image,null,G.skypeButtonDisplayMode,p,a);G.skypeButtonId?G.secondSkypeButtonId=t:G.skypeButtonId=t,G._topRowControlsCount++,Sys.UI.DomElement.addCssClass(n,"SkypeButton"),n.style.display="none";const i=document.createElement("div");Sys.UI.DomElement.addCssClass(i,"SkypeUnreadConversationsDiv"),n.appendChild(i);const o=document.createElement("span");i.appendChild(o),Sys.UI.DomElement.addCssClass(o,"SkypeUCBBackground"),Sys.UI.DomElement.addCssClass(o,G.skypeUnreadConversationsBubbleClass),o.style.display="none"}if(!m.AFrameworkApplication.isEmbedded){let e=!1;if(m.AFrameworkApplication.userNameUnknown&&!m.AFrameworkApplication.signoutUrl||m.AFrameworkApplication.limitedEdit||e){const e=this.createSignInLink(m.AFrameworkApplication.signInUrl);e&&p.appendChild(e),l.userControl=e}else{const e=this.createUserNameAndSignOutLink();e&&p.appendChild(e),l.userControl=e}}t.appendChild(p)}return G._topRowControlsCount++,G.headerEventSource.raiseTopRowControlsCreatedEvent(a,new y(r)),l}createBottomRowRightControls(e,t,n,a,i=null,o=null,r=null,s=null){const l=G.createGenericPeripheralSection(e,"TabRowRight");if(a){if(G.createPeopleWellControl(n,a,l),G.createDocChatButton(a,l),i&&this.createActionButton(a,i,l,G.actionButtonDisplayModeInRibbon),s&&l){G.addButton(s.id,s.command,s.label,s.image,null,G.copyLinkButtonDisplayMode,l,a).className+=" "+V}if(o&&l){G.addToggleButton(o.id,o.command,o.queryCommand,o.label,o.image,o.keytip,G.commentsButtonDisplayMode,l,a).className+=" CommentsButton"}if(r&&l){G.addToggleButton(r.id,r.command,r.queryCommand,r.label,r.image,r.keytip,G.changesButtonDisplayMode,l,a).className+=" ChangesButton"}}t.appendChild(l)}createActionButton(e,t,n,a="Medium20"){if(!n||!t||!e)return;G.addButton(t.id+(G._topRowControlsCount>0?G._topRowControlsCount.toString():""),t.command,t.label,t.image,null,a,n,e).className+=" "+V}createBottomRowCenterControls(e,t,n,a,i,o,r){const s=G.createGenericPeripheralSection(e,"TabRowInline");G.addPrintButton(n,s,r),G.addTellMeSearchBox(a,s,r),i&&G.addSeparator(s,r),G.addOpenInClientButton(i,s,r),G.addFeedbackButton(o,r,s),t.appendChild(s)}createOfficeBrandElement(){let e=null;return void 0!==G._officeOnlineBrandWidth&&(e=document.createElement("span"),e.style.width=G._officeOnlineBrandWidth+"px",e.style.height=G._officeOnlineBrandHeight+"px",e.style.lineHeight=G._officeOnlineBrandHeight+"px",e.className="headBrand",e.innerText=(0,f.a)("AppNameShort"),g.ULS.shipAssertTag(40978313,207,(0,f.a)("AppNameShort").indexOf("webappshort")<0)),e}createTopRowSeparatorElement(e,t){let n=!1,a=!1;t&&(n=!!m.AFrameworkApplication.breadcrumbBrandName,a=!!m.AFrameworkApplication.breadcrumbFolderName);let i=null;return e&&(i=document.createElement("span"),i.className=e?"OfficeOnlineBrandSwitcherSeparator":"OfficeOnlineBrandBreadcrumbSeparator"),i}createTopLeftControls(e,t){const n=h.f(),a=G.createGenericPeripheralSection(e,"QATRowLeft");Sys.UI.DomElement.addCssClass(a,"BreadcrumbContainer");const i=new D;i.breadcrumbContainer=a,i.breadcrumbItems=[];const o=G.createUnifiedAppAndBrandContainer(e);if(n||this.createAppIcon(o),G.isTransistionalHeaderUIEnabled()||this.addSeparatorToContainer(o,n,t),this.createAndAddBreadCrumbToContainer(o,i.breadcrumbItems),a.appendChild(o),t){const e=G.createHostBrandAndFolderElements(a,G.breadcrumbSeparatorImageName);for(const t of e)Array.add(i.breadcrumbItems,t)}return i}addSeparatorToContainer(e,t,n){const a=this.createTopRowSeparatorElement(t,n);a&&e.appendChild(a)}createAndAddBreadCrumbToContainer(e,t){const n=this.createOfficeBrandElement();n&&(e.appendChild(n),Array.add(t,n))}createAppIcon(e){const t=F.a(36,36,"AppLogoSilhouette_36x36x32","AppHeaderIconFloat",!0,null);e.appendChild(t)}createSignInLink(e){let t=null;return e&&(t=document.createElement("a"),t.className="SignInLink",t.href=e,t.id=G.signInLinkId,t.innerText=G._headerStrings.SignInLink.toString(),t.target="_top",I.a.instance.registerHandlerWithBrowserClickOption(M.a.click,t,G.onSignInLinkClick,null,!0)),t}createUserNameAndSignOutLink(){let e=null;if(m.AFrameworkApplication.userName||m.AFrameworkApplication.signoutUrl){e=document.createElement("span"),Sys.UI.DomElement.addCssClass(e,"UsernameContainer");const t=document.createElement("span");if(t.className="UsernameNameContainer",e.appendChild(t),!m.AFrameworkApplication.userNameUnknown){const e=document.createElement("span");e.className="UsernameNameItem",e.setAttribute("dir","auto"),e.innerText=m.AFrameworkApplication.userName,t.appendChild(e)}let n=m.AFrameworkApplication.signoutUrl;if(n){if(!G.isTransistionalHeaderUIEnabled()){const t=document.createElement("span");t.className="UserNameSeparator",e.appendChild(t)}const t=document.createElement("a");t.className="SignoutLink",t.href=n,t.id=G.signoutLinkId,t.innerText=G._headerStrings.SignoutLink.toString(),e.appendChild(t)}}return e}static get headerEventSource(){return G._headerEventSource||(G._headerEventSource=(0,i.a)(p))}static registerOnClickBreadcrumbLink(e){G._breadcrumbLinkClickHandler=e}static getNodeAttributes(e){return e.attrs}static getNodeChildren(e){const t=e.children;return t??G.emptyArray}static get emptyArray(){return void 0!==G.s_emptyArray&&null!==G.s_emptyArray||(G.s_emptyArray=[]),G.s_emptyArray}static getPeoplesWellDefaultControlSettings(e,t,n,a,i,o,r=null,s=null){return new P(G.peoplesWellControlId,S.a.coauthoringCommand,S.a.coauthoringQueryStatus,S.a.coauthoringPopulateFlyout,S.a.coauthoringCommandMenuOpen,S.a.coauthoringCommandMenuClose,S.a.coauthoringUserButtonClick,S.a.coauthoringRefreshControl,e,t,n,a,i,o,r,s)}static addFeedbackButton(e,t,n){if(e&&t){const a=v.a(G.feedbackButtonId,e.command,e.label,null),i=t.hostControl(G.feedbackButtonId,a,"Medium");i&&n&&(Sys.UI.DomElement.addCssClass(i,"UITextTranformUpperCase"),Sys.UI.DomElement.addCssClass(i,"GiveFeedbackControl"),n.appendChild(i))}}static createPeopleWellControl(e,t,n){if(e&&t){const a=v.j(e),i=t.hostControl(e.id,a,"Medium");i&&(Sys.UI.DomElement.addCssClass(i,"PeoplesWellControl"),n.appendChild(i))}}static createDocChatButton(e,t){let n;const a=R.swxDocChatSettings;const i=m.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DocChatIsEnabled"),o=m.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BasicChatIsEnabled");i&&a&&e&&(n=!o&&i?v.i(a.id,a.id,a.togglePaneActionId.toString(),a.queryStatusActionId.toString(),(0,f.a)("DocChatButtonLabel"),(0,f.a)("DocChatButtonTooltip"),a.imageName,!1):v.a(a.id,a.togglePaneActionId.toString(),(0,f.a)("DocChatButtonLabel"),a.imageName,a.id,null,(0,f.a)("DocChatButtonTooltip"),"Medium",null,a.queryStatusActionId.toString(),void 0,void 0,void 0,!1),e.addControl(a.id,n)&&G.addDocChatButtonToContainer(t,e.getDOMElementForControlDisplayMode(a.id,"Medium")))}static getTopRightSkypeButtonInfo(){let e=null;const t=m.AFrameworkApplication.appSettingsManager.getIntAppSetting("SkypeExperience",0);let n=1===t?G.skypeConsumerButtonWhite:G.skypeBusinessButtonWhite;return G.isTransistionalHeaderUIEnabled()&&(n=G.skypeNewHeaderButton),e=Object.assign(new x,{label:(0,f.a)("SkypeTooltip"),command:"3476734992",image:n,id:G.skypeButtonPrefixId,swxExperience:t}),e}static addDocChatButtonToContainer(e,t){t&&(t.style.display="none",e.appendChild(t))}static disposeTopRowControls(e){let t;e.breadcrumb&&(G.disposeTopLeftControls(e.breadcrumb),e.breadcrumb=null),e.titleSection&&(G.disposeTitleElement(),e.titleSection=null),e.userControl&&(G.disposeUserControl(e.userControl),e.userControl=null),G.headerEventSource.raiseOnTopRowControlsDisposingEvent(),({headerPanel:t}=b.a.tryEnsuredHeaderPanelInitialized(!1)).returnValue&&(_.a.clearElementHtml(t),G.skypeButtonId=G.secondSkypeButtonId=null)}static createDocumentTitleElement(e){return G.createDocumentTitleElementInternal(e,m.AFrameworkApplication.isRenameSupported())}static createDocumentTitleElementInternal(e,t){let n=m.AFrameworkApplication.docPropertiesProvider.breadcrumbDocName;m.AFrameworkApplication.documentIsFolder||(n=O.a.getFileNameWithoutExtension(n));const a=G.createBreadcrumbItem(e,G.breadcrumbTitleId,n,null,t);return t&&(m.AFrameworkApplication.documentTitleInputElement=a),a}static createEmptyHeaderAndToolbar(e){const t=document.createElement("div");t.className="cui-viewerchrome";const{elmHeaderContainer:n,elmCuiRibbonTopBars:a}=G.ensureTopBars(t);return G.ensureTopBars1And2(e,n,a),t.appendChild(a),t}static ensureTopBars(e){let t;const n=document.createElement("div");let a;return n.className="cui-ribbonTopBars",({headerPanel:a}=b.a.tryEnsuredHeaderPanelInitialized()).returnValue?(t=document.createElement("div"),t.id=W,t.className="cui-viewerchrome cui-ribbonTopBars empty",a.appendChild(t),Sys.UI.DomElement.addCssClass(e,"cui-exth")):t=n,{elmHeaderContainer:t,elmCuiRibbonTopBars:n}}static ensureTopBars1And2(e,t,n){const a=document.createElement("div");a.className="cui-topBar1",m.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LegacyHeaderAppColorIsEnabled")&&(a.className+=" cui-topBar1-transistionalHeaderUI"),e&&(a.style.display="none"),t.appendChild(a);const i=document.createElement("div");return i.className="cui-topBar2",n.appendChild(i),m.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(a.className+=" cui-color-update"),{elmCuiTopBar1:a,elmCuiTopBar2:i}}static disposeEmptyHeaderAndToolbar(e){_.a.removeElement(e);const t=document.getElementById(W);t&&_.a.removeElement(t)}static initializeRenameUIHandler(){m.AFrameworkApplication.theActionManager.processAction(S.a.initializeRenameUIHandler,2)}static disposeTitleElement(){m.AFrameworkApplication.documentTitleInputElement&&E.EventHandlerManager.instance.unregisterAllHandlers(m.AFrameworkApplication.documentTitleInputElement)}static addPrintButton(e,t,n){e&&n&&G.addButton(G.printButtonId,e.command,e.label,null,(0,f.a)("PrintKeytip"),"Medium",t,n)}static addTellMeSearchBox(e,t,n){if(!e||!n)return;const a=G.buildSearchBoxXml(G.tellMeSearchBoxId,e.accessibilityTextCommand,e.command,e.commandMenuClose,e.commandMenuOpen,e.menuControlExecutedCommand,e.onInteractionBegin,e.onRestoreFocus,e.onInputBoxFocus,e.onInputBoxBlur,e.populateQueryCommand,e.populateAsyncTriggerCommand,!0,!1,e.altText,e.placeHolderText,e.keytip,"182px",m.AFrameworkApplication.imageClusterPath,F.c("Oz_16x16x32"),F.c("OzSilhouette_Glyph_16x16x32"),F.c("OzSilhouette_16x16x32")),i=n.hostControl(G.tellMeSearchBoxId,a,"Medium");Sys.UI.DomElement.addCssClass(i,G.tellMeSearchBoxClass),i&&(m.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled")&&G.hideTellMeSearchBoxOnlyTillFeatureIsEnabled(i,t),t.appendChild(i))}static hideTellMeSearchBoxOnlyTillFeatureIsEnabled(e,t){const n=e.childNodes;for(let e=0;e<n.length;e++)n[e].style.display="none";(0,i.h)(o.a).execute((e=>{e.isFeatureEnabled("ConnectedServices",!0).then((e=>{if(e)for(let e=0;e<n.length;e++)n[e].style.display="";return null}))}))}static addOpenInClientButton(e,t,n){if(e&&n){const a=G.addButton(G.openInClientButtonId,e.command,e.label,null,(0,f.a)("OpenInClientKeytip"),"Medium",t,n);Sys.UI.DomElement.addCssClass(a,G.openInClientButtonClass)}}static buildSearchBoxXml(e,t,n,a,i,o,r,s,l,c,d,u,p,g,h,m,_,S,f,C,y,A){const b={Id:e,AccessibilityTextCommand:t,Command:n,CommandMenuClose:a,CommandMenuOpen:i,MenuControlExecutedCommand:o,InteractionBeginCommand:r,RestoreFocusCommand:s,InputBoxFocusCommand:l,InputBoxBlurCommand:c,PopulateQueryCommand:d,PopulateAsyncTriggerCommand:u,PopulateDynamically:p,PopulateOnlyOnce:g,Alt:h,PlaceholderText:m,Keytip:_,Width:S,Image16by16:f,Image16by16Class:C,LightImage16by16Class:y,DarkImage16by16Class:A};let T="<SearchBox ";for(const e in b){const t={key:e,value:b[e]};t.value&&(T+=t.key+'="'+O.a.xmlEncode(t.value.toString())+'" ')}return T+"/>"}static addSeparator(e,t){if(!t)return;const n=v.g(H),a=t.hostControl(H,n,"Small");a&&e.appendChild(a)}static addButton(e,t,n,a,i,o,r,s){const l=v.a(e,t,n,a,null,null,null,o,null,null,void 0,void 0,i),c=s.hostControl(e,l,o);return c&&r.appendChild(c),c}static addToggleButton(e,t,n,a,i,o,r,s,l,c=!0){const d=v.i(e,null,t,n,a,a,i,c,o),u=l.hostControl(e,d,r);return u&&s.appendChild(u),u}static createGenericPeripheralSection(e,t){const n=document.createElement("span");return n.className="cui-"+t,n.id=G.generatePeripheralSectionID(e,t),n.style.display="none",n}static generatePeripheralSectionID(e,t){return e+"-"+t}static createUnifiedAppAndBrandContainer(e){const t=document.createElement("span");return Sys.UI.DomElement.addCssClass(t,"AppAndBrandContainer"),t.id=e+"-AppAndBrandContainer",t}static createAppBrandElement(e){return G.createBreadcrumbItem(e,G.breadcrumbAppBrandId,(0,f.a)("AppNameShort"),null,!1)}static createAppBrandSeparatorElement(e){const t=document.createElement("span");return t.className="AppBrandSeparator",e.appendChild(t),t}static createHostBrandAndFolderElements(e,t){const n=!!m.AFrameworkApplication.breadcrumbBrandName,a=!!m.AFrameworkApplication.breadcrumbFolderName,i=[];let o=null;if(n&&(o=G.createBreadcrumbItem(e,G.breadcrumbBrandId,m.AFrameworkApplication.breadcrumbBrandName,m.AFrameworkApplication.breadcrumbBrandUrl,!1),Array.add(i,o),a)){const n=F.a(6,16,t,"BreadcrumbItem FolderSeparator",!0,"");n.id=G.folderSeparatorId,e.appendChild(n),Array.add(i,n)}return a&&(o=G.createBreadcrumbItem(e,G.breadcrumbFolderId,m.AFrameworkApplication.breadcrumbFolderName,m.AFrameworkApplication.breadcrumbFolderUrl,!1),Array.add(i,o)),i}static createBreadcrumbItem(e,t,n,a,i){let o;return!!a?(o=document.createElement("a"),o.href=a,o.target="_top",I.a.instance.registerHandlerWithBrowserClickOption(M.a.click,o,G.onBreadcrumbLinkClick,null,!0)):i?(o=document.createElement("div"),o.tabIndex=0):o=document.createElement("span"),o.className="BreadcrumbItem"+(i?" Selectable":""),o.id=t,o.innerText=n,o.setAttribute("dir","auto"),e.appendChild(o),o}static disposeTopLeftControls(e){e.breadcrumbItems&&E.EventHandlerManager.instance.unregisterAllHandlersForDOMArray(e.breadcrumbItems)}static onBreadcrumbLinkClick(e){const t=A.a.instance.startActivity(S.a.breadcrumbLinkClick);return t.properties.add("id",e.caughtElement.id),t.end(),g.ULS.sendTraceTag(595732178,207,50,"Breadcrumb link clicked: {0}",{id:e.caughtElement.id}),!!G._breadcrumbLinkClickHandler&&G._breadcrumbLinkClickHandler(e)}static disposeUserControl(e){I.a.instance.unregisterHandlerWithBrowserClickOption(M.a.click,e,G.onSignInLinkClick,!0)}static onSignInLinkClick(e){if(m.AFrameworkApplication.useSignInCommandPostMessage){const e=m.AFrameworkApplication.activeFrame.applicationInstance.getSignInParams();m.AFrameworkApplication.activeFrame.signInInternal(e),m.AFrameworkApplication.useSignInCommandPostMessage=!1}else window.top.location=m.AFrameworkApplication.signInUrl;return!0}static isTransistionalHeaderUIEnabled(){return!!m.AFrameworkApplication.activeFrame&&m.AFrameworkApplication.activeFrame.applicationInstance.isTransistionalHeaderUIEnabled}constructor(e,t,n=null,a=null,i=null){this._imagePath=e,this._intlStringClasses=U.a.mergeWithOptionalArray(t,i),"undefined"!=typeof CommonUiStrings&&this._intlStringClasses.push(CommonUiStrings),"undefined"!=typeof CommonUIStrings&&this._intlStringClasses.push(CommonUIStrings),this._isOfficePresentationAttendeeMode=h.b(),G._actionManager=n??m.AFrameworkApplication.theActionManager,null==a?this.buildHeaderStringsDictionary():G._headerStrings=a,G._officeOnlineBrandWidth=m.AFrameworkApplication.unifiedHeaderOfficeOnlineLogoWidth,G._officeOnlineBrandHeight=G.unifiedHeaderHeight}}G._headerEventSource=null,G._intlStringOptionalPrefix=new RegExp("L_","i"),G.shareButtonImg20="ShareServerWhite_20x20x32",G.skypeConsumerButtonBlack="WACSkypeButtonBlack_20x20x32",G.skypeConsumerButtonWhite="WACSkypeButtonWhite_20x20x32",G.skypeBusinessButtonBlack="WACSkypeBusinessButtonBlack_20x20x32",G.skypeBusinessButtonWhite="WACSkypeBusinessButtonWhite_20x20x32",G.skypeNewHeaderButton="SkypeTitlebar_20x20x32",G.externalHeaderFullTopBarsId="ExternalHeaderFullTopBars",G.externalHeaderViewerChromeTopBarsId="ExternalHeaderViewerChromeTopBars",G.headerTopBarsId="HeaderTopBars",G.breadcrumbAppBrandId="BreadcrumbAppBrand",G.breadcrumbBrandId="BreadcrumbBrand",G.breadcrumbFolderId="BreadcrumbFolder",G.breadcrumbTitleId="BreadcrumbTitle",G.folderSeparatorId="FolderSeparator",G.signoutLinkId="SignoutLink",G.signInLinkId="SignInLink",G.tellMeSearchBoxId="sbTellMe",G.simplifiedTellMeSearchBoxId="TellMe-SearchBox",G.openInClientButtonId="btnOpenInClient",G.printButtonId="btnPrint",G.shareButtonId="btnFileSharing",G.skypeButtonPrefixId="BasicChat",G.replyWithChangesButtonId="btnReplyWithChanges",G.feedbackButtonId="jbtnGiveFeedback",G.peoplesWellControlId="PeoplesWellControl",G.editableBreadcrumbItemClass="EditableBreadcrumbItem",G.tellMeSearchBoxClass="TellMeSearchBox",G.openInClientButtonClass="ButtonOpenInClient",G.skypeUnreadConversationsBubbleClass="SkypeUnreadConversationsBubble",G._actionManager=null,G._headerStrings=null,G._breadcrumbLinkClickHandler=null,G._officeOnlineBrandWidth=0,G._officeOnlineBrandHeight=0,G.unifiedHeaderHeight=50,G._topRowControlsCount=0,G.breadcrumbSeparatorImageName="BreadcrumbCaret_6x16x32",G.breadcrumbAlternateSeparatorImageName="BreadcrumbCaretAlt_6x16x32",G.skypeButtonDisplayMode="Small20",G.actionButtonDisplayModeInRibbon="Medium",G.actionButtonDisplayModeInHeader="Medium20",G.commentsButtonDisplayMode="Medium",G.changesButtonDisplayMode="Medium",G.copyLinkButtonDisplayMode="Medium",G.headerDocumentTitleSpanId=null,G.skypeButtonId=null,G.secondSkypeButtonId=null,G.s_emptyArray=null,(0,a.a)(G,"CuiHelper",null,[25])},4941:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(9224);class o{static addButton(e,t,n,a,o,r,s,l){const c=i.a(e,t,n,a,null,null,null,r,null,null,void 0,void 0,o),d=l.hostControl(e,c,r);return d&&s.appendChild(d),d}}o.replyWithChangesButtonId="btnReplyWithChanges",(0,a.a)(o,"CuiHelperStatic",null,[])},4401:function(e,t,n){"use strict";n.d(t,{a:function(){return S},b:function(){return c},c:function(){return _},d:function(){return u},e:function(){return m},f:function(){return h},g:function(){return p},h:function(){return d}});var a=n(3245),i=n(100);class o{constructor(){this.command=null,this.label=null,this.image=null,this.id=null,this.keytip=null}}(0,i.a)(o,"HeaderButtonInfo",null,[]);var r=n(3516),s=n(1163),l=n(8103);const c=()=>a.AFrameworkApplication.isEmbedded,d=()=>{const e=a.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled;return!c()&&!a.AFrameworkApplication.hideHeader&&r.a()&&(e||1===a.AFrameworkApplication.freemiumUpsellMode)},u=()=>a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DiscoverPremiumButtonEnabled"),p=()=>a.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AnonymousSignInButtonExperiment",!1)&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"),g=()=>a.AFrameworkApplication.shouldShowSwitcher&&!c()&&!a.AFrameworkApplication.hideHeader,h=()=>g()&&!("officecomhwa"===(a.AFrameworkApplication.appSettingsManager.getStringAppSetting(a.AFrameworkApplication.uiHostSettingName)||"").toLowerCase())&&!a.AFrameworkApplication.hideAppLauncherInHeaderByUiHost&&!s.a.isOculusPwa,m=()=>!a.AFrameworkApplication.hideMeInHeaderByUiHost&&g(),_=()=>!c()&&!a.AFrameworkApplication.hideHeader&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BasicChatIsEnabled"),S=()=>{if(a.AFrameworkApplication.hideWorkflowInHeaderByUiHost)return null;const e=a.AFrameworkApplication.isReplyWithChangesWorkFlow&&!!a.AFrameworkApplication.replyWithChangesUrl||a.AFrameworkApplication.useReplyWithChangesPostMessage,t=!!a.AFrameworkApplication.activeFrame&&a.AFrameworkApplication.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled;if(e&&t)return Object.assign(new o,{command:"1197060601",label:(0,l.a)("ReplyWithChanges"),id:n(4941).a.replyWithChangesButtonId});if(a.AFrameworkApplication.workflowEnabled){let e="";switch(a.AFrameworkApplication.workflowTypeString){case"Assign":e=(0,l.a)("Assign");break;case"Submit":e=(0,l.a)("Submit")}if(""!==e)return Object.assign(new o,{command:"2988588587",label:e,id:"btnWorkflow"})}return null};a.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HeaderPlaceholderAddNewUx",!1)},8028:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.Header.IReactSharedHeaderFocusManager")},1400:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(4238),o=n(5278),r=n(5072),s=n(2544),l=n(988);class c{registerF6(e,t,n,a=null){const i=this._focusManager.getScope(t);i.parent=n,i.keyDownHandledExternally=!0,a&&i.addOnFocus(a),this._mouseInputManager.addControlFocus(t,e,!1),this._touchInputManager.addControlFocus(t,e,!1);const l=new o.a((()=>e));l.addValidTag(2),l.addValidTag(1),l.addValidTag(8),l.addValidTag(5),l.addValidTag(3),l.addValidTag(6);this._focusManager.buildRegionWithDelegate((()=>e),i,l).looped=!0;const c=s.a.hashKey(r.a.vK_Tab,0),d=s.a.hashKey(r.a.vK_Tab,4);i.unBindAction(c),i.unBindAction(d)}onFlexPaneOpen(e){this.registerF6(e,"ReactSharedHeaderMeControlFlexPane","headerui"),this._focusManager.setScope("ReactSharedHeaderMeControlFlexPane"),this._f6Manager.addF6("ReactSharedHeaderMeControlFlexPane")}onFlexPaneClose(e){this._f6Manager.deactivateFocus("ReactSharedHeaderMeControlFlexPane"),this._focusManager.setScope("headerui")}onChatOpen(e,t){this._transferFocusToChat||(this._transferFocusToChat=t,this.registerF6(e,"chat_wrapper_pane",i.a.appFocusId,this.onChatFocus)),this._focusManager.setScope("chat_wrapper_pane"),this._f6Manager.addF6("chat_wrapper_pane")}onChatClose(){this._f6Manager.deactivateFocus("chat_wrapper_pane"),this._focusManager.forceScopeChange(i.a.documentFocusID)}onChatCtrlF6(e){this._actionManager.processAction(e?l.a.f6shift:l.a.f6,2)}constructor(e,t,n,a,i){this._transferFocusToChat=null,this.onChatFocus=(e,t)=>{this._transferFocusToChat&&this._transferFocusToChat()},this._focusManager=e,this._f6Manager=t,this._mouseInputManager=n,this._touchInputManager=a,this._actionManager=i}}(0,a.a)(c,"ReactSharedHeaderFocusManager",null,[250])},5325:function(e,t,n){"use strict";n.d(t,{a:function(){return W}});var a=n(100),i=n(625),o=n(7958);class r{get elmContainer(){return this._elmContainer}get containerBounds(){return o.a.getElementBounds(this.elmContainer)}get isVisible(){return this._isVisible}dispose(){}constructor(){this._elmContainer=null,this._isVisible=!0}}(0,a.a)(r,"ViewerChromeItemContainer",null,[462]);class s extends r{hide(){this.elmContainer&&(this._isVisible=!1,this.elmContainer.style.display="none")}undoScaling(){this._elementToTruncate&&(this._elementToTruncate.style.width="auto",this._elementToTruncate.style.maxWidth="none"),this.elmContainer&&(this._isVisible=!0,this.elmContainer.style.display="inline-block")}truncateWidth(e){this._elementToTruncate&&(this._elementToTruncate.style.maxWidth=e+"px")}constructor(){super(),this._elementToTruncate=null}}(0,a.a)(s,"ScalableViewerChromeItemContainer",r,[463,462]);var l=n(8326);class c{static createUnselectableElement(e){const t=document.createElement(e);return c.setUnselectable(t),t}static setUnselectable(e){e.setAttribute("unselectable","on")}}(0,a.a)(c,"ViewerChromeStatic",null,[]);var d=n(3245),u=n(9865);class p extends s{getBreadcrumbItem(e){if(!this._breadcrumbItems)return null;for(let t=0;t<this._breadcrumbItems.length;t++)if(this._breadcrumbItems[t].id===e)return this._breadcrumbItems[t];return null}truncateWidth(e){if(this._elementToTruncate=this.getBreadcrumbItem(l.a.breadcrumbFolderId),!this._elementToTruncate)return;const t=p.calculateBreadcrumbFolderNameMaxWidth(this.elmContainer.offsetWidth,this._elementToTruncate.offsetWidth,e);t>0&&super.truncateWidth(t)}dispose(){u.EventHandlerManager.instance.unregisterAllHandlersForDOMArray(this._breadcrumbItems)}static calculateBreadcrumbFolderNameMaxWidth(e,t,n){return t-(e-n)}constructor(){super(),this._elmContainer=c.createUnselectableElement("span"),this.elmContainer.className="cui-herobar-breadcrumbContainer",this.elmContainer.id="viewerChrome-breadcrumbContainer",d.AFrameworkApplication.hideHeader&&(l.a.createAppBrandElement(this.elmContainer),(d.AFrameworkApplication.breadcrumbBrandName||d.AFrameworkApplication.breadcrumbFolderName)&&l.a.createAppBrandSeparatorElement(this.elmContainer)),this._breadcrumbItems=l.a.createHostBrandAndFolderElements(this.elmContainer,l.a.breadcrumbAlternateSeparatorImageName)}}(0,a.a)(p,"BreadcrumbContainer",s,[]);var g=n(5374);class h extends s{dispose(){l.a.disposeTitleElement()}constructor(){if(super(),this._elmContainer=c.createUnselectableElement("span"),this.elmContainer.id="viewerChrome-documentTitleContainer",d.AFrameworkApplication.isMobileMode){this.elmContainer.className="cui-herobar-MobileDocTitleContainer";const e=g.a(32,32,d.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppIcon"),"AppHeaderIconFloat",!0,"");e.style.margin="4px",e.style.marginLeft="12px",this.elmContainer.appendChild(e)}else this.elmContainer.className="cui-herobar-documentTitleContainer";d.AFrameworkApplication.docPropertiesProvider.breadcrumbDocName&&(this._elementToTruncate=l.a.createDocumentTitleElementInternal(this.elmContainer,!1),d.AFrameworkApplication.isMobileMode&&(this._elementToTruncate.style.padding="10px 5px 10px",this._elementToTruncate.style.lineHeight="18px"))}}(0,a.a)(h,"DocumentTitleContainer",s,[]);class m extends r{constructor(){super(),this._elmContainer=c.createUnselectableElement("span"),this.elmContainer.className="cui-herobar-toolbarContainer",this.elmContainer.id="viewerChrome-ToolbarContainer",d.AFrameworkApplication.isMobileMode&&1===d.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&(this.elmContainer.style.fontSize="1.42em")}}(0,a.a)(m,"ToolbarContainer",r,[]);var _=n(2378),S=n(9123),f=n(6094),C=n(4941);const y="_scaleStep",A="_isHidden";class b{static scaleHeader(e){const{topBar1ExclusiveContainer:t,topBar2ExclusiveContainer:n}=b.findDefaultRibbonTopBars();b.scaleHeaderUsingContainers(t,n,e)}static findDefaultRibbonTopBars(){let e,t;const{headerPanel:n}=_.a.tryEnsuredHeaderPanelInitialized(!d.AFrameworkApplication.hideHeaderEmbedded),a=$get(l.a.headerTopBarsId);return n?(e=document.getElementById(l.a.externalHeaderFullTopBarsId),t=a):(e=a.childNodes[0],t=a.childNodes[1]),{topBar1ExclusiveContainer:e,topBar2ExclusiveContainer:t}}static scaleHeaderUsingContainers(e,t,n){if(e&&t&&t.clientHeight>0){const a=-1!==t.parentNode.parentNode.className.indexOf("cui-ribbon");b.scaleHeaderCore(e,t,n,a)}}static scaleHeaderCore(e,t,n,a){let i=null,o=null,r=null,s=null,l=null,c=null,d=null,u=null,p=null,g=null,h=null,m=null,_=null,S=null,f=null,C=null,y=null,A=null,T=null,v=null;({elmTopRowLeft:i,elmTopRowCenter:o,elmTopRowRight:r,elmBreadcrumbSeparator:s,elmHostBrand:l,elmFolderSeparator:c,elmFolder:d,elmTitle:u,elmTopRightActionButton:p,elmUserNameNameContainer:g,elmUserNameNameItem:h,elmUpsellButton:v}=b.findHeaderItems(e,i,o,r,s,l,c,d,u,p,g,h,v)),({elmFileButton:m,elmTabHeaders:_,elmTabHeadersSeparator:S,elmBottomRowCenter:f,elmOpenInClientButton:C,elmFeedbackButton:y,elmPeopleWellControl:A,elmBottomRowRight:T}=b.findTopBar2Items(t,m,_,S,f,C,y,A,T));const w=[i,o,r,s,l,c,d,u,p,g,h,S,f,C,y,A,T,v];for(const e of w)b.showElement(e);const F=[i,o,r,l,d,u,g,h,f,y,A,T];for(const e of F)b.untruncateElement(e);b.resetPosition(o),b.setHeaderScaleIndex(_,0),b.ensureNoHeaderItemsOverlap(i,o,r,s,l,c,d,u,p,g,h,m,_,S,f,C,y,A,T,v,a,n),b.adjustBreadcrumbDisplay(c,d)}static scaleNonCuiHeaders(e,t){b.scaleHeaderCore(e,null,t,!1)}static adjustBreadcrumbDisplay(e,t){e&&t&&(e.style.marginTop=(t.offsetHeight-e.offsetHeight)/2+"px")}static findHeaderItems(e,t,n,a,i,o,r,s,c,d,u,p,g){for(let h=0;e&&h<e.childNodes.length;h++){const m=e.childNodes[h],_=f.a.getDOMElementClassName(m),S=!!m.id;-1!==_.indexOf("cui-QATRowLeft")?t=m:-1!==_.indexOf("cui-QATRowCenter")?n=m:-1!==_.indexOf("cui-QATRowRight")?a=m:-1!==_.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?i=m:m.id===l.a.breadcrumbBrandId?o=m:m.id===l.a.folderSeparatorId?r=m:m.id===l.a.breadcrumbFolderId?s=m:m.id===l.a.breadcrumbTitleId?c=m:S&&b.isElementTopRightActionButton(m)?d=m:-1!==_.indexOf("UsernameNameContainer")?u=m:-1!==_.indexOf("UsernameNameItem")?p=m:-1!==_.indexOf("FreemiumUpsellButton")&&(g=m),({elmTopRowLeft:t,elmTopRowCenter:n,elmTopRowRight:a,elmBreadcrumbSeparator:i,elmHostBrand:o,elmFolderSeparator:r,elmFolder:s,elmTitle:c,elmTopRightActionButton:d,elmUserNameNameContainer:u,elmUserNameNameItem:p,elmUpsellButton:g}=b.findHeaderItems(m,t,n,a,i,o,r,s,c,d,u,p,g))}return{elmTopRowLeft:t,elmTopRowCenter:n,elmTopRowRight:a,elmBreadcrumbSeparator:i,elmHostBrand:o,elmFolderSeparator:r,elmFolder:s,elmTitle:c,elmTopRightActionButton:d,elmUserNameNameContainer:u,elmUserNameNameItem:p,elmUpsellButton:g}}static findTopBar2Items(e,t,n,a,i,o,r,s,c){for(let d=0;e&&d<e.childNodes.length;d++){const u=e.childNodes[d],p=f.a.getDOMElementClassName(u),g=!!u.id;-1!==p.indexOf("cui-jewel-container")?t=u:-1!==p.indexOf("cui-tts")?n=u:-1!==p.indexOf("cui-TabRowInline")?i=u:-1!==p.indexOf("cui-TabRowRight")?c=u:-1!==p.indexOf("cui-separator")?a=u:g&&u.id.startsWith(l.a.openInClientButtonId)&&!o?o=u:g&&u.id.startsWith(l.a.feedbackButtonId)?r=u:g&&u.id.startsWith(l.a.peoplesWellControlId)&&(s=u),({elmFileButton:t,elmTabHeaders:n,elmTabHeadersSeparator:a,elmBottomRowCenter:i,elmOpenInClientButton:o,elmFeedbackButton:r,elmPeopleWellControl:s,elmBottomRowRight:c}=b.findTopBar2Items(u,t,n,a,i,o,r,s,c))}return{elmFileButton:t,elmTabHeaders:n,elmTabHeadersSeparator:a,elmBottomRowCenter:i,elmOpenInClientButton:o,elmFeedbackButton:r,elmPeopleWellControl:s,elmBottomRowRight:c}}static scaleBottomRowItems(e,t,n,a,i,o,r,s,l){b.relativeLayoutAwry(e,t,l)&&(b.headerScaleDown(t),b.relativeLayoutAwry(e,t,l)&&b.headerScaleDown(t)),b.relativeLayoutAwry(t,a,l)&&(b.hideElement(n),b.hideElement(i),b.relativeLayoutAwry(t,a,l)&&(b.headerScaleDown(t),b.relativeLayoutAwry(t,a,l)&&(b.headerScaleDown(t),b.relativeLayoutAwry(t,a,l)&&b.hideElement(a)))),b.relativeLayoutAwry(a,s,l)&&(b.hideElement(n),b.hideElement(i));const c=[o,r,s];b.hideElementsIfContainerControlsOverlap(a,s,c,l),b.hideElementsIfContainerControlsOverlap(t,s,c,l)}static hideElementsIfContainerControlsOverlap(e,t,n,a){let i=0;for(;i<n.length&&b.relativeLayoutAwry(e,t,a);)b.hideElement(n[i]),i++}static getScaleStep(e){if(!e)return 0;if(void 0===e[y]||null===e[y]){let t=0;-1!==e.className.indexOf("cui-tts-scale1")?t=1:-1!==e.className.indexOf("cui-tts-scale2")&&(t=2),e[y]=t}return parseInt(e[y])}static headerScaleDown(e){let t=b.getScaleStep(e);t<2&&b.setHeaderScaleIndex(e,++t)}static headerScaleUp(e){let t=b.getScaleStep(e);t>0&&b.setHeaderScaleIndex(e,--t)}static setHeaderScaleIndex(e,t){e&&(e.className=b.ribbonHeaderScaleClasses[t],e[y]=t)}static relativeLayoutAwry(e,t,n){return!(!e||!t)&&o.a.leftBoundsOverlapsRightBounds(o.a.getElementBounds(e),o.a.getElementBounds(t),n)}static overlapAmount(e,t,n){let a=0;return e&&t&&(a=o.a.leftBoundsOverlapsRightBoundsByAmount(o.a.getElementBounds(e),o.a.getElementBounds(t),n)),a}static contextualTabsVisible(e){for(let t=0;e&&t<e.childNodes.length;t++){if(-1!==e.childNodes[t].className.indexOf("cui-cg"))return!0}return!1}static getFirstContextualTabSet(e){let t=null;for(let n=e.childNodes.length-1;e&&n>=0;n--){const a=e.childNodes[n];if(-1===a.className.indexOf("cui-cg"))break;t=a}return t}static truncateElement(e,t,n){if(e&&!b.isHidden(e)){let a=S.a.getCurrentStyle(e);const i=f.a.parseCssSize(a.paddingLeft)+f.a.parseCssSize(a.paddingRight);let o=e.offsetWidth-n-i,r=t,s=0;for(;r&&r!==e;)a=S.a.getCurrentStyle(r),a&&(s+=f.a.parseCssSize(a.paddingLeft)+f.a.parseCssSize(a.paddingRight)),r=r.parentNode;o=Math.max(o,75+s),e.style.width=o+"px"}}static repositionElement(e,t,n){if(e&&t){let a=0,i=0;({left:a,top:i}=o.a.getElementAbsolutePosition(t,a,i));const r=n?a-e.offsetWidth:a+t.offsetWidth;b.moveElement(e,r)}}static ensureNoHeaderItemsOverlap(e,t,n,a,i,o,r,s,l,c,d,u,p,g,h,m,_,S,f,C,y,A){y&&b.scaleBottomRowItems(u,p,g,h,m,_,S,f,A),b.contextualTabsVisible(p)?b.scaleTopRowItemsAroundContextualTabs(p,e,t,n,a,i,o,r,s,l,c,d,C,A):b.scaleTopRowItems(e,t,n,a,i,o,r,s,l,c,d,C,A)}static scaleTopRowItems(e,t,n,a,i,o,r,s,l,c,d,u,p){const g=!!i,h=!!r,m=!!s;let _=0;if((h||m)&&(_=b.overlapAmount(e,t,p))>0){let n=h;m&&(!h||s.offsetWidth>r.offsetWidth)&&(n=!1),b.truncateElement(n?r:s,n?r:s,n?_:2*_),h&&m&&(_=b.overlapAmount(e,t,p))>0&&b.truncateElement(n?r:s,n?r:s,n?_:2*_)}(h&&b.relativeLayoutAwry(r,t,p)||g&&b.relativeLayoutAwry(i,t,p))&&(b.hideElement(a),b.hideElement(i),b.hideElement(o),b.hideElement(r),m&&(b.untruncateElement(t),b.untruncateElement(s))),b.remedyCenterAndRightOverlap(t,n,s,l,c,d,u,p),m&&b.capElementWidth(s,e,n,p)}static scaleTopRowItemsAroundContextualTabs(e,t,n,a,i,o,r,s,l,c,d,u,p,g){const h=!!s,m=!!l,_=!!c,S=!!p,f=b.getFirstContextualTabSet(e);let C=0;(C=b.overlapAmount(t,f,g))>0&&(h&&b.truncateElement(s,s,C),h&&!b.relativeLayoutAwry(s,f,g)||(b.hideElement(i),b.hideElement(o),b.hideElement(r),b.hideElement(s))),b.relativeLayoutAwry(e,n,g)&&b.repositionElement(n,e,g),b.remedyCenterAndRightOverlap(n,a,l,c,d,u,p,g),(C=b.overlapAmount(e,a,g))>0&&(b.truncateElement(d,u,C),S&&b.relativeLayoutAwry(e,a,g)&&b.hideElement(p),_&&b.relativeLayoutAwry(e,a,g)&&b.hideElement(c)),m&&!b.isHidden(n)&&b.capElementWidth(l,e,a,g)}static remedyCenterAndRightOverlap(e,t,n,a,i,o,r,s){const l=!!n,c=!!a,d=!!i,u=!!r;let p=0;if((l||d)&&(p=b.overlapAmount(e,t,s))>0){const a=!!e&&"absolute"!==e.style.position;let r=l;d&&(!l||i.offsetWidth>n.offsetWidth)&&(r=!1),b.truncateElement(r?n:i,r?n:o,r&&a?2*p:p),l&&d?((p=b.overlapAmount(e,i,s))>0&&(r=!r,b.truncateElement(r?n:i,r?n:o,r&&a?2*p:p)),b.relativeLayoutAwry(e,i,s)&&b.hideElement(e)):l&&b.relativeLayoutAwry(e,t,s)&&b.hideElement(e)}u&&b.relativeLayoutAwry(e,t,s)&&b.hideElement(r),c&&b.relativeLayoutAwry(e,t,s)&&b.hideElement(a)}static isHidden(e){if(!e)return!0;const t=e[A];return!(null==t||"0"===t)}static hideElement(e){e&&!b.isHidden(e)&&(e.style.display="none",e[A]="1")}static showElement(e){e&&b.isHidden(e)&&(e.style.display="",e[A]="0")}static untruncateElement(e){e&&(e.style.width="auto",e.style.maxWidth="none")}static moveElement(e,t){e&&(e.style.position="absolute",e.style.left=t+"px")}static resetPosition(e){e&&(e.style.position="static",e.style.left="auto")}static capElementWidth(e,t,n,a){if(e&&e.parentNode&&e.parentNode.parentNode){const i=b.peripheralOffsetWithElement(e);if("auto"!==e.parentNode.style.width){const t=e.parentNode.offsetWidth-i;e.style.width=t+"px"}const r=a?n:t,s=a?t:n,l=o.a.getElementBounds(e.parentNode.parentNode),c=r?o.a.getElementBounds(r):new Sys.UI.Bounds(l.x,0,0,0),d=s?o.a.getElementLocation(s):new Sys.UI.Point(l.x+l.width,0);let u=0;if("absolute"===e.parentNode.style.position)u=d.x-(c.x+c.width)-i-1;else{const t=o.a.getElementBounds(e.nextSibling?e.parentNode:e),n=t.x+t.width/2;u=2*Math.min(n-(c.x+c.width),d.x-n)-i-1}e.style.maxWidth=u+"px"}}static peripheralOffsetWithElement(e){const t=S.a.getCurrentStyle(e),n=t?f.a.parseCssSize(t.paddingLeft)+f.a.parseCssSize(t.paddingRight):0,a=S.a.getCurrentStyle(e.parentNode),i=a?f.a.parseCssSize(a.paddingLeft)+f.a.parseCssSize(a.paddingRight):0;let o=0,r=e;for(;r.nextSibling;)r=r.nextSibling,o+=r.offsetWidth;return n+i+o}static isElementTopRightActionButton(e){return!!e.id&&(e.id.startsWith(l.a.shareButtonId)||e.id.startsWith(C.a.replyWithChangesButtonId))}}b.ribbonHeaderScaleClasses=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"],(0,a.a)(b,"RibbonTabScalingActor",null,[]);const T="_isHidden",v=(e,t)=>{let n=0;for(;t()&&n<e.length;)e[n](),n++},w=(e,t,n,a)=>{if(e&&e.parentNode&&e.parentNode.parentNode){const i=L(e);if("auto"!==e.parentNode.style.width){const t=e.parentNode.offsetWidth-i;e.style.width=t+"px"}const r=a?n:t,s=a?t:n,l=o.a.getElementBounds(e.parentNode.parentNode),c=r?o.a.getElementBounds(r):new Sys.UI.Bounds(l.x,0,0,0),d=s?o.a.getElementLocation(s):new Sys.UI.Point(l.x+l.width,0);let u=0;if("absolute"===e.parentNode.style.position)u=d.x-(c.x+c.width)-i-1;else{const t=o.a.getElementBounds(e.nextSibling?e.parentNode:e),n=t.x+t.width/2;u=2*Math.min(n-(c.x+c.width),d.x-n)-i-1}e.style.maxWidth=u+"px"}},F=e=>{for(const t of e)I(t)},I=e=>{e&&M(e)&&(e.style.display="",e[T]="0")},E=e=>{e&&!M(e)&&(e.style.display="none",e[T]="1")},M=e=>{if(!e)return!0;const t=e[T];return!(null==t||"0"===t)},k=(e,t,n)=>{if(e&&!M(e)){let a=S.a.getCurrentStyle(e);const i=f.a.parseCssSize(a.paddingLeft)+f.a.parseCssSize(a.paddingRight);let o=e.offsetWidth-n-i,r=t,s=0;for(;r&&r!==e;)a=S.a.getCurrentStyle(r),a&&(s+=f.a.parseCssSize(a.paddingLeft)+f.a.parseCssSize(a.paddingRight)),r=r.parentNode;o=Math.max(o,75+s),e.style.width=o+"px"}},P=e=>{e&&(e.style.width="auto",e.style.maxWidth="none")},D=(e,t)=>{e&&(e.style.position="absolute",e.style.left=t+"px")},R=(e,t,n)=>!(!e||!t)&&(!M(e)&&!M(t)&&o.a.leftBoundsOverlapsRightBounds(o.a.getElementBounds(e),o.a.getElementBounds(t),n)),x=(e,t,n)=>{let a=0;return e&&t&&(a=o.a.leftBoundsOverlapsRightBoundsByAmount(o.a.getElementBounds(e),o.a.getElementBounds(t),n)),a},L=e=>{const t=S.a.getCurrentStyle(e),n=t?f.a.parseCssSize(t.paddingLeft)+f.a.parseCssSize(t.paddingRight):0,a=S.a.getCurrentStyle(e.parentNode),i=a?f.a.parseCssSize(a.paddingLeft)+f.a.parseCssSize(a.paddingRight):0;let o=0,r=e;for(;r.nextSibling;)r=r.nextSibling,o+=r.offsetWidth;return n+i+o},U=e=>!!e.id&&(e.id.startsWith(l.a.shareButtonId)||e.id.startsWith(C.a.replyWithChangesButtonId));class O{findAndScaleDefaultRibbonTopBars(){const{headerPanel:e}=_.a.tryEnsuredHeaderPanelInitialized(),t=$get(l.a.headerTopBarsId);e?(this._elmTopBar1=document.getElementById(l.a.externalHeaderFullTopBarsId),this._elmTopBar2=t):(this._elmTopBar1=t.childNodes[0],this._elmTopBar2=t.childNodes[1]),this.scaleHeader()}scaleNonCuiHeader(e){this._elmTopBar1=e,this._elmTopBar2=null,this.findTopBar1Elements(this._elmTopBar1),this.undoScaleTopBar1(),this.scaleTopBar1()}scaleHeader(){if(!this._elmTopBar1||!this._elmTopBar2||!this._elmTopBar2.clientHeight)return;this.findTopBar1Elements(this._elmTopBar1),this.undoScaleTopBar1(),this.scaleTopBar1();-1!==this._elmTopBar2.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.findTopBar2Elements(this._elmTopBar2),this.undoScaleTopBar2(),this.scaleTopBar2())}findTopBar1Elements(e){if(e)for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t],a=f.a.getDOMElementClassName(n),i=!!n.id;-1!==a.indexOf("cui-QATRowLeft")?this.elmTopBar1Left=n:-1!==a.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?this.elmBreadcrumbSeparator=n:n.id===l.a.breadcrumbBrandId?this.elmHostBrand=n:n.id===l.a.folderSeparatorId?this.elmFolderSeparator=n:n.id===l.a.breadcrumbFolderId?this.elmFolder=n:-1!==a.indexOf("cui-QATRowCenter")?this.elmTopBar1Center=n:n.id===l.a.breadcrumbTitleId?this.elmTitle=n:-1!==a.indexOf("cui-QATRowRight")?this.elmTopBar1Right=n:i&&U(n)?this.elmTopRightActionButton=n:i&&n.id.startsWith(l.a.skypeButtonPrefixId)?this.elmSkypeButton=n:-1!==a.indexOf("UsernameNameContainer")?this.elmUserNameNameContainer=n:-1!==a.indexOf("UsernameNameItem")&&(this.elmUserNameNameItem=n),this.findTopBar1Elements(n)}}undoScaleTopBar1(){const e=[this.elmBreadcrumbSeparator,this.elmHostBrand,this.elmFolderSeparator,this.elmFolder,this.elmTopBar1Center,this.elmTitle,this.elmTopBar1Right,this.elmTopRightActionButton,this.elmSkypeButton,this.elmUserNameNameContainer],t=[this.elmTopBar1Center,this.elmTitle,this.elmUserNameNameContainer];var n;F(e),(e=>{for(const t of e)P(t)})(t),(n=this.elmTopBar1Center)&&(n.style.position="static",n.style.left="auto")}scaleTopBar1(){var e,t;this.contextualTabsVisible()?this.scaleTopBar1WithContextual():this.scaleTopBar1WithoutContextual(),e=this.elmFolderSeparator,t=this.elmFolder,e&&t&&(e.style.marginTop=(t.offsetHeight-e.offsetHeight)/2+"px")}scaleTopBar1WithContextual(){let e,t;const n=this.getFirstContextualTabSet();e=()=>R(this.elmFolder,n,this._isRtl),t=[()=>{k(this.elmFolder,this.elmFolder,x(this.elmTopBar1Left,n,this._isRtl))},()=>{E(this.elmBreadcrumbSeparator),E(this.elmHostBrand),E(this.elmFolderSeparator),E(this.elmFolder)}],v(t,e),R(this.elmTabHeaders,this.elmTopBar1Center,this._isRtl)&&((e,t,n)=>{if(e&&t){let a=0,i=0;({left:a,top:i}=o.a.getElementAbsolutePosition(t,a,i));const r=n?a-e.offsetWidth:a+t.offsetWidth;D(e,r)}})(this.elmTopBar1Center,this.elmTabHeaders,this._isRtl),this.resolveTopBar1CenterAndRightOverlap(),e=()=>R(this.elmTabHeaders,this.elmTopBar1Right,this._isRtl),t=[()=>{k(this.elmUserNameNameContainer,this.elmUserNameNameItem,x(this.elmTabHeaders,this.elmTopBar1Right,this._isRtl))},()=>{E(this.elmTopRightActionButton)}],this.resolveTopBar1LeftAndRightOverlap(),M(this.elmTopBar1Center)||M(this.elmTitle)||w(this.elmTitle,this.elmTabHeaders,this.elmTopBar1Right,this._isRtl)}scaleTopBar1WithoutContextual(){const e=!!this.elmFolder,t=!!this.elmTitle;let n=0;if((e||t)&&(n=x(this.elmTopBar1Left,this.elmTopBar1Center,this._isRtl))>0){let a=e;t&&(!e||this.elmTitle.offsetWidth>this.elmFolder.offsetWidth)&&(a=!1),k(a?this.elmFolder:this.elmTitle,a?this.elmFolder:this.elmTitle,a?n:2*n),e&&t&&(n=x(this.elmTopBar1Left,this.elmTopBar1Center,this._isRtl))>0&&(a=!a,k(a?this.elmFolder:this.elmTitle,a?this.elmFolder:this.elmTitle,a?n:2*n))}v([()=>{E(this.elmBreadcrumbSeparator),E(this.elmHostBrand),E(this.elmFolderSeparator),E(this.elmFolder),P(this.elmTitle)},()=>{k(this.elmTitle,this.elmTitle,2*x(this.elmTopBar1Left,this.elmTopBar1Center,this._isRtl))},()=>{E(this.elmTitle)}],(()=>R(this.elmTopBar1Left,this.elmTopBar1Center,this._isRtl))),this.resolveTopBar1CenterAndRightOverlap(),this.resolveTopBar1LeftAndRightOverlap(),M(this.elmTopBar1Center)||M(this.elmTitle)||w(this.elmTitle,this.elmTopBar1Left,this.elmTopBar1Right,this._isRtl)}resolveTopBar1CenterAndRightOverlap(){const e=M(this.elmTitle);v([()=>{this.resolveTopBar1TitleandRightOverlap()},()=>{E(this.elmTopRightActionButton),P(this.elmTitle),P(this.elmUserNameNameContainer),e||I(this.elmTitle)},()=>{this.resolveTopBar1TitleandRightOverlap()},()=>{E(this.elmSkypeButton),P(this.elmTitle),P(this.elmUserNameNameContainer),e||I(this.elmTitle)},()=>{this.resolveTopBar1TitleandRightOverlap()}],(()=>R(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl)))}resolveTopBar1TitleandRightOverlap(){const e=!!this.elmTitle,t=!!this.elmUserNameNameContainer;let n=0;if((e||t)&&(n=x(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl))>0){const a=!!this.elmTopBar1Center&&"absolute"!==this.elmTopBar1Center.style.position;let i=e;t&&(!e||this.elmUserNameNameContainer.offsetWidth>this.elmTitle.offsetWidth)&&(i=!1),k(i?this.elmTitle:this.elmUserNameNameContainer,i?this.elmTitle:this.elmUserNameNameItem,i&&a?2*n:n),e&&t?((n=x(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl))>0&&(i=!i,k(i?this.elmTitle:this.elmUserNameNameContainer,i?this.elmTitle:this.elmUserNameNameItem,i&&a?2*n:n)),R(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl)&&(E(this.elmTopBar1Center),P(this.elmUserNameNameContainer))):e&&R(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl)&&E(this.elmTitle)}}resolveTopBar1LeftAndRightOverlap(){const e=()=>{k(this.elmUserNameNameContainer,this.elmUserNameNameItem,x(this.elmTopBar1Left,this.elmTopBar1Right,this._isRtl))};v([e,()=>{E(this.elmTopRightActionButton),P(this.elmUserNameNameContainer)},e,()=>{E(this.elmSkypeButton),P(this.elmUserNameNameContainer)},e,()=>{E(this.elmUserNameNameContainer)}],(()=>R(this.elmTopBar1Left,this.elmTopBar1Right,this._isRtl)))}contextualTabsVisible(){if(!this.elmTabHeaders)return!1;for(let e=0;e<this.elmTabHeaders.childNodes.length;e++){const t=this.elmTabHeaders.childNodes[e];if(-1!==f.a.getDOMElementClassName(t).indexOf("cui-cg"))return!0}return!1}getFirstContextualTabSet(){if(!this.elmTabHeaders)return null;let e=null;for(let t=this.elmTabHeaders.childNodes.length-1;t>=0;t--){const n=this.elmTabHeaders.childNodes[t];if(-1===f.a.getDOMElementClassName(n).indexOf("cui-cg"))break;e=n}return e}findTopBar2Elements(e){if(e)for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t],a=f.a.getDOMElementClassName(n),i=!!n.id;-1!==a.indexOf("cui-jewel-container")?this.elmFileButton=n:-1!==a.indexOf("cui-tts")?this.elmTabHeaders=n:-1!==a.indexOf("cui-TabRowInline")?this.elmTopBar2Center=n:-1!==a.indexOf("cui-separator")?this.elmOICSeparator=n:i&&n.id.startsWith(l.a.openInClientButtonId)?this.elmOpenInClientButton=n:i&&n.id.startsWith(l.a.feedbackButtonId)?this.elmFeedbackButton=n:-1!==a.indexOf("cui-TabRowRight")?this.elmTopBar2Right=n:i&&n.id.startsWith(l.a.peoplesWellControlId)&&(this.elmPeopleWellControl=n),this.findTopBar2Elements(n)}}undoScaleTopBar2(){const e=[this.elmTabHeaders,this.elmTopBar2Center,this.elmOICSeparator,this.elmOpenInClientButton,this.elmFeedbackButton,this.elmTopBar2Right,this.elmPeopleWellControl];F(e),this.setTabHeaderScaleIndex(0)}scaleTopBar2(){let e,t;t=()=>R(this.elmTabHeaders,this.elmTopBar2Center,this._isRtl),e=[()=>{E(this.elmOICSeparator),E(this.elmOpenInClientButton)},()=>{this.setTabHeaderScaleIndex(1)},()=>{this.setTabHeaderScaleIndex(2)},()=>{E(this.elmTopBar2Center),this.setTabHeaderScaleIndex(0)}],v(e,t),t=()=>R(this.elmTopBar2Center,this.elmTopBar2Right,this._isRtl)||R(this.elmTabHeaders,this.elmTopBar2Right,this._isRtl),e=[()=>{E(this.elmOICSeparator),E(this.elmOpenInClientButton)},()=>{E(this.elmFeedbackButton)},()=>{E(this.elmPeopleWellControl)},()=>{E(this.elmTopBar2Right)}],v(e,t),t=()=>R(this.elmFileButton,this.elmTabHeaders,this._isRtl),e=[()=>{this.setTabHeaderScaleIndex(1)},()=>{this.setTabHeaderScaleIndex(2)},()=>{E(this.elmTabHeaders)}],v(e,t)}setTabHeaderScaleIndex(e){this.elmTabHeaders&&(this.elmTabHeaders.className=O.tabHeaderScaleClasses[e],this.elmTabHeaders._scaleStep=e)}constructor(e,t,n){this.elmTopBar1Left=null,this.elmBreadcrumbSeparator=null,this.elmHostBrand=null,this.elmFolderSeparator=null,this.elmFolder=null,this.elmTopBar1Center=null,this.elmTitle=null,this.elmTopBar1Right=null,this.elmTopRightActionButton=null,this.elmSkypeButton=null,this.elmUserNameNameContainer=null,this.elmUserNameNameItem=null,this.elmFileButton=null,this.elmTabHeaders=null,this.elmTopBar2Center=null,this.elmOICSeparator=null,this.elmOpenInClientButton=null,this.elmFeedbackButton=null,this.elmTopBar2Right=null,this.elmPeopleWellControl=null,this._elmTopBar1=e,this._elmTopBar2=t,this._isRtl=n}}O.tabHeaderScaleClasses=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"],(0,a.a)(O,"TopBarScalingManager",null,[]);class B{adjustBreadcrumbDisplay(){const e=!!d.AFrameworkApplication.breadcrumbBrandName,t=!!d.AFrameworkApplication.breadcrumbFolderName;if(!d.AFrameworkApplication.isEmbedded&&e&&t){const e=this._breadcrumb.getBreadcrumbItem(l.a.breadcrumbFolderId),t=this._breadcrumb.getBreadcrumbItem(l.a.folderSeparatorId);e&&t&&b.adjustBreadcrumbDisplay(t,e)}}scaleHerobar(){const e=[()=>{B.trimLongestElement(this._breadcrumb,this._documentTitle,200)},()=>{B.trimBreadcrumbAndDocumentTitle(this._breadcrumb,this._documentTitle,200)},()=>{B.hideDocumentTitleAndUntruncateBreadcrumb(this._breadcrumb,this._documentTitle)},()=>{this._breadcrumb.truncateWidth(200)},(0,i.a)(this._breadcrumb,this._breadcrumb.hide,"hide")];B.showAndUntruncateAllElements(this._breadcrumb,this._documentTitle),B.invokeScalingSteps(e,(()=>B.herobarElementBoundsOverlap(this._breadcrumb,this._documentTitle,this._toolbarContainer,d.AFrameworkApplication.isRtl)))}scaleHeader(){if(this.enhancedMobileViewIsEnabled()){document.getElementById("application").style.minWidth="0px";new O(this._elmTopBar1,this._elmTopBar2,d.AFrameworkApplication.isRtl).scaleHeader()}else b.scaleHeaderUsingContainers(this._elmTopBar1,this._elmTopBar2,d.AFrameworkApplication.isRtl)}enhancedMobileViewIsEnabled(){return!!d.AFrameworkApplication.appSettingsManager&&d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnhancedMobileViewIsEnabled")}scaleViewerChrome(){this.scaleHeader(),this.adjustBreadcrumbDisplay(),this.scaleHerobar()}static showAndUntruncateAllElements(e,t){e&&e.undoScaling(),t&&t.undoScaling()}static herobarElementBoundsOverlap(e,t,n,a){return B.viewerChromeItemsOverlap(e,t,a)||B.viewerChromeItemsOverlap(t,n,a)||B.viewerChromeItemsOverlap(e,n,a)}static viewerChromeItemsOverlap(e,t,n){return!(!e||!t)&&(!(!e.isVisible||!t.isVisible)&&o.a.leftBoundsOverlapsRightBounds(e.containerBounds,t.containerBounds,n))}static trimLongestElement(e,t,n){e&&t&&(e.containerBounds.width>t.containerBounds.width?e.truncateWidth(n):t.truncateWidth(n))}static trimBreadcrumbAndDocumentTitle(e,t,n){e&&e.truncateWidth(n),t&&t.truncateWidth(n)}static hideDocumentTitleAndUntruncateBreadcrumb(e,t){t.hide(),e.undoScaling()}static invokeScalingSteps(e,t){let n=0;for(;t()&&n<e.length;)e[n](),n++}constructor(e,t,n,a,i){this._elmTopBar1=e,this._elmTopBar2=t,this._breadcrumb=n,this._documentTitle=a,this._toolbarContainer=i}}(0,a.a)(B,"ViewerChromeScalingManager",null,[]);var N=n(1196);class W{get toolbarWithTopbarHeight(){return W.calculateToolbarWithTopBarHeight(this._headerIsHidden,this._appHasExternalHeader)}get viewerChromeCssClass(){return"cui-viewerchrome"}get toolbarContainer(){return this._isExternalToolbar?this._elmTopBar2:this._toolbarContainer.elmContainer}get peripheralContentContainer(){return this._peripheralContentContainer}get toolbarContentContainer(){return this._elmTopBar2}createViewerChromeStructure(){this._elmViewerChromeContainer=c.createUnselectableElement("div"),this._elmViewerChromeContainer.className=this.viewerChromeCssClass,this.ensureTopBars(),this.ensureTopBars1And2()}ensureTopBars(){this._elmToolbarTopBars=c.createUnselectableElement("div"),this._elmToolbarTopBars.id=l.a.headerTopBarsId,this._elmToolbarTopBars.className="cui-ribbonTopBars",this._elmViewerChromeContainer.appendChild(this._elmToolbarTopBars),this.ensureHeaderDom()}ensureHeaderDom(){this._appHasExternalHeader?(this._elmHeaderContainer=c.createUnselectableElement("div"),this._elmHeaderContainer.className="cui-ribbonTopBars",this._elmHeaderContainer.id=l.a.externalHeaderViewerChromeTopBarsId,d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteLegacyHeaderRenderingDisabled")||this._appExternalHeaderPanel.appendChild(this._elmHeaderContainer),Sys.UI.DomElement.addCssClass(this._elmHeaderContainer,this.viewerChromeCssClass),Sys.UI.DomElement.addCssClass(this._elmViewerChromeContainer,"cui-exth")):this._elmHeaderContainer=this._elmToolbarTopBars}ensureTopBars1And2(){this._peripheralContentContainer=c.createUnselectableElement("div"),this.peripheralContentContainer.className="cui-topBar1";const e=d.AFrameworkApplication.appSettingsManager.appSettings;"TransitionalHeaderUIInViewEnabled"in e&&Boolean.parse(e.TransitionalHeaderUIInViewEnabled)&&d.AFrameworkApplication.activeFrame&&d.AFrameworkApplication.activeFrame.applicationInstance.isTransistionalHeaderUIEnabled&&(this.peripheralContentContainer.className+=" cui-topBar1-transistionalHeaderUI"),d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LegacyHeaderAppColorIsEnabled")&&(this.peripheralContentContainer.className+=" cui-topBar1-transistionalHeaderUI"),d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(this.peripheralContentContainer.className+=" cui-color-update"),this._headerIsHidden&&(this.peripheralContentContainer.style.display="none"),this._elmHeaderContainer.appendChild(this.peripheralContentContainer),this._elmTopBar2=c.createUnselectableElement("div"),d.AFrameworkApplication.isMobileMode||(this._elmTopBar2.className="cui-topBar2"),this._isExternalToolbar&&(this._elmTopBar2.className+=" elevated-toolbar"),d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Fluent2StyleIsEnabled")&&(this._elmTopBar2.className+=" fluent2Styling"),this._elmToolbarTopBars.appendChild(this._elmTopBar2)}populateHeader(e){this._elmTopRowLeft=document.getElementById(e+"-QATRowLeft"),this._elmTopRowCenter=document.getElementById(e+"-QATRowCenter"),this._elmTopRowRight=document.getElementById(e+"-QATRowRight"),this._elmTopRowLeft&&(this._elmTopRowLeft.parentNode.removeChild(this._elmTopRowLeft),this.peripheralContentContainer.appendChild(this._elmTopRowLeft),this._elmTopRowLeft.style.display="inline-block",W.setUnselectable(this._elmTopRowLeft)),this._elmTopRowCenter&&(this._elmTopRowCenter.parentNode.removeChild(this._elmTopRowCenter),this.peripheralContentContainer.appendChild(this._elmTopRowCenter),this._elmTopRowCenter.style.display="inline-block",W.setUnselectable(this._elmTopRowCenter)),this._elmTopRowRight&&(this._elmTopRowRight.parentNode.removeChild(this._elmTopRowRight),this.peripheralContentContainer.appendChild(this._elmTopRowRight),this._elmTopRowRight.style.display="inline-block",W.setUnselectable(this._elmTopRowRight))}populateHerobarContainers(){this._hideTitleAndBreadcrumbs||(d.AFrameworkApplication.isMobileMode||d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HideBreadCrumbinRibbonforUIHost")||(this._breadcrumbContainer=new p,this._elmTopBar2.appendChild(this._breadcrumbContainer.elmContainer)),d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HideTitleinRibbonforUIHost")||(this._documentTitleContainer=new h,this._elmTopBar2.appendChild(this._documentTitleContainer.elmContainer))),this._toolbarContainer=new m,this._elmTopBar2.appendChild(this._toolbarContainer.elmContainer)}scale(){d.AFrameworkApplication.isMobileMode||this._hideTitleAndBreadcrumbs||d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HideBreadCrumbinRibbonforUIHost")&&d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HideTitleinRibbonforUIHost")||this.viewerChromeScalingManager&&this.viewerChromeScalingManager.scaleViewerChrome()}dispose(){this._documentTitleContainer&&(this._documentTitleContainer.dispose(),this._documentTitleContainer=null),this._breadcrumbContainer&&(this._breadcrumbContainer.dispose(),this._breadcrumbContainer=null),this._elmToolbarTopBars=null,this._peripheralContentContainer=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._resizableContainer&&(this._resizableContainer.remove_onResize((0,i.a)(this,this.scale,"scale")),this._resizableContainer=null),this._appExternalHeaderPanel&&f.a.clearElementHtml(this._appExternalHeaderPanel)}static calculateToolbarWithTopBarHeight(e,t){return 40+(e||t?0:48)}static setUnselectable(e){e.setAttribute("unselectable","on")}constructor(e,t,n,a=!1,o=!1,r=!1){this._elmViewerChromeContainer=null,this._elmToolbarTopBars=null,this._elmHeaderContainer=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._breadcrumbContainer=null,this._documentTitleContainer=null,this._toolbarContainer=null,this.viewerChromeScalingManager=null,this._resizableContainer=null,this._appExternalHeaderPanel=null,this._peripheralContentContainer=null,this._appHasExternalHeader=({headerPanel:this._appExternalHeaderPanel}=_.a.tryEnsuredHeaderPanelInitialized(!a)).returnValue,this._headerIsHidden=a,this._hideTitleAndBreadcrumbs=o,this._isExternalToolbar=r,this.createViewerChromeStructure(),e.appendChild(this._elmViewerChromeContainer),this._headerIsHidden||this.populateHeader(t),this._isExternalToolbar||(this.populateHerobarContainers(),this.viewerChromeScalingManager=new B(this.peripheralContentContainer,this._elmTopBar2,this._breadcrumbContainer,this._documentTitleContainer,this._toolbarContainer),this._resizableContainer=n||new N.a,this._resizableContainer.add_onResize((0,i.a)(this,this.scale,"scale")),this.scale())}}(0,a.a)(W,"ViewerChrome",null,[11,20])},3647:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.O365Shell.O365ShellActor")},7260:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.OAuth.IWacTokenValidator")},2113:function(e,t,n){"use strict";n.d(t,{a:function(){return J}});var a=n(100),i=n(5149);var o,r=n(2813);!function(e){e[e.external=0]="external",e[e.msa=1]="msa",e[e.aad=2]="aad",e[e.common=3]="common"}(o||(o={})),(0,a.b)("AuthorityType",o);var s=n(8829);class l{initialize(){return Promise.resolve(0)}loadAuthContext(e){return Promise.resolve(0)}tryGetToken(e,t,n,a,o,r,l,c){return i.ULS.sendTraceTag(574239257,3e3,50,"Automation flag set.  Returning Mock Token."),Promise.resolve(Object.assign(new s.a,{IsSuccess:!0,Token:this._mockToken}))}tryLogin(e,t,n,a,i,o,r){return Promise.resolve(Object.assign(new s.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}hideLoginUI(){}supportsTryLogin(){return!1}getStrategyName(){return"MockAuthTokenStrategy"}constructor(e){this._mockToken=e}}(0,a.a)(l,"MockAuthTokenStrategy",null,[545]);class c{}(0,a.a)(c,"AuthContext",null,[]);var d=n(3245),u=n(9505);class p{static getAuthContext(){const e=d.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName")||"";let t=e;return t=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnoreLoginHintForAnonymousUser",!1)&&d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser")?"":u.a.oAuthLoginHint||e,Object.assign(new c,{upn:e,loginHint:t,authority:u.a.authority,authorityType:p.getAuthorityType(),tenantId:d.AFrameworkApplication.appSettingsManager.getStringAppSetting("TenantId")||"",trustedBrokerDomains:[d.AFrameworkApplication.postMessageOrigin]})}static getAuthorityType(){let e=0;const t=p.getAuthorityTypeAsString();return"aad"===t.toLowerCase()?e=2:"msa"===t.toLowerCase()?e=1:"common"===t.toLowerCase()&&(e=3),e}static getAuthorityTypeAsString(){let e=d.AFrameworkApplication.appSettingsManager.getStringAppSetting("HostAuthType")||"";return"OpenFromUrl"===d.AFrameworkApplication.appSettingsManager.getStringAppSetting("FileSource")&&(e="common"),e}}(0,a.a)(p,"OAuthIdentity",null,[]);class g{static get(e,t,n){if(!n)return e;let a=0;return Promise.race([e,new Promise(((e,o)=>{a=window.setTimeout((()=>{i.ULS.sendTraceTag(506478665,3e3,15,"PromiseWithTimeout Failed Due to Timeout {0}: {1}",n,t.resultName),e(t.value)}),n)}))]).then((e=>(window.clearTimeout(a),Promise.resolve(e)))).catch((e=>(window.clearTimeout(a),i.ULS.sendTraceTag(506478664,3e3,15,"PromiseWithTimeout Failed Due to Error: {0}",t.resultName),Promise.resolve(t.value))))}}(0,a.a)(g,"PromiseWithTimeout",null,[]);var h=n(3792);class m{constructor(e,t,n,a,i){this.resource=null,this.scope=null,this.silentLogin=!1,this.options=null,this.correlationId=null,this.resource=e,this.scope=t,this.silentLogin=n,this.options=a,this.correlationId=i}}(0,a.a)(m,"TokenRequestParameters",null,[563]);var _=n(1163);const S=(0,h.b)("Common.App.WopiIdentity.WopiIdentityManager");class f{initialize(){return new Promise((e=>{(0,h.h)(S).execute((t=>{this._wopiIdentityManager=t,e(0)}))}))}getScope(e){const t=["HTTPS:","API:"];let n=!1;const a=e.toLocaleUpperCase();for(const e of t)if(a.startsWith(e)){n=!0;break}return n||this.isGuid(e)?e+"/.default":e}isGuid(e){return new RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(e)}loadAuthContext(e){return Promise.resolve(0)}tryGetToken(e,t,n,a,i,o,r,l){if(_.a.isTeamsElectron){const t=u.a.wacFrameTeamsElectronSSO;if(!t){const e=Object.assign(new s.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."});return Promise.resolve(e)}if(!Array.contains(t,e)){const t=Object.assign(new s.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+e});return Promise.resolve(t)}}const c=this.getScope(n),p=new m(n,c,!a,null,d.AFrameworkApplication.userSessionId);return this._wopiIdentityManager.getAccessToken(p,t,r).then((e=>Object.assign(new s.a,{IsSuccess:!0,Token:e.accessToken})),(e=>Object.assign(new s.a,{IsSuccess:!1,ErrorCode:e})))}tryLogin(e,t,n,a,i,o,r){return Promise.resolve(Object.assign(new s.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}hideLoginUI(){}supportsTryLogin(){return!1}getStrategyName(){return this._strategyName}constructor(){this._wopiIdentityManager=null;const e="Unspecified";let t=d.AFrameworkApplication.appSettingsManager.getStringAppSetting(d.AFrameworkApplication.uiHostSettingName),n=d.AFrameworkApplication.appSettingsManager.getStringAppSetting(d.AFrameworkApplication.uiHostIntegrationTypeSettingName);t=t&&""!==t?t:e,n=n&&""!==n?n:e,this._strategyName=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",t,n)}}var C;(0,a.a)(f,"ParentFrameTokenStrategy",null,[545]),function(e){e[e.default=0]="default",e[e.eventDriven=1]="eventDriven",e[e.pairwise=2]="pairwise",e[e.nestedApp=3]="nestedApp"}(C||(C={}));var y=n(1212),A=n(8103),b=n(8779),T=n(5467),v=n(8216),w=n(6534),F=n(7442),I=n(7958),E=n(1509),M=n(9267),k=n(7646),P=n(1520);class D{constructor(){this.resolve=null,this.reject=null,this.startTime=0,this.basePromise=null,this.promiseFactory=null}}(0,a.a)(D,"PromiseWrapper",null,[]);class R{enqueue(e){return new Promise(((t,n)=>{this._queue.add(Object.assign(new D,{promiseFactory:e,resolve:t,reject:n})),this.process()}))}process(){if(this._pendingPromise||this._currentIndex===this._queue.count)return!1;const e=this._queue.get_item(this._currentIndex++);try{this._pendingPromise=!0,e.promiseFactory().then((t=>{this._pendingPromise=!1,this.completeCurrentPromiseWithTimeout(e,t,null,!0)})).catch((t=>{this._pendingPromise=!1,this.completeCurrentPromiseWithTimeout(e,null,t,!1)}))}catch(t){this._pendingPromise=!1,this.completeCurrentPromiseWithTimeout(e,null,t,!1)}return!0}completeCurrentPromiseWithTimeout(e,t,n,a){if(a){const n=()=>{e.resolve(t),this.process()};this._timeout>0?window.setTimeout((()=>{n()}),this._timeout):n()}else{const t=()=>{e.reject(n),this.process()};this._timeout>0?window.setTimeout((()=>{t()}),this._timeout):t()}}constructor(e=0){this._currentIndex=0,this._pendingPromise=!1,this._queue=new P.a,this._timeout=e}}(0,a.a)(R,"PromiseQueue",null,[]);class x{constructor(){this.resolve=null,this.correlationId=null}}(0,a.a)(x,"ResolveWithCorrelation",null,[]);var L=n(9011);class U{getStrategyName(){return this._strategyName}get baseStrategyName(){return"SharedAuthTokenStrategy"}initialize(e=!1){if(i.ULS.sendTraceTag(506319826,3e3,50,`${this._baseStrategyName} Intialize. ReInit? [{0}].`,e),e&&this._sharedAuthFrame&&(document.body.removeChild(this._sharedAuthFrame),this._promiseCollection={}),!this._sharedFrameOrigin)return T.Health.instance.recordKpiFailure("OAuthManager","SharedAuthFrameOriginNotSet",!1,!1,null),i.ULS.sendTraceTag(562381581,3e3,10,`${this._baseStrategyName} Init failed: No Shared Frame Origin Path`),Promise.reject(1);const t=this.storePromiseWrapper("loadFrame");this._iFrameStartTime=I.a.getTickCount();const n=this.generateSharedAuthFrameSource(!1);this._sharedAuthFrame=document.createElement("iframe"),this.initializeEventHandlers(this._sharedAuthFrame),this._sharedAuthFrame.style.cssText="height:0;width:0;display:none;",this._sharedAuthFrame.id="SharedAuthFrame",this._sharedAuthFrame.setAttribute("name","SharedAuthFrame"),this._sharedAuthFrame.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups"),this._sharedAuthFrame.src=n,document.body.appendChild(this._sharedAuthFrame);const a=I.a.getTickCount()-this._iFrameStartTime;return i.ULS.sendTraceTag(573112899,3e3,50,`${this._baseStrategyName} Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}.`,a,this._sharedAuthFrame.src),t}generateSharedAuthFrameSource(e=!1){let t=`${this._sharedFrameOrigin}${this._sharedFrameFilePath}?replyUrl=${window.location.protocol}//${window.location.host}&usid=${d.AFrameworkApplication.userSessionId}&WacUserType=${d.AFrameworkApplication.userType}&sv=${this._sharedAuthVersion}`;return t+="&msalv3=1",e&&(t+="&interactive=1"),t}loadAuthContext(e){if(this._authContext=e,this._bundlePostMessageFlight)return Promise.resolve(0);const t=new b.a(y.a.init);t.Values=this.authContextToDictionary(e);const n=this.storePromiseWrapper("initFrame");return this.shouldWaitForPairwiseBrokerInitMessageFromParentFrame_RemoveDuringPairwiseBrokerStrategyFlightCleanup()?this.waitForPairwiseBrokerInitMessageFromParentFrameWithTimeout_RemoveDuringPairwiseBrokerStrategyFlightCleanup(t,this._sharedAuthFrame.contentWindow):this._crossDocumentMessenger.sendToWindow(t,this._sharedAuthFrame.contentWindow,this._sharedFrameOrigin),i.ULS.sendTraceTag(573112900,3e3,50,`${this._baseStrategyName} Init: Called package initialize.`),n}tryGetToken(e,t,n,a,o,r,s,l){const c=this.getRequestKey(),d=this.storePromiseWrapper(c);if(this._bundlePostMessageFlight&&!a){const i=new b.a(y.a.initAndGetToken),s=this.authContextToDictionary(this._authContext,!1),d=this.tryGetTokenRequestToMessageValues(e,t,n,a,o,r.message,c,l),u={};u.initParams=s,u.getTokenParams=d,i.Values=u,this.shouldWaitForPairwiseBrokerInitMessageFromParentFrame_RemoveDuringPairwiseBrokerStrategyFlightCleanup()?this.waitForPairwiseBrokerInitMessageFromParentFrameWithTimeout_RemoveDuringPairwiseBrokerStrategyFlightCleanup(i,this._sharedAuthFrame.contentWindow):this._crossDocumentMessenger.sendToWindow(i,this._sharedAuthFrame.contentWindow,this._sharedFrameOrigin)}else{const s=new b.a(y.a.tryGetToken);s.Values=this.tryGetTokenRequestToMessageValues(e,t,n,a,o,r.message,c,l),a?this._interactiveFlowRequestQueue.enqueue((()=>new Promise((e=>{this.tryGetTokenInteractive(r,s,e,c)})))):(this._crossDocumentMessenger.sendToWindow(s,this._sharedAuthFrame.contentWindow,this._sharedFrameOrigin),i.ULS.sendTraceTag(573112901,3e3,50,`${this._baseStrategyName} TryGetToken: Called TryGetToken for app {0}`,t))}return d}tryGetTokenInteractive(e,t,n,a){const o=this._promiseCollection[a];if(o){this._tryGetTokenInteractiveRequest=t,this._interactiveFlowResolve=Object.assign(new x,{resolve:n,correlationId:a});!1?(async()=>{try{this._sharedAuthConsentDialog=await(0,F.a)(15,this.generateSharedAuthFrameSource(!0),this._sharedFrameOrigin,e,this._crossDocumentMessenger,o,n),this._sharedAuthConsentDialog.showAndFocus()}catch(e){i.ULS.sendTraceTag(505718421,3e3,10,e)}})():(this._sharedAuthConsentDialog=new L.SharedAuthConsentDialog(this.generateSharedAuthFrameSource(!0),this._sharedFrameOrigin,e,this._crossDocumentMessenger,o,n),this._sharedAuthConsentDialog.showAndFocus())}}getRequestKey(){return E.a.create().toString()}tryGetTokenRequestToMessageValues(e,t,n,a,i,o,r,s){const l={};return l.appName=e,l.appId=t,l.target=n,l.withPopup=a,l.claims=i,l.promptMessage=o,l.forceRefresh=s??!1,l.messageCorrelationId=r,l}initializeEventHandlers(e){$addHandler(e,"load",this.onIFrameLoaded),$addHandler(e,"error",this.onIFrameError),this._crossDocumentMessenger.addAllowedOrigin(this._sharedFrameOrigin),this._crossDocumentMessenger.addAllowedReceivingMessage(y.b.scriptLoaded),this._crossDocumentMessenger.registerCallback(y.b.scriptLoaded,this.onScriptLoaded),this._crossDocumentMessenger.addAllowedReceivingMessage(y.b.scriptInitialized),this._crossDocumentMessenger.registerCallback(y.b.scriptInitialized,this.onScriptInitialized),this._crossDocumentMessenger.addAllowedReceivingMessage(y.b.getTokenResponse),this._crossDocumentMessenger.registerCallback(y.b.getTokenResponse,this.onGetTokenResponse),this._crossDocumentMessenger.addAllowedReceivingMessage(y.b.loginResponse),this._crossDocumentMessenger.registerCallback(y.b.loginResponse,this.onLoginResponse),this._crossDocumentMessenger.addAllowedReceivingMessage(y.b.interactiveFlowReady),this.registerInteractiveFlowReadyHandler(),this._crossDocumentMessenger.addAllowedReceivingMessage(y.b.hideDialog),this._crossDocumentMessenger.registerCallback(y.b.hideDialog,this.onHideDialog),this._crossDocumentMessenger.addAllowedReceivingMessage(y.b.closeDialog),this.registerCloseUxHandler(),this._crossDocumentMessenger.addAllowedReceivingMessage(y.b.signInExecute),this.registerSignInExecuteHandler(),this._sharedAuthSettingsEnabled&&(this._crossDocumentMessenger.addAllowedReceivingMessage(y.b.getSharedSettings),this._crossDocumentMessenger.registerCallback(y.b.getSharedSettings,this.onGetSharedSettings))}storePromiseWrapper(e){const t=new D;t.startTime=I.a.getTickCount();const n=new Promise(((e,n)=>{t.resolve=e,t.reject=n}));return t.basePromise=n,this._promiseCollection[e]=t,n}isDialogStylesRetrieved(){return this._sharedAuthConsentDialog.dialogStylesRetrieved}sendInitRequest(){if(this._authContext&&this._sharedAuthConsentDialog){const e=new b.a(y.a.init);e.Values=this.authContextToDictionary(this._authContext,!0),this.shouldWaitForPairwiseBrokerInitMessageFromParentFrame_RemoveDuringPairwiseBrokerStrategyFlightCleanup()?this.waitForPairwiseBrokerInitMessageFromParentFrameWithTimeout_RemoveDuringPairwiseBrokerStrategyFlightCleanup(e,this._sharedAuthConsentDialog.sharedAuthFrame.contentWindow):this._crossDocumentMessenger.sendToWindow(e,this._sharedAuthConsentDialog.sharedAuthFrame.contentWindow,this._sharedFrameOrigin)}}tryToShowSignInButton(e,t){return!(!t||!this._sharedAuthConsentDialog)&&(this._sharedAuthConsentDialog.dialogStylesPromise.then((t=>{this._crossDocumentMessenger.sendToWindow(this._tryGetTokenInteractiveRequest,this._sharedAuthConsentDialog.sharedAuthFrame.contentWindow,this._sharedFrameOrigin),this._sharedAuthConsentDialog.showSignInCancelButtons(e,t),this._sharedAuthConsentDialog.updateProps(!0,!0),this._tryGetTokenInteractiveRequest=null})),!0)}authContextToDictionary(e,t=!1){const n={appIds:["243c63a3-247d-41c5-9d83-7788c43f1c43"]};return n.upn=e.loginHint,n.authority=e.authority,n.authorityType=o[e.authorityType],n.tenantId=e.tenantId,n.correlationId=d.AFrameworkApplication.userSessionId,n.enableConsoleLogging=this._enableConsoleLogging,n.enableUpnCheck=this._enableUpnCheck,n.interactive=t,this._sharedFrameRedirectPath&&(n.redirectUri=this._sharedFrameRedirectPath),n.trustedBrokerDomains=e.trustedBrokerDomains,n}tryLogin(e,t,n,a,o,r,s){const l=new b.a(y.a.tryLogin),c=this.getRequestKey();l.Values=this.tryGetTokenRequestToMessageValues(e,t,n,a,o,r.message,c),this._tryLoginMessage=l;const d=this.storePromiseWrapper(c);return i.ULS.sendTraceTag(555049437,3e3,20,`${this._baseStrategyName} TryLogin: Called TryLogin for app {0}`,t),this.showBusinessBarForLogin(c),d}supportsTryLogin(){return!0}hideLoginUI(){this._loginBusinessBar&&d.AFrameworkApplication.activeFrame.businessBar?.removeEntry(this._loginBusinessBar)}showBusinessBarForLogin(e){if(this._loginBusinessBar)return;this._loginBusinessBar=new M.a((0,A.a)("WAC_OAuth_CompleteSignIn_Title"),(0,A.a)("WAC_OAuth_CompleteSignIn_Body"),null),this._loginBusinessBar.id=16,this._loginBusinessBar.isMultiLine=!1,this._loginBusinessBar.barType=0,this._loginBusinessBar.closeable=!0;let t=!1;this._loginBusinessBar.closeHandler=()=>{if(!t){const t=this._promiseCollection[e];if(t){const e=new s.a;e.ErrorCode="UserCancelled",e.ErrorMessage="The interactive flow was cancelled by the user",t.reject(e)}}},this._loginBusinessBar.addButton((0,A.a)("WAC_OAuth_CompleteSignIn_Button"),(()=>{i.ULS.sendTraceTag(527827290,3e3,50,`${this._baseStrategyName} TryLogin: User Clicked Login`),t=!0,this._crossDocumentMessenger.sendToWindow(this._tryLoginMessage,this._sharedAuthFrame.contentWindow,this._sharedFrameOrigin),this._loginBusinessBar=void 0}),(0,A.a)("WAC_OAuth_CompleteSignIn_Button"),!0);if(d.AFrameworkApplication.activeFrame.applicationInstance.addEntryToBusinessBar(this._loginBusinessBar,!0));else{i.ULS.sendTraceTag(555049438,3e3,10,"Failed to add entry to business bar. Login message could not be shown to user."),this._loginBusinessBar=void 0;const t=this._promiseCollection[e];if(t){const e=new s.a;e.ErrorCode="Cookies Disabled",e.ErrorMessage="Interaction Required - Current App Context does not support Business Bar",t.reject(e)}}}tryResolveInteractiveFlowPromise(e){this._interactiveFlowResolve&&this._interactiveFlowResolve.correlationId===e&&(this._interactiveFlowResolve.resolve(null),this._interactiveFlowResolve=null)}registerInteractiveFlowReadyHandler(){this._crossDocumentMessenger.registerCallback(y.b.interactiveFlowReady,this.onInteractiveFlowReady)}registerCloseUxHandler(){this._crossDocumentMessenger.registerCallback(y.b.closeDialog,this.onCloseDialog)}registerSignInExecuteHandler(){this._crossDocumentMessenger.registerCallback(y.b.signInExecute,this.onSignInExecute)}shouldWaitForPairwiseBrokerInitMessageFromParentFrame_RemoveDuringPairwiseBrokerStrategyFlightCleanup(){if(this._wacPairwiseBrokerEnabled&&this._waitForPairwiseBrokerInitMessageFromParentFrame&&this._sharedAuthVersion===C.pairwise){return"sharepointcom"===d.AFrameworkApplication.appSettingsManager.getStringAppSetting(d.AFrameworkApplication.uiHostSettingName)}return!1}async waitForPairwiseBrokerInitMessageFromParentFrameWithTimeout_RemoveDuringPairwiseBrokerStrategyFlightCleanup(e,t){const n=this.getPairwiseBrokerInitMessageFromParentFramePromise_RemoveDuringPairwiseBrokerStrategyFlightCleanup(),a=g.get(n,{resultName:"PairwiseBrokerInitMessage",value:!0},this._wacPairwiseBrokerHostInitializationTimeout),o=this._wacPairwiseBrokerHostInitializationTimeoutEnabled?a:n;try{await o&&i.ULS.sendTraceTag(505999954,3e3,50,`${this._baseStrategyName} Init: Timed out waiting for Host_MsalComplete message from parent frame, attempting to initialize anyway.`)}catch(e){i.ULS.sendTraceTag(505999953,3e3,10,`${this._baseStrategyName} Init: Caught error ${e} waiting for for Host_MsalComplete message from parent frame, attempting to initialize anyway.`)}finally{this._crossDocumentMessenger.sendToWindow(e,t,this._sharedFrameOrigin)}}async getPairwiseBrokerInitMessageFromParentFramePromise_RemoveDuringPairwiseBrokerStrategyFlightCleanup(){let e;try{const{complete:t,error:n}=await d.AFrameworkApplication.pairwiseBrokerHostCompleteListener;t&&!n||(e=n||new Error("PairwiseBrokerHostCompleteListener not complete"),i.ULS.sendTraceTag(505999952,3e3,10,`${this._baseStrategyName} Init: Error waiting for PairwiseBrokerHostCompleteListener: {0}`,n))}catch(t){e=t,i.ULS.sendTraceTag(505999951,3e3,10,`${this._baseStrategyName} Init: Caught error waiting for PairwiseBrokerHostCompleteListener: {0}`,t)}finally{if(e)throw e}return!1}isNotSafariOrIsPairwiseBrokerEnabledInSafari_RemoveDuringPairwiseBrokerStrategyFlightCleanup(){return!_.a.isSafari||this._wacPairwiseBrokerForSafariEnabled}getSharedSettingsMessage(){const e=new b.a(y.a.setSharedSettings);return e.Values={treatmentFlights:this.getFilteredSettings(d.AFrameworkApplication.appSettingsManager&&d.AFrameworkApplication.appSettingsManager.flightingTreatmentVariables),disabledChangeGates:this.getFilteredSettings(d.AFrameworkApplication.appSettingsManager&&d.AFrameworkApplication.appSettingsManager.disabledChangeGates)},e}getFilteredSettings(e){return e?Object.fromEntries(Object.entries(e).filter((e=>e[0].startsWith("Microsoft.Office.SharedOnline.")))):{}}addVisibilityTelemetryToResult(e,t){if(this._sharedAuthVisibilityEnabled){const n=e.Values.isVisible??"visible"===document.visibilityState,a=e.Values.visibilityChangeCount??-1,i=t.Telemetry||{};i.isVisible=n,i.visibilityChangeCount=a,t.Telemetry=i}}constructor(){this._sharedAuthFrame=null,this._iFrameStartTime=0,this._tryLoginMessage=null,this._sharedAuthConsentDialog=null,this._interactiveFlowResolve=null,this._authContext=null,this._tryGetTokenInteractiveRequest=null,this._loginBusinessBar=null,this._sharedAuthVersion=C.default,this.onIFrameLoaded=e=>{const t=I.a.getTickCount()-this._iFrameStartTime;i.ULS.sendTraceTag(572346566,3e3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",t)},this.onIFrameError=e=>{const t=I.a.getTickCount(),n=t-this._iFrameStartTime,a=v.a.createExtendedPropertiesMap();if(null!=a){a.set("StartTime",this._iFrameStartTime.toString()),a.set("EndTime",t.toString());const e=Object.assign({},{durationMs:n,extendedProperties:a});T.Health.instance.recordKpiFailure("OAuthManager","SharedAuthWACOAuthAspxFrameError",!1,!0,e)}i.ULS.sendTraceTag(572346567,3e3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",n,this._enableConsoleLogging?JSON.stringify(e):"")},this.onScriptLoaded=e=>{const t=this._promiseCollection.loadFrame;if(!t)return void i.ULS.sendTraceTag(506291911,3e3,50,`${this._baseStrategyName} OnScriptLoaded called after abandoned promise`);const n=I.a.getTickCount(),a=n-t.startTime,o=e.Values.AuthLibrary.toString(),r=e.Values.Success.toString();i.ULS.sendTraceTag(573112902,3e3,50,`${this._baseStrategyName} OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]`,r,o,a),o&&(this._strategyName=this._baseStrategyName+" "+o);const s=Boolean.parse(r);if(!s){const e=v.a.createExtendedPropertiesMap();if(null!=e){e.set("StartTime",t.startTime.toString()),e.set("EndTime",n.toString()),e.set("AuthLibrary",this.getStrategyName());const i=Object.assign({},{durationMs:a,extendedProperties:e});T.Health.instance.recordKpiFailure("OAuthManager","SharedAuthStrategyInitFailed",!1,!0,i)}}t.resolve(s?0:1)},this.onScriptInitialized=e=>{if(e.Values.interactive&&this._tryGetTokenInteractiveRequest&&this._tryGetTokenInteractiveRequest.Values.messageCorrelationId){const t=e.Values.interactive,n=this._tryGetTokenInteractiveRequest.Values.messageCorrelationId.toString();if(this.tryToShowSignInButton(n,t))return}const t=this._promiseCollection.initFrame;if(!t)return void i.ULS.sendTraceTag(506291910,3e3,50,`${this._baseStrategyName} OnScriptInitialized called after abandoned promise`);const n=I.a.getTickCount()-t.startTime;i.ULS.sendTraceTag(573112903,3e3,50,`${this._baseStrategyName} OnScriptInitialized. E/T: [{0}]`,n),t.resolve(0)},this.onGetTokenResponse=e=>{if(!e.Values.messageCorrelationId||!e.Values.messageCorrelationId.toString())return void i.ULS.sendTraceTag(573112904,3e3,10,`${this._baseStrategyName} OnGetTokenResponse called without valid messageCorrelationId`);const t=e.Values.messageCorrelationId.toString(),n=this._promiseCollection[t];if(!n)return void i.ULS.sendTraceTag(573112905,3e3,10,`${this._baseStrategyName} OnGetTokenResponse called with an unregistered messageCorrelationId`);const a=I.a.getTickCount()-n.startTime;i.ULS.sendTraceTag(573112906,3e3,50,`${this._baseStrategyName} OnGetTokenResponse. E/T: [{0}]`,a);const o=!!e.Values.isSuccess&&e.Values.isSuccess,r=e.Values.response;this.addVisibilityTelemetryToResult(e,r),o?n.resolve(r):n.reject(r),this.tryResolveInteractiveFlowPromise(t)},this.onInteractiveFlowReady=e=>{this.isDialogStylesRetrieved()?this._sharedAuthConsentDialog.forceShowError():this.sendInitRequest()},this.onHideDialog=e=>{this._sharedAuthConsentDialog&&this._sharedAuthConsentDialog.hidePreservingMessageBoxElement()},this.onGetSharedSettings=e=>{this._crossDocumentMessenger.sendToWindow(this.getSharedSettingsMessage(),this._sharedAuthFrame.contentWindow,this._sharedFrameOrigin)},this.onCloseDialog=e=>{if(e.Values.cancelled&&e.Values.cancelled&&e.Values.messageCorrelationId){const t=e.Values.messageCorrelationId.toString(),n=this._promiseCollection[t];if(n){const e=new s.a;e.ErrorCode="UserCancelled",e.ErrorMessage="The interactive flow was cancelled by the user",n.reject(e)}this.tryResolveInteractiveFlowPromise(t)}this._sharedAuthConsentDialog&&this._sharedAuthConsentDialog.hide()},this.onSignInExecute=e=>{w.b("SignInExecute"),i.ULS.sendTraceTag(506299086,3e3,d.AFrameworkApplication.isUnauthEdit?20:50,"onSignInExecute")},this.onLoginResponse=e=>{if(!e.Values.messageCorrelationId||!e.Values.messageCorrelationId.toString())return void i.ULS.sendTraceTag(555049439,3e3,10,`${this._baseStrategyName} OnLoginResponse called without valid messageCorrelationId`);const t=this._promiseCollection[e.Values.messageCorrelationId.toString()];if(!t)return void i.ULS.sendTraceTag(555049440,3e3,10,`${this._baseStrategyName} OnLoginResponse called with an unregistered messageCorrelationId`);const n=I.a.getTickCount()-t.startTime;i.ULS.sendTraceTag(555049441,3e3,50,`${this._baseStrategyName} OnLoginResponse. E/T: [{0}]`,n);const a=!!e.Values.isSuccess&&e.Values.isSuccess,o=e.Values.response;this.addVisibilityTelemetryToResult(e,o),a?t.resolve(o):t.reject(o)},this._crossDocumentMessenger=new k.a(null,null),this._baseStrategyName=this.baseStrategyName,this._strategyName=this._baseStrategyName+" Unloaded",this._sharedFrameOrigin=u.a.sharedAuthOrigin,this._sharedFrameFilePath=u.a.sharedAuthFilePath,u.a.sharedAuthRedirectPath&&""!==u.a.sharedAuthRedirectPath&&(this._sharedFrameRedirectPath=this._sharedFrameOrigin+u.a.sharedAuthRedirectPath),this._enableConsoleLogging=u.a.enableConsoleLogging,this._bundlePostMessageFlight=d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.BundleSharedAuthPostMessages"),this._sharedAuthVersion=d.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.SharedAuthVersionRollout",C.default),this._enableUpnCheck=d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.EnableStrictUpnChecking"),this._wacPairwiseBrokerForSafariEnabled=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PairwiseBrokerForSafariEnabled",!1),this._waitForPairwiseBrokerInitMessageFromParentFrame=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WaitForPairwiseBrokerInitMessageFromParentFrame",!1),this._wacPairwiseBrokerEnabled=(d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacPairwiseBrokerEnabled",!1)||d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacPairwiseBrokerEnabledForZoom",!1)&&"69769f4e-b8a8-4413-939d-c728ca6da386"===d.AFrameworkApplication.appSettingsManager.getStringAppSetting("TenantId"))&&this.isNotSafariOrIsPairwiseBrokerEnabledInSafari_RemoveDuringPairwiseBrokerStrategyFlightCleanup(),this._wacPairwiseBrokerHostInitializationTimeoutEnabled=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PairwiseBrokerInitializationTimeoutEnabled",!0),this._wacPairwiseBrokerHostInitializationTimeout=d.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.PairwiseBrokerHostInitializationTimeout",5e3),this._sharedAuthSettingsEnabled=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthSettingsEnabled",!1),this._sharedAuthVisibilityEnabled=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthVisibilityTelemetry",!1),this._promiseCollection={},this._interactiveFlowRequestQueue=new R(1500),d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9544703_PairwiseBrokerEnabled")&&u.a.hostPageSupportsPairwiseBroker&&this.isNotSafariOrIsPairwiseBrokerEnabledInSafari_RemoveDuringPairwiseBrokerStrategyFlightCleanup()&&(this._sharedAuthVersion=C.pairwise)}}(0,a.a)(U,"SharedAuthTokenStrategy",null,[545]);var O=n(6166);class B extends O.a{constructor(e,t,n,a,i,o,r,s){super("PromoteSignInCallout"),this.title=null,this.titleId=null,this.content=null,this.imageProps=null,this.title=e,this.content=t,this.imageProps=n,this.sharedAuthFrameLoadStatus=a,this.getIframe=i,this.onCloseButtonExecute=o,this.cancelTryGetTokenPromise=r,this.resolveThemePromise=s}}(0,a.a)(B,"PromoteSignInContentProps",O.a,[]);var N=n(9557),W=n(1307);const H="SharedAuthInteractiveFrame";class V{get sharedAuthFrame(){return this._sharedAuthFrame}showPromoteSignInUX(){this._sharedAuthFrameLoadStatus="loading",W.a.getNotificationsAPIAsync().then((e=>{this._notificationID=null;const t=this.setUpPromoteSignInContentProps(this._promptInfo),n=this.setUpCalloutParameters(t,this._promptInfo),a=e.callout(n);return this._notificationID=e.addNotification(a),this._notificationID}),(e=>null))}sharedAuthFrameLoadedSuccessfully(e,t){"unset"!==this._sharedAuthFrameLoadStatus&&(this._sharedAuthFrameLoadStatus="success",this.sendRequestToShowSignInCancelButtons(e,t))}sendRequestToShowSignInCancelButtons(e,t){const n=new b.a(y.a.showSignInCancelButtons),a={signInLabel:(0,A.a)("SignIn"),cancelLabel:(0,A.a)("DialogCancel"),rtl:d.AFrameworkApplication.isRtl,messageCorrelationId:e,dialogStyles:{},isLegacy:!1,fluentVersion:"V9",theme:t};n.Values=a,this._crossDocumentMessenger.sendToWindow(n,this._sharedAuthFrame.contentWindow,this._sharedFrameOrigin)}setUpPromoteSignInContentProps(e){const{title:t,message:n,imageSrc:a}=e,i=new N.a(a);return i.alt=i.src&&"null"!==i.src&&!i.alt?"An abstract illustration":i.alt,new B(t,n,i,this._sharedAuthFrameLoadStatus,this.getIFrame,this.onCloseButtonExecute,this.cancelTryGetTokenPromise,this._themePromiseResolve)}setUpCalloutParameters(e,t){return{target:t.anchorIdOrQuery?t.anchorIdOrQuery:"#AppBrand",content:e,showCloseIcon:!1,useTeachingStyles:!1,primaryButtonProps:null,secondaryButtonProps:null,calloutProps:{directionalHint:6,onDismiss:null,preventDismissOnResize:!0,layerProps:{styles:{root:{zIndex:1000001}}}},title:void 0,hasFocusableControls:void 0,preventLightDismiss:void 0,hasDynamicSizing:void 0,jumpToCalloutTargetButtonEnabled:void 0,useCoachmark:void 0,onFullRenderComplete:null}}get themePromise(){return this._themePromise.then((e=>e))}constructor(e,t,n,a,i,o){var r,l;this._themePromiseResolve=null,this.removeCallout=()=>{W.a.getNotificationsAPIAsync().then((e=>{this._notificationID&&e.removeNotification(this._notificationID)}))},this.getIFrame=()=>this._sharedAuthFrame,this.setupSharedAuthFrame=e=>{this._sharedAuthFrame=document.createElement("iframe"),this._sharedAuthFrame.id=H,this._sharedAuthFrame.setAttribute("name",H),this._sharedAuthFrame.setAttribute("title",H),this._sharedAuthFrame.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups"),this._sharedAuthFrame.style.border="0",this._sharedAuthFrame.style.height="40px",this._sharedAuthFrame.style.width="100%",this._sharedAuthFrame.src=e},this.onCloseButtonExecute=()=>{this.cancelTryGetTokenPromise()},this.cancelTryGetTokenPromise=()=>{this.removeCallout(),this._tryGetTokenPromise?.reject(Object.assign(new s.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this._tryGetTokenPromise=null,this._interactiveFlowResolve(null)},this.setupSharedAuthFrame(e),this._sharedFrameOrigin=t,this._crossDocumentMessenger=n,this._tryGetTokenPromise=i,this._promptInfo=a,(r=this._promptInfo).title??(r.title=(0,A.a)("SignIn")),(l=this._promptInfo).message??(l.message=(0,A.a)("WAC_OAuth_CompleteSignIn_Body")),this._interactiveFlowResolve=o,this._themePromise=new Promise((e=>{this._themePromiseResolve=e}))}}(0,a.a)(V,"SharedAuthPromoteSignInCallout",null,[]);class G extends U{tryGetToken(e,t,n,a,o,r,l,c){if(this._promptType="Dialog","AnonymousSignIn"!==e)return super.tryGetToken(e,t,n,a,o,r,l);if(this._interactiveFlowInProgress){const e=new s.a;return e.ErrorCode="interactive_flow_in_progress",e.ErrorMessage="Another interactive flow is in progress",Promise.reject(e)}"AnonymousSignIn"===e&&(this._interactiveFlowInProgress=!0);const d=this.getRequestKey();this._theOnlyCorrelation=d;const u=this.storePromiseWrapper(d),p=new b.a(y.a.tryGetToken);return p.Values=this.tryGetTokenRequestToMessageValues(e,t,n,a,o,r.message,d,c),i.ULS.sendTraceTag(506303891,3e3,50,`${this._baseStrategyName} TryGetToken: Called TryGetToken for app {0}`,t),this._interactiveFlowRequestQueue.enqueue((()=>new Promise((e=>{"Callout"!==this._promptType?this.tryGetTokenInteractive(r,p,e,d):this.createAndShowPromoteToSignInCallout(r,p,d,e)})).finally((()=>{this._interactiveFlowInProgress=!1})))),u}tryToShowSignInButton(e,t){return"Callout"!==this._promptType?super.tryToShowSignInButton(e,t):!(!t||!this._sharedAuthPromoteSignInCallout)&&(this._sharedAuthPromoteSignInCallout.themePromise.then((t=>{this._crossDocumentMessenger.sendToWindow(this._tryGetTokenInteractiveRequest,this._sharedAuthPromoteSignInCallout.sharedAuthFrame.contentWindow,this._sharedFrameOrigin),this._sharedAuthPromoteSignInCallout.sharedAuthFrameLoadedSuccessfully(e,t),this._tryGetTokenInteractiveRequest=null})),!0)}registerInteractiveFlowReadyHandler(){this._crossDocumentMessenger.registerCallback(y.b.interactiveFlowReady,this.onInteractiveFlowReadyUnauthenticated)}registerCloseUxHandler(){this._crossDocumentMessenger.registerCallback(y.b.closeDialog,this.onCloseUx)}registerSignInExecuteHandler(){this._crossDocumentMessenger.registerCallback(y.b.signInExecute,this.onSignInClicked)}createAndShowPromoteToSignInCallout(e,t,n,a){const i=this._promiseCollection[n];i&&(this._tryGetTokenInteractiveRequest=t,this._interactiveFlowResolve=Object.assign(new x,{resolve:a,messageCorrelationId:n}),this._sharedAuthPromoteSignInCallout=new V(this.generateSharedAuthFrameSource(!0),this._sharedFrameOrigin,this._crossDocumentMessenger,e,i,a),this._sharedAuthPromoteSignInCallout.showPromoteSignInUX())}showModal(){this._modalDiv.style.visibility="visible",this._modalDiv.style.display="flex"}hideModal(){this._modalDiv.style.visibility="hidden",this._modalDiv.style.display="none"}initializeModal(){this._modalDiv=document.createElement("div"),this._modalDiv.id="unauthenticatedModalDiv",this._modalDiv.style.position="fixed",this._modalDiv.style.height="100%",this._modalDiv.style.width="100%",this._modalDiv.style.backgroundColor="rgba(0,0,0,0.4)",this._modalDiv.style.visibility="hidden",this._modalDiv.style.display="none",this._modalDiv.style.zIndex="1000002",this._modalDiv.style.justifyContent="center",this._modalDiv.style.alignItems="center";const e=document.createElement("div");e.style.backgroundColor="white",e.style.height="124px",e.style.width="600px",e.style.borderRadius="8px";const t=document.createElement("div");t.style.fontFamily='"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',t.style.margin="24px",t.style.width="552px",t.style.height="76px";const n=document.createElement("div");n.style.height="28px",n.style.fontSize="20px",n.style.lineHeight="28px",n.style.fontWeight="600",n.innerText=(0,A.a)("PleaseFinishSigningInModalTitle"),t.appendChild(n);const a=document.createElement("div");a.style.height="40x",a.style.marginTop="8px",a.style.fontSize="14px",a.style.lineHeight="20px",a.style.fontWeight="400",a.innerText=(0,A.a)("PleaseFinishSigningInModalMessage"),t.appendChild(a),e.appendChild(t),this._modalDiv.appendChild(e),document.body.insertBefore(this._modalDiv,document.body.firstChild)}get baseStrategyName(){return"SharedAuthTokenStrategyUnauthenticated"}constructor(){super(),this._sharedAuthPromoteSignInCallout=null,this._interactiveFlowInProgress=!1,this._signInInProgress=!1,this._theOnlyCorrelation=null,this.onInteractiveFlowReadyUnauthenticated=e=>{if("Callout"!==this._promptType)return void(this.isDialogStylesRetrieved()?(this._signInInProgress&&i.ULS.sendTraceTag(506078755,3e3,10,"Interactive frame is refreshed while sign in window is open"),e.Values.messageCorrelationId=this._theOnlyCorrelation,e.Values.cancelled=!0,this.onCloseUx(e)):this.sendInitRequest());if(!this._authContext||!this._sharedAuthPromoteSignInCallout)return;const t=new b.a(y.a.init);t.Values=this.authContextToDictionary(this._authContext,!0),this._crossDocumentMessenger.sendToWindow(t,this._sharedAuthPromoteSignInCallout.sharedAuthFrame.contentWindow,this._sharedFrameOrigin)},this.onCloseUx=e=>{this._signInInProgress=!1,this.hideModal(),"Callout"===this._promptType?this._sharedAuthPromoteSignInCallout&&this._sharedAuthPromoteSignInCallout.removeCallout():this.onCloseDialog(e)},this.onSignInClicked=e=>{this._signInInProgress=!0,this.onSignInExecute(e),this.showModal()},this.initializeModal()}}(0,a.a)(G,"SharedAuthTokenStrategyUnauthenticated",U,[]);class Q{initialize(){return Promise.resolve(0)}loadAuthContext(e){return Promise.resolve(0)}tryGetToken(e,t,n,a,i,o,l){return Promise.resolve(Object.assign(new s.a,{IsSuccess:!1,ErrorCode:r.a[this._reason],ErrorMessage:"Unable to get a token. Reason: ["+r.a[this._reason]+"]"}))}tryLogin(e,t,n,a,i,o,r){return Promise.resolve(Object.assign(new s.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}hideLoginUI(){}supportsTryLogin(){return!1}getStrategyName(){return this._strategyName}constructor(e){this._reason=e,this._strategyName="UnsupportedAuthTokenStrategy Reason="+r.a[this._reason]}}(0,a.a)(Q,"UnsupportedAuthTokenStrategy",null,[545]);class q{}q.excelWebApp="WAC_Excel",q.wordWebApp="WAC_Word",q.outlookWebApp="WAC_Outlook",q.accessWebApp="WAC_Access",q.powerpointWebApp="WAC_Powerpoint",q.oneNoteWebApp="WAC_OneNote",q.hostApplicationName=null,(0,a.a)(q,"AddinHostApp",null,[]);var K=n(9858);class z{static getFlagLocalCacheKeyPrefix(){return z.addinCommandsLocalCacheFlagKey+"_"+q.hostApplicationName+"_"+K.a.calcHashCode(d.AFrameworkApplication.userName)+"_"}static getAddinCommandsKeyPrefix(e){return e+"_"+q.hostApplicationName+"_"+K.a.calcHashCode(d.AFrameworkApplication.userName)+"_"}static getPrivateCatalogAddinIdCacheKey(){return z.privateCatalogAddinIdCacheKey+"_"+q.hostApplicationName+"_"+K.a.calcHashCode(d.AFrameworkApplication.userName)+"_"}static getPrivateCatalogNeedNotifyAddinIdCacheKey(){return z.privateCatalogNeedNotifyAddinIdCacheKey+"_"+q.hostApplicationName+"_"+K.a.calcHashCode(d.AFrameworkApplication.userName)+"_"}}z.addinCommandsLaunchOpTypeKey="ack0",z.addinCommandsLaunchProviderTypeKey="ack1",z.addinCommandsAddinListKey="ack2",z.addinCommandsLocalCacheFlagKey="ack3",z.addinCommandsEntitlementsRetrievedKey="ack4",z.addinCommandsInsertAgaveParam="ack5",z.addinCommandsDevCatalogMyAddinKey="ack6",z.addinCommandsLaunchCompletedKey="ack7",z.launchAddinButtonClickedKey="ack8",z.showCalloutOnAddinKey="ack9",z.autoLaunchAddin="ack10",z.showCalloutForContentAddinKey="ack13",z.addinDetailsRefreshedKey="AddinDetailsRefreshed",z.addinServiceUserState="AddinServiceUserState",z.diagosticInfo="DiagnosticInfo",z.addinCommandsContextMenuId="msExtensibility",z.addinCommandsContextMenuControlsId="addInControls",z.addinCommandsContextMenuDisplayMode="Menu16",z.addinCommandsDdaMethod="DdaMethod",z.addinCommandsControlId="ControlId",z.addinOsfcontrolId="OsfcontrolId",z.addinSecurityOrigin="SecurityOrigin",z.addinLastUpdateTimeKey="ak0",z.addinErrorMessageKey="ak1",z.addinLastUpdateRecheckTimeKey="ak2",z.addinCommandsHasRibbonCacheKey="ak4",z.addinCommandsAutoShowTaskPaneId="Office.AutoShowTaskpaneWithDocument",z.addinEntitlementsRefreshRequired="refreshRequired",z.addinEntitlementsQueryValue="value",z.addinEntitlementsQueryErrorCode="errorCode",z.addinCommandsResourceTypeKey="ResourceType",z.dynamicAddinCommandsStoreTypeKey="StoreType",z.dynamicAddinCommandsSolutionIdKey="SolutionId",z.dynamicAddinCommandsPrivacyCompliantSolutionIdKey="PrivacyCompliantSolutionId",z.dynamicAddinCommandsMethodDataKey="MethodData",z.dynamicAddinCommandsMethodDispatchIdKey="DynamicAddinCommandsMethodDispatchId",z.dynamicAddinCommandsSourceControlIdKey="SourceControlId",z.dynamicAddinCommandsOsfControlKey="OsfControl",z.dynamicAddinCommandsWebExtensionDataKey="WebExtensionData",z.dynamicAddinCommandsRibbonUpdaterDataKey="RibbonUpdaterData",z.thirdPartyAddinAppName="AddinShared",z.privateCatalogAddinIdCacheKey="__OSF_PRIVATECATALOG_ADDINIDS",z.privateCatalogNeedNotifyAddinIdCacheKey="__OSF_PRIVATECATALOG_NEED_NOTIFY_ADDINIDS",(0,a.a)(z,"AddinConstantsString",null,[]);var j=n(7449),Z=n(4990);class X extends U{loadAuthContext(e){return this._authContext=e,Promise.resolve(0)}tryGetToken(e,t,n,a,o,r,s,l){const c=this.getRequestKey(),d=this.storePromiseWrapper(c);if(a){const s=new b.a(y.a.tryGetToken);s.Values=this.tryGetTokenRequestToMessageValues(e,t,n,a,o,r.message,c,l),a?this._interactiveFlowRequestQueue.enqueue((()=>new Promise((e=>{this.tryGetTokenInteractive(r,s,e,c)})))):(this._crossDocumentMessenger.sendToWindow(s,this._sharedAuthFrame.contentWindow,this._sharedFrameOrigin),i.ULS.sendTraceTag(573112901,3e3,50,`${this._baseStrategyName} TryGetToken: Called TryGetToken for app {0}`,t))}else{const i=new b.a(y.a.initAndGetToken),s=this.authContextToDictionary(this._authContext,!1),d=this.tryGetTokenRequestToMessageValues(e,t,n,a,o,r.message,c,l),u={};u.initParams=s,u.getTokenParams=d,i.Values=u,this.shouldWaitForPairwiseBrokerInitMessageFromParentFrame()?this.waitForPairwiseBrokerInitMessageFromParentFrameWithTimeout(i,this._sharedAuthFrame.contentWindow):this._crossDocumentMessenger.sendToWindow(i,this._sharedAuthFrame.contentWindow,this._sharedFrameOrigin)}return d}sendInitRequest(){if(this._authContext&&this._sharedAuthConsentDialog){const e=new b.a(y.a.init);e.Values=this.authContextToDictionary(this._authContext,!0),this.shouldWaitForPairwiseBrokerInitMessageFromParentFrame()?this.waitForPairwiseBrokerInitMessageFromParentFrameWithTimeout(e,this._sharedAuthConsentDialog.sharedAuthFrame.contentWindow):this._crossDocumentMessenger.sendToWindow(e,this._sharedAuthConsentDialog.sharedAuthFrame.contentWindow,this._sharedFrameOrigin)}}get baseStrategyName(){return"PairwiseBrokerStrategy"}shouldWaitForPairwiseBrokerInitMessageFromParentFrame(){if(this._waitForPairwiseBrokerInitMessageFromParentFrame){return"sharepointcom"===d.AFrameworkApplication.appSettingsManager.getStringAppSetting(d.AFrameworkApplication.uiHostSettingName)}return!1}async waitForPairwiseBrokerInitMessageFromParentFrameWithTimeout(e,t){const n=this.getPairwiseBrokerInitMessageFromParentFramePromise(),a=g.get(n,{resultName:"PairwiseBrokerInitMessage",value:!0},this._wacPairwiseBrokerHostInitializationTimeout),o=this._wacPairwiseBrokerHostInitializationTimeoutEnabled?a:n;try{await o&&i.ULS.sendTraceTag(505558081,3e3,50,`${this._baseStrategyName} Init: Timed out waiting for Host_MsalComplete message from parent frame, attempting to initialize anyway.`)}catch(e){i.ULS.sendTraceTag(505558080,3e3,10,`${this._baseStrategyName} Init: Caught error ${e} waiting for for Host_MsalComplete message from parent frame, attempting to initialize anyway.`)}finally{this._crossDocumentMessenger.sendToWindow(e,t,this._sharedFrameOrigin)}}async getPairwiseBrokerInitMessageFromParentFramePromise(){let e;try{const{complete:t,error:n}=await d.AFrameworkApplication.pairwiseBrokerHostCompleteListener;t&&!n||(e=n||new Error("PairwiseBrokerHostCompleteListener not complete"),i.ULS.sendTraceTag(505558051,3e3,10,`${this._baseStrategyName} Init: Error waiting for PairwiseBrokerHostCompleteListener: {0}`,n))}catch(t){e=t,i.ULS.sendTraceTag(505558050,3e3,10,`${this._baseStrategyName} Init: Caught error waiting for PairwiseBrokerHostCompleteListener: {0}`,t)}finally{if(e)throw e}return!1}constructor(){super(),this._sharedAuthVersion=C.pairwise,this._waitForPairwiseBrokerInitMessageFromParentFrame=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WaitForPairwiseBrokerInitMessageFromParentFrame",!1),this._wacPairwiseBrokerHostInitializationTimeoutEnabled=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PairwiseBrokerInitializationTimeoutEnabled",!0),this._wacPairwiseBrokerHostInitializationTimeout=d.AFrameworkApplication.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.PairwiseBrokerHostInitializationTimeout",5e3)}}(0,a.a)(X,"PairwiseBrokerStrategy",U,[545]);class J{determineAuthSupportAndStrategy(){if(this._authTokenStrategy&&d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.SkipCreatingAuthStrategyIfAlreadyCreated"))return;if(this._isPerfAutomation)return this._authSupportStatus=5,void(this._authTokenStrategy=new Q(this._authSupportStatus));const e=u.a.mockTokenForAutomation;if(e&&e.length>0)return this._authSupportStatus=1,void(this._authTokenStrategy=new l(e));const t=d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost"),n=d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost"),a=d.AFrameworkApplication.appSettingsManager.getStringAppSetting("FileSource"),o="OpenFromUrl"===a,r="OneDriveWOPI"===a||"SharePointOnlineConsumer"===a,s=d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"),c=d.AFrameworkApplication.isUnauthEdit;if(!(t||n||o))return this._authSupportStatus=4,void(this._authTokenStrategy=new Q(this._authSupportStatus));if(s&&!r&&!o)return this._authSupportStatus=2,void(this._authTokenStrategy=new Q(this._authSupportStatus));if(c)return this._authSupportStatus=1,void(this._authTokenStrategy=new G);if(!(p.getAuthContext().loginHint||s&&(o||r)))return this._authSupportStatus=3,void(this._authTokenStrategy=new Q(this._authSupportStatus));if(u.a.hostPageSupportsAuth)return this._authSupportStatus=1,void(this._authTokenStrategy=new f);const g=d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9544703_PairwiseBrokerEnabled"),h=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacPairwiseBrokerStrategyEnabled",!1),m=!_.a.isSafari&&d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacPairwiseBrokerEnabled",!1),S=_.a.isSafari&&d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PairwiseBrokerForSafariEnabled",!1),C=d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacPairwiseBrokerEnabledForZoom",!1)&&"69769f4e-b8a8-4413-939d-c728ca6da386"===d.AFrameworkApplication.appSettingsManager.getStringAppSetting("TenantId"),y=g&&u.a.hostPageSupportsPairwiseBroker&&h&&(m||S||C);if(i.ULS.sendTraceTag(505546695,3e3,50,"isPairwiseBrokerEnabled={0}, hostPageSupportsPairwiseBroker={1}, isPairwiseBrokerChangeGateEnabled={2}, isPairwiseBrokerStrategyEnabled={3}, isPairwiseBrokerEnabledAndBrowserIsNotSafari={4}, isPairwiseBrokerEnabledAndBrowserIsSafari={5}, isPairwiseBrokerEnabledAndTenantIsZoomTestTenant={6}",y,u.a.hostPageSupportsPairwiseBroker,g,h,m,S,C),y)return this._authSupportStatus=1,void(this._authTokenStrategy=new X);this._authSupportStatus=1,this._authTokenStrategy=new U}getAuthStrategyName(){return this._authTokenStrategy?this._authTokenStrategy.getStrategyName()||"Unknown":"None"}hasVisibilityStateChanged(){return this._hasVisibilityStateChanged||window.document.hidden}getInitAttempts(){return this._initAttempts}determineAuthLibrary(e=null){i.ULS.sendTraceTag(562128578,3e3,50,"Creating OAuthManager.");const t=I.a.getTickCount();return d.AFrameworkApplication.appSettingsManager.getFullAppSettings().then((n=>(n?(this.determineAuthSupportAndStrategy(),e&&(this._authTokenStrategy=e),i.ULS.sendTraceTag(42084323,3e3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",u.a.clientVersion,u.a.appVersion,u.a.docVersion,this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-t))):i.ULS.sendTraceTag(562128579,3e3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(I.a.getTickCount()-t)),this.logInitUsageKpi(t,t),Promise.resolve(n))),(e=>(i.ULS.sendTraceTag(562128580,3e3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(I.a.getTickCount()-t)),this.logInitUsageKpi(t,t),Promise.resolve(!1))))}initOAuthManager(e=null,t){this._initSuccessful?i.ULS.sendTraceTag(506319825,3e3,100,"OAuthManager Already Init'd - return"):"visible"!==document.visibilityState&&this._initAndLoadPromise?i.ULS.sendTraceTag(506319824,3e3,15,"Document Not Visible - postponing OAuthManager init."):this._initAndLoadPromise=this.determineAuthLibrary(e).then((e=>{if(!e){i.ULS.sendTraceTag(527827277,3e3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-t)),this.logInitErrorKpi(t,I.a.getTickCount(),"StrategyPickFailed");const e=v.a.createExtendedPropertiesMap();if(null!=e){e.set("AuthLibrary",this.getAuthStrategyName());const n=Object.assign({},{durationMs:Math.floor(I.a.getTickCount()-t),extendedProperties:e});T.Health.instance.recordKpiFailure("OAuthManager","StrategyPickFailed",!1,!0,n)}return Promise.resolve(1)}return this.initAuthLibrary()})).then((e=>0!==e?(this.logInitErrorKpi(t,I.a.getTickCount(),"StrategyPickFailed"),Promise.resolve(e)):this.loadAuthLibrary()))}initAuthLibrary(){i.ULS.sendTraceTag(573390991,3e3,50,"Initializing {0}",this.getAuthStrategyName());const e=I.a.getTickCount(),t=this._initAttempts>0;return this._initAttempts++,g.get(this._authTokenStrategy.initialize(t),{resultName:"Strategy Initialize",value:2},u.a.promiseTimeoutInMs).then((t=>{const n=I.a.getTickCount();if(0===t)this._initSuccessful=!0,i.ULS.sendTraceTag(42084353,3e3,50,"Initialization succeeded for {0} in {1} ms after {2} attempts",this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-e),this._initAttempts);else if(1===t){i.ULS.sendTraceTag(527827291,3e3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-e)),this.logInitErrorKpi(e,n,"StrategyInitFailed");const t=v.a.createExtendedPropertiesMap();if(null!=t){t.set("StartTime",e.toString()),t.set("EndTime",n.toString()),t.set("AuthLibrary",this.getAuthStrategyName());const a=Object.assign({},{durationMs:Math.floor(I.a.getTickCount()-e),extendedProperties:t});T.Health.instance.recordKpiFailure("OAuthManager","StrategyInitFailed",!1,!0,a)}}else if(2===t){i.ULS.sendTraceTag(42267908,3e3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-e)),this.logInitErrorKpi(e,n,"StrategyInitTimedOut");const t=v.a.createExtendedPropertiesMap();if(null!=t){t.set("StartTime",e.toString()),t.set("EndTime",n.toString()),t.set("AuthLibrary",this.getAuthStrategyName());const a=Object.assign({},{durationMs:Math.floor(I.a.getTickCount()-e),extendedProperties:t});T.Health.instance.recordKpiFailure("OAuthManager","StrategyInitTimedOut",!1,!0,a)}}return Promise.resolve(t)}),(t=>(i.ULS.sendTraceTag(574239256,3e3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-e)),this.logInitErrorKpi(e,I.a.getTickCount(),"StrategyInitUnknownError"),Promise.resolve(1))))}loadAuthLibrary(){i.ULS.sendTraceTag(562128581,3e3,50,"Loading {0}",this.getAuthStrategyName());const e=I.a.getTickCount();return g.get(this._authTokenStrategy.loadAuthContext(p.getAuthContext()),{resultName:"Strategy Load",value:2},u.a.promiseTimeoutInMs).then((t=>{const n=I.a.getTickCount();if(0===t)i.ULS.sendTraceTag(562128582,3e3,50,"Load succeeded for {0} in {1} ms.",this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-e)),this.logInitSuccessKpi(e,n);else if(1===t){i.ULS.sendTraceTag(562128583,3e3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-e)),this.logInitErrorKpi(e,n,"StrategyLoadFailed");const t=v.a.createExtendedPropertiesMap();if(null!=t){t.set("StartTime",e.toString()),t.set("EndTime",n.toString()),t.set("AuthLibrary",this.getAuthStrategyName());const a=Object.assign({},{durationMs:Math.floor(I.a.getTickCount()-e),extendedProperties:t});T.Health.instance.recordKpiFailure("OAuthManager","StrategyLoadFailed",!1,!0,a)}}else if(2===t){i.ULS.sendTraceTag(558469660,3e3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-e)),this.logInitErrorKpi(e,n,"StrategyLoadTimedOut");const t=v.a.createExtendedPropertiesMap();if(null!=t){t.set("StartTime",e.toString()),t.set("EndTime",n.toString()),t.set("AuthLibrary",this.getAuthStrategyName());const a=Object.assign({},{durationMs:Math.floor(I.a.getTickCount()-e),extendedProperties:t});T.Health.instance.recordKpiFailure("OAuthManager","StrategyLoadTimedOut",!1,!0,a)}}return Promise.resolve(t)}),(t=>(i.ULS.sendTraceTag(562128584,3e3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.getAuthStrategyName(),Math.floor(I.a.getTickCount()-e)),this.logInitErrorKpi(e,I.a.getTickCount(),"StrategyLoadUnknownError"),Promise.resolve(1))))}tryRefreshToken(e,t,n=null,a,i){return this.tryGetTokenInternal(e,t,!1,a,{message:""},n,0,0,!0,i)}tryGetToken(e,t,n=null,a,i){return this.tryGetTokenInternal(e,t,!1,a,{message:""},n,void 0,void 0,void 0,i)}tryGetTokenWithPopup(e,t,n,a,i=null,o){return this.tryGetTokenInternal(e,t,!0,n,a,i,void 0,void 0,void 0,o)}tryGetTokenInternal(e,t,n,a,o,r,l=0,c=0,p,h){l+=1,i.ULS.sendTraceTag(42084352,3e3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called withPopup={2}.  Using strategy {3} - attempt {4}, callerServiceName={5}",e,this.sanitizeStringForThirdParty(e,t),n,this.getAuthStrategyName(),l,h),n||this.logSilentUsageKpi(I.a.getTickCount(),I.a.getTickCount(),e,t,h);const m=v.a.createExtendedPropertiesMap();if(null!=m&&(m.set("StartTime",I.a.getTickCount().toString()),m.set("CallerServiceName",h),m.set("AuthLibrary",this.getAuthStrategyName()),m.set("AppName",e),m.set("Target",this.sanitizeStringForThirdParty(e,t)),T.Health.instance.recordKpiUsage("OAuthManager",j.b.FailureBased,"WacOAuthFC",m)),!u.a.isEnabled||this._isPerfAutomation){let n;return this.logFailureAndResolvePromise((n=new s.a,n.IsSuccess=!1,n.Token=null,n.ErrorCode="NotEnabled",n.ErrorMessage="OAuthManager is disabled.",n),e,t,h)}const _=u.a.appMapping[e];if(null==_){let n;return i.ULS.sendTraceTag(41961345,3e3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",e),this.logFailureAndResolvePromise((n=new s.a,n.IsSuccess=!1,n.Token=null,n.ErrorCode="DisallowedApp",n.ErrorMessage="Disallowed appName: "+e,n),e,t,h)}const S=I.a.getTickCount();let f=S;const C=this,y=this._initAndLoadPromise.then((s=>{const l=this.attemptSilentFirst(e,a);this.markAppStarted(e);let d=!1;return d=!l&&n,d&&(i.ULS.sendTraceTag(507252869,3e3,50,"TryGetToken called withPopup: {0}.  Will invoke popup instead of attempting silently",n),c|=32),f=I.a.getTickCount(),C.invokeStrategyTryGetToken(e,_,t,d,a,o,r,s,p,h)}));let A,b=u.a.promiseTimeoutInMs;(n||this._interactionInProgress)&&(b=0);const w={resultName:"Strategy Get Token",value:(A=new s.a,A.IsSuccess=!1,A.Token=null,A.ErrorCode="authTokenStrategy_timeout",A.ErrorMessage="Auth Strategy timed out after ["+b+"] ms when fetching token",A)},F=g.get(y,w,b),E=this,M=this;return F.then((s=>{if(d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RemapErrorCodes",!1)&&l<=J.maxRetriesOnTimeout&&(s.ErrorCode===J.authStrategy_TimeoutErrorCode||s.ErrorCode===J.RetryRequiredError)||l<=J.maxRetriesOnTimeout&&(s.ErrorCode===J.TimeoutError||s.ErrorCode===J.authStrategy_TimeoutErrorCode))return i.ULS.sendTraceTag(573175516,3e3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",l,Math.floor(I.a.getTickCount()-S)),E.tryGetTokenInternal(e,t,n,a,o,r,l,4|c);if(s.ErrorCode===J.ThirdPartyCookiesBlockedError||s.ErrorCode===J.InteractionRequiredError){if(i.ULS.sendTraceTag(561517645,3e3,50,"TryGetToken failed with ITP error. Popup Requested [{0}]",n),this.logInteractiveOrSilentFailureKpi(S,I.a.getTickCount(),e,t,c,this.getAuthStrategyName(),s?.Telemetry?.isRequestBrokered,h,s?.Telemetry?.correlationId,s?.Telemetry?.isVisible,s?.Telemetry?.visibilityChangeCount,"InteractionRequiredFailre",s.ErrorCode,s.ErrorMessage,s.MsalError),n)return i.ULS.sendTraceTag(505558231,3e3,50,"Retry getting token with popup when [ITP error] occurred and [withPopup] set to true"),this._interactionInProgress=!0,E.tryGetTokenInternal(e,t,!0,a,o,r,l,32|c);if(J.interactiveFallbackEnabledForApp(_)){if(d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.BeforeInteractiveFlowKpiEnabled")){const n=I.a.getTickCount(),a=n-f,i=v.a.createExtendedPropertiesMap();if(null!=i){i.set("CallerServiceName",h),i.set("StartTime",S.toString()),i.set("EndTime",n.toString()),i.set("AppName",e),i.set("AuthLibrary",this.getAuthStrategyName()),i.set("ErrorCode",s.ErrorCode),i.set("ErrorMessage",this.sanitizeStringForThirdParty(e,s.ErrorMessage)),i.set("MsalError",s.MsalError),i.set("SubError",s.SubError),i.set("Type",c.toString()),i.set("Target",this.sanitizeStringForThirdParty(e,t));const o=Object.assign({},{durationMs:a,extendedProperties:i});T.Health.instance.recordKpiFailure("OAuthManager","TryGetTokenSilentFailure",!1,!0,o)}}const u=this._resolveITPErrorPromise;return this._resolveITPErrorPromise=u.then((s=>s.IsSuccess?E.tryGetTokenInternal(e,t,n,a,o,r,l,8|c):s.ErrorCode===J.NoResultError||s.ErrorCode===J.ThirdPartyCookiesBlockedError?(i.ULS.sendTraceTag(505558230,3e3,50,"Interactive flow start when [ITP error/Interaction required error] occurred: show biz bar"),this.logInteractiveUsageKpi(S,I.a.getTickCount(),e,t,h),this._interactionInProgress=!0,E.invokeStrategyTryLogin(e,_,t,n,a,o,r,S,f,16|c,h).then((n=>n.ErrorCode===J.InteractionRequiredError?(i.ULS.sendTraceTag(505558229,3e3,50,"Interactive flow hit [Interaction required error]: show popup window"),this._interactionInProgress=!0,E.tryGetTokenInternal(e,t,!0,a,o,r,l,32|c)):n))):s.ErrorCode===J.InteractionRequiredError?(i.ULS.sendTraceTag(505558228,3e3,50,"Interactive flow hit [Interaction required error]: show popup window"),this._interactionInProgress=!0,E.tryGetTokenInternal(e,t,!0,a,o,r,l,32|c)):s.ErrorCode===J.UserCancelledError?(i.ULS.sendTraceTag(505558227,3e3,50,"Interactive flow stopped with [User cancelled error]"),s):void 0)).catch((i=>(this._interactionInProgress=!0,E.invokeStrategyTryLogin(e,_,t,n,a,o,r,S,f,c,h)))),this._resolveITPErrorPromise}}return Promise.resolve(E.logResultAndReturn(s,e,t,_,S,f,c,l,h))})).catch((n=>{let a;const i=(a=new s.a,a.IsSuccess=!1,a.Token=null,a.ErrorCode="authTokenStrategy_failure",a.ErrorMessage="Auth Strategy failed with an unknown error",a);return Promise.resolve(M.logResultAndReturn(i,e,t,_,S,f,c,l,h))}))}invokeStrategyTryLogin(e,t,n,a,i,o,r,l,c,u,p){const g=new s.a;if(g.IsSuccess=!1,d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"))return g.ErrorCode="userUnsupportedAnonymous",g.ErrorMessage="Won't login the anonymous user until any action that requires login is triggered",Promise.resolve(g);if(!this._authTokenStrategy.supportsTryLogin())return g.ErrorCode="authTokenStrategy_loginNotSupported",g.ErrorMessage="This Token Strategy does not support login flow, TryLogin could not be completed",Promise.resolve(g);const h=this._authTokenStrategy.tryLogin(e,t,n,a,i,o,r).then((t=>Promise.resolve(this.normalizeResponseToOAuthResult(t,!0,e)))).catch((t=>Promise.resolve(this.normalizeResponseToOAuthResult(t,!1,e)))).then((a=>(u|=16,Promise.resolve(this.logResultAndReturn(a,e,n,t,l,c,u,void 0,p))))).catch((a=>(g.ErrorCode="authTokenStrategy_failure",g.ErrorMessage="LoginPopup failed, GetToken could not be called",u|=16,Promise.resolve(this.logResultAndReturn(g,e,n,t,l,c,u,null,p))))),m=this._popupPromise.basePromise.then((()=>this.tryGetTokenInternal(e,n,a,i,o,r,0,8|u)));return Promise.race([m,h])}invokeStrategyTryGetToken(e,t,n,a,i,o,r,l,c,d){return 1===l||2===l?this.logFailureAndResolvePromise(Object.assign(new s.a,{IsSuccess:!1,Token:null,ErrorCode:1===l?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load",VisibilityStateChanged:this.hasVisibilityStateChanged()}),e,n,d):this._authTokenStrategy.tryGetToken(e,t,n,a,i,o,r,c).then((t=>{if(a){const e=new s.a;e.IsSuccess=!0,this._authTokenStrategy.hideLoginUI(),this._popupPromise.resolve(e)}return Promise.resolve(this.normalizeResponseToOAuthResult(t,!0,e))})).catch((t=>Promise.resolve(this.normalizeResponseToOAuthResult(t,!1,e))))}logResultAndReturn(e,t,n,a,s,l,c=0,d=0,u){const g={},h=I.a.getTickCount(),m=l-s,_=h-l,S=e?.Telemetry?.correlationId,f=e?.Telemetry?.isVisible,C=e?.Telemetry?.visibilityChangeCount,y=e?.Telemetry?.isRequestBrokered;g.IsSuccess=e.IsSuccess,g.ErrorCode=e.IsSuccess?"Success":e.ErrorCode||"",g.ErrorMessage=e.IsSuccess?"Success":this.sanitizeStringForThirdParty(t,e.ErrorMessage||""),g.Target=this.sanitizeStringForThirdParty(t,n||""),g.TimeInMS=Math.floor(_),g.LoadTimeInMS=Math.floor(m),g.AuthLibrary=this.getAuthStrategyName(),g.AppName=t,g.AuthorityType=((e,t)=>{let n=e.__sortedValues;if(!n){n=[];for(const t in e)"string"==typeof t&&n.push({key:t,value:e[t]});n.sort(((e,t)=>e.value-t.value)),e.__sortedValues=n}const a=[];let i=t,o=1;for(;i>0;)1&i&&e[o]&&a.push(e[o]),o<<=1,i>>=1;if(a.length&&0===i)return a.reverse().join(", ")})(o,p.getAuthorityType()),g.UserType=this.getUserTypeForLogging(p.getAuthContext(),e.IsSuccess),g.IsAuthSupportedInSession=r.a[this.getSupportStatus()],g.RequestCount=++this._requestCount,g.AppId=a,g.RetryCount=d,S&&(g.CorrelationId=S),null!=f&&(g.IsVisible=f),null!=C&&(g.VisibilityChangeCount=C),null!=y&&(g.IsRequestBrokered=y),e.IsSuccess&&(this.markAppSuccessful(t),e.Telemetry?.fromCache?c|=1:c|=2),g.Type=c,(16&c||32&c)&&(this._interactionInProgress=!1),i.ULS.sendTraceTag(593863640,3e3,50,JSON.stringify(g));const A=v.a.createExtendedPropertiesMap();if(e.IsSuccess){if(this.logInteractiveOrSilentSuccessKpi(s,h,t,n,c,this.getAuthStrategyName(),y,u,S,f,C),null!=A){A.set("CallerServiceName",u),A.set("StartTime",s.toString()),A.set("EndTime",h.toString()),A.set("AppName",t),A.set("AuthLibrary",this.getAuthStrategyName()),A.set("RetryCount",d.toString()),A.set("Type",c.toString()),A.set("Target",this.sanitizeStringForThirdParty(t,n)),S&&A.set("CorrelationId",S),null!=f&&A.set("IsVisible",f.toString()),null!=C&&A.set("VisibilityChangeCount",C.toString()),null!=y&&A.set("IsRequestBrokered",y.toString());const e=Object.assign({},{durationMs:_,extendedProperties:A});T.Health.instance.recordKpiSuccess("OAuthManager",e)}}else{if(null!=A){A.set("CallerServiceName",u),A.set("StartTime",s.toString()),A.set("EndTime",h.toString()),A.set("AppName",t),A.set("AuthLibrary",this.getAuthStrategyName()),A.set("ErrorCode",e.ErrorCode),A.set("ErrorMessage",this.sanitizeStringForThirdParty(t,e.ErrorMessage)),A.set("MsalError",e.MsalError),A.set("SubError",e.SubError),A.set("Type",c.toString()),A.set("Target",this.sanitizeStringForThirdParty(t,n)),S&&A.set("CorrelationId",S),null!=f&&A.set("IsVisible",f.toString()),null!=C&&A.set("VisibilityChangeCount",C.toString()),null!=y&&A.set("IsRequestBrokered",y.toString());const a=Object.assign({},{durationMs:_,extendedProperties:A});T.Health.instance.recordKpiFailure("OAuthManager","TryGetTokenFailure",!1,!0,a)}this.logInteractiveOrSilentFailureKpi(s,h,t,n,c,this.getAuthStrategyName(),y,u,S,f,C,"TryGetTokenFailure",e.ErrorCode,e.ErrorMessage,e.MsalError)}return e}logFailureAndResolvePromise(e,t,n,a){i.ULS.sendTraceTag(506024475,3e3,50,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",t,this.sanitizeStringForThirdParty(t,e.ErrorMessage));const o=e?.Telemetry?.isVisible,r=e?.Telemetry?.visibilityChangeCount,s=e?.Telemetry?.isRequestBrokered,l=e?.Telemetry?.correlationId,c=I.a.getTickCount();this.logSilentErrorKpi(c,c,t,n,null,this.getAuthStrategyName(),s,a,l,o,r,"FailureBeforeGetToken",e?.ErrorCode,e?.ErrorMessage,e?.MsalError);const d=v.a.createExtendedPropertiesMap();if(null!=d){d.set("StartTime",c.toString()),d.set("EndTime",c.toString()),d.set("CallerServiceName",a),d.set("AppName",t),d.set("AuthLibrary",this.getAuthStrategyName()),d.set("ErrorCode",e.ErrorCode),d.set("ErrorMessage",this.sanitizeStringForThirdParty(t,e.ErrorMessage)),d.set("VisibilityStateChanged",String(e.VisibilityStateChanged)),d.set("Target",this.sanitizeStringForThirdParty(t,n)),d.set("CorrelationId",l),d.set("IsRequestBrokered",s?.toString()),d.set("VisibilityChangeCount",r?.toString()),d.set("IsVisible",o?.toString());const i=Object.assign({},{extendedProperties:d});T.Health.instance.recordKpiFailure("OAuthManager","FailureBeforeGetToken",!1,!0,i)}return Promise.resolve(e)}isForThirdParty(e){return e===z.thirdPartyAddinAppName}sanitizeStringForThirdParty(e,t){return this.isForThirdParty(e)&&t?"REDACTED":t}getUserTypeForLogging(e,t){return d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser")?t?"signed-in-from-anonymous":"anonymous":!e.loginHint||e.loginHint.length<1?"empty":e.loginHint.indexOf("guest#")>-1?"guest":e.loginHint.indexOf("ext#")>-1?"external":e.upn.indexOf("@")<0?"no-at":"supported"}isAuthSupportedInSession(){return 1===this._authSupportStatus}getSupportStatus(){return this._authSupportStatus}normalizeResponseToOAuthResult(e,t,n){const a=e;let o=null,r=null,l=null,c=null,u=null,p=null,g=null,h=null;return a?a.ErrorCode||a.ErrorMessage?(r=a.ErrorCode?a.ErrorCode:J.ExceptionError,l=a.ErrorMessage?a.ErrorMessage:"No message",u=a.ErrorCode,p=a.SubError):e.errorCode||e.errorMessage?(r=e.errorCode?e.errorCode:J.ExceptionError,l=e.errorMessage?e.errorMessage:"No message",u=e.errorCode,p=e.subError,g=e.correlationId,h=e.isRequestBrokered):a.Token?t?o=a.Token:(r=J.RejectTokenError,l="A rejected promise returned a token."):(r=J.ExceptionError,l=JSON.stringify(a)):(r=J.NoResultError,l="No result came from Auth Token Strategy"),a&&a.Telemetry&&!this.isForThirdParty(n)&&(c=a.Telemetry),g&&(c=c?{...c,correlationId:g}:{correlationId:g}),null!=h&&(c=c?{...c,isRequestBrokered:h}:{isRequestBrokered:h}),c&&i.ULS.sendTraceTag(579166408,3e3,50,JSON.stringify(c)),d.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RemapErrorCodes",!1)?(r===J.authLibrary_ITPError&&(r=J.ThirdPartyCookiesBlockedError),r!==J.authLibrary_PopupBlockedError&&r!==J.authLibrary_MonitorWindowTimeoutErrorCode&&r!==J.authLibrary_ConsentRequiredError&&r!==J.authLibrary_InvalidGrantError&&r!==J.authLibrary_InteractionRequiredError&&r!==J.authLibrary_BadTokenError&&r!==J.authLibrary_NoTokenFoundError&&r!==J.authLibrary_NativeAccountUnavailable&&r!==J.authLibrary_RefreshTokenExpiredError||(r=J.InteractionRequiredError),r===J.authLibrary_UserCancelled&&(r=J.UserCancelledError),r!==J.authLibrary_NoNetworkConnectivityError&&r!==J.authLibrary_EndpointsResolutionError&&r!==J.authLibrary_AuthorizationCodeMissingError&&r!==J.authLibrary_StateNotFoundError&&r!==J.authLibrary_PostRequestFailedError||(r=J.RetryRequiredError)):(r!==J.authLibrary_MonitorWindowTimeoutErrorCode&&r!==J.authLibrary_TokenRenewalError||(r=J.TimeoutError,l="Auth Library Timed Out"),r===J.authLibrary_ITPError&&(r=J.ThirdPartyCookiesBlockedError),r!==J.authLibrary_PopupBlockedError&&r!==J.authLibrary_ConsentRequiredError&&r!==J.authLibrary_InvalidGrantError||(r=J.InteractionRequiredError),r===J.authLibrary_UserCancelled&&(r=J.UserCancelledError)),(r||l)&&(o=null),Object.assign(new s.a,{IsSuccess:!!o,Token:o,ErrorCode:r,ErrorMessage:l,Telemetry:c,MsalError:u,SubError:p})}static interactiveFallbackEnabledForApp(e){return"243c63a3-247d-41c5-9d83-7788c43f1c43"===e}markAppStarted(e){if(!this._successfullyAcquiredTokens.has(e))return this._successfullyAcquiredTokens.set(e,!1)}markAppSuccessful(e){this._successfullyAcquiredTokens.set(e,!0)}isForAnonymousSignIn(e){return"AnonymousSignIn"===e}attemptSilentFirst(e,t){return!this.isForThirdParty(e)&&!this.isForAnonymousSignIn(e)&&(!t&&(!this._successfullyAcquiredTokens.has(e)||this._successfullyAcquiredTokens.get(e)))}isKpiLogged(e,t,n){return!!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerKpiLoggingCheckEnabled")&&(e.has(t)?!!e.get(t).has(n)||(e.get(t).add(n),!1):(e.set(t,new Set([n])),!1))}isInteractiveFlow(e){return 0!=(32&e)||0!=(16&e)}getExtendedProperties(e,t,n,a,o,r,s,l,c,d,u,p,g,h,m){const _=v.a.createExtendedPropertiesMap();if(null!=_){_.set("CallerServiceName",c),_.set("StartTime",t?.toString()),_.set("EndTime",n?.toString()),_.set("AppName",a),_.set("AuthLibrary",s),_.set("Type",r?.toString()),_.set("Target",this.sanitizeStringForThirdParty(a,o)),_.set("CorrelationId",d),_.set("IsRequestBrokered",l?.toString()),_.set("VisibilityChangeCount",p?.toString()),_.set("IsVisible",u?.toString()),e&&(_.set("ErrorCode",g),_.set("ErrorMessage",this.sanitizeStringForThirdParty(a,h)),_.set("MsalError",m));const i=n-t;return Object.assign({},{durationMs:i,extendedProperties:_})}return i.ULS.sendTraceTag(505545051,3e3,50,"getExtendedProperties: kpiExtendedProperties is not initialized"),null}logInteractiveOrSilentSuccessKpi(e,t,n,a,i,o,r,s,l,c,d){this.isInteractiveFlow(i)?this.logInteractiveSuccessKpi(e,t,n,a,i,o,r,s,l,c,d):this.logSilentSuccessKpi(e,t,n,a,i,o,r,s,l,c,d)}logInteractiveOrSilentFailureKpi(e,t,n,a,i,o,r,s,l,c,d,u,p,g,h){this.isInteractiveFlow(i)?this.logInteractiveErrorKpi(e,t,n,a,i,o,r,s,l,c,d,u,p,g,h):this.logSilentErrorKpi(e,t,n,a,i,o,r,s,l,c,d,u,p,g,h)}logSilentUsageKpi(e,t,n,a,o){if(!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerSilentKpiEnabled"))return void i.ULS.sendTraceTag(505545050,3e3,50,"OAuthManagerSilentKpiEnabled gate is disabled. Not logging KPI.");if(i.ULS.sendTraceTag(505545049,3e3,50,`OAuthManagerSilentUsage: StartTime: ${e}, EndTime: ${t}, AppName: ${n}, CallerServiceName: ${o}`),this.isKpiLogged(this.silentKpisLoggedPerSession,n,"Usage"))return;const r=this.getExtendedProperties(!1,e,t,n,a,null,this.getAuthStrategyName(),null,o,null,null,null,null,null,null);r&&r.extendedProperties?T.Health.instance.recordKpiUsageForAlertableKpi("OAuthManagerSilent","WacOAuthFC",r.extendedProperties):i.ULS.sendTraceTag(505545048,3e3,50,"OAuthManagerSilentKpiUsage: extendedProperties is null. The KPI will not be logged.")}logSilentSuccessKpi(e,t,n,a,o,r,s,l,c,u,p){if(!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerSilentKpiEnabled"))return void i.ULS.sendTraceTag(505545047,3e3,50,"OAuthManagerSilentKpiEnabled gate is disabled. Not logging KPI.");if(i.ULS.sendTraceTag(505545046,3e3,50,`OAuthManagerSilentKpiSuccess: StartTime: ${e}, EndTime: ${t}`),this.isInteractiveFlow(o))return;if(this.isKpiLogged(this.silentKpisLoggedPerSession,n,"Success"))return;const g=this.getExtendedProperties(!1,e,t,n,a,o,r,s,l,c,u,p,null,null,null);g?T.Health.instance.recordKpiSuccess("OAuthManagerSilent",g):i.ULS.sendTraceTag(505545045,3e3,50,"OAuthManagerSilentKpiSuccess: successKpiAdditionalValues is null. The KPI will not be logged.")}logSilentErrorKpi(e,t,n,a,o,r,s,l,c,u,p,g,h,m,_){if(!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerSilentKpiEnabled"))return void i.ULS.sendTraceTag(505545044,3e3,50,"OAuthManagerSilentKpiEnabled gate is disabled. Not logging KPI.");if(i.ULS.sendTraceTag(505545043,3e3,50,`OAuthManagerSilentKpiError: ${g}, StartTime: ${e}, EndTime: ${t}`),this.isKpiLogged(this.silentKpisLoggedPerSession,n,"Failure"))return;const S=this.getExtendedProperties(!0,e,t,n,a,o,r,s,l,c,u,p,h,m,_);S?T.Health.instance.recordKpiFailure("OAuthManagerSilent",g,!1,!0,S):i.ULS.sendTraceTag(505545042,3e3,50,"OAuthManagerSilentKpiFailure: failureKpiAdditionalValues is null. The KPI will not be logged.")}logInteractiveUsageKpi(e,t,n,a,o){if(!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerInteractiveKpiEnabled"))return void i.ULS.sendTraceTag(505545041,3e3,50,"OAuthManagerInteractiveKpiEnabled gate is disabled. Not logging KPI.");i.ULS.sendTraceTag(505545040,3e3,50,`OAuthManagerInteractiveUsage: StartTime: ${e}, EndTime: ${t}, AppName: ${n}, CallerServiceName: ${o}`);const r=this.getExtendedProperties(!1,e,t,n,a,null,this.getAuthStrategyName(),null,o,null,null,null,null,null,null);r&&r.extendedProperties?T.Health.instance.recordKpiUsageForAlertableKpi("OAuthManagerInteractive","WacOAuthFC",r.extendedProperties):i.ULS.sendTraceTag(505545039,3e3,50,"OAuthManagerInteractiveKpiUsage: extendedProperties is null. The KPI will not be logged.")}logInteractiveSuccessKpi(e,t,n,a,o,r,s,l,c,u,p){if(!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerInteractiveKpiEnabled"))return void i.ULS.sendTraceTag(505545038,3e3,50,"OAuthManagerInteractiveKpiEnabled gate is disabled. Not logging KPI.");if(i.ULS.sendTraceTag(505545037,3e3,50,`OAuthManagerInteractiveKpiSuccess: StartTime: ${e}, EndTime: ${t}`),!this.isInteractiveFlow(o))return;const g=this.getExtendedProperties(!1,e,t,n,a,o,r,s,l,c,u,p,null,null,null);g?T.Health.instance.recordKpiSuccess("OAuthManagerInteractive",g):i.ULS.sendTraceTag(505545036,3e3,50,"OAuthManagerInteractiveKpiSuccess: successKpiAdditionalValues is null. The KPI will not be logged.")}logInteractiveErrorKpi(e,t,n,a,o,r,s,l,c,u,p,g,h,m,_){if(!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerInteractiveKpiEnabled"))return void i.ULS.sendTraceTag(505545035,3e3,50,"OAuthManagerInteractiveKpiEnabled gate is disabled. Not logging KPI.");i.ULS.sendTraceTag(505545034,3e3,50,`OAuthManagerInteractiveKpiError: ${g}, StartTime: ${e}, EndTime: ${t}`);const S=this.getExtendedProperties(!0,e,t,n,a,o,r,s,l,c,u,p,h,m,_);S?T.Health.instance.recordKpiFailure("OAuthManagerInteractive",g,!1,!0,S):i.ULS.sendTraceTag(505545033,3e3,50,"OAuthManagerInteractiveKpiFailure: failureKpiAdditionalValues is null. The KPI will not be logged.")}logInitSuccessKpi(e,t){if(!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerInitKpiEnabled"))return void i.ULS.sendTraceTag(505545032,3e3,50,"OAuthManagerInitKpiEnabled gate is disabled. Not logging KPI.");i.ULS.sendTraceTag(505545031,3e3,50,`OAuthManagerInitKpiSuccess: StartTime: ${e}, EndTime: ${t}`);const n=v.a.createExtendedPropertiesMap();if(null!=n){n.set("StartTime",e.toString()),n.set("EndTime",t.toString()),n.set("AuthLibrary",this.getAuthStrategyName());const a=Object.assign({},{durationMs:Math.floor(I.a.getTickCount()-e),extendedProperties:n});T.Health.instance.recordKpiSuccess("OAuthManagerInit",a)}}logInitErrorKpi(e,t,n){if(!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerInitKpiEnabled"))return void i.ULS.sendTraceTag(505684047,3e3,50,"OAuthManagerInitKpiEnabled gate is disabled. Not logging KPI.");i.ULS.sendTraceTag(505684046,3e3,50,`OAuthManagerInitKpiError: ${n}, StartTime: ${e}, EndTime: ${t}`);const a=v.a.createExtendedPropertiesMap();if(null!=a){a.set("StartTime",e.toString()),a.set("EndTime",t.toString()),a.set("AuthLibrary",this.getAuthStrategyName());const i=Object.assign({},{durationMs:Math.floor(I.a.getTickCount()-e),extendedProperties:a});T.Health.instance.recordKpiFailure("OAuthManagerInit",n,!1,!0,i)}}logInitUsageKpi(e,t){if(!d.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OAuthManagerInitKpiEnabled"))return void i.ULS.sendTraceTag(505684045,3e3,50,"OAuthManagerInitKpiEnabled gate is disabled. Not logging KPI.");i.ULS.sendTraceTag(505684044,3e3,50,`OAuthManagerInitUsage: StartTime: ${e}, EndTime: ${t}`);const n=v.a.createExtendedPropertiesMap();null!=n&&(n.set("StartTime",e.toString()),n.set("EndTime",t.toString()),n.set("AuthLibrary",this.getAuthStrategyName()),T.Health.instance.recordKpiUsageForAlertableKpi("OAuthManagerInit","WacOAuthFC",n))}constructor(e=null){this._authSupportStatus=0,this._authTokenStrategy=null,this._requestCount=0,this._isPerfAutomation=(0,Z.a)(),this._interactionInProgress=!1,this._initAttempts=0,this._initSuccessful=!1,this._hasVisibilityStateChanged=!1,this.silentKpisLoggedPerSession=new Map;const t=I.a.getTickCount(),n=new s.a;n.ErrorCode=J.NoResultError,this._resolveITPErrorPromise=Promise.resolve(n),this._successfullyAcquiredTokens=new Map;const a=new D;a.startTime=I.a.getTickCount();const i=new Promise(((e,t)=>{a.resolve=e,a.reject=t}));a.basePromise=i,this._popupPromise=a,document.addEventListener("visibilitychange",(()=>{this._hasVisibilityStateChanged=!0,this._initAttempts<u.a.maxInitRetries&&this.initOAuthManager(e,t)})),this.initOAuthManager(e,t)}}J.authLibrary_TokenRenewalError="token_renewal_error",J.authLibrary_MonitorWindowTimeoutErrorCode="monitor_window_timeout",J.authLibrary_ITPError="login_required",J.authLibrary_PopupBlockedError="popup_window_error",J.authLibrary_ConsentRequiredError="consent_required",J.authLibrary_InvalidGrantError="invalid_grant",J.authLibrary_UserCancelled="user_cancelled",J.authLibrary_InteractionRequiredError="interaction_required",J.authLibrary_BadTokenError="bad_token",J.authLibrary_NoTokenFoundError="no_token_found",J.authLibrary_RefreshTokenExpiredError="refresh_token_expired",J.authLibrary_NativeAccountUnavailable="native_account_unavailable",J.authLibrary_NoNetworkConnectivityError="no_network_connectivity",J.authLibrary_EndpointsResolutionError="endpoints_resolution_error",J.authLibrary_AuthorizationCodeMissingError="authorization_code_missing_from_server_response",J.authLibrary_StateNotFoundError="stated_not_found",J.authLibrary_PostRequestFailedError="post_request_failed",J.authStrategy_TimeoutErrorCode="authTokenStrategy_timeout",J.TimeoutError="Timeout",J.ThirdPartyCookiesBlockedError="Cookies Disabled",J.InteractionRequiredError="UserInteractionRequired",J.ExceptionError="Exception",J.NoResultError="NoResult",J.RejectTokenError="RejectToken",J.UserCancelledError="UserCancelled",J.InteractiveFlowInProgressError="interactive_flow_in_progress",J.RetryRequiredError="RetryRequired",J.maxRetriesOnTimeout=2,(0,a.a)(J,"OAuthManager",null,[443])},9011:function(e,t,n){"use strict";n.r(t),n.d(t,{SharedAuthConsentDialog:function(){return p}});var a=n(100),i=n(1212),o=n(8555),r=n(8103),s=n(8779),l=n(3245),c=n(3563),d=n(8829);const u="SharedAuthInteractiveFrame";class p extends c.CustomDialog{showAndFocus(){if(this._useReactDialog){const e=this._promptInfo.imageSrc&&"null"!==this._promptInfo.imageSrc?"An abstract illustration":"",t={promptMessage:this._message,errorText:(0,r.a)("InternalError"),rtl:l.AFrameworkApplication.isRtl,frameLoaded:!1,createFrame:this.createFrame,resolveDialogStyles:this._dialogStylesPromiseResolve,imageProps:{src:this._promptInfo.imageSrc,alt:e},title:this._title};this._controlValues$4={id:this._promptInfo.useWelcomeDialog?"WelcomeToUnauthenticatedEditDialog":"SharedAuthConsentDialog",bodyControls:t}}this.initializeAndShow(this._title,this.sharedAuthConsentDialogHandler,this._controlValues$4),this._useReactDialog||this._body.append(this.createLegacyDialogBody(l.AFrameworkApplication.isRtl))}updateProps(e=!1,t=!1,n=5){this._controlValues$4&&this._controlValues$4.bodyControls&&(e!==(0,o.a)(Object,this._controlValues$4.bodyControls).frameLoaded&&((0,o.a)(Object,this._controlValues$4.bodyControls).frameLoaded=e),t!==(0,o.a)(Object,this._controlValues$4.bodyControls).frameLoadSuccess&&((0,o.a)(Object,this._controlValues$4.bodyControls).frameLoadSuccess=t),n!==this._controlValues$4.dialogButtonsOption&&(this._controlValues$4.dialogButtonsOption=null,this.buttonsOption=n),this.update(this._controlValues$4))}showSignInCancelButtons(e,t){const n=new s.a(i.a.showSignInCancelButtons),a={signInLabel:this._signInLabel,cancelLabel:this._cancelLabel,rtl:l.AFrameworkApplication.isRtl,messageCorrelationId:e,dialogStyles:t,isLegacy:!this._useReactDialog,fluentVersion:"V8",buttonOrientation:this._promptInfo.signInCancelButtonsOrientation};n.Values=a,this._crossDocumentMessenger.sendToWindow(n,this._sharedAuthFrame.contentWindow,this._sharedFrameOrigin)}forceShowError(){this.updateProps(!0,!1,6)}get sharedAuthFrame(){return this._sharedAuthFrame}get dialogStylesPromise(){return this._useReactDialog?this._dialogStylesPromise.then((e=>(this._dialogStylesRetrieved=!0,e))):(this._dialogStylesRetrieved=!0,Promise.resolve(void 0))}get dialogStylesRetrieved(){return this._dialogStylesRetrieved}createLegacyDialogBody(e){const t=document.createElement("div");t.id="WACDialogTextPanel",t.className="WACDialogTextPanel";const n=document.createElement("div");n.id="WACDialogTextContent",n.innerText=this._message,t.appendChild(n);const a=document.createElement("section");a.id="sharedAuthFrameOuterContainer";const i=document.createElement("div");i.id="sharedAuthFrameInnerContainer",i.style.display="flex",i.style.justifyContent=e?"left":"right",i.appendChild(this._sharedAuthFrame),a.appendChild(i);const o=document.createElement("div");return o.className="WACDialogRow",o.appendChild(t),o.appendChild(a),o}constructor(e,t,n,a,i,o){super(!1,!1,!0),this._controlValues$4=null,this._dialogStylesPromiseResolve=null,this.onSharedAuthFrameError=e=>{this.forceShowError()},this.createFrame=()=>this._sharedAuthFrame,this.sharedAuthConsentDialogHandler=(e,t)=>{0===e&&(this._tryGetTokenPromise.reject(Object.assign(new d.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this._interactiveFlowResolve(null))},this._sharedFrameOrigin=t,this._promptInfo=n,this._title=n.title||(0,r.a)("SignIn"),this._message=n.message||(0,r.a)("WAC_OAuth_CompleteSignIn_Body"),this._cancelLabel=n.cancelLabel||(0,r.a)("DialogCancel"),this._signInLabel=n.useWelcomeDialog?(0,r.a)("SignInNow"):(0,r.a)("SignIn"),this._crossDocumentMessenger=a,this._tryGetTokenPromise=i,this._interactiveFlowResolve=o,this._sharedAuthFrame=document.createElement("iframe"),this._sharedAuthFrame.id=u,this._sharedAuthFrame.setAttribute("name",u),this._sharedAuthFrame.setAttribute("title",u),this._sharedAuthFrame.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups"),this._sharedAuthFrame.style.border="0",this._sharedAuthFrame.style.height="vertical"===n?.signInCancelButtonsOrientation?"96px":"48px",this._sharedAuthFrame.style.width="100%",$addHandler(this._sharedAuthFrame,"error",this.onSharedAuthFrameError),this._sharedAuthFrame.src=e,this._dialogStylesPromise=new Promise((e=>{this._dialogStylesPromiseResolve=e})),this._dialogStylesRetrieved=!1,this.hasButtonPanel=!1,this.buttonsOption=5}}(0,a.a)(p,"SharedAuthConsentDialog",c.CustomDialog,[311])},2813:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var a,i=n(100);!function(e){e[e.unknown=0]="unknown",e[e.supported=1]="supported",e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous",e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint",e[e.hostUnsupported=4]="hostUnsupported",e[e.perfAutomation=5]="perfAutomation"}(a||(a={})),(0,i.b)("SupportStatus",a)},9246:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(5149);class o{static setTokenExpiration(e,t){return this._tokenToExpirationTime.set(e,t)}static deleteTokenExpiration(e){return this._tokenToExpirationTime.delete(e)}static isTokenExpirationTimeKnown(e){return!!o.getTokenExpirationTime(e)}static isTokenUnexpired(e){const t=o.getTokenExpirationTime(e);return t?!(t<=Date.now())||(i.ULS.sendTraceTag(505702491,3e3,15,"TokenRefreshManager: Token is expired."),!1):(i.ULS.sendTraceTag(505742728,3e3,100,"TokenRefreshManager: Token is missing expiration time."),!1)}static getTokenExpirationTime(e){if(e){const t=e.startsWith("Bearer ")?e.substring(7):e;return o._tokenToExpirationTime.get(t)}}}o._tokenToExpirationTime=new Map,(0,a.a)(o,"TokenRefreshManagerUtils",null,[])},7646:function(e,t,n){"use strict";n.d(t,{a:function(){return l}});var a=n(100),i=n(5149),o=n(1962),r=n(4913),s=n(4908);class l extends o.a{static initializeBrowserUlsImpl(){s.a.sendTraceTag=l.sendTraceTagImpl,s.a.debugAssertTag=l.debugAssertTagImpl}static sendTraceTagImpl(e,t,n,...a){i.ULS.sendTraceTag.apply(null,[e,204,l.crmToUlsLevel(t),n].concat(a))}static debugAssertTagImpl(e,t,n=null,...a){0}static crmToUlsLevel(e){switch(e){case 0:return 200;case 1:default:return 100;case 2:return 50;case 4:return 15;case 3:return 10}}constructor(e,t,n=null){super(e,t,n||r.a.instance,l.initializeBrowserUlsImpl)}}l.previousSessionParamName="wdPreviousSession",l.currentSessionParamName="wdUserSession",(0,a.a)(l,"CommonCrossDocumentMessenger",o.a,[])},4913:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(3299),o=n(3245),r=n(6012),s=n(7296);class l{constructor(e,t,n,a=null){this.origin=e,this.data=t,this.source=n,this.innerEvent=a}}(0,a.a)(l,"MessageEventArgs",null,[]);class c{get theWindowEventManager(){return this._windowEventManager.value}get taskManager(){return this._taskManager.value}attachHandler(e,t){this._messageHandler=e,this._windowEventHandler=this.postMessageEventHandler,this.theWindowEventManager.addHandler(r.a.message,this._windowEventHandler,t)}detachHandler(e){this._messageHandler=null,this.theWindowEventManager.removeHandler(r.a.message,this._windowEventHandler)}invokeCallback(e,t){const n=new s.a(0,1,1,(n=>{e(t)}),7);this.taskManager.addTask(n)}invokeEventCallback(e,t){const n=new s.a(0,1,1,(n=>{e(t)}),7);this.taskManager.addTask(n)}static get instance(){return c.getAnInstanceWithResolvedDependecies()}static getAnInstanceWithResolvedDependecies(){return new c(new i.a((()=>o.AFrameworkApplication.theWindowEventManager)),new i.a((()=>o.AFrameworkApplication.theTaskManager)))}constructor(e,t){this._windowEventHandler=null,this.postMessageEventHandler=e=>!!this._messageHandler&&this._messageHandler(new l(e.origin,e.data,e.source,e.innerEvent)),this._windowEventManager=e,this._taskManager=t,this._messageHandler=null}}(0,a.a)(c,"MessageEventHandler",null,[258])},4555:function(e,t,n){"use strict";n.d(t,{a:function(){return A}});var a=n(100),i=n(5149),o=n(7646),r=n(3245),s=n(629),l=n(1891),c=n(680),d=n(965),u=n(9969),p=n(7958),g=n(1962),h=n(9611),m=n(988);class _ extends o.a{tryGrabFocus(){return!(!s.FocusManager.instance()||!s.FocusManager.instance().currentScope||s.FocusManager.instance().currentScope.name!==r.AFrameworkApplication.postmessageFocusId)&&(s.FocusManager.instance().popScope(s.FocusManager.instance().currentScope.name),!0)}hostBlurFocusHandler(e){if(s.FocusManager.instance().pushScope(r.AFrameworkApplication.postmessageFocusId,!1),"ShareCorrelation"in e.Values){const t={};t.ShareCorrelation=e.Values.ShareCorrelation,i.ULS.sendTraceTag(38278996,204,50,d.c(t))}}hostPerfMessageHandler(e){if(!!u.a.getParameterValue(document.URL,r.AFrameworkApplication.modeSwitchTimeParamName))return;if(!e.Values)return void 0;let t=0,n=0;try{t=e.Values.Click,n=e.Values.Iframe,"FetchStart"in e.Values?this._hostPageFetchStartTime=e.Values.FetchStart:"HostFrameFetchStart"in e.Values&&(this._hostPageFetchStartTime=e.Values.HostFrameFetchStart),"RedirectCount"in e.Values&&(this._hostPageRedirectCount=e.Values.RedirectCount)}catch(e){return void 0}this._hostClickTime=t,this._hostIframeTime=n,this._documentLoadedTime&&this.logHostPerfSqm()}jsApiDiagnosticsHandler(e){i.ULS.sendTraceTag(37536415,204,50,"JsApiDiagnostics");const t=e.Values.HostInitializeDiagnostics;t&&l.a.instance.recordHostInitDiagnostics(t);const n=e.Values.ClientDiagnostics;n&&l.a.instance.recordClientDiagnostics(n);const a=e.Values.JsApiDiagnostics;a&&l.a.instance.recordJsApiDiagnostics(a)}beforeUnloadAppHandler(e){i.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",Date.now()),r.AFrameworkApplication.isShuttingDownFromPostMessage=!0,r.AFrameworkApplication.activeFrame.thePageManager.onBeforeNavigate(e.eventArgs.innerEvent)}unloadAppHandler(e){i.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now()),r.AFrameworkApplication.activeFrame.thePageManager.onNavigate(null,Sys.EventArgs.Empty)}logHostPerfSqm(){this.logHostClickTimeSqm(),this.logHostIFrameSqm(),null!=this._hostPageFetchStartTime&&l.a.instance.recordHostPageFetchStart(this._hostPageFetchStartTime),null!=this._hostPageRedirectCount&&l.a.instance.recordHostPageRedirectCount(this._hostPageRedirectCount)}logHostClickTimeSqm(){if(!this._documentLoadedTime||!this._hostClickTime||this._hostClickTimeReported)return;if(this._hostClickTimeReported=!0,this._hostClickTime>this._documentLoadedTime)return void 0;const e=this._documentLoadedTime-this._hostClickTime;r.AFrameworkApplication.theWsaClient.setDw(10324,e),l.a.instance.recordUserClickedInHostUi(this._hostClickTime)}logHostIFrameSqm(){if(!this._documentLoadedTime||!this._hostIframeTime||this._hostIFrameTimeReported)return;if(this._hostIFrameTimeReported=!0,this._hostIframeTime>this._documentLoadedTime)return void 0;const e=this._documentLoadedTime-this._hostIframeTime;r.AFrameworkApplication.theWsaClient.setDw(10325,e),l.a.instance.recordWacIframeGeneratedInHost(this._hostIframeTime)}reportBrowserFetchStartToLoadBsqm(){const e=p.a.getWindowPerformanceTimingObject();if(!e)return;let t=0;const n=e.fetchStart;if(null!=n&&(t=n),t<=0||t>this._documentLoadedTime)return;const a=this._documentLoadedTime-t;r.AFrameworkApplication.theWsaClient.setDw(11045,a)}create(){r.AFrameworkApplication.isCrossDocumentMessengerDisabled&&this.disable(),this.targetOrigin!==g.a.anyDomain&&this.addAllowedOrigin(this.targetOrigin),this._actionManager.addActionWithFlags(m.a.disposeCrossDocumentMessenger,h.a.frame,this.disposeInstance,96),this.addAllowedReceivingMessage("BlurFocus"),this.addAllowedReceivingMessage("Blur_Focus"),this.addAllowedReceivingMessage("GrabFocus"),this.addAllowedReceivingMessage("Grab_Focus"),this.addAllowedReceivingMessage("Host_PerfTiming"),this.addAllowedReceivingMessage("Host_RefreshSessionInfo"),this.addAllowedReceivingMessage("App_RefreshSessionInfo");const e=this.hostMessageHandler;if(this.registerEventCallback("BlurFocus",e),this.registerEventCallback("Blur_Focus",e),this.registerEventCallback("GrabFocus",e),this.registerEventCallback("Grab_Focus",e),this.registerEventCallback("Host_PerfTiming",e),r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteEmbedUnloadIsEnabled")&&(this.addAllowedFreeReceivingMessage("Wac_BeforeUnloadApp"),this.addAllowedFreeReceivingMessage("Wac_UnloadApp"),this.registerEventCallback("Wac_BeforeUnloadApp",e),this.registerEventCallback("Wac_UnloadApp",e)),r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PostMessageEmbedded")||r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApi")){this.addAllowedReceivingMessage("Host_Unload");const e=this.uiHostMessageHandler;r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SupportsAccessibilityLoop")&&(this.addAllowedReceivingMessage("Host_AccessibilityLoopComplete"),this.registerCallback("Host_AccessibilityLoopComplete",e)),this.registerCallback("Host_Unload",e),r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MobileEmbedViewerIsEnabled")&&(this.addAllowedReceivingMessage("Host_GetClientUrl"),this.registerCallback("Host_GetClientUrl",e),this.addAllowedReceivingMessage("Host_BackButtonPressed"),this.registerCallback("Host_BackButtonPressed",e),this.addAllowedReceivingMessage("Host_CopyLink"),this.registerCallback("Host_CopyLink",e),this.addAllowedReceivingMessage("Host_GetWebUrl"),this.registerCallback("Host_GetWebUrl",e)),r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.addAllowedReceivingMessage("Host_SendChannelId"),this.registerCallback("Host_SendChannelId",e))}r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApi")&&(this.addAllowedReceivingMessage("JsApiDiagnostics"),this.registerEventCallback("JsApiDiagnostics",e))}reportDocumentLoadedTime(e){this._hostDocumentLoadedTimeReported||(this._documentLoadedTime=e,this.reportBrowserFetchStartToLoadBsqm(),this.targetOrigin!==g.a.anyDomain&&this.sendMessage("App_LoadingStatus",{DocumentLoadedTime:e}),this.logHostPerfSqm(),this._hostDocumentLoadedTimeReported=!0)}constructor(e,t,n,a){super(e,t,n),this._documentLoadedTime=0,this._hostClickTime=0,this._hostClickTimeReported=!1,this._hostIframeTime=0,this._hostPageFetchStartTime=null,this._hostPageRedirectCount=null,this._hostIFrameTimeReported=!1,this._hostDocumentLoadedTimeReported=!1,this.hostMessageHandler=e=>{const t=e.message,n=e.eventArgs.origin;switch(r.AFrameworkApplication.wopiHostOriginFromPostMessage||(r.AFrameworkApplication.wopiHostOriginFromPostMessage=n),t.MessageId){case"BlurFocus":case"Blur_Focus":this.hostBlurFocusHandler(t);break;case"GrabFocus":case"Grab_Focus":this.tryGrabFocus();break;case"Host_PerfTiming":this.hostPerfMessageHandler(t);break;case"JsApiDiagnostics":this.jsApiDiagnosticsHandler(t);break;case"Wac_BeforeUnloadApp":this.beforeUnloadAppHandler(e);break;case"Wac_UnloadApp":this.unloadAppHandler(e)}},this.uiHostMessageHandler=e=>{switch(e.MessageId){case"Host_AccessibilityLoopComplete":r.AFrameworkApplication.theActionManager.processActionWithData(m.a.resumeFocusWithDirection,2,e.Values.Direction);break;case"Host_Unload":i.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received"),r.AFrameworkApplication.theActionManager.processActionWithData(m.a.hostUnload,2,(new Date).getTime());break;case"Host_BackButtonPressed":i.ULS.sendTraceTag(544221062,204,50,"We received HostBackButtonPressed message in WAC"),r.AFrameworkApplication.activeFrame.applicationInstance.handleHostBackButton();break;case"Host_GetClientUrl":i.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved"),r.AFrameworkApplication.theActionManager.processAction(m.a.getClientUrl,2);break;case"Host_CopyLink":i.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved"),r.AFrameworkApplication.theActionManager.processAction(m.a.hostCopyLink,2);break;case"Host_GetWebUrl":i.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received"),r.AFrameworkApplication.theActionManager.processAction(m.a.getWebUrl,2);break;case"Host_SendChannelId":i.ULS.sendTraceTag(537424842,204,50,"Host_SendChannelId Received"),r.AFrameworkApplication.activeFrame.applicationInstance.saveHostChannelId(e)}},this.disposeInstance=(e,t,n,a,i)=>(2!==n||c.a.safeDispose(this),32),this._actionManager=a,this._name="HostIntegrationMessenger",this.create()}}(0,a.a)(_,"HostIntegrationMessenger",o.a,[138,135,11]);var S=n(3792),f=n(4051),C=n(4913),y=n(2650);const A=(0,S.e)(y.a,{onDemandRegister:(e,t)=>e.register(_,t).singleInstance().usingFactory((()=>{r.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady||i.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const e=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("PostMessageOrigin");i.ULS.sendTraceTag(506278049,204,50,"PostMessageOrigin (1) from hostAppSettings {0} (2) from InitialAppSettings {1}",r.AFrameworkApplication.postMessageOrigin,e);const t=r.AFrameworkApplication.postMessageOrigin?r.AFrameworkApplication.postMessageOrigin:e||g.a.anyDomain;return i.ULS.sendTraceTag(536987587,204,50,"HostIntegrationMessenger instantiating"),new _(window.parent,t,C.a.instance,r.AFrameworkApplication.theActionManager)})),_ignoreOnDemandRegister:(0,f.a)(9374681)})},815:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(3245);function i(){return((a.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("SessionExpirationManagerV2IsEnabled")??!1)||(a.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.SessionTokenRefreshIsEnabledForViewer",!1)??!1))&&a.AFrameworkApplication.isWopiTokenRefreshEnabled&&a.AFrameworkApplication.isWopiTokenRefreshWhenSessionExpiredEnabled&&2==a.AFrameworkApplication.wopiTokenExpirationPolicy}},4238:function(e,t,n){"use strict";n.d(t,{a:function(){return te}});var a=n(100),i=n(5149),o=n(625),r=n(3299),s=n(3245),l=n(8599),c=n(1779);class d{get regionNames(){return this._regionNames||(this._regionNames=new l.a(c.a.get_ordinalIgnoreCase()),this._regionNames.add("Header","Header"),this._regionNames.add("Ribbon","Ribbon"),this._regionNames.add("NotificationBar","NotificationBar"),this._regionNames.add("BusinessBar","BusinessBar"),this._regionNames.add("Canvas","Canvas"),this._regionNames.add("FarPane","FarPane"),this._regionNames.add("StatusBar","StatusBar"),this._regionNames.add("Ruler","Ruler")),this._regionNames}getRegion(e){return null}registerBoundingWindowRectsChanged(e,t){}unregisterBoundingWindowRectsChanged(e,t){}registerLayoutBreakpointChanged(e,t){}unregisterLayoutBreakpointChanged(e){}getLayoutBreakpoint(){return"Default"}getWindowMode(){return"undefined"}getKeyboardSegment(){return null}getWindowRectsWithoutKeyboard(){return null}show(e=null){}constructor(){this._regionNames=null}}(0,a.a)(d,"AAdaptiveLayout",null,[42]);class u extends d{constructor(){super()}}(0,a.a)(u,"AdaptiveLayoutEmptyImpl",d,[]);var p=n(3998);class g{constructor(){this.selector=null,this.definition=null,this.index=0}}(0,a.a)(g,"CssRule",null,[]);class h{get style(){return this._broswerRule.style}get selectorText(){return this._broswerRule.selectorText}get parentSheet(){return this._parentSheet}get isReadOnly(){return this._readOnly}constructor(e,t,n,a){this._model=e,this._broswerRule=t,this._parentSheet=n,this._readOnly=a}}(0,a.a)(h,"StyleRule",null,[]);var m=n(7531),_=n(7296);class S{dispose(){this._styleElement=null,this._browserSheet=null,this._ownerDocument=null}remove(){this._browserSheet&&this._styleElement&&this._styleElement.parentNode.removeChild(this._styleElement)}addLoadHandler(e){e&&(this._loaded?e(this):(Array.add(this._onLoadCallbacks,e),this._styleElementOnLoad||(this._styleElementOnLoad=this.onLoad,m.a.addHandler(this._styleElement,"load",this._styleElementOnLoad))))}addRule(e,t,n){if(t&&!t.length)throw Error.argument("css definition must be valid css or null");switch(i.ULS.shipAssertTag(17154717,324,this._loaded&&!!this._browserSheet),this._model){case 1:this._browserSheet.addRule(e,t,n);break;case 2:if(this._browserSheet){const a=t||"";this._browserSheet.insertRule(e+" {"+a+"}",n)}else{if(!this._loaded&&this._retryAttempts<5){const a=new g;a.selector=e,a.definition=t,a.index=n,Array.add(this._pendingCssRules,a)}i.ULS.sendTraceTag(17342615,324,15,"Fail to insert Css Rule since _brwoserSheet is null. selector={0} definition={1} index={2} _retryAttempts={3}",e,t,n,this._retryAttempts)}break;default:throw Error.invalidOperation("Unknown stylesheet model detected.")}}removeRule(e){switch(i.ULS.shipAssertTag(17154718,324,this._loaded&&!!this._browserSheet),this._model){case 1:this._browserSheet.removeRule(e);break;case 2:this._browserSheet.deleteRule(e)}}getRuleCount(){switch(i.ULS.shipAssertTag(17154719,324,this._loaded&&!!this._browserSheet),this._model){case 1:return this._browserSheet.rules.length;case 2:return this._browserSheet.cssRules.length;default:throw Error.invalidOperation("Unknown stylesheet model detected.")}}getRule(e){let t;switch(i.ULS.shipAssertTag(17154720,324,this._loaded&&!!this._browserSheet),this._model){case 1:return t=this._browserSheet.rules.item(e),t?new h(1,t,this,this._readOnly):null;case 2:return t=this._browserSheet.cssRules[e],t?new h(1,t,this,this._readOnly):null;default:throw Error.invalidOperation("Unknown stylesheet model detected.")}}get styleElement(){return this._styleElement}get isReadOnly(){return this._readOnly}get isLoaded(){return this._loaded}createFindhCallbackTask(){const e=new _.a(2,1,this._retryDelay,this.findSheet,11);s.AFrameworkApplication.theTaskManager.addTask(e)}static createStyleSheet(e,t=null){return S.createOrImportStyleSheet(e,t)}static importStyleSheet(e,t,n){return S.createOrImportStyleSheet(e,n,t)}static createOrImportStyleSheet(e,t,n=null){let a=null;return e.createStyleSheet?a=S.createStylesheetUsingCreateStyleSheetFunction(e,n,t):e.styleSheets&&(a=S.createStylesheetUsingStyleSheetsCollection(e,n,t)),a}static createStylesheetUsingCreateStyleSheetFunction(e,t,n){const a=t?e.createStyleSheet(t):e.createStyleSheet(),i=new S(e,1,a,a.owningElement,!!t);return n&&i.addLoadHandler(n),i}static createStylesheetUsingStyleSheetsCollection(e,t,n){const a=t?S.createLinkElement(e,t):S.createStyleElement(e),i=new S(e,2,null,a,!!t);return e.getElementsByTagName("head")[0].appendChild(a),S.attemptToLoadSheet(e,i,a,n),i}static createLinkElement(e,t){const n=e.createElement("link");return n.rel="stylesheet",n.href=t,n.type="text/css",n}static createStyleElement(e){const t=e.createElement("style"),n=e.createTextNode(" ");return t.appendChild(n),t}static attemptToLoadSheet(e,t,n,a){const i=e.styleSheets;for(let e=0;e<i.length;e++){if(n===i[e].ownerNode){t._browserSheet=i[e],t.addLoadHandler(a);const n=new _.a(0,1,0,(e=>{t.onLoad(null)}),10);0,s.AFrameworkApplication.theTaskManager.addTask(n)}}t._browserSheet||(t._retryDelay=100,t._loaded=!1,t.addLoadHandler(a),t.createFindhCallbackTask())}static importStyleSheetFromText(e){try{const t=document.createElement("style");return t.type="text/css",t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t),t}catch(t){i.ULS.sendTraceTag(40137891,210,10,"ImportStyleSheetFromText error message : {0}.",t.message);const n=document.createStyleSheet();return n.cssText=e,n.owningElement}}constructor(e,t,n,a,o){this._styleElementOnLoad=null,this._retryDelay=0,this._retryAttempts=0,this.onLoad=e=>{if(this._browserSheet){this._loaded=!0;for(let e=0;e<this._onLoadCallbacks.length;e++){(0,this._onLoadCallbacks[e])(this)}Array.clear(this._onLoadCallbacks),this._styleElementOnLoad&&(m.a.removeHandler(this._styleElement,"load",this._styleElementOnLoad),this._styleElementOnLoad=null);for(let e=0;e<this._pendingCssRules.length;e++){const t=this._pendingCssRules[e],n=t.definition||"";this._browserSheet.insertRule(t.selector+" {"+n+"}",t.index)}Array.clear(this._pendingCssRules)}},this.findSheet=e=>{const t=this._ownerDocument.styleSheets;for(let e=0;e<t.length;e++){const n=t[e].ownerNode;if(this._styleElement===n)return this._browserSheet=t[e],void this.onLoad(null)}++this._retryAttempts<5?(this._retryDelay*=3,this.createFindhCallbackTask()):i.ULS.sendTraceTag(17154721,324,10,"Failed to load stylesheet after max retry attempts, abandoning search")},this._onLoadCallbacks=[],this._ownerDocument=e,this._model=t,this._browserSheet=n,this._styleElement=a,this._readOnly=o,this._loaded=!o,this._pendingCssRules=[]}}(0,a.a)(S,"StyleSheet",null,[11]);var f=n(9123),C=n(680);class y{dispose(){C.a.safeDispose(this._styleSheet),this._styleSheet=null,this._controlledElement=null}setCursor(e){switch(e){case 1:this.setCursorString("crosshair");break;case 2:this.setCursorString("pointer");break;case 3:this.setCursorString("move");break;case 4:this.setCursorString("e-resize");break;case 5:this.setCursorString("ne-resize");break;case 6:this.setCursorString("nw-resize");break;case 7:this.setCursorString("n-resize");break;case 8:this.setCursorString("se-resize");break;case 9:this.setCursorString("sw-resize");break;case 10:this.setCursorString("s-resize");break;case 11:this.setCursorString("w-resize");break;case 12:this.setCursorString("text");break;case 13:this.setCursorString("wait");break;case 14:this.setCursorString("help");break;case 20:this.setCursorString("col-resize");break;case 21:this.setCursorString("row-resize");break;case 15:this.setCursorString("not-allowed");break;case 22:this.setCursorString("default");break;case 23:this.setCursorString("grabbing")}}setCursorUrl(e,t){let n;switch(t){case 1:n="crosshair";break;case 2:n="pointer";break;case 3:n="move";break;case 4:n="e-resize";break;case 5:n="ne-resize";break;case 6:n="nw-resize";break;case 7:n="n-resize";break;case 8:n="se-resize";break;case 9:n="sw-resize";break;case 10:n="s-resize";break;case 11:n="w-resize";break;case 12:n="text";break;case 13:n="wait";break;case 14:n="help";break;case 20:n="col-resize";break;case 21:n="row-resize";break;case 22:n="default";break;default:return void 0}this.setCursorString("url('"+e+"'), "+n)}resetCursor(){this.ensureCssIsLoaded((()=>{if(3===this._cssState){for(let e=0;e<this._numCssRules;++e)this.updateCssRuleCursorStyleSafe("",e);this._cssState=2}}))}pinCursor(e){const t=f.a.getCurrentStyle(e);t&&this.setCursorString(t.cursor)}setCursorString(e){this.ensureCssIsLoaded((()=>{if(2===this._cssState){for(let t=0;t<this._numCssRules;++t)this.updateCssRuleCursorStyleSafe(e,t);this._cssState=3}}))}updateCssRuleCursorStyleSafe(e,t){let n=null;try{n=this._styleSheet.getRule(t)}catch(e){i.ULS.sendTraceTag(17342976,324,15,"GetRule({0}) threw an exception:{1}.",t,e.message)}n?n.style.cursor=e:this.monitorNullCssRuleError(t)}monitorNullCssRuleError(e){if(this._rulesErrorFirstHitTime<=0)this._rulesErrorFirstHitTime=Date.now(),i.ULS.sendTraceTag(17342977,324,15,"GetRule({0}) returned null.",e);else if(!this._rulesErrorLogged){const t=(Date.now()-this._rulesErrorFirstHitTime)/1e3;t>30&&(i.ULS.sendTraceTag(17342978,324,10,"GetRule({0}) still returns null, causing improper cursor/drag experience, {1} seconds after first hit!",e,t),this._rulesErrorLogged=!0)}}ensureCssIsLoaded(e){0===this._cssState?this.createStylesheet(e):e()}createStylesheet(e){this._styleSheet=S.createStyleSheet(this._controlledElement.ownerDocument,(t=>{this._styleSheet=t;for(let e=0,t=this._selectors.length;e<t;++e)this._styleSheet.addRule(this._selectors[e],null,e),this._numCssRules++;this._cssState=2,e()})),this._styleSheet||(this._cssState=1)}constructor(e){this._styleSheet=null,this._selectors=[],this._numCssRules=0,this._rulesErrorFirstHitTime=0,this._rulesErrorLogged=!1,this._cssState=0,this._controllerID=y._currentControllerCount++,this._controlledElement=e,this._selectorText="cursorControl"+this._controllerID,Array.addRange(this._selectors,["."+this._selectorText,"."+this._selectorText+" *"]),e.id&&""!==e.id&&Array.add(this._selectors,"#"+e.id+" *"),Sys.UI.DomElement.addCssClass(this._controlledElement,this._selectorText)}}y._currentControllerCount=0,(0,a.a)(y,"CursorManager",null,[71,11]);var A=n(8585),b=n(2929);class T extends b.a{constructor(e,t,n){super(e,t,n,1)}}(0,a.a)(T,"CompositionEventHandlerArgs",b.a,[]);var v=n(6012);class w{registerHandler(e,t,n,a){this._eventHandlerManager.registerHandler(e,t,2,this.onCompositionEvent,n,a)}unregisterHandler(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)}static isCompositionEventName(e){return e===v.a.compositionStart||e===v.a.compositionUpdate||e===v.a.compositionEnd}constructor(e){this.onCompositionEvent=(e,t,n)=>this._eventHandlerManager.processEvent(e,t,new T(e,t,n)),this._eventHandlerManager=e}}(0,a.a)(w,"CompositionEventManager",null,[]);var F=n(6808),I=n(6923),E=n(9865),M=n(629),k=n(2544),P=n(2217),D=n(9855);class R extends b.a{constructor(e,t,n){super(e,t,n,1),this.text=n.data}}(0,a.a)(R,"TextInputEventHandlerArgs",b.a,[]);class x{registerHandler(e,t,n,a){this._eventHandlerManager.registerHandler(e,t,2,this.onTextInputEvent,n,a)}unregisterHandler(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)}static isTextInputEventName(e){return e===v.a.textInput||e===v.a.input}constructor(e){this.onTextInputEvent=(e,t,n)=>this._eventHandlerManager.processEvent(e,t,new R(e,t,n)),this._eventHandlerManager=e}}(0,a.a)(x,"TextInputEventManager",null,[]);var L=n(4706),U=n(7905),O=n(7989),B=n(7072),N=n(2274),W=n(6124);class H{toString(){return String.format("ForegroundTextColor: {0}, BackgroundColor: {1}, LinkColor: {2}",this.foregroundTextColor,this.backgroundColor,this.linkColor)}constructor(){this.foregroundTextColor=null,this.backgroundColor=null,this.linkColor=null}}(0,a.a)(H,"HighContrastColors",null,[]);var V=n(9858);const G="screenReaderDetectionDiv";class Q{get isInHighContrastMode(){return this._isInHighContrastMode}get isScreenReaderPresent(){if(!this._isScreenReaderPresent&&(this.screenReaderDetector=document.getElementById(G),this.screenReaderDetector)){const e=f.a.getCurrentStyle(this.screenReaderDetector);e||i.ULS.sendTraceTag(25523334,334,50,"HighContrastDetector.IsScreenReaderPresent=false, current style is null"),this._isScreenReaderPresent=!!e&&-1===e.borderBottomStyle.toLowerCase().indexOf("dashed"),this._isScreenReaderPresent&&i.ULS.sendTraceTag(19137420,334,50,"HighContrastDetector.IsScreenReaderPresent=true")}return this._isScreenReaderPresent}get areAllHighContrastValuesValid(){return this._areAllHighContrastValuesValid}get highContrastColors(){return this._highContrastColors}get highContrastColorsQueryParameter(){return!this._highContrastColorsQueryParameter&&this._isInHighContrastMode&&this._highContrastColors&&this._areAllHighContrastValuesValid&&(this._highContrastColorsQueryParameter=String.format("{0}_{1}_{2}",this._highContrastColors.foregroundTextColor,this._highContrastColors.backgroundColor,this._highContrastColors.linkColor)),this._highContrastColorsQueryParameter}getNormalizedHighContrastHexValuesFromColor(e,t,n){let a,o,r;const s=({normalizedColor:a}=this.tryGetNormalizedColor(e)).returnValue,l=({normalizedColor:o}=this.tryGetNormalizedColor(t)).returnValue,c=({normalizedColor:r}=this.tryGetNormalizedColor(n)).returnValue;return s&&l&&c?Object.assign(new H,{backgroundColor:o,foregroundTextColor:a,linkColor:r}):(i.ULS.sendTraceTag(18458838,334,15,"Failed to parse system colors. isParsingForegroundTextColorSucceed({0}): {1}, isParsingBackgroundColorSucceed({2}): {3}, isParsingLinkColorSucceed({4}): {5}",s,e,l,t,c,n),null)}tryGetNormalizedColor(e){let t;return this._validColorPatternRegularExpression.test(e)?t=e:"transparent"===e||"window"===e?(t="transparent",this._areAllHighContrastValuesValid=!1):t=this.convertRgbRawToHex(e),{returnValue:!!t,normalizedColor:t}}convertRgbRawToHex(e){if(e.startsWith("rgb(")){const t=e.indexOf("("),n=e.indexOf(","),a=e.lastIndexOf(","),i=e.indexOf(")");if(-1!==t&&-1!==n&&-1!==a&&n!==a&&-1!==i){const o=e.substring(t+1,n),r=e.substring(n+1,a),s=e.substring(a+1,i);return this.convertRgbToHex(o,r,s)}}return null}convertRgbToHex(e,t,n){return"#"+(e=V.a.convertToHex(parseInt(e),2))+(t=V.a.convertToHex(parseInt(t),2))+(n=V.a.convertToHex(parseInt(n),2))}constructor(e){this._areAllHighContrastValuesValid=!0,this._validColorPatternRegularExpression=new RegExp("#[0-9A-Fa-f]{6}"),this._highContrastColors=null,this.screenReaderDetector=null,this._isScreenReaderPresent=!1,this._highContrastColorsQueryParameter=null,this._dummyStyleColor="rgb(50, 50, 50)",this._isNewHighContrastDetectionEnabled=N.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("HighContrastDetectionMechanism"),this._isHighContrastDetectorImprovementEnabled=N.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HighContrastDetectorImprovementEnabled",!1);const t=e.ownerDocument.createElement("div");t.id=Q.highContrastDetectionDivId,t.setAttribute(W.a.ariaRoleAttribute,W.a.ariaPresentationRole),t.setAttribute(W.a.ariaHiddenAttribute,W.a.ariaTrueValue);const n=e.ownerDocument.createElement("a");if(n.setAttribute("href","#"),n.id=Q.highContrastDetectionAnchorId,n.setAttribute(W.a.ariaRoleAttribute,W.a.ariaPresentationRole),n.setAttribute(W.a.ariaHiddenAttribute,W.a.ariaTrueValue),t.appendChild(n),this._isHighContrastDetectorImprovementEnabled){e.appendChild(t);const a=f.a.getCurrentStyle(t),o=f.a.getCurrentStyle(n),r=window.matchMedia("(forced-colors: active)").matches;this._isInHighContrastMode=r,a&&o||i.ULS.sendTraceTag(25523335,334,50,"HighContrastDetector foregroundBackgroundCurrentStyle is null:[{0}] and linkCurrentStyle is null:[{1}]",!a,!o),this._isInHighContrastMode&&(this._highContrastColors=a?this.getNormalizedHighContrastHexValuesFromColor(a.color.toLowerCase(),a.backgroundColor.toLowerCase(),o.color.toLowerCase()):null,this._areAllHighContrastValuesValid||i.ULS.sendTraceTag(19223450,334,15,"We believe the user is in high contrast mode, but encountered an invalid color value (transparent or window)")),i.ULS.sendTraceTag(18458837,334,50,"HighContrastDetector.ctor: IsInHighContrastMode=[{0}], HighContrastColors=[{1}]",this._isInHighContrastMode,this._highContrastColors);const s=e.ownerDocument.createElement("div");s.id=G,s.setAttribute(W.a.ariaRoleAttribute,W.a.ariaPresentationRole),s.setAttribute(W.a.ariaHiddenAttribute,W.a.ariaTrueValue),window.requestAnimationFrame((()=>{e.removeChild(t),e.appendChild(s)}))}else{this._isNewHighContrastDetectionEnabled&&f.a.setStyle(t,"color",this._dummyStyleColor),e.appendChild(t);const a=f.a.getCurrentStyle(t),o=f.a.getCurrentStyle(n),r=!!o&&-1===o.backgroundImage.toLowerCase().indexOf(Q.highContrastDetectionAnchorDefaultBackgroundImageName);let s=!1;!r&&this._isNewHighContrastDetectionEnabled&&(s=!!a&&-1===a.color.toLowerCase().indexOf(this._dummyStyleColor)),this._isInHighContrastMode=r||s,a&&o||i.ULS.sendTraceTag(25523335,334,50,"HighContrastDetector foregroundBackgroundCurrentStyle is null:[{0}] and linkCurrentStyle is null:[{1}]",!a,!o),this._isInHighContrastMode&&(this._highContrastColors=a?this.getNormalizedHighContrastHexValuesFromColor(a.color.toLowerCase(),a.backgroundColor.toLowerCase(),o.color.toLowerCase()):null,this._areAllHighContrastValuesValid||i.ULS.sendTraceTag(19223450,334,15,"We believe the user is in high contrast mode, but encountered an invalid color value (transparent or window)")),i.ULS.sendTraceTag(18458837,334,50,"HighContrastDetector.ctor: IsInHighContrastMode=[{0}], HighContrastColors=[{1}]",this._isInHighContrastMode,this._highContrastColors),e.removeChild(t);const l=e.ownerDocument.createElement("div");l.id=G,l.setAttribute(W.a.ariaRoleAttribute,W.a.ariaPresentationRole),l.setAttribute(W.a.ariaHiddenAttribute,W.a.ariaTrueValue),e.appendChild(l)}}}Q.highContrastDetectionDivId="highContrastDetectionDiv",Q.highContrastDetectionAnchorId="highContrastDetectionAnchor",Q.highContrastDetectionAnchorDefaultBackgroundImageName="highcontrastdetectordefault",(0,a.a)(Q,"HighContrastDetector",null,[127]);var q=n(7958),K=n(1163),z=n(9611),j=n(5018),Z=n(988),X=n(5072),J=n(8103),Y=n(9578);const $="msosp-touch",ee="ModeSwitched";class te extends Sys.UI.Control{static get previewPanelId(){return"PreviewPanelOverlay"}static get versionHistoryOverlayId(){return"VersionHistoryOverlay"}static get versionHistoryHeaderId(){return"VersionHistoryHeader"}getDOMElement(){return this.get_element()}get mode(){return this._mode}set mode(e){this._mode=e}get theStopwatchBuilder(){return this._theLazyStopwatchBuilder.value}get theCompositionEventManager(){return this._theCompositionEventManager||(this._theCompositionEventManager=new w(this.eventHandlerManager))}set theCompositionEventManager(e){this._theCompositionEventManager=e}get theTextInputEventManager(){return this._theTextInputEventManager||(this._theTextInputEventManager=new x(this.eventHandlerManager))}set theTextInputEventManager(e){this._theTextInputEventManager=e}get taskPaneManager(){return this._taskPaneManager}set taskPaneManager(e){this._taskPaneManager=e}get adaptiveLayoutInstance(){return this._adaptiveLayoutInstance||(this._adaptiveLayoutInstance=new u)}set adaptiveLayoutInstance(e){this._adaptiveLayoutInstance=e}get applicationInstance(){return this._applicationInstance}get modeName(){return""}get state(){return this._frameState}set state(e){this._frameState=e}get businessBar(){return null}set_businessBar(e){return e}get hasStatusBar(){return!1}get statusBarPanel(){if(!this.hasStatusBar)return null;let e=document.getElementById(te._statusPanelId);return e?this.updateExistingStatusBarPanel(e,this.applicationInstance):e=this.buildStatusBarPanel(),e}get lowerRibbonHeight(){return this._lowerRibbonHeight}set lowerRibbonHeight(e){this._lowerRibbonHeight=e}get documentPanelWithRibbonTop(){return this.upperRibbonHeight+this.lowerRibbonHeight}get documentPanelWithoutRibbonTop(){return this.upperRibbonHeight}get isStaticUiTouchMode(){return this._isStaticUiTouchMode}get highContrastDetector(){return this._highContrastDetector}get headerFocusScopeName(){return te.headerScopeName}static get customHeaderFocusScopeName(){return te.customHeaderScopeName?te.customHeaderScopeName:te.headerScopeName}static set customHeaderFocusScopeName(e){te.customHeaderScopeName=e}add_modeSwitched(e){this.get_events().addHandler(ee,e)}remove_modeSwitched(e){this.get_events().removeHandler(ee,e)}add_onSetOffline(e){this.get_events().addHandler("OnSetOffline",e)}remove_onSetOffline(e){this.get_events().removeHandler("OnSetOffline",e)}updateCommandUI(e=!1){}get canSaveACopy(){const e=1===this.mode,t=U.a.instance.isSessionExpired(s.AFrameworkApplication.accessTokenTtl)||U.a.instance.isSessionAboutToExpire(s.AFrameworkApplication.accessTokenTtl,s.AFrameworkApplication.accessTokenExpirationPromptSeconds),n=Y.a.fileMenuDisabledButtonsHandlingEnabled&&s.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("DisablePrintBasedOnPolicy")&&s.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("DisablePrint");if(s.AFrameworkApplication.createACopyFeatureEnabledForProtectedFiles)return!(e&&t)&&!n&&s.AFrameworkApplication.webEditingEnabled;const a=s.AFrameworkApplication.protectFile||s.AFrameworkApplication.protectedFile||!Y.a.fileMenuDisabledButtonsHandlingEnabled&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ProtectedFile");return!(e&&t)&&!a&&!n&&s.AFrameworkApplication.webEditingEnabled}setStaticUiTouchMode(e){this.isStaticUiTouchMode!==e&&(this._isStaticUiTouchMode=e,this.isStaticUiTouchMode?Sys.UI.DomElement.addCssClass(this.get_element(),$):Sys.UI.DomElement.removeCssClass(this.get_element(),$))}get defaultModalDivZIndex(){return 1002}get activeModalDivZIndex(){return this._activeModalDivZIndex}get activeModalUIZIndex(){return this.activeModalDivZIndex+1}beginModal(e){-1===this.activeModalDivZIndex?this._activeModalDivZIndex=this.defaultModalDivZIndex:this._activeModalDivZIndex=this.activeModalDivZIndex+2}endModal(e){this._activeModalDivZIndex=this.activeModalDivZIndex-2,this.activeModalDivZIndex<this.defaultModalDivZIndex&&(this._activeModalDivZIndex=-1)}get holdRequestsWhenSessionHasExpired(){return!0}get runRequestCallbackWhenSessionHasExpired(){return!1}get isOffline(){return this._isOffline}applyTouchStyles(){this.setStaticUiTouchMode(K.a.supportsTouch);s.AFrameworkApplication.appSettingsManager;s.AFrameworkApplication.isMultiTouchGestureEnabled()&&s.AFrameworkApplication.isPinchToZoomEnabled()&&Sys.UI.DomElement.addCssClass(document.body,te.touchPanOnlyCssClass)}applyScrollBarStyles(){s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ModernScrollBarIsEnabled")?Sys.UI.DomElement.addCssClass(document.body,te.modernScrollBarCssClass):s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DisableSharedLegacyScrollBarExcel")||Sys.UI.DomElement.addCssClass(document.body,te.legacyScrollBarCssClass)}buildStatusBarPanel(){const e=document.createElement("div");return e.id=te._statusPanelId,e.className="WACStatusBarContainer",this.applicationInstance&&this.applicationInstance.isReactStatusBarEnabled?Sys.UI.DomElement.addCssClass(e,"reactStatusBar"):e.style.height=te.statusBarHeight+"px",this.applicationInstance&&this.applicationInstance.isRegionComposerEnabled&&Sys.UI.DomElement.addCssClass(e,"regionComposer"),this.applicationInstance&&this.applicationInstance.isRibbonFlexBoxLayoutEnabled&&Sys.UI.DomElement.addCssClass(e,"FlexBoxLayout"),this.applicationInstance&&this.applicationInstance.isRibbonVisualRefreshEnabled&&Sys.UI.DomElement.addCssClass(e,"MLRVisualRefresh"),this.get_element().appendChild(e),e}updateExistingStatusBarPanel(e,t){}buildExternalHeaderPanel(e,t){if(!e.parentNode)return;let n=s.AFrameworkApplication.externalHeaderPanelClassName;t&&!s.AFrameworkApplication.hideHeaderEmbedded&&(n+=" FlexBoxLayout");s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SharedShyRibbonIsEnabled")&&!(s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NoRaisedZIndexWithNoHeader")&&s.AFrameworkApplication.hideHeaderEmbedded)&&(n+=" RaisedZIndexIncrease");const a=this.addAppHearderPanelIfNeeded(n,e);a.setAttribute("role","toolbar"),B.a.appendHiddenLabel(a,s.AFrameworkApplication.externalHeaderPanelId+"-label",s.AFrameworkApplication.externalHeaderLabel||(0,J.a)("AppHeader_Label")),k.a.instance.initializeForElement(a),P.a.instance.initializeForElement(a),L.a.instance.initializeForElement(a),A.a.instance.initializeForElement(a),I.a.instance.initializeForElement(a),D.a.instance.initializeForElement(a),F.a.instance.initializeForElement(a),F.a.instance.registerHandler(a,te.suppressContextMenuHandler,null)}addAppHearderPanelIfNeeded(e,t){s.AFrameworkApplication.appSettingsManager&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactHeaderCrashLogs")&&i.ULS.sendTraceTag(509116636,340,50,"AFrame.AddAppHearderPanelIfNeeded has been called");const n=document.getElementById(s.AFrameworkApplication.externalHeaderPanelId)||document.createElement("div");return n.id=s.AFrameworkApplication.externalHeaderPanelId,n.className.indexOf(e)<0&&(n.className=e+" "+n.className),this.applicationInstance.skipReparentOfHeaderPanel?(s.AFrameworkApplication.appSettingsManager&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactHeaderCrashLogs")&&i.ULS.sendTraceTag(508704135,340,50,"AFrame.AddAppHearderPanelIfNeeded SkipReparentOfHeaderPanel path"),n):(s.AFrameworkApplication.appSettingsManager&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactHeaderCrashLogs")&&i.ULS.sendTraceTag(508704134,340,50,"AFrame.AddAppHearderPanelIfNeeded didnt SkipReparentOfHeaderPanel"),t.parentNode.insertBefore(n,t),n)}dispose(){this._isDisposed||(C.a.safeDispose(this._styleSheet),this._styleSheet=null,this._documentFocusHandler&&(m.a.removeHandler(document.body,"focus",this._documentFocusHandler),m.a.removeHandler(window.document,"focus",this._documentFocusHandler)),this._documentFocusHandler=null,O.a&&O.a.hide(),k.a.instance.deinitializeForElement(this.get_element()),P.a.instance.deinitializeForElement(this.get_element()),s.AFrameworkApplication.nativeSelectionAndContextMenu||L.a.instance.deinitializeForElement(this.get_element()),A.a.instance.deinitializeForElement(this.get_element()),s.AFrameworkApplication.nativeSelectionAndContextMenu||(I.a.instance.deinitializeForElement(this.get_element()),D.a.instance.deinitializeForElement(this.get_element())),C.a.safeDispose(this.theCursorManager),te.disposeExternalHeader(),s.AFrameworkApplication.unRegisterFrame(this.get_element().id),this._applicationInstance=null,Sys.Component.prototype.dispose.call(this),this._isDisposed=!0)}switchToMode(e){this._mode!==e&&(this.validateFrameMode(e),this._mode=e,this.raiseModeSwitchEvent())}validateFrameMode(e){switch(e){case 0:throw Error.argumentNull("newMode");case 1:case 2:break;default:throw Error.argumentOutOfRange("newMode")}}raiseModeSwitchEvent(){s.AFrameworkApplication.theActionManager.mode=1===this.mode?1:3;const e=this.get_events().getHandler(ee);e&&e(this)}setOffline(e){if(this.isOffline===e)return;this._isOffline=e,s.AFrameworkApplication.theActionManager.isOffline=e;const t=this.get_events().getHandler("OnSetOffline");t&&t(e)}prepareForDialog(){}animateDocumentPanel(e,t){}updateOpenMenu(e){return!1}doBrowserDefault(e,t,n,a,i){return 4}restoreFocusAfterDismissingPopup(e,t){try{e.focus()}catch(e){0}}setFocusOnDocument(){}restoreFocusAfterExecutingActionFromRibbon(){this.theFocusManager&&this.theFocusManager.currentScope&&(this.theFocusManager.currentScope.name===this.ribbonFocusScopeName||this.theFocusManager.currentScope.name===this.headerFocusScopeName||this.theFocusManager.currentScope.name===te.reactTransientUIFocusId&&this.theFocusManager.peekNonReactTransientUiScope()===this.ribbonFocusScopeName)&&(this.theFocusManager.previousEditableScopeName&&this.theFocusManager.isEditableFocusScopeActivated(this.theFocusManager.previousEditableScopeName)?this.theFocusManager.setScope(this.theFocusManager.previousEditableScopeName):this.setFocusOnDocument())}onFloatieDismissed(e){}signInInternal(e){}onDocumentFocus(e){this.theFocusManager.currentScope&&this.theFocusManager.currentScope.name===M.FocusManager.browserFocusId&&this.theFocusManager.popScope(M.FocusManager.browserFocusId)}navigateToHostUrl(e,t,n=!1){if(!t)return 8;if(e){i.ULS.sendTraceTag(6070364,306,50,"AFrame::NavigateToHostUrl openInNewWindow:{0}",n);try{if(n||s.AFrameworkApplication.isEmbedded){const e=q.a.safelyOpenWindow(t,"_blank",void 0,"AFrame.NavigateToHostUrl");(null==e||e.closed)&&i.ULS.sendTraceTag(5325278,306,15,"Window.Open did not succeed.")}else window.top.location=t}catch(e){let t="Unable to get exception message";try{t=e.toString()}catch(e){}return i.ULS.sendTraceTag(6070365,306,10,"AFrame::NavigateToHostUrl caught exception: {0}",t),8}}return 32}beforeRefreshDocument(){return!0}refreshDocument(e){}onBeforeOpenSwitcher(){return!0}onBeforeCloseSwitcher(){return!0}add_onResize(e){this._eventSource.addHandler(te.resizeEventKey,e)}remove_onResize(e){this._eventSource.removeHandler(te.resizeEventKey,e)}notifyResize(){this._eventSource.raiseEvent(te.resizeEventKey)}static suppressContextMenuHandler(e){return!0}static disposeExternalHeader(){let e=document.getElementById(s.AFrameworkApplication.externalHeaderPanelId);e&&(k.a.instance.deinitializeForElement(e),P.a.instance.deinitializeForElement(e),L.a.instance.deinitializeForElement(e),A.a.instance.deinitializeForElement(e),I.a.instance.deinitializeForElement(e),D.a.instance.deinitializeForElement(e),F.a.instance.deinitializeForElement(e),F.a.instance.unregisterHandler(e,te.suppressContextMenuHandler),e=null)}static bindWithDoNothingFallback(e,t,n,a){te._appScope||(te._appScope=M.FocusManager.instance().getScope("app")),a?(e.bindActionWithArguments(t,n,a),te._appScope.bindActionWithArguments(t,Z.a.doNothing,a)):(e.bindAction(t,n),te._appScope.bindAction(t,Z.a.doNothing))}static doNothing(e,t,n,a,i){return 32}constructor(e,t){super(t),this._mode=0,this._theCompositionEventManager=null,this._theTextInputEventManager=null,this._frameState=0,this._isDisposed=!1,this._lowerRibbonHeight=0,this._styleSheet=null,this._taskPaneManager=null,this._adaptiveLayoutInstance=null,this.theContextMenuInputManager=null,this.thePageManager=null,this.theErrorHandler=null,this.theF6Manager=null,this.upperRibbonHeight=0,this._isStaticUiTouchMode=!1,this._activeModalDivZIndex=-1,this.updateStyleSheetWithLocalizableStyles=e=>{this._styleSheet=e;const t="font-family:"+this.uiFontFamily+";font-size:"+this.uiFontSize+";",n="font-family:"+this.uiFontFamilyLight+";font-size:"+this.uiFontSize+";",a="font-size:"+this.uiSmallFontSize+";",i="font-weight:"+this.uiFontWeightBold+";",o="text-transform:"+this.uiTextTranformUpperCase+";",r="font-family:"+this.uiFontFamily+";font-size:"+this.uiSmallFontSize+";";this._styleSheet.addRule(".UIFont, .AppHeaderPanel, .WACFrame, .WACFrameWord, .ewa-root-ltr, .ewa-root-rtl, .cui-menu, .WACDialogButtonNormal, .WACBusinessBarButton, .WACDialogPanel, .AppRegionComposer",t,0),this._styleSheet.addRule(".cui-floatie",r,0),this._styleSheet.addRule(".UIFontLight",n,0),this._styleSheet.addRule(".UISmallFont",a,0),this._styleSheet.addRule(".UIFontBold",i,0),this._styleSheet.addRule(".UITextTranformUpperCase",o,0);this.headerLargeFontSize;const s="300",l="400",c="-webkit-font-smoothing: antialiased;",d="font-size:"+this.jewelMenuFontSize+";"+c,u="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuFontSize+";font-weight:"+s+";"+c,p="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuMainTitleFontSize+";font-weight:200;"+c,g="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuFileNameFontSize+";font-weight:"+s+";"+c;this._styleSheet.addRule(".cui-jewelmenu .cui-ctl-mediumlabel",d,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-mediumlabel",u,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-menusection-titleAtTop",p,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-filenamelabel",g,0);const h="font-family:"+this.uiFontFamily+";font-weight:"+l+";"+c,m="font-family:"+this.uiFontFamily+";font-size:"+this.uiFontSizeReactSmall+"pt;font-weight:"+l+";"+c,_="font-family:"+this.uiFontFamily+";font-size:"+this.uiFontSizeReactLarge+"pt !important;font-weight:"+s+";"+c,S="font-family:"+this.uiFontFamily+" !important;font-weight:"+l+" !important;"+c,f="font-weight:400;"+c;this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-filenamelabel.cui-menusection-filenametitle",m,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-menulabel",h,0),this._styleSheet.addRule(".cui-jewelmenu .cui-ctl-mediumlabel .cui-btn-title",h,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-menusection-titleAtTop",_,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-mediumlabel",S,0),this._styleSheet.addRule(".cui-jewelsubmenu #lblWheresTheSaveButton-MenuSaveButton .cui-btn-menu-description",f,0);const C="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuMruButtonTitleFontSize+";",y="font-family:"+this.uiFontFamily+";font-size:"+this.jewelSubmenuFooterButtonFontSize+";";this._styleSheet.addRule(".cui-jewelsubmenu .cui-mrubutton-title",C,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-footerbutton",y,0);const A="font-size:"+this.dialogTitleFontSize+";",b="font-size:"+this.dialogButtonFontSize+";",T="font-size:"+this.dialogTextFontSize+";",v="font-size:"+this.dialogTextLargeFontSize+";";this._styleSheet.addRule(".UIFontDialogTitle",A,0),this._styleSheet.addRule(".UIFontDialogButton",b,0),this._styleSheet.addRule(".UIFontDialogText",T,0),this._styleSheet.addRule(".UIFontDialogTextLarge",v,0);const w="font-family:"+this.uiFontFamilyLight+";font-size:"+this.taskPaneTitleFontSize+";";this._styleSheet.addRule(".cui-taskPaneTitle",w,0)},this._isOffline=!1,this._applicationInstance=e,this._eventSource=new j.a,this.eventHandlerManager=E.EventHandlerManager.instance,this.theFocusManager=M.FocusManager.instance(),this.theFocusManager.getScope(te.mainAppFocusId).parent="app",this.theKeyInputManager=k.a.instance,this.theKeyInputManager.initializeForElement(this.get_element()),this.theMouseInputManager=P.a.instance,this.theMouseInputManager.initializeForElement(this.get_element()),this.theTouchInputManager=L.a.instance,s.AFrameworkApplication.nativeSelectionAndContextMenu||this.theTouchInputManager.initializeForElement(this.get_element()),this.theClickInputManager=A.a.instance,this.theClickInputManager.initializeForElement(this.get_element()),this.theDragInputManager=I.a.instance,s.AFrameworkApplication.nativeSelectionAndContextMenu||this.theDragInputManager.initializeForElement(this.get_element()),s.AFrameworkApplication.nativeSelectionAndContextMenu||D.a.instance.initializeForElement(this.get_element()),this.theCursorManager=new y(this.get_element()),s.AFrameworkApplication.cursorPinningIsEnabled&&I.a.instance.registerCursorPinningTool(this.theCursorManager),this.theActionManager=s.AFrameworkApplication.theActionManager,M.FocusManager.registerActions(this.theActionManager),p.b(this.theActionManager),M.FocusManager.registerShortcuts(this.theFocusManager),this.theFocusManager.getScope(n(4238).a.appFocusId).bindAction(k.a.hashKey(X.a.VK_O,5),Z.a.toggleAnimations),this.theActionManager.addAction(Z.a.focusToBrowser,z.a.frame,(0,o.a)(this.theFocusManager,this.theFocusManager.focusToBrowser,"focusToBrowser")),this.theActionManager.addActionWithFlags(Z.a.doNothing,z.a.frame,te.doNothing,65632),this.theActionManager.addActionWithFlags(Z.a.doNothingInEdit,z.a.frame,te.doNothing,100),this.theActionManager.addActionWithFlags(Z.a.doBrowserDefault,z.a.frame,(0,o.a)(this,this.doBrowserDefault,"doBrowserDefault"),65632),K.a.isFirefox?Sys.UI.DomElement.addCssClass(document.body,"FireFox"):K.a.isWebKit?Sys.UI.DomElement.addCssClass(document.body,"Safari"):K.a.isOpera12Older&&Sys.UI.DomElement.addCssClass(document.body,"Opera"),K.a.isIPad&&(Sys.UI.DomElement.addCssClass(document.body,"iPad"),K.a.iPadOsVersion>=6&&Sys.UI.DomElement.addCssClass(document.body,"v6up")),K.a.isIPhone&&Sys.UI.DomElement.addCssClass(document.body,"iPhone"),K.a.isMac&&Sys.UI.DomElement.addCssClass(document.body,"Mac"),K.a.isWindows&&Sys.UI.DomElement.addCssClass(document.body,"Windows"),K.a.isLinux&&Sys.UI.DomElement.addCssClass(document.body,"Linux"),K.a.isIPad||Sys.UI.DomElement.addCssClass(document.body,"usehover"),this._documentFocusHandler=(0,o.a)(this,this.onDocumentFocus,"onDocumentFocus"),this._theLazyStopwatchBuilder=new r.a((0,o.a)(this,this.makeStopwatchBuilder,"makeStopwatchBuilder")),this.applyTouchStyles(),this.applyScrollBarStyles(),m.a.addHandler(document.body,"focus",this._documentFocusHandler),m.a.addHandler(window.document,"focus",this._documentFocusHandler),S.createStyleSheet(t.ownerDocument,this.updateStyleSheetWithLocalizableStyles),s.AFrameworkApplication.hasExternalHeader&&this.buildExternalHeaderPanel(this.get_element(),!!this.applicationInstance&&this.applicationInstance.isRibbonFlexBoxLayoutEnabled),this._highContrastDetector=new Q(t)}}te.ribbonMinimizedStateCookieName="WACRibbonMinimized",te.uiCookieExpirationDays=365,te._statusPanelId="WACStatusBarContainer",te.touchPanOnlyCssClass="TouchPanOnly",te.modernScrollBarCssClass="customScrollBar",te.legacyScrollBarCssClass="legacyScrollBar",te.allowBrowserClickClassname="AllowBrowserClick",te.dynamicTouchModeCssClass="msosp-touch-dyn",te._appScope=null,te.appFocusId="app",te.mainAppFocusId="main",te.documentFocusID="document",te.flexPaneFocusId="FlexPane",te.commentPaneFocusId="CommentPane",te.accCheckerPaneFocusId="AccessibilityCheckerPane",te.accAssistantPaneFocusId="AccessibilityAssistantPane",te.activityPaneFocusId="ActivityTaskPane",te.catchUpNotificationFocusId="CatchUpNotification",te.catchUpFlyoutFocusId="CatchUpFlyout",te.floatingContainersHostFocusId="FloatingContainersHostFocusScope",te.headerScopeName="NoOpHeaderUi",te.customHeaderScopeName=void 0,te.modalCommandUIFocusId="CUIModal",te.reactTransientUIFocusId="ReactTransientUI",te.modelessDialogFocusId="dialog/modeless",te.switcherFocusId="SwitcherFocus",te.activityFeedPaneFocusId="ActivityFeedTaskPane",te.copilotComposeFocusId="CopilotCompose",te.copilotComposeLaunchpadFocusId="CopilotComposeLaunchpadFocusId",te.copilotComprehensionFocusId="CopilotComprehension",te.copilotCursorFocusId="CopilotCursor",te.statusBarHeight=23,te.resizeEventKey="Resize",(0,a.a)(te,"AFrame",Sys.UI.Control,[52,11,53])},3700:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var a,i=n(100);!function(e){e.appFocusId="app",e.reactTransientUIFocusId="ReactTransientUI",e.documentFocusID="document",e.previewPanelId="PreviewPanelOverlay",e.versionHistoryOverlayId="VersionHistoryOverlay",e.versionHistoryHeaderId="VersionHistoryHeader",e.copilotComposeFocusId="CopilotCompose",e.copilotComposeLaunchpadFocusId="CopilotComposeLaunchpadFocusId",e.copilotComprehensionFocusId="CopilotComprehension",e.copilotCursorFocusId="CopilotCursor"}(a||(a={})),(0,i.b)("AFrameConstants",a)},3245:function(e,t,n){"use strict";n.r(t),n.d(t,{AFrameworkApplication:function(){return $t}});var a,i=n(100),o=n(3792),r=n(4182),s=n(1198),l=n(502),c=n(8009),d=n(5149),u=n(625),p=n(8555),g=n(1057),h=n(5018),m=n(8650),_=n(92);!function(e){e[e.none=0]="none",e[e.reading=1]="reading",e[e.edit=2]="edit"}(a||(a={})),(0,i.b)("FrameMode",a);var S=n(6295),f=n(6534),C=n(5434),y=n(6362),A=n(5665),b=n(2448);const T="OtelUserAction";class v{add_onActionEventHandler(e){this._actionEventSource.addHandler(T,e)}remove_onActionEventHandler(e){this._actionEventSource.removeHandler(T,e)}getName(){return"Otel"}onBeforeAction(e){this.addUnprocessedActionOperation(e),v.shouldTrackOperation(e)&&1===this._unprocessedActionOperations.length&&(this._event=window.event)}onAfterAction(e){this.removeLastUnprocessedActionOperation(e)&&this.canRecordToOtel(e)&&(this.recordToOtel(e),v.shouldTrackOperation(e)&&0===this._unprocessedActionOperations.length&&(this._event=null))}addUnprocessedActionOperation(e){Array.add(this._unprocessedActionOperations,e)}removeLastUnprocessedActionOperation(e){const t=this._unprocessedActionOperations.length-1;return this._unprocessedActionOperations[t]!==e?(Array.clear(this._unprocessedActionOperations),!1):(Array.removeAt(this._unprocessedActionOperations,t),!0)}closeUnprocessedActions(){this._unprocessedActionOperations.length>0&&d.ULS.sendTraceTag(40109205,383,50,"Count of unprocessed action operations: "+this._unprocessedActionOperations.length.toString());for(let e=0;e<this._unprocessedActionOperations.length;e++){const t=this._unprocessedActionOperations[e];this.recordToOtel(t)}Array.clear(this._unprocessedActionOperations)}canRecordToOtel(e){return!0}recordToOtel(e){const{AFrameworkApplication_WsaClient:t}=n(6865);if(!C.a.isUserActionLoggingToOtelEnabled())return;const i=v.getActionMetadata(e.actionId),o=v.checkNoReportingOfAction(i);if(2!==e.behavior||e.response<1||!t.theWsaClient||o)return;const r=e.actionId,s=g.ActionManager.actionIdResolver(r)||"",l=e.startTime.getTime();let c=e.endTime.getTime()-l;c=c<0?0:c;let u=e.commandTabName||C.a.unknownValueString,p=S.a[e.invocationMethod],h=_.a[e.commandLocation];const b=a[e.beginMode],w=e.telemetryData&&"TriggerTime"in e.telemetryData?e.telemetryData.TriggerTime:0;let F=parseInt(String(Math.round(w)));F>C.a.MAX_SAFE_INTEGER&&(d.ULS.sendTraceTag(42567431,383,50,"timeOffsetMs ("+F+") was > "+C.a.MAX_SAFE_INTEGER),F=C.a.MAX_SAFE_INTEGER);const I=n(6865).AFrameworkApplication_WsaClient.theWsaClient.getActiveDocKey(),E=32===e.response,M=!!i&&i.flags[8]&&!!e.reportingData,k=[{name:"Mode",string:b},{name:"ActiveDocKey",int64:I}],P=e.telemetryData;if(P)for(const e of y.a.getKeys(P)){if("Mode"===e||"ActiveDocKey"===e)continue;const t=P[e];null!=t&&Array.add(k,{name:e,string:t.toString()})}let D=0,R=0;if(M){const t=e.reportingData;0,D=void 0===t.dataValue1||null===t.dataValue1?0:t.dataValue1,R=void 0===t.dataValue2||null===t.dataValue2?0:t.dataValue2,Array.add(k,{name:"CustomData1",int64:D}),Array.add(k,{name:"CustomData2",int64:R});let n=(65535&r^r>>>16)<<16;n<0&&(n+=4294967296),D+=n,R+=n}64===e.response||v.componentNameNotUsed;i&&i.flags[64]?(({parentName:u,triggerMethod:p,commandSurface:h}=C.a.sanitizeValues(u,p,h)),Array.add(k,{name:"ActionId",int64:e.actionId}),Array.add(k,{name:"ActionName",string:s}),Array.add(k,{name:"CommandSurface",string:h}),Array.add(k,{name:"ParentName",string:u}),Array.add(k,{name:"TriggerMethod",string:p}),Array.add(k,{name:"TimeOffsetMs",int64:F}),Array.add(k,{name:"StartTime",date:l}),Array.add(k,{name:"Succeeded",bool:E}),A.a.sendActivityEvent({name:s&&s.length>0?this.otelNonUserActionEventTableNamePrefix+s:this.otelNonUserActionEventTableName,durationMs:c,dataFields:k}),d.ULS.sendTraceTag(40915043,383,50,"OtelActionListener activity:"+s)):(f.c(r,E,u,e.invocationMethod,e.commandLocation,c,k,window.event?window.event:this._event),d.ULS.sendTraceTag(40915072,383,50,"OtelActionListener action:"+s),this._actionEventSource.raiseEvent(T,new m.a(s,u,Date.now())))}static getInstance(){return v._instance||(v._instance=new v)}static checkNoReportingOfAction(e){return!!e&&e.flags[32]&&e.flags[64]}static getActionMetadata(e){return n(1510).AFrameworkApplication_ActionManager.theActionManager.getActionMetadata(e)}static shouldTrackOperation(e){const t=v.checkNoReportingOfAction(v.getActionMetadata(e.actionId));return A.a.interactivityTrackerLogger&&2===e.behavior&&!t}constructor(){this._unprocessedActionOperations=[],this._actionEventSource=new h.a,this._event=null,this.otelNonUserActionEventTableName=C.a.getOtelNonUserActionEventTableName(),this.otelNonUserActionEventTableNamePrefix=C.a.getOtelNonUserActionEventTablePrefix(),b.a.add_onAfterError((0,u.a)(this,this.closeUnprocessedActions,"closeUnprocessedActions"))}}v._instance=null,v.componentNameNotUsed=2,(0,i.a)(v,"OtelActionListener",null,[49,50]);var w=n(9858);class F{getName(){return"Wsa"}onBeforeAction(e){this.addUnprocessedActionOperation(e)}onAfterAction(e){this.removeLastUnprocessedActionOperation(e)&&this.canRecordToSqm(e)&&this.recordToSqm(e)}addUnprocessedActionOperation(e){Array.add(this._unprocessedActionOperations,e)}removeLastUnprocessedActionOperation(e){const t=this._unprocessedActionOperations.length-1;return this._unprocessedActionOperations[t]!==e?(Array.clear(this._unprocessedActionOperations),!1):(Array.removeAt(this._unprocessedActionOperations,t),!0)}closeUnprocessedActions(){for(let e=0;e<this._unprocessedActionOperations.length;e++){const t=this._unprocessedActionOperations[e];this.recordToSqm(t)}Array.clear(this._unprocessedActionOperations)}canRecordToSqm(e){return C.a.oldActionsPipelineIsEnabled()}recordToSqm(e){const{AFrameworkApplication_WsaClient:t}=n(6865);if(!this.canRecordToSqm(e))return;const a=n(1510).AFrameworkApplication_ActionManager.theActionManager.getActionMetadata(e.actionId),i=!!a&&a.flags[64];if(2!==e.behavior||e.response<1||!t.theWsaClient||i)return;const o=e.actionId;let r=e.startTime.getTime(),s=e.endTime.getTime()-r;r&=4294967295,r<0&&(r+=4294967296),s<0&&(s=0);const l=e.invocationMethod+(e.beginMode<<5)+(e.commandLocation<<9)+(F.commandUIActionComponentTypeNotUsed<<16)+(F.actionResponseToResponseCode(e.response)<<21),c=w.a.calcHashCode(e.commandTabName);let d=0,u=0;if(!!a&&a.flags[8]){const t=e.reportingData;let n=(65535&o^o>>>16)<<16;n<0&&(n+=4294967296),d=void 0===t.dataValue1||null===t.dataValue1?0:t.dataValue1,u=void 0===t.dataValue2||null===t.dataValue2?0:t.dataValue2,d+=n,u+=n}const p=[l,c,o,64===e.response?1:F.componentNameNotUsed,r,s,d,u];let g;this._logActiveDocKey&&p.push(t.theWsaClient.getActiveDocKey()),(g=t.theWsaClient).addToStreamDw.apply(g,[F.ribbonStreamId].concat(p))}static getInstance(e=!0){return F._instance||(F._instance=new F(e))}static actionResponseToResponseCode(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 4:return 3;case 8:return 4;case 16:return 5;case 32:return 6;case 64:return 7;default:return 8}}constructor(e=!0){this._unprocessedActionOperations=[],b.a.add_onAfterError((0,u.a)(this,this.closeUnprocessedActions,"closeUnprocessedActions")),this._logActiveDocKey=e}}F._instance=null,F.ribbonStreamId=8327,F.ribbonStreamWidth=9,F.commandUIActionComponentTypeNotUsed=31,F.componentNameNotUsed=2,(0,i.a)(F,"WsaListener",null,[51,50]);var I=n(385),E=n(871),M=n(9401);class k extends Sys.EventArgs{get oldRefreshedSettingsGetter(){return this._oldRefreshedSettingsGetter}get newRefreshedSettingsGetter(){return this._newRefreshedSettingsGetter}isSettingChanged(e){return!this._changedSettingNames||e in this._changedSettingNames}constructor(e,t,n){super(),this._oldRefreshedSettingsGetter=e,this._newRefreshedSettingsGetter=t,this._changedSettingNames=n}}(0,i.a)(k,"SettingsRefreshedArgs",Sys.EventArgs,[]);const P="SR";class D{get isRefreshEnabled(){return this.getBooleanAppSetting("AppSettingsRefreshIsEnabled")}updatePostRefresh(e){e=e||{};const t=this.getChangedSettingNames(e);if(!t.length)return;const n={};for(let e=0;e<t.length;e++)n[t[e]]=!0;const a=this._settingsGetter;this._settingsGetter=new M.a(e,this._appSettingsManager),this._eventSource.raiseEvent(P,new k(a,this._settingsGetter,n))}getChangedSettingNames(e){const t=new Array(0);return this.appendChangedSettingsFromDictionary(e,null,this._settingsGetter,t),this.appendChangedSettingsFromDictionary(this._settingsGetter.appSettings,e,this._settingsGetter.fallbackAppSettingsGetter,t),t}appendChangedSettingsFromDictionary(e,t,n,a){if(!e)return;const i=y.a.getKeys(e);for(let o=0;o<i.length;o++){const r=i[o];if(!t||!(r in t)){const t=e[r];(n?n.getStringAppSetting(r):null)!==t&&Array.add(a,r)}}}add_onSettingsRefreshed(e){this._eventSource.addHandler(P,e)}remove_onSettingsRefreshed(e){this._eventSource.removeHandler(P,e)}getBooleanAppSetting(e){return this._settingsGetter.getBooleanAppSetting(e)}getDoubleAppSetting(e,t){return this._settingsGetter.getDoubleAppSetting(e,t)}getIntAppSetting(e,t){return this._settingsGetter.getIntAppSetting(e,t)}getLongAppSetting(e,t){return this._settingsGetter.getLongAppSetting(e,t)}getStringAppSetting(e){return this._settingsGetter.getStringAppSetting(e)}containsAppSetting(e){return this._settingsGetter.containsAppSetting(e)}getListAppSetting(e){return this._settingsGetter.getListAppSetting(e)}constructor(e){this._appSettingsManager=e,this._settingsGetter=new M.a({},this._appSettingsManager),this._eventSource=new h.a}}(0,i.a)(D,"RefreshableAppSettings",null,[59,60]);var R=n(9824),x=n(4733),L=n(1207),U=n(4168),O=n(7220);class B{constructor(){this.errorCode=0,this.errorCause=0,this.errorResolution=0}}(0,i.a)(B,"ErrorWithCauseAndResolution",null,[]);var N=n(884),W=n(5467),H=n(8216),V=n(9865),G=n(7531);class Q{get maxSessionMs(){return this.m_MaxSessionMs}set maxSessionMs(e){this.m_MaxSessionMs=e}get uploadUrl(){return this.m_UploadUrl}constructor(){this.defaultCommonDatapointIds=[60,7982,7993,7994,8047,8048,8049,9411,9412],this.m_UploadUrl="",this.m_IsOptedIn=!1,this.m_SqmQoSEnabled=!1,this.m_QoSDataPoints=null,this.m_MaxSessionMs=18e5,this.m_MaxDataSize=65536,this.m_MaxSqmId=2147483647,this.m_MaxStreamWidth=9,this.m_MinTimeBetweenUploads=1e3,this.m_MaxStreamRows=Q.defaultMaxStreamRows}}Q.defaultMaxStreamRows=1e3,Q.defaultMaxInt32=4294967295,Q.defaultRibbonStreamWidth=8,(0,i.a)(Q,"BWsaConfig",null,[]);class q{static getTicks32(){const e=(new Date).getTime();return q.startTicks||(q.startTicks=e),1+e-q.startTicks&2147483647}static getTicks64(){let e=(new Date).getTime();return e+=116444736e5,e*=1e4,e}}q.startTicks=0,(0,i.a)(q,"Ticks",null,[]);class K{constructor(){this.m_CorrelationId=null,this.m_FlightId=null,this.m_StartTime=q.getTicks64(),this.m_EndTime=0}}(0,i.a)(K,"BWsaHeader",null,[]);class z{constructor(){this.m_cDataPoints=0,this.m_cStreams=0,this.m_cbStreams=0,this.m_wsaHeader=new K,this.m_wsaDatapoints={},this.m_wsaStreams={}}}(0,i.a)(z,"BWsaData",null,[]);class j{constructor(e){this.m_WsaId=e,this.m_Value=0,this.m_Ticks=q.getTicks32(),this.m_Count=0,this.m_Sum=0}}(0,i.a)(j,"BWsaDatapoint",null,[]);class Z{constructor(e,t,n,a){(a<1||a>Q.defaultMaxStreamRows)&&(a=Q.defaultMaxStreamRows),this.m_WsaId=e,this.m_StreamType=t,this.m_Width=n,this.m_MaxRows=a,this.m_RowCount=0,this.m_RowsOverwritten=0,this.m_Rows={}}}(0,i.a)(Z,"BWsaStream",null,[]);class X{}X.maxRowCount=0,X.maxOverwritten=0,(0,i.a)(X,"StreamRowCounters",null,[]);class J{static isTimerResetNeeded(){let e=!1;const t=(new Date).getTime();return(!J.lastResetTicks||t-J.lastResetTicks>6e4)&&(e=!0,J.lastResetTicks=t),e}}J.lastResetTicks=0,(0,i.a)(J,"TimerResetCheck",null,[]);class Y{constructor(e){this.m_Ticks=q.getTicks32(),this.m_Values=new Array(e)}}(0,i.a)(Y,"WsaStreamRow",null,[]);var $=n(2274);const ee="iPhone;",te="iPad;",ne="iPod;";class ae{bWsaClientInit(e,t,n,a){this.m_BWsaData=new z,this.m_BWsaConfig=new Q,this.m_Continuation=!1,this.m_LastUpload=0,this.m_TimerId=0,this.m_DataAvailableForUpload=!1,this.m_CommonDatapoints={};for(let e=0;e<this.m_BWsaConfig.defaultCommonDatapointIds.length;e++)this.m_CommonDatapoints[""+this.m_BWsaConfig.defaultCommonDatapointIds[e]]=!0;this.m_BWsaConfig.m_UploadUrl=e,this.m_BWsaConfig.m_IsOptedIn=""!==e&&t,this.m_BWsaConfig.m_SqmQoSEnabled=n&&!!a,this.m_BWsaConfig.m_QoSDataPoints=a}get wsaConfig(){return this.m_BWsaConfig}get isContinuation(){return this.m_Continuation}disableSqmQos(){this.m_BWsaConfig.m_SqmQoSEnabled=!1}initContinuationSession(){const e=new z,t=this.m_CommonDatapoints;for(const n in t){const a={key:n,value:t[n]}.key,i=this.m_BWsaData.m_wsaDatapoints[a];if(i){const t=new j(parseInt(a));t.m_Value=i.m_Value,t.m_Count=i.m_Count,t.m_Sum=i.m_Sum,e.m_wsaDatapoints[a]=t,e.m_cDataPoints++}}e.m_wsaHeader.m_CorrelationId=this.m_BWsaData.m_wsaHeader.m_CorrelationId,e.m_wsaHeader.m_FlightId=this.m_BWsaData.m_wsaHeader.m_FlightId,this.m_BWsaData=e,this.m_DataAvailableForUpload=!1}maxSizeReachedCheck(){let e=12*this.m_BWsaData.m_cDataPoints+this.m_BWsaData.m_cbStreams;return e>=this.m_BWsaConfig.m_MaxDataSize&&(this.uploadWsaData(),e=12*this.m_BWsaData.m_cDataPoints+this.m_BWsaData.m_cbStreams,e>=this.m_BWsaConfig.m_MaxDataSize)}setInitialDatapoints(e){try{if(this.m_DataAvailableForUpload||this.m_CommonDatapoints[""+e])return;this.m_DataAvailableForUpload=!0,this.addCommonDataPointInternal(7982,ae.getBrowserInfo()),this.addCommonDataPointInternal(8049,ae.getOsInfo()),this.addCommonDataPointInternal(8814,3),this.addCommonDataPointInternal(9411,ae.getScreenResolution()),this.addCommonDataPointInternal(9412,ae.getDeviceType())}catch(e){e.message;0}}isQoSDataPoint(e){if(this.m_BWsaConfig.m_IsOptedIn)return!0;if(!this.m_BWsaConfig.m_SqmQoSEnabled)return!1;const t=this.m_BWsaConfig.m_QoSDataPoints;for(const n in t){if({key:n,value:t[n]}.value===e)return!0}return!1}setDw(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(e<1||e>this.m_BWsaConfig.m_MaxSqmId)return;if(t<0||t>Q.defaultMaxInt32)return void this.setDw(8763,e);if(this.maxSizeReachedCheck())return;this.setInitialDatapoints(e),this.resetTimer();let n=this.m_BWsaData.m_wsaDatapoints[""+e];n||(n=new j(e),this.m_BWsaData.m_wsaDatapoints[""+e]=n,this.m_BWsaData.m_cDataPoints++),n.m_Value=t,n.m_Count++,n.m_Sum=t+n.m_Sum}catch(e){}}setBool(e,t){t&&(t=1),this.setDw(e,t)}setBitsOrAnd(e,t,n){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(t<0||t>Q.defaultMaxInt32||n<0||n>Q.defaultMaxInt32)return void this.setDw(8763,e);const a=this.m_BWsaData.m_wsaDatapoints[""+e];a?(this.resetTimer(),a.m_Value&=n,a.m_Value|=t,a.m_Count++):this.setDw(e,t)}catch(e){}}setBitsOr(e,t){this.setBitsOrAnd(e,t,4294967295)}setBitsAnd(e,t){this.setBitsOrAnd(e,0,t)}setIfMax(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;const n=this.m_BWsaData.m_wsaDatapoints[""+e];!n||n.m_Value<t?this.setDw(e,t):this.resetTimer()}catch(e){}}setIfMin(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;const n=this.m_BWsaData.m_wsaDatapoints[""+e];!n||n.m_Value>t?this.setDw(e,t):this.resetTimer()}catch(e){}}incrementDw(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(!t)return void this.resetTimer();let n=0;const a=this.m_BWsaData.m_wsaDatapoints[""+e];a&&(n=a.m_Value),this.setDw(e,n+t)}catch(e){}}addToAverage(e,t,n){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;this.setDw(e,t);const a=this.m_BWsaData.m_wsaDatapoints[""+e];a&&(n>1&&(a.m_Count+=n-1),a.m_Value=Math.floor(a.m_Sum/a.m_Count))}catch(e){}}createStream(e,t,n,a){try{if(this.bsqmActionsPipelineDisabled()&&8327===e)return;if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(e<1||e>this.m_BWsaConfig.m_MaxSqmId)return;if(1!==t&&2!==t)return;if(n<1||n>this.m_BWsaConfig.m_MaxStreamWidth)return;if(this.maxSizeReachedCheck())return;if((a<1||a>this.m_BWsaConfig.m_MaxStreamRows)&&(a=this.m_BWsaConfig.m_MaxStreamRows),!this.m_BWsaData.m_wsaStreams[""+e]){const i=new Z(e,t,n,a);this.m_BWsaData.m_wsaStreams[""+e]=i,this.m_BWsaData.m_cStreams++,this.m_BWsaData.m_cbStreams+=12}}catch(e){}}createStreamUnobfuscated(e,t,n,a){this.createStream(e,t,n,a)}bsqmActionsPipelineDisabled(){return $.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OldPipelineActionLoggingDisabled")}removeOldestStreamRow(e){delete e.m_Rows[""+e.m_RowsOverwritten],this.m_BWsaData.m_cbStreams-=4*(e.m_Width+1),e.m_RowCount--,e.m_RowsOverwritten++,e.m_RowsOverwritten>X.maxOverwritten&&(X.maxOverwritten=e.m_RowsOverwritten,this.setDw(7994,e.m_RowsOverwritten),this.setDw(8047,e.m_WsaId))}addToStreamDw(e,...t){if(t.length)try{const n=new Y(t.length);for(let e=0;e<t.length;e++)n.m_Values[e]=t[e];0,this.addToStreamInternal(e,n)}catch(e){}}addToStreamDwUnobfuscated(e,...t){this.addToStreamDw.apply(this,[e].concat(t))}addToStreamInternal(e,t){if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(e<1||e>this.m_BWsaConfig.m_MaxSqmId)return;if(this.maxSizeReachedCheck())return;this.setInitialDatapoints(e);for(let n=0;n<t.m_Values.length;n++){const a=t.m_Values[n];if(a<0||a>Q.defaultMaxInt32)return void this.setDw(8763,e)}const n=this.m_BWsaData.m_wsaStreams[""+e];if(n){if(this.resetTimer(),n.m_Width!==t.m_Values.length)return void 0;if(n.m_RowCount>=n.m_MaxRows&&2===n.m_StreamType&&this.removeOldestStreamRow(n),n.m_RowCount<n.m_MaxRows){const e=n.m_RowCount+n.m_RowsOverwritten;n.m_Rows[""+e]=t,n.m_RowCount++,this.m_BWsaData.m_cbStreams+=4*(n.m_Width+1),n.m_RowCount>X.maxRowCount&&(X.maxRowCount=n.m_RowCount,this.setDw(7993,n.m_RowCount),this.setDw(8048,n.m_WsaId))}else n.m_RowsOverwritten++,n.m_RowsOverwritten>X.maxOverwritten&&(X.maxOverwritten=n.m_RowsOverwritten,this.setDw(7994,n.m_RowsOverwritten),this.setDw(8047,n.m_WsaId))}}terminate(){this.uploadWsaData()}uploadWsaData(){try{if(this.clearTimer(),!this.m_BWsaData||!this.m_BWsaConfig)return;if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(""===this.m_BWsaConfig.m_UploadUrl)return void(this.m_BWsaConfig.m_IsOptedIn=!1);const e=q.getTicks32();if(this.m_LastUpload>0&&e<=this.m_LastUpload+this.m_BWsaConfig.m_MinTimeBetweenUploads)return;this.m_LastUpload=e;const t=new Array(0),n=this.m_BWsaData.m_wsaStreams;for(const e in n){const a={key:e,value:n[e]};a.value.m_RowCount||(t[t.length]=a.key)}for(let e=0;e<t.length;e++)delete this.m_BWsaData.m_wsaStreams[t[e]],this.m_BWsaData.m_cStreams--,this.m_BWsaData.m_cbStreams-=12;if(this.m_DataAvailableForUpload){this.m_Continuation?this.setDw(60,1):(this.setDw(60,0),this.m_Continuation=!0),this.writeDocIdStream(),this.m_BWsaData.m_wsaHeader.m_EndTime=q.getTicks64();const e=this.serialize(this.m_BWsaData,this.m_BWsaConfig);this.initContinuationSession(),e&&e.length>0&&this.uploadWsaDataRequest(e)}}catch(e){}}uploadWsaDataRequest(e){if(this.c_request||(this.c_request=new XMLHttpRequest),0===this.c_request.readyState||4===this.c_request.readyState){let t=!0;Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.version>=10&&(t=!1),this.c_request.open("POST",this.m_BWsaConfig.m_UploadUrl,t),this.c_request.setRequestHeader("Content-Type","application/json"),this.c_request.send(e)}}escape(e){return e.replace(new RegExp("[\\\\]","g"),"\\\\").replace(new RegExp('[\\"]',"g"),'\\\\\\"').replace(new RegExp("[\\/]","g"),"\\\\/").replace(new RegExp("[\\b]","g"),"\\\\b").replace(new RegExp("[\\f]","g"),"\\\\f").replace(new RegExp("[\\n]","g"),"\\\\n").replace(new RegExp("[\\r]","g"),"\\\\r").replace(new RegExp("[\\t]","g"),"\\\\t")}serialize(e,t){const n=new Sys.StringBuilder;let a=!0,i=!1,o=0;t.m_IsOptedIn&&(o=16),t.m_SqmQoSEnabled&&(o|=32),n.append("{"),n.append('"StartTime":'+e.m_wsaHeader.m_StartTime+","),n.append('"EndTime":'+e.m_wsaHeader.m_EndTime+","),n.append('"Flags":'+o+","),e.m_wsaHeader.m_CorrelationId&&n.append('"CorrelationId":"'+e.m_wsaHeader.m_CorrelationId+'",'),e.m_wsaHeader.m_FlightId&&n.append('"FlightId":"'+e.m_wsaHeader.m_FlightId+'",'),n.append('"wsaDatapoints":[');const r=e.m_wsaDatapoints;for(const e in r){const t={key:e,value:r[e]}.value;this.isQoSDataPoint(t.m_WsaId)&&(i=!0,a||n.append(","),n.append('{"Id":'+t.m_WsaId+","),n.append('"Val":'+t.m_Value+","),n.append('"Tic":'+t.m_Ticks+"}"),a=!1)}n.append('],"wsaStreams":['),a=!0;const s=e.m_wsaStreams;for(const e in s){const t={key:e,value:s[e]}.value;if(!this.isQoSDataPoint(t.m_WsaId))continue;i=!0;let o=!0;a||n.append(","),n.append('{"Id":'+t.m_WsaId+","),n.append('"Width":'+t.m_Width+","),n.append('"Rows":[');const r=t.m_Rows;for(const e in r){const t={key:e,value:r[e]}.value;o||n.append(","),n.append('{"Tic":'+t.m_Ticks+","),n.append('"Vals":[');for(let e=0;e<t.m_Values.length;e++)e>0&&n.append(","),n.append(""+t.m_Values[e]);n.append("]}"),o=!1}n.append("]}"),a=!1}return n.append("]}"),i?n.toString():null}isUserOptedIn(){return this.m_BWsaConfig.m_IsOptedIn}disable(){try{this.clearTimer(),this.m_BWsaConfig.m_IsOptedIn=!1}catch(e){}}addCommonDataPointInternal(e,t){if(!this.m_BWsaData.m_wsaDatapoints[""+e]){const n=new j(e);n.m_Value=t,this.m_BWsaData.m_wsaDatapoints[""+e]=n,this.m_BWsaData.m_cDataPoints++}}clearTimer(){this.m_TimerId&&(window.clearTimeout(this.m_TimerId),this.m_TimerId=0)}resetTimer(){J.isTimerResetNeeded()&&(this.clearTimer(),this.m_TimerId=window.setTimeout(this.bWsaOnTimer,this.m_BWsaConfig.m_MaxSessionMs))}addCommonDatapoint(e){this.m_CommonDatapoints[""+e]=!0}registerPersistentDocId(e){return!(!e||4!==e.length||!(e[0]||e[1]||e[2]||e[3]))&&(this.docKey=1,this.persistentDocHash=e,!0)}getActiveDocKey(){return this.docKey}writeDocIdStream(){return!(!this.docKey||!this.persistentDocHash)&&(this.createStream(9797,1,5,1),this.addToStreamDw(9797,this.docKey,this.persistentDocHash[0],this.persistentDocHash[1],this.persistentDocHash[2],this.persistentDocHash[3]),this.setDw(10273,this.persistentDocHash[0]),!0)}getStreamById(e){return this.m_BWsaData.m_wsaStreams[e.toString()]}getRowsById(e,t){if(!e)return null;const n=new Array(0);let a=0;const i=e.m_Rows;for(const e in i){const o={key:e,value:i[e]}.value;o.m_Values.length>0&&o.m_Values[0]===t&&(n[a++]=o)}return n}updateStartTime(e){e&&(this.m_BWsaData.m_wsaHeader.m_StartTime=e)}setCorrelationId(e){this.m_BWsaData.m_wsaHeader.m_CorrelationId=e}setFlightId(e){this.m_BWsaData.m_wsaHeader.m_FlightId=e}static getBrowserInfo(){let e=0;const t=window.navigator.userAgent;let n=-1;if((n=t.indexOf(" MSIE "))>-1?(n+=6,e=2<<24):t.indexOf(" Trident/")>-1&&(n=t.indexOf(" rv:"))>-1?(n+=4,e=2<<24):(n=t.indexOf(" Edge/"))>-1?(n+=6,e=2<<24):(n=t.indexOf(" Firefox/"))>-1?(n+=9,e=3<<24):(n=t.indexOf(" Chrome/"))>-1?(n+=8,e=6<<24):(n=t.indexOf(" Safari/"))>-1&&(n=t.indexOf(" Version/"))>-1?(n+=9,e=4<<24):(n=t.indexOf("Opera/"))>-1?(n+=6,e=5<<24):(e=1<<24,n=-1),n>=0){const a=ae.getVersionFromString(t.substr(n));Sys.Browser.agent===Sys.Browser.InternetExplorer&&7===a[0]&&t.indexOf("Trident/4.0")>=0&&(a[0]=8),e|=(a[0]<<16)+a[1]}try{window.navigator.cookieEnabled?e|=2<<29:e|=3<<29}catch(e){}return e}static getVersionFromString(e){const t=[0,0];ae.isDigit(e.charAt(0))&&(t[0]=parseInt(e));for(let t=0;t<e.length;t++)if(!ae.isDigit(e.charAt(t))){e=e.substr(t+1);break}return ae.isDigit(e.charAt(0))&&(t[1]=parseInt(e)),(t[0]<0||t[0]>255||t[1]<0||t[1]>65535)&&(t[0]=0,t[1]=0),t}static getOsInfo(){let e=0,t=1;const n=window.navigator.userAgent;n.indexOf("Windows CE")>=0?t=3:n.indexOf("Windows")>=0?t=2:n.indexOf("PPC")>=0||n.indexOf("Macintosh")>=0?t=4:n.indexOf(ee)>=0||n.indexOf(te)>=0||n.indexOf(ne)>=0?t=7:n.indexOf("SunOS")>=0?t=5:n.indexOf("Linux")>=0&&(t=6),e=t<<24;let a="Windows NT ";7===t&&(a=" OS ");let i=n.indexOf(a);if(i<0&&(a="Mac OS X ",i=n.indexOf(a)),i>=0){const t=ae.getVersionFromString(n.substr(i+a.length));e+=(t[0]<<16)+t[1]}let o=0;try{const e=window.navigator.platform;-1!==n.indexOf("WOW64")?o=2:"Win64"===e?o=3:"Win32"!==e&&"Linux i686"!==e||(o=1)}catch(e){}return e|=o<<29,e}static getScreenResolution(){const e=65535&window.screen.width;return((65535&window.screen.height)<<16)+e}static getDeviceType(){const e=window.navigator.userAgent;let t=0;return e.indexOf(ee)>=0?t=1:e.indexOf(te)>=0?t=2:e.indexOf(ne)>=0&&(t=3),t}static isNullOrUndefined(e){return null==e}static isDigit(e){return e>="0"&&e<="9"}static getSQMLocationFromCUICommandInfo(e){let t=0;if(e){const n=e.RootType;if("Ribbon"===n){const n=e.RootLocation;"LowerRibbon"===n?t=2:"UpperRibbon"===n&&(t=1)}else"QAT"===n?t=3:"Jewel"===n?t=4:"ContextMenu"===n&&(t=19)}return t}static calcActionId(e){let t=5381,n=t;const a=e.length;for(let i=0;i<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==a-1);i+=2)n=4294967295&((n<<5)+n^e.charCodeAt(i+1));let i=t+35685*n+(23896*n<<16)&4294967295;return i<0&&(i+=4294967296),i}constructor(e,t,n,a){this.m_BWsaData=null,this.m_BWsaConfig=null,this.m_Continuation=!1,this.m_LastUpload=0,this.m_TimerId=0,this.m_DataAvailableForUpload=!1,this.m_CommonDatapoints=null,this.c_request=null,this.docKey=0,this.persistentDocHash=null,this.bWsaOnTimer=()=>{this.m_TimerId=0,this.clearTimer(),this.uploadWsaData(),this.resetTimer()},this.bWsaClientInit(e,t,n,a)}}(0,i.a)(ae,"BWsaClient",null,[298]);var ie=n(965),oe=n(6776);class re extends ae{get uploadUrl(){return this._uploadUrl}uploadWsaDataRequest(e){if(oe.AFrameworkApplicationConstants.theClientRequestManager){let t=n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.SessionStartInfoJson||"";if($.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("BSqmAddFlightsToSessionStartInfoJsonIfMissing")&&(!oe.AFrameworkApplicationConstants.sessionStartInfoSettings.Flights||""===oe.AFrameworkApplicationConstants.sessionStartInfoSettings.Flights)&&oe.AFrameworkApplicationConstants.flightId&&""!==oe.AFrameworkApplicationConstants.flightId){0;try{oe.AFrameworkApplicationConstants.sessionStartInfoSettings.Flights=oe.AFrameworkApplicationConstants.flightId.split(";"),t=ie.c(oe.AFrameworkApplicationConstants.sessionStartInfoSettings)}catch(e){d.ULS.sendTraceTag(595083586,201,10,"Failed to updated SessionStartInfo settings with FlightId: {0}",e)}}let i="";if(oe.AFrameworkApplicationConstants.dataPlumber){const e=oe.AFrameworkApplicationConstants.activeFrame?oe.AFrameworkApplicationConstants.activeFrame.mode:0;oe.AFrameworkApplicationConstants.dataPlumber.FrameMode=a[e],i=ie.c(oe.AFrameworkApplicationConstants.dataPlumber)}const o=n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("SendWsaHeadersInBody");let r="";const s=window.IsSessionRehydrated||!1,l={};if(o){let n;return n=e&&e.length>0?new Sys.StringBuilder(e.slice(0,-1)+","):new Sys.StringBuilder("{"),n.append('"SessionStartInfo":"'+w.a.encodeString(t,w.a.jsonEscapedCharacters)+'"'),n.append(',"DataPlumber":"'+w.a.encodeString(i,w.a.jsonEscapedCharacters)+'"'),n.append(',"UserPrimaryIdentityHash":"'+w.a.encodeString($.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("LoggableUserId")||"",w.a.jsonEscapedCharacters)+'"'),n.append(',"UserPrimaryIdentitySpace":"'+w.a.encodeString($.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("LoggableUserIdSpace")||"",w.a.jsonEscapedCharacters)+'"'),n.append(',"OmsTenantId":"'+w.a.encodeString($.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("TenantId")||"",w.a.jsonEscapedCharacters)+'"'),$.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("AddIsSessionRehydratedToWsaDataRequest")&&n.append(',"IsSessionRehydrated":'+s.toString()),n.append("}"),r=n.toString(),void oe.AFrameworkApplicationConstants.theClientRequestManager.sendShuttingDownRequest(this.uploadUrl,r)}l["X-SessionStartInfo-Json"]=t,l["X-DataPlumber-Json"]=i,oe.AFrameworkApplicationConstants.theClientRequestManager.addRequest(this.uploadUrl,2,o?r:e,l,!1,this.taskItemPriority,(e=>{}),(e=>{}),null,null,this.isSynchronous,void 0,void 0,"13",void 0,void 0,void 0,!0)}}constructor(e,t,n,a){super(e,t,n,a),this.isSynchronous=!1,this._uploadUrl=e,this.taskItemPriority=3,this.wsaConfig.m_MaxSessionMs=864e5}}(0,i.a)(re,"MsoBWsaClientBase",ae,[297,298,299]);class se extends re{constructor(e,t,n,a){super(e,t,n,a)}}(0,i.a)(se,"MsoBWsaClient",re,[]);var le=n(2388),ce=n(4361),de=n(5721),ue=n(9454),pe=n(9442),ge=n(4004),he=n(5832),me=n(5557);class _e{static postMessageToServiceWorker(e,t){"serviceWorker"in navigator?navigator.serviceWorker.controller?.postMessage({messageType:e,controlValue:t}):console.error("Service Worker not supported in this browser.")}static requestStatsFromServiceWorker(){_e.postMessageToServiceWorker("controlServiceWorker","getCacheInfo")}static disableServiceWorker(){_e.postMessageToServiceWorker("controlServiceWorker","disableServiceWorker")}static getServiceWorkerVersion(){_e.postMessageToServiceWorker("controlServiceWorker","getVersion")}static registerServiceWorkerListener(){"serviceWorker"in navigator&&navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",(e=>{e.data&&"versionResponse"===e.data.messageType?me.b(507548106,200,50,"Service Worker Version: {0}",e.data.cacheVersion):e.data&&"cacheInfoResponse"===e.data.messageType&&me.b(507548105,200,50,"Service Worker stats: {0}",e.data.cacheInfo)}))}static scheduleStatsUpdateLoggerEveryNMinutes(e=45){_e.registerServiceWorkerListener(),setInterval((()=>{_e.requestStatsFromServiceWorker()}),60*e*1e3)}static createServiceWorker(e){let t;if("Word"!=e)return;t="./WordServiceWorkerProxy.ashx";const n=document.createElement("iframe");n.src=t,document.body.appendChild(n),_e.scheduleStatsUpdateLoggerEveryNMinutes()}static unregisterServiceWorker(){"serviceWorker"in navigator?navigator.serviceWorker.getRegistration().then((e=>{e?e.unregister().then((e=>{e?me.b(507364386,200,50,"Succesfully unregistered service worker"):me.b(507364385,200,10,"Failed to unregister service worker")})).catch((e=>{me.b(507364384,200,50,"Error while unregistering service worker: {0}",e)})):me.b(507364383,200,50,"No ServiceWorker registration found")})).catch((e=>{me.b(507364382,200,50,"Error while unregistering service worker: {0}",e)})):me.b(507364381,200,50,"ServiceWorker not supported in this browser")}}(0,i.a)(_e,"ServiceWorkerMessenger",null,[]);var Se=n(3758);class fe{get dataFields(){return this._dataFields}get dataFieldsKeys(){return this._dataFieldsKeys}addFieldIfMissing(e){this.dataFieldsKeys.contains(e.name)||(this.dataFieldsKeys.add(e.name),Array.add(this.dataFields,e))}deepClone(){const e=new fe;for(let t=0;t<this.dataFields.length;t++)e.addFieldIfMissing(this.dataFields[t]);return e}constructor(){this._dataFields=new Array(0),this._dataFieldsKeys=new Se.a}}(0,i.a)(fe,"DataFieldsCollection",null,[]);var Ce,ye=n(7905),Ae=n(988),be=n(6009),Te=n(6363),ve=n(9457);!function(e){e[e.None=0]="None",e[e.Sampled=1]="Sampled"}(Ce||(Ce={}));var we=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-\S+)?$/,Fe=function(e){return/^0+$/.test(e)},Ie=/^([\da-f]{16})$/,Ee=16,Me=function(){function e(e,t,n){void 0===e&&(e=Pe()),void 0===t&&(t=De()),this.traceId=e,this.version="00",this._parentId=t,this._traceFlags=function(e){void 0===e&&(e=Ce.None);return e&Ce.Sampled}(n)}return Object.defineProperty(e.prototype,"parentId",{get:function(){return this._parentId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traceFlags",{get:function(){return this._traceFlags},enumerable:!1,configurable:!0}),e.prototype.isValid=function(){return we.test(this.serialize())&&!Fe(this.traceId)&&!Fe(this._parentId)},e.prototype.isSampled=function(){return(this.traceFlags&Ce.Sampled)===Ce.Sampled},e.prototype.updateSampled=function(e,t){return t!==this._parentId&&(!!this.updateParentId(t)&&(this._traceFlags=e?this._traceFlags|Ce.Sampled:this._traceFlags&~Ce.Sampled,!0))},e.prototype.updateParentId=function(e){return e?!(!Ie.test(e)||Fe(e))&&(this._parentId=e,!0):(this._parentId=De(),!0)},e.prototype.serialize=function(){return"".concat(this.version,"-").concat(this.traceId,"-").concat(this._parentId,"-0").concat(this._traceFlags)},e.create=function(t,n,a){var i=new e(t,n,a);return i.isValid()?i:void 0},e.createNew=function(t){return new e(Pe(),De(),t)},e.parse=function(t){var n=we.exec(t);if(n&&"ff"!==n[1]&&("00"!==n[1]||!n[5]))return e.create(n[2],n[3],parseInt(n[4],Ee))},e}();function ke(e){var t=new Uint8Array(e);window.crypto.getRandomValues(t);var n=Array.from(t).map((function(e){return(256+e).toString(Ee).slice(1)})).join("");return Fe(n)?n.slice(1)+"1":n}function Pe(){return ke(16)}function De(){return ke(8)}var Re=n(4607),xe="[-_*/0-9a-z]",Le="[a-z]".concat(xe,"{0,255}"),Ue="[0-9a-z]".concat(xe,"{0,240}"),Oe="[a-z]".concat(xe,"{0,13}"),Be="".concat(Ue,"@").concat(Oe),Ne=new RegExp("^(?:".concat(Le,"|").concat(Be,")$")),We=/^[ -+--<>-~]{0,255}[!-+--<>-~]$/,He=function(){function e(){this._listMemberMap=new Map}return e.prototype.set=function(e,t){if(!Ne.test(e)||!We.test(t))return!1;var n=this._listMemberMap;return n.has(e)&&n.delete(e),n.set(e,t),n.size>32&&n.delete(n.keys().next().value),!0},e.prototype.unset=function(e){this._listMemberMap.delete(e)},e.prototype.get=function(e){return this._listMemberMap.get(e)},Object.defineProperty(e.prototype,"keys",{get:function(){return Array.from(this._listMemberMap.keys()).reverse()},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){var e=this;return this.keys.map((function(t){return"".concat(t).concat("=").concat(e._listMemberMap.get(t))})).join(",")},e.parse=function(t){var n=new e,a=t.split(","),i=!0;return a.reverse().forEach((function(e){var t=e.trim();if(t){var a=t.split("=");2===a.length&&n.set(a[0],a[1])||((0,Re.b)(1,0,(function(){return"Invalid trace state entry '".concat(t,"'")})),i=!1)}})),i?n:void 0},e}(),Ve=function(){function e(){}return e.getFields=function(e){var t="Event.",n=e.parent,a=e.state,i=a?a.serialize():void 0;return(0,Te.b)([(0,ve.d)(t+"TraceId",n.traceId),(0,ve.d)(t+"TraceParentId",n.parentId),(0,ve.c)(t+"TraceFlags",n.traceFlags)],i?[(0,ve.d)(t+"TraceState",i)]:[],!0)},e}();class Ge{logSessionStartData(){this.sessionData&&C.a.isEnabledLogSessionStartAndEndDataFromClientToOTel(this.sessionData.Application)&&this.logStartSession(this.sessionStartNameSpace)}logSessionEndData(){if(this.sessionData&&C.a.isEnabledLogSessionStartAndEndDataFromClientToOTel(this.sessionData.Application)){ye.a.instance.raiseBeforeSessionEndEvent(),this.initMiscEndData(),this.logEndSession(this.sessionEndNameSpace);try{W.Health.instance.shutdown()}catch(e){d.ULS.sendExceptionTraceTag(592541129,383,10,e,"Failed to shutdown Health")}}}logAutomationMetadata(){C.a.isEnabledLogSessionStartAndEndDataFromClientToOTel(this.sessionData.Application)&&this.sessionData&&this.doLogAutomationMetadata(this.automationMetadataNameSpace)}initMiscStartData(){this.initStartDataFromPlumber(this.sessionFinishedDataPlumber),this.fixUpLoggingDataIfNeeded(),this.sessionData.ClientVersion=this.sessionFinishedDataPlumber.ApplicationVersion}initEndDataFromPlumber(e){this.sessionData.FrameMode=e.FrameMode,this.sessionData.Feedback=e.Feedback,this.sessionData.IsCoauthSession=e.IsCoauthSession,this.sessionData.IsRealEdit=e.IsRealEdit,this.sessionData.PrivacyNotice=e.PrivacyNotice,this.sessionData.RenavigationReason=e.RenavigationReason,this.sessionData.CookieComplianceBanner=e.CookieComplianceBanner,this.sessionData.HadSettingsRefresh=e.HadSettingsRefresh,this.sessionData.IsMixedCoauthSession=e.IsMixedCoauthSession,C.a.logFlightsInOtelSessionStartEndIsEnabled()&&(this.sessionData.IsRealCoauthSession=e.IsRealCoauthSession,this.sessionData.HasDataLoss=e.HasDataLoss);const t=e.MemoryUsageData;t&&(this.sessionData.JsHeapSizeLimit=t.JsHeapSizeLimit,this.sessionData.InitialTotalJSHeapSize=t.InitialTotalJSHeapSize,this.sessionData.InitialUsedJSHeapSize=t.InitialUsedJSHeapSize,this.sessionData.MaxTotalJSHeapSize=t.MaxTotalJSHeapSize,this.sessionData.MaxUsedJSHeapSize=t.MaxUsedJSHeapSize),this.sessionData.WacSessionDatacenter=e.WacSessionDatacenter,this.sessionData.TabLastFrozenAt=e.TabLastFrozenAt,this.sessionData.EmergencyViewLastDeployedAt=e.EmergencyViewLastDeployedAt,this.sessionData.RunawayDatalossSystemStartedAt=e.RunawayDatalossSystemStartedAt,e.DssLineageId&&""!==e.DssLineageId&&(this.sessionData.DssLineageId=e.DssLineageId),e.HostProtocol&&""!==e.HostProtocol&&(this.sessionData.HostProtocol=e.HostProtocol),this.sessionData.PaginatedDurationMs=e.PaginatedDurationMs;const n=e.GraphNodeConnectPerf;n&&(this.sessionData.AvgOnConnectTime=n.AvgOnConnectTime,this.sessionData.MaxOnConnectTime=n.MaxOnConnectTime)}initStartDataFromPlumber(e){try{if(e.HostResponseStats){const t=e.HostResponseStats.Label;t&&(this.sessionData.HostFarmHint=t)}this.sessionData.ClientThrottlingProtection=e.ClientThrottlingProtection,this.sessionData.HostServiceLevel=e.HostServiceLevel,this.sessionData.RequestedCallThrottling=e.RequestedCallThrottling,this.sessionData.WacServiceLevel=e.WacServiceLevel,this.sessionData.SharingStatus=e.SharingStatus}catch(e){}}computeSessionEndTime(e){if(!e)return me.b(38844107,200,10,"endTimeOnClient was null"),null;let t=null;if(this.serverStartTime){const n=e.getTime()-this.startTimeOnClient.getTime();t=new Date(n+this.serverStartTime.getTime()),this.sessionData.SessionDurationMs=n}else me.b(38844108,200,10,"serverStartTime on client was null");return t}fixUpLoggingDataIfNeeded(){if("Application"in this.sessionData){"Excel"===this.sessionData.Application&&this.fixUpModeForExcel()}}fixUpModeForExcel(){if("Excel"!==this.sessionData.Application||!("ApplicationModeExtended"in this.sessionData))return;const e=this.sessionData.ApplicationModeExtended.toUpperCase();"VIEW"===e||"UNIFIED"===e?this.sessionData.ApplicationModeExtended="EDIT":"EDIT"!==e&&"UNIFIED"!==e||(this.sessionData.ApplicationModeExtended="VIEW")}serializeFlights(){if(C.a.logFlightsInOtelSessionStartEndIsEnabled()&&"Flights"in this.sessionData){const e=this.sessionData.Flights;this.sessionData.Flights=ie.c(e)}}initMiscEndData(){this.initEndDataFromPlumber(this.sessionFinishedDataPlumber);const e=this.computeSessionEndTime(new Date);e&&(this.sessionData.EndTime=e.toString())}getDataField(e,t,n){if(!e||!t)return null;let a=null;switch(n){case 1:a={name:t,bool:Boolean.parse(e.toString())};break;case 0:{const n=parseInt(e);isNaN(n)||(a={name:t,int64:n});break}case 2:{const n=parseFloat(e);isNaN(n)||(a={name:t,double:n});break}case 3:a={name:t,string:e};break;case 4:{const n=Date.parse(e);isNaN(n)||(a={name:t,date:new Date(n).getTime()});break}}return a}logStartSession(e){this.appendStartInfoToCollection(this.startInfoDataFields);const t=(0,be.d)({name:e,dataFields:this.startInfoDataFields.dataFields});if(this.sessionData.TraceParent){const e=function(e,t){var n=Me.parse(e);if(n){var a=void 0;return t&&(a=He.parse(t)),a||(a=new He),{parent:n,state:a}}}(this.sessionData.TraceParent,this.sessionData.TraceState);e&&(e.parent.updateParentId(),t.eventContract=t.eventContract||{name:"",dataFields:[]},t.eventContract.dataFields.push(...Ve.getFields(e)))}if(A.a.sendOtelEvent({otelEvent:t}),C.a.isUserActionLoggingToOtelEnabled(this.sessionData.Application)){let e=Ae.a.openDocument;"ApplicationModeExtended"in this.sessionData&&this.sessionData.ApplicationModeExtended&&this.sessionData.ApplicationModeExtended.toLowerCase().indexOf("new")>=0&&(e=Ae.a.createDocument);let t=null;this.sessionData&&"TemplateId"in this.sessionData&&this.sessionData.TemplateId&&(t={},t.TemplateId=this.sessionData.TemplateId),f.d(e,void 0,void 0,void 0,void 0,void 0,t)}d.ULS.sendTraceTag(39089113,306,50,"SSED:startsession info sent to Otel")}appendStartInfoToCollection(e){this.addDataIfAvailable("AccessTokenLength","AccessTokenLength",0,e),this.addDataIfAvailable("AccessTokenTtl","AccessTokenTtl",3,e),this.addDataIfAvailable("AllowEarlyFeatures","AllowEarlyFeatures",3,e),this.addDataIfAvailable("ApplicationLCID","ApplicationLcid",3,e),this.addDataIfAvailable("ARRVersion","ArrVersion",3,e),this.addDataIfAvailable("BrowserLCID","BrowserLcid",3,e),this.addDataIfAvailable("CacheId","CacheId",3,e),this.addDataIfAvailable("ClientThrottlingProtection","ClientThrottlingProtection",3,e),this.addDataIfAvailable("ClientVersion","ClientVersion",3,e),this.addDataIfAvailable("CookieComplianceBanner","CookieComplianceBanner",0,e),this.addDataIfAvailable("CookieConsentRequired","CookieConsentRequired",1,e),this.addDataIfAvailable("DeviceName","DeviceName",3,e),this.addDataIfAvailable("EdgeEnvironmentName","EdgeEnvironmentName",3,e),this.addDataIfAvailable("EdgeEventId","EdgeEventId",3,e),this.addDataIfAvailable("EdgeFeatures","EdgeFeatures",3,e),this.addDataIfAvailable("FileExtension","FileExtension",3,e),this.addDataIfAvailable("FileSizeBytes","FileSizeBytes",0,e),this.addDataIfAvailable("FlightsHash","FlightsHash",3,e),this.addDataIfAvailable("HostDatacenterHint","HostDatacenterHint",3,e),this.addDataIfAvailable("HostServiceLevel","HostServiceLevel",3,e),this.addDataIfAvailable("HostFarmHint","HostFarmHint",3,e),this.addDataIfAvailable("HostSessionId","HostSessionId",3,e),this.addDataIfAvailable("LocationCity","LocationCity",3,e),this.addDataIfAvailable("LocationCountry","LocationCountry",3,e),this.addDataIfAvailable("LocationState","LocationState",3,e),this.addDataIfAvailable("PLT","Plt",3,e),this.addDataIfAvailable("RequestedDatacenter","RequestedDatacenter",3,e),this.addDataIfAvailable("RequestedComplianceRegion","RequestedComplianceRegion",3,e),this.addDataIfAvailable("PreviousSession","PreviousSession",3,e),this.addDataIfAvailable("RequestedCallThrottling","RequestedCallThrottling",3,e),this.addDataIfAvailable("ResolvedThrottlingLevel","ResolvedThrottlingLevel",3,e),this.addDataIfAvailable("RoutedVia","RoutedVia",3,e),this.addDataIfAvailable("SessionOrigin","SessionOrigin",3,e),this.addDataIfAvailable("SharingStatus","SharingStatus",3,e),this.addDataIfAvailable("StartTimeUtc","StartTime",4,e),this.addDataIfAvailable("UserAgent","UserAgent",3,e),this.addDataIfAvailable("WacServiceLevel","WacServiceLevel",3,e),this.addDataIfAvailable("WFEVersion","WfeVersion",3,e),C.a.logFlightsInOtelSessionStartEndIsEnabled()&&this.addDataIfAvailable("Flights","Flights",3,e)}logEndSession(e){const t=this.startInfoDataFields.deepClone();this.appendStartInfoToCollection(t),this.addDataIfAvailable("EndTimeUtc","EndTime",4,t),this.addDataIfAvailable("Feedback","Feedback",0,t),this.addDataIfAvailable("FrameMode","FrameMode",3,t),this.addDataIfAvailable("HadSettingsRefresh","HadSettingsRefresh",1,t),this.addDataIfAvailable("InitialTotalJSHeapSize","InitialTotalJSHeapSize",0,t),this.addDataIfAvailable("InitialUsedJSHeapSize","InitialUsedJSHeapSize",0,t),this.addDataIfAvailable("IsCoauthSession","IsCoauthSession",1,t),this.addDataIfAvailable("IsRealEdit","IsRealEdit",1,t),this.addDataIfAvailable("JsHeapSizeLimit","JsHeapSizeLimit",0,t),this.addDataIfAvailable("MaxTotalJSHeapSize","MaxTotalJSHeapSize",0,t),this.addDataIfAvailable("MaxUsedJSHeapSize","MaxUsedJSHeapSize",0,t),this.addDataIfAvailable("PrivacyNotice","PrivacyNotice",0,t),this.addDataIfAvailable("RenavigationReason","RenavigationReason",3,t),this.addDataIfAvailable("HadSettingsRefresh","HadSettingsRefresh",1,t),this.addDataIfAvailable("IsMixedCoauthSession","IsMixedCoauthSession",1,t),this.addDataIfAvailable("SessionDurationMs","SessionDurationMs",0,t),this.addDataIfAvailable("WacSessionDatacenter","WacSessionDatacenter",3,t),this.addDataIfAvailable("TabLastFrozenAt","TabLastFrozenAt",1,t),this.addDataIfAvailable("EmergencyViewLastDeployedAt","EmergencyViewLastDeployedAt",1,t),this.addDataIfAvailable("DssLineageId","DssLineageId",3,t),this.addDataIfAvailable("AvgOnConnectTime","AvgOnConnectTime",0,t),this.addDataIfAvailable("MaxOnConnectTime","MaxOnConnectTime",0,t),this.addDataIfAvailable("HostProtocol","HostProtocol",3,t),this.addDataIfAvailable("RunawayDatalossSystemStartedAt","RunawayDatalossSystemStartedAt",1,t),C.a.logFlightsInOtelSessionStartEndIsEnabled()&&(this.addDataIfAvailable("HasDataLoss","HasDataLoss",1,t),this.addDataIfAvailable("IsRealCoauthSession","IsRealCoauthSession",1,t),this.addDataIfAvailable("PaginatedDurationMs","PaginatedDurationMs",0,t)),A.a.sendTelemetryEvent({name:e,dataFields:t.dataFields}),C.a.isUserActionLoggingToOtelEnabled(this.sessionData.Application)&&"IsRealEdit"in this.sessionData&&this.sessionData.IsRealEdit&&this.sessionData.IsRealEdit&&f.d(Ae.a.editDocument),d.ULS.sendTraceTag(39089114,306,50,"SSED:endsession info sent to Otel")}doLogAutomationMetadata(e){const t=new Array(0);let n;({deserialized:n}=ie.d(this.sessionData.OfficeAutomationMetadata.toString())).returnValue?(this.addAutomationItemIfAvailable("JobId","JobId",3,t,n),this.addAutomationItemIfAvailable("JobClassification","JobClassificationId",3,t,n),this.addAutomationItemIfAvailable("TaskId","TaskId",3,t,n),this.addAutomationItemIfAvailable("TaskExecutionId","TaskExecutionId",3,t,n),this.addAutomationItemIfAvailable("ExecutionNumber","ExecutionNumber",3,t,n),this.addAutomationItemIfAvailable("JobProperties","JobProperties",3,t,n),this.addAutomationItemIfAvailable("ScenarioId","TestId",3,t,n),this.addAutomationItemIfAvailable("ConfigName","ConfigName",3,t,n),A.a.sendTelemetryEvent({name:e,dataFields:t}),d.ULS.sendTraceTag(41302225,306,50,"SSED:automation metadata sent to Otel")):d.ULS.sendTraceTag(41302224,201,10,"SSED:Unable to deserialize OfficeAutomationMetadata")}addAutomationItemIfAvailable(e,t,n,a,i){const o=this.getDataField(i[e],t,n);o&&Array.add(a,o)}addDataIfAvailable(e,t,n,a){if(e in this.sessionData&&this.sessionData[e]){const i=this.getDataField(this.sessionData[e],t,n);i&&a.addFieldIfMissing(i)}}constructor(e,t){this.sessionData=null,this.startTimeOnClient=new Date,this.serverStartTime=null,this.sessionStartNameSpace="Office.Online.SessionStart",this.sessionEndNameSpace="Office.Online.SessionEnd",this.automationMetadataNameSpace="Office.Online.AutomationMetadata",me.b(38844105,200,100,"SSED:Entered SessionStartEndData"),this.startInfoDataFields=new fe,this.sessionFinishedDataPlumber=t,({deserialized:this.sessionData}=ie.d(e)).returnValue?(this.fixUpLoggingDataIfNeeded(),this.initMiscStartData(),this.serializeFlights()):d.ULS.sendTraceTag(38844106,201,10,"SSED:Unable to deserialize SessionStartInfoJson"),this.sessionData&&"StartTimeUtc"in this.sessionData&&(this.serverStartTime=new Date(this.sessionData.StartTimeUtc))}}(0,i.a)(Ge,"SessionStartEndData",null,[]);var Qe=n(7296),qe=n(657),Ke=n(3299);class ze{constructor(){this.containerId=null,this.styles=null}}(0,i.a)(ze,"ToastInitializationOptions",null,[]);var je=n(5709);class Ze extends je.a{constructor(){super(),this.icon=null,this.toastContainerId=null}}(0,i.a)(Ze,"LimitedAppStateToastParameters",je.a,[]);var Xe=n(5970),Je=n(1307);class Ye{get isShowing(){return this._isShowing}createElement(e=!0){if(!this.isRegistered){const e=Object.assign(new Xe.a,{onShow:()=>{this._isShowing=!0}});Je.a.getNotificationsAPIAsync().then((t=>{const n=t.limitedAppStateToast(Object.assign(new Ze,{message:this.message,title:this.title,icon:this.icon,toastContainerId:this.containerId}));return this.id=t.addNotification(n,e),this.registerEntry(this.id,this),this.isRegistered=!0,null}),(e=>(d.ULS.sendTraceTag(512587094,383,15,"Attempt to add app state toast notification failed: {0}",e),null)))}return null}dispose(){this.isRegistered&&Je.a.getNotificationsAPIAsync().then((e=>(this.id&&(e.removeNotification(this.id),this.unregisterEntry(this.id)),this.isRegistered=!1,this._isShowing=!1,null)))}constructor(e){this.id=null,this.isRegistered=!1,this._isShowing=!1,this.message=e.message,this.title=e.title,this.icon=e.icon,this.containerId=e.containerId,this.registerEntry=e.registerEntry,this.unregisterEntry=e.unregisterEntry}}(0,i.a)(Ye,"ReactLimitedAppStateNotificationBarEntry",null,[469,125,11]);class $e{constructor(){this.message=null,this.title=null,this.icon=null,this.containerId=null,this.registerEntry=null,this.unregisterEntry=null}}(0,i.a)($e,"ReactLimitedAppStateNotificationInternalProps",null,[]);const et="LimitedAppStateToastContainer";class tt{addEntry(e){this.initializedNotificationsApi.value.then((()=>{this.isVisible||this.updateContainerWidth(),e.createElement()}))}removeEntry(e){e.dispose(),this.isVisible||this.updateContainerWidth(!0)}get isVisible(){return y.a.any(this.entryById,((e,t)=>t.isShowing))}createEntry(e){const t=Object.assign(new $e,{});return t.icon=e.icon,t.message=e.message,t.title=e.title,t.containerId=et,t.registerEntry=(e,t)=>{this.entryById[e]=t},t.unregisterEntry=e=>{delete this.entryById[e]},new Ye(t)}dispose(){}updateContainerWidth(e=!1){document.getElementById(et).style.width=e?"":"100%"}constructor(e,t){this.entryById={};const n=document.createElement("div");n.id=et,n.className="WACNotificationBar",e.insertBefore(n,t),this.initializedNotificationsApi=new Ke.a((()=>Je.a.getNotificationsAPIAsync().then((e=>{const t={"justify-content":"center"},a={};return a.root=t,e.initializeToastNotifications(n,Object.assign(new ze,{containerId:et,styles:a})),e}),(e=>(d.ULS.sendTraceTag(512587095,383,15,"Notifications API not available. Cannot initialize toast notifications: {0}",e),null)))))}}(0,i.a)(tt,"ReactLimitedAppStateNotificationBar",null,[202,11]);var nt=n(7128),at=n(3989),it=n(6124),ot=n(2409),rt=n(680),st=n(6915),lt=n(1493),ct=n(9969),dt=n(7958),ut=n(1163),pt=n(9936);const gt=e=>{const t={featureName:e,crewAlias:"wordwebsxfc",areaName:"SDX"};return pt.a.getInstance(t)},ht=(e,t,n)=>{let a=null;if("FA000000051"===e?a=gt("Transcribe"):"FA000000125"===e&&(a=gt("CopilotChat")),a)if(t.has("Error.ErrorGroup")){const i=t.get("Error.ErrorGroup");if(t.has("Message")){const e=t.get("Message");n.set("ErrorMessage",e)}a.logKpiFailure(pt.a.getKpiFailureParams(e,i,null,n))}else a.logKpiUsage(pt.a.getKpiUsageParams(e,n))},mt=(e,t,n)=>{const a=gt("Editor");if(a){let i=!1;if(t.has("Tag")){const o=St(t.get("Tag"));n.set("tag",o),t.has("Level")&&(i=2===t.get("Level"),i&&a.logKpiFailure(pt.a.getKpiFailureParams(e,o,null,n)))}i||a.logKpiUsage(pt.a.getKpiUsageParams(e,n))}},_t=(e,t)=>{const n=gt("SDX");n&&n.logKpiUsage(pt.a.getKpiUsageParams(e,t))},St=e=>{const t="abcdefghijklmnopqrstuvwxyz0123456789";let n="";if(e<=65535)return e.toString();let a=0,i=5,o=6;e>>24>=36&&(i=4,o=8);const r=(1<<o)-1;let s=e;for(a=0;a<i;a++){const a=s&r;let i=String.fromCharCode(a);if(6===o){if(a<0||a>=36)return e.toString();i=t.charAt(a)}n=i+n,s>>=o}return"tag_"+n.toLowerCase()};class ft{sendTelemetryEvent(e){e&&(e=>{if(e){const t=e,n=new Map;for(const e of t.dataFields)n.set(e.name,e.value);if(n.has("SDX.Id")){const e=n.get("SDX.Id");if(e.startsWith("FA")&&11===e.length){const a=new Map;switch(a.set("eventName",t.eventName),e){case"FA000000051":case"FA000000125":ht(e,n,a);break;case"FA000000029":mt(e,n,a);break;default:_t(e,a)}}}}})(e)}}(0,i.a)(ft,"SDXKpiTelemetryListener",null,[]);class Ct{static initializeSubComponent(e,t){Ct.initializeSubComponents(e,[t])}static initializeSubComponents(e,t,n=null,a=null){const i={};i.component=e,i.subComponents=t,n&&(i.optionalSubComponents=n),a&&(i.nonReportingSubComponents=a),U.a.dispatch("Wac-SubComponentsInit",i)}static notifyFunctionallyReady(e,t,n=!1){Ct.notifyReady(e,t,"functionally-ready",n)}static notifyVisuallyReady(e,t,n=!1){Ct.notifyReady(e,t,"visually-ready",n)}static notifyUnused(e,t,n=!1){Ct.notifyReady(e,t,"unused",n)}static promoteToVisuallyReady(e,t,n=!1){Ct.notifyReady(e,t,"visually-ready",n,"visually-perceived")}static notifyVisuallyPerceived(e,t,n=!1){Ct.notifyReady(e,t,"visually-perceived",n)}static notifyReady(e,t,n,a=!1,i=null){const o={};o.component=e,o.subComponent=t,o.state=n,o.ignoreNewSubComponents=a,i&&(o.promoteStateFrom=i),U.a.dispatch("Wac-SubComponentSetLoadState",o)}}(0,i.a)(Ct,"RumTracker",null,[]);var yt=n(1509),At=n(5985),bt=n(2280),Tt=n(9611),vt=n(9005);class wt{get properties(){return this._properties}dispose(){}constructor(e){this._properties=e}}(0,i.a)(wt,"RegisteredObjectProperties",null,[11]);class Ft{toString(){return this.id.toString()}constructor(e,t,n){this.id=e,this.type=t,this.flags=n}}(0,i.a)(Ft,"PropertyDefinition",null,[]);class It{static define(e,t,n){return t|e<<10|n<<26}static getStorageType(e){return e>>>26&31}static getPropertySpaceId(e){return e>>>10&65535}static getPropertyIndex(e){return 1023&e}static arePropertiesInSamePropertySpace(e,t){return!(67107840&(e^t))}}(0,i.a)(It,"PropertyId",null,[]);class Et{static fromPropertyDefinition(e){return e.type}static definePropertyType(e,t){return e|t<<16}static getStorageType(e){return e>>>16}static isStringType(e){return e===Et.string||e===Et.byteArray}static isSimpleType(e){return e===Et.uInt_8||e===Et.uInt_16||e===Et.uInt_32||e===Et.int_8||e===Et.int_16||e===Et.int_32||e===Et.float_32||e===Et.float_64||e===Et.oneByte||e===Et.twoBytes||e===Et.fourBytes||e===Et.eightBytes||e===Et.guid||e===Et.objectId||e===Et.objectSpaceId||e===Et.contextId||e===Et.extendedGuid}static isDateTimeType(e){return e===Et.dateTime_32||e===Et.dateTime_64}static isBoolType(e){return e===Et.bool}static isArrayOfPrimitiveType(e){return e===Et.arrayOfUInt_16s||e===Et.arrayOfUInt_32s||e===Et.arrayOfFloat_32s}static isArrayOfObjectSpaceType(e){return e===Et.arrayOfObjectIds||e===Et.arrayOfObjectSpaceIds||e===Et.arrayOfContextIds}static isArrayOfBools(e){return e===Et.arrayOfBools}static isArrayOfPropertySets(e){return e===Et.arrayOfPropertySets}static isArrayOfPropertyValues(e){return e===Et.arrayOfPropertyValues}static isArrayOfStrings(e){return e===Et.arrayOfStrings}static isArrayOfGuids(e){return e===Et.arrayOfGuids}static isArrayOfExtendedGuids(e){return e===Et.arrayOfExtendedGuids}static isArrayOfDateTimes(e){return e===Et.arrayOfDateTime_64s}static isPropertySetType(e){return e===Et.propertySet}static isNullAllowedForPropertyType(e){return!(Et.isSimpleType(e)||Et.isDateTimeType(e)||Et.isArrayOfPrimitiveType(e)||Et.isArrayOfObjectSpaceType(e)||Et.isArrayOfBools(e)||Et.isArrayOfPropertyValues(e))}}Et.nil=Et.definePropertyType(0,0),Et.noData=Et.definePropertyType(1,1),Et.bool=Et.definePropertyType(2,2),Et.oneByte=Et.definePropertyType(3,3),Et.twoBytes=Et.definePropertyType(4,4),Et.fourBytes=Et.definePropertyType(5,5),Et.eightBytes=Et.definePropertyType(6,6),Et.byteArray=Et.definePropertyType(7,7),Et.objectId=Et.definePropertyType(8,8),Et.arrayOfObjectIds=Et.definePropertyType(9,9),Et.objectSpaceId=Et.definePropertyType(10,10),Et.arrayOfObjectSpaceIds=Et.definePropertyType(11,11),Et.contextId=Et.definePropertyType(12,12),Et.arrayOfContextIds=Et.definePropertyType(13,13),Et.reserved14=Et.definePropertyType(14,14),Et.reserved15=Et.definePropertyType(15,15),Et.arrayOfPropertyValues=Et.definePropertyType(16,16),Et.propertySet=Et.definePropertyType(17,17),Et.iUnknown=Et.definePropertyType(18,18),Et.iUnknownInPropertySet=Et.definePropertyType(19,19),Et.reserved20=Et.definePropertyType(20,20),Et.reserved21=Et.definePropertyType(21,21),Et.reserved22=Et.definePropertyType(22,22),Et.reserved23=Et.definePropertyType(23,23),Et.reserved24=Et.definePropertyType(24,24),Et.reserved25=Et.definePropertyType(25,25),Et.reserved26=Et.definePropertyType(26,26),Et.reserved27=Et.definePropertyType(27,27),Et.reserved28=Et.definePropertyType(28,28),Et.reserved29=Et.definePropertyType(29,29),Et.reserved30=Et.definePropertyType(30,30),Et.conflict=Et.definePropertyType(31,31),Et.int_8=Et.definePropertyType(32,3),Et.int_16=Et.definePropertyType(33,4),Et.int_32=Et.definePropertyType(34,5),Et.uInt_8=Et.definePropertyType(36,3),Et.uInt_16=Et.definePropertyType(37,4),Et.uInt_32=Et.definePropertyType(38,5),Et.float_32=Et.definePropertyType(40,5),Et.float_64=Et.definePropertyType(41,6),Et.arrayOfUInt_16s=Et.definePropertyType(47,7),Et.arrayOfUInt_32s=Et.definePropertyType(48,7),Et.arrayOfFloat_32s=Et.definePropertyType(50,7),Et.sz=Et.definePropertyType(54,7),Et.string=Et.definePropertyType(58,7),Et.wt=Et.definePropertyType(59,7),Et.arrayOfStrings=Et.definePropertyType(61,7),Et.arrayOfBools=Et.definePropertyType(62,7),Et.guid=Et.definePropertyType(63,7),Et.arrayOfGuids=Et.definePropertyType(64,7),Et.pointer=Et.definePropertyType(65,6),Et.dateTime_64=Et.definePropertyType(67,6),Et.arrayOfDateTime_64s=Et.definePropertyType(68,7),Et.color=Et.definePropertyType(71,5),Et.dateTime_32=Et.definePropertyType(75,5),Et.arrayOfPropertySets=Et.definePropertyType(78,7),Et.extendedGuid=Et.definePropertyType(79,7),Et.arrayOfExtendedGuids=Et.definePropertyType(80,7),(0,i.a)(Et,"PropertyType",null,[]);class Mt{registerProperty(e){this._properties[e.id]=e,this.addRegisteredObjectProperty(e)}static get instance(){return Mt._instance||(Mt._instance=new Mt)}get properties(){return this._properties}set properties(e){this._properties=e}get registeredObjectProperties(){return this._registeredObjectProperties}get additionalRegisteredObjectProperties(){return this._additionalRegisteredObjectProperties}addRegisteredObjectProperty(e){e.type!==Et.objectId&&e.type!==Et.arrayOfObjectIds||Array.add(this._registeredObjectProperties,e),e.type!==Et.objectId&&e.type!==Et.arrayOfObjectIds&&e.type!==Et.arrayOfPropertyValues&&e.type!==Et.propertySet||Array.add(this._additionalRegisteredObjectProperties,e)}constructor(){this._properties={},this._registeredObjectProperties=[],this._additionalRegisteredObjectProperties=[]}}Mt._instance=null,(0,i.a)(Mt,"PropertiesManagerStatic",null,[]);class kt{static defineProperty(e,t,n,a){const i=new Ft(It.define(e,t,Et.getStorageType(n)),n,a);return Mt.instance.registerProperty(i),i}}(0,i.a)(kt,"APropertySpace",null,[]);class Pt extends kt{static $$cctor(){}static ensureLoaded(){}static defineProperty$1(e,t){return kt.defineProperty(2,e,t,0)}constructor(){super()}}Pt.nil=Pt.defineProperty$1(0,Et.nil),Pt.noData=Pt.defineProperty$1(1,Et.noData),Pt.bool=Pt.defineProperty$1(2,Et.bool),Pt.oneByteOfData=Pt.defineProperty$1(3,Et.oneByte),Pt.twoBytesOfData=Pt.defineProperty$1(4,Et.twoBytes),Pt.fourBytesOfData=Pt.defineProperty$1(5,Et.fourBytes),Pt.eightBytesOfData=Pt.defineProperty$1(6,Et.eightBytes),Pt.fourBytesOfLengthFollowedByData=Pt.defineProperty$1(7,Et.byteArray),Pt.objectId=Pt.defineProperty$1(8,Et.objectId),Pt.arrayOfObjectIds=Pt.defineProperty$1(9,Et.arrayOfObjectIds),Pt.objectSpaceId=Pt.defineProperty$1(10,Et.objectSpaceId),Pt.arrayOfObjectSpaceIds=Pt.defineProperty$1(11,Et.arrayOfObjectSpaceIds),Pt.contextId=Pt.defineProperty$1(12,Et.contextId),Pt.arrayOfContextIds=Pt.defineProperty$1(13,Et.arrayOfContextIds),Pt.reserved14=Pt.defineProperty$1(14,Et.reserved14),Pt.reserved15=Pt.defineProperty$1(15,Et.reserved15),Pt.arrayOfPropertyValues=Pt.defineProperty$1(16,Et.arrayOfPropertyValues),Pt.propertySet=Pt.defineProperty$1(17,Et.propertySet),Pt.iUnknown=Pt.defineProperty$1(18,Et.iUnknown),Pt.iUnknownInPropertySet=Pt.defineProperty$1(19,Et.iUnknownInPropertySet),Pt.reserved20=Pt.defineProperty$1(20,Et.reserved20),Pt.reserved21=Pt.defineProperty$1(21,Et.reserved21),Pt.reserved22=Pt.defineProperty$1(22,Et.reserved22),Pt.reserved23=Pt.defineProperty$1(23,Et.reserved23),Pt.reserved24=Pt.defineProperty$1(24,Et.reserved24),Pt.reserved25=Pt.defineProperty$1(25,Et.reserved25),Pt.reserved26=Pt.defineProperty$1(26,Et.reserved26),Pt.reserved27=Pt.defineProperty$1(27,Et.reserved27),Pt.reserved28=Pt.defineProperty$1(28,Et.reserved28),Pt.reserved29=Pt.defineProperty$1(29,Et.reserved29),Pt.reserved30=Pt.defineProperty$1(30,Et.reserved30),Pt.conflict=Pt.defineProperty$1(31,Et.conflict),Pt.reportingCustomData1=Pt.defineProperty$1(32,Et.uInt_32),Pt.reportingCustomData2=Pt.defineProperty$1(33,Et.uInt_32),Pt.maxPropertyIndex=33,(0,i.a)(Pt,"CommonProperties",kt,[]),Pt.$$cctor();class Dt{get properties(){return this._propertiesManagerStaticInstance.properties}set properties(e){this._propertiesManagerStaticInstance.properties=e}start(){++this._refCount}stop(){--this._refCount||(this.properties={},this._unregisteredProperties={})}registerProperty(e){this._propertiesManagerStaticInstance.registerProperty(e)}unregisteredPropertiesRead(e){return this._unregisteredProperties[e]}unregisteredPropertiesAdd(e,t){this._unregisteredProperties[e]=t}addRegisteredObjectProperty(e){this._propertiesManagerStaticInstance.addRegisteredObjectProperty(e)}readRegisteredObjectProperties(){return new wt(this._propertiesManagerStaticInstance.registeredObjectProperties)}readAdditionalRegisteredObjectProperties(){return new wt(this._propertiesManagerStaticInstance.additionalRegisteredObjectProperties)}findPropertyByStringId(e){let t;return t=this.properties[e],t||(t=this.unregisteredPropertiesRead(e)),t}lookupPropertyByString(e){let t=this.properties[e];return t||(t=this.unregisteredPropertiesRead(e)),t||(t=this.createAndRegisterProperty(parseInt(e))),t}lookupProperty(e){let t;const n=e.toString();return t=this.properties[n],t||(t=this.unregisteredPropertiesRead(n)),t||(t=this.createAndRegisterProperty(e)),t}createAndRegisterProperty(e){const t=It.getStorageType(e);if(!Pt.nil)throw vt.a.invalidOperation("Cannot find the common property definitions");const n=It.define(2,t,It.getStorageType(e)),a=this.properties[n];const i=new Ft(e,a.type,0);return this.unregisteredPropertiesAdd(e.toString(),i),this.addRegisteredObjectProperty(i),i}isPersistedProperty(e){switch(It.getPropertySpaceId(e)){case 14:case 8:case 0:case 6:case 16:case 17:case 26:return!1;default:return!0}}static get instance(){return Dt._instance||(Dt._instance=new Dt(Mt.instance))}constructor(e=null){this._refCount=0,this._propertiesManagerStaticInstance=null,this._unregisteredProperties={},this._propertiesManagerStaticInstance=e||new Mt}}Dt._instance=null,(0,i.a)(Dt,"PropertiesManager",null,[]);var Rt=n(7449),xt=n(1634),Lt=n(7112),Ut=n(4934),Ot=n(734),Bt=n(2693),Nt=n(682),Wt=n(3798),Ht=n(9800),Vt=n(1251),Gt=n(1510),Qt=n(2118),qt=n(6865),Kt=n(956),zt=n(1801),jt=n(9606),Zt=n(9838);const Xt="ASEK",Jt="AWEK",Yt="IHFTSEK";class $t{static get userSessionIdQueryParam(){return oe.AFrameworkApplicationConstants.userSessionIdQueryParam}static get browserBuildQueryParam(){return oe.AFrameworkApplicationConstants.browserBuildQueryParam}static get noAuthQueryParam(){return oe.AFrameworkApplicationConstants.noAuthQueryParam}static get officeApplicationModeDatapointId(){return oe.AFrameworkApplicationConstants.officeApplicationModeDatapointId}static get modeSwitchTimeParamName(){return oe.AFrameworkApplicationConstants.modeSwitchTimeParamName}static get previousSessionParamName(){return oe.AFrameworkApplicationConstants.previousSessionParamName}static get correlationIdQueryParam(){return oe.AFrameworkApplicationConstants.correlationIdQueryParam}static get uiHostParamName(){return oe.AFrameworkApplicationConstants.uiHostParamName}static get invalidHostCanaryRedirectParamName(){return oe.AFrameworkApplicationConstants.invalidHostCanaryRedirectParamName}static get controllerServicesParamName(){return oe.AFrameworkApplicationConstants.controllerServicesParamName}static get hostUIControlSettingName(){return oe.AFrameworkApplicationConstants.hostUIControlSettingName}static get uiHostSettingName(){return oe.AFrameworkApplicationConstants.uiHostSettingName}static get uiHostIntegrationTypeSettingName(){return oe.AFrameworkApplicationConstants.uiHostIntegrationTypeSettingName}static get uiHostScenarioTypeSettingName(){return oe.AFrameworkApplicationConstants.uiHostScenarioTypeSettingName}static get theClientRequestManager(){return oe.AFrameworkApplicationConstants.theClientRequestManager}static set theClientRequestManager(e){oe.AFrameworkApplicationConstants.theClientRequestManager=e,$t.listenForWacTokenMessage()}static listenForWacTokenMessage(){$t.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9895199_DisableAcquireTokenPostMessage")&&$t.get_hostPostmessengerFuture().execute((e=>{e.addAllowedReceivingMessage("Host_PostWacToken"),e.registerCallback("Host_PostWacToken",$t.receivePostWacTokenMessage)}))}static receivePostWacTokenMessage(e){const t=e.Values.wacToken,n=e.Values.postWacTokenStart;if(t&&"string"==typeof t){if(d.ULS.sendTraceTag(507873093,3e3,50,"Received PFT token to WAC. Length: "+t.length),!$t.theClientRequestManager)return void d.ULS.sendTraceTag(507807195,3e3,15,"AFrameworkApplication.theClientRequestManager is not initialized yet. This should never happen.");const e="Bearer "+t;if($t.theClientRequestManager.wacAcquireToken||(d.ULS.sendTraceTag(507327242,204,20,"Received WAC Acquire token"),$t.theClientRequestManager.wacAcquireToken=e),$t.theClientRequestManager.wacaadToken){const t=$t.theClientRequestManager.wacaadToken===e;d.ULS.sendTraceTag(507873092,3e3,50,`Received a PFT token to WAC, but we already have one. Length: ${e.length}. Token is ${t?"the same as":"different than"} the one already provided.`),t||$t.get_hostPostmessengerFuture().execute((e=>{e.sendMessage("App_WacTokenAck",{TokenAlreadySet:!0}),e.unregisterCallback("Host_PostWacToken")}))}else{const t=n&&"number"==typeof n?{durationMs:dt.a.getTickCount()-n}:{};W.Health.instance.recordKpiImpliedSuccess("PostWacToken","owlfc",t),d.ULS.sendTraceTag(507774683,204,20,"Received WAC token"),$t.theClientRequestManager.wacaadToken=e,$t.get_hostPostmessengerFuture().execute((e=>{e.sendMessage("App_WacTokenAck",{TokenAlreadySet:!1}),e.unregisterCallback("Host_PostWacToken")}))}}}static get pairwiseBrokerHostCompleteListener(){return $t._pairwiseBrokerHostCompleteListener}static get userSessionId(){return oe.AFrameworkApplicationConstants.userSessionId}static set userSessionId(e){oe.AFrameworkApplicationConstants.userSessionId=e}static get buildVersion(){return oe.AFrameworkApplicationConstants.buildVersion}static set buildVersion(e){oe.AFrameworkApplicationConstants.buildVersion=e}static get feedbackDescription(){return oe.AFrameworkApplicationConstants.feedbackDescription}static set feedbackDescription(e){oe.AFrameworkApplicationConstants.feedbackDescription=e}static get uiCulture(){return oe.AFrameworkApplicationConstants.uiCulture}static set uiCulture(e){oe.AFrameworkApplicationConstants.uiCulture=e}static get isDivSyndicated(){return oe.AFrameworkApplicationConstants.isDivSyndicated}static set isDivSyndicated(e){oe.AFrameworkApplicationConstants.isDivSyndicated=e}static get isShuttingDown(){return oe.AFrameworkApplicationConstants.isShuttingDown}static set isShuttingDown(e){oe.AFrameworkApplicationConstants.isShuttingDown=e}static get accessTokenParamName(){return oe.AFrameworkApplicationConstants.accessTokenParamName}static set accessTokenParamName(e){oe.AFrameworkApplicationConstants.accessTokenParamName=e}static get accessTokenServerExpirationTime(){return oe.AFrameworkApplicationConstants.accessTokenServerExpirationTime}static set accessTokenServerExpirationTime(e){oe.AFrameworkApplicationConstants.accessTokenServerExpirationTime=e}static get useCrossOriginStaticScripts(){return oe.AFrameworkApplicationConstants.useCrossOriginStaticScripts}static set useCrossOriginStaticScripts(e){oe.AFrameworkApplicationConstants.useCrossOriginStaticScripts=e}static get sessionStartInfoSettings(){return oe.AFrameworkApplicationConstants.sessionStartInfoSettings}static set sessionStartInfoSettings(e){oe.AFrameworkApplicationConstants.sessionStartInfoSettings=e}static get featureStatusSettings(){return this.featureStatusSettingsValue}static set featureStatusSettings(e){this.featureStatusSettingsValue=e}static get dataPlumber(){return oe.AFrameworkApplicationConstants.dataPlumber}static set dataPlumber(e){oe.AFrameworkApplicationConstants.dataPlumber=e}updateOpenInClientDocumentUrl(e){return null}static get theDefaultErrorHandler(){return Lt.a.theDefaultErrorHandler}static set theDefaultErrorHandler(e){Lt.a.theDefaultErrorHandler=e}get irmPolicyTitle(){return $t._irmPolicyTitle}get irmPolicyDescription(){return $t._irmPolicyDescription}get supportsFrameTrustCheck(){try{return-1!==window.location.href.toLowerCase().indexOf("&sftc=1")}catch(e){d.ULS.sendTraceTag(508396375,306,10,"Exception while getting SupportsFrameTrustCheck:{0}",e)}return!1}get modeMenuForOneNoteEnabled(){return!1}bodyID(){return"MainApp"}get isActivityTaskPaneWithNewInfrastructureEnabled(){return!1}get isRibbonFlexBoxLayoutEnabled(){return!1}get isSimplifiedReactRibbonUxEnabled(){return!1}get isReactMultilineRibbonEnabled(){return!1}get isReactStatusBarEnabled(){return!1}get isReactRibbonEnvironmentEnabled(){return this.isSimplifiedReactRibbonUxEnabled||this.isReactMultilineRibbonEnabled}get isShyRibbonEnabled(){return!1}get shouldRenderReactMultilineRibbon(){return!1}get delayInstallAddInIsEnabled(){return!1}get shouldResizeLegacyDialogBeforeFocus(){return!1}get skipReparentOfHeaderPanel(){return!1}get isReactSharedHeaderUxEnabled(){return!$t.hideHeaderEmbedded}get isSharedHeaderPlaceholderEnabled(){return!1}get isSharedHeaderSearchUxEnabled(){return!$t.hideSearchInHeaderByUiHost}get isSharedHeaderVersionHistoryEnabled(){return!1}get isSharedHeaderThemingEnabled(){return!1}get isReactFileMenuUxEnabled(){return!1}get isReactFileMenuWithHomeEnabled(){return!1}get isReactRibbonTabRefreshEnabled(){return!1}get isReactFloatieEnabled(){return!1}get isReactTabbedTaskPaneInfrastructureEnabled(){return!1}get isTaskPaneResizingEnabled(){return!1}get isFirstPartyTaskPaneResizeEnabled(){return!1}get isReactDialogEnabled(){return!1}get isReactJustificationDialogEnabled(){return!1}get isReactFileUploadErrorDialogEnabled(){return!1}get isReactDialogWithLinkToResourceEnabled(){return!1}get isReactRefreshDialogEnabled(){return!1}get isReactCommercialPrivacyNoticeDialogEnabled(){return!1}get isReactCommercialTrustCenterDialogEnabled(){return!0}get isReactInsertFileDialogEnabled(){return!0}get isReactAccCheckerPaneEnabled(){return!1}get isReactNotificationsEnabled(){return!1}get limitedAppStateNotificationBar(){return $t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LimitedAppStateNotificationsEnabled",!1)?(this.isRegionComposerEnabled&&!$t._limitedAppStateNotificatioBar&&($t._limitedAppStateNotificatioBar=new tt(document.getElementById("NotificationBarRegion"),null)),$t._limitedAppStateNotificatioBar):null}get isReactSmartLookupTaskPaneEnabled(){return!1}get isReactEquationToolsTaskPaneEnabled(){return!1}get isMathAssistantSDXTaskPaneEnabled(){return!1}get isReactInsertLinkDialogEnabled(){return!0}get isRegionComposerEnabled(){return!1}get isResponsiveUxEnabled(){return!1}get isAppSpecificReactDialogEnabled(){return!1}get isExperimentalBundleEnabled(){return!1}get isRibbonVisualRefreshEnabled(){return!1}get isChangesButtonEnabled(){return!1}get isTellMeServiceEdogEndpointOverrideEnabled(){return!1}get isTellMeServiceProdEndpointOverrideEnabled(){return!1}get isTellMeUseServiceForCommandClassifierEnabled(){return!1}get isTellMeServiceSendParameterInRequestBodyEnabled(){return!1}get isTellMeServiceResultsForSearchEnabled(){return!1}get isFindInDocumentWithMatchesEnabled(){return!1}get customFallbackMessageForPrintDialog(){return""}get shouldFetchTokensForSearch(){return!1}get shouldShowAnswerSearchResults(){return!1}get shouldShowDefinitionSearchResults(){return!1}get shouldShowEntitySearchResults(){return!1}get shouldShowWolframSearchResults(){return!1}get shouldFindInDocWithMatchesOpenSerplet(){return!1}get shouldHelpShowNumberOfMatches(){return!1}get shouldHelpShowTopSearchResult(){return!1}get isTellMeInSharedHeaderEnabled(){return!$t.hideSearchInHeaderByUiHost}get isTellMeNBCommandProviderEnabled(){return this.isReactRibbonEnvironmentEnabled&&$t.appSettingsManager.getBooleanAppSetting("TellMeNBCommandProviderIsEnabled")&&"en-US"===$t.uiCulture}static get isO365Host(){return null!=$t.__cached_isO365Host_0_568dd0cd?$t.__cached_isO365Host_0_568dd0cd:$t.__cached_isO365Host_0_568dd0cd=$t.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost")||$t.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost")}get isCommentsButtonInCollabCornerEnabled(){return!1}get isSimplifiedReactRibbonUxFlightEnabled(){return this.isSimplifiedReactRibbonUxEnabled}get isSimplifiedUXOptOutInViewTabFlightEnabled(){return!1}get isTransistionalHeaderUIEnabled(){return!1}get officeAppType(){return 0}get officeAppMode(){return 0}get clientUrl(){return""}get isBusinessUser(){return!!$t.sessionStartInfoSettings.IsBusinessUser}get isEduUser(){return!!$t.sessionStartInfoSettings.IsEduUser}get commandsToHostControlIdsMap(){return{}}shouldCommandBeHostControlled(e){if(e in this.commandsToHostControlIdsMap&&$t.appSettingsManager.containsAppSetting($t.hostUIControlSettingName)&&$t.appSettingsManager.getStringAppSetting($t.hostUIControlSettingName)){const t=this.commandsToHostControlIdsMap[e],n=$t.appSettingsManager.getListAppSetting($t.hostUIControlSettingName);for(let e=0;e<n.length;e++){const a=n[e];if(a.id===t&&1===a.visibility)return!0}}return!1}isEntryExistent(e){return!1}addEntryToBusinessBar(e,t){return!1}removeEntryFromBusinessBar(e){return!1}addGdprBusinessBar(e,t,n){}addGdprBusinessBarWithCloseCallback(e,t,n,a){this.addGdprBusinessBar(e,t,n)}privacyRefreshRequested(){$t.activeFrame.refreshDocument(null)}addDatacenterDecommissionWarning(e){}saveAction(){return()=>{}}get isSyncUxFeatureEnabled(){return!1}get newAndOpenHandlerUrlPrefix(){return""}get isFocusManagerBugFixEnabled(){return this._isFocusManagerBugFixEnabled}getFileOpenProperties(){return null}get catchUpFlyoutEnabled(){return!1}get diagnosticsBuildVersion(){return $t.buildVersion}get diagnosticsSessionId(){return $t.userSessionId}get isHttp2Enabled(){return this._isHttp2Enabled}createMinimumSessionStartInfoSettingsAfterJsonException(e){const t={};return null!==e&&(t.Application=e.Application||"",t.WACSessionID=e.SessionId||""),t}initialize(e){const t="true",n="false";$t._isUpdateFullSessionStartInfoCalled=!1,Nt.a.instance.addMark(de.a.appInitStart),this._isHttp2Enabled=Boolean.parse(e.StaticContentPrefetchUsingHttp2IsEnabled||n);const a=new Date;if($t.bootTime=a.getTime(),I.a.get_instance().setAppInitializationStatus(1),$t.appSettingsManager=this.createAppSettingsManager(e),d.ULS.setExceptionLogging($t.appSettingsManager.getBooleanAppSetting("BUlsExceptionLoggingIsEnabled")),d.ULS.setImportantLogging(!0),($t.appSettingsManager.getBooleanAppSetting("SanitizeCookiesEnabled")||$t.appSettingsManager.getBooleanAppSetting("SanitizeCookiesAtBootEnabled"))&&ot.a.sanitizeCookies(),($t.appSettingsManager.getBooleanAppSetting("OneNoteHardBlockBrowsersEnabled")||$t.appSettingsManager.getBooleanAppSetting("HardBlockUnsupportedBrowsers"))&&(R.a.instance.runFeatureChecks($t.appSettingsManager),!R.a.instance.areBrowserFeaturesSupported)){d.ULS.sendTraceTag(507561162,306,20,"AFrameworkApplication.Initialize: Browser features are not supported. Redirecting to UpgradeBrowser page.");const e="/o/UpgradeBrowser.htm",t=window.navigator.userLanguage||window.navigator.browserLanguage||window.navigator.language,n=window.location.protocol+"/"+"0".replace("0","")+"/"+window.location.host+e+"?llcc="+t;this.redirectOutside(n,40)}this.initSessionStartInfoSettings(e.SessionStartInfoJson||""),this.initializeOtel(),e.FeatureStatus&&this.initializeFeatureStatusSettings(e.FeatureStatus),ce.a.instance.notifyReadyToConfigure(bt.a.instance),zt.a.listenForChunkLoads(),window.g_logMSAjaxErrorCallback=$t.logMSAjaxError,window.g_logMSAjaxInfoCallback=$t.logMSAjaxInfo,$t.showPageStats=Boolean.parse(e.ShowPageStats||n),$t.collectPageStats=Boolean.parse(e.CollectPageStats||n),$t.collectPageStats&&e.PageStats&&""!==e.PageStats&&($t.appPreloadStatistics=e.PageStats),Dt.instance.start(),g.ActionManager.actionIdResolverDelegate=(0,u.a)(this,this.resolveActionId,"resolveActionId"),g.ActionManager.contextIdResolverDelegate=(0,u.a)(this,this.resolveContextId,"resolveContextId"),g.ActionManager.commandIdResolverDelegate=(0,u.a)(this,this.resolveCommandId,"resolveCommandId"),V.EventHandlerManager.instance.setOnEventInterruptedTask(this.reportEventInterruptedJavascript),nt.WacAirSpace.registerDomEvents(),$t.buildVersion=e.BuildVersion||"0.0.0.0",$t.firstRunExperienceIsEnabled=Boolean.parse(e.FirstRunExperienceIsEnabled||n),$t.firstRunExperienceUiVariation=parseInt(e.FirstRunExperienceUiVariation||"0"),$t.lcid=parseInt(e.Lcid||"1033"),$t.uiCulture=e.UICulture||"en-US",$t.dataCulture=e.DataCulture||$t.uiCulture,$t.requestedLcid=parseInt(e.RequestedLcid||$t.lcid.toString()),$t.canary=e.Canary,$t.hostCanary=e.HostCanary,$t.isUnauthEdit=Boolean.parse(e.IsUnauthEdit||n),$t._isEmbedded=Boolean.parse(e.IsEmbedded||n),$t.isUIEmbedMode=Boolean.parse(e.IsUIEmbedMode||n),$t.supportsInPlaceCreateNew=Boolean.parse(e.ShouldSupportInPlaceCreateNewByUiHost||n),$t.disableEmbedViewCodeSnippet=Boolean.parse(e.ShouldDisableEmbedViewCodeSnippetByUiHost||n),$t._isNoChrome=Boolean.parse(e.IsNoChrome||n),$t._requiresCheckout=Boolean.parse(e.RequiresCheckout||n),$t.useParentHelpFunction=Boolean.parse(e.UseParentHelpFunction||n),$t.feedbackStringId=parseInt(e.CfString||"0"),$t.showRtcConnectionStatus=Boolean.parse(e.ShowRtcConnectionStatus||n),$t._sleepIntervalInMsec=1e3*parseInt(e.SleepInterval),$t._trimOICButtonsIfUnavailable=Boolean.parse(e.TrimOICButtonsIfUnavailable||n),$t.isCrossDocumentMessengerDisabled=Boolean.parse(e.CrossDocumentMessengerDisabled||n),$t.isOpenInClientEnabled=!0,$t.userSessionId=e.SessionId,$t.isRtl=Boolean.parse(e.Rtl||n),$t.shortDateFormat=e.ShortDateFormat,$t.shortTimeFormat=e.ShortTimeFormat,$t.appSettingsManager?.isChangeGateEnabled("CAETokenSecurePodHandlerAPI")?$t.accessToken=e.AccessToken||e.access_token||"":$t.accessToken=e.AccessToken||"",$t.userType=e.UserType||"UNKNOWN",$t.tellMeIsEnabled=Boolean.parse(e.TellMeIsEnabled||n),$t.hideSearchInHeaderByUiHost=Boolean.parse(e.HideSearchInHeaderByUiHost||n),$t.hideMeInHeaderByUiHost=Boolean.parse(e.HideMeInHeaderByUiHost||n),$t.hideAppLauncherInHeaderByUiHost=Boolean.parse(e.HideAppLauncherInHeaderByUiHost||n),$t.hideWorkflowInHeaderByUiHost=Boolean.parse(e.HideWorkflowInHeaderByUiHost||n),$t.hideChatInHeaderByUiHost=Boolean.parse(e.HideChatInHeaderByUiHost||n),$t.isMeetingLiveSession=Boolean.parse(e.IsMeetingLiveSession||n),$t.isMeetingPresenter=Boolean.parse(e.IsMeetingPresenter||n),$t.meetingId=e.MeetingId,$t.meetingTitle=e.MeetingTitle,$t.meetingType=e.MeetingType,$t.meetingOrganizerId=e.MeetingOrganizerId,$t.meetingJoinUrl=e.MeetingJoinUrl,$t.liveInTeamsWordAppSharingUrl=e.LiveInTeamsWordAppSharingUrl,$t.meetingScheduledStartTime=e.MeetingScheduledStartTime,$t.meetingScheduledEndTime=e.MeetingScheduledEndTime,$t.defaultDocumentTitleToLeftByUiHost=Boolean.parse(e.DefaultDocumentTitleToLeftByUiHost||n),$t._dataBoundary=$t.appSettingsManager.getIntAppSetting("DataBoundary",0),d.ULS.sendTraceTag(508396371,230,50,"AFrameworkApplication::Initialize::IsMeetingLiveSession: {0}. MeetingId: {1}. IsMeetingPresenter: {2}. MeetingOrganizerId: {3}. MeetingJoinUrl: {4}",$t.isMeetingLiveSession,$t.meetingId,$t.isMeetingPresenter,$t.meetingOrganizerId,$t.meetingJoinUrl),$t.dataPlumber.fillFromAppSettings($t.appSettingsManager),(0,o.h)(c.a).execute((e=>{e.add_onSettingsRefreshed((0,u.a)($t.dataPlumber,$t.dataPlumber.handleOnSettingsRefresh,"handleOnSettingsRefresh"))})),$t._shouldHideToolbarOnViewerRedirect=Boolean.parse(e.ShouldHideToolbarOnViewerRedirect||n),$t.initializeBulsProperties(e),window.g_sid=$t.userSessionId,$t.rtcTransportProtocol=e.RtcTransportProtocol,$t._newMenuMoreTemplatesUrl=e.NewMenuMoreTemplatesUrl,$t._documentIsFolder=Boolean.parse(e.DocumentIsFolder||n),$t.appSupportsFileRename=Boolean.parse(e.AppSupportsFileRename||n),$t.appSupportsVersionHistory=Boolean.parse(e.AppSupportsVersionHistory||n),$t.appSupportsInsertOnlinePictureFromHost=Boolean.parse(e.AppSupportsInsertOnlinePictureFromHost||n),$t.appSupportsInsertOnlinePictureFromSharePoint=Boolean.parse(e.AppSupportsInsertOnlinePictureFromSharePoint||n),$t.insertOnlinePictureFromHostEnabled=Boolean.parse(e.InsertOnlinePictureFromHostEnabled||n),$t.appSupportsMultiInsertOnlinePictureFromHost=Boolean.parse(e.AppSupportsMultiInsertOnlinePictureFromHost||n),this._isFocusManagerBugFixEnabled=Boolean.parse(e.FocusManagerBugFixEnabled||n),$t._mruPollingIntervalInMs=parseInt(e.MruPollingIntervalInMs||"1200000"),$t._timeUntilInactiveInMs=parseInt(e.TimeUntilInactiveInMs||"420000"),$t.isCustomerFeedbackExternal=Boolean.parse(e.CfExternal||n),$t._getMoreInfoRetryIntervalsInMs=e.GetMoreInfoRetryIntervalsInMs,$t._wacCopyPasteShortcutDialogIsEnabled=Boolean.parse(e.WacCopyPasteShortcutDialogIsEnabled||n),$t._isDogfoodEnvironment=Boolean.parse(e.IsDogfoodEnvironment||n),$t.useO365ShellService=Boolean.parse(e.UseO365ShellService||n),Boolean.parse(e.LogNonDissmissibleDialogForAllApps||n)&&!$t.errorDialogAdditionalQosVetos.length&&($t.errorDialogAdditionalQosVetos=["NonDismissibleDialog"]);try{const e=(new Date).getTime(),t=$t.appSettingsManager.getLongAppSetting("AccessTokenExpirationInMs",0);t<0&&d.ULS.sendTraceTag(508396370,201,50,t.toString()),$t.accessTokenTtl=t?e+t:0,$t.accessTokenServerExpirationTime=$t.appSettingsManager.getLongAppSetting("AccessTokenTtl",0)}catch(e){$t.accessTokenTtl=0}try{$t.accessTokenExpirationPromptSeconds=Number.parseInvariant(e.AccessTokenExpirationPromptSeconds)}catch(e){$t.accessTokenExpirationPromptSeconds=0}$t.roamingAppsX86RootUrl=e.RoamingAppsX86RootUrl||"",$t.roamingAppsControlInstallerUrl=ct.a.addParameterValue(e.RoamingAppsControlInstallerUrl||"","clid",$t.lcid.toString()),$t.roamingAppsFirefoxExtensionUrl=ct.a.addParameterValue(e.RoamingAppsFirefoxExtensionUrl||"","clid",$t.lcid.toString()),$t.hideHeader=Boolean.parse(e.HideHeader||n),$t.isMobileMode=Boolean.parse(e.IsMobileMode||n),$t.hasExternalHeader=!Boolean.parse(e.HeaderInsideRibbonIsEnabled||n),$t.forceTouchRibbon=Boolean.parse(e.ForceTouchRibbon||n),$t.useCrossOriginStaticScripts=Boolean.parse(e.UseCrossOriginStaticScripts||n),at.a.applicationNameLong=e.WebAppLongName,at.a.applicationNameShort=e.WebAppShortName,document.body.id=this.bodyID(),$t._splashscreenElement=document.getElementById("load_img"),$t._splashscreenOverlay=document.getElementById("load_back"),$t._isSplashScreenUp=!!$t._splashscreenElement&&!!$t._splashscreenOverlay,$t._canvasSkeletalUXElement=document.getElementById("SkeletalPage"),$t._isCanvasSkeletalUXUp=!!$t._canvasSkeletalUXElement,Bt.a.webToadHostName=e.WebToadHostName,$t._ribbonRegionElement=document.getElementById("RibbonRegion"),$t.appSettingsManager.isFullAppSettingsReady&&this.updateFullAppSettings(e),this.updateMiniCheckBasedAppSettings(e),$t.ensureAwake(),G.a.setEnsureAppAwakeCallback($t.ensureAwake),G.a.setEnsureAppAwakeIfAsleepCallback($t.ensureAwakeIfAsleep),$t.endSessionHeaderReceivedCallback=this.crashApplication,$t.assistanceIsEnabled=e.AssistanceIsEnabled===t,$t.assistancePaneIsEnabled=e.AssistancePaneIsEnabled===t,$t.assistanceSearchUrl=e.AssistanceSearchUrl,$t.copyLinkForTeamsIsEnabled=$t.appSettingsManager.getBooleanAppSetting("CopyLinkForTeamsIsEnabled"),$t.isUnifiedHostMode=$t.appSettingsManager.getBooleanAppSetting("IsUnifiedHostMode"),$t.lokiEndpointForSearch=e.LokiEndpointForSearch,$t.tellMeQueryIndexLoggingBaseUrl=e.TellMeQueryIndexLoggingBaseUrl,$t.substrateEndpointForSearch=e.SubstrateEndpointForSearch,$t.tellMeServiceEndpointForSearch=e.TellMeServiceEndpointForSearch,$t.insightsUrl=e.InsightsUrl||"",$t.smartLookupIsEnabled=e.SmartLookupIsEnabled===t,$t.documentAssemblyEnabledV2=Boolean.parse(e.HostSupportCAAEMode||n),$t.documentAssemblyEnabledModes=e.HostSupportForCAAEModes||"",$t.insightsIsEnabled=Boolean.parse(e.InsightsIsEnabled||n),$t.allowEarlyFeaturesForHost=Boolean.parse(e.AllowEarlyFeaturesForHost||n),$t._environment=$t.appSettingsManager.getIntAppSetting("Environment",0),this.initSessionStartAndEndData(),H.a.initialize(),$t.healthTelemetrySystemSupportCrashReportingSuppression=Boolean.parse(e.HealthTelemetrySystemSupportCrashReportingSuppression||n),$t.splitCrashError=Boolean.parse(e.SplitCrashError||n),$t.reportAdditionCrashProperties=Boolean.parse(e.ReportAdditionCrashProperties||t),$t.reportSuppressedCrashesToWatson=Boolean.parse(e.ReportSuppressedCrashesToWatson||n),$t._cursorPinningIsEnabled=Boolean.parse(e.CursorPinningIsEnabled||t),$t._nativeSelectionAndContextMenu=$t.appSettingsManager.getBooleanAppSetting("MobileEmbedViewerIsEnabled"),$t._removeWacDialogKeyUpHandler=Boolean.parse(e.RemoveWacDialogKeyUpHandler||n),$t.hostOperationHttpStatusCode=$t.appSettingsManager.getIntAppSetting("HostOperationHttpStatusCode",0),$t.hostOperationNetworkErrorStatusCode=e.HostOperationNetworkErrorStatusCode,$t.clientPermissionDeniedDueToNetworkLocation=$t.appSettingsManager.getBooleanAppSetting("ClientPermissionDeniedDueToNetworkLocation"),$t.enrichmentPaneUrl=e.EnrichmentPaneUrl||"",$t.enrichmentIsEnabled=Boolean.parse(e.EnrichmentIsEnabled||"false"),$t.isNewFile=Boolean.parse(e.CreateNew||"false"),$t.isNewFile&&($t._newFileTemplateName=e.CreateNewTemplateName,$t._newFileTemplateLcid=e.CreateNewTemplateLcid),$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CanvasHandoffEnabled",!1)||$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasHandoffEnabled",!1)?$t.handOffMessageId=e.HandoffMessageId:$t.handOffMessageId=e.HandoffMessageId||"",$t.formatReuseMessageId=e.FormatReuseMessageId||"",$t.hideHeaderEmbedded=Boolean.parse(e.HideHeaderEmbedded||n),$t.hideRibbonEmbedded=Boolean.parse(e.HideRibbonEmbedded||n),$t.hideContextMenu=Boolean.parse(e.HideContextMenu||n),$t.hideRibbon=Boolean.parse(e.HideRibbon||n),($t.documentAssemblyEnabledV2||""!==$t.documentAssemblyEnabledModes)&&($t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)&&"DocGen"!==$t.documentAssemblyEnabledModes&&"ContentAssemblyView"!==$t.documentAssemblyEnabledModes||($t.hideRibbon=!0),$t.appSettingsManager.appSettings.DefaultMainViewModeOverride="WebView"),$t.wopiIdentityWhitelist=(e.WopiIdentityWhitelist||"").split(","),$t.isWopiTokenRefreshEnabled=$t.appSettingsManager.getBooleanAppSetting("WOPITokenRefreshIsEnabled")&&$t.appSettingsManager.getBooleanAppSetting("UiHostSupportsTokenRefresh"),$t._isWopiTokenRefreshWhenSessionExpiredEnabled=$t.appSettingsManager.getBooleanAppSetting("WOPITokenRefreshWhenSessionExpiredIsEnabled"),$t._isWopiTokenRefreshCancelExpirationEnabled=$t.appSettingsManager.getBooleanAppSetting("WOPITokenRefreshCancelExpirationIsEnabled"),$t.wopiTokenLastRefreshTime=$t.bootTime,$t.wopiTokenExpiresAfterMinutes=$t.appSettingsManager.getIntAppSetting("WOPITokenExpiresAfterMinutes",0),$t._wopiTokenRefreshMaxRetryAttempts=$t.appSettingsManager.getIntAppSetting("WopiTokenRefreshMaxRetryAttempts",3),$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ServerFileSuffix")&&$t.appSettingsManager.containsAppSetting("ServerDebugSuffix")?($t.serverDebugSuffix=$t.appSettingsManager.getStringAppSetting("ServerDebugSuffix"),$t.serverMinSuffix=$t.appSettingsManager.getStringAppSetting("ServerMinSuffix")):($t.serverDebugSuffix="",$t.serverMinSuffix=".min"),$t._wopiTokenRefreshRetryeInterval=$t.appSettingsManager.getIntAppSetting("WopiTokenRefreshRetryeInterval",1e4),$t._wopiTokenRefreshRetryIntervalForClientNetworkIssue=$t.appSettingsManager.getIntAppSetting("WopiTokenRefreshRetryIntervalForClientNetworkIssue",2e3),this.shouldUpdatePermanentErrorList?$t.wopiTokenRefreshPermanentHostErrorIdList="401,403,404".split(","):$t.wopiTokenRefreshPermanentHostErrorIdList=(e.WopiTokenRefreshPermanentHostErrorIdList||"").split(","),$t.wopiTokenRefreshNetworkErrorIdList=(e.WopiTokenRefreshNetworkErrorIdList||"").split(",");const i=(e.WopiTokensToRefresh||"").split(",");$t.wopiTokensToRefresh=i.length>0&&""!==i[0]?i:["AccessToken"],$t._wopiTokenTaskItemPriority=$t.appSettingsManager.getIntAppSetting("WopiTokenTaskItemPriority",2),Boolean.parse(e.UpdateRootQuerySignatureInMiniCheck||n)||($t.rootQuerySignature=$t.appSettingsManager.getStringAppSetting("RootQuerySignature")||$t.baseDocQuerySignatureWithoutVersion);switch($t.appSettingsManager.getStringAppSetting("SessionExpirationPolicy")){case"NullManager":$t._wopiTokenExpirationPolicy=1;break;case"RefreshToken":$t._wopiTokenExpirationPolicy=2;break;default:$t._wopiTokenExpirationPolicy=0}const r=e[$t.uiHostSettingName]||"";if("teams"===r.toLowerCase()){$t._isTeamsUiHost=!0;(0,o.h)(l.a).execute((e=>{e.logActivity("WACTeamsSession",null)}))}if("assignments"===r.toLowerCase()&&($t._isAssignmentsUiHost=!0),$t.subscribeToBeforeAppShutDown(((e,t)=>{$t.appSettingsManager.isChangeGateEnabled("SharedOnline.ChangeGate.RaiseApplicationDispiseEvent")&&U.a.dispatch("onApplicationDispose"),this.shutdownOtel(),W.Health.instance.shutdown()})),$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UsePrimaryAndSecondaryCss",!1)&&this.initAsyncCss(),this.configureAppComponents(),$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CreateDelegateBindReplacementEnabled",!1)||$t.appSettingsManager.getBooleanAppSetting("CreateDelegateBindReplacementEnabled")){window["g_isCreateDelegateBindReplacementEnabled"]=!0}$t.appSettingsManager.getBooleanAppSetting("EcsChangeGatesLogsFromAFrameworkIsEnabled")&&(me.b(508396369,200,50,"Test ECS IsChangeGateEnabled API for SharedOnlineTestChangeGate {0} ",$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.TestChangeGate")),me.b(508396368,200,50,"Test BRS IsChangeGateEnabled API for SharedOnlineTestChangeGateBRS {0} ",$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.TestChangeGateBRS"))),$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.CanaryChangeGate")&&d.ULS.sendTraceTag(508396377,306,20,"Canary ChangeGate Outage"),$t.accessibilityUseRoleDialog=Boolean.parse(e.AccessibilityUseRoleDialog||n);const s=e.AppScriptBaseName,p=$t.sessionStartInfoSettings.Application;s&&lt.a(s,"WordEditor")&&$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WordServiceWorkerEnabled",!1)&&window.setTimeout((()=>{_e.createServiceWorker(p)}),3e4),$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WordServiceWorkerForceUnregister",!1)&&_e.unregisterServiceWorker();const h=$t.appSettingsManager.appSettings.StaticContentHost||"";if(s&&lt.a(s,"WordEditor")||"PowerPoint"===p&&!h.includes("/p/s/")){if($t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogLookAheadPrefetchTrigger",!0)){const e=p+"_CurrentVersion_Artifacts";this.LogMetricsToMeasureFirstBoot(e)}$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LookAheadPrefetchEnabled",!1)&&(me.b(508396367,200,50,"LookAheadPrefetch flight is Enabled, Going ahead with prefetchLogic from previous stage artifacts"),this.initiatePerfOptimizationExperimentsAfterATimeOut(),this.setClientManifestUrlIfNotSet())}if($t._homeButtonUrl=e.HomeButtonUrl??null,""===$t._homeButtonUrl)$t._homeButtonUrl=null;else if($t._homeButtonUrl?.includes("cloud.microsoft")){(0,o.h)(l.a).execute((e=>{e.logActivity("WACHomeButtonLinksToOCDI",null)}))}this.SendOwlFlightsToHost()}SendOwlFlightsToHost(){const e=$t.appSettingsManager.getHostFlightingTreatmentVariables("Host");Object.entries(e).forEach((([e,t])=>{t&&$t.sendWacFlightToHost(e,t)}))}LogMetricsToMeasureFirstBoot(e){const t=this.getContentVersion();t!==Kt.a.instance.getItem(e)?(Ht.a.logUniqueUsage("6e1i9390;afe27538"),Kt.a.instance.setItem(e,t)):d.ULS.sendTraceTag(507277982,208,20,"Subsequent boot after deployment")}initiatePerfOptimizationExperimentsAfterATimeOut(){window.setTimeout((()=>{this.initiatePerfOptimizationExperiments()}),2e4);let e=0;const t=[["2","1"],["5","1"],["5","2"]];window.setInterval((()=>{const n=(0,p.a)(String,$t.sessionStartInfoSettings.Ring)||"-1",a=t[e];if("5"==n&&a){const[n,i]=a;this.initiatePerfOptimizationExperiments(n,i),e=(e+1)%t.length}else this.initiatePerfOptimizationExperiments()}),282e4),me.b(0,200,50,"Trigger initiatePerfOptimizationExperiments 15 seconds after boot")}setClientManifestUrlIfNotSet(){let e;const t=$t.sessionStartInfoSettings.Application,n=$t.appSettingsManager.appSettings.StaticContentHost;"Word"===t||"PowerPoint"===t?e=n+"resources/{Lcid}/clientManifest.exp.js":"Excel"===t&&(e=n+"_layouts/Resources/{Lcid}/clientManifest.exp.js");const a=$t.uiCulture||"en-US";$t.uiCulture,$t.appSettingsManager.appSettings.ClientManifestUrl=e.replace("{Lcid}",a)}getContentVersion(){return $t.buildVersion.replace(".0.","").replace(".","")}initiatePerfOptimizationExperiments(e="",t=""){try{(async function(e,t,a,i,o="",r=""){return new((await n.e(6).then(n.bind(n,6844))).LookAheadPrefetchArtifacts)(e,t,a,i,o,r)})($t.appSettingsManager,$t.theClientRequestManager,$t.sessionStartInfoSettings.Application,$t.useCrossOriginStaticScripts,e,t).then((e=>{e.initiatePrefetchArtifacts()}))}catch(e){d.ULS.sendTraceTag(505816329,201,10,"Exception thrown from LoadLookAheadPrefetchArtifactsPackage. Exception:{0}",e)}}configureAppComponents(){bt.a.instance.register(D,"Common.RefreshableAppSettings").as("Common.IRefreshableAppSettings").singleInstance().usingFactory((()=>new D($t.appSettingsManager)))}redirectOutside(e,t){const n=new st.a(e);throw n.addParam($t.previousSessionParamName,$t.userSessionId),n.addParam($t.invalidHostCanaryRedirectParamName,"1"),window.top.location.replace(n.toString()),$t.suppressCrashDialog=!0,$t.suppressCrashReportingToBSqm=!0,$t.suppressCrashReportingToWatson=!0,$t.reportError(t),Error.invalidOperation()}updateFullSessionStartInfo(e){$t._isUpdateFullSessionStartInfoCalled||($t._isUpdateFullSessionStartInfoCalled=!0,null==e&&(e=""),$t.appSettingsManager.appSettings.SessionStartInfoJson=e,this.initSessionStartInfoSettings(e),this.initializeOtel(),this.initSessionStartAndEndData(),this.initializeBrowserSqm($t.appSettingsManager.appSettings))}initSessionStartAndEndData(){C.a.isEnabledLogSessionStartAndEndDataFromClientToOTel($t.sessionStartInfoSettings.Application||"unknownApp")&&($t.sessionStartAndEndData=new Ge($t.sessionStartInfoJson,$t.dataPlumber),$t.sessionStartAndEndData.logSessionStartData(),"OfficeAutomationMetadata"in $t.sessionStartInfoSettings&&$t.sessionStartInfoSettings.OfficeAutomationMetadata&&$t.sessionStartAndEndData.logAutomationMetadata())}initializeFeatureStatusSettings(e){try{$t.featureStatusSettings=ie.b(e)}catch(t){d.ULS.sendTraceTag(505804188,201,10,"Exception thrown from JsonSerializer.SecureDeserialize for featureStatus:{0}. Exception:{1}",e,t)}}initSessionStartInfoSettings(e){$t.sessionStartInfoJson=e;try{$t.sessionStartInfoSettings=ie.b($t.sessionStartInfoJson)}catch(e){d.ULS.sendTraceTag(508396365,201,10,"Exception thrown from JsonSerializer.SecureDeserialize for sessionStartInfo:{0}. Exception:{1}",$t.sessionStartInfoJson,e)}y.a.isNullOrEmpty($t.sessionStartInfoSettings)?($t.sessionStartInfoSettings=this.createMinimumSessionStartInfoSettingsAfterJsonException($t.appSettingsManager.appSettings),d.ULS.sendTraceTag(508396364,201,10,"Received an empty SessionStartJson object from the server. Most Part A fields will be missing in Aria events")):($t.sessionStartInfoSettings.Application=$t.sessionStartInfoSettings.Application||$t.appSettingsManager.getStringAppSetting("Application")||"",$t.sessionStartInfoSettings.WACSessionID=$t.sessionStartInfoSettings.WACSessionID||$t.appSettingsManager.getStringAppSetting("SessionId")||"")}initializeOtel(){A.a.getInstance();const e=$t.appSettingsManager.getBooleanAppSetting("OtelPipelineIsEnabled");A.a.setEnabledState(e),e&&(A.a.setOtelWorkerEnabledState(!0,this.getWorkerLoggerSettings),$t.sdxKpisAreEnabled()&&A.a.addSink(new ft))}initAsyncCss(){I.a.get_instance().executeWhen(7,(()=>{$t.theTaskManager.addTask(new Qe.a(5,1,0,(e=>{ue.a.instance.addMetric(de.a.asyncCssChromeReadyOnIdleQueryStart,(new Date).getTime());const t=document.querySelectorAll("link[rel='preload'][as='style'][data-apply-css-when='chrome-ready-on-idle']");ue.a.instance.addDurationMetric(de.a.asyncCssChromeReadyOnIdleQueryStart,de.a.asyncCssChromeReadyOnIdleQueryDuration,(new Date).getTime()),ue.a.instance.addMetric(de.a.asyncCssChromeReadyOnIdleResourceCount,t.length),t.length>0&&(ue.a.instance.addMetric(de.a.asyncCssChromeReadyOnIdleApplyStart,(new Date).getTime()),$t.setLinkElementsToStylesheets(t),ue.a.instance.addDurationMetric(de.a.asyncCssChromeReadyOnIdleApplyStart,de.a.asyncCssChromeReadyOnIdleApplyDuration,(new Date).getTime()))})))}))}getOtelWorkerTelemetrySettings(){try{let e=(0,p.a)(String,$t.sessionStartInfoSettings.Os);if(e){const t=(0,p.a)(String,$t.sessionStartInfoSettings.OsVersion);t&&(e+="("+t+")")}const t={name:(0,p.a)(String,$t.sessionStartInfoSettings.Application)||"",platform:"Web",version:(0,p.a)(String,$t.buildVersion||$t.sessionStartInfoSettings.WFEVersion)||"",osVersion:e||"",sessionId:(0,p.a)(String,$t.sessionStartInfoSettings.WACSessionID)||"",flightsImpressionId:(0,p.a)(String,$t.sessionStartInfoSettings.FlightsImpressionId)||"",audienceGroup:(0,p.a)(String,$t.sessionStartInfoSettings.AudienceGroup)||"",browserName:(0,p.a)(String,$t.sessionStartInfoSettings.Browser)||"",browserVersion:(0,p.a)(String,$t.sessionStartInfoSettings.BrowserVersion)||"",appLanguage:(0,p.a)(String,$t.sessionStartInfoSettings.ApplicationLCID)||"",host:(0,p.a)(String,$t.sessionStartInfoSettings.Host)||"",uiHost:(0,p.a)(String,$t.sessionStartInfoSettings.UiHost)||"",uiHostIntegrationType:(0,p.a)(String,$t.sessionStartInfoSettings.UiHostIntegrationType)||"",sessionOrigin:(0,p.a)(String,$t.sessionStartInfoSettings.SessionOrigin)||"",serverDocId:(0,p.a)(String,$t.sessionStartInfoSettings.ServerDocId)||"",datacenter:(0,p.a)(String,$t.sessionStartInfoSettings.WACDatacenter)||"",isSynthetic:Boolean.parse($t.sessionStartInfoSettings.IsSynthetic||"false"),applicationMode:(0,p.a)(String,$t.sessionStartInfoSettings.ApplicationMode)||"",applicationModeExtended:(0,p.a)(String,$t.sessionStartInfoSettings.ApplicationModeExtended)||"",browserLanguage:(0,p.a)(String,$t.sessionStartInfoSettings.BrowserLCID)||"",contentLanguage:(0,p.a)(String,$t.sessionStartInfoSettings.DataCulture)||"",ring:(0,p.a)(String,$t.sessionStartInfoSettings.Ring)||"-1",loggableUserId:($t.appSettingsManager.getStringAppSetting("LoggableUserId")||"").toLowerCase(),loggableUserIdSpace:($t.appSettingsManager.getStringAppSetting("LoggableUserIdSpace")||"").toLowerCase(),isAnonymousUser:Boolean.parse($t.appSettingsManager.getStringAppSetting("IsAnonymousUser")||"false"),isBusinessUser:!!$t.sessionStartInfoSettings.IsBusinessUser,isEduUser:!!$t.sessionStartInfoSettings.IsEduUser,omsTenantId:$t.appSettingsManager.getStringAppSetting("TenantId")||"",flights:$t.flightId?$t.flightId.split(";"):new Array(0)};""===t.name||""===t.applicationMode||""===t.sessionId||""===t.loggableUserId||""===t.loggableUserIdSpace||""===t.audienceGroup||""===t.host||""===t.datacenter||"-1"===t.ring||""===t.omsTenantId?d.ULS.sendTraceTag(508396362,228,15,"OTelJS Worker AlwaysOnMetadata Missing! AppName: "+(""!==t.name?t.name:"N")+", ApplicationMode: "+(""!==t.applicationMode?t.applicationMode:"N")+", SessionId: "+(""!==t.sessionId?"Y":"N")+", LoggableUserIdSpace: "+(""!==t.loggableUserIdSpace?"Y":"N")+", LoggableUserId: "+(""!==t.loggableUserId?"Y":"N")+", AudienceGroup: "+(""!==t.audienceGroup?"Y":"N")+", Host: "+(""!==t.host?"Y":"N")+", Datacenter: "+(""!==t.datacenter?"Y":"N")+", Ring: "+("-1"!==t.ring?"Y":"N")+", OmsTenantId: "+(""!==t.omsTenantId?"Y":"N")):d.ULS.sendTraceTag(508396361,228,50,"OTelJS Worker AlwaysOnMetadata Good!");const n={alwaysOnMetadata:t,sendToAria:!0,sendToUls:!1,ulsLogger:new ge.a,loggingCategory:227,ariaEndpointTarget:$t.appSettingsManager.getStringAppSetting("AriaEndpointTarget"),ariaEndpointUrl:$t.appSettingsManager.getStringAppSetting("AriaOneCollectorUrlClient"),eventUploadFrequency:$t.appSettingsManager.getIntAppSetting("OtelPipelineEventUploadFrequency",2e3),pingCollectorPingUrl:$t.appSettingsManager.getBooleanAppSetting("OtelPingCollectorPingUrl"),pingCollectorEndpoint:$t.appSettingsManager.getBooleanAppSetting("OtelPingCollectorEndpoint"),wacAriaThrottlingIsEnabled:$t.appSettingsManager.getBooleanAppSetting("WACAriaThrottlingIsEnabled"),wacAriaTotalEventsThrottlePerSec:$t.appSettingsManager.getIntAppSetting("WACAriaTotalEventsThrottlePerSec",100),wacAriaSingleEventThrottlePerSec:$t.appSettingsManager.getIntAppSetting("WACAriaSingleEventThrottlePerSec",20),otelEventNamesToBeSuppressedCommaSeparated:$t.appSettingsManager.getStringAppSetting("WACAriaEventNamesToBeSuppressedCommaSeparated"),taskDurationLogFrequency:$t.appSettingsManager.getIntAppSetting("OtelStatsTaskDurationLogFrequency",20),taskDurationLogThreshold:$t.appSettingsManager.getIntAppSetting("OtelStatsTaskDurationLogThreshold",100),reportTaskDetails:$t.appSettingsManager.getBooleanAppSetting("OtelStatsReportTaskDetails"),samplingIsEnabled:$t.appSettingsManager.getBooleanAppSetting("OtelSamplingEnabled"),sampleRate:$t.appSettingsManager.getDoubleAppSetting("OtelSampleRate",1),enableCustomerContent:$t.appSettingsManager.getBooleanAppSetting("OtelCustomerContentEnabled")&&$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OTelCustomerContentIsEnabled",!1),enableDNM:$t.appSettingsManager.getBooleanAppSetting("OtelDirectNumericMeasuresEnabled"),enablePG:$t.isPGEnabled};return $t.appSettingsManager.getBooleanAppSetting("OtelPipelineExperimentalFeaturesEnabled")&&(n.sendToAria=$t.appSettingsManager.getBooleanAppSetting("OtelPipelineSendEventsToAria"),n.sendToUls=$t.appSettingsManager.getBooleanAppSetting("OtelPipelineSendEventsToULS"),n.alwaysOnMetadata=$t.appSettingsManager.getBooleanAppSetting("OtelPipelineAppendAlwaysOnMetadataToEveryEvent")?t:null),""===n.ariaEndpointUrl?(d.ULS.sendTraceTag(508396360,228,15,"Aria Endpoint URL is not set"),null):n}catch(e){d.ULS.sendTraceTag(508396359,228,15,"Failed to create an instance of TelemetrySettings for the OTelJS worker: "+e)}return null}getPrivacyGuardContext(){if(!$t.isPGEnabled)return null;let e="",t="";if($t.appSettingsManager&&!$t.appSettingsManager.getBooleanAppSetting("IsAnonymousUser")){e=$t.appSettingsManager.getStringAppSetting("UserName")||e;const n=$t.appSettingsManager.getStringAppSetting("UserPrincipalName")||"";n&&n.length>0&&(t=n.split("@")[0])}return{userName:e,userAlias:t}}shutdownOtel(){if($t._otelShutdownTriggered)return;$t._otelShutdownTriggered=!0,this.logSessionEndData();const e=A.a.shutdown();e>0&&(d.ULS.sendTraceTag(508396358,226,50,"Otel telemetry queue contains events at shutdown: {0}",e),e>$t.appSettingsManager.getIntAppSetting("OtelDroppedEventsThreshold",10)&&d.ULS.sendTraceTag(508396357,226,15,"Otel telemetry queue contains events at shutdown (data loss):{0}",e))}isInHighContrastMode(){return!1}get dialogReturnsToPreviousEditableScope(){return!1}get shouldShowPrivacyDialog(){return!0}updateFullAppSettings(e){const t="false";$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.UpdateSessionStartInfoSettingsOnFullAppSettings")&&($t.sessionStartInfoJson=e.SessionStartInfoJson||"",this.initSessionStartInfoSettings($t.sessionStartInfoJson)),$t.closeUrl=e.CloseUrl||"",$t.useClosePostMessage=Boolean.parse(e.ClosePostMessage||t),$t.privacyUrl=e.PrivacyUrl||"",$t.termsUrl=e.TermsUrl||"",$t.consumerHealthPolicyUrl=e.ConsumerHealthPolicyUrl||"",$t.filePropertiesUrl=e.FilePropertiesUrl||"",$t.useFilePropertiesPostMessage=Boolean.parse(e.FilePropertiesPostMessage||t),$t.fileSharingUrl=e.FileSharingUrl||"",$t.useFileSharingPostMessage=Boolean.parse(e.FileSharingPostMessage||t),$t.fileShareEnabled=!!$t.fileSharingUrl||At.a()&&$t.useFileSharingPostMessage,$t.workflowTypeString=e.WorkflowType||"None",$t.workflowUrl=e.WorkflowUrl||"",$t.useWorkflowPostMessage=At.a()&&Boolean.parse(e.WorkflowPostMessage||t),$t.workflowEnabled=Boolean.parse(e.WorkflowEnabled||t)&&"None"!==$t.workflowTypeString&&(""!==$t.workflowUrl||At.a()&&$t.useWorkflowPostMessage),$t.copyAndEditUrl=e.CopyAndEditUrl||"",$t.useCopyAndEditPostMessage=Boolean.parse(e.CopyAndEditPostMessage||t),$t.useEditModePostMessage=Boolean.parse(e.EditModePostMessage||t),$t.useRedeemForCommentingPostMessage=Boolean.parse(e.RedeemForCommentingPostMessage||t),$t.useSignInCommandPostMessage=Boolean.parse(e.SignInCommandPostMessage||t),$t.appCatalogUrl=e.AppCatalogUrl||"",$t.decryptSkipReason=e.DecryptSkipReason||"",$t.downloadACopyUrl=e.DownloadACopyUrl||"",$t.directReadUrl=e.DirectReadUrl||"",$t.fileDownloadCode=e.FileDownloadCode||"",$t.directInvokeDAVUrl=e.DirectInvokeDAVUrl||"",$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.PowerPointOnline.ChangeGate.PowerPointFileRenameFix")&&2==$t.activeFrame?.applicationInstance?.officeAppType&&($t.fileDocInClientUrl=e.EditDocInClientUrl||""),$t.fileEmbedCommandUrl=e.FileEmbedCommandUrl||"",$t.hostEmbeddedViewUrl=e.HostEmbeddedViewUrl||"",$t.hostEmbeddedEditUrl=e.HostEmbeddedEditUrl||"",$t.useFileEmbedCommandPostMessage=Boolean.parse(e.FileEmbedCommandPostMessage||t),$t.replyWithChangesUrl=e.ReplyWithChangesUrl||"",$t.useReplyWithChangesPostMessage=Boolean.parse(e.ReplyWithChangesPostMessage||t),$t.isReplyWithChangesWorkFlow=!$t.isNoChrome&&(ot.a.get("BP")||"").startsWith("FR=WC.Hotmail%2AWACCopy"),$t.useOpenInClientPostMessage=Boolean.parse(e.OpenInClientPostMessage||t),$t.preferPostMessageOverCommandUrlForOpenInClient=Boolean.parse(e.PreferPostMessageOverCommandUrlForOpenInClient||t),$t.addSessionIdToClientUrl=Boolean.parse(e.AddSessionIdToClientUrl||t),$t.fileVersionUrl=e.FileVersionUrl||"",$t.useFileVersionPostMessage=Boolean.parse(e.FileVersionPostMessage||t),$t.reportAbuseUrl=e.ReportAbuseUrl||"",$t.closeButtonClosesWindow=Boolean.parse(e.CloseButtonClosesWindow||t),$t.openInClientEditOnly=Boolean.parse(e.OpenInClientEditOnly||t),$t.isOfficeTrialOfferEnabled=Boolean.parse(e.OfficeTrialOfferEnabled||t),$t.isMacOfficeTrialOfferEnabled=Boolean.parse(e.MacOfficeTrialOfferEnabled||t),$t.dialogClearerStringsIsEnabled=Boolean.parse(e.DialogClearerStringsIsEnabled||t),$t.dialogDefaultEnterBehaviorIsEnabled=Boolean.parse(e.DialogDefaultEnterBehaviorIsEnabled||t),$t.downloadCopyOnOpenInClient=Boolean.parse(e.DownloadCopyOnOpenInClient||t),$t.postMessageOrigin=e.PostMessageOrigin||"",$t.hostSupportsFileRename=Boolean.parse(e.HostSupportsFileRename||t),$t.hostSupportsVersionHistory=Boolean.parse(e.HostSupportsVersionHistory||t),$t.hostSupportsInsertOnlinePictureFromHost=Boolean.parse(e.HostSupportsInsertOnlinePictureFromHost||t),$t.userCanRename=Boolean.parse(e.UserCanRenameFile||t),$t.fileNameMaxLength=parseInt(e.FileNameMaxLength||"250"),$t.breadcrumbBrandName=e.BreadcrumbBrandName||"",$t.breadcrumbBrandUrl=e.BreadcrumbBrandUrl||"",$t.breadcrumbFolderName=e.BreadcrumbFolderName||"",$t.breadcrumbFolderUrl=e.BreadcrumbFolderUrl||"",$t.signoutUrl=e.SignoutUrl||"",$t.signInUrl=e.SignInUrl||"",$t.privacyDialogText=e.PrivacyDialogText||"",$t.privacyDialogLinkText=e.PrivacyDialogLinkText||"",$t.privacyDialogTitleText=e.PrivacyDialogTitleText||"",$t.privacyDialogFwlinkId=e.PrivacyDialogFwlinkId||"",$t.privacyCookieDomain=e.PrivacyCookieDomain||"";var n=!1;$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HidePrivacyDialogueInViewerForNoHpa",!1)&&$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.UpdateViewModeCheckForCCS")&&(2===$t.instance.officeAppMode||$t.sessionStartInfoSettings&&"view"==$t.sessionStartInfoSettings.UserSessionApplicationMode?.toLowerCase())&&(n=!0),$t.mightNeedPrivacyDialog=Boolean.parse(e.ShowPrivacyDialog||t)&&!$t.isEmbedded&&!Boolean.parse($t.sessionStartInfoSettings.IsSynthetic||t)&&!n,d.ULS.sendTraceTag(505772248,306,50,"playwright sessionStart isSynthetic check:{0}",$t.sessionStartInfoSettings.IsSynthetic),$t.privacyDialogShouldCheckRoaming=Boolean.parse(e.PrivacyDialogShouldCheckRoaming||t),$t.privacyDialogCanWriteServerSettings=Boolean.parse(e.PrivacyDialogCanWriteServerSettings||t),$t.privacyDialogCurrentVersion=parseInt(e.PrivacyDialogCurrentVersion||"1"),$t.privacyDialogAlreadySeen=Boolean.parse(e.PrivacyDialogAlreadySeen||t),$t._irmPolicyTitle=e.IrmPolicyTitle,$t._irmPolicyDescription=e.IrmPolicyDescription,e.PrintingEnabled&&($t.printingEnabled=Boolean.parse(e.PrintingEnabled)),e.ProtectInClient&&($t.protectFile=Boolean.parse(e.ProtectInClient)),e.ProtectedFile&&($t.protectedFile=Boolean.parse(e.ProtectedFile)),e.EnableMacrosForProtectedFile&&($t.enableMacrosForProtectedFile=Boolean.parse(e.EnableMacrosForProtectedFile)),e.EnableExtractForProtectedFile&&($t.enableExtractForProtectedFile=Boolean.parse(e.EnableExtractForProtectedFile)),e.EnableExportForProtectedFile&&($t.enableExportForProtectedFile=Boolean.parse(e.EnableExportForProtectedFile)),e.EnableFullControlForProtectedFile&&($t.enableFullControlForProtectedFile=Boolean.parse(e.EnableFullControlForProtectedFile)),$t.initializeWebAddinSettings(e),$t.initializeSdxSettings(e),$t._hostNameToIncludeInSavedStatus=e.HostNameToIncludeInSavedStatus||"",$t.sessionContext=e.SessionContext||"",$t.isCloseable=!$t.isEmbedded&&($t.closeButtonClosesWindow||!!$t.closeUrl||$t.useClosePostMessage),$t._hostFrameTrustCheckIsEnabled=Boolean.parse(e.HostFrameTrustCheckIsEnabled||t),d.ULS.sendTraceTag(508396355,306,100,"HostFrameTrustCheckIsEnabled:{0}",$t._hostFrameTrustCheckIsEnabled),$t._hostAllowlistCheckIsEnabled=Boolean.parse(e.HostAllowlistCheckIsEnabled||t),d.ULS.sendTraceTag(508396354,306,100,"HostAllowlistCheckIsEnabled:{0}",$t._hostAllowlistCheckIsEnabled),$t._hostFrameTrustCheckIsEnabled&&0===$t.isHostFrameTrusted&&(this.supportsFrameTrustCheck?(d.ULS.sendTraceTag(508396353,306,100,"IsHostFrameTrusted is NotReady"),$t.isHostFrameTrusted=2,$t.sendIsFrameTrustedMessage()):Boolean.parse(e.HostExemptedFromFrameTrustCheck||t)?$t.isHostFrameTrusted=3:(d.ULS.sendTraceTag(508396352,306,100,"IsHostFrameTrusted is NotImplemented"),$t.isHostFrameTrusted=1)),!$t.isEmbedded&&$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.AllowUpdatedFeatureGateExtension")&&"inner"===$t.appSettingsManager.getStringAppSetting("Microsoft365Ring")&&($t.sendAppBootedMessage(),$t.recieveCondition()),$t.smartLookupIsEnabled=Boolean.parse(e.SmartLookupIsEnabled||t),$t.insightsIsEnabled=Boolean.parse(e.InsightsIsEnabled||t),$t.mightNeedPrivacyDialog&&this.shouldShowPrivacyDialog&&I.a.get_instance().executeWhen(8,pe.PrivacyDialogManager.showPrivacyDialogIfNecessary);const a="Excel"===($t.sessionStartInfoSettings.Application||"");$t.isEmbedded||a||!$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowUnifiedConsent",!1)||I.a.get_instance().executeWhen(8,(()=>{(0,o.h)(s.a).execute((e=>{e.showConsentDialog()}))})),$t.wopiIdentityWhitelist=(e.WopiIdentityWhitelist||"").split(","),"ShowFeedback"in e&&($t.showFeedbackButton=Boolean.parse(e.ShowFeedback)),"IsFeedbackExperiencesAvailable"in e&&($t.showFeedbackButton=$t.showFeedbackButton&&e.IsFeedbackExperiencesAvailable),$t.showCopilotFeedbackButton=$t.showFeedbackButton,(0,o.h)(r.a).execute((e=>{e.isFeatureEnabled("mso_sendASmile",$t.showFeedbackButton).then((e=>($t.showFeedbackButton=$t.showFeedbackButton&&e,null)))})),(0,o.h)(r.a).execute((e=>{e.isFeatureEnabled("sendcopilotfeedback",$t.showCopilotFeedbackButton).then((e=>($t.showCopilotFeedbackButton=$t.showCopilotFeedbackButton&&e,null)))})),(0,o.h)(r.a).execute((e=>{e.isFeatureEnabled("Copilot",!1).then((e=>($t.copilotEnabled=e,null)))}));const i="teams"===(e[$t.uiHostSettingName]||"").toLowerCase(),l=["Word","Excel","PowerPoint"].includes(e.WebAppShortName),c=["SharePoint Online","ServiceTestHost"].includes($t.sessionStartInfoSettings.Host),u=""!=e.SovereignEnvironmentName,p=""!==($t.appSettingsManager.getStringAppSetting("LoggableUserId")||"");$t.mosForWXPEnabled=$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MosForWXPEnabled",!1)&&!Boolean.parse(e.IsAnonymousUser)&&!i&&l&&c&&!u&&p}updateMiniCheckBasedAppSettings(e){const t="false",n="true";$t._areRoamingAppsEnabled=Boolean.parse(e.RoamingAppsAreEnabled||t),$t.baseDocQuerySignatureWithoutVersion=e.BaseDocQuerySignatureWithoutVersion||"",Boolean.parse(e.UpdateRootQuerySignatureInMiniCheck||t)&&($t.rootQuerySignature=e.RootQuerySignature||$t.baseDocQuerySignatureWithoutVersion),$t._requiresCheckout=Boolean.parse(e.RequiresCheckout||t),$t.suppressHelp=Boolean.parse(e.SuppressHelp||t),$t.showFeedbackButton=Boolean.parse(e.ShowFeedback||t),$t.showCopilotFeedbackButton=Boolean.parse(e.ShowCopilotFeedback||t),$t.feedbackDescription=e.FeedbackDescription||"",$t.webEditingEnabled=!$t.isMobileExperimentEnabled&&Boolean.parse(e.WebEditingEnabled||n),$t.needsSignOutChecking=Boolean.parse(e.NeedsSignOutChecking||t),$t.accessTokenParamName=e.AccessTokenParam||"access_token",$t.limitedEdit=Boolean.parse(e.LimitedEdit||t),$t.hostAuthenticatesUsersDuringOpenInClient=Boolean.parse(e.HostAuthenticatesUsersDuringOpenInClient||t),$t.fileName=e.FileName||"",$t._isSkyDrive=Boolean.parse(e.IsSkyDrive||t),$t._isTellMeUpSellEnterpriseEnabled=Boolean.parse(e.IsTellMeUpSellEnterpriseEnabled||t),$t.flightId=e.FlightId||"",$t.userName=e.UserName||"",$t.userNameUnknown=Boolean.parse(e.UserNameUnknown||t),$t._newDocumentDestinationHost=e.NewDocumentDestinationHost,$t._isNewDocumentTemplateUIEnabled=Boolean.parse(e.IsNewDocumentTemplateUIEnabled||t),$t._readFromMruIsEnabled=Boolean.parse(e.ReadFromMruIsEnabled||t),$t._openMenuBrowseMoreHostUrl=e.OpenMenuBrowseMoreHostUrl,$t._openMenuBrowseMoreHostName=e.OpenMenuBrowseMoreHostName,$t._updateMruIsEnabled=Boolean.parse(e.UpdateMruIsEnabled||t),$t._supportsGetMoreInfoForPersonalStorage=Boolean.parse(e.SupportsGetMoreInfoForPersonalStorage||t),$t.printingEnabled=e.PrintingEnabled===n,$t.protectFile=e.ProtectInClient===n,$t.protectedFile=e.ProtectedFile===n,$t.enableMacrosForProtectedFile=e.EnableMacrosForProtectedFile===n,$t.enableExtractForProtectedFile=e.EnableExtractForProtectedFile===n,$t.enableExportForProtectedFile=e.EnableExportForProtectedFile===n,$t.enableFullControlForProtectedFile=e.EnableFullControlForProtectedFile===n,$t.shouldShowSwitcher=Boolean.parse(e.ShouldShowSwitcher||t),$t.bootAppFromMiniCheck=Boolean.parse(e.BootAppFromMiniCheck||t),$t.useMiniCheckedDocumentParam=e.UseMiniCheckedDocumentParam||"",$t._hideAppsExtensionUrl=e.HideAppsExtensionUrl||"",$t.wopiIdentityWhitelist=(e.WopiIdentityWhitelist||"").split(",")}getSignInParams(){return{}}getCopyAndEditParams(){return{}}getFileNewProperties(){return null}initializeBrowserSqm(e){let t=!1;const n=e.WsaData;let a;n&&({deserialized:a}=ie.d(n)).returnValue||(a={});const i=a.Dispatcher;i&&(t=a.Enabled);const o=a.SqmQoSEnabled,r=a.SqmQoSDataPoints;if($t.theWsaClient=new se(i,t,o,r),t||o){const t=a.StartTime;$t.theWsaClient.updateStartTime(t),$t.theWsaClient.createStream(F.ribbonStreamId,1,F.ribbonStreamWidth,Q.defaultMaxStreamRows),$t.theWsaClient.createStream(9134,1,3,Q.defaultMaxStreamRows),$t.theWsaClient.createStream($t.documentStreamId,1,$t.documentStreamWidth,Q.defaultMaxStreamRows),C.a.shouldRegisterOtelListener($t.sessionStartInfoSettings.Application||"unknownApp")&&$t.theActionManager.registerListener(this.getOtelActionListener()),$t.theActionManager.registerListener(this.getWsaListener());const n=parseInt(e.OfficeApplicationId||"0");$t.theWsaClient.addCommonDatapoint(59),$t.theWsaClient.addCommonDatapoint($t.officeApplicationModeDatapointId),$t.theWsaClient.addCommonDatapoint(8491),$t.theWsaClient.addCommonDatapoint(11030),$t.theWsaClient.addCommonDatapoint(9104),$t.theWsaClient.addCommonDatapoint(9902),$t.theWsaClient.setDw(59,n),$t.theWsaClient.setDw(8491,$t.lcid);const i=a.InitialDP;0;for(let e=0;e<i.length;e+=2)$t.theWsaClient.setDw(i[e],i[e+1]);if(void 0!==window.__startTime){const e=window.__startTime;$t.theWsaClient.setDw(9085,$t.bootTime-e.getTime())}$t.theWsaClient.setDw(11030,1440-(new Date).getTimezoneOffset());const o=a.FlightId;$t.theWsaClient.setFlightId(o)}}initializeDefaultErrorHandler(e,t,n=!1){e&&e.init(t,this.officeAppType,this.officeAppMode,n)}getWsaListener(){return F.getInstance()}getOtelActionListener(){return v.getInstance()}onAuthenticationLost(e,t,n,a,i){return $t._wasAuthenticationLostDuringSession=!0,32}onAuthenticationRestored(e,t,n,a,i){return 32}logSessionEndData(){$t._logSessionEndDataCalled||($t._logSessionEndDataCalled=!0,C.a.isEnabledLogSessionStartAndEndDataFromClientToOTel($t.sessionStartInfoSettings.Application||"unknownApp")&&$t.sessionStartAndEndData.logSessionEndData())}dispose(){d.ULS.sendTraceTag(508396320,306,50,"In Dispose"),$t.appSettingsManager.getBooleanAppSetting("LogBootPerfMetricsOnAppDisposeIsEnabled")&&ue.a.instance.log(),this.logSessionEndData(),$t.isShuttingDown=!0,$t.eventSource.raiseEvent($t.shuttingDownEventKey),$t.theWsaClient&&($t.theWsaClient.terminate(),$t.theWsaClient=null),rt.a.safeDispose($t.activeFrame),$t.activeFrame=null,$t._splashscreenElement=null,$t._splashscreenOverlay=null,$t._ribbonRegionElement=null,$t.theClientRequestManager=null,this.shutdownOtel(),W.Health.instance.shutdown(),rt.a.safeDispose($t.theUlsHost),qe.TaskManager.dispose(),Dt.instance.stop(),$t.theActionManager=null,$t.theWacAirSpaceEngine=null,$t.theUlsHost=null}resolveActionId(e){return Ae.a.getNameFromId(e)}resolveContextId(e){return Tt.a.getNameFromId(e)}resolveCommandId(e){return null}get editMode(){return 0}get giveFeedbackOnOpenClient(){return!1}handleEditInBrowser(){0}handleGiveFeedback(){0}refreshReactRibbonModeCookie(){}getSliceForCommand(e){return null}createAppSettingsManager(e){return $t.appSettingsManager=new E.a(e),this._sessionConfig={appSettingsManager:$t.appSettingsManager,rootQuerySignature:$t.appSettingsManager?.getStringAppSetting("RootQuerySignature")},(0,Zt.b)(this._sessionConfig),$t.appSettingsManager}static get appSettingsManager(){return $.AFrameworkApplication_AppSettingsManager.appSettingsManager}static set appSettingsManager(e){$.AFrameworkApplication_AppSettingsManager.appSettingsManager=e}getAppChromePromise(e=!0){return Promise.reject("getAppChromeLoadedPromise not overridden")}get hideFileNameInDTT(){return!1}get showFolderAndFileNameInDTT(){return!1}handleHostBackButton(){}saveHostChannelId(e){}static get_createdPageNodeIDs(){return $t._createdPageNodeIDs||($t._createdPageNodeIDs=new Set),$t._createdPageNodeIDs}static get documentLoadedTime(){return $t._documentLoadedTime}static set documentLoadedTime(e){$t._documentLoadedTime=e,$t.theActionManager.processAction(Ae.a.documentLoaded,2)}static get disableEditIfAndroid(){return 2===$t.activeFrame.applicationInstance.officeAppType?!!ut.a.isAndroid&&(!!$t.appSettingsManager&&$t.appSettingsManager.getBooleanAppSetting("EnablePowerPointOnlineEditorForAndroid")):!!ut.a.isAndroid&&(!!$t.appSettingsManager&&$t.appSettingsManager.getBooleanAppSetting("DisableEditEntryPointsFromViewerForAndroid"))}static get quietWindowTrackedFiles(){return zt.a.getTrackedFiles()}static get wd1jsIsEnabled(){return oe.AFrameworkApplicationConstants.wd1jsIsEnabled}static get theActionManager(){return Gt.AFrameworkApplication_ActionManager.theActionManager}static set theActionManager(e){Gt.AFrameworkApplication_ActionManager.theActionManager=e}static get theWsaClient(){return qt.AFrameworkApplication_WsaClient.theWsaClient}static set theWsaClient(e){qt.AFrameworkApplication_WsaClient.theWsaClient=e}static get theTaskManager(){return qe.TaskManager.instance}static get extraErrorInfoFromHost(){return $t._extraErrorInfoFromHost}static get latestActivityTime(){return oe.AFrameworkApplicationConstants.latestActivityTime}static set latestActivityTime(e){oe.AFrameworkApplicationConstants.latestActivityTime=e}static get canExecuteCloseAction(){return $t.isCloseable&&!!$t.theActionManager&&32===$t.theActionManager.processAction(Ae.a.close,1)}static get isRtl(){return oe.AFrameworkApplicationConstants.isRtl}static set isRtl(e){oe.AFrameworkApplicationConstants.isRtl=e}static get areRoamingAppsEnabled(){return $t._areRoamingAppsEnabled}static get_wopiIdentityWhitelist(){return $t.wopiIdentityWhitelist}static get isWopiTokenRefreshWhenSessionExpiredEnabled(){return $t._isWopiTokenRefreshWhenSessionExpiredEnabled}static get isWopiTokenRefreshCancelExpirationEnabled(){return $t._isWopiTokenRefreshCancelExpirationEnabled}static get wopiTokenRefreshRetryeInterval(){return $t._wopiTokenRefreshRetryeInterval}static get wopiTokenRefreshRetryIntervalForClientNetworkIssue(){return $t._wopiTokenRefreshRetryIntervalForClientNetworkIssue}static get_wopiTokenRefreshNetworkErrorIdList(){return $t.wopiTokenRefreshNetworkErrorIdList}static get_wopiTokenRefreshPermanentHostErrorIdList(){return $t.wopiTokenRefreshPermanentHostErrorIdList}static get wopiTokenRefreshMaxRetryAttempts(){return $t._wopiTokenRefreshMaxRetryAttempts}static get_wopiTokensToRefresh(){return $t.wopiTokensToRefresh}static get wopiTokenExpirationPolicy(){return $t._wopiTokenExpirationPolicy}static get wopiTokenTaskItemPriority(){return $t._wopiTokenTaskItemPriority}static get isTeamsUiHost(){return $t._isTeamsUiHost}static get isAssignmentsUiHost(){return $t._isAssignmentsUiHost}static registerFrame(e){const t=e.get_element().id;$t._registeredFrames[t]||($t._registeredFrames[t]=e,Array.add($t.registeredFramesArray,e)),R.a.instance.runFeatureChecks($t.appSettingsManager)}static unRegisterFrame(e){e&&($t._registeredFrames[e],Array.remove($t.registeredFramesArray,$t._registeredFrames[e]),delete $t._registeredFrames[e])}static get wasAuthenticationLostDuringSession(){return $t._wasAuthenticationLostDuringSession}static get isCustomerFeedbackExternal(){return oe.AFrameworkApplicationConstants.isCustomerFeedbackExternal}static set isCustomerFeedbackExternal(e){oe.AFrameworkApplicationConstants.isCustomerFeedbackExternal=e}static get closeWindowOnAppClose(){return $t.closeButtonClosesWindow}static get trimDownloadACopy(){return!$t.downloadACopyUrl||ut.a.isIPad||$t.protectFile}static get isDogfoodEnvironment(){return $t._isDogfoodEnvironment}static get environment(){return $t._environment}static get_bulsSizeThresholdBytes(){return $t.bulsSizeThresholdBytes}static get trimOICButtons(){if($t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.AddOICLogging")){const e=!$t.isOpenInClientEnabled||$t.appSettingsManager.getBooleanAppSetting("OICAllowListIsEnabled")&&!le.a.isAllowedPlatformForOpenInClient(),t=void 0===$t.docPropertiesProvider||null===$t.docPropertiesProvider||void 0===$t.docPropertiesProvider.openInClientCommandUrl||null===$t.docPropertiesProvider.openInClientCommandUrl||""===$t.docPropertiesProvider.openInClientCommandUrl,n=!$t.useOpenInClientPostMessage,a=$t._trimOICButtonsIfUnavailable;return me.b(505964739,200,50,"OIC Button trimmed platformDoesNotAllowOIC {0}, oicUrlIsUnDefined {1}, dontUseOICInClientPostMessage {2}, trimOICButtonsIfUnavailable {3}",e,t,n,a),e&&t&&n&&a}return(!$t.isOpenInClientEnabled||$t.appSettingsManager.getBooleanAppSetting("OICAllowListIsEnabled")&&!le.a.isAllowedPlatformForOpenInClient())&&(void 0===$t.docPropertiesProvider.openInClientCommandUrl||null===$t.docPropertiesProvider.openInClientCommandUrl||""===$t.docPropertiesProvider.openInClientCommandUrl)&&!$t.useOpenInClientPostMessage&&$t._trimOICButtonsIfUnavailable}static get isEmbedded(){return $t._isEmbedded}static get isUIEmbedMode(){return oe.AFrameworkApplicationConstants.isUIEmbedMode}static set isUIEmbedMode(e){oe.AFrameworkApplicationConstants.isUIEmbedMode=e}static get shouldHideToolbarOnViewerRedirect(){return $t._shouldHideToolbarOnViewerRedirect}static get isNoChrome(){return $t._isNoChrome}static get isPGEnabled(){return $t.appSettingsManager.getBooleanAppSetting("OtelPrivacyGuardEnabled")&&$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OTelPrivacyGuardIsEnabled",!1)}static get areThirdPartyAddInsAllowed(){return!$t.protectedFile||$t.enableMacrosForProtectedFile}static get isSleeping(){return $t._isSleeping}static set isSleeping(e){$t._isSleeping!==e&&($t._isSleeping=e,$t._isSleeping?$t.eventSource.raiseEvent(Xt):$t.eventSource.raiseEvent(Jt))}static pinchZoomForOneNoteIsEnabled(){return oe.AFrameworkApplicationConstants.pinchZoomForOneNoteIsEnabled()}static isTTVRForOneNoteEnabled(){return $t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.isTTVRForOneNoteEnabled",!1)}static getCurrentZoom(){return oe.AFrameworkApplicationConstants.getCurrentZoom()}static get isHostFrameTrusted(){return d.ULS.sendTraceTag(508396315,306,100,"IsHostFrameTrusted:{0}",$t._isHostFrameTrusted),$t._isHostFrameTrusted}static set isHostFrameTrusted(e){if(d.ULS.sendTraceTag(508396314,306,50,"IsHostFrameTrusted:{0}",e),$t._isHostFrameTrusted!==e){$t._isHostFrameTrusted=e,4===$t._isHostFrameTrusted&&d.ULS.sendTraceTag(508396313,306,15,"Host_IsFrameTrusted is NotTrusted");try{$t.eventSource.raiseEvent(Yt,$t._isHostFrameTrusted)}catch(e){d.ULS.sendTraceTag(508396312,306,10,"Exception while setting IsHostFrameTrusted:{0}",e)}}}static get requiresCheckout(){return $t._requiresCheckout}static get imageClusterName(){return oe.AFrameworkApplicationConstants.imageClusterName}static set imageClusterName(e){oe.AFrameworkApplicationConstants.imageClusterName=e}static get imageClusterPath(){return oe.AFrameworkApplicationConstants.imageClusterPath}static set imageClusterPath(e){oe.AFrameworkApplicationConstants.imageClusterPath=e}static get versionedPathToClusterImages(){return $t._versionedPathToClusterImages}static set versionedPathToClusterImages(e){$t._versionedPathToClusterImages=e}static get scriptBase(){return $t._scriptBase}static set scriptBase(e){$t._scriptBase=e}static get currentBrowserSupportsCrossDomainAjax(){return xt.a.browserSupportsCrossDomainRequests}static get accessToken(){return oe.AFrameworkApplicationConstants.accessToken}static set accessToken(e){oe.AFrameworkApplicationConstants.accessToken=e}static get isSkyDrive(){return $t._isSkyDrive}static get hostNameToIncludeInSavedStatus(){return $t._hostNameToIncludeInSavedStatus}static get unifiedHeaderOfficeOnlineLogoWidth(){return $t._unifiedHeaderOfficeOnlineLogoWidth}static get newDocumentDestinationHost(){return $t._newDocumentDestinationHost}static get isNewDocumentTemplateUIEnabled(){return $t._isNewDocumentTemplateUIEnabled}static get isTellMeUpSellEnterpriseEnabled(){return $t._isTellMeUpSellEnterpriseEnabled}static get newMenuMoreTemplatesUrl(){return $t._newMenuMoreTemplatesUrl}static get isAppsForOfficeSingleSignOnSupportedOnHost(){return $t._isAppsForOfficeSingleSignOnSupportedOnHost}static get hideAppsExtensionUrl(){return $t._hideAppsExtensionUrl}static get dataBoundary(){return $t._dataBoundary}static get isControllerServicesQueryParamNeeded(){return oe.AFrameworkApplicationConstants.isControllerServicesQueryParamNeeded}static isSdxAllowed(e){const t=$t.sdxAllowList;return!t||!t.length||1===t.length&&"all"===t[0]||Array.contains(t,w.a.toLower(e))}static get documentIsFolder(){return $t._documentIsFolder}static get readFromMruIsEnabled(){return $t._readFromMruIsEnabled}static get mruPollingIntervalInMs(){return $t._mruPollingIntervalInMs}static get timeUntilInactiveInMs(){return $t._timeUntilInactiveInMs}static get openMenuBrowseMoreHostUrl(){return $t._openMenuBrowseMoreHostUrl}static get openMenuBrowseMoreHostName(){return $t._openMenuBrowseMoreHostName}static get supportsGetMoreInfoForPersonalStorage(){return $t._supportsGetMoreInfoForPersonalStorage}static get getMoreInfoRetryIntervalsInMs(){return $t._getMoreInfoRetryIntervalsInMs}static get cursorPinningIsEnabled(){return $t._cursorPinningIsEnabled}static get nativeSelectionAndContextMenu(){return $t._nativeSelectionAndContextMenu}static isInsertOnlinePictureFromHostSupported(){return $t.insertOnlinePictureFromHostEnabled&&($t.hostSupportsInsertOnlinePictureFromHost||$t.isSkyDrive)&&$t.appSupportsInsertOnlinePictureFromHost||$t.appSupportsInsertOnlinePictureFromSharePoint}static isInsertPictureFromMobileDeviceEnabledForWord(){const e=$t.appSettingsManager.getStringAppSetting("HostAuthType"),t=$t.appSettingsManager.getBooleanAppSetting("PhoneLinkInsertPictureFromMobileDeviceEnabled");return"aad"===e.toLowerCase()&&!$t.isTeamsUiHost&&t}static shouldUseEmulatedOneDriveHostForInsertOnlinePicture(){return!!$t.activeFrame&&!!$t.activeFrame.applicationInstance&&4===$t.activeFrame.applicationInstance.officeAppType||$t.appSupportsInsertOnlinePictureFromSharePoint||$t.insertOnlinePictureFromHostEnabled&&$t.appSupportsInsertOnlinePictureFromHost&&$t.appSettingsManager.getBooleanAppSetting("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled")&&$t.isSkyDrive&&!$t.hostSupportsInsertOnlinePictureFromHost}static isRenameSupported(){return!!$t.isUnauthEdit||$t.hostSupportsFileRename&&$t.appSupportsFileRename}static isVersionHistorySupported(){return $t.hostSupportsVersionHistory&&$t.appSupportsVersionHistory&&!$t.protectFile}static isPublishToWebEnabled(){return $t.appSettingsManager.getBooleanAppSetting("IsPublishedToWebSupported")&&$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PublishToWebEnabled",!1)}static get freemiumUpsellMode(){if(!$t.appSettingsManager.getBooleanAppSetting("FreemiumUpsellHeaderUIIsEnabled"))return 0;let e=3;switch($t.appSettingsManager.getStringAppSetting("FreemiumUpsellMode")){case"ShowUpsell":e=1;break;case"ShowBadge":e=2;break;default:$t.appSettingsManager.getBooleanAppSetting("FreemiumUpsellShowWhenPremiumStatusIsUnknown")&&(d.ULS.sendTraceTag(508396308,324,50,"Premium Status unknown. Defaulting to app setting"),e=1)}return e}static get updateMruIsEnabled(){return $t._updateMruIsEnabled}static get wacCopyPasteShortcutDialogIsEnabled(){return $t._wacCopyPasteShortcutDialogIsEnabled}static get_flights(){const e=Array.isArray($t.sessionStartInfoSettings.Flights)?$t.sessionStartInfoSettings.Flights:null;return e||($t._flights||e||!$t.flightId||($t._flights=$t.flightId.split(";")),$t._flights)}static get removeWacDialogKeyUpHandler(){return $t._removeWacDialogKeyUpHandler}static get newFileTemplateName(){return $t._newFileTemplateName}static get newFileTemplateLcid(){return $t._newFileTemplateLcid}static get instance(){return $t._instance}static get perceivedInteractiveCommandHandler(){return Vt.a.perceivedInteractiveCommandHandler}static initializeBulsProperties(e){const t="false";$t.browserUlsIsEnabled=Boolean.parse(e.BrowserUlsIsEnabled||t);const n=parseInt(e.BulsSizeThresholdBytes||"0");n&&($t.bulsSizeThresholdBytes=n),$t.bulsUploadMaxSize=parseInt(e.BulsUploadMaxSize||"0"),$t.browserUlsTraceLevel=parseInt(e.BrowserUlsTraceLevel||"0"),$t.logCanaryInBrowser=Boolean.parse(e.LogCanaryInBrowser||t)}static setLinkElementsToStylesheets(e){for(let t=0;t<e.length;t++)e[t].setAttribute("rel","stylesheet")}static sdxKpisAreEnabled(){return $t.appSettingsManager.getBooleanAppSetting("SdxKpisAreEnabled")}static getOtelWorkerJSName(){let e="otel";return $t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OtelNextWorkerIsEnabled",!1)&&(e+="Next"),e+=".worker",$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ServerFileSuffix")?e+=$t.serverMinSuffix:($t.appSettingsManager.containsAppSetting("IsServerFlavorDebug")&&$t.appSettingsManager.getBooleanAppSetting("IsServerFlavorDebug"),e+=".min"),e+=".js",e}static logMSAjaxError(e){d.ULS.sendTraceTag(508396306,201,10,e)}static logMSAjaxInfo(e){d.ULS.sendTraceTag(508396305,209,50,e)}static initializeWebAddinSettings(e){const t="false";Boolean.parse(e.HostFrameTrustCheckIsEnabledForAddIns||t)?$t.disableWholeAppsForOfficeFeature=Boolean.parse(e.DisableWholeAppsForOfficeFeature||t)||!Boolean.parse(e.HostAllowedSdxEmbedding||t)||Boolean.parse(e.ShouldDisableOfficeAddinsByUiHost??t):$t.disableWholeAppsForOfficeFeature=Boolean.parse(e.DisableWholeAppsForOfficeFeature||t)||Boolean.parse(e.ShouldDisableOfficeAddinsByUiHost??t),$t._isAppsForOfficeSingleSignOnSupportedOnHost=Boolean.parse(e.IsAppsForOfficeSingleSignOnSupportedOnHost||t),$t._hostAllowlistForAddIns=$t.appSettingsManager.getStringAppSetting("HostAllowlistForAddIns")}static initializeSdxAllowList(e){e&&e.length>0?$t.sdxAllowList=e.split(";"):$t.sdxAllowList=null}static initializeDefaultManifestTokens(e){const t={__proto__:null},n=e.TokenSDXManifestsTokenValueList;if(n){const e=n.trim().split("^");for(const n of e){const e=n.split("|");if(2===e.length){const n="{{"+e[0].trim()+"}}",a=e[1].trim();t[n]=a}else{0}}}$t.defaultManifestTokens=t}static initializeSdxSettings(e){$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.UseSdxAllowList")&&$t.initializeSdxAllowList(e.SdxAllowList),$t.sdxExceptionFrom1CDNList=e.SdxExceptionFrom1CDNList||"",$t.dmsSdxListDocument=e.DmsSdxListDocument||"",$t.dmsSdxListWorkbook=e.DmsSdxListWorkbook||"",$t.dmsSdxListPresentation=e.DmsSdxListPresentation||"",$t.sdxIsEnabled=e.SdxIsEnabled||!1,$t.initializeDefaultManifestTokens(e)}static scriptUrlFromName(e,t,n=!0){let a,i=null;return i=$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WD1JSPPTFixes")&&9===t?L.a.staticContentHost:$t.staticContentScriptNameBase,a=N.a.instance.isEnabled?he.a.hashedScriptUrlFromName(e,t,$t.scriptBase,i,$t.lcid,n?L.a.staticContentQueryParameter:""):he.a.scriptUrlFromName(e,t,$t.scriptBase,i,$t.lcid,n?L.a.staticContentQueryParameter:""),a=$t.getBrotliResourceUrl(a),me.b(508396304,200,100,"ScriptUrlFromName for {0} is {1}",e,a),a}static scriptUrlFromNameWithFolderPath(e,t,n){let a;return a=N.a.instance.isEnabled?he.a.hashedScriptUrlFromNameNew(e,t,$t.scriptBase,L.a.staticContentHost+n,$t.lcid,L.a.staticContentQueryParameter):he.a.scriptUrlFromName(e,t,null,L.a.staticContentHost+n,$t.lcid,L.a.staticContentQueryParameter),a=$t.getBrotliResourceUrl(a),me.b(508396303,200,100,"ScriptUrlFromNameWithFolderPath for fileName: {0} folderPath: {1} is url: {2}",e,n,a),a}static sriHashFromName(e,t){let n=null,a=null;return N.a.instance.isEnabled&&$t.appSettingsManager.getBooleanAppSetting("SubresourceIntegrityIsEnabled")&&(a=he.a.getFileName(e,t,$t.scriptBase,$t.lcid,L.a.staticContentQueryParameter),n=N.a.instance.getSriHash($t.scriptFolderPath+a)),me.b(508396302,200,100,"SriHash for {0} is {1}",a,n),n}static getBrotliResourceUrl(e){return Wt.a.getBrotliResourceUrl(e)}static add_appSleep(e){$t.eventSource.addHandler(Xt,e)}static remove_appSleep(e){$t.eventSource.removeHandler(Xt,e)}static add_appWakeup(e){$t.eventSource.addHandler(Jt,e)}static remove_appWakeup(e){$t.eventSource.removeHandler(Jt,e)}static add_isHostFrameTrustedSet(e){$t.eventSource.addHandler(Yt,e)}static remove_isHostFrameTrustedSet(e){$t.eventSource.removeHandler(Yt,e)}static ensureAwakeIfAsleep(){$t.isSleeping&&$t.ensureAwake()}static ensureAwake(){if(!isFinite($t._sleepIntervalInMsec))return;const e=$t._theAppSleepTask;$t._theAppSleepTask=null,$t.isSleeping=!1,e&&$t.theTaskManager.deleteTask(e),$t._theAppSleepTask=new Qe.a(3,1,$t._sleepIntervalInMsec,$t.putApplicationToSleep,21),$t.theTaskManager.addTask($t._theAppSleepTask)}static putApplicationToSleep(e){$t.isSleeping=!0,$t._theAppSleepTask=null}static isSplashScreenUp(){return $t._isSplashScreenUp}static isCanvasSkeletalUXUp(){return $t._isCanvasSkeletalUXUp}static dismissSplashScreenFrom100ToZeroPercent(){$t._isSplashScreenUp&&(x.a.splashScreenFadeOutFrom100PercentToZero($t._splashscreenElement,null,$t.onAfterDismissSplashScreen),x.a.splashScreenFadeOutFrom100PercentToZero($t._splashscreenOverlay,null,$t.onAfterDismissSplashScreenOverlay),this.determineKpiLoggingForSplashScreen())}static dismissSplashScreen(){$t._isSplashScreenUp&&(x.a.splashScreenFadeOut($t._splashscreenElement,null,$t.onAfterDismissSplashScreen),x.a.splashScreenFadeOut($t._splashscreenOverlay,null,$t.onAfterDismissSplashScreenOverlay),this.determineKpiLoggingForSplashScreen())}static dismissCanvasSkeletalUXFrom100PercentToZero(){$t._isCanvasSkeletalUXUp&&x.a.splashScreenFadeOutFrom100PercentToZero($t._canvasSkeletalUXElement,null,$t.onAfterDismissCanvasSkeletalUX)}static dismissCanvasSkeletalUX(){$t._isCanvasSkeletalUXUp&&x.a.splashScreenFadeOut($t._canvasSkeletalUXElement,null,$t.onAfterDismissCanvasSkeletalUX)}static determineKpiLoggingForSplashScreen(){$t.appSettingsManager.getBooleanAppSetting("ShouldLogWordBootServerKpis")&&(this._hasFastViewBeenShown||this.recordSplashScreenKpi())}static recordSplashScreenKpi(){const e=window.performance&&window.performance.now?window.performance.now():0;let t;t=e>0&&window.g_splashScreenShownHighResTime>0?{additionalValues:Object.assign({},{durationMs:e-window.g_splashScreenShownHighResTime}),hasImpliedUsage:!0}:{additionalValues:null,hasImpliedUsage:!0};this.getSplashScreenHealthInstance().logKpiSuccess({kpiName:"SplashScreen",optionalProperties:t})}static getSplashScreenHealthInstance(){const e={topLevelKpiName:"SplashScreen",featureName:"Init",crewAlias:"wwbootperf",vetoPillar:null,areaName:Ot.a[Ot.a.Boot]};return Ut.a.getInstance(e)}static updateFastViewShown(e){this._hasFastViewBeenShown=e}static dismissSplashScreenImmediately(){$t._isSplashScreenUp&&this.determineKpiLoggingForSplashScreen(),$t.setSplashScreenInvisible(),$t.setSplashScreenOverlayInvisible()}static dismissSplashScreenOverlay(){$t._isSplashScreenUp&&x.a.splashScreenFadeOut($t._splashscreenOverlay,null,$t.onAfterDismissSplashScreenOverlay)}static registerOnAfterSplashScreenDismissed(e){Array.add($t._splashScreenDismissedCallbacks,e)}static runSplashScreenDismissedCallbacks(){for(let e=0;e<$t._splashScreenDismissedCallbacks.length;++e){(0,$t._splashScreenDismissedCallbacks[e])()}}static showSplashScreen(e=!1){(!$t._isSplashScreenUp||e)&&$t._splashscreenElement&&$t._splashscreenOverlay&&($t._isSplashScreenUp=!0,$t._splashscreenElement.style.display="flex",$t._splashscreenOverlay.style.display="block",$t._splashscreenOverlay.setAttribute(it.a.ariaHiddenAttribute,it.a.ariaFalseValue),dt.a.setOpacity($t._splashscreenElement,100),dt.a.setOpacity($t._splashscreenOverlay,70))}static onAfterDismissSplashScreen(e){$t.setSplashScreenInvisible(),$t.isMobileExperimentEnabled&&($t.hideRibbonRegion(),f.b("HidingRibbonRegionForMword"))}static hideRibbonRegion(){$t._ribbonRegionElement&&($t._ribbonRegionElement.style.display="none")}static onAfterDismissCanvasSkeletalUX(e){$t.setCanvasSkeletalUXInvisible()}static onAfterDismissSplashScreenOverlay(e){$t.setSplashScreenOverlayInvisible()}static setSplashScreenInvisible(){$t._splashscreenElement&&($t._splashscreenElement.style.display="none"),$t._isSplashScreenUp&&($t.clearAriaLoadingAttributes(),$t.runSplashScreenDismissedCallbacks()),$t._isSplashScreenUp=!1}static setCanvasSkeletalUXInvisible(){$t._canvasSkeletalUXElement&&($t._canvasSkeletalUXElement.style.display="none"),$t._isCanvasSkeletalUXUp&&$t.clearAriaLoadingAttributes(),$t._isCanvasSkeletalUXUp=!1}static clearAriaLoadingAttributes(){const e=document.getElementById($t.applicationOuterContainerId);e&&(e.removeAttribute(it.a.ariaHiddenAttribute),e.removeAttribute(it.a.ariaBusyAttribute))}static setSplashScreenOverlayInvisible(){$t._splashscreenOverlay&&($t._splashscreenOverlay.style.display="none",$t._splashscreenOverlay.setAttribute(it.a.ariaHiddenAttribute,it.a.ariaTrueValue))}static reportError(e,t=null,n=null,a=null){$t.reportErrorWithCauseAndResolution(e,0,0,t,n,a)}static add_errorDialogDisplayed(e){$t.eventSource.addHandler($t.errorDialogDisplayedEventKey,e)}static remove_errorDialogDisplayed(e){$t.eventSource.removeHandler($t.errorDialogDisplayedEventKey,e)}static reportErrorWithCauseAndResolution(e,t,n,a=null,i=null,o=null){$t._appEncounteredFirstError||($t._appEncounteredFirstError=!0,I.a.get_instance().isCompleted(13)||(I.a.get_instance().setAppInitializationStatus(13),d.ULS.sendTraceTag(508396299,306,50,"App encountered its first error so updating app init status")));const r=Object.assign(new B,{errorCode:e,errorCause:0,errorResolution:0});if($t.eventSource.raiseEvent($t.errorDialogDisplayedEventKey,r),$t.theWsaClient&&($t.theWsaClient.addToStreamDw(9134,e,t,n),!$t._checkedForBootError&&4!==e&&5!==e&&9!==e&&14!==e&&15!==e&&20!==e&&22!==e)){const t=1e3,n=new Date;(!$t._reportedRenderTime||n.getTime()-$t._renderTime.getTime()<t)&&$t.theWsaClient.setDw(10459,e),"Word"==(null!=$t.sessionStartInfoSettings&&$t.sessionStartInfoSettings.Application)&&$t.appSettingsManager.getBooleanAppSetting("EnableWordBootBeaconStateHandler")&&$t.SendWordBootBeaconWithError(e.toString()),$t._checkedForBootError=!0}(21===e||e>=44&&e<=71)&&$t.suppressCrashReportingToBSqm&&$t.healthTelemetrySystemSupportCrashReportingSuppression||H.a.recordBSqmQosError(e.toString(),a,i,o)}static SendWordBootBeaconWithError(e){try{const t="undefined"!=typeof _wBST&&"function"==typeof _wBST.gCS?_wBST.gCS():"Unknown";"undefined"!=typeof _wBST&&"function"==typeof _wBST.sFKBS&&_wBST.sFKBS(t,e)}catch(e){d.ULS.sendTraceTag(508070051,383,100,"Exception while attempting to log a Boot Beacon KPI:{0}",e)}}static reportRenderTime(e=null,t=!0){if($t._reportedRenderTime)return;let n;if($t._reportedRenderTime=!0,$t._renderTime=e||new Date,void 0!==window.__startTime){const e=window.__startTime;n=$t._renderTime.getTime()-e.getTime()}else n=1e9;t&&$t.theWsaClient.setDw(9086,n),d.ULS.sendTraceTag(508396295,345,50,"Legacy RenderTime (ms): {0}",n)}static sendIsFrameTrustedMessage(){$t._hostFrameTrustCheckIsEnabled&&!$t._isFrameTrustedMessageInitiated&&($t.get_hostPostmessengerFuture().execute((e=>{e.addAllowedReceivingMessage("Host_IsFrameTrusted"),e.registerCallback("Host_IsFrameTrusted",$t.receivedIsFrameTrustedMessage),$t.sendIsFrameTrustedMessageWithRetry(e)})),$t._isFrameTrustedMessageInitiated=!0)}static sendIsFrameTrustedMessageWithRetry(e,t=0){if(2===$t.isHostFrameTrusted){if(t>3)return void d.ULS.sendTraceTag(508396294,306,50,"No retries remaining.");e.sendMessage("App_IsFrameTrusted",null),t++,window.setTimeout((()=>{$t.sendIsFrameTrustedMessageWithRetry(e,t)}),5e3)}}static receivedIsFrameTrustedMessage(e){if($t._hostFrameTrustCheckIsEnabled&&3!==$t.isHostFrameTrusted){0;const t=e.Values.isTopFrameTrusted;let n=!!t&&Boolean.parse(t.toString()||"false");if($t._hostAllowlistCheckIsEnabled&&!n)if(e.Values.m_Origin){const t=ct.a.getHostname(e.Values.m_Origin.toString());n=$t.isHostAllowlistedForAddIns(t)}else d.ULS.sendTraceTag(508396292,306,15,"Messsage origin is null");$t.isHostFrameTrusted=n?5:4}}static isHostAllowlistedForAddIns(e){if(!e)return!1;const t=new RegExp($t._hostAllowlistForAddIns).exec(e);return t&&t.length>=1?$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DisallowEmbed")?(d.ULS.sendTraceTag(508396291,306,100,"IsEmbedded:{0}",$t.isEmbedded),!$t.isEmbedded||$t.isTeamsUiHost||$t.isAssignmentsUiHost?(d.ULS.sendTraceTag(508396290,306,50,"IsHostFrameTrusted set true via Allowlist check:{0}",e),!0):(d.ULS.sendTraceTag(508396289,306,50,"IsHostFrameTrusted set false via Allowlist check:{0}",e),!1)):(d.ULS.sendTraceTag(508396288,306,50,"IsHostFrameTrusted set true via Allowlist check:{0}",e),!0):(d.ULS.sendTraceTag(508396259,306,50,"IsHostFrameTrusted set false via Allowlist check:{0}",e),!1)}static sendSetOverlayContentMessage(e){$t._successfullySetOverlayContent||$t.get_hostPostmessengerFuture().execute((t=>{t.addAllowedReceivingMessage("SetOverlayContent"),t.registerCallback("SetOverlayContent",$t.receivedSetOverlayContentMessage),t.sendMessage("SetOverlayContent",{overlayContent:e})}))}static receivedSetOverlayContentMessage(e){$t._successfullySetOverlayContent=!0}static reportDocumentLoadedTime(e=null,t=!1){$t._reportedLoadTime||($t._reportedLoadTime=!0,I.a.get_instance().setAppInitializationStatus(t?9:8)),$t.documentLoadedTime=e||new Date,Nt.a.instance.recordDocumentLoadedTime($t.documentLoadedTime.getTime()),$t.get_hostPostmessengerFuture().execute((e=>{e.reportDocumentLoadedTime($t.documentLoadedTime.getTime())}))}static get_hostPostmessengerFuture(){return oe.AFrameworkApplicationConstants.get_hostPostmessengerFuture()}static set_hostPostmessengerFuture(e){return oe.AFrameworkApplicationConstants.set_hostPostmessengerFuture(e),e}static reportInitialUi(e){if($t._reportedInitialUi)return;let t;$t._reportedInitialUi=!0,t=e?1:2,$t.theWsaClient.setDw(10309,t)}static getSessionIdQueryParam(){return $t.userSessionIdQueryParam+"="+w.a.urlKeyValueEncode($t.userSessionId)}static getBrowserBuildRequestQueryParam(){return $t.browserBuildQueryParam+"="+w.a.urlKeyValueEncode($t.buildVersion)}static getWacClusterQueryParam(){let e=$t.theClientRequestManager?.wacClusterId;return!e&&$t.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8198587_WacClusterFallsBackToMachineFunction")&&(e=$t.appSettingsManager.getStringAppSetting("WacCluster")),e?"waccluster="+e:null}static getWacUserAgentQueryParam(){return $t.theClientRequestManager&&$t.theClientRequestManager.wacUserAgent?"wdwacuseragent="+$t.theClientRequestManager.wacUserAgent:null}static addCommonUrlParameters(e){$t.ensureCommonUrlParameters((0,u.a)(e,e.addFullParam,"addFullParam"))}static addOrReplaceCommonUrlParameters(e){$t.ensureCommonUrlParameters((0,u.a)(e,e.addOrReplaceFullParam,"addOrReplaceFullParam"))}static ensureCommonUrlParameters(e){$t.userSessionId&&e($t.getSessionIdQueryParam()),$t.buildVersion&&e($t.getBrowserBuildRequestQueryParam());const t=$t.getWacClusterQueryParam();t&&e(t);const n=$t.getWacUserAgentQueryParam();n&&e(n)}static disableControllerServicesViaQueryParam(){$t.isControllerServicesQueryParamNeeded=!0}static enableControllerServicesViaQueryParam(){$t.isControllerServicesQueryParamNeeded=!1}static loadTestFrameworkIfRequested(){$t.shouldDownloadTestFramework()&&(Bt.a.loadTestHarness(),$t.suppressCrashDialog=!0,O.a.debugSettings.assertHandler=O.a.reportAssertToTestHarness)}static shouldDownloadTestFramework(){const e=e=>{try{return sessionStorage.getItem(e)}catch(e){return null}};return""!==Bt.a.webToadHostName&&Bt.a.isBrowserUnderWebToadRun(window.location.href,e)}static registerTestHarnessErrorHandler(e){O.a.registerTestHarnessErrorHandler(e)}static tryReportErrorToTestHarness(e){return O.a.tryReportErrorToTestHarness(e)}static get scheduledShutdownPromptSeconds(){return $t.accessTokenExpirationPromptSeconds}static isMultiTouchGestureEnabled(){return!!$t.appSettingsManager&&($t.appSettingsManager.getBooleanAppSetting("MultiTouchGestureIsEnabledForONO")&&ut.a.isChrome||$t.appSettingsManager.getBooleanAppSetting("MultiTouchGestureIsEnabledForVisio")||$t.appSettingsManager.getBooleanAppSetting("MultiTouchGestureChromeIsEnabled")&&ut.a.isChrome||$t.appSettingsManager.getBooleanAppSetting("MultiTouchGestureNonChromeIsEnabled")&&!ut.a.isChrome)}static isPinchToZoomEnabled(){return!!$t.appSettingsManager&&($t.pinchZoomForOneNoteIsEnabled()&&ut.a.isChrome||$t.appSettingsManager.getBooleanAppSetting("PinchZoomIsEnabled")||$t.appSettingsManager.getBooleanAppSetting("MultiTouchGestureChromeIsEnabled")&&ut.a.isChrome||$t.appSettingsManager.getBooleanAppSetting("MultiTouchGestureNonChromeIsEnabled")&&!ut.a.isChrome)}static shouldUseChromeExtension(){if(!$t.appSettingsManager)return!1;if(ut.a.isChromiumEdge){const e=ut.a.isPasteSupportedNatively();if(($t.appSettingsManager.getBooleanAppSetting("ChromiumEdgeUIPasteForWordIsEnabled")||$t.appSettingsManager.getBooleanAppSetting("ChromiumEdgeUIPasteForPPTIsEnabled")||$t.appSettingsManager.getBooleanAppSetting("ChromiumEdgeUIPasteForOneNoteIsEnabled"))&&e)return!1}return $t.appSettingsManager.getBooleanAppSetting("ChromeClipboardAccessIsEnabled")}static get isSupportedBrowserForPasteHandlerUIPaste(){return null==$t._isSupportedBrowserForPasteHandlerUIPaste&&($t._isSupportedBrowserForPasteHandlerUIPaste=ut.a.isChromiumEdge||ut.a.isElectron||ut.a.isSafari12Up),$t._isSupportedBrowserForPasteHandlerUIPaste}static shouldUsePasteHandlerForUIPaste(){if(!$t.appSettingsManager)return!1;const e=ut.a.isPasteSupportedNatively();return $t.isSupportedBrowserForPasteHandlerUIPaste&&e&&$t.appSettingsManager.getBooleanAppSetting("UsePasteHandlerForUIPasteIsEnabled")}static shouldUsePasteHandlerForUIPasteTextOnly(){if(!$t.appSettingsManager)return!1;const e=ut.a.isPasteSupportedNatively();return $t.isSupportedBrowserForPasteHandlerUIPaste&&e&&$t.appSettingsManager.getBooleanAppSetting("UsePasteHandlerForUIPasteTextOnlyIsEnabled")}static shouldEnableUpdatedRUMReporting(){return!$t.hideHeaderEmbedded&&$t.isHeaderPlaceholderAddNewUxEnabled?!!window.MutationObserver:R.a.instance.areBrowserFeaturesSupported}static registerHeaderPlaceholderTTVRActions(){$t.registerOnAfterSplashScreenDismissed((()=>{Ct.initializeSubComponents("header",["Placeholder","Search"],["SearchShift-1"]),Ct.notifyVisuallyReady("header","Placeholder"),Ct.notifyVisuallyReady("header","Search")}))}static registerStaticRibbonTTVRReporting(){$t.registerOnAfterSplashScreenDismissed((()=>{$t.sendStaticRibbonTTVRActions()}))}static sendStaticRibbonTTVRActions(){if((0,jt.c)()){const e={initializeSubComponents:Ct.initializeSubComponents,notifyVisuallyReady:Ct.notifyVisuallyReady};staticRibbon.api.registerAndUnblockTTVRReporting(e)}else d.ULS.sendTraceTag(507122595,306,15,"Attempted to send static ribbon TTVR actions, but the apis were unavailable")}static markNavFloatiePlaceholderTTVR(){Ct.initializeSubComponent("ribbon","top-bar"),Ct.initializeSubComponent("ribbon","NavFloatie"),Ct.notifyVisuallyReady("ribbon","NavFloatie")}static registerNavFloatiePlaceholderTTVR(){$t.registerOnAfterSplashScreenDismissed((()=>{this.markNavFloatiePlaceholderTTVR()}))}static sendWacFlightToHost(e,t){window.setTimeout((()=>{$t.get_hostPostmessengerFuture().execute((n=>{const a={flightKey:e,flightValue:t};n.sendMessage("App_SetWacFlightValue",a)}))}),3e4)}static get activeFrame(){return oe.AFrameworkApplicationConstants.activeFrame}static set activeFrame(e){oe.AFrameworkApplicationConstants.activeFrame=e}static get bootTime(){return oe.AFrameworkApplicationConstants.bootTime}static set bootTime(e){oe.AFrameworkApplicationConstants.bootTime=e}static get accessTokenTtl(){return oe.AFrameworkApplicationConstants.accessTokenTtl}static set accessTokenTtl(e){oe.AFrameworkApplicationConstants.accessTokenTtl=e}static get accessTokenExpirationPromptSeconds(){return oe.AFrameworkApplicationConstants.accessTokenExpirationPromptSeconds}static set accessTokenExpirationPromptSeconds(e){oe.AFrameworkApplicationConstants.accessTokenExpirationPromptSeconds=e}static get isWopiTokenRefreshEnabled(){return oe.AFrameworkApplicationConstants.isWopiTokenRefreshEnabled}static set isWopiTokenRefreshEnabled(e){oe.AFrameworkApplicationConstants.isWopiTokenRefreshEnabled=e}static get wopiTokenLastRefreshTime(){return oe.AFrameworkApplicationConstants.wopiTokenLastRefreshTime}static set wopiTokenLastRefreshTime(e){oe.AFrameworkApplicationConstants.wopiTokenLastRefreshTime=e}static get wopiTokenExpiresAfterMinutes(){return oe.AFrameworkApplicationConstants.wopiTokenExpiresAfterMinutes}static set wopiTokenExpiresAfterMinutes(e){oe.AFrameworkApplicationConstants.wopiTokenExpiresAfterMinutes=e}static get rootQuerySignature(){return oe.AFrameworkApplicationConstants.rootQuerySignature}static set rootQuerySignature(e){oe.AFrameworkApplicationConstants.rootQuerySignature=e}static get baseDocQuerySignatureWithoutVersion(){return oe.AFrameworkApplicationConstants.baseDocQuerySignatureWithoutVersion}static set baseDocQuerySignatureWithoutVersion(e){oe.AFrameworkApplicationConstants.baseDocQuerySignatureWithoutVersion=e}static getRegisteredFrames(){return oe.AFrameworkApplicationConstants.getRegisteredFrames()}static get registeredFramesArray(){return oe.AFrameworkApplicationConstants.registeredFramesArray}static set registeredFramesArray(e){oe.AFrameworkApplicationConstants.registeredFramesArray=e}static get currentFileBaseDocQuerySignatureWithoutVersion(){return oe.AFrameworkApplicationConstants.currentFileBaseDocQuerySignatureWithoutVersion}static set currentFileBaseDocQuerySignatureWithoutVersion(e){oe.AFrameworkApplicationConstants.currentFileBaseDocQuerySignatureWithoutVersion=e}static get staticContentScriptNameBase(){return oe.AFrameworkApplicationConstants.staticContentScriptNameBase}static get scriptFolderPath(){return oe.AFrameworkApplicationConstants.scriptFolderPath}static set scriptFolderPath(e){oe.AFrameworkApplicationConstants.scriptFolderPath=e}static set scriptDebugExtension(e){oe.AFrameworkApplicationConstants.scriptDebugExtension=e}static get flightId(){return oe.AFrameworkApplicationConstants.flightId}static set flightId(e){oe.AFrameworkApplicationConstants.flightId=e}static get scheduledShutdownTtl(){return oe.AFrameworkApplicationConstants.scheduledShutdownTtl}static set scheduledShutdownTtl(e){oe.AFrameworkApplicationConstants.scheduledShutdownTtl=e}static get lcid(){return oe.AFrameworkApplicationConstants.lcid}static set lcid(e){oe.AFrameworkApplicationConstants.lcid=e}static get useParentHelpFunction(){return oe.AFrameworkApplicationConstants.useParentHelpFunction}static set useParentHelpFunction(e){oe.AFrameworkApplicationConstants.useParentHelpFunction=e}static get numberFormat(){return oe.AFrameworkApplicationConstants.numberFormat}static set numberFormat(e){oe.AFrameworkApplicationConstants.numberFormat=e}static get accessTokenTtlParamName(){return oe.AFrameworkApplicationConstants.accessTokenTtlParamName}static get sessionOriginParamName(){return oe.AFrameworkApplicationConstants.sessionOriginParamName}static recieveCondition(){window.addEventListener("message",(e=>{I.a.get_instance().executeWhen(19,(()=>{if(e.data?.flightCondition){let t=!1;try{const n=JSON.parse(e.data.flightCondition);t=!!document.querySelector(n.querySelectorInput)}catch(e){t=!1}this.sendDOMConditionReturnMessage(t)}}))}),!1)}static sendAppBootedMessage(){$t.get_hostPostmessengerFuture().execute((e=>{e.addAllowedReceivingMessage("CheckDOMCondition"),e.sendMessage("CheckDOMCondition",{isAppBooted:!0})}))}static sendDOMConditionReturnMessage(e){$t.get_hostPostmessengerFuture().execute((t=>{t.addAllowedReceivingMessage("ReturnDOMCondition"),t.sendMessage("ReturnDOMCondition",{domCondition:e})}))}static get hostCanary(){return oe.AFrameworkApplicationConstants.hostCanary}static set hostCanary(e){oe.AFrameworkApplicationConstants.hostCanary=e}static set isControllerServicesQueryParamNeeded(e){oe.AFrameworkApplicationConstants.isControllerServicesQueryParamNeeded=e}static get theWacAirSpaceEngine(){return oe.AFrameworkApplicationConstants.theWacAirSpaceEngine}static set theWacAirSpaceEngine(e){oe.AFrameworkApplicationConstants.theWacAirSpaceEngine=e}static get limitedEdit(){return oe.AFrameworkApplicationConstants.limitedEdit}static set limitedEdit(e){oe.AFrameworkApplicationConstants.limitedEdit=e}static get hideHeaderEmbedded(){return oe.AFrameworkApplicationConstants.hideHeaderEmbedded}static set hideHeaderEmbedded(e){oe.AFrameworkApplicationConstants.hideHeaderEmbedded=e}static get showFeedbackButton(){return oe.AFrameworkApplicationConstants.showFeedbackButton}static set showFeedbackButton(e){oe.AFrameworkApplicationConstants.showFeedbackButton=e}static get showCopilotFeedbackButton(){return oe.AFrameworkApplicationConstants.showCopilotFeedbackButton}static set showCopilotFeedbackButton(e){oe.AFrameworkApplicationConstants.showCopilotFeedbackButton=e}static get privacyUrl(){return oe.AFrameworkApplicationConstants.privacyUrl}static set privacyUrl(e){oe.AFrameworkApplicationConstants.privacyUrl=e}static get eventSource(){return Qt.AFrameworkApplication_AppShutDown.eventSource}static set eventSource(e){Qt.AFrameworkApplication_AppShutDown.eventSource=e}static get shuttingDownEventKey(){return Qt.AFrameworkApplication_AppShutDown.shuttingDownEventKey}static subscribeToBeforeAppShutDown(e){Qt.AFrameworkApplication_AppShutDown.subscribeToBeforeAppShutDown(e)}get shouldUpdatePermanentErrorList(){return null!=this.__cached_shouldUpdatePermanentErrorList_1_568dd0cd?this.__cached_shouldUpdatePermanentErrorList_1_568dd0cd:this.__cached_shouldUpdatePermanentErrorList_1_568dd0cd=!!$t.appSettingsManager&&$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.UpdatePermanentErrorList")}static get createACopyFeatureEnabledForProtectedFiles(){return null!=$t.__cached_createACopyFeatureEnabledForProtectedFiles_2_568dd0cd?$t.__cached_createACopyFeatureEnabledForProtectedFiles_2_568dd0cd:$t.__cached_createACopyFeatureEnabledForProtectedFiles_2_568dd0cd=$t.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CreateACopyFeatureEnabledForProtectedFiles",!1)??!1}static get homeButtonUrl(){return $t._homeButtonUrl}static isMobileBrowser(){return/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static get isMobileExperimentEnabled(){return null!=$t.__cached_isMobileExperimentEnabled_3_568dd0cd?$t.__cached_isMobileExperimentEnabled_3_568dd0cd:$t.__cached_isMobileExperimentEnabled_3_568dd0cd=(()=>!(!this.isMobileBrowser()||!$t.appSettingsManager)&&$t.appSettingsManager.getBooleanAppSetting("MwacWordEditorExperimentExperienceIsEnabled"))()}static getFeedbackEligibility(e){const t=[];return $t.showFeedbackButton&&(t.push("CanShowGeneralFeedbackButton"),t.push("CanShowSingleClickFeedbackButton")),$t.showCopilotFeedbackButton&&(t.push("CanShowGeneralCopilotFeedbackButton"),t.push("CanShowSingleClickCopilotFeedbackButton")),t.includes(e)}constructor(e,t=!0){this._isFocusManagerBugFixEnabled=!1,this._isHttp2Enabled=!1,this.getWorkerLoggerSettings=()=>{try{const e="OtelWorker",t=(new Date).getTime(),n={recordKpiUsage:()=>{W.Health.instance.recordKpiUsage(e,Rt.b.SuccessBased,"wactelhealthfc",null)},recordKpiSuccess:(t,n)=>{W.Health.instance.recordKpiSuccess(e,Object.assign({},{durationMs:t,extendedProperties:n}))},recordKpiFailure:(t,n)=>{W.Health.instance.recordKpiFailure(e,t,!1,!0,Object.assign({},{extendedProperties:n}))}},a={sendTraceTag:(e,t,n,a)=>{d.ULS.sendTraceTag(e,t,n,a)}},i={enabled:$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OtelWorkerIsBatchingEnabled",!0),numEventsToTriggerUpload:$t.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.OtelWorkerNumEventsToTriggerUpload",10),timeToWaitBeforeAutoUploadingEvents:$t.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.OtelWorkerTimeToWaitBeforeAutoUploadingEvents",1e4),periodicPingFrequency:$t.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.PeriodicPingFrequency",3e3)};let o=(new Date).getTime();try{$t.sessionStartInfoSettings&&"StartTimeUtc"in $t.sessionStartInfoSettings&&(o=new Date($t.sessionStartInfoSettings.StartTimeUtc).getTime())}catch(e){}const r={sessionStartTime:o,startOtelWorkerMethodScriptSharpDuration:(new Date).getTime()-t};let s=!1;$t.appSettingsManager&&$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelWorkerApiMonitoring",!1)&&(s=!0);const l=this.getPrivacyGuardContext(),c={telemetryLoggerSettings:this.getOtelWorkerTelemetrySettings(),workerUrl:$t.scriptUrlFromName($t.getOtelWorkerJSName(),5),batchingSettings:i,healthKpiMethods:n,ulsLoggingMethods:a,appData:r,uuid:()=>yt.a.create().toString(),minSinkLimit:$t.appSettingsManager.getIntAppSetting("OtelMinSinkEventLimit",500),batchSize:$t.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.OtelWorkerBatchSize",100),batchFrequencyMs:$t.appSettingsManager.getIntFeatureGate("Microsoft.Office.SharedOnline.OtelWorkerBatchFrequencyMs",1e3),pgContext:l,enableMinSinkDNM:$t.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8409925_OTelMinSinkDNMIsEnabled"),TrustedTypesPolicy:s};if(!c.telemetryLoggerSettings)throw Error.format("TelemetryLoggerSettings could not be loaded.");return d.ULS.sendTraceTag(508396363,228,50,"Starting the OTel worker"),c}catch(e){return d.ULS.sendExceptionTraceTag(570750431,228,15,e,"Failed to initialize the OTel worker"),null}},this.crashApplication=()=>{null.crash()},this.reportEventInterruptedJavascript=e=>{0},$t._instance=this}}$t.documentStreamId=2096,$t.documentStreamWidth=9,$t.supportsViewingFlag="V",$t.supportsEditingFlag="E",$t.supportsCobaltFlag="C",$t.supportsPublishingFlag="P",$t.supportsEditingWithLocksFlag="L",$t.supportsReviewingFlag="R",$t._isAssignmentsUiHost=!1,$t.consumptionSupportedParamName="csc",$t.isInteractiveReadOnlyParamName="cons",$t.postmessageFocusId=oe.AFrameworkApplicationConstants.postmessageFocusId,$t._renderTime=null,$t._reportedRenderTime=!1,$t._checkedForBootError=!1,$t._reportedInitialUi=!1,$t._reportedLoadTime=!1,$t._appEncounteredFirstError=!1,$t._isUpdateFullSessionStartInfoCalled=!1,$t._createdPageNodeIDs=null,$t._documentLoadedTime=null,$t.documentAssemblyEnabledV2=!1,$t.documentAssemblyEnabledModes=null,$t.serverDebugSuffix="",$t.serverMinSuffix="",$t._registeredFrames={},$t._splashscreenElement=null,$t._splashscreenOverlay=null,$t._ribbonRegionElement=null,$t._canvasSkeletalUXElement=null,$t._isSplashScreenUp=!0,$t._isCanvasSkeletalUXUp=!1,$t._splashScreenDismissedCallbacks=[],$t.endSessionHeaderReceivedCallback=null,$t.theUlsHost=null,$t.delayLoadCloudPolicy=!1,$t.isClosureEnabled=!1,$t._pairwiseBrokerHostCompleteListener=new Promise((e=>{$t.get_hostPostmessengerFuture().execute((t=>{if($t.appSettingsManager&&$t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacPairwiseBrokerEnabled",!1)){const n=a=>{if(!t.isOriginAllowed(a.origin))return;let i=a.data;if("string"==typeof i)try{i=JSON.parse(i)}catch{}if(i.MessageId&&"Host_MsalComplete"===i.MessageId){window.removeEventListener("message",n);const t=i.Values&&i.Values.error;e(t?{complete:!1,error:t}:{complete:!0})}};window.addEventListener("message",n)}else e({complete:!1,error:"Pairwise broker for WAC is disabled"})}))})),$t.theWindowEventManager=null,$t.hostPostmessenger=null,$t.theOfflineLogger=null,$t.errorDialogAdditionalQosVetos=[],$t._extraErrorInfoFromHost=null,$t._areRoamingAppsEnabled=!1,$t.privacyDialogText=null,$t.privacyDialogLinkText=null,$t.privacyDialogTitleText=null,$t.privacyDialogFwlinkId=null,$t.privacyCookieDomain=null,$t.mightNeedPrivacyDialog=!1,$t.privacyDialogShouldCheckRoaming=!1,$t.privacyDialogCanWriteServerSettings=!1,$t.privacyDialogCurrentVersion=0,$t.privacyDialogAlreadySeen=!1,$t.wopiIdentityWhitelist=null,$t._isWopiTokenRefreshWhenSessionExpiredEnabled=!1,$t._isWopiTokenRefreshCancelExpirationEnabled=!1,$t._wopiTokenRefreshRetryeInterval=0,$t._wopiTokenRefreshRetryIntervalForClientNetworkIssue=0,$t.wopiTokenRefreshNetworkErrorIdList=null,$t.wopiTokenRefreshPermanentHostErrorIdList=null,$t._wopiTokenRefreshMaxRetryAttempts=0,$t.wopiTokensToRefresh=null,$t._wopiTokenExpirationPolicy=0,$t._wopiTokenTaskItemPriority=0,$t._isTeamsUiHost=!1,$t.wopiHostOriginFromPostMessage=null,$t.docPropertiesProvider=null,$t.collectPageStats=!1,$t.showPageStats=!1,$t.suppressCrashDialog=!1,$t.suppressRetryFromCrashDialog=!1,$t.suppressRetryFromCrashDialogMessage=null,$t._wasAuthenticationLostDuringSession=!1,$t.suppressDebugCrashDialog=!1,$t.suppressCrashReportingToBSqm=!1,$t.suppressCrashReportingToWatson=!1,$t.reportSuppressedCrashesToWatson=!1,$t.splitCrashError=!1,$t.reportAdditionCrashProperties=!1,$t.appInitTime=new Date,$t.appPreloadStatistics="",$t.forceTouchRibbon=!1,$t.controllerConnectedServicesEnabled=!0,$t.isReadOnlyRecommended=!1,$t.isInImmersiveReaderMode=!1,$t.hostOperationHttpStatusCode=0,$t.hostOperationNetworkErrorStatusCode=null,$t.clientPermissionDeniedDueToNetworkLocation=!1,$t.closeUrl="",$t.useClosePostMessage=!1,$t.termsUrl="",$t.filePropertiesUrl="",$t.useFilePropertiesPostMessage=!1,$t.fileSharingUrl="",$t.useFileSharingPostMessage=!1,$t.fileShareEnabled=!1,$t.workflowTypeString="",$t.workflowUrl="",$t.useWorkflowPostMessage=!1,$t.workflowEnabled=!1,$t.copyAndEditUrl="",$t.useCopyAndEditPostMessage=!1,$t.useEditModePostMessage=!1,$t.useRedeemForCommentingPostMessage=!1,$t.useSignInCommandPostMessage=!1,$t.appCatalogUrl="",$t.decryptSkipReason="",$t.downloadACopyUrl="",$t.directReadUrl="",$t.directInvokeDAVUrl="",$t.fileDocInClientUrl="",$t.fileDownloadCode="",$t.fileEmbedCommandUrl="",$t.hostEmbeddedViewUrl="",$t.hostEmbeddedEditUrl="",$t.useFileEmbedCommandPostMessage=!1,$t.replyWithChangesUrl="",$t.useReplyWithChangesPostMessage=!1,$t.isReplyWithChangesWorkFlow=!1,$t.fileVersionUrl="",$t.useFileVersionPostMessage=!1,$t.useOpenInClientPostMessage=!1,$t.preferPostMessageOverCommandUrlForOpenInClient=!1,$t.addSessionIdToClientUrl=!1,$t.fileName="",$t.sessionContext="",$t.reportAbuseUrl=null,$t.hostAuthenticatesUsersDuringOpenInClient=!1,$t.breadcrumbBrandName=null,$t.breadcrumbBrandUrl=null,$t.breadcrumbFolderName=null,$t.breadcrumbFolderUrl=null,$t.userName=null,$t.userNameUnknown=!1,$t.signoutUrl=null,$t.signInUrl=null,$t.consumerHealthPolicyUrl="",$t.hideHeader=!1,$t.isMobileMode=!1,$t.closeButtonClosesWindow=!1,$t.isCloseable=!1,$t.suppressHelp=!1,$t.hideRibbon=!1,$t.hideContextMenu=!1,$t.hideRibbonEmbedded=!1,$t.canSupportConsumption=!1,$t.feedbackStringId=0,$t.showRtcConnectionStatus=!1,$t.openInClientEditOnly=!1,$t.webEditingEnabled=!1,$t.downloadCopyOnOpenInClient=!1,$t.needsSignOutChecking=!1,$t.isOpenInClientEnabled=!1,$t.firstRunExperienceIsEnabled=!1,$t.firstRunExperienceUiVariation=0,$t.assistanceIsEnabled=!1,$t.assistancePaneIsEnabled=!1,$t.assistanceSearchUrl=null,$t.copyLinkForTeamsIsEnabled=!1,$t.isUnifiedHostMode=!1,$t.tellMeIsEnabled=!1,$t.smartLookupIsEnabled=!1,$t.insightsIsEnabled=!1,$t.allowEarlyFeaturesForHost=!1,$t.enrichmentIsEnabled=!1,$t.hostSupportsFileRename=!1,$t.hostSupportsVersionHistory=!1,$t.appSupportsFileRename=!1,$t.appSupportsVersionHistory=!1,$t.insertOnlinePictureFromHostEnabled=!1,$t.hostSupportsInsertOnlinePictureFromHost=!1,$t.appSupportsInsertOnlinePictureFromHost=!1,$t.appSupportsMultiInsertOnlinePictureFromHost=!1,$t.appSupportsInsertOnlinePictureFromSharePoint=!1,$t.userCanRename=!1,$t.renameInCoauthSessionWithRenameCapableClientsIsEnabled=!1,$t.isUnauthEdit=!1,$t.readyToLeaveUnauthEdit=!1,$t.documentTitleInputElement=null,$t.fileNameMaxLength=0,$t.renameFileTooltip=null,$t.renameFileExecutedInCurrentSession=!1,$t.rtcTransportProtocol=null,$t.peoplesWellIsEnabled=!1,$t._isDogfoodEnvironment=!1,$t._environment=0,$t.browserUlsIsEnabled=!1,$t.bulsUploadMaxSize=0,$t.bulsSizeThresholdBytes=null,$t.browserUlsTraceLevel=0,$t._trimOICButtonsIfUnavailable=!1,$t.suppressAppCloseOnNavigate=!1,$t.isOfficeTrialOfferEnabled=!1,$t.isMacOfficeTrialOfferEnabled=!1,$t.dialogClearerStringsIsEnabled=!1,$t.dialogDefaultEnterBehaviorIsEnabled=!1,$t.isShuttingDownFromPostMessage=!1,$t.requestedLcid=0,$t._isEmbedded=!1,$t._shouldHideToolbarOnViewerRedirect=!1,$t._isNoChrome=!1,$t.isRenameKpiLoggingEnabled=!1,$t.shouldShowSwitcher=!1,$t.hasExternalHeader=!1,$t.lokiEndpointForSearch=null,$t.tellMeQueryIndexLoggingBaseUrl=null,$t.substrateEndpointForSearch=null,$t.tellMeServiceEndpointForSearch=null,$t.accessibilityUseRoleDialog=!1,$t.printingEnabled=!1,$t.protectFile=!1,$t.protectedFile=!1,$t.enableExtractForProtectedFile=!1,$t.enableExportForProtectedFile=!1,$t.enableFullControlForProtectedFile=!1,$t.isMandatoryLabellingMode=!1,$t.hideAppLauncherInHeaderByUiHost=!1,$t.hideSearchInHeaderByUiHost=!1,$t.defaultDocumentTitleToLeftByUiHost=!1,$t.hideMeInHeaderByUiHost=!1,$t.hideWorkflowInHeaderByUiHost=!1,$t.hideChatInHeaderByUiHost=!1,$t.enableMacrosForProtectedFile=!1,$t.copilotEnabled=!1,$t.mosForWXPEnabled=!1,$t.isMeetingLiveSession=!1,$t.meetingId=null,$t.meetingTitle=null,$t.meetingType=null,$t.meetingScheduledStartTime=null,$t.meetingScheduledEndTime=null,$t.isMeetingPresenter=!1,$t.meetingOrganizerId=null,$t.meetingJoinUrl=null,$t.liveInTeamsWordAppSharingUrl=null,$t.handOffMessageId=null,$t.formatReuseMessageId=null,$t.supportsInPlaceCreateNew=!1,$t.disableEmbedViewCodeSnippet=!1,$t._irmPolicyTitle=null,$t._irmPolicyDescription=null,$t._isSleeping=!1,$t._isHostFrameTrusted=0,$t._hostFrameTrustCheckIsEnabled=!1,$t._hostAllowlistCheckIsEnabled=!1,$t._isFrameTrustedMessageInitiated=!1,$t._hostAllowlistForAddIns=null,$t._requiresCheckout=!1,$t._theAppSleepTask=null,$t._sleepIntervalInMsec=0,$t.isCrossDocumentMessengerDisabled=!1,$t.postMessageOrigin="",$t._versionedPathToClusterImages=null,$t._scriptBase=null,$t.requiresCrossDomainAjax=!1,$t.fromTypingIndex=-1,$t._isSkyDrive=!1,$t._hostNameToIncludeInSavedStatus=null,$t._unifiedHeaderOfficeOnlineLogoWidth=0,$t._newDocumentDestinationHost=null,$t._isNewDocumentTemplateUIEnabled=!1,$t._isTellMeUpSellEnterpriseEnabled=!1,$t._newMenuMoreTemplatesUrl=null,$t._isAppsForOfficeSingleSignOnSupportedOnHost=!1,$t._hideAppsExtensionUrl=null,$t._dataBoundary=0,$t._limitedAppStateNotificatioBar=null,$t.disableWholeAppsForOfficeFeature=!1,$t.sdxAllowList=null,$t.sdxExceptionFrom1CDNList=null,$t.dmsSdxListDocument=null,$t.dmsSdxListWorkbook=null,$t.dmsSdxListPresentation=null,$t.sdxIsEnabled=!1,$t.defaultManifestTokens={__proto__:null},$t._documentIsFolder=!1,$t._readFromMruIsEnabled=!1,$t._mruPollingIntervalInMs=0,$t._timeUntilInactiveInMs=0,$t._openMenuBrowseMoreHostUrl=null,$t._openMenuBrowseMoreHostName=null,$t._supportsGetMoreInfoForPersonalStorage=!1,$t._getMoreInfoRetryIntervalsInMs=null,$t.healthTelemetrySystemSupportCrashReportingSuppression=!1,$t._cursorPinningIsEnabled=!1,$t._nativeSelectionAndContextMenu=!1,$t.executeRenameFile=null,$t.executeVersionHistory=null,$t.executeRefreshFilename=null,$t.sendFileNameAndLocationUpdateNotification=null,$t._updateMruIsEnabled=!1,$t._wacCopyPasteShortcutDialogIsEnabled=!1,$t._flights=null,$t.bootAppFromMiniCheck=!1,$t.useMiniCheckedDocumentParam=null,$t.logCanaryInBrowser=!1,$t.useO365ShellService=!1,$t.applicationDivId="application",$t.externalHeaderPanelId="AppHeaderPanel",$t.externalHeaderPanelClassName="AppHeaderPanel",$t.applicationOuterContainerId="applicationOuterContainer",$t.externalHeaderLabel=null,$t.featureStatusSettingsValue={},$t.sessionStartAndEndData=null,$t._removeWacDialogKeyUpHandler=!1,$t.isNewFile=!1,$t._newFileTemplateName=null,$t._newFileTemplateLcid=null,$t.bootPerfDebuggingMetrics={},$t._instance=null,$t._otelShutdownTriggered=!1,$t.errorDialogDisplayedEventKey="ErrorDialogDisplayedEvent",$t._logSessionEndDataCalled=!1,$t._successfullySetOverlayContent=!1,$t.coauthManager=null,$t._hasFastViewBeenShown=!1,$t._hasViewerSplashScreenBeenDismissed=!1,$t._homeButtonUrl=null,$t._isSupportedBrowserForPasteHandlerUIPaste=null,$t.isInteractiveReadOnlyMode=!1,$t.restrictedActivitiesInInteractiveReadOnlyMode=[],$t.isHeaderPlaceholderAddNewUxEnabled=$t.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HeaderPlaceholderAddNewUx",!1),(0,i.a)($t,"AFrameworkApplication",null,[11])},6776:function(e,t,n){"use strict";n.r(t),n.d(t,{AFrameworkApplicationConstants:function(){return h}});var a=n(100),i=n(3792),o=n(6487),r=n(2650),s=n(2274),l=n(9969),c=n(1207);class d{constructor(){this.negativeSign=null,this.numberDecimalDigits=0,this.numberDecimalSeparator=null,this.numberGroupSeparator=null,this.numberGroupSizes=null,this.numberNegativePattern=0,this.percentDecimalDigits=0,this.percentDecimalSeparator=null,this.percentGroupSeparator=null,this.percentGroupSizes=null,this.percentNegativePattern=0,this.percentPositivePattern=0,this.percentSymbol=null}}(0,a.a)(d,"NumberFormatInfo",null,[]);var u=n(311),p=n(9838);const g="AppRtl";class h{static get accessTokenTtl(){return h._accessTokenTtl}static isScheduledShutdownEnabled(){return!!s.AFrameworkApplication_AppSettingsManager.appSettingsManager&&s.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("SessionExpirationDueToScheduledShutdownIsEnabled")}static get isWopiTokenRefreshEnabled(){return h._isWopiTokenRefreshEnabled}static set isWopiTokenRefreshEnabled(e){h._isWopiTokenRefreshEnabled=e}static get wopiTokenExpiresAfterMinutes(){return h._wopiTokenExpiresAfterMinutes}static set wopiTokenExpiresAfterMinutes(e){h._wopiTokenExpiresAfterMinutes=e}static get rootQuerySignature(){return h._rootQuerySignature}static set rootQuerySignature(e){h._rootQuerySignature=e,(0,p.a)().rootQuerySignature=e}static get isRtl(){return h._isRtl}static set isRtl(e){h._isRtl!==e&&(h._isRtl=e,h.updatePageRtl(h._isRtl))}static updatePageRtl(e){let t;if(e?(Sys.UI.DomElement.addCssClass(document.body,g),t="rtl"):(Sys.UI.DomElement.removeCssClass(document.body,g),t="ltr"),h.isDivSyndicated){const e=h.getRegisteredFrames();for(let n=0,a=e.length;n<a;n++)e[n].getDOMElement().dir=t}else document.body.dir=t,document.documentElement.dir=t}static get scheduledShutdownPromptSeconds(){return h.accessTokenExpirationPromptSeconds}static set accessTokenTtl(e){h.isWopiTokenRefreshEnabled&&(h.baseDocQuerySignatureWithoutVersion&&(h.baseDocQuerySignatureWithoutVersion=l.a.addOrReplaceParameterValueInQueryParams(h.baseDocQuerySignatureWithoutVersion,h.accessTokenTtlParamName,e.toString())),h.currentFileBaseDocQuerySignatureWithoutVersion&&(h.currentFileBaseDocQuerySignatureWithoutVersion=l.a.addOrReplaceParameterValueInQueryParams(h.currentFileBaseDocQuerySignatureWithoutVersion,h.accessTokenTtlParamName,e.toString())),h.rootQuerySignature&&(h._rootQuerySignature=l.a.addOrReplaceParameterValueInQueryParams(h.rootQuerySignature,h.accessTokenTtlParamName,e.toString()))),h._accessTokenTtl=e}static getGroupSizesArrayFromString(e){const t=e.split(","),n=t.length,a=new Array(n);for(let e=0;e<n;e++)a[e]=parseInt(t[e]);return a}static createNumberFormat(){const e=new d;return void 0!==s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.NegativeSign&&null!==s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.NegativeSign&&(e.negativeSign=s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.NegativeSign,e.numberDecimalDigits=parseInt(s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.NumberDecimalDigits),e.numberDecimalSeparator=s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.NumberDecimalSeparator,e.numberGroupSeparator=s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.NumberGroupSeparator,e.numberGroupSizes=h.getGroupSizesArrayFromString(s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.NumberGroupSizes),e.numberNegativePattern=parseInt(s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.NumberNegativePattern),e.percentDecimalDigits=parseInt(s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.PercentDecimalDigits),e.percentDecimalSeparator=s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.PercentDecimalSeparator,e.percentGroupSeparator=s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.PercentGroupSeparator,e.percentGroupSizes=h.getGroupSizesArrayFromString(s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.PercentGroupSizes),e.percentNegativePattern=parseInt(s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.PercentNegativePattern),e.percentPositivePattern=parseInt(s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.PercentPositivePattern),e.percentSymbol=s.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.PercentSymbol),e}static get scriptFolderPath(){return h._scriptFolderPath}static set scriptFolderPath(e){h._scriptFolderPath=e}static get staticContentScriptNameBase(){return c.a.staticContentHost+h.scriptFolderPath}static get numberFormat(){return h._numberFormat||(h._numberFormat=h.createNumberFormat())}static set numberFormat(e){h._numberFormat=e}static getRegisteredFrames(){return h._registeredFramesArray}static get activeFrame(){if(!h._activeFrame){const e=h.getRegisteredFrames();h._activeFrame=e[0]}return h._activeFrame}static set activeFrame(e){h._activeFrame=e}static get registeredFramesArray(){return h._registeredFramesArray}static set registeredFramesArray(e){h._registeredFramesArray=e}static get imageClusterPath(){return h._imageClusterPath}static set imageClusterPath(e){h._imageClusterPath=e}static get_hostPostmessengerFuture(){return h._hostPostmessengerFuture||(h._hostPostmessengerFuture=(0,i.h)(r.a))}static set_hostPostmessengerFuture(e){return h._hostPostmessengerFuture=e,e}static get imageClusterName(){return h._imageClusterName}static set imageClusterName(e){h._imageClusterName=e}static get accessToken(){return h._accessToken}static set accessToken(e){h.isWopiTokenRefreshEnabled&&(h.baseDocQuerySignatureWithoutVersion&&(h.baseDocQuerySignatureWithoutVersion=l.a.addOrReplaceParameterValueInQueryParams(h.baseDocQuerySignatureWithoutVersion,h.accessTokenParamName,encodeURIComponent(e))),h.currentFileBaseDocQuerySignatureWithoutVersion&&(h.currentFileBaseDocQuerySignatureWithoutVersion=l.a.addOrReplaceParameterValueInQueryParams(h.currentFileBaseDocQuerySignatureWithoutVersion,h.accessTokenParamName,encodeURIComponent(e))),h.rootQuerySignature&&(h.rootQuerySignature=l.a.addOrReplaceParameterValueInQueryParams(h.rootQuerySignature,h.accessTokenParamName,encodeURIComponent(e)))),h._accessToken=e}static get latestActivityTime(){return h._latestActivityTime}static set latestActivityTime(e){h._latestActivityTime=e}static get isUIEmbedMode(){return h._isUIEmbedMode}static set isUIEmbedMode(e){h._isUIEmbedMode=e}static get isControllerServicesQueryParamNeeded(){return h._isControllerServicesQueryParamNeeded}static set isControllerServicesQueryParamNeeded(e){h._isControllerServicesQueryParamNeeded=e}static get wd1jsIsEnabled(){return!!s.AFrameworkApplication_AppSettingsManager.appSettingsManager&&s.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("Wd1jsIsEnabled")}static getCurrentZoom(){return h.pinchZoomForOneNoteIsEnabled()&&h.get_futureZoomManager().instance?h.get_futureZoomManager().instance.currentZoom:1}static pinchZoomForOneNoteIsEnabled(){return s.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OneNotePinchZoomIsEnabled")}static get_futureZoomManager(){return h.pinchZoomForOneNoteIsEnabled()?h._futureZoomManager||(h._futureZoomManager=(0,i.h)(o.a)):null}static get isCustomerFeedbackExternal(){return h._isCustomerFeedbackExternal}static set isCustomerFeedbackExternal(e){h._isCustomerFeedbackExternal=e}}h._isCustomerFeedbackExternal=!1,h.hideHeaderEmbedded=!1,h.privacyUrl="",h.showFeedbackButton=!1,h.showCopilotFeedbackButton=!1,h.feedbackDescription=null,h.noAuthQueryParam="NoAuth",h.officeApplicationModeDatapointId=8721,h.modeSwitchTimeParamName="wdModeSwitchTime",h.previousSessionParamName="wdPreviousSession",h.correlationIdQueryParam="corrid",h.uiHostParamName="uih",h.invalidHostCanaryRedirectParamName="wdHCRedir",h.uiHostScenarioTypeSettingName="UiHostScenarioType",h.sessionStartInfoSettings=null,h.uiHostSettingName="UiHost",h.uiHostIntegrationTypeSettingName="UiHostIntegrationType",h.sessionOriginParamName="wdOrigin",h.useParentHelpFunction=!1,h.theWacAirSpaceEngine=null,h.dataPlumber=new u.a,h._futureZoomManager=null,h.theClientRequestManager=null,h._hostPostmessengerFuture=null,h.scriptDebugExtension="debug.",h.flightId=null,h.scheduledShutdownTtl=0,h.wopiTokenLastRefreshTime=0,h._isWopiTokenRefreshEnabled=!1,h._accessTokenTtl=0,h._wopiTokenExpiresAfterMinutes=0,h._rootQuerySignature=null,h._isRtl=!1,h._latestActivityTime=new Date,h._isControllerServicesQueryParamNeeded=!1,h._isUIEmbedMode=!1,h.userSessionIdQueryParam="usid",h.browserBuildQueryParam="build",h.controllerServicesParamName="wdccsoff",h.limitedEdit=!1,h.hostUIControlSettingName="HostDefinedUIControls",h.postmessageFocusId="HostIntegrationMessaging",h.currentFileBaseDocQuerySignatureWithoutVersion=null,h.baseDocQuerySignatureWithoutVersion=null,h.bootTime=0,h.accessTokenExpirationPromptSeconds=0,h.accessTokenTtlParamName="access_token_ttl",h.isDivSyndicated=!1,h.accessTokenParamName=null,h.lcid=0,h.accessTokenServerExpirationTime=0,h.isShuttingDown=!1,h.useCrossOriginStaticScripts=!1,h._numberFormat=null,h._scriptFolderPath=null,h._activeFrame=null,h._registeredFramesArray=[],h._imageClusterPath=null,h._imageClusterName=null,(0,a.a)(h,"AFrameworkApplicationConstants",null,[])},1510:function(e,t,n){"use strict";n.r(t),n.d(t,{AFrameworkApplication_ActionManager:function(){return l}});var a=n(100),i=n(3792),o=n(5385),r=n(4182),s=n(1057);class l{static get theActionManager(){return l._theActionManager||(l._theActionManager=new s.ActionManager((0,i.h)(r.a),(0,i.h)(o.a)))}static set theActionManager(e){l._theActionManager=e}}l._theActionManager=null,(0,a.a)(l,"AFrameworkApplication_ActionManager",null,[])},2274:function(e,t,n){"use strict";n.r(t),n.d(t,{AFrameworkApplication_AppSettingsManager:function(){return i}});var a=n(100);class i{}(0,a.a)(i,"AFrameworkApplication_AppSettingsManager",null,[])},2118:function(e,t,n){"use strict";n.r(t),n.d(t,{AFrameworkApplication_AppShutDown:function(){return r}});var a=n(100),i=n(5149),o=n(5018);class r{static subscribeToBeforeAppShutDown(e){r.add_beforeAppShutDown(((t,n)=>{try{e(t,n)}catch(e){i.ULS.shipAssertTag(508396298,201,!1,e.toString())}}))}static add_beforeAppShutDown(e){r.eventSource.addHandler(r.shuttingDownEventKey,e)}static remove_beforeAppShutDown(e){r.eventSource.removeHandler(r.shuttingDownEventKey,e)}}r.shuttingDownEventKey="ShuttingDownEvent",r.eventSource=new o.a,(0,a.a)(r,"AFrameworkApplication_AppShutDown",null,[])},7112:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.theDefaultErrorHandler=null,(0,a.a)(i,"AFrameworkApplication_DefaultErrorHandler",null,[])},6865:function(e,t,n){"use strict";n.r(t),n.d(t,{AFrameworkApplication_WsaClient:function(){return i}});var a=n(100);class i{}i.theWsaClient=null,(0,a.a)(i,"AFrameworkApplication_WsaClient",null,[])},4754:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e,t){this.actionData=e,this.inputMethod=t}}(0,a.a)(i,"ActionDataWithInputMethod",null,[])},8650:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i extends Sys.EventArgs{constructor(e,t,n,a=0,i=0,o=null,r=null,s=null){super(),this.actionName=e,this.tabName=t,this.timeStamp=n,this.controlId=r,this.terminalParentControlId=s,this.commandSurface=a,this.inputMethod=i,this.contentType=o}}(0,a.a)(i,"ActionEventArgs",Sys.EventArgs,[])},1057:function(e,t,n){"use strict";n.r(t),n.d(t,{ActionManager:function(){return L}});var a=n(100),i=n(5149),o=n(6082);const r=(e,t,n=0)=>{n||(n=(e=>{let t=2*e+1;for(;;){let e=!1;const n=Math.sqrt(t);for(let a=t/2|0;a>=n;a--)if(!(t%a)){e=!0;break}if(!e)return t;t+=2}})(e.length));const a=e;e=new Array(n);for(let t=0;t<n;t++)e[t]=new Array(0);if(a)for(const n of a)for(const a of n)Array.add(e[s(e,t.getHashCode(a))],a);return e},s=(e,t)=>{const n=e.length;let a=t%n;return a<0&&(a+=n),a};class l{equals(e,t){return this._keyComparer.equals(e.key,t.key)}getHashCode(e){return this._keyComparer.getHashCode(e.key)}constructor(e){this._keyComparer=e}}(0,a.a)(l,"KeyValueComparer",null,[36]);var c=n(2125),d=n(1520);class u{getEnumerator(){const e=new d.a;for(const t of this._buckets)for(const n of t)e.add(n);return e.$$lge()}[Symbol.iterator](){return(0,o.a)(this.getEnumerator())}get count(){return this._count}get keys(){return this.getKeyEnumerator()}get values(){return this.getValueEnumerator()}getKeyEnumerator(){const e=new d.a;for(const t of this._buckets)for(const n of t)e.add(n.key);return e}getValueEnumerator(){const e=new d.a;for(const t of this._buckets)for(const n of t)e.add(n.value);return e}Akvp(e){this.insert(e,!0)}get_item(e){const{value:t,returnValue:n}=this.tryGetValue(e,null);if(!n)throw Error.create("KeyNotFoundException");return t}set_item(e,t){return this.insert(new c.a(e,t),!1),t}insert(e,t){const n=({buckets:this._buckets}=((e,t,n,a)=>{const i=n.getHashCode(t);let o=e[s(e,i)];return o.length>5&&a>3*e.length&&(o=(e=r(e,n))[s(e,i)]),{returnValue:o,buckets:e}})(this._buckets,e,this._pairComparer,this.count)).returnValue;for(let a=0;a<n.length;a++){const i=n[a];if(this._comparer.equals(i.key,e.key)){if(t)throw Error.invalidOperation("DuplicateKeyException");return void(n[a]=e)}}this._count=this.count+1,n.push(e)}add(e,t){this.Akvp(new c.a(e,t))}containsKey(e){const t=this._comparer.getHashCode(e);for(const n of this._buckets[s(this._buckets,t)])if(this._comparer.equals(n.key,e))return!0;return!1}remove(e){const t=this._buckets[s(this._buckets,this._comparer.getHashCode(e))];for(let n=0;n<t.length;n++){const a=t[n];if(this._comparer.equals(a.key,e))return Array.removeAt(t,n),this._count=this.count-1,!0}return!1}tryGetValue(e,t=null){const n=this._buckets[s(this._buckets,this._comparer.getHashCode(e))];for(const t of n)if(this._comparer.equals(t.key,e)){return{returnValue:!0,value:t.value}}return{returnValue:!1,value:t}}constructor(e){this._count=0,this.$$ge=this.getEnumerator,this._comparer=e,this._pairComparer=new l(e),this._buckets=r(this._buckets,this._pairComparer,7)}}(0,a.a)(u,"Dictionary",null,[32,13]);var p=n(3078);class g{equals(e,t){return e===t}getHashCode(e){return 0|e}getEqualityKey(e){return e}static get_default(){return g._default||(g._default=new g)}}g._default=null,(0,a.a)(g,"NumberComparer",null,[36,37]);class h{constructor(){this.flags=[],this.handlers=[],this.asyncHandlers=[],this.defaultActionDataGenerator=null,this.telemetryData=null}}(0,a.a)(h,"ActionMetadata",null,[]);var m=n(7481),_=n(1779),S=n(392),f=n(6362),C=n(1163);class y extends S.a{run(){const{AFrameworkApplication:e}=n(3245);let t=0,a=1;if(y.isActionTimingTelemetryEnabled){const e=this.childOperation;t=e?e.actionId:0,a=e?e.behavior:1}if(e.appSettingsManager?.isChangeGateEnabled("AddedTelemetryForAfterActionTime")){const e=this._actionManager.getTelemetryData(t);if(e&&e?.hasOwnProperty("interactive_uid")){const t=performance?.now()??Date.now();L.addInteractiveEventContextDelegate(e.interactive_uid,"BeforeActionTime",`${t}`)}}this.timeTelemetry.Browser=C.a.browserNameForlogging,this.timeTelemetry.ST=performance?.now()??Date.now();const o=1===a&&this.shouldSkipBeforeAfterActions;if(0===this._stage&&(o&&e.appSettingsManager?.isChangeGateEnabled("SkipBeforeActionsWithEnabledBehaviour")||this._actionManager.beforeAction(this.childOperation),this._stage=1),this.timeTelemetry.TBA=performance?.now()??Date.now(),1===this._stage){try{this.childOperation.run()}catch(e){throw this._actionManager.notifyOnActionError(this.childOperation,e),e}if(this.childOperation.hasYielded)return;this._stage=2}this.timeTelemetry.TAA=performance?.now()??Date.now(),2===this._stage&&(o&&e.appSettingsManager?.isChangeGateEnabled("SkipAfterActionsWithEnabledBehaviour")||this._actionManager.afterAction(this.childOperation),this.childOperation.recycle(),this.setIsCompleted(),this.recycle()),this.timeTelemetry.ET=performance?.now()??Date.now();let r="";if(1!==a&&({actionName:r}=this.shouldLogActionTimeTelemetry(t,r)).returnValue&&(this.timeTelemetry.ACT=r,this.timeTelemetry.ACB=a,i.ULS.sendTraceTag(508417182,329,this.timeTelemetry.ET-this.timeTelemetry.ST<y.timeThresholdForActionTimingLogging?50:20,f.a.toJSON(this.timeTelemetry)),r&&e.theActionManager.recordActionPerfDetailsTelemetry(t,"ActionName",r,!0)),this.timeTelemetry={},e.appSettingsManager?.isChangeGateEnabled("AddedTelemetryForAfterActionTime")){const e=this._actionManager.getTelemetryData(t);if(e&&e?.hasOwnProperty("interactive_uid")){const t=performance?.now()??Date.now();L.addInteractiveEventContextDelegate(e.interactive_uid,"AfterActionTime",`${t}`)}}}shouldLogActionTimeTelemetry(e,t){const{ActionManager:a}=n(1057);return y.isActionTimingTelemetryEnabled&&e>0&&(t=a.actionIdResolver(e))&&""!==t&&!t.startsWith("Query")&&(!y.actionNameLookupForTelemetry.count||y.actionNameLookupForTelemetry.contains(t.toLowerCase()))?{returnValue:!0,actionName:t}:{returnValue:!1,actionName:t}}recycle(){super.recycle(),Array.add(y._instances,this)}static registerInstance(e,t){let n;const a=y._instances.length;return a?(n=y._instances[a-1],Array.removeAt(y._instances,a-1)):n=new y,n.init(e),n.setDebugName("ActionNotificationOperation"),n._stage=0,n._actionManager=t,n}get shouldSkipBeforeAfterActions(){return null!=this.__cached_shouldSkipBeforeAfterActions_0_7b5877ca?this.__cached_shouldSkipBeforeAfterActions_0_7b5877ca:this.__cached_shouldSkipBeforeAfterActions_0_7b5877ca=(()=>{const{AFrameworkApplication:e}=n(3245);return e.appSettingsManager?.getBooleanAppSetting("SkipActionsWithEnabledBehavior")})()}constructor(){super(),this._stage=0,this._actionManager=null,this.timeTelemetry={};const{AFrameworkApplication:e}=n(3245);try{if(e.appSettingsManager&&(y.isActionTimingTelemetryEnabled=e.appSettingsManager.getBooleanAppSetting("EnableActionTimingLogging"),y.timeThresholdForActionTimingLogging=e.appSettingsManager.getIntAppSetting("TotalTimeThresholdForActionTimingLogging",20),y.isActionTimingTelemetryEnabled)){const e=n(3245).AFrameworkApplication.appSettingsManager.getStringAppSetting("ActionNameListforActionTimingLogging");if(e&&e.length>0){const t=e.split(",");for(const e of t)y.actionNameLookupForTelemetry.add(e.toLowerCase())}}}catch(e){i.ULS.sendTraceTag(508417183,329,15,"ActionNotificationOperation: Exception while parsing ActionIdListforActionTimingLogging:{0}",e.message)}}}y.actionNameLookupForTelemetry=new m.a(_.a.get_ordinalIgnoreCase()),y.isActionTimingTelemetryEnabled=!1,y.timeThresholdForActionTimingLogging=0,y._instances=[],(0,a.a)(y,"ActionNotificationOperationImpl",S.a,[]);var A=n(3958),b=n(4050);class T extends A.a{recycle(){super.recycle(),Array.add(T._instances,this)}run(){if(1===this._stage){if(1===this.processCurrentOperation())return;const e=this._actionManager.applicationContextCollection.length;for(let t=this._currentIndex;t<e;t++){const n=this._actionManager.applicationContextCollection[t];if(this._currentIndex=t+1,this.setCurrentOperationFromContext(n),1===this.processCurrentOperation())return;if(this.timeoutExceeded&&t!==e-1)return void this.yield()}this._stage=3}3===this._stage&&(this._response=(0,b.a)(this.response,2),this.setIsCompleted(),!this.isSynchronous&&this._actionResultCallback&&this._actionResultCallback(this,this._callbackUserData))}static registerInstance(e,t,n,a,i,o,r,s,l){let c;const d=T._instances.length;return d?(c=T._instances[d-1],Array.removeAt(T._instances,d-1)):c=new T,c.init(t),c.setDebugName("ProcessActionOperation"),c.initAction(e,n,a,i,o,l),c._actionResultCallback=r,c._callbackUserData=s,c._stage=1,c._currentIndex=0,c._actionManager=e,c}constructor(){super(),this._actionResultCallback=null,this._callbackUserData=null,this._stage=0,this._currentIndex=0}}T._instances=[],(0,a.a)(T,"ProcessActionOperation",A.a,[]);var v=n(6290),w=n(7354);class F{constructor(){this.dataValue1=0,this.dataValue2=0}}(0,a.a)(F,"ReportingData",null,[]);class I{static locationIsRibbon(e){return 2===e||14===e||15===e}}(0,a.a)(I,"UILocationUtil",null,[]);var E=n(2388),M=n(1509),k=n(1251),P=n(3774),D=n(2274),R=n(6776),x=n(988);class L{get disableActionLocksForDoNothingActions(){return null!=this.__cached_disableActionLocksForDoNothingActions_0_ad726f0e?this.__cached_disableActionLocksForDoNothingActions_0_ad726f0e:this.__cached_disableActionLocksForDoNothingActions_0_ad726f0e=D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableActionLocksForDoNothingActions",!1)}static get actionIdResolverDelegate(){return P.a.actionIdResolverDelegate}static set actionIdResolverDelegate(e){P.a.actionIdResolverDelegate=e}static get commandIdResolverDelegate(){return P.a.commandIdResolverDelegate}static set commandIdResolverDelegate(e){P.a.commandIdResolverDelegate=e}static get contextIdResolverDelegate(){return P.a.contextIdResolverDelegate}static set contextIdResolverDelegate(e){P.a.contextIdResolverDelegate=e}static get getCurrentInteractiveId(){return L.currentInteractiveId}static setCurrentInteractiveId(e){L.currentInteractiveId=e}get commandTabName(){return this._commandTabName}set commandTabName(e){this._commandTabName=e}get applicationContextCollection(){return this._applicationContextCollection}registerApplication(e){Array.add(this._applicationContextCollection,e)}logUnhandledKeyboardActions(){f.a.getKeys(this._actionsWithoutHandlers).length>0&&(i.ULS.sendTraceTag(508395983,306,15,"Unhandled actions: {0}",JSON.stringify(this._actionsWithoutHandlers)),this._actionsWithoutHandlers=null)}logUnhandledAction(e){let t=e.toString();if(t in this._actionsWithoutHandlers){const e=this._actionsWithoutHandlers[t];this._actionsWithoutHandlers[t]=e+1}else this._actionsWithoutHandlers[t]=1}logUnhandledFileMenuAction(e){i.ULS.sendTraceTag(507601877,306,15,"Unhandled File Menu action: {0}",e)}unregisterApplication(e){Array.remove(this._applicationContextCollection,e)}registerListener(e){Array.add(this._listeners,e)}unregisterListener(e){Array.remove(this._listeners,e)}addAction(e,t,n){this.registerAction(e,t,n,null)}removeAction(e,t,n){this.unregisterAction(e,t,n,null)}addActionWithFlags(e,t,n,a){this.registerAction(e,t,n,null),this.setActionFlags(e,a)}addAsyncAction(e,t,n){this.registerAction(e,t,null,n)}addAsyncActionWithFlags(e,t,n,a){this.registerAction(e,t,null,n),this.setActionFlags(e,a)}setActionFlags(e,t){if(0===t)return void 0;this._actionCollection[e]||(this._actionCollection[e]=new h);const n=this._actionCollection[e];for(let e=1;e<=t;e*=2)t&e&&(n.flags[e]=!0)}setActionDataGenerator(e,t){this._actionCollection[e].defaultActionDataGenerator=t}processAction(e,t,n=null){let a=null;return this._actionCollection[e]&&this._actionCollection[e].defaultActionDataGenerator&&(a=this._actionCollection[e].defaultActionDataGenerator()),this.processActionWithData(e,t,a,n)}processActionAsync(e,t,n,a,i,o=null){let r=null;return this._actionCollection[t]&&this._actionCollection[t].defaultActionDataGenerator&&(r=this._actionCollection[t].defaultActionDataGenerator()),this.processActionWithDataAsync(e,t,n,r,a,i,null)}getTelemetryData(e){return this._actionCollection[e]?this._actionCollection[e].telemetryData:null}currentSelectionContentType(){return this._actionContextProvider?this._actionContextProvider.contentType:null}handleUnhandledAction(e){if(!(e in this._unhandledActionData))return;const t=this.processActionWithDataInternal(this._unhandledActionData[e].parentOperation,this._unhandledActionData[e].actionId,this._unhandledActionData[e].actionBehavior,this._unhandledActionData[e].actionData,this._unhandledActionData[e].telemetryData,this._unhandledActionData[e].actionResultCallback,this._unhandledActionData[e].callbackUserData,this._unhandledActionData[e].executeSynchronous);this._unhandledActionData[e]=null,i.ULS.sendTraceTag(507547744,306,15,"Action: {0}, Result of Unhandled action: {1}",e,t)}get shouldAssociateInterPerfDataWithActionContextData(){return null!=this.__cached_shouldAssociateInterPerfDataWithActionContextData_1_ad726f0e?this.__cached_shouldAssociateInterPerfDataWithActionContextData_1_ad726f0e:this.__cached_shouldAssociateInterPerfDataWithActionContextData_1_ad726f0e=D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("AssociateInterPerfDataWithActionContextData")}processActionWithDataInternal(e,t,n,a,i,o,r,s){if(t===L.nullAction)return 2;if(!this._actionCollection[t])return this._actionsWithoutHandlers&&2===n&&6===this.commandLocation&&this.logUnhandledAction(t),D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.isChangeGateEnabled("FileMenuActionLogging")&&2===n&&22===this.commandLocation&&this.logUnhandledFileMenuAction(t),D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("FileMenuTemplateErrorFixIsEnabled")&&t===x.a.populateNewMenu&&2===n&&(this._unhandledActionData[t]={parentOperation:e,actionId:t,actionBehavior:n,actionData:a,telemetryData:i,actionResultCallback:o,callbackUserData:r,executeSynchronous:s}),this.extendedPRIIsApplicable(t,a)?(this.addLoggingInCaseOfSlideShow(t,n),this.addLoggingInCaseOfPreview(t,n),this.handleExtendedPRIAction(t,n,a)):2;if(this.extendedPRIIsApplicable(t,a))return this.handleExtendedPRIAction(t,n,a);const l=this.getActionMetadata(t);if(l.flags[16]&&this.throttlingManager&&!this.throttlingManager.shouldRunThrottledAction)return 2;const c=y.registerInstance(e,this);if(c.isSynchronous=s,this._actionContextProvider&&2===n&&!l.flags[64]&&(i||(i={}),i.ContentType=this._actionContextProvider.contentType),l.flags[4096]&&(i||(i={}),i.correlationId=M.a.create().toString()),l.flags[8192]&&(i||(i={}),i.sessionOrigin=E.a.getNormalizedSessionOrigin()),i&&i.TriggerTime){const e=i.TriggerTime;e<L.pastClickTime?i.epochClickTime=(new Date).getTime()-e:i.epochClickTime=e,i.epochClickTime=Math.floor(i.epochClickTime)}if(this._actionCollection[t].telemetryData=i,i&&this.shouldAssociateInterPerfDataWithActionContextData){const e=i.interactive_uid;e&&L.associateInteractiveActionToCurrentActionDelegate(e,void 0)}const d=T.registerInstance(this,c,t,n,new F,a,o,r,i);i&&this.contextCapturer&&this.contextCapturer.captureTelemetryData(i),c.run();const u=+c.endTime-+c.startTime;return l.flags[16]&&this.throttlingManager&&this.throttlingManager.recordThrottledActionTime(u),d.response}addLoggingInCaseOfSlideShow(e,t){!D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.isChangeGateEnabled("SlideShowLaunchTimingLogging")||1989200744!==e&&3477644587!==e&&149770451!==e&&2832668252!==e&&4039328901!==e||2!==t||(i.ULS.sendTraceTag(507297816,306,15,"SlideShow Launch tried at {0} for action {1}",window.performance.now(),e),window.setTimeout((()=>{appChrome.PRIToastManager.dismissToast()}),5e3))}addLoggingInCaseOfPreview(e,t){!D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("RegisterPreviewLaunchHandlersAfterInit")||3849020888!==e&&3365334625!==e||2!==t||(i.ULS.sendTraceTag(506590281,306,15,"Preview Launch tried at {0} for action {1}",window.performance.now(),e),window.setTimeout((()=>{appChrome.PRIToastManager.dismissToast()}),5e3))}setInteractiveIdForLogging(e){D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("LogPageViewUpdated")&&e?.interactive_uid&&L.setCurrentInteractiveId(e.interactive_uid.toString())}processActionWithData(e,t,n,a=null){return this.setInteractiveIdForLogging(a),this.processActionWithDataInternal(null,e,t,n,a,null,null,!0)}processActionWithDataAsync(e,t,n,a,i,o,r=null){return this.setInteractiveIdForLogging(r),this.processActionWithDataInternal(e,t,n,a,r,i,o,!1)}processContextSet(e,t,n,a,i,o,r=null){const s=y.registerInstance(null,this);s.isSynchronous=!0;const l=w.a.registerInstance(this,s,e,t,n,a,i,o,r);return s.run(),l.response}processContextSetAsync(e,t,n,a,i,o,r,s=null){const l=y.registerInstance(e,this),c=w.a.registerInstance(this,l,t,n,a,i,o,r,s);return l.run(),c.response}processActionAgainstContext(e,t,n,a,i,o,r=null){if(!e)return 8;if(e.isContextSet)return this.processContextSet(e,t,n,a,i,o,r);const s=y.registerInstance(null,this);s.isSynchronous=!0;const l=v.a.registerInstance(this,s,e,t,n,a,i,o,r);return s.run(),l.response}processActionAgainstContextAsync(e,t,n,a,i,o,r,s){if(!t)return 8;if(t.isContextSet)return this.processContextSetAsync(e,t,n,a,i,o,r,s);const l=y.registerInstance(e,this),c=v.a.registerInstance(this,l,t,n,a,i,o,r,s);return l.run(),c.response}removeActionIfFeatureIsDisabled(e,t,n,a,i,o=null){this._applicationFeatureHelperFuture&&this._applicationFeatureHelperFuture.execute((r=>{r.isFeatureEnabled(e,t).then((e=>(e||(this.removeAction(n,a,i),o&&o(n)),null)))}))}beforeAction(e){const t=e.actionId;1!==e.behavior&&D.AFrameworkApplication_AppSettingsManager.appSettingsManager&&D.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("LoggingActionsEnabled")&&L.logActionForAutomation(t),this._actionDepth[t]?this._actionDepth[t]++:(this.notifyOnBeforeAction(e),this._actionDepth[t]=1)}afterAction(e){const t=e.actionId;if(this._actionDepth[t]--,!this._actionDepth[t]){if(this.invocationMethod=0,this.commandLocation=0,this.commandTabName=null,e.response>1){this.notifyOnAfterAction(e);const n=L.actionIdResolver(t);if(2===e.behavior&&this.associateActionNameToInteractiveId(t),D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.isChangeGateEnabled("AddBrowserPasteContextToTracker")&&"PowerPointBrowserPaste"==n){const e=this.getTelemetryData(t);e&&e.interactive_uid&&L.addInteractiveEventContextDelegate(e.interactive_uid,"pastedContentInfo",this._actionContextProvider?.contentType?this._actionContextProvider?.contentType:"")}}delete this._actionDepth[t]}}registerAction(e,t,n,a){this._actionCollection[e]||(this._actionCollection[e]=new h);const i=this._actionCollection[e];n?(i.handlers[t]=n,this.disableActionLocksForDoNothingActions&&n!==L.doNothing&&n!==L.doNothingButReport&&this.actionIdsWithNonDoNothingHandlers.add(e)):i.asyncHandlers[t]=a,this._currentlyBlockedActionId===e&&e!==L.nullAction&&(appChrome.PRIToastManager.dismissToast(),this._currentlyBlockedActionId=L.nullAction),this._onActionRegistered.containsKey(e)&&this._onActionRegistered.get_item(e)()}unregisterAction(e,t,n,a){if(!this._actionCollection[e])return;const i=this._actionCollection[e];i.handlers[t]===n?i.handlers[t]=null:i.asyncHandlers[t]===a&&(i.asyncHandlers[t]=null),D.AFrameworkApplication_AppSettingsManager.appSettingsManager&&D.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("CleanActionFlagsIsEnabled")&&(i.flags=[])}get isListenersTimeLoggingEnabled(){return null!=this.__cached_isListenersTimeLoggingEnabled_2_ad726f0e?this.__cached_isListenersTimeLoggingEnabled_2_ad726f0e:this.__cached_isListenersTimeLoggingEnabled_2_ad726f0e=D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("EnableListenersTimeLogging")}recordActionPerfDetailsTelemetry(e,t,n,a=!1){if(this.isListenersTimeLoggingEnabled){const o=this.getTelemetryData(e);o&&(o[t]=n,a&&i.ULS.sendTraceTag(508385416,329,50,f.a.toJSON(o)))}}notifyOnBeforeAction(e){const t={ListenersCount:this._listeners.length},n=Date.now();this.notifyListeners(e,t,n,!0),this.recordActionPerfDetailsTelemetry(e.actionId,"BeforeActionListeners",t)}notifyOnAfterAction(e){const t={ListenersCount:this._listeners.length},n=Date.now();this.notifyListeners(e,t,n,!1),this.recordActionPerfDetailsTelemetry(e.actionId,"AfterActionListeners",t)}notifyListeners(e,t,n,a){const i=this.isListenersTimeLoggingEnabled;for(let o=0;o<this._listeners.length;o++){const r=this._listeners[o],s={};if(s.ST=Date.now(),a?r.onBeforeAction(e):r.onAfterAction(e),s.ET=Date.now(),i)if(r.getName){const e=r.getName();t[e]=s,"PPTBox4App"==e&&(t.PPTBox4AppSequence=o,t.PPTBox4AppEndTime=s.ET-n)}else t["NA_"+o.toString()]=s}}notifyOnActionError(e,t){if(D.AFrameworkApplication_AppSettingsManager.appSettingsManager&&3===R.AFrameworkApplicationConstants.activeFrame.applicationInstance.officeAppType&&D.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("WordActionManagerKpiLoggingEnabled"))for(let n=0;n<this._listeners.length;n++)(0,p.a)(43,this._listeners[n])&&this._listeners[n].onActionError(e,t)}getActionMetadata(e){return this._actionCollection[e]}isActionRegisteredWithDoNothingHandlersOnly(e){return!this.actionIdsWithNonDoNothingHandlers.has(e)}setOnActionRegistered(e,t){this._onActionRegistered.set_item(e,t)}get isExtendedPRIEnabled(){return null!=this.__cached_isExtendedPRIEnabled_3_ad726f0e?this.__cached_isExtendedPRIEnabled_3_ad726f0e:this.__cached_isExtendedPRIEnabled_3_ad726f0e=D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)}get isStatusBarPRIEnabled(){return null!=this.__cached_isStatusBarPRIEnabled_4_ad726f0e?this.__cached_isStatusBarPRIEnabled_4_ad726f0e:this.__cached_isStatusBarPRIEnabled_4_ad726f0e=D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("StatusBarPRIEnabled")}extendedPRIIsApplicable(e,t){if(!this.isExtendedPRIEnabled)return!1;const n=t,a=this.getLauncherCommandId(n,e),i=!this._actionCollection[a]||!this._actionCollection[a].handlers.length&&!this._actionCollection[a].asyncHandlers.length,o=!!n&&!!n.MappedCommand,r=!!n&&!!n.PRIReadinessCheck||i&&I.locationIsRibbon(this.commandLocation)&&!o&&3===this.mode,s=this.isStatusBarPRIEnabled&&i&&7===this.commandLocation&&!o;return r||s}handleExtendedPRIAction(e,t,n){const a=n,i=this.getLauncherCommandId(a,e);if(a&&a.PRIReadinessCheck)return a.PRIReadinessCheck=null,this.extendedPRIIsApplicable(e,a)?this._currentlyBlockedActionId=i:appChrome.PRIToastManager.dismissToast(),32;if(1===t)return 32;if(2===t&&n&&a.InputMethod){const e={payload:{}};return k.a.perceivedInteractiveCommandHandler.handleCommand(L.actionIdResolver(i),e),this._currentlyBlockedActionId=i,2}return 2}getLauncherCommandId(e,t){return e&&e.launcherCommandId?e.launcherCommandId:t}static logActionForAutomation(e){const t="ActionLog";let n=document.getElementById(t);n||(n=document.createElement("div"),n.id=t,n.style.display="none",document.body.appendChild(n));const a=document.createElement("div");a.innerText=e.toString(),n.appendChild(a)}isCurrentAction(e){return null!=this._actionDepth[e]&&this._actionDepth[e]>=0}static actionIdResolver(e){return L.actionIdResolverDelegate(e)}static commandIdResolver(e){return L.commandIdResolverDelegate(e)}static contextIdResolver(e){return L.contextIdResolverDelegate(e)}static nullInteractivityRecorder(e,t,n,a){}static nullAddContextToEventRecorder(e,t,n){}static nullAssociateInteractiveActionToCurrentActionDelegate(e,t){}static doNothing(e,t,n,a,i){return 32}static doNothingButReport(e,t,n,a,i){if((0,p.a)(F,i)){const e=i;a.dataValue1=e.dataValue1,a.dataValue2=e.dataValue2}return 32}associateActionNameToInteractiveId(e){if(D.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("AssociateActionNameToInteractiveId")){const t=this.getTelemetryData(e),n=L.actionIdResolver(e);t&&t.interactive_uid&&L.addInteractiveEventContextDelegate(t.interactive_uid,"ACNID",n)}}constructor(e=null,t=null){this._commandTabName=null,this._actionDepth=[],this._applicationContextCollection=[],this._listeners=[],this._actionContextProvider=null,this._currentlyBlockedActionId=L.nullAction,this._onActionRegistered=new u(g.get_default()),this.contextCapturer=null,this.commandLocation=0,this.invocationMethod=0,this.throttlingManager=null,this._unhandledActionData={},this.actionIdsWithNonDoNothingHandlers=new Set,this._actionCollection=Object.create(null),this.mode=3,this.isOffline=!1,this._actionsWithoutHandlers={},this._applicationFeatureHelperFuture=e,t&&t.execute((e=>{e.actionManagerLoggingEnabled&&(this._actionContextProvider=e)}))}}L.doNothingHandler=L.doNothing,L.doNothingButReportHandler=L.doNothingButReport,L.nullAction=null,L.pastClickTime=new Date("01-01-2023").getTime(),L.emptyActionId=371857150,L.trackInteractiveEventsDelegate=L.nullInteractivityRecorder,L.addInteractiveEventContextDelegate=L.nullAddContextToEventRecorder,L.isInteractivePerfRecordingEnabled=()=>!1,L.associateInteractiveActionToCurrentActionDelegate=L.nullAssociateInteractiveActionToCurrentActionDelegate,L.currentInteractiveId=null,(0,a.a)(L,"ActionManager",null,[44,45])},3774:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static nullIdResolver(e){return null}static nullCommandIdResolver(e){return null}static actionIdResolver(e){return i.actionIdResolverDelegate(e)}static commandIdResolver(e){return i.commandIdResolverDelegate(e)}}i.actionIdResolverDelegate=i.nullIdResolver,i.commandIdResolverDelegate=i.nullCommandIdResolver,i.contextIdResolverDelegate=i.nullIdResolver,(0,a.a)(i,"ActionManagerResolver",null,[])},3958:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(392),o=n(4050),r=n(6776),s=n(2274),l=n(9800);class c extends i.a{get yieldTimestamps(){return this._yieldTimestamps}static get isYieldTimestampsEnabled(){return null!=c.__cached_isYieldTimestampsEnabled_0_84fa8372?c.__cached_isYieldTimestampsEnabled_0_84fa8372:c.__cached_isYieldTimestampsEnabled_0_84fa8372=s.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.YieldTimestampsEnabled",!1)}static get isActionManagerModeFixEnabled(){return null!=c.__cached_isActionManagerModeFixEnabled_1_84fa8372?c.__cached_isActionManagerModeFixEnabled_1_84fa8372:c.__cached_isActionManagerModeFixEnabled_1_84fa8372=(l.a.logUniqueUsage("chb2h767;g7gi8147"),s.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerModeFix",!1))}initAction(e,t,n,a,i,o=null){this._actionId=t,this._actionData=i,c.isActionManagerModeFixEnabled&&(o||(o={}),o.ActionManagerMode=e.mode),this._telemetryData=o,this._behavior=n,this._response=1,this._actionManager=e,this._reportingData=a,this._invocationMethod=e.invocationMethod,this._commandLocation=e.commandLocation,this._commandTabName=e.commandTabName,this._beginMode=r.AFrameworkApplicationConstants.activeFrame?r.AFrameworkApplicationConstants.activeFrame.mode:0,this._yieldTimestamps=[]}get actionId(){return this._actionId}get behavior(){return this._behavior}get beginMode(){return this._beginMode}get reportingData(){return this._reportingData}get actionData(){return this._actionData}get telemetryData(){return this._telemetryData}get response(){return this._response}get invocationMethod(){return this._invocationMethod}get commandLocation(){return this._commandLocation}get commandTabName(){return this._commandTabName}setCurrentOperationFromContext(e){const{ProcessContextSetOperation:t}=n(3212),{ProcessContextOperation:a}=n(5668);e.isContextSet?t.registerInstance(this._actionManager,this,e,this.actionId,this.behavior,!0,this.reportingData,this._actionData,this._telemetryData):a.registerInstance(this._actionManager,this,e,this.actionId,this.behavior,!0,this.reportingData,this._actionData,this._telemetryData)}processCurrentOperation(){const e=this.childOperation;if(e){if(e.inProgress){if(e.run(),e.hasYielded)return 1;0}0;const t=e.response;return this._response=(0,o.a)(this.response,t),e.recycle(),this.clearChildOperation(),t}return 0}updateStartTime(){if(c.isYieldTimestampsEnabled){this._yieldTimestamps[this._yieldTimestamps.length-1].yieldEnd=performance.now()}super.updateStartTime()}yield(){c.isYieldTimestampsEnabled&&this._yieldTimestamps.push(new d),super.yield()}constructor(){super(),this._actionData=null,this._telemetryData=null,this._actionManager=null,this._actionId=0,this._behavior=0,this._beginMode=0,this._reportingData=null,this._response=0,this._invocationMethod=0,this._commandLocation=0,this._commandTabName=null,this._yieldTimestamps=[]}}(0,a.a)(c,"ActionOperation",i.a,[46,47]);class d{get duration(){return this.yieldEnd-this.yieldStart}constructor(){this.yieldStart=performance.now()}}(0,a.a)(d,"YieldTimestamp",null,[])},5401:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.CommandLocation=0,this.CommandTabName=null,this.InvocationMethod=0}}(0,a.a)(i,"CommandSqmInfo",null,[])},5668:function(e,t,n){"use strict";n.r(t),n.d(t,{ProcessContextOperation:function(){return a.a}});var a=n(6290)},6290:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(3958);class o extends i.a{recycle(){super.recycle(),Array.add(o._instances,this)}run(){if(0===this._stage){const e=this.processCurrentOperation();if(1===e)return;if(0===e){0;const e=this._actionManager.getActionMetadata(this.actionId),t=this._context.contextId;let a=null,i=null;if(e&&(a=e.asyncHandlers[t],i=e.handlers[t]),i||a){0;const t=e.flags[1024],o=e.flags[4],r=e.flags[2048],s=n(3245).AFrameworkApplication.documentAssemblyEnabledV2&&e.flags[16384];let l=!1;if(this._actionManager.isOffline)l=r;else switch(this._actionManager.mode){case 2:l=!t&&!o||t;break;case 3:l=!t&&!o||o;break;case 1:if(n(3245).AFrameworkApplication.isInteractiveReadOnlyMode){l=e.flags[65536];break}l=!t&&!o||s;break;default:l=!t&&!o}if(l){if(e.flags[1]&&(void 0===this._actionData||null===this._actionData))return this._response=16,void this.setIsCanceled();if(e.flags[8]&&!this.reportingData)return this._response=16,void this.setIsCanceled();if(a){if(a(this,this.actionId,this._context,this.behavior,this.reportingData,this._actionData),1===this.processCurrentOperation())return}else this._response=i(this.actionId,this._context,this.behavior,this.reportingData,this._actionData)}else this._response=4}}this._stage=this.response>2?2:1}if(1===this._stage&&this._shouldSpecialize){if(!this.childOperation){const e=this._context.nextContext;e?this.setCurrentOperationFromContext(e):this._response=2}if(1===this.processCurrentOperation())return}this._stage=2,2===this._stage&&this.setIsCompleted()}static registerInstance(e,t,n,a,i,r,s,l,c){let d;const u=o._instances.length;return u?(d=o._instances[u-1],Array.removeAt(o._instances,u-1)):d=new o,d.init(t),d.setDebugName("ProcessContextOperationImpl"),d.initAction(e,a,i,s,l,c),d._context=n,d._shouldSpecialize=r,d._stage=0,d}constructor(){super(),this._context=null,this._shouldSpecialize=!1,this._stage=0}}o._instances=[],(0,a.a)(o,"ProcessContextOperationImpl",i.a,[])},3212:function(e,t,n){"use strict";n.r(t),n.d(t,{ProcessContextSetOperation:function(){return a.a}});var a=n(7354)},7354:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(3958),o=n(4050);class r extends i.a{recycle(){super.recycle(),Array.add(r._instances,this)}run(){if(1===this.processCurrentOperation())return;const e=this._contextSet.length;for(let t=this._nextContextIndex;t<e&&(this.response<=2||!this._stopOnFirstResponse);t++){0,this._nextContextIndex=t+1;const n=this._contextSet.getContext(t);0,this.setCurrentOperationFromContext(n);if(1===this.processCurrentOperation())return;if(this.timeoutExceeded&&t!==e-1)return void this.yield()}this._response=(0,o.a)(this.response,2),this.setIsCompleted()}static registerInstance(e,t,n,a,i,o,s,l,c){let d;const u=r._instances.length;return u?(d=r._instances[u-1],Array.removeAt(r._instances,u-1)):d=new r,d.init(t),d.setDebugName("Context Set Operation"),d.initAction(e,a,i,s,l,c),d._contextSet=n,d._nextContextIndex=0,d._response=1,d._stopOnFirstResponse=1===i,d}constructor(){super(),this._contextSet=null,this._nextContextIndex=0,this._stopOnFirstResponse=!1}}r._instances=[],(0,a.a)(r,"ProcessContextSetOperationImpl",i.a,[])},92:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var a,i=n(100);!function(e){e[e.unknown=0]="unknown",e[e.upperRibbon=1]="upperRibbon",e[e.ribbon=2]="ribbon",e[e.QAT=3]="QAT",e[e.jewel=4]="jewel",e[e.navigationPane=5]="navigationPane",e[e.keyboardShortcut=6]="keyboardShortcut",e[e.statusBar=7]="statusBar",e[e.dialog=8]="dialog",e[e.floatie=9]="floatie",e[e.notificationBar=10]="notificationBar",e[e.standaloneCuiRoot=11]="standaloneCuiRoot",e[e.taskPane=12]="taskPane",e[e.heroDock=13]="heroDock",e[e.singleLineRibbon=14]="singleLineRibbon",e[e.multilineRibbon=15]="multilineRibbon",e[e.overflow=16]="overflow",e[e.tellMe=17]="tellMe",e[e.farPeripheralControls=18]="farPeripheralControls",e[e.contextMenu=19]="contextMenu",e[e.dialogMenu=20]="dialogMenu",e[e.header=21]="header",e[e.fileMenu=22]="fileMenu",e[e.editorPane=23]="editorPane",e[e.indicator=24]="indicator",e[e.indicatorNudge=25]="indicatorNudge",e[e.toolbar=26]="toolbar",e[e.viewerToolbar=27]="viewerToolbar",e[e.canvasMention=29]="canvasMention",e[e.canvas=30]="canvas",e[e.singleLineToolBar=31]="singleLineToolBar",e[e.canvasHeader=32]="canvasHeader"}(a||(a={})),(0,i.b)("UILocation",a)},4050:function(e,t,n){"use strict";function a(e,t){return t>e?t:e}n.d(t,{a:function(){return a}})},8979:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100);class i{get activityName(){return this._activityName}set activityName(e){this._activityName=e}get startTime(){return this._startTime}set startTime(e){this._startTime=e}get endTime(){return this._endTime}set endTime(e){this._endTime=e}get properties(){return this._properties}set properties(e){this._properties=e}get maxAllowedDuration(){return this._maxAllowedDuration}end(){}cancel(){}constructor(){this._activityName=0,this._startTime=0,this._endTime=0,this._properties=null,this._maxAllowedDuration=0,this.ended=!1}}(0,a.a)(i,"ActivityStub",null,[58]);var o=n(6996);class r extends i{constructor(){super(),this.properties=new o.a}}(0,a.a)(r,"FakeActivity",i,[]);class s{get isProxy(){return s._instance!==this}get enabled(){return!!this.isProxy&&s._instance.enabled}set enabled(e){this.isProxy&&(s._instance.enabled=e)}startActivity(e,t=-1){return this.isProxy?s._instance.startActivity(e,t):new r}recordEvent(e,t=null){this.isProxy&&s._instance.recordEvent(e,t)}recordError(e,t=null){this.isProxy&&s._instance.recordError(e,t)}add_activityRecorded(e){this.isProxy&&s._instance.add_activityRecorded(e)}remove_activityRecorded(e){this.isProxy&&s._instance.remove_activityRecorded(e)}static get instance(){return s._instance||(s._instance=s.getAnInstanceWithResolvedDependencies())}static set instance(e){s._instance=e}static getAnInstanceWithResolvedDependencies(){return new s}}s._instance=null,(0,a.a)(s,"ActivityManager",null,[56])},3998:function(e,t,n){"use strict";n.d(t,{a:function(){return u},b:function(){return l}});var a=n(935),i=n(6094),o=n(9611),r=n(988);const s="WacAirSpaceStats",l=e=>{e.addAction(r.a.toggleAnimations,o.a.frame,c),e.addAction(r.a.getAnimationStats,o.a.frame,d)},c=(e,t,n,i,o)=>(a.a.toggleAnimation(),32),d=(e,t,n,a,i)=>(u(),32),u=()=>{const e=a.a.getAnimationStats();let t=document.getElementById(s);t||(t=document.createElement("div"),t.style.display="none",t.id=s,document.body.appendChild(t)),i.a.clearElement(t);const n=document.createElement("div");n.id="WacAirSpaceNumElements",n.innerText=e.length.toString(),t.appendChild(n);for(let n=0;n<e.length;n++){const a=document.createElement("div");a.id="WacAirSpaceStat"+n;const i=e[n],o=document.createElement("div");o.id="WacAirSpaceElementsAnimated"+n,o.innerText=i.elementIds,a.appendChild(o);const r=document.createElement("div");r.id="WacAirSpaceAnimationFps"+n,r.innerText=i.fps.toString(),a.appendChild(r);const s=document.createElement("div");s.id="WacAirSpaceMin"+n,s.innerText=i.min.toString(),a.appendChild(s);const l=document.createElement("div");l.id="WacAirSpaceMax"+n,l.innerText=i.max.toString(),a.appendChild(l);const c=document.createElement("div");c.id="WacAirSpaceStdDev"+n,c.innerText=i.stdDev.toString(),a.appendChild(c);const d=document.createElement("div");d.id="WacAirSpaceStartTime"+n,d.innerText=i.startTime.toString(),a.appendChild(d);const u=document.createElement("div");u.id="WacAirSpaceEndTime"+n,u.innerText=i.endTime.toString(),a.appendChild(u),t.appendChild(a)}}},8208:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var a,i=n(100);!function(e){e[e.notSpecified=0]="notSpecified",e[e.appCtorStarting=1]="appCtorStarting",e[e.appCtorInitialized=2]="appCtorInitialized",e[e.contentDisplayed=3]="contentDisplayed",e[e.interactivityReady=4]="interactivityReady",e[e.ribbonInitialized=5]="ribbonInitialized",e[e.ribbonBehaviorAttached=6]="ribbonBehaviorAttached",e[e.chromeReady=7]="chromeReady",e[e.appLoadedSuccessfully=8]="appLoadedSuccessfully",e[e.appLoadedFailure=9]="appLoadedFailure",e[e.ribbonDisplayed=10]="ribbonDisplayed",e[e.ribbonAutomationReady=11]="ribbonAutomationReady",e[e.commentRendered=12]="commentRendered",e[e.appEncounteredFirstError=13]="appEncounteredFirstError",e[e.documentReady=14]="documentReady",e[e.suiteHeaderRendered=15]="suiteHeaderRendered",e[e.suiteHeaderInteractive=16]="suiteHeaderInteractive",e[e.documentTitleRendered=17]="documentTitleRendered",e[e.ribbonSkeletonDismissed=18]="ribbonSkeletonDismissed",e[e.appFullyLoaded=19]="appFullyLoaded",e[e.visualReadyReported=20]="visualReadyReported",e[e.metadataInitiallyParsed=21]="metadataInitiallyParsed",e[e.uiActorsReady=22]="uiActorsReady",e[e.wopiInfoReady=23]="wopiInfoReady"}(a||(a={})),(0,i.b)("AppInitializationStatus",a)},385:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var a=n(100),i=n(5367),o=n(5149),r=n(8208),s=n(353);class l{constructor(){this.duration=0,this.taskCompletionSourceObject=new s.a}}(0,a.a)(l,"TaskCompletionObjectWithDuration",null,[]);var c=n(9454),d=n(4783),u=n(7296),p=n(657);class g extends d.a{queueTask(e){this._taskManager.addTask(new u.a(2,1,0,(t=>{this.tryExecuteTask(e)}),78))}static get instance(){return g._singletonInstance||(g._singletonInstance=new g(p.TaskManager.instance))}constructor(e){super(),this._taskManager=e}}g._singletonInstance=null,(0,a.a)(g,"TaskManagerExecutionScheduler",d.a,[]);var h=n(7958),m=n(5737);class _ extends m.a{constructor(){super()}}(0,a.a)(_,"EnumDictionary",m.a,[]);class S{getInitStatusName(e){return e.toString()}setAppInitializationStatus(e){o.ULS.sendTraceTag(20025679,306,50,"SetAppInitializationStatus: {0}",r.a[e]),c.a.instance.addMetric("AppInitStatus_"+r.a[e],(new Date).getTime());try{window.performance&&window.performance.mark&&(window.performance.mark(this.getInitStatusName(e)),1===e&&(this._appCtorStarted=!0),this._appCtorStarted&&1!==e&&window.performance.measure(this.getInitStatusName(e),this.getInitStatusName(1),this.getInitStatusName(e)))}catch(e){}this._appStateTasks.get_item(e).taskCompletionSourceObject.setResult(!0)}clearAppInitializationStatus(e){this._appStateTasks.set_item(e,new l)}isCompleted(e){return this._appStateTasks.get_item(e).taskCompletionSourceObject.task.isCompleted}durationTakenToExecuteTasksAtState(e){return this._appStateTasks.get_item(e).duration}executeWhen(e,t,n=3){return this._appStateTasks.get_item(e).taskCompletionSourceObject.task.CWCT((n=>{const a=h.a.getTickCount();t&&t();const i=h.a.getTickCount()-a;let o;(o=this._appStateTasks.get_item(e)).duration=o.duration+i}),i.a.none,n,this._taskScheduler)}static get_instance(){return S._singletonInstance||(S._singletonInstance=new S(g.instance))}constructor(e){this._appCtorStarted=!1,this._taskScheduler=e,this._appStateTasks=new _,this._appStateTasks.add(1,new l),this._appStateTasks.add(2,new l),this._appStateTasks.add(3,new l),this._appStateTasks.add(4,new l),this._appStateTasks.add(5,new l),this._appStateTasks.add(6,new l),this._appStateTasks.add(7,new l),this._appStateTasks.add(8,new l),this._appStateTasks.add(9,new l),this._appStateTasks.add(10,new l),this._appStateTasks.add(11,new l),this._appStateTasks.add(12,new l),this._appStateTasks.add(13,new l),this._appStateTasks.add(14,new l),this._appStateTasks.add(15,new l),this._appStateTasks.add(16,new l),this._appStateTasks.add(17,new l),this._appStateTasks.add(18,new l),this._appStateTasks.add(19,new l),this._appStateTasks.add(20,new l),this._appStateTasks.add(21,new l),this._appStateTasks.add(22,new l),this._appStateTasks.add(23,new l)}}S._singletonInstance=null,(0,a.a)(S,"AppLifecycleManager",null,[27])},9401:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5149),o=n(965);class r{get fallbackAppSettingsGetter(){return this._fallbackAppSettingsGetter}get appSettings(){return this._appSettings}getBooleanAppSetting(e){return!this.containsAppSettingNoFallback(e)&&(Boolean.parse(this.appSettings.ReportMissingAppSetting||"false")&&!this.reportedMissingAppSettings.has(e)&&(i.ULS.sendTraceTag(590189376,331,50,"AppSettingsGetter.GetBooleanAppSetting: Missing value for app setting: [{0}]",e),this.reportedMissingAppSettings.add(e)),this.fallbackAppSettingsGetter)?this.fallbackAppSettingsGetter.getBooleanAppSetting(e):Boolean.parse(this.appSettings[e]||"false")}getStringAppSetting(e){return this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e)?this.fallbackAppSettingsGetter.getStringAppSetting(e):this.appSettings[e]}getIntAppSetting(e,t){if(this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e))return this.fallbackAppSettingsGetter.getIntAppSetting(e,t);let n=parseInt(this.appSettings[e]);return isNaN(n)&&(n=t),n}getLongAppSetting(e,t){if(this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e))return this.fallbackAppSettingsGetter.getLongAppSetting(e,t);const n=this.appSettings[e];if(n){const e=Number.parseInvariant(n);if(!isNaN(e))return e}return t}getDoubleAppSetting(e,t){if(this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e))return this.fallbackAppSettingsGetter.getDoubleAppSetting(e,t);let n=parseFloat(this.appSettings[e]);return isNaN(n)&&(n=t),n}getListAppSetting(e){return this.fallbackAppSettingsGetter&&!this.containsAppSettingNoFallback(e)?this.fallbackAppSettingsGetter.getListAppSetting(e):o.b(this.appSettings[e])}containsAppSetting(e){return e in this.appSettings||!!this.fallbackAppSettingsGetter&&this.fallbackAppSettingsGetter.containsAppSetting(e)}containsAppSettingNoFallback(e){return e in this.appSettings}constructor(e,t){this.reportedMissingAppSettings=new Set,this._appSettings=e,this._fallbackAppSettingsGetter=t}}(0,a.a)(r,"AppSettingsGetter",null,[60])},871:function(e,t,n){"use strict";n.d(t,{a:function(){return f}});var a=n(100),i=n(5149),o=n(625),r=n(9401),s=n(5018),l=n(7296),c=n(965),d=n(9969),u=n(1163),p=n(9858),g=n(657),h=n(6776),m=n(2274);const _="FARE",S="FAFA";class f{get _clientAppSettings(){return this.appSettings}get appSettings(){return this._settingsGetter.appSettings}get logData(){return this._logData}get flightingTreatmentVariables(){return this._flightingTreatmentVariables}get disabledChangeGates(){return this._disabledChangeGates}get isFullAppSettingsReady(){return 1===this.state}get state(){return this._state}updateFullAppSettings(e){if(!h.AFrameworkApplicationConstants.isShuttingDown){0;for(const t in e){const n={key:t,value:e[t]};!this.allowFullAppSettingsOverrides&&this._settingsGetter.containsAppSetting(n.key)&&(this.isFullAppSettingsReady||(this._settingsGetter.appSettings[n.key],n.value)),this._settingsGetter.appSettings[n.key]=n.value}this.updateFlightingTreatmentVariables(e),this._settingsGetter.appSettings.MiniCheckAppSettings=!1,this._state=1,this.raiseFullAppSettingsReadyEvent()}}updateFlightingTreatmentVariables(e){const t=e.FlightingTreatmentVariables||"";let n;if(({deserialized:n}=c.d(t)).returnValue)for(const e in n){const t={key:e,value:n[e]};t.key in this._flightingTreatmentVariables||(this._flightingTreatmentVariables[t.key]=t.value)}}updateDisabledChangeGates(e){const t=e.DisabledChangeGates;let n;({deserialized:n}=c.d(t)).returnValue&&(this._disabledChangeGates=n)}isFullChecked(e){return Boolean.parse(e.IsFullAppSettings||"false")}invokeOrRegisterOnFullAppSettingsReady(e){this.isFullAppSettingsReady?e():this._eventSource&&this._eventSource.addHandler(_,e)}raiseFullAppSettingsReadyEvent(){this._eventSource&&(this._eventSource.raiseEvent(_),this._eventSource.dispose(),this._eventSource=null)}invokeOrRegisterOnFullAppSettingsFailed(e){2!==this.state?this._eventSource&&this._eventSource.addHandler(S,e):e()}raiseFullAppSettingsFailedEvent(){this._eventSource&&(this._eventSource.raiseEvent(S),this._eventSource.dispose(),this._eventSource=null)}getFullAppSettings(){return this._appSettingsPromise||(this._appSettingsPromise=new Promise(((e,t)=>{this.invokeOrRegisterOnFullAppSettingsReady((()=>{e(!0)})),this.invokeOrRegisterOnFullAppSettingsFailed((()=>{t(!1)}))}))),this._appSettingsPromise}requestPostBootAppSettings(e=null){const t=this.getAppSettingsUri();t?h.AFrameworkApplicationConstants.theClientRequestManager.addRequest(t,1,null,null,!1,2,this.onAppSettingsRequestSucceeded,this.onAppSettingsRequestFailed,null,void 0,void 0,void 0,void 0,"10"):i.ULS.sendTraceTag(5247296,208,15,"Failed to get full appsettings service url")}getBaseDocQuerySignature(){return this._settingsGetter.appSettings.BaseDocQuerySignatureWithoutVersion}getAppSettingsUri(){const e=this.getBaseDocQuerySignature();if(!e)return null;let t=this._settingsGetter.appSettings.WebServiceBase+"appsettings.ashx?"+e;const n=d.a.getParameterValueDecoded(document.URL,"sc");return n&&(t=d.a.addParameterValue(t,"sc",n)),t}logAndRetryFailedAppSettingsRequest(e){const t=this._appSettingsRequestRetries<this.getIntAppSetting("AppSettingsRequestRetryCount",5);if(this._appSettingsRequestRetries++,e.ShouldRetry=t,e.RetryNumber=this._appSettingsRequestRetries,i.ULS.sendTraceTag(4850133,208,10,"AppSettings request failed. {0}",e),t){const e=new l.a(2,1,5e3,(0,o.a)(this,this.requestPostBootAppSettings,"requestPostBootAppSettings"),96);this._taskManager.addTask(e)}else this._state=2,this.raiseFullAppSettingsFailedEvent()}getBooleanAppSetting(e){return this._settingsGetter.getBooleanAppSetting(e)}getStringAppSetting(e){return this._settingsGetter.getStringAppSetting(e)}getIntAppSetting(e,t){return this._settingsGetter.getIntAppSetting(e,t)}getLongAppSetting(e,t){return this._settingsGetter.getLongAppSetting(e,t)}getDoubleAppSetting(e,t){return this._settingsGetter.getDoubleAppSetting(e,t)}getListAppSetting(e){return this._settingsGetter.getListAppSetting(e)}containsAppSetting(e){return this._settingsGetter.containsAppSetting(e)}getFlightingTreatmentVariables(e){const t={},n=this.getIntAppSetting("SdxAssetIdPositionInTreatmentVariablesNamespace",0),a=this._flightingTreatmentVariables;for(const i in a){const o={key:i,value:a[i]},r=o.key.split(".");r.length>n+1&&r[n]===e&&(t[o.key]=o.value)}return t}getHostFlightingTreatmentVariables(e){const t={},n=this._flightingTreatmentVariables;for(const a in n){const i={key:a,value:n[a]},o=i.key.split(".");o.length>=2&&o[o.length-2]===e&&(t[i.key]=i.value)}return t}getBooleanFeatureGate(e,t){return(e=this.updateFeatureGateNameIfPrefixIsMissing(e))in this._flightingTreatmentVariables?Boolean.parse(this._flightingTreatmentVariables[e]):t}getIntFeatureGate(e,t){if((e=this.updateFeatureGateNameIfPrefixIsMissing(e))in this._flightingTreatmentVariables){const t=parseInt(this._flightingTreatmentVariables[e]);if(!isNaN(t))return t}return t}getStringFeatureGate(e,t){return(e=this.updateFeatureGateNameIfPrefixIsMissing(e))in this._flightingTreatmentVariables?this._flightingTreatmentVariables[e]:t}updateFullAppSettingsWithTreatmentVariables(e,t){for(const n in t){const a={key:n,value:t[n]};a.key in e||(e[a.key]=a.value)}}updateFeatureGateNameIfPrefixIsMissing(e){if(this._settingsGetter.getBooleanAppSetting("ShouldRemoveMicrosoftOfficeFeatureGatePrefix")){const t="microsoft.office.",n=e.length-17,a=e.toLowerCase();n>0&&!a.indexOf(t)&&(e=e.substring(17,n))}return e}isChangeGateEnabled(e){return!(e in this._disabledChangeGates)}addInfoForULS(e){if(null==e)return void 0;let t;try{t=c.b(m.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.SessionStartInfoJson.toString())}catch(e){t={}}const n="Unknown",a="Application",i="AppMode",o="Host",r="Browser",s="BrowserMajorVersion",l="BrowserMinorVersion",d="Platform",p="PlatformMajorVersion",g="PlatformMinorVersion",_="DeviceName",S="IsProd",f="ApplicationVersion",C="FlightIDs",y="Error",A="ErrorCode",b="Crash",T="Ring",v="ServerDocId",w=m.AFrameworkApplication_AppSettingsManager.appSettingsManager?m.AFrameworkApplication_AppSettingsManager.appSettingsManager.getIntAppSetting("TrimMaxFlightIdLength",Number.MAX_VALUE):Number.MAX_VALUE,F=e.App||this.appSettings.OfficeApplicationName||n;e[a]=t[a]||F||m.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.OfficeApplicationName.toString().replace("Web","")||n,e[i]=e[i]||h.AFrameworkApplicationConstants.activeFrame.modeName||n,e.ApplicationMode=t.ApplicationModeExtended||e[i]||h.AFrameworkApplicationConstants.activeFrame.modeName||n,e[o]=t[o]||e[o]||h.AFrameworkApplicationConstants.feedbackDescription||n,e[r]=t[r]||e[r]||n,e[s]=t[s]||null,e[l]=t[l]||null,e[d]=t[d]||e[d]||n,e[p]=t[p]||null,e[g]=t[g]||null,e[_]=t[_]||e[_]||n,e.SessionID=t.WACSessionID||(h.AFrameworkApplicationConstants.theClientRequestManager?m.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("SessionId"):n),e.LanguageID=h.AFrameworkApplicationConstants.lcid,e.IsIPad=u.a.isIPad,e.IsMac=u.a.isMac,e[T]=t[T]||-1,e[S]=e[S]||h.AFrameworkApplicationConstants.isCustomerFeedbackExternal,e.Datacenter=t.WACDatacenter||(h.AFrameworkApplicationConstants.theClientRequestManager?h.AFrameworkApplicationConstants.theClientRequestManager.wacClusterId:n),e.Version=h.AFrameworkApplicationConstants.buildVersion,e[f]=t[f]||h.AFrameworkApplicationConstants.buildVersion,e[y]=e[y]||!1,e[A]=e[A]||null,e[b]=e[b]||!1,e[C]=e[C]||h.AFrameworkApplicationConstants.flightId||"",e[C].toString().length>w&&(e[C]=String.format("{0}...[Flight IDs trimmed]",e[C].toString().substr(0,w-1))),e[v]=t[v]||n}constructor(e,t=null){this._settingsGetter=new r.a({},null),this._eventSource=new s.a,this._logData={},this._appSettingsPromise=null,this._flightingTreatmentVariables={},this._disabledChangeGates={},this._appSettingsRequestRetries=0,this.allowFullAppSettingsOverrides=!1,this._state=0,this._delayFullAppSettings=void 0,this._holdFullAppSettings=void 0,this._savedClientAppSettings=null,this.onAppSettingsRequestSucceeded=e=>{let t;this._logData={Status:e.data.status,HttpStatus:e.data.httpStatus,ResponseLength:e.data.responseData?e.data.responseData.length:-1},i.ULS.sendTraceTag(4850132,208,50,"AppSettings request succeeded. {0}",this._logData);try{t=c.b(e.data.responseData)}catch(e){return i.ULS.sendTraceTag(5908570,208,10,"AppSettings JSON parse failed. {0}",e),this._state=2,void this.raiseFullAppSettingsFailedEvent()}this.updateFullAppSettings(t)},this.onAppSettingsRequestFailed=e=>{this._logData={Status:e.data.status,HttpStatus:e.data.httpStatus,ResponseData:p.a.trimToLength(e.data.responseData,100)},this.logAndRetryFailedAppSettingsRequest(this._logData)},this.isFullChecked(e)?this.updateFullAppSettings(e):this._settingsGetter=new r.a(e,null),this.updateFlightingTreatmentVariables(e),this.updateDisabledChangeGates(e),this._taskManager=t||g.TaskManager.instance}}(0,a.a)(f,"AppSettingsManager",null,[61,60])},8009:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.IRefreshableAppSettings")},4182:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")},7096:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper")},1682:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper")},3798:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5557),o=n(2274);class r{static getBrotliResourceUrl(e){return o.AFrameworkApplication_AppSettingsManager.appSettingsManager&&o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting(r.isBrotliSupportedSettingName)&&(e.endsWith(r.cssExtension)?e.replace(r.cssExtension,r.brotliExtension+r.cssExtension):e.endsWith(r.jsExtension)&&e.replace(r.cssExtension,r.brotliExtension+r.jsExtension),i.b(508396301,200,50,"Returning brotli compressed url {0}",e)),e}}r.isBrotliSupportedSettingName="IsBrotliSupported",r.cssExtension=".css",r.jsExtension=".js",r.brotliExtension=".br",(0,a.a)(r,"BrotliResourceUrlResolver",null,[])},9824:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(5149);class o{get name(){return this._name}get test(){return this._test}get shouldRedirect(){return this._shouldRedirect}isSupported(){return this._test()}constructor(e,t,n){this._name=e.toLowerCase(),this._test=t,this._shouldRedirect=n}}(0,a.a)(o,"BrowserFeature",null,[62]);var r=n(3696),s=n(8103);class l{get name(){return`CSS ${this._propertyName}:${this._value}`}get shouldRedirect(){return this._shouldRedirect}isSupported(){return this.test()}test(){if("CSS"in window&&"supports"in window.CSS)return window.CSS.supports(this._propertyName,this._value);const e=document.createElement("div").style;return e.cssText=`${this._propertyName} : ${this._value}`,e.length>0}constructor(e,t,n){this._propertyName=e.toLowerCase(),this._value=t.toLowerCase(),this._shouldRedirect=n}}(0,a.a)(l,"CssBrowserFeature",null,[62]);n(7442);class c{get areBrowserFeaturesSupported(){return this._areBrowserFeaturesSupported}runFeatureChecks(e){try{if(e&&e.getBooleanAppSetting("BrowserFeatureDetectionIsEnabled")){let t=!1;for(let e=0;e<this._browserFeatures.length;e++)this._browserFeatures[e].isSupported()||(t=this._browserFeatures[e].shouldRedirect||t,i.ULS.sendTraceTag(39321882,306,15,"{0} is not supported. Show warning dialog: {1}",this._browserFeatures[e].name,this._browserFeatures[e].shouldRedirect));if(this._areBrowserFeaturesSupported=!t,t&&e.getBooleanAppSetting("BrowserFeatureDetectionWarningIsEnabled")){const t=e.getStringAppSetting("BrowserFeatureDetectionRedirectURL")||"";""!==t&&this.showDialog(t)}}}catch(e){i.ULS.sendTraceTag(39321883,306,15,"RunFeatureChecks caught exception: {0}",e)}}showDialog(e){this._dialog=new r.StandardDialog,this.setupStandardDialog(e)}setupStandardDialog(e){try{this._title=(0,s.a)("DefaultDialogTitle"),this._message=(0,s.a)("UnsupportedBrowser"),this._dialogOk=(0,s.a)("DialogOk"),this._linkText=(0,s.a)("LearnMore")}catch(e){i.ULS.sendTraceTag(39321884,306,15,"Failed to get CommonUiStrings. Exception: {0}",e)}this._dialog.buttonsOption=6,this._dialog.setButtonText(0,this._dialogOk),this._dialog.addExtraLink(this._linkText,e),this._dialog.showError(40,this._title,this._message,this.dialogHandler,!1,!0),i.ULS.sendTraceTag(39683483,306,15,"Show dialog and report UnsupportedBrowserWarning error")}static get instance(){return c._instance||(c._instance=new c),c._instance}constructor(){this._title="Microsoft Office",this._message="The browser you're using isn't supported, so some features may not work as expected. For best results, switch to a supported browser.",this._dialogOk="OK",this._linkText="Learn More",this._dialog=null,this._areBrowserFeaturesSupported=!0,this.dialogHandler=(e,t)=>{0===e&&this._dialog.dispose()},this._browserFeatures=[],this._browserFeatures.push(new o("window.Map",(()=>{let e=!0;try{e=void 0!==window.Map;new Map}catch(t){e=!1}return e}),!0)),this._browserFeatures.push(new o("window.Set",(()=>{let e=!0;try{e=void 0!==window.Set;new Set}catch(t){e=!1}return e}),!0)),this._browserFeatures.push(new o("window.requestanimationframe",(()=>{let e=!0;try{e=void 0!==window.requestAnimationFrame}catch(t){e=!1}return e}),!0)),this._browserFeatures.push(new o("window.Promise",(()=>{let e=!0;try{e=void 0!==window.Promise}catch(t){e=!1}return e}),!0)),this._browserFeatures.push(new o("window.performance",(()=>{let e=!0;try{e=void 0!==window.performance}catch(t){e=!1}return e}),!0)),this._browserFeatures.push(new o("window.Proxy",(()=>{let e=!0;try{e=void 0!==window.Proxy}catch(t){e=!1}return e}),!1)),this._browserFeatures.push(new o("window.ResizeObserver",(()=>{let e=!0;try{e=void 0!==window.ResizeObserver}catch(t){e=!1}return e}),!1)),this._browserFeatures.push(new o("window.IntersectionObserver",(()=>{let e=!0;try{e=void 0!==window.IntersectionObserver}catch(t){e=!1}return e}),!1)),this._browserFeatures.push(new l("display","grid",!0))}}c._instance=null,(0,a.a)(c,"BrowserFeatureManager",null,[198])},7445:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e,t){this.externalUxCommand=null,this.commandId=null,this.queryCommandId=null,this.commandPreviewId=null,this.commandRevertId=null,this.menuItemId=null,this.populationProps=null,this.legacyControlId=null,this.previewControlIds=null,this.getPreviewControlIdsExternally=!1,this.externalUxCommand=e,this.commandId=t}}(0,a.a)(i,"CommandMetadata",null,[])},2378:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(4238),o=n(3245),r=n(5278),s=n(3225),l=n(629),c=n(2217),d=n(4706),u=n(6094);class p{static get topBarOneCssClass(){let e="cui-topBar1";return o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.isTransistionalHeaderUIEnabled&&(e+=" cui-topBar1-transistionalHeaderUI"),o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(e+=" cui-color-update"),e}static tryEnsuredHeaderPanelInitialized(e=!0,t=!1){const n=document.getElementById(o.AFrameworkApplication.externalHeaderPanelId);if(!n)return{returnValue:!1,headerPanel:n};const a=!!o.AFrameworkApplication.activeFrame?o.AFrameworkApplication.activeFrame.get_element():n.nextSibling,i=t||!!o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.isRibbonFlexBoxLayoutEnabled;return e?(n.style.display="",u.a.ensureCSSClassOnElement(a,"cui-exth"),i&&u.a.ensureCSSClassOnElement(a,"FlexBoxLayout")):n.style.display="none",{returnValue:!0,headerPanel:n}}static initializeCuiScope(e,t,n,a,o,u,p=!0){const g=l.FocusManager.instance(),h=s.a.instance,m=c.a.instance,_=d.a.instance,S=g.getScope(e);if(S.parent=i.a.mainAppFocusId,h.addF6(e,p),t&&S.addSetFocus(t),n&&(m.addControlFocus(e,n,a),_.addControlFocus(e,n,a),o)){const e=new r.a((()=>n));e.addValidTag(3),e.addValidTag(2),e.addValidTag(4),e.addValidTag(1);g.buildRegionWithDelegate((()=>n),S,e).looped=u}return S}}p.externalHeaderFullTopBarsId="ExternalHeaderFullTopBars",p.externalHeaderViewerChromeTopBarsId="ExternalHeaderViewerChromeTopBars",p.breadcrumbBrandId="BreadcrumbBrand",p.breadcrumbFolderId="BreadcrumbFolder",p.signoutLinkId="SignoutLink",p.signInLinkId="SignInLink",p.touchModeCssClass="cui-touch",p.externalHeaderContainerClass="cui-ribbonTopBars",p.externalHeaderContainerClassToMimicRibbon="cui-ribbon",p.ribbonExternalHeaderClass="cui-exth",(0,a.a)(p,"CuiHeaderDomReference",null,[])},1752:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e,t){this.populateQueryCommandId=null,this.populateOnlyOnce=!1,this.populateQueryCommandId=e,this.populateOnlyOnce=t}}(0,a.a)(i,"MenuPopulationProperties",null,[])},9052:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(3435);class o extends i.a{get ControlType(){return 6}constructor(){super(),this.UseUncheckedImage=!1,this.CloseMenuWhenExecuted=!0,this.IsChecked=!1,this.CheckedImageClass=null,this.CheckedImage=null}}(0,a.a)(o,"CheckMarkToggleButtonProps",i.a,[])},7146:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(3299),o=n(5149),r=n(965),s=n(6362),l=n(2274);const c="HashedStaticContentHostShippingFrom1JS",d="VersionedStaticContentHostShippingFrom1JS",u="HashedResourceClientManifestShippingFrom1JS";class p{get isShippingFrom1JSEnabled(){return this._isShippingFrom1JSEnabled}get hasedResourceDomainShippingFrom1JS(){return this._hasedResourceDomainShippingFrom1JS}get versionedResourceDomainShippingFrom1JS(){return this._versionedResourceDomainShippingFrom1JS}get resourceShippingFrom1JSHashMap(){return this._resourceShippingFrom1JSHashMap}get resourceShippingFrom1JSVersionedMap(){return this._resourceShippingFrom1JSVersionedMap}isShippingFrom1JSSettingsEnabled(){return this._appSettingsManager&&"Word"===this._appSettingsManager.getStringAppSetting("Application")&&this.hasServerSetShipFrom1JSSettings()}hasServerSetShipFrom1JSSettings(){return this._appSettingsManager&&void 0!==this._appSettingsManager.getStringAppSetting(u)&&void 0!==this._appSettingsManager.getStringAppSetting(c)&&void 0!==this._appSettingsManager.getStringAppSetting(d)}setResourceHashMap(){try{const e=this._resourceShippingFrom1JSHashMap=r.b(this._appSettingsManager.getStringAppSetting(u));e&&(this._resourceShippingFrom1JSHashMap=e.resources,this._resourceShippingFrom1JSVersionedMap=e.versionedResources),(s.a.isNullOrEmpty(this._resourceShippingFrom1JSHashMap)||s.a.isNullOrEmpty(this._resourceShippingFrom1JSVersionedMap))&&(this._isShippingFrom1JSEnabled=!1)}catch(e){o.ULS.sendTraceTag(507351361,200,15,"setResourceHashMap failed with error: "+e.message),this._isShippingFrom1JSEnabled=!1}}static getLazySingletonInstance(){return new i.a((()=>new p(l.AFrameworkApplication_AppSettingsManager.appSettingsManager)))}static get instance(){return p._singletonInstance.value}constructor(e){this._resourceShippingFrom1JSHashMap=null,this._resourceShippingFrom1JSVersionedMap=null,this._versionedResourceDomainShippingFrom1JS=null,this._hasedResourceDomainShippingFrom1JS=null,this._isShippingFrom1JSEnabled=!1,this._appSettingsManager=e,this.isShippingFrom1JSSettingsEnabled()&&(this._isShippingFrom1JSEnabled=!0,this._isShippingFrom1JSEnabled&&(this._hasedResourceDomainShippingFrom1JS=this._appSettingsManager.getStringAppSetting(c),this._versionedResourceDomainShippingFrom1JS=this._appSettingsManager.getStringAppSetting(d),this.setResourceHashMap()))}}p._singletonInstance=p.getLazySingletonInstance(),(0,a.a)(p,"ClientManifestSettings",null,[])},1244:function(e,t,n){"use strict";n.d(t,{a:function(){return o},b:function(){return i},c:function(){return l},d:function(){return r},e:function(){return a},f:function(){return c},g:function(){return d},h:function(){return s}});const a="event_source",i="CloseButton",o="OIC",r="FileMenu",s="",l="Error",c="ReportAbuse",d="SessionExpiration"},4853:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8281);class o extends i.a{get ControlType(){return 7}constructor(){super(),this.McuLayout=!1,this.McuExternalId=null,this.Command=null,this.QueryCommand=null,this.CommandPreviewId=null,this.CommandRevertId=null,this.Width=0,this.Colors=null,this.Stateful=!1,this.SelectedColorId=null}}(0,a.a)(o,"ColorPickerControlProps",i.a,[])},4733:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(2500),o=n(1489),r=n(681),s=n(7128),l=n(7958),c=n(1163);const d="Shared_BasicClass",u="Shared_QuickClass";class p{static splashScreenFadeOutFrom100PercentToZero(e,t,n){s.WacAirSpace.setAnimationClass(e,d);const a=new i.a(e);a.animateOpacity(1,0),s.WacAirSpace.animate(a,t,n)}static splashScreenFadeOut(e,t,n){const a=l.a.getOpacity(e)/100;s.WacAirSpace.setAnimationClass(e,d);const o=new i.a(e);o.animateOpacity(a,0),s.WacAirSpace.animate(o,t,n)}static addNotification(e){s.WacAirSpace.setAnimationClass(e,"Shared_QuickClass");const t=new r.a(e);t.animateOpacity(0,1),s.WacAirSpace.animate(t,null,null);const n=new o.a(e);n.animateY(e.clientTop-30,e.clientTop),s.WacAirSpace.animate(n,null,null)}static removeNotification(e,t,n){const a=new i.a(e);a.animateOpacity(1,0),s.WacAirSpace.animate(a,t,n)}static showMenu(e,t,n){t&&t.length>0&&p.hideDomElements(t),s.WacAirSpace.setAnimationClass(e,u);const a=new r.a(e);a.animateOpacity(0,1),s.WacAirSpace.animate(a,null,n)}static hideDomElements(e){for(let t=0;t<e.length;t++)l.a.setOpacity(e[t],0)}static animateJewelMenuContents(e,t){for(let e=0;e<t.length;e++){const n=t[e];n.style.position="relative",s.WacAirSpace.setAnimationClass(n,u);const a=new r.a(n);if(a.animateOpacity(l.a.getOpacity(n)/100,1),s.WacAirSpace.animate(a,null,null),!c.a.isFirefox){const e=-100,t=new o.a(n);t.animateY(e,0),s.WacAirSpace.animate(t,null,null)}}}static hideJewelMenu(e,t){const n=s.WacAirSpace.cloneElement(e,!1,!0),a=n.children[0];n.style.zIndex=String(t),s.WacAirSpace.setAnimationClass(a,"Shared_QuickClass"),s.WacAirSpace.setAnimationClass(n,"Shared_BasicClass");const o=new i.a(n);o.animateOpacity(l.a.getOpacity(n)/100,0),s.WacAirSpace.animate(o,null,p.afterHideJewelMenu);const r=new i.a(a);r.animateOpacity(l.a.getOpacity(a)/100,0),s.WacAirSpace.animate(r,null,null)}static afterHideJewelMenu(e){const t=e.element;t.parentNode&&t.parentNode.removeChild(t)}}p.documentPanelAnimationClass="UEX_WindowTransition",p.showHideTaskPaneAnimationClass="Shared_BasicClass",(0,a.a)(p,"CommonAnimator",null,[])},8281:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get ControlType(){return 0}constructor(){this.Id=null,this.ExternalId=null}}(0,a.a)(i,"CommonControlProps",null,[])},8462:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8281);class o extends i.a{constructor(){super(),this.KeyTip=null,this.Alt=null,this.Command=null,this.LabelText=null,this.LabelCss=null,this.Image16by16=null,this.Image16by16Class=null,this.Image32by32=null,this.Image32by32Class=null,this.Lang=null,this.ExternalImageId=null}}(0,a.a)(o,"CommonControlWithIconAndTextProps",i.a,[])},1207:function(e,t,n){"use strict";n.d(t,{a:function(){return l}});var a=n(100),i=n(2274),o=n(7146),r=n(884),s=n(9858);class l{static get staticContentQueryParameter(){return l._StaticContentQueryParameter}static set staticContentQueryParameter(e){l._StaticContentQueryParameter=e?e.replace("&","&amp;"):""}static removeBroltiFlightFromStaticContentQueryParameter(e){return e&&((e=e.replace("?UseBrotli=true",""))!==l.staticContentQueryParameter&&""!==e&&(e="?"+e),e=e.replace("&UseBrotli=true","")),e}static get pagePath(){return l._pagePath||(l._pagePath=l._prefixExp.exec(document.URL)[1])}static get pageBase(){return l._pageBase||(l._pageBase=l._absolutePatExp.exec(l.pagePath)[1])}static get pageHost(){return l._pageHost||(l._pageHost=new RegExp("^([a-z+.-]+://[^/]*)").exec(document.URL)[1])}static get wd1jsIsEnabled(){return!!i.AFrameworkApplication_AppSettingsManager.appSettingsManager&&i.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("Wd1jsIsEnabled")}static commonImage(e){return r.a.instance.isEnabled?l.createHashedResourcePath(e,l.commonImageBase,!0,!0):l.sharedStaticContentHost+l.commonImageBase+s.a.escape(e)+l.removeBroltiFlightFromStaticContentQueryParameter(l.staticContentQueryParameter)}static commonCss(e){return r.a.instance.isEnabled?l.createHashedResourcePath(e,l.commonCssBase,!0,!1):l.sharedStaticContentHost+l.commonCssBase+s.a.escape(e)+l.staticContentQueryParameter}static commonScripts(e){return l.commonScriptsPath(e)+l.staticContentQueryParameter}static commonScriptsPath(e){if(r.a.instance.isEnabled)return l.createHashedResourcePath(e,l.commonScriptsBase,!1,!1);return l.sharedStaticContentHost+l.commonScriptsBase+s.a.escape(e)}static commonScriptsLocalized(e){if(r.a.instance.isEnabled)return l.createHashedResourcePath(e,l.commonScriptsLcidBase,!0,!1);return l.sharedStaticContentHost+l.commonScriptsLcidBase+s.a.escape(e)+l.staticContentQueryParameter}static createHashedResourcePath(e,t,n,a){o.a.instance.isShippingFrom1JSEnabled&&!l.wd1jsIsEnabled&&(t="");let i="";i=l.wd1jsIsEnabled?l.staticContentHost:r.a.instance.getHashedCommonResourceHost(t+e)||l.sharedStaticContentHost;let c="";n&&(c=a?l.removeBroltiFlightFromStaticContentQueryParameter(l.staticContentQueryParameter):l.staticContentQueryParameter);return i+t+s.a.escape(e)+c}static combineUrlPaths(e,t){return e?e.endsWith("/")?e+t:e+"/"+t:t}static isAbsolute(e){return l._absolutePatExp.test(l._prefixExp.exec(e)[1])}static absolutePath(e){return l.isAbsolute(e)?e:e.startsWith("/")?l.pageHost+e:e.startsWith("~")?null:l.pageBase+e}static commonImageLocation(e){const t=l.commonImage(e);return t.substring(0,t.length-e.length)}}l.commonImageBase=null,l.commonCssBase=null,l.commonScriptsBase=null,l.commonScriptsLcidBase=null,l._StaticContentQueryParameter=null,l.staticContentHost=null,l.sharedStaticContentHost=null,l._prefixExp=new RegExp("^([^?]+)"),l._absolutePatExp=new RegExp("^([a-z+.-]+://(?:[^/]*/)*)[^/]*$"),l._pagePath=null,l._pageBase=null,l._pageHost=null,(0,a.a)(l,"CommonPath",null,[])},6984:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(3792);const o=(0,i.b)("Common.ICpuMeterProvider");class r{get realCpuMeter(){return!this._realCpuMeter&&this._realCpuMeterGetter()&&(this._realCpuMeter=this._realCpuMeterGetter().tryGetCpuMeter()),this._realCpuMeter}profileTopLevelTask(e,t,n,a=null){const i=this.realCpuMeter;i?i.profileTopLevelTask(e,t,n,a):e()}profileFunction(e,t){const n=this.realCpuMeter;n?n.profileFunction(e,t):e()}onTaskAdded(e){const t=this.realCpuMeter;t&&t.onTaskAdded(e)}onBeforeProcess(){const e=this.realCpuMeter;e&&e.onBeforeProcess()}onAfterProcess(){const e=this.realCpuMeter;e&&e.onAfterProcess()}markInterestingEvent(e){const t=this.realCpuMeter;t&&t.markInterestingEvent(e)}add_onCpuMeterFrameAvailable(e){}remove_onCpuMeterFrameAvailable(e){}run(){}markEventTraceFlag(e){const t=this.realCpuMeter;t&&t.markEventTraceFlag(e)}clearEventTraceFlag(e=!0,t=0){const n=this.realCpuMeter;n&&n.clearEventTraceFlag(e,t)}addCpuMeterTaskEventWithFilter(e,t,n){const a=this.realCpuMeter;a&&a.addCpuMeterTaskEventWithFilter(e,t,n)}static get instance(){return r._instance||(r._instance=r.getInstance())}static getInstance(){return new r((()=>(0,i.j)(o)))}constructor(e){this._realCpuMeter=null,this._realCpuMeterGetter=e}}r._instance=null,(0,a.a)(r,"CpuMeterProxy",null,[67])},8574:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8462);class o extends i.a{get ControlType(){return 1}constructor(){super(),this.MenuItemId=null,this.QueryCommand=null,this.CommandPreviewId=null,this.CommandRevertId=null,this.CommandValueId=null,this.DisplayMode=null,this.Description=null,this.ImageBackColor=null,this.IconColor=null,this.LabelTextUserGeneratedPlaceholderReplacements=null,this.MenuItemsStatefulData=null,this.Visible=!1,this.AriaDescription=null,this.RoleInMenu=null,this.ShouldTakeFocus=!0,this.SecondaryText=null}}(0,a.a)(o,"CuiButtonProps",i.a,[])},9224:function(e,t,n){"use strict";n.d(t,{a:function(){return h},b:function(){return y},c:function(){return T},d:function(){return v},e:function(){return b},f:function(){return f},g:function(){return w},h:function(){return A},i:function(){return C},j:function(){return S},k:function(){return F}});var a=n(8555),i=n(3245),o=n(9052),r=n(4853),s=n(8574),l=n(121),c=n(1993),d=n(5374),u=n(9645),p=n(3435),g=n(9858);const h=(e,t,n,a,o,r,s,l,c,u,p=null,g=null,h=null,_=!0,S=null,f=null,C=null,y=null,A=null,b=null)=>m(e,t,n,a?i.AFrameworkApplication.imageClusterPath:null,a?d.c(a):null,o,r,s,l,c,u,p,g,h,_,S,f,C,y,A,null,b),m=(e,t,n,a,i,o,r,s,l,c,d,u=null,p=null,g=null,h=!0,m=null,_=null,S=null,f=null,C=null,y=null,A=null)=>{let b='<Button Id="{0}" Command="{1}" LabelText="{2}" Visible="{3}"';b=String.format(b,e,t,n,h);const T={MenuItemId:o,CommandValueId:r,Alt:s,DisplayMode:l,LabelCss:c,QueryCommand:d,Description:u,ImageBackColor:p,Keytip:g,LabelTextUserGeneratedPlaceholderReplacements:y,ShortcutHint:A};m&&(T.AriaLabel=m),_&&(T.AriaLabelledById=_),S&&(T.AriaLabelledByText=S),f&&(T.AriaDescribedById=f),C&&(T.AriaDescribedByText=C),a&&(l&&"Small"!==l&&"Medium"!==l&&"Menu16"!==l?"Small20"===l||"Medium20"===l?(T.Image20by20=a,T.Image20by20Class=i):("Large"===l||"Menu32"===l||"Initials"===l)&&(T.Image32by32=a,T.Image32by32Class=i):(T.Image16by16=a,T.Image16by16Class=i));for(const e in T){const t={key:e,value:T[e]};t.value&&(b+=String.format(' {0}="{1}"',t.key,t.value))}return b+=" />",b},_=(e,t,n,a,i,o,r,s,l,c,d,u,p,g,h,m,_,S,f=null)=>{let C='<FlyoutAnchor Id="{0}" ';C=String.format(C,e);const y={Command:t,CommandMenuOpen:n,CommandMenuClose:a,PopulateDynamically:i?"True":"False",PopulateOnlyOnce:o?"True":"False",QueryCommand:r,PopulateQueryCommand:s,Alt:u,SequenceType:p,LabelText:g,LabelCss:h,ShouldRefreshWhenDropped:m?"True":"False",RefreshableMenu:_?"True":"False",Visible:S?"True":"False"};let A=null,T=null;"None"!==l&&(A=l,T=l+"Class"),c&&A&&(y[A]=c),d&&T&&(y[T]=d);for(const e in y){const t={key:e,value:y[e]};t.value&&(C+=String.format(' {0}="{1}"',t.key,t.value))}return C+=">",f&&(C+=b(f)),C+="</FlyoutAnchor>",C},S=e=>_(e.id,e.actionIdCommand.toString(),e.actionIdCommandMenuOpen.toString(),e.actionIdCommandMenuClose.toString(),!0,!1,e.actionIdQueryStatus.toString(),e.actionIdPopulateFlyout.toString(),"Image16by16",e.singleUserCollabGlyph16.cluster,e.singleUserCollabGlyph16.css,null,null,null,null,!1,!1,!1),f=(e,t,n)=>{let a="";return a=g.a.formatNumberToString(n,6,i.AFrameworkApplication.numberFormat),h(e,t,a,null,n.toString())},C=(e,t,n,a,o,r=null,s=null,l=!0,c=null,u=!1,p=null)=>{let g='<ToggleButton Id="{0}" MenuItemId="{1}" Command="{2}" QueryCommand="{3}" LabelText="{4}" Visible="{5}" UpdateHtmlPostToggle="{6}" ';return g=String.format(g,e,t,n,a,o,l,u),null!=r&&o!==r&&(g+=String.format('Alt="{0}" ',r)),null!=s&&(g+=String.format('Image16by16="{0}" Image16by16Class="{1}" ',i.AFrameworkApplication.imageClusterPath,d.c(s))),null!=c&&(g+=String.format('Keytip="{0}" ',c)),null!=p&&(g+=String.format('AriaLabel="{0}" ',p)),g+="/>",g},y=(e,t,n,a,i,o=null,r=null,s=!1,l=!0,c=null,d=null,u=null,p=!1)=>{const g=o||i,h=r?String.format('Keytip="{0}"',r):"",m=a?String.format('QueryCommand="{0}"',a):"",_=c?String.format('IsChecked="{0}"',c??!1):"",S=d?String.format('CheckedImageClass="{0}"',d):"",f=u?String.format('CheckedImage="{0}"',u):"";return String.format('<ToggleButton Id="{0}"\r\n\tMenuItemId="{1}"\r\n\tCommand="{2}"\r\n\t{3}\r\n\tLabelText="{4}"\r\n\tAlt="{5}"\r\n\t{6}\r\n\tUseCheckMark="true"\r\n\tUseUncheckedImage="{7}"\r\n\tCloseMenuWhenExecuted="{8}"\r\n\t{9}\r\n\t{10}\r\n\t{11}\r\n\tUpdateHtmlPostToggle="{12}"\r\n/>',e,t,n,m,i,g,h,s,l,_,S,f,p)},A=(e,t,n,a,o,r)=>{let s='<SplitButton Id="{0}" Command="{1}" QueryCommand="{2}" LabelText="{3}" Image16by16="{4}" Image16by16Class="{5}">';return s=String.format(s,e,t,n,a,i.AFrameworkApplication.imageClusterPath,d.c(o)),s+=b(r),s+="</SplitButton>",s},b=(e,t)=>{let n="<Menu";null!=t&&(n+=' Id="'+t+'"'),n+=">";for(let t=0;t<e.length;++t)n+=e[t];return n+="</Menu>",n},T=(e,t)=>{let n=null==e?"<Controls>":String.format('<Controls Id="{0}">',e);for(let e=0;e<t.length;e++)n+=t[e];return n+="</Controls>",n},v=(e,t,n,a=null,o=null,r=null,s=null)=>{let l="<MenuSection ";return e&&(l+=String.format('Id="{0}" ',e)),n&&(l+=String.format('DisplayMode="{0}" ',n)),a&&(l+=String.format('Title="{0}" ',a),!o||n&&"Menu16"!==n&&"Menu16DescriptionEnabled"!==n||(l+=String.format('Image="{0}" ',i.AFrameworkApplication.imageClusterPath),l+=String.format('ImageClass="{0}" ',d.c(o)))),r&&(l+=String.format('Language="{0}" ',r)),s&&(l+=String.format('ariaLabelledById="{0}" ',s)),l+=">",l+=t,l+="</MenuSection>",l},w=e=>{let t='<Separator Id="{0}" />';return t=String.format(t,e),t},F=e=>{const t=new Sys.StringBuilder;t.append(String.format('<Menu Id="{0}"',e.Id)),e.MaxWidth&&t.append(String.format(' MaxWidth="{0}"',e.MaxWidth)),t.append(">");for(let n=0;n<e.MenuSectionList.length;n++){const a=e.MenuSectionList[n];a&&t.append(I(a))}return t.append("</Menu>"),t.toString()},I=e=>{if(!e.ControlList.length)return"";const t=new Sys.StringBuilder;return t.append("<MenuSection"),e.Id&&t.append(String.format(' Id="{0}"',e.Id)),e.DisplayMode&&t.append(String.format(' DisplayMode="{0}"',e.DisplayMode)),e.Title&&t.append(String.format(' Title="{0}"',e.Title)),e.TitleId&&t.append(String.format(' TitleId="{0}"',e.TitleId)),e.Theme&&t.append(String.format(' Theme="{0}"',e.Theme)),e.ShowMenuSectionSeparator||t.append(String.format(' ShowMenuSectionSeparator="{0}"',e.ShowMenuSectionSeparator)),e.ShowMenuSectionTitleIcon||t.append(String.format(' ShowMenuSectionTitleIcon="{0}"',e.ShowMenuSectionTitleIcon)),e.ShowMenuSectionTitleBackground||t.append(String.format(' ShowMenuSectionTitleBackground="{0}"',e.ShowMenuSectionTitleBackground)),e.MenuSectionTitleFocusable||t.append(String.format(' MenuSectionTitleFocusable="{0}"',e.MenuSectionTitleFocusable)),e.ControlsId?t.append(String.format('><Controls Id="{0}">',e.ControlsId)):t.append(">"),t.append(R(e.ControlList)),e.ControlsId&&t.append("</Controls>"),t.append("</MenuSection>"),t.toString()},E=e=>{const t=new Sys.StringBuilder;return e&&(t.append(String.format('<Button Id="{0}"',e.Id)),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.CommandValueId&&t.append(String.format(' CommandValueId="{0}"',e.CommandValueId)),e.CommandPreviewId&&t.append(String.format(' CommandPreview="{0}"',e.CommandPreviewId)),e.CommandRevertId&&t.append(String.format(' CommandRevert="{0}"',e.CommandRevertId)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),e.MenuItemId&&t.append(String.format(' MenuItemId="{0}"',e.MenuItemId)),e.LabelCss&&t.append(String.format(' LabelCss="{0}"',e.LabelCss)),e.Image16by16Class&&t.append(String.format(' Image16by16="{0}" Image16by16Class="{1}"',e.Image16by16,e.Image16by16Class)),e.Image32by32Class&&t.append(String.format(' Image32by32="{0}" Image32by32Class="{1}"',e.Image32by32,e.Image32by32Class)),e.DisplayMode&&t.append(String.format(' DisplayMode="{0}"',e.DisplayMode)),e.Description&&t.append(String.format(' Description="{0}"',e.Description)),e.ImageBackColor&&t.append(String.format(' ImageBackColor="{0}"',e.ImageBackColor)),e.LabelTextUserGeneratedPlaceholderReplacements&&t.append(String.format(' LabelTextUserGeneratedPlaceholderReplacements="{0}"',e.LabelTextUserGeneratedPlaceholderReplacements)),e.KeyTip&&t.append(String.format(' Keytip="{0}"',e.KeyTip)),e.Alt&&t.append(String.format(' Alt="{0}"',e.Alt)),t.append("/>")),t.toString()},M=e=>e?C(e.Id,e.MenuItemId,e.Command,e.QueryCommand,e.LabelText,e.Alt,e.Image16by16Class,e.Visible,e.KeyTip,e.UpdateHtmlPostToggle,e.AriaLabel):null,k=e=>{const t=new Sys.StringBuilder;return e&&(t.append(String.format('<GalleryButton Id="{0}"',e.Id)),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.QueryCommand&&t.append(String.format(' QueryCommand="{0}"',e.QueryCommand)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),e.VerticalCenterAlign&&t.append(String.format(' VerticalCenterAlign="{0}"',e.VerticalCenterAlign)),e.MenuItemId&&t.append(String.format(' MenuItemId="{0}"',e.MenuItemId)),e.Image&&t.append(String.format(' Image="{0}"',e.Image)),e.ImageClass&&t.append(String.format(' ImageClass="{0}"',e.ImageClass)),e.InnerHTML&&t.append(String.format(' InnerHTML="{0}"',e.InnerHTML)),e.Image||e.InnerHTML||t.append(' InnerHTML=""'),e.ShouldSetTitle&&t.append(String.format(' ShouldSetTitle="{0}"',e.ShouldSetTitle)),e.Alt&&t.append(String.format(' Alt="{0}"',e.Alt)),t.append("/>")),t.toString()},P=e=>{const t=new Sys.StringBuilder;if(e){const n='<Gallery Id="{0}" Width="{1}" ElementDimensions="{2}">';t.append(String.format(n,e.Id,e.Width,e.ElementDimensions));for(let n=0;n<e.GalleryItems.length;n++)t.append(k(e.GalleryItems[n]));t.append("</Gallery>")}return t.toString()},D=e=>{const t=new Sys.StringBuilder;if(e){t.append(String.format('<ColorPicker Id="{0}" Width="{1}"',e.Id,e.Width)),e.McuLayout&&t.append(String.format(' McuLayout="{0}"',e.McuLayout.toString())),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.QueryCommand&&t.append(String.format(' QueryCommand="{0}"',e.QueryCommand)),e.Stateful&&t.append(String.format(' Stateful="{0}"',e.Stateful)),t.append("><Colors>");for(let a=0;a<e.Colors.length;a++)t.append((n=e.Colors[a],String.format('<Color Color="{0}" Alt="{1}" DisplayColor="{2}"/>',n.Color,n.Alt,n.DisplayColor)));t.append("</Colors></ColorPicker>")}var n;return t.toString()},R=e=>{const t=new Sys.StringBuilder;for(let i=0;i<e.length;i++){let d=P((0,a.a)(c.a,e[i]));d?t.append(d):(d=(n=(0,a.a)(o.a,e[i]))?y(n.Id,n.MenuItemId,n.Command,n.QueryCommand,n.LabelText,n.Alt,n.KeyTip,n.UseUncheckedImage,n.CloseMenuWhenExecuted,n.IsChecked,n.CheckedImageClass,n.CheckedImage,n.UpdateHtmlPostToggle):null,d?t.append(d):(d=M((0,a.a)(p.a,e[i])),d?t.append(d):(d=E((0,a.a)(s.a,e[i])),d?t.append(d):(d=D((0,a.a)(r.a,e[i])),d?t.append(d):(d=x((0,a.a)(l.a,e[i])),d?t.append(d):(d=L((0,a.a)(u.a,e[i])),d&&t.append(d)))))))}var n;return t.toString()},x=e=>{const t=new Sys.StringBuilder;return e&&(t.append(String.format('<FlyoutAnchor Id="{0}" ',e.Id)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),e.Alt&&t.append(String.format(' Alt="{0}"',e.Alt)),e.KeyTip&&t.append(String.format(' Keytip="{0}"',e.KeyTip)),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.QueryCommand&&t.append(String.format(' QueryCommand="{0}"',e.QueryCommand)),e.PopulateQueryCommand&&t.append(String.format(' PopulateDynamically="true" PopulateQueryCommand="{0}"',e.PopulateQueryCommand)),e.PopulateOnlyOnce&&t.append(String.format(' PopulateOnlyOnce="{0}"',e.PopulateOnlyOnce)),e.MenuOpenCommand&&t.append(String.format(' MenuOpenCommand="{0}"',e.MenuOpenCommand)),e.MenuCloseCommand&&t.append(String.format(' MenuCloseCommand="{0}"',e.MenuCloseCommand)),e.Image16by16Class&&t.append(String.format(' Image16by16="{0}" Image16by16Class="{1}"',e.Image16by16,e.Image16by16Class)),e.Image32by32Class&&t.append(String.format(' Image32by32="{0}" Image32by32Class="{1}"',e.Image32by32,e.Image32by32Class)),e.ImageIsVisible&&t.append(String.format(' ImageIsVisible="{0}"',e.ImageIsVisible)),e.ImageUsesSpaceWhileInvisible&&t.append(String.format(' ImageUsesSpaceWhileInvisible="{0}"',e.ImageUsesSpaceWhileInvisible)),t.append(">"),e.Menu&&t.append(F(e.Menu)),t.append("</FlyoutAnchor>")),t.toString()},L=e=>{const t=new Sys.StringBuilder;return e&&(t.append(String.format('<Label Id="{0}" ',e.Id)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),t.append("/>")),t.toString()}},4168:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(6949);class o{static dispatch(e,t=null){if(!o._customEventsSupported)return;const n=new CustomEvent(e,t?{detail:t}:{});window.dispatchEvent(n)}static dispatchEvent(e){o._customEventsSupported&&window.dispatchEvent(e)}static addEventListener(e,t,n){void 0!==e.addEventListener&&null!==e.addEventListener&&e.addEventListener(t,n,!1)}}o._customEventsSupported=i.a.browserSupportsCustomEvent(),(0,a.a)(o,"CustomEventHelper",null,[])},7220:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100);class i{static getDefaultDebugSettings(){return new i}constructor(){this.assertHandler=null,this.allowAssertDebugging=void 0,this.disableAssert=void 0,this.enableMaxAssertCount=void 0,this.maxAssertCount=void 0,this.logListeners=void 0,this.shouldLogFunction=null,this.shouldLogCallstackFunction=null}}(0,a.a)(i,"DebugSettings",null,[]);var o=n(499),r=n(9858),s=n(2691),l=n(2274);class c{static get isUnitTest(){if(null==c._isUnitTest)try{c._isUnitTest=!(void 0===JVUnit||null===JVUnit)}catch(e){c._isUnitTest=!1}return c._isUnitTest}static get debugSettings(){return c._debugSettings||(c._debugSettings=i.getDefaultDebugSettings()),c._debugSettings}static set debugSettings(e){c._debugSettings=e}static get KomodoLoaded(){return window.self.g_liveBooksKomodoLoaded}static get KomodoFailedToConnect(){return window.self.g_liveBooksKomodoFailedToConnect}static set KomodoFailedToConnect(e){window.self.g_liveBooksKomodoFailedToConnect=e}static breakpoint(){0}static registerTestHarnessErrorHandler(e){c._testHarnessOnErrorCallback=e}static tryReportErrorToTestHarness(e){return!!c._testHarnessOnErrorCallback&&(c._testHarnessOnErrorCallback(e),!0)}static reportAssertToTestHarness(e,t,n=0){const a=t?s.a(t):"not tagged",i=new Sys.StringBuilder;i.appendLine("Assert ["+a+"] OAUTOBUGTAG:CLS[WebToadBrowserProductErrorAssert]["+a+"][][][]ENDOABT  "),i.append(e),c.tryReportErrorToTestHarness(r.a.replaceAll(i.toString(),"\r\n","\\r\\n"))}static generateCallstack(e=null,t=!0,n=!1,a=0){if(l.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("UseJavascriptCallstacks"))return o.a.generateStack(a+1,20);const i=new Sys.StringBuilder,s=[];let d=1;try{for(let a=e||arguments.callee;a&&d<40;a=a.caller,d++){const e=c.getFunctionName(a);if(e.startsWith(c._commonDebugFunctionPrefix))continue;const o=c.generateSignature(a,n)||"";if(t)i.append(e),i.append(o),i.appendLine();else{const t="anonymous"===e;i.append(String.format(t?'<function depth="{0}" signature="{1}"><![CDATA[{2}]]></function>':'<function depth="{0}" signature="{1}" />',d-1,r.a.htmlEncode(e+o),t?a.toString():""))}if(Array.contains(s,a)){t&&i.appendLine("--[JavaScript recursion]--");break}Array.add(s,a)}40===d&&t&&i.appendLine("***[Maximum callstack depth reached]***")}catch(e){t?(i.append("Exception: "),i.append(e.message),i.appendLine()):i.append(String.format('<function depth="{0}" signature="{1}" />',d-1,r.a.htmlEncode("Exception: "+e.message)))}return i.toString()}static generateMethodFrame(e,t,n=!1){let a="";try{for(let t=e||arguments.callee;t&&(a=c.getFunctionName(t),a.startsWith(c._commonDebugFunctionPrefix)||a.startsWith("$$ct"));t=t.caller);}catch(e){return"[Failed to find current method name - exception "+e.toString()+"]"}if(null==a)return"[Failed to find current method name]";if(t){const e=a.indexOf("__");-1!==e&&(a=a.substr(e+2));const t=a.lastIndexOf("$");-1!==t&&(a=a.substring(0,t))}return a}static generateSignature(e,t){if(!e)return null;let n=null;const a=e.toString().match(c._simpleSignatureRegex);if(a&&3===a.length&&(n=a[2]),!t)return n;let i;i=n&&n.length>=2?n.substring(n.indexOf("(")+1,n.length-1).split(","):[];const o=e.arguments;if(o){const e=new Sys.StringBuilder("("),t=i.length;for(let n=0,a=o.length;n<a;n++){let r;if(n<t){let t=i[n];t=t?t.trim():"",e.append(t),e.append(" = ")}const s=o[n];if(null===s)r="null";else{const e=typeof s;switch(e){case"function":case"undefined":case"object":r=e;break;case"number":case"boolean":r=s.toString();break;case"string":r='"'+s+'"';break;default:r="unknown ("+e+")"}}e.append(r),n<a-1&&e.append(", ")}return e.append(")"),e.toString()}return null}static getFunctionName(e){let t;if(l.AFrameworkApplication_AppSettingsManager.appSettingsManager&&l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("FixAnonymousCallstacksIsEnabled")){t=e.name;const n=e[c._functionLabelFieldName];t&&t.length||(t=n)}else t=e.name||e[c._functionLabelFieldName];if(null==t){const n=e.toString().match(c._functionNameRegex);if(!n||2!==n.length)return"anonymous";t=n[1]}return t.trim().length>0?t:"anonymous"}static addAnonymousFunctionNameFieldToAtlasTypes(){for(const e of Type.getRootNamespaces())0}static nnlpt(e){return e.getName().replace(c._normalizeNamespaceRegex,"_")}static normalizeNamespaceLabelPrefix(e){return e.getName().replace(c._normalizeNamespaceRegex,"_")}static shouldLog(e,t){let n;return n=!1,n}static methodFrame(e,t=null){return c.generateMethodFrame(t,e)}static domElementLoggingInfo(e){let t=c.domElementInfo(e);e.parentNode&&(t+="\nwith Parent "+c.domElementInfo(e.parentNode));const n=e.innerHTML;return n.length<5e3?t+="\n InnerHTML: "+n:t+="\n InnerHTML too long",t}static domElementInfo(e){return String.format("'{0}' tag named '{1}' class '{2}'",e.tagName,e.id,e.className)}}c._debugSettings=null,c._logCache=void 0,c._flushing=void 0,c._komodoNodeProcessor=null,c._komodoLog=null,c._komodoMessageCenter=null,c._komodoContent=null,c._sysNamespaceLabeled=void 0,c._testHarnessOnErrorCallback=null,c._simpleSignatureRegex=new RegExp("function\\s*([^(]*)([^{]*\\))"),c._functionNameRegex=new RegExp("function\\s*([^(]*)\\("),c._normalizeNamespaceRegex=new RegExp("\\.","g"),c._functionLabelFieldName="__ulsFunctionName",c._commonDebugFunctionPrefix=c.nnlpt(c),c.shouldForwardToUls=!0,c.commonLevelMap=void 0,c._isUnitTest=null,c.alertAssertAdditionalInfo=null,c.ReadyForKomodo=!1,c._ignoredAssertCount=void 0,c._ignoredNameCount=void 0,(0,a.a)(c,"Debug",null,[])},4290:function(e,t,n){"use strict";n.d(t,{a:function(){return U}});var a=n(100),i=n(3792),o=n(5149),r=n(625),s=n(1520),l=n(8511);class c{shouldSuppressError(e,t,n,a,i,r,s){for(let l=0;l<this._members.length;l++){const c=this._members[l];if(c.shouldSuppressError(e,t,n,a,i,r,s))return o.ULS.sendTraceTag(39978438,306,50,"Error is suppressed by {0}",Object.getType(c).getName()),!0}return!1}register(e){o.ULS.sendTraceTag(39978439,306,50,"Register {0} as IAppStateConsistencyManager",Object.getType(e).getName()),Array.add(this._members,e)}dispose(){Array.clear(this._members)}static get instance(){return c._instance||(c._instance=new c),c._instance}constructor(){this._members=[]}}c._instance=null,(0,a.a)(c,"AppStateConsistencyHandler",null,[11]);var d=n(9824),u=n(1244),p=n(1207),g=n(7220),h=n(8216),m=n(629),_=n(7531),S=n(6935),f=n(7989),C=n(9969),y=n(7958),A=n(4176),b=n(499),T=n(9858),v=n(988),w=n(2448),F=n(8103),I=n(3245),E=n(965);class M{serialization(){return E.c(this)}constructor(){this.Message=null,this.File=null,this.Line=0,this.Column=0,this.Stack=null,this.ClientAppVersion=null,this.AppType=0,this.AppMode=0,this.DeobfuscateWithSourceMaps=!1,this.SessionStartInfoJson=null,this.DataPlumber=null,this.IsShuttingDown=!1,this.Flight=null,this.ErrorName=null}}(0,a.a)(M,"DiagnosticsRequest",null,[]);class k{sendReport(e,t){try{this.createHttpRequest().send(this.generateReport(e,t))}catch(e){o.ULS.sendTraceTag(6161306,201,10,"Could not send error report [{0}]",e.toString())}}createHttpRequest(){const e=new XMLHttpRequest;if(e.open("POST",this._webServiceUrl,!0),e.setRequestHeader("Content-Type","text/json; charset=utf-8"),I.AFrameworkApplication.userSessionId&&e.setRequestHeader("X-UserSessionId",T.a.httpHeaderEncode(I.AFrameworkApplication.userSessionId)),this._appVersion&&e.setRequestHeader("X-OfficeVersion",this._appVersion),I.AFrameworkApplication.theClientRequestManager){const t=I.AFrameworkApplication.theClientRequestManager.wacClusterId;t&&e.setRequestHeader("X-WacCluster",t)}return e}generateReport(e,t){if(!e)return null;t=t?"<stack>"+t+"</stack>":"";const n=new M;if(n.Message=e.message,n.File=e.source,n.Line=e.line,n.Column=e.column,n.Stack=t,n.ClientAppVersion=this._appVersion,n.AppType=this._appType,n.AppMode=this._appMode,n.DeobfuscateWithSourceMaps=this._isGoogleClosureEnabled,I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("JavaScriptCrashJsonTagEnabled")){const t=I.AFrameworkApplication.appSettingsManager.appSettings.SessionStartInfoJson||"";n.SessionStartInfoJson=t,I.AFrameworkApplication.dataPlumber&&(n.DataPlumber=E.c(I.AFrameworkApplication.dataPlumber)),n.IsShuttingDown=I.AFrameworkApplication.isShuttingDown,n.Flight=I.AFrameworkApplication.flightId,n.ErrorName=w.a.getCrashErrorName(e)}return n.serialization()}constructor(e,t,n,a,i){this._webServiceUrl=e,this._appVersion=t,this._appType=n,this._appMode=a,this._isGoogleClosureEnabled=i}}(0,a.a)(k,"JavascriptErrorReporter",null,[541]);class P{build(e,t,n,a,i){return new k(e,t,n,a,i)}}(0,a.a)(P,"JavascriptErrorReporterFactory",null,[435]);const D=(0,i.b)("Common.IJavascriptErrorReporterFactory"),R=(0,i.e)(D,{onDemandRegister:(e,t)=>{e.register(P,"Common.App.Diagnostics.JavascriptErrorReporterFactory").as(t).singleInstance().usingFactory((()=>new P))}});var x=n(9800);n(7442);const L="OnAfterError";class U{get seenError(){return this._seenError}get preventDuplicateBsqmErrors(){return this._preventDuplicateBsqmErrors}get javascriptErrorReporterFactory(){return this._javascriptErrorReporterFactory||(this._javascriptErrorReporterFactory=(0,i.a)(R))}static get _eventSource(){return w.a._eventSource}init(e,t=0,n=0,a=!1){this.initSuppressRegularExpressions(e,p.a.pagePath);const i=e.WebServiceBase,r=e.BrowserWatsonUrl;r&&(this._javascriptErrorReporter=this.initializeJavascriptErrorReporter(r,i,t,n,a)),o.ULS.sendTraceTag(38401684,306,50,"Suppress ResizeObserverError: {0}",U.suppressResizeObserverErrorIsEnabled)}initializeJavascriptErrorReporter(e,t,n,a,i){return t&&-1===e.indexOf("/")&&(e=t+e),this.javascriptErrorReporterFactory.build(e,I.AFrameworkApplication.buildVersion,n,a,i)}initSuppressRegularExpressions(e,t){this._pagePath=t.toLowerCase(),this._ignoreInCallstackRegExp=e.BrowserWatsonCallstackErrorsToIgnoreRegExp,this.appendHostNameRuleToRegExp(C.a.getHostname(e.ContentBaseUrl)),this.appendHostNameRuleToRegExp(C.a.getHostname(e.StaticContentHost)),this.appendHostNameRuleToRegExp(C.a.getHostname(e.SharedStaticContentHost)),this.appendHostNameRuleToRegExp(C.a.getHostname(e.OneNoteOreoCDNUrl)),this.appendHostNameRuleToRegExp(C.a.getHostname(t)),this._additionalErrorsRegExp=e.BrowserWatsonAdditionalErrorsToReportRegExp,this._healthWorkerErrorsRegExp=e.BrowserWatsonHealthWorkerErrorsToIgnoreRegExp,this._otelErrorsSuppressionEnabled=Boolean.parse(e.OtelLibraryCrashSupressionIsEnabled||"false"),this._otelErrorsRegExp=e.BrowserWatsonOtelErrorsToIgnoreRegExp,this._otelWorkerErrorsRegExp=e.BrowserWatsonOtelWorkerErrorsToIgnoreRegExp,this._skypeErrorsRegExp=e.BrowserWatsonSkypeErrorsToIgnoreRegExp}appendHostNameRuleToRegExp(e){e&&(this._knownHostnamesRegExp=this._knownHostnamesRegExp?this._knownHostnamesRegExp+"|":"",this._knownHostnamesRegExp+="^https?://"+e+"[/:]")}setExceptionCallStack(e){this.callStack=e.stack}onError(e){if(!e)return;const t=e.eventObject;t&&t.message&&-1!==t.message.indexOf("target frame")&&(t.message="Crash related to [Failed to set the 'href' property on] with target frame");try{window.console.error(t.stack)}catch(e){}try{if(this.suppressError(t))return this.processSuppressedError(t),void(I.AFrameworkApplication.reportSuppressedCrashesToWatson&&this.sendCrashErrorReport(t))}catch(e){o.ULS.sendTraceTag(38401685,306,15,"Error while trying to determine if we shuld suppress error or not. Exception: {0}",e)}this._seenError=!0;if(this.sendCrashErrorReport(t),I.AFrameworkApplication.tryReportErrorToTestHarness("null  (no crash messages available in ship)"))return void(this.callStack=null);I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DontStopTaskManagerOnCrashIsEnabled")||I.AFrameworkApplication.theTaskManager.stop(),I.AFrameworkApplication.activeFrame&&I.AFrameworkApplication.activeFrame.thePageManager&&(I.AFrameworkApplication.activeFrame.thePageManager.unregisterDomEvents(),m.FocusManager.usable()&&(m.FocusManager.instance().delegatesEnabled=!1)),I.AFrameworkApplication.isShuttingDown=!0,this.extraOnError(e),this.callStack=null,U._eventSource.raiseEvent(L);let n=21;if(U.browserFeatureDetectionWarningIsEnabled&&!d.a.instance.areBrowserFeaturesSupported&&(n=41),!(I.AFrameworkApplication.suppressCrashReportingToBSqm||this.preventDuplicateBsqmErrors&&U._errorsReportedToBsqm.contains(n)))if(U._errorsReportedToBsqm.add(n),I.AFrameworkApplication.splitCrashError&&41!==n){let e=null;if(I.AFrameworkApplication.reportAdditionCrashProperties){const n=h.a.createExtendedPropertiesMap();n.set("CrashMessage",t.message||"No error message."),n.set("CrashCallstack",t.stack||"No callstack."),e=Object.assign({},{extendedProperties:n})}const a=U.getCrashErrorCode(t);a!==n?(U._errorsReportedToBsqm.add(a),I.AFrameworkApplication.reportError(a,void 0,void 0,e),n=a):I.AFrameworkApplication.reportError(n,void 0,void 0,e)}else I.AFrameworkApplication.reportError(n);I.AFrameworkApplication.theWsaClient&&I.AFrameworkApplication.theWsaClient.uploadWsaData(),I.AFrameworkApplication.suppressCrashDialog||this.showCrashDialog(n)}sendCrashErrorReport(e){if(!I.AFrameworkApplication.suppressCrashReportingToWatson&&this._javascriptErrorReporter){let t="Unknown errorEvent",n="Unable to generate callstack.";try{t=e.message||"No error message",n=this.getCallStackToReport(e,!1)}catch(a){e.message=String.format("Unable to generate callstack. Original message: {0}. New message: {1}.",t,a.message),n=a.stack}o.ULS.sendTraceTag(38081179,306,15,"About to send error report to the server. Error: {0}",t),this._javascriptErrorReporter.sendReport(e,n)}}disableApplication(){_.a.removeAllHandlers(window)}extraOnError(e){}suppressError(e){if(I.AFrameworkApplication.isShuttingDown)return o.ULS.sendTraceTag(39978440,306,15,"Error is suppressed due to the app is shutting down"),!0;if(!this._knownHostnamesRegExp&&!this._additionalErrorsRegExp)return!1;const t=e.source,n=this.callStack||e.stack,a=e.message||"",i=String.format("{0}",e.stackReference),r=this.infoMatchesOurServers(t),s=this.infoMatchesOurServers(n),l=this.infoMatchesHealthWorker(t);let d=!1;this._otelErrorsSuppressionEnabled&&(d=this.infoMatchesOtel(t));const u=this.infoMatchesOtelWorker(t),p=this.infoMatchesSkype(t),g=this.infoMatchesSkype(n),h=!r&&!s,m=p||g,_=this.shouldSuppressAdditionalErrors(a),S=this.shouldSuppressErrorFromCallstack(t,n)||this.shouldSuppressErrorFromCallstack(t,i),f=h||l||d||u||m||_||S,C=c.instance.shouldSuppressError(t,n,a,f,this._knownHostnamesRegExp,this._additionalErrorsRegExp,this._ignoreInCallstackRegExp);return o.ULS.sendTraceTag(579155912,306,50,"DefaultErrorHandler::ShouldSuppressError - sourceCouldBeOurs: {0}, callstackCouldBeOurs: {1}, errorIsHealthWorker: {2}, errorIsOtel: {3}, errorIsOtelWorker: {4}, errorIsSkype: {5}, shouldSuppressAdditionalErrors: {6}, shouldSuppressErrorFromCallstack: {7}, shouldSuppressCustomErrors: {8}, returnVal: {9}",r,s,l,d,u,m,_,S,C,f||C),f||C}infoMatchesOurServers(e){return!e||this.stringMatchesRegExp(e,this._knownHostnamesRegExp)||this.stringMatchesRegExp(e,this._additionalErrorsRegExp)}infoMatchesOtel(e){const t=!!e&&this.stringMatchesRegExp(e.toLowerCase(),this._otelErrorsRegExp);return t&&!this._seenOtelError&&(o.ULS.sendTraceTag(40150101,306,15,"Ignored script error for Otel"),this._seenOtelError=!0),t}infoMatchesOtelWorker(e){const t=!!e&&this.stringMatchesRegExp(e.toLowerCase(),this._otelWorkerErrorsRegExp);return t&&!this._seenOtelWorkerError&&(o.ULS.sendTraceTag(570750363,306,15,"Ignored script error for the OTelJS worker prototype"),this._seenOtelWorkerError=!0),t}infoMatchesHealthWorker(e){const t=!!e&&this.stringMatchesRegExp(e.toLowerCase(),this._healthWorkerErrorsRegExp);return t&&!this._seenHealthWorkerError&&(o.ULS.sendTraceTag(579155913,306,15,"Ignored script error for the Health worker"),this._seenHealthWorkerError=!0),t}infoMatchesSkype(e){const t=!!e&&this.stringMatchesRegExp(e.toLowerCase(),this._skypeErrorsRegExp);return t&&!this._seenSkypeError&&(o.ULS.sendTraceTag(17659039,306,15,"Ignored script error for Skype."),this._seenSkypeError=!0),t}shouldSuppressAdditionalErrors(e){for(const t of U.get_suppressCrashBasedOnMessageList())if(e&&-1!==e.indexOf(t))return U._crashSuppressedBasedOnMessageList.contains(t)||(o.ULS.sendTraceTag(577611074,306,15,"Ignored error with {0}",t),U._crashSuppressedBasedOnMessageList.add(t)),!0;return!(!U.suppressResizeObserverErrorIsEnabled||!this.shouldSuppressFromErrorMessage(e,"ResizeObserver loop"))&&(this._seenResizeObserverError||(o.ULS.sendTraceTag(38290114,306,15,"Ignored script error of {0}}.",e),this._seenResizeObserverError=!0),!0)}shouldSuppressFromErrorMessage(e,t){return!!e&&-1!==e.toLowerCase().indexOf(t.toLowerCase())}shouldSuppressErrorFromCallstack(e,t){return(!e||e.toLowerCase().startsWith(this._pagePath))&&!!t&&this.stringMatchesRegExp(t,this._ignoreInCallstackRegExp)}stringMatchesRegExp(e,t){return!!t&&!!e.match(new RegExp(t,"i"))}processSuppressedError(e){let t="Unknown errorEvent";try{if(t=e.message||"No error message",this._suppressedErrorsReported.length>=10)return;for(let t=0;t<this._suppressedErrorsReported.length;t++)if(e.isSameError(this._suppressedErrorsReported[t]))return;o.ULS.sendTraceTag(5904476,306,15,"Ignored script error. Browser session data: {0}",U.getTraceData(e)),Array.add(this._suppressedErrorsReported,e)}catch(e){o.ULS.sendTraceTag(38401689,306,15,"Exception in ProcessSuppressedError. Exception: {0}",e)}}register(e){if(e&&(I.AFrameworkApplication.theDefaultErrorHandler=this,this._onErrorDelegate=(0,r.a)(this,this.onError,"onError"),e.registerHandler(3,this._onErrorDelegate,null),this._pageManager=e,"undefined"!=typeof _wBST&&"function"==typeof _wBST.rEL))try{_wBST.rEL()}catch(e){o.ULS.sendTraceTag(507537633,306,15,"Exception in Word Boot Error Listener. Exception: {0}",e)}}unregister(){this._pageManager&&(this._pageManager.unregisterHandler(3,this._onErrorDelegate),this._pageManager=null,this._onErrorDelegate=null)}getCallStackToReport(e,t){let n=this.callStack||e.stack;if(n)return t?n:T.a.xmlEncode(n);return function(){return!this}()?(n=b.a.generateStack(1),t?n:T.a.xmlEncode(n)):g.a.generateCallstack(e.stackReference,t,!0)}showCrashDialog(e=21){try{f.a&&(f.a.hide(),f.a.dispose())}catch(e){}{const t=new S.CrashDialog;this.setupCrashDialog(t,e)}}setupCrashDialog(e,t=21){let n=!1;let a="Microsoft Office",i="Sorry, we ran into a problem.",s="Something went wrong",l="Sorry, we ran into a problem. Please try refreshing the page.",c="Sorry, we ran into a problem. Please try again.",u="You can't use Office because your browser isn't supported. Please switch to a supported browser.",p="Exit",g="Restart",h="Refresh";try{a=(0,F.a)("DefaultDialogTitle"),s=(0,F.a)("CrashDialogTitle"),l=(0,F.a)("CrashDialogMessage"),c=(0,F.a)("WordImprovedCrashDialogMessage"),i=(0,F.a)("ErrorDialogMessage"),p=(0,F.a)("ErrorDialogExitName"),g=(0,F.a)("ErrorDialogRestartName"),h=(0,F.a)("ErrorDialogRefreshName"),u=(0,F.a)("UnsupportedBrowserCrashed")}catch(e){o.ULS.sendTraceTag(39321885,306,15,"Failed to get CommonUiStrings. Exception: {0}",e)}I.AFrameworkApplication.theActionManager.getActionMetadata(v.a.close)?I.AFrameworkApplication.suppressRetryFromCrashDialog?(I.AFrameworkApplication.suppressRetryFromCrashDialogMessage&&I.AFrameworkApplication.suppressRetryFromCrashDialogMessage.length>0&&(i=I.AFrameworkApplication.suppressRetryFromCrashDialogMessage),e.buttonsOption=6,e.setButtonText(0,p)):I.AFrameworkApplication.isEmbedded?e.buttonsOption=0:(e.buttonsOption=1,e.setButtonText(0,p)):(o.ULS.sendTraceTag(39125970,306,50,"ShowCrashDialog: Crash shown before Close command loaded."),e.buttonsOption=5,e.hasCloseGlyph=!1),e.setButtonText(1,g),I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsCrashDialogImprovementEnabled")&&(e.buttonsOption=0,e.setButtonText(1,h),e.hasCloseGlyph=!1,a=s,i=l),this.isWordImprovedCrashDialogSettingEnabled()&&(e.buttonsOption=0,e.setButtonText(1,h),e.hasCloseGlyph=!1,i=c);let m=(0,r.a)(this,this.crashDialogHandler,"crashDialogHandler");U.browserFeatureDetectionWarningIsEnabled&&!d.a.instance.areBrowserFeaturesSupported&&(t=41,i=u),I.AFrameworkApplication.clientPermissionDeniedDueToNetworkLocation&&I.AFrameworkApplication.hostOperationHttpStatusCode===A.a.unauthorized_401&&(i=(0,F.a)("ClientPermissionDeniedDueToNetworkLocation"),n=!0),e.showError(t,a,i,m,!1,n,!1)}crashDialogHandler(e,t){if(1===e)if(o.ULS.sendTraceTag(507126869,306,50,"CrashDialogAction: User selected Restart/Refresh option."),window.self.g_instantApp&&I.AFrameworkApplication.activeFrame)I.AFrameworkApplication.activeFrame.refreshDocument(null);else{let e=window.location.href;x.a.logUsage("9gc1i836;ghddf848"),I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RemoveUsidAndCorridFromCrashFrameRequest")?(e=C.a.removeParameter(e,"corrid"),e=C.a.removeParameter(e,"usid"),o.ULS.sendTraceTag(505745742,306,20,"CrashDialogAction: removing usid and corrid from frameRequest to prevent WACSessionID from being reused")):o.ULS.sendTraceTag(506308293,306,10,"CrashDialogAction: Simply refreshing URL. This could cause session ID to be reused"),y.a.openWindow(1,e)}else o.ULS.sendTraceTag(507126868,306,50,"CrashDialogAction: User selected Exit option."),U.closeAppOnErrorWithFailoverToBlank();this.disableApplication(),I.AFrameworkApplication.theUlsHost&&I.AFrameworkApplication.theUlsHost.dispose()}static get_suppressCrashBasedOnMessageList(){if(!U._suppressCrashBasedOnMessageList&&(U._suppressCrashBasedOnMessageList=new s.a,I.AFrameworkApplication.appSettingsManager&&I.AFrameworkApplication.appSettingsManager.containsAppSetting("SuppressCrashBasedOnMessageList"))){const e=I.AFrameworkApplication.appSettingsManager.getListAppSetting("SuppressCrashBasedOnMessageList");for(let t=0;t<e.length;t++)U._suppressCrashBasedOnMessageList.add(e[t])}return U._suppressCrashBasedOnMessageList}static get suppressResizeObserverErrorIsEnabled(){return null==U._suppressResizeObserverErrorIsEnabled&&(U._suppressResizeObserverErrorIsEnabled=!!I.AFrameworkApplication.appSettingsManager&&I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SuppressResizeObserverErrorIsEnabled")),U._suppressResizeObserverErrorIsEnabled}static get browserFeatureDetectionWarningIsEnabled(){return null==U._browserFeatureDetectionWarningIsEnabled&&(U._browserFeatureDetectionWarningIsEnabled=!!I.AFrameworkApplication.appSettingsManager&&(I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BrowserFeatureDetectionIsEnabled")&&I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BrowserFeatureDetectionWarningIsEnabled"))),U._browserFeatureDetectionWarningIsEnabled}static get add_onAfterError(){return w.a.add_onAfterError}static remove_onAfterError(e){U._eventSource.removeHandler(L,e)}static getCrashErrorCode(e){switch(w.a.getCrashErrorName(e?e.error:null)){case"AggregateError":return 50;case"ArgumentError":return 59;case"ArgumentNullError":return 60;case"ArgumentUndefinedError":return 61;case"CommentError":return 58;case"EvalError":return 44;case"FormatError":return 62;case"HierarchyRequestError":return 69;case"IndexSizeError":return 52;case"InternalError":return 51;case"InvalidAccessError":return 56;case"InvalidOperationError":return 63;case"InvalidStateError":return 55;case"NamespaceError":return 70;case"NetworkError":return 54;case"NotFoundError":return 57;case"NotImplementedError":return 64;case"ParameterCountError":return 65;case"QuotaExceededError":return 71;case"RangeError":return 45;case"ReactError":return 66;case"ReferenceError":return 46;case"ScriptError":return 67;case"SecurityError":return 53;case"SyntaxError":return 47;case"TimeoutError":return 68;case"TypeError":return 48;case"URIError":return 49;default:return 21}}static getCrashErrorName(e){try{return U.getCrashErrorNameInternal(e)}catch(e){return o.ULS.sendTraceTag(559982276,306,15,"Exception in GetCrashErrorNameInternal when classifying an error. Exception: {0}",e),"Error"}}static getCrashErrorNameInternal(e){if(!e)return"Error";switch(e.name){case"AggregateError":return"AggregateError";case"CommentError":return"CommentError";case"EvalError":return"EvalError";case"RangeError":case"Sys.ArgumentOutOfRangeException":return"RangeError";case"ReferenceError":return"ReferenceError";case"HierarchyRequestError":return"HierarchyRequestError";case"InternalError":return"InternalError";case"INDEX_SIZE_ERR":case"IndexSizeError":return"IndexSizeError";case"INVALID_ACCESS_ERR":case"InvalidAccessError":return"InvalidAccessError";case"InvalidStateError":return"InvalidStateError";case"NamespaceError":return"NamespaceError";case"NETWORK_ERR":case"NetworkError":return"NetworkError";case"NOT_FOUND_ERR":case"NotFoundError":return"NotFoundError";case"QUOTA_EXCEEDED_ERR":case"QuotaExceededError":return"QuotaExceededError";case"SECURITY_ERR":case"SecurityError":return"SecurityError";case"SYNTAX_ERR":case"SyntaxError":return"SyntaxError";case"Sys.ArgumentException":return"ArgumentError";case"Sys.ArgumentNullException":return"ArgumentNullError";case"Sys.ArgumentUndefinedException":return"ArgumentUndefinedError";case"Sys.FormatException":return"FormatError";case"Sys.InvalidOperationException":return"InvalidOperationError";case"Sys.NotImplementedException":return"NotImplementedError";case"Sys.ParameterCountException":return"ParameterCountError";case"TIMEOUT_ERR":case"TimeoutError":return"TimeoutError";case"TYPE_MISMATCH_ERR":case"TypeMismatchError":case"TypeError":case"Sys.ArgumentTypeException":return"TypeError";case"URIError":return"URIError";default:{const t=e.message;if(t){if(t.toLowerCase().indexOf("react error")>=0)return"ReactError";if(t.toLowerCase().indexOf("script error")>=0)return"ScriptError"}return"Error"}}}static getTraceData(e){const t={};return t.message=e.message,t.line=e.line,e.source&&(t.file=U.getFileTraceData(e.source)),e.stack&&(t.stack=U.getStackTraceData(e.stack)),t}static getFileTraceData(e){if(I.AFrameworkApplication.appSettingsManager&&I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("StripAllQueryParamsFromSuppressedErrorIsEnabled")){let t=C.a.removeAllUrlParameters(e);return e!==t&&(t+="?<Redacted>"),t}return C.a.addOrReplaceParameterValue(e,"fileName","DWITHDRAWN")}static getStackTraceData(e){if(I.AFrameworkApplication.appSettingsManager&&I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("StripAllQueryParamsFromSuppressedErrorIsEnabled")){const t=new RegExp("(\\([^? ]+\\?)([^ ]+)(:\\d+:\\d+\\))","i");return e.replace(t,"$1<REDACTED>$3")}return e}isWordImprovedCrashDialogSettingEnabled(){return I.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsWordImprovedCrashDialogEnabled")}static closeAppOnErrorWithFailoverToBlank(){32!==I.AFrameworkApplication.theActionManager.processActionWithData(v.a.close,2,u.c)&&(o.ULS.sendTraceTag(5878498,201,50,"Failed to execute Close action."),window.location="about:blank")}constructor(){this._suppressedErrorsReported=[],this.callStack=null,this._pageManager=null,this._seenHealthWorkerError=!1,this._seenOtelError=!1,this._seenOtelWorkerError=!1,this._seenSkypeError=!1,this._seenResizeObserverError=!1,this._knownHostnamesRegExp=null,this._additionalErrorsRegExp=null,this._ignoreInCallstackRegExp=null,this._otelErrorsSuppressionEnabled=!1,this._healthWorkerErrorsRegExp=null,this._otelErrorsRegExp=null,this._otelWorkerErrorsRegExp=null,this._skypeErrorsRegExp=null,this._pagePath=null,this._onErrorDelegate=null,this._javascriptErrorReporter=null,this._javascriptErrorReporterFactory=null,this._seenError=!1,this._preventDuplicateBsqmErrors=!1}}U._suppressCrashBasedOnMessageList=null,U._crashSuppressedBasedOnMessageList=new l.a,U._errorsReportedToBsqm=new l.a,U._suppressResizeObserverErrorIsEnabled=null,U._browserFeatureDetectionWarningIsEnabled=null,(0,a.a)(U,"DefaultErrorHandler",null,[73])},2448:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5149),o=n(5018);class r{static get _eventSource(){return r.eventSource}static add_onAfterError(e){r.eventSource.addHandler("OnAfterError",e)}static getCrashErrorName(e){try{return r.getCrashErrorNameInternal(e)}catch(e){return i.ULS.sendTraceTag(559982276,306,15,"Exception in GetCrashErrorNameInternal when classifying an error. Exception: {0}",e),"Error"}}static getCrashErrorNameInternal(e){if(!e)return"Error";switch(e.name){case"AggregateError":return"AggregateError";case"CommentError":return"CommentError";case"EvalError":return"EvalError";case"RangeError":case"Sys.ArgumentOutOfRangeException":return"RangeError";case"ReferenceError":return"ReferenceError";case"HierarchyRequestError":return"HierarchyRequestError";case"InternalError":return"InternalError";case"INDEX_SIZE_ERR":case"IndexSizeError":return"IndexSizeError";case"INVALID_ACCESS_ERR":case"InvalidAccessError":return"InvalidAccessError";case"InvalidStateError":return"InvalidStateError";case"NamespaceError":return"NamespaceError";case"NETWORK_ERR":case"NetworkError":return"NetworkError";case"NOT_FOUND_ERR":case"NotFoundError":return"NotFoundError";case"QUOTA_EXCEEDED_ERR":case"QuotaExceededError":return"QuotaExceededError";case"SECURITY_ERR":case"SecurityError":return"SecurityError";case"SYNTAX_ERR":case"SyntaxError":return"SyntaxError";case"Sys.ArgumentException":return"ArgumentError";case"Sys.ArgumentNullException":return"ArgumentNullError";case"Sys.ArgumentUndefinedException":return"ArgumentUndefinedError";case"Sys.FormatException":return"FormatError";case"Sys.InvalidOperationException":return"InvalidOperationError";case"Sys.NotImplementedException":return"NotImplementedError";case"Sys.ParameterCountException":return"ParameterCountError";case"TIMEOUT_ERR":case"TimeoutError":return"TimeoutError";case"TYPE_MISMATCH_ERR":case"TypeMismatchError":case"TypeError":case"Sys.ArgumentTypeException":return"TypeError";case"URIError":return"URIError";default:{const t=e.message;if(t){if(t.toLowerCase().indexOf("react error")>=0)return"ReactError";if(t.toLowerCase().indexOf("script error")>=0)return"ScriptError"}return"Error"}}}}r.eventSource=new o.a,(0,a.a)(r,"DefaultErrorHandlerStatic",null,[])},7826:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(7112);const i=e=>{a.a.theDefaultErrorHandler&&a.a.theDefaultErrorHandler.setExceptionCallStack(e)}},9800:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5149),o=n(2274);class r{static logUniqueUsage(e){e in this.loggedFlightingTypes||this.logUsage(e)}static logUsage(e){const t=String.format('These flights have impacted the experience: {{"CerberusFlights":"{0}"}}',e);i.ULS.sendTraceTag(572318923,306,50,t),this.loggedFlightingTypes[e]=!0,o.AFrameworkApplication_AppSettingsManager.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogTriggeredFlightsOnSessionEnds")&&!this.hasRegisteredSessionEndsCallback&&this.registerSessionEndsCallback()}static registerSessionEndsCallback(){const e=()=>{i.ULS.sendTraceTag(506017810,306,20,Object.keys(this.loggedFlightingTypes).join(";")),window.removeEventListener("beforeunload",e)};window.addEventListener("beforeunload",e),this.hasRegisteredSessionEndsCallback=!0}}r.loggedFlightingTypes={},r.hasRegisteredSessionEndsCallback=!1,(0,a.a)(r,"ExperimentFlightsUsageLogger",null,[])},4934:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(8555),o=n(5861),r=n(9936);class s extends r.a{static recordKpiHealth(e,t,n,a=null,i=null,r=null){const l=s.getInstance(e);l&&l.logKpiUsage(s.getKpiUsageParams(t));const c=o.a.getTickCount();try{const e=n(),i=s.getKpiSuccessParams(t,o.a.getTickCount()-c,a);return l&&l.logKpiSuccess(i),e}catch(e){let n="";n=r?r(e):e.message;const d=s.getKpiFailureParams(t,n,o.a.getTickCount()-c,a,i);throw l&&l.logKpiFailure(d),e}}static recordKpiHealthPromise(e,t,n,a=null,r=null,l=null){const c=s.getInstance(e);c&&c.logKpiUsage(s.getKpiUsageParams(t));const d=o.a.getTickCount();try{const e=n();return e.then((e=>{const n=s.getKpiSuccessParams(t,o.a.getTickCount()-d,a);return c&&c.logKpiSuccess(n),e})).catch((e=>{let n="UnknownError";l&&e?n=l((0,i.a)(Error,e)):e&&(n=e.toString());const u=s.getKpiFailureParams(t,n,o.a.getTickCount()-d,a,r);c&&c.logKpiFailure(u)})),e}catch(e){let n="";n=l?l(e):e.message;const i=s.getKpiFailureParams(t,n,o.a.getTickCount()-d,a,r);throw c&&c.logKpiFailure(i),e}}static getKpiSuccessParams(e,t=null,n=null){return r.a.getKpiSuccessParams(e,t,n)}}(0,a.a)(s,"ExtendedHealth",r.a,[])},9936:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(5149),o=n(5467),r=n(7449);class s{static getInstance(e){try{return r.a.getExtendedHealthInstance(o.Health.instance,e)}catch(e){return i.ULS.sendExceptionTraceTag(521457890,383,10,e,"Failed to initialize extendedHealth"),null}}static getKpiUsageParams(e,t=null){const n={extendedProperties:s.getExtendedProperties(t)};return{kpiName:e,kpiType:r.b.FailureBased,optionalProperties:n,blockFutureEmissionDurationInMs:3e5}}static getKpiFailureParams(e,t,n=null,a=null,i=null){return{kpiName:e,errorName:t,optionalProperties:{additionalValues:{extendedProperties:s.getExtendedProperties(a),durationMs:n}},optionalVeto:i,blockFutureEmissionDurationInMs:3e5}}static getExtendedProperties(e=null){const t=new Map;return e&&e.forEach(((e,n)=>{t.set(n,e)})),t.has("SkipAria")||t.set("SkipAria","True"),t}static getKpiSuccessParams(e,t=null,n=null){return{kpiName:e,optionalProperties:{additionalValues:{extendedProperties:s.getExtendedProperties(n),durationMs:t}},blockFutureEmissionDurationInMs:3e5}}}(0,a.a)(s,"ExtendedHealthStatic",null,[])},9578:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a,i,o=n(100),r=n(9800),s=n(3245),l=n(5149);!function(e){e[e.CopyLinkFileMenu=0]="CopyLinkFileMenu",e[e.ShareWithPeople=1]="ShareWithPeople",e[e.EmbedThisDocument=2]="EmbedThisDocument",e[e.AlwaysOpenViewOnly=3]="AlwaysOpenViewOnly",e[e.DeleteDocument=4]="DeleteDocument",e[e.Print=5]="Print",e[e.DownloadACopy=6]="DownloadACopy",e[e.DownloadAsPdf=7]="DownloadAsPdf",e[e.DownloadAsPdfWithComments=8]="DownloadAsPdfWithComments",e[e.DownloadAsOdt=9]="DownloadAsOdt",e[e.TransformToWebPage=10]="TransformToWebPage",e[e.SaveToSharePoint=11]="SaveToSharePoint",e[e.SendToKindle=12]="SendToKindle",e[e.PptJewelDownloadACopy=13]="PptJewelDownloadACopy",e[e.PptJewelDownloadACopyAsPdf=14]="PptJewelDownloadACopyAsPdf",e[e.PptJewelDownloadACopyAsOdp=15]="PptJewelDownloadACopyAsOdp",e[e.PptJewelDownloadAsImages=16]="PptJewelDownloadAsImages",e[e.PptJewelSaveToSharePoint=17]="PptJewelSaveToSharePoint",e[e.PptJewelPrintFullSlide=18]="PptJewelPrintFullSlide",e[e.PptJewelPrintHandouts=19]="PptJewelPrintHandouts",e[e.PptJewelPrintNotes=20]="PptJewelPrintNotes"}(a||(a={})),(0,o.b)("FileMenuCommandsForLogging",a),function(e){e[e.SensitivityLabel=0]="SensitivityLabel",e[e.NotTheOwner=1]="NotTheOwner",e[e.ReadOnlyMode=2]="ReadOnlyMode",e[e.EmergencyViewModeBeenDeployed=3]="EmergencyViewModeBeenDeployed",e[e.Miscellaneous=4]="Miscellaneous"}(i||(i={})),(0,o.b)("FileMenuCommandDisabledReason",i);class c{static get fileMenuDisabledButtonsHandlingEnabled(){return null!=c.__cached_fileMenuDisabledButtonsHandlingEnabled_0_669d9cb3?c.__cached_fileMenuDisabledButtonsHandlingEnabled_0_669d9cb3:c.__cached_fileMenuDisabledButtonsHandlingEnabled_0_669d9cb3=(r.a.logUniqueUsage("FileMenuDisabledButtonsHandlingEnabledTF;FileMenuDisabledButtonsHandlingEnabledCF"),(s.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileMenuDisabledButtonsHandlingEnabled",!1)||s.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("DisabledButtonTooltipForFileMenuForWordIsEnabled"))&&s.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&s.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileMenuRedesignIsEnabled",!1))}static logCommandDisabledWithReason(e,t){l.ULS.sendTraceTag(507122015,202,50,`File menu command ${e} is disabled with reason ${t}`)}}(0,o.a)(c,"FileMenuDisabledButtonsHandling",null,[])},121:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8462);class o extends i.a{get ControlType(){return 9}constructor(){super(),this.QueryCommand=null,this.Menu=null,this.PopulateOnlyOnce=!1,this.PopulateQueryCommand=null,this.MenuOpenCommand=null,this.MenuCloseCommand=null,this.ImageIsVisible=!1,this.Toggled=!1,this.ImageUsesSpaceWhileInvisible=!1,this.AriaLabel=null}}(0,a.a)(o,"FlyoutAnchorProps",i.a,[])},1993:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8281);class o extends i.a{get ControlType(){return 8}constructor(){super(),this.Type=0,this.Width=0,this.ElementDimensions=null,this.ExternalGalleryId=null,this.Title=null,this.GalleryItems=null,this.GalleryStyle=null,this.GallerySections=null,this.GalleryContextMenu=null}}(0,a.a)(o,"GalleryProps",i.a,[])},3094:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.IGestureInputManager")},884:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var a=n(100),i=n(625),o=n(3299),r=n(965),s=n(6362),l=n(9858),c=n(5557),d=n(7146),u=n(2274),p=n(2764),g=n(9800),h=n(7726).a;const m="UrlHash",_="SriHash";class S{get isEnabled(){return this._isEnabled}getHashedCommonResourceHost(e){return this._baseCommonResourceDomain?this.getHashedUrl(this._baseCommonResourceDomain,e):null}getHashedAppResourceHost(e){return this._baseAppResourceDomain?this.getHashedUrl(this._baseAppResourceDomain,e):null}getUnusedResourcesOnExit(){if(this._isEnabled&&this._logOnExitIsEnabled){const e=[],t=this._resourceHashMap;for(const n in t){const a={key:n,value:t[n]};this._accessedResources.has(a.key)||e.push(a.key)}if(e.length>0)return e}return null}getVersionedAndNonSRIResourcesOnExit(){if(this._isEnabled&&this._logOnExitIsEnabled){const e=[];let t=0;const n=document.getElementsByTagName("script");for(let a=0;a<n.length;a++){const i=n[a].getAttribute("src");i&&(S._versionedUrlRegEx.exec(i)&&e.push(i.split(new RegExp("[/\\\\]")).pop()),n[a].getAttribute("integrity")||t++)}const a=document.getElementsByTagName("link");for(let n=0;n<a.length;n++){const i=a[n].getAttribute("href");a[n].getAttribute("href")&&(S._versionedUrlRegEx.exec(i)&&e.push(i.split(new RegExp("[/\\\\]")).pop()),a[n].getAttribute("integrity")||t++)}const i={};return i.VersionedResources=e,i.ResourcesWithoutSRI=t,i}return null}updateUrlWithRegexes(e,t){for(const n of t){const t=this.parseUrlWithRegex(e,n);if(t)return t}}parseUrlWithRegex(e,t){const n=t.exec(e);if(n&&n.length>2){const e=n[1];let t=n[2];const a=this.getHashedUrl(e,t);if(a)return d.a.instance.isShippingFrom1JSEnabled&&(t=t.toLowerCase()),a+t}return null}setResourceHashMap(){"undefined"!=typeof ResourceHashJson&&(this._resourceHashMap=ResourceHashJson),this._resourceHashMap||(this._resourceHashMap=r.b(this._appSettingsManager.getStringAppSetting("HashedResourceClientManifest")||"{}"))}getHashedUrlFromVersionedUrl(e){const t=this.updateUrlWithRegexes(e,this._urlParsingRegexList);if(t)return!0===window.__generateLowerCaseStaticResourceUrl?t.toLowerCase():t;if(u.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FallbackToVersionedUrlIsEnabled",!1)){let t;return t=this.isVersionedUrl(e)?e:this.getVersionedUrlFromHashedUrl(e),c.b(508827607,200,50,"ReturnUrl when FallbackToVersionedUrlIsEnabled is true: {0}",t),!0===window.__generateLowerCaseStaticResourceUrl&&(t=t.toLowerCase()),t}return null}rewriteUrlWithSriHashForShipFrom1JS(e,t){const n=S._versionedUrlShippingFrom1JSRegExRegEx.exec(e)??S._hashedUrlShippingFrom1JSRegEx.exec(e);if(n&&n.length>2)return d.a.instance.hasedResourceDomainShippingFrom1JS+t.substring(1)+"/"+n[2]}rewriteUrlWithSriHashForLegacyShipping(e,t){const n=S._versionedUrlRegEx.exec(e)??S._hashedUrlRegEx.exec(e);if(n&&n.length>2)return n[1]+t+"_"+n[2]}isVersionedUrl(e){const t=S._versionedUrlRegEx.exec(e);return!!t&&t.length>2}getVersionedUrlFromHashedUrl(e){const t=S._hashedUrlRegEx.exec(e);return t&&t.length>2?(this._buildVersion=this._buildVersion.replace(".0.","").replace(".",""),t[1]+this._buildVersion+"_"+t[2]):e}getResourceUrlShippingFrom1JS(e){if(!d.a.instance.isShippingFrom1JSEnabled)return null;const t=this.getHashedUrl(null,e);return t?(t+e).toLowerCase():null}getVersionedResourceUrlShippingFrom1JS(e,t,n){const a=t?e+"/"+t:e,i=d.a.instance.resourceShippingFrom1JSVersionedMap[a.toLowerCase()];if(i&&d.a.instance.versionedResourceDomainShippingFrom1JS)return(d.a.instance.versionedResourceDomainShippingFrom1JS+i+"/"+n).toLowerCase()}getHashedUrl(e,t){const n=this.getHashShippingFrom1JS(t,m);if(n)return(d.a.instance.hasedResourceDomainShippingFrom1JS+n+"/").toLowerCase();const a=this.getHash(t,m);return a?e+a+"_":null}getSriHashFromVersionedUrl(e){let t=null;for(const n of this._urlParsingRegexList){const a=n.exec(e);if(a&&a.length>2){t=this.getSriHash(a[2]);break}}return t&&(t="sha256-"+t),t}getSriHash(e){return this._subresourceIntegrityIsEnabled?this.getHashShippingFrom1JS(e,_)??this.getHash(e,_):null}getHashShippingFrom1JS(e,t){if(!d.a.instance.isShippingFrom1JSEnabled||!e||e.endsWith("undefined")||e.endsWith("/"))return null;e=e.toLowerCase();const n=d.a.instance.resourceShippingFrom1JSHashMap[e];if(!n&&this.shouldLogHashFailureForShippingFrom1JS(e))return c.b(507816004,200,10,"getHashShippingFrom1JS failed to find {0} hash for {1}",t,e),null;if(n&&t===m){return h.from(n,"base64").toString("hex").substring(0,16).toLowerCase()}return n&&t===_?n:void 0}shouldLogHashFailureForShippingFrom1JS(e){const t=e.split("/"),n=t[t.length-1];return!n.startsWith("thumbnail_")&&!n.startsWith("acl")}getHash(e,t){if(!this.isEnabled||s.a.isNullOrEmpty(this._resourceHashMap))return null;c.b(592721430,200,50,"Getting {0} for [{1}]",t,e),e=e.toLowerCase();const n=this._resourceHashMap[e];let a=null;if(n){this._logOnExitIsEnabled&&this._accessedResources.add(e);const i=Object.getType(n)===String;return t===_?a=i?n:n[_]:t===m&&(a=i?S.sriHashToUrlHash(n):S.sriHashToUrlHash(n[_])),this._logHashesOnly?(c.b(574993569,200,50,"HashedResourcePathManager LogMode: Would have delivered "+a+" for "+e),null):a}return c.b(591015967,200,50,"Failed to get {0} for [{1}]",t,e),a}getBaseDomainFromVersionedUrl(e){const t=S._baseDomainRegEx.exec(e);return t&&t.length>1?t[1]:null}static sriHashToUrlHash(e){const t=window.self.atob(e);let n="h";for(let e=0;e<8;e++)n+=l.a.padLeft(t.charCodeAt(e).toString(16).toUpperCase(),2,"0");return n}static getLazySingletonInstance(){return new o.a((()=>new S(u.AFrameworkApplication_AppSettingsManager.appSettingsManager)))}static get instance(){return S._singletonInstance.value}getTrustedScriptUrl(e){if(g.a.logUniqueUsage("9d8ii465;fb57i154"),!u.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsAppResourceLoaderTrustedTypesPolicyEnabled",!1))return e;try{return p.b.createScriptURL(e)}catch{const{origin:t}=new URL(e,document.baseURI);return c.b(506012428,200,15,"HashedUrlValidation: TrustedTypes policy does not allow loading URL {0}",t),u.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.HashedResourcePathManagerBlock",!1)?"":e}}constructor(e){if(this._resourceHashMap=null,this._accessedResources=new Set,this._baseCommonResourceDomain=null,this._baseAppResourceDomain=null,this._isEnabled=!1,this._logHashesOnly=!1,this._buildVersion=null,this._logOnExitIsEnabled=!1,this._subresourceIntegrityIsEnabled=!1,this._clientManifestDiagnosticInfoLogged=!1,this.rewriteUrlWithSriHash=(e,t)=>{t.startsWith("sha256-")&&(t=t.substring(7));const n=S.sriHashToUrlHash(t);return d.a.instance.isShippingFrom1JSEnabled?this.rewriteUrlWithSriHashForShipFrom1JS(e,n)??this.rewriteUrlWithSriHashForLegacyShipping(e,n)??null:this.rewriteUrlWithSriHashForLegacyShipping(e,n)??this.rewriteUrlWithSriHashForShipFrom1JS(e,n)??null},this._appSettingsManager=e,this._appSettingsManager){c.b(572905165,200,50,"HashedResourcePathManager: Initializing");try{this._baseCommonResourceDomain=this.getBaseDomainFromVersionedUrl(this._appSettingsManager.getStringAppSetting("SharedStaticContentHost")),this._baseAppResourceDomain=this.getBaseDomainFromVersionedUrl(this._appSettingsManager.getStringAppSetting("StaticContentHost")),this._isEnabled=this._appSettingsManager.getBooleanAppSetting("HashedResourcePathManagerIsEnabled")||d.a.instance.isShippingFrom1JSEnabled,this._logOnExitIsEnabled=this._appSettingsManager.getBooleanAppSetting("HashedResourcePathManagerLogOnExitIsEnabled"),this._logHashesOnly=this._appSettingsManager.getBooleanAppSetting("HashedResourcePathManagerOnlyLogModeIsEnabled"),this._subresourceIntegrityIsEnabled=this._appSettingsManager.getBooleanAppSetting("SubresourceIntegrityIsEnabled"),this._buildVersion=this._appSettingsManager.getStringAppSetting("BuildVersion"),this._resourceHashMap=null,this._urlParsingRegexList=d.a.instance.isShippingFrom1JSEnabled?[S._versionedUrlShippingFrom1JSRegExRegEx,S._hashedUrlShippingFrom1JSRegEx,S._legacyHashedUrlShippingFrom1JSRegEx,S._versionedUrlRegEx,S._hashedUrlRegEx]:[S._versionedUrlRegEx,S._hashedUrlRegEx,S._versionedUrlShippingFrom1JSRegExRegEx,S._hashedUrlShippingFrom1JSRegEx,S._legacyHashedUrlShippingFrom1JSRegEx],this._isEnabled&&(c.b(572905166,200,50,"HashedResourcePathManager: Enabled"),this.setResourceHashMap(),!s.a.isNullOrEmpty(this._resourceHashMap)||d.a.instance.isShippingFrom1JSEnabled?(window.g_versionedUrlHashFunction=(0,i.a)(this,this.getHashedUrlFromVersionedUrl,"getHashedUrlFromVersionedUrl"),window.g_urlIntegrityFunction=(0,i.a)(this,this.getSriHashFromVersionedUrl,"getSriHashFromVersionedUrl"),window.g_urlHashRewriteFunction=this.rewriteUrlWithSriHash,window.g_hashedUrlTrustedTypesValidationFunction=this.getTrustedScriptUrl):u.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FallbackToVersionedUrlIsEnabled",!1)?(window.g_versionedUrlHashFunction=(0,i.a)(this,this.getHashedUrlFromVersionedUrl,"getHashedUrlFromVersionedUrl"),c.b(508691924,200,15,"Registering g_versionedUrlHashFunction even when client resource hash is invalid")):c.b(574993568,200,15,"Client resource hash manifest is invalid"))}catch(e){c.b(592721431,200,15,"Could not deserialize client resource hash manifest. exception: {0}",e.message),this._resourceHashMap=null}}else this._isEnabled=!1}}S._baseDomainRegEx=new RegExp("^(.+/)\\d+_$"),S._versionedUrlRegEx=new RegExp("^(.+/)\\d+_(.+)$"),S._hashedUrlRegEx=new RegExp("^(.+/)h\\w+?_(.+)$"),S._legacyHashedUrlShippingFrom1JSRegEx=new RegExp("^(.+/)h\\w+?_(?:.+)/(.+)$"),S._versionedUrlShippingFrom1JSRegExRegEx=new RegExp("^(.+\\d+_.*)/(.+)$"),S._hashedUrlShippingFrom1JSRegEx=new RegExp("^(.+hashed/)\\w+/(.+)$"),S._singletonInstance=S.getLazySingletonInstance(),(0,a.a)(S,"HashedResourcePathManager",null,[])},5467:function(e,t,n){"use strict";n.r(t),n.d(t,{Health:function(){return l}});var a=n(100),i=n(5149),o=n(8216),r=n(7449),s=n(3245);class l{static get instance(){return l.getInstance()}static getInstance(){let e=!1;if(!l._singleton){i.ULS.sendTraceTag(557973774,383,50,"Initializing small Health package from ScriptSharp");try{const t=!!o.a.disabledHealthEvents&&o.a.disabledHealthEvents.length>0,n=t?new Set:null;if(t){const e=o.a.disabledHealthEvents.split(",");for(const t of e)t.length>0&&n.add(t)}s.AFrameworkApplication.appSettingsManager&&s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.HealthPolicyMonitoring",!1)&&(e=!0);const a={isHealthEnabled:o.a.isHealthTelemetrySystemEnabled,isErrorPartCEnabled:o.a.isErrorPartCEnabled,remoteTelemetryUrl:o.a.remoteTelemetryUrl,heartbeatIntervalMs:o.a.heartbeatIntervalMs,recordPillarToWarmPipelineIntervalMs:o.a.recordQosPillarToWarmPipelineIntervalMs,loggerMaxQueueSize:o.a.loggerMaxQueueSize,loggerMaxIntervalMs:o.a.loggerMaxIntervalMs,maxConcurrentRetries:o.a.maxConcurrentRetries,retryDelayMs:o.a.retryDelayMs,retryMaxAttempts:o.a.retryMaxAttempts,dimensions:o.a.getSessionDimensions(),disabledHealthEvents:n,isOfflineEnabled:o.a.shouldUseOfflineWorker,offlineWorkerUrl:o.a.smallOfflineWorkerUrl,absoluteRemoteTelemetryUrlForOfflineWorker:o.a.absoluteRemoteTelemetryUrlForOfflineWorker,isFetchApiEnabled:o.a.isFetchApiEnabled,TrustedTypesPolicy:e};if(!a.dimensions)throw Error.argumentNull("healthConfig.dimensions");l.setInstance(r.a.getHealthInstance(a))}catch(e){throw i.ULS.sendTraceTag(557973775,383,10,"Failed to initialize health small: "+e),e}}return l._singleton}static setInstance(e){if(!e)throw Error.argumentNull("health");l._singleton=e}}l._singleton=null,(0,a.a)(l,"Health",null,[])},8384:function(e,t,n){"use strict";n.r(t),n.d(t,{HealthConnectivityListener:function(){return s}});var a=n(100),i=n(5149),o=n(5467),r=n(8216);class s{networkDisconnected(){i.ULS.sendTraceTag(579393666,383,50,"Lost connection to the internet. Health 2.0 events will be stored on IndexedDB until the connection is restored"),o.Health.instance.setIsAppOnline(!1),r.a.isAppOnline=!1}networkResumed(){i.ULS.sendTraceTag(579393667,383,50,"Connection restored. Any events in our IndexedDB database will now be flushed"),o.Health.instance.setIsAppOnline(!0),r.a.isAppOnline=!0}}(0,a.a)(s,"HealthConnectivityListener",null,[295])},8216:function(e,t,n){"use strict";n.d(t,{a:function(){return m}});var a=n(100),i=n(3792),o=n(4182),r=n(5149),s=n(8555),l=n(6915),c=n(9969),d=n(1163),u=n(1600),p=n(7449),g=n(734),h=n(3245);class m{static getSessionDimensions(){if(!h.AFrameworkApplication.appSettingsManager||!h.AFrameworkApplication.sessionStartInfoSettings)return r.ULS.sendTraceTag(589825177,383,10,"AppSettingsManager is null so we can't initialize the session dimensions"),null;let e=(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.Os);if(e){const t=(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.OsVersion);t&&(e+="("+t+")")}m.healthDimensionsIncludesUserLicenseType=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HealthDimensionsIncludesUserLicenseType");const t={application:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.Application)||"",applicationLcid:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.ApplicationLCID)||"",applicationMode:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.ApplicationMode)||"",applicationModeExtended:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.ApplicationModeExtended)||"",arrVersion:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.ARRVersion)||"",browser:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.Browser)||"",browserLcid:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.BrowserLCID)||"",browserMajorVersion:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.BrowserMajorVersion)||"",browserVersion:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.BrowserVersion)||"",clientVersion:h.AFrameworkApplication.buildVersion,datacenter:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)||"",dataCulture:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.DataCulture)||"",fileExtension:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.FileExtension)||"",flightsImpressionId:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.FlightsImpressionId)||"",host:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.Host)||"",isAnonymousUser:h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"),isBusinessUser:!!h.AFrameworkApplication.sessionStartInfoSettings.IsBusinessUser,isEduUser:!!h.AFrameworkApplication.sessionStartInfoSettings.IsEduUser,isSynthetic:Boolean.parse((0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.IsSynthetic)||"false"),loggableUserId:h.AFrameworkApplication.appSettingsManager.getStringAppSetting("LoggableUserId")||"",loggableUserIdSpace:h.AFrameworkApplication.appSettingsManager.getStringAppSetting("LoggableUserIdSpace")||"",osVersion:e||"",ring:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.Ring)||"-1",serverDocId:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.ServerDocId)||"",session_id:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.WACSessionID)||"",sessionOrigin:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.SessionOrigin)||"",tenantId:h.AFrameworkApplication.appSettingsManager.getStringAppSetting("TenantId")||"",uiHost:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.UiHost)||"",uiHostIntegrationType:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.UiHostIntegrationType)||"",wfeVersion:(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.WFEVersion)||"",allowEarlyFeatures:h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AllowEarlyFeatures")};if(h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NetworkInformationIsEnabled")){const e=d.a.networkInformation;Object.assign(t,{networkDownlink:e.downlink,networkDownlinkMax:e.downlinkMax,networkEffectiveType:e.effectiveType||"",networkRTT:e.rtt,networkSaveData:e.saveData,networkType:e.type||""})}return m.healthDimensionsIncludesUserLicenseType&&(m.setUserLicenseType(),Object.assign(t,{userLicenseType:m.userLicenseType})),t}static initialize(){const{Health:e}=n(5467);try{if(!h.AFrameworkApplication.appSettingsManager)return void r.ULS.sendTraceTag(42554066,383,10,"AppSettingsManager is null so couldn't fully initialize Health.");if(m.isHealthTelemetrySystemEnabled=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HealthTelemetrySystemIsEnabled"),m.isHealthTelemetrySystemEnabled){m.isErrorPartCEnabled=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HealthIsErrorPartCEnabled"),m.shouldUseOfflineWorker=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HealthUseOfflineWorker"),m.smallOfflineWorkerUrl=h.AFrameworkApplication.appSettingsManager.getStringAppSetting("HealthSmallOfflineWorkerScriptUrl"),m.remoteTelemetryUrl=h.AFrameworkApplication.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl"),m.isFetchApiEnabled=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HealthUsesFetchApi");const t=new l.a(m.remoteTelemetryUrl);h.AFrameworkApplication.addCommonUrlParameters(t),m.remoteTelemetryUrl=t.toString(),m.absoluteRemoteTelemetryUrlForOfflineWorker=c.a.getAbsoluteUrl(m.remoteTelemetryUrl),m.heartbeatIntervalMs=h.AFrameworkApplication.appSettingsManager.getIntAppSetting("HealthTelemetrySystemHeartbeatIntervalMs",3e5),m.recordQosPillarToWarmPipelineIntervalMs=h.AFrameworkApplication.appSettingsManager.getIntAppSetting("HealthTelemetrySystemRecordQosPillarToWarmPipelineIntervalMs",864e5),m.loggerMaxQueueSize=h.AFrameworkApplication.appSettingsManager.getIntAppSetting("HealthTelemetrySystemLoggerMaxQueueSize",25),m.loggerMaxIntervalMs=h.AFrameworkApplication.appSettingsManager.getIntAppSetting("HealthTelemetrySystemLoggerMaxIntervalMs",3e4),m.maxConcurrentRetries=h.AFrameworkApplication.appSettingsManager.getIntAppSetting("HealthMaxConcurrentRetries",3),m.retryDelayMs=h.AFrameworkApplication.appSettingsManager.getIntAppSetting("HealthRetryDelayMs",15e3),m.retryMaxAttempts=h.AFrameworkApplication.appSettingsManager.getIntAppSetting("HealthRetryMaxAttempts",3),m.disabledHealthEvents=h.AFrameworkApplication.appSettingsManager.getStringAppSetting("HealthDisabledEventsCommaSeparated")||"";const n=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsHostTopologyEnabled"),a=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsComplianceRegionEnabled"),i=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsFlightInformationEnabled"),o=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsFlightInformationOnAllEventsEnabled"),r=(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.Application)||"";if(e.instance){if(e.instance.setHandlerForIsAppShuttingDown((()=>h.AFrameworkApplication.isShuttingDown)),e.instance.addOrUpdatePartCDimension("FileSizeBucket",(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.FileSizeBucket)||""),"Word"===r&&e.instance.addOrUpdatePartCDimension("IsDotNetBoot",(h.AFrameworkApplication.sessionStartInfoSettings.IsDotNetBoot??!1).toString()),e.instance.addOrUpdatePartCDimension("IsMeetingLiveSession",h.AFrameworkApplication.isMeetingLiveSession.toString()),e.instance.addOrUpdatePartCDimension("HostSessionId",(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.HostSessionId)||""),e.instance.addOrUpdatePartCDimension("HostDatacenterHint",(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.HostDatacenterHint)||""),e.instance.addOrUpdatePartCDimension("LocationCountry",(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.LocationCountry)||""),e.instance.addOrUpdatePartCDimension("EdgeEnvironmentName",(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.EdgeEnvironmentName)||""),e.instance.addOrUpdatePartCDimension("EdgeEventId",(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.EdgeEventId)||""),e.instance.addOrUpdatePartCDimension("DeviceName",(0,s.a)(String,h.AFrameworkApplication.sessionStartInfoSettings.DeviceName)||""),"OneNote"!==r&&"Visio"!==r||e.instance.addOrUpdatePartCDimension("IsOcsSession","false"),n){const t=u.d(h.AFrameworkApplication.dataPlumber);t&&t.length>0&&e.instance.addOrUpdatePartCDimension("HostTopology",t)}if("Word"===r&&a){const t=h.AFrameworkApplication.sessionStartInfoSettings.RequestedComplianceRegion;t&&t.length>0&&e.instance.addOrUpdatePartCDimension("ComplianceRegion",t)}if(i){const t=h.AFrameworkApplication.get_flights();o?e.instance.addOrUpdatePartCDimension("Flights",JSON.stringify(t)):e.instance.addOrUpdateErrorPartCDimension("Flights",JSON.stringify(t))}if("Excel"===r){const t=u.b(h.AFrameworkApplication.dataPlumber);e.instance.addOrUpdatePartCDimension("ActiveCoauth",t);const n=u.c(h.AFrameworkApplication.dataPlumber);e.instance.addOrUpdatePartCDimension("HostProtocol",n);const a=u.a(h.AFrameworkApplication.dataPlumber);e.instance.addOrUpdatePartCDimension("AccessType",a)}}e.instance.addQosPillar(g.a[g.a.Open]),e.instance.addQosPillar(g.a[g.a.Interruptions]),e.instance.addQosPillar(g.a[g.a.bSqmCompatibility]),e.instance.addQosPillar(g.a[g.a.ContentConsumption]),"Word"!==r&&"PowerPoint"!==r||e.instance.addQosPillar(g.a[g.a.Fidelity]),m.errorIDAlreadyReported={},h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HealthTelemetrySystemPartAUpdateAfterFullSettingsIsEnabled")&&(h.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady?m.onFullAppSettingsReady():h.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady(m.onFullAppSettingsReady))}m.registerEvents()}catch(e){r.ULS.sendTraceTag(50677138,383,15,"Failed to initialize the health telemetry system: "+e),m.isHealthTelemetrySystemEnabled=!1}}static onFullAppSettingsReady(){const{Health:e}=n(5467);e.instance&&(e.instance.updatePartADimensions({isAnonymousUser:h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"),loggableUserId:h.AFrameworkApplication.appSettingsManager.getStringAppSetting("LoggableUserId")||"",loggableUserIdSpace:h.AFrameworkApplication.appSettingsManager.getStringAppSetting("LoggableUserIdSpace")||"",tenantId:h.AFrameworkApplication.appSettingsManager.getStringAppSetting("TenantId")||""}),e.instance&&m.healthDimensionsIncludesUserLicenseType&&(m.setUserLicenseType(),e.instance.updatePartADimensions({userLicenseType:m.userLicenseType})),m.logSessionKpi("SessionReady"))}static logSessionKpi(e){const{Health:t}=n(5467);if(h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsSessionLifecycleKpisLoggingEnabled")){const n=h.AFrameworkApplication.get_flights(),a=m.createExtendedPropertiesMap();if(a){const i=h.AFrameworkApplication.appSettingsManager.getStringAppSetting("SessionLifecycleKpisOwningFcAlias")||"wordwebsxfc";a.set("AreaName","Infrastructure"),a.set("FeatureName","Session"),a.set("Flights",JSON.stringify(n)),a.set("SkipAria","True"),t.instance.recordKpiUsage(e,p.b.FailureBased,i,a)}}}static createExtendedPropertiesMap(){try{return new Map}catch(e){return null}}createExtendedPropertiesMap(){return m.createExtendedPropertiesMap()}static addConnectivityListener(e){const{HealthConnectivityListener:t}=n(8384);m.shouldUseOfflineWorker&&(e?(e.addNetworkConnectivityListener(new t),r.ULS.sendTraceTag(579187396,383,50,"Added HealthConnectivityListener to TheClientRequestManager")):r.ULS.sendTraceTag(579393665,383,15,"AFrameworkApplication.TheClientRequestManager is null, so we can't listen for connectivity changes"))}static onAppSleepHandler(e,t){const{Health:a}=n(5467);r.ULS.sendTraceTag(594616329,383,50,"App going to sleep, pausing health heartbeat"),m.logSessionKpi("SessionSuspended"),a.instance.stopAllHealthTimers()}static onAppWakeupHandler(e,t){const{Health:a}=n(5467);r.ULS.sendTraceTag(594616328,383,50,"App waking up, resuming health heartbeat"),m.logSessionKpi("SessionResumed"),a.instance.resumeAllHealthTimers()}static registerEvents(){h.AFrameworkApplication.add_appSleep(m.onAppSleepHandler),h.AFrameworkApplication.add_appWakeup(m.onAppWakeupHandler)}static recordBSqmQosError(e,t=null,a=null,i=null){const{Health:o}=n(5467);if(m.isHealthTelemetrySystemEnabled)try{if(m.errorIDAlreadyReported){if(e in m.errorIDAlreadyReported)return void r.ULS.sendTraceTag(595353998,383,50,"Not reporting errorID "+e+" again.");m.errorIDAlreadyReported[e]=1}if(t){const n=t.processBsqmQosError(e,a,i);o.instance.recordBsqmQosError(e,n.additionalVetos,n.additionalValues)}else o.instance.recordBsqmQosError(e,a,i)}catch(e){r.ULS.sendTraceTag(50931779,383,15,"Exception in RecordBSqmQosError occurred: "+e)}}static setUserLicenseType(){const e=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"),t=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost"),n=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost");if(t)m.userLicenseType="Commercial_Unknown";else if(n){if(e)return void(m.userLicenseType="Anonymous_Unknown");(0,i.h)(o.a).execute((e=>{e.isFeatureEnabled("MsoPremiumBadge",!1).then((e=>(m.userLicenseType=e?"Consumer_Paid":"Consumer_Free",null)))}))}}}m.isHealthTelemetrySystemEnabled=!1,m.isErrorPartCEnabled=!1,m.isAppOnline=!0,m.shouldUseOfflineWorker=!1,m.smallOfflineWorkerUrl="",m.remoteTelemetryUrl="",m.absoluteRemoteTelemetryUrlForOfflineWorker="",m.heartbeatIntervalMs=3e5,m.recordQosPillarToWarmPipelineIntervalMs=864e5,m.loggerMaxQueueSize=25,m.loggerMaxIntervalMs=3e4,m.maxConcurrentRetries=3,m.retryDelayMs=15e3,m.retryMaxAttempts=3,m.disabledHealthEvents="",m.isFetchApiEnabled=!1,m.errorIDAlreadyReported=null,m.userLicenseType="TBD",(0,a.a)(m,"HealthUtilsImpl",null,[])},5385:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.IActionContextProvider")},4153:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.IAppSpecificFeedbackData")},9223:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(3792);const i=(0,a.b)("Common.IDynamicScriptLoaderProvider"),o=(0,a.e)(i)},6798:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.IMacOfficeOffer")},8135:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(3792),i=n(2113),o=n(5115);const r=(0,a.e)(o.a,{onDemandSingleton:e=>new i.a})},5115:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.OAuth.IOAuthManager")},6677:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.IOfficeTrialExperience")},451:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.ISessionExpirationManagerWithDialog")},502:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.ISystemInitiatedFeedback")},2739:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.OAuth.ITokenRefreshManager")},6487:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.IZoomManager")},5374:function(e,t,n){"use strict";n.d(t,{a:function(){return r},b:function(){return p},c:function(){return u},d:function(){return o}});var a=n(6776),i=n(6124);const o="wv",r=(e,t,n,i,o,r)=>s(e,t,n,a.AFrameworkApplicationConstants.imageClusterName,a.AFrameworkApplicationConstants.imageClusterPath,i,null,o,r),s=(e,t,n,a,i,o,r,s,c,d=null)=>l(e,t,p(a,n),i,o,r,s,c,d),l=(e,t,n,a,i,o,r,s,l=null,u=null)=>{const p=c(l,"span"),g=String.format("clip{0}x{1}",e.toString(),t.toString());return p.className=i?i+" "+g:g,p.setAttribute("Unselectable","on"),p.style.zIndex="0",r&&(p.style.display="inline-block"),u||(u=d(n,a,i,o,s,l)),p.appendChild(u),p},c=(e,t)=>(e||window.document).createElement(t),d=(e,t,n,a,o,r=null)=>{const s=c(r,"img");return s.className=a?a+" "+e:e,s.setAttribute("Unselectable","on"),s.setAttribute(i.a.ariaRoleAttribute,i.a.ariaPresentationRole),s.src=t,o&&(s.alt=o,s.title=o),s},u=e=>String.format("{0}_{1}",a.AFrameworkApplicationConstants.imageClusterName,e),p=(e,t)=>String.format("{0}_{1}",e,t)},9531:function(e,t,n){"use strict";n.d(t,{a:function(){return l}});var a=n(100),i=n(7531),o=n(2929),r=n(9865),s=n(680);class l extends i.a{registerHandler(e,t,n){this._eventHandlerManager.registerHandler(e,t,2,this.onEvent,n,null)}unregisterHandler(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)}static get instance(){return l._instance||(l._instance=new l),l._instance}static disposeInputManager(){s.a.safeDispose(l._instance)}constructor(){super(),this.onEvent=(e,t,n)=>{const a=o.a.getSourceElement(n),r=new o.a(e,a,n,0),s=this._eventHandlerManager.processEvent(e,t,r);return s&&i.a.cancelEvent(n),s},this._eventHandlerManager=r.EventHandlerManager.instance}}l._instance=null,(0,a.a)(l,"BasicInputManager",i.a,[])},6601:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(2929),o=n(1163);class r extends i.a{get action(){return this.eventName}get mouseButton(){return this._button}get clientPoint(){return this._client}get screenPoint(){return this._screen}get elementPoint(){return this._element||(this._element=i.a.getElementPoint(this._client,this.sourceElement)),this._element}get caughtElement(){return this._caught}get shiftKey(){return this._shiftKey}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get commandKey(){return o.a.isMac?this._metaKey:this._ctrlKey}static createFromMouseEvent(e,t,n,a,o){if(a.rawEvent){const s=a.rawEvent,l=i.a.getSourceElement(a),c=new Sys.UI.Point(s.clientX,s.clientY),d=new Sys.UI.Point(s.screenX,s.screenY);return new r(e,i.a.getMouseButton(s),c,null,d,l,t,s.shiftKey,s.altKey,s.ctrlKey,s.metaKey,n,a,o)}{const i=a.target,s=new Sys.UI.Point(a.clientX,a.clientY),l=new Sys.UI.Point(a.screenX,a.screenY),c=!1;return new r(e,a.button,s,null,l,i,t,a.shiftKey,a.altKey,a.ctrlKey,c,n,a,o)}}static createFromTouchArgs(e){const t=e.innerEvent.rawEvent;let n=!1,a=!1,i=!1,o=!1;return t?(n=t.shiftKey,a=t.altKey,i=t.ctrlKey,o=t.metaKey):(n=e.innerEvent.shiftKey,a=e.innerEvent.altKey,i=e.innerEvent.ctrlKey),new r(e.eventName,Sys.UI.MouseButton.leftButton,e.clientPoint,e.elementPoint,e.screenPoint,e.sourceElement,e.caughtElement,n,a,i,o,e.userData,e.innerEvent,3)}static changeUserData(e,t){e.userData=t}constructor(e,t,n,a,i,o,r,s,l,c,d,u,p,g){super(e,o,p,g),this._client=n,this._element=a,this._screen=i,this._caught=r,this._button=t,this._shiftKey=s,this._altKey=l,this._ctrlKey=c,this._metaKey=d,this.userData=u}}(0,a.a)(r,"ClickEventArgs",i.a,[])},8585:function(e,t,n){"use strict";n.d(t,{a:function(){return T}});var a=n(100),i=n(7531),o=n(6601),r=n(7939),s=n(9865),l=n(6012),c=n(629),d=n(794),u=n(2604),p=n(8817),g=n(6580),h=n(5976),m=n(4706),_=n(657),S=n(6094),f=n(680),C=n(7958),y=n(1163),A=n(3245),b=n(9800);class T extends i.a{get doubleTapFixEnabled(){return null!=this.__cached_doubleTapFixEnabled_0_f08deea5?this.__cached_doubleTapFixEnabled_0_f08deea5:this.__cached_doubleTapFixEnabled_0_f08deea5=A.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TouchClickAdapterDoubleTapFix",!1)??!1}get doubleTapIsEnabled(){return null!=this.__cached_doubleTapIsEnabled_1_f08deea5?this.__cached_doubleTapIsEnabled_1_f08deea5:this.__cached_doubleTapIsEnabled_1_f08deea5=A.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("SelectWordOnDoubleTapIsEnabled")??!1}get inTouchClick(){return this._inTouchClick}get clickStartedOutsideCanvas(){return this._clickStartedOutsideCanvas}set clickStartedOutsideCanvas(e){this._clickStartedOutsideCanvas=e}initializeForElement(e){super.initializeForElement(e),this._eventHandlerManager.initializeListForElement(l.a.clickEvents,e,2,this.onClickEvent)}deinitializeForElement(e){super.deinitializeForElement(e),this._eventHandlerManager.deinitializeListForElement(e,l.a.clickEvents)}registerHandler(e,t,n){this.registerHandlerWithBrowserClickOption(e,t,n,null,!1)}registerHandlerWithData(e,t,n,a){this.registerHandlerWithBrowserClickOption(e,t,n,a,!1)}registerHandlerWithBrowserClickOption(e,t,n,a,i){this.registerHandlerWithCaptureOption(e,t,n,a,i,!1)}registerHandlerWithCaptureOption(e,t,n,a,i,o=!1){this._eventHandlerManager.registerHandler(e,t,2,this.onClickEvent,n,a,o),i||(this._eventHandlerManager.initializeForElementInternal(l.a.touchStart,t,2,this.onTouchEvent,o),this._eventHandlerManager.initializeForElementInternal(l.a.touchMove,t,2,this.onTouchEvent,o),this._eventHandlerManager.initializeForElementInternal(l.a.touchEnd,t,2,this.onTouchEvent,o))}unregisterHandler(e,t,n){this.unregisterHandlerWithBrowserClickOption(e,t,n,!1)}unregisterHandlerWithBrowserClickOption(e,t,n,a){this.unregisterHandlerWithCaptureOption(e,t,n,a,!1)}unregisterHandlerWithCaptureOption(e,t,n,a,i=!1){this._eventHandlerManager.unregisterHandler(e,t,n,i),a||(this._eventHandlerManager.deinitializeForElementInternal(t,l.a.touchStart,i),this._eventHandlerManager.deinitializeForElementInternal(t,l.a.touchMove,i),this._eventHandlerManager.deinitializeForElementInternal(t,l.a.touchEnd,i))}registerDefaultHandler(e,t,n){for(let a=0;a<l.a.clickEvents.length;++a)l.a.isInternalEvent(l.a.clickEvents[a])||this._eventHandlerManager.registerHandler(l.a.clickEvents[a],e,3,this.onClickEvent,t,n)}unregisterDefaultHandler(e,t){for(let n=0;n<l.a.clickEvents.length;++n)l.a.isInternalEvent(l.a.clickEvents[n])||this._eventHandlerManager.unregisterHandler(l.a.clickEvents[n],t,e)}processClick(e,t,n){if(!this.isEnabled)return!1;if(!S.a.isValidElement(e.sourceElement))return!1;if(_.TaskManager.instance.isYielding)return!1;if(this._supressEvents)return this.cancelClick(e),!0;if(this.clickStartedOutsideCanvas)return this.clickStartedOutsideCanvas=!1,!0;let a=!1;if(this._capturedHandler)return e.userData=this._capturedHandler.userData,a=this._capturedHandler.handler(e),a&&this.cancelClick(e),a;if(n){if(s.EventHandlerManager.instance.isDragging)return this.cancelClick(e),!0;a=this._eventHandlerManager.processEvent(l.a.doubleClick,e.caughtElement,e)}else t&&(this._eventHandlerManager._lastClickEventTime=(new Date).getTime(),a=this._eventHandlerManager.processEvent(l.a.click,e.caughtElement,e));return a&&this.cancelClick(e),a}cancelClick(e){let t=!0;3===e.inputSource&&C.a.isTextField(e.sourceElement)&&(t=!1),i.a.cancelEventInternal(e.innerEvent,t)}capture(e,t){this._capturedHandler=new r.a(e,t)}releaseCapture(){this._capturedHandler=null}addFocusEvent(e,t,n=!1){const a=t=>(!t.sourceElement.disabled&&this._focusManager&&this._focusManager.scopeChanged(e),!1);this.registerHandlerWithBrowserClickOption(l.a.click,t,a,null,n),this._focusManager.getScope(e).addDispose((()=>{this.unregisterHandler(l.a.click,t,a)}))}static get instance(){return T._instance||(T._instance=new T),T._instance}static disposeInputManager(){f.a.safeDispose(T._instance),T._instance=null}constructor(){super(),this._capturedHandler=null,this._clickStartedOutsideCanvas=!1,this._currentTouchEvent=null,this._previousTouchEventArgs=null,this._doubleTapDetected=!1,this._inTouchClick=!1,this.onClickEvent=(e,t,n)=>{let a=this.inTouchClick?3:2;y.a.isIPad&&(a=3);const i=o.a.createFromMouseEvent(e,t,null,n,a),r=e===l.a.click,s=e===l.a.doubleClick;return this.processClick(i,r,s)},this.onTouchEvent=(e,t,a)=>{b.a.logUniqueUsage("cd716272;387e4477");const i=h.a.create(e,t,null,a),o=p.a.getTouchClickAdapter(t);if(a&&m.a.isOneNoteInkingImprovementsEnabled(a.target))return!0;if(m.a.isMultiTouch(a))return o.cancelPendingClick(),!1;if(t.disabled)return!1;let r=new g.a;if(e===l.a.touchStart)o.onTouchStart(i,this._previousTouchEventArgs);else if(e===l.a.touchMove)o.onTouchMove(i);else if(e===l.a.touchEnd){if(this.doubleTapFixEnabled&&this.doubleTapIsEnabled&&this._currentTouchEvent?.innerEvent.rawEvent!==i.innerEvent.rawEvent&&(this._doubleTapDetected?(this._previousTouchEventArgs=null,this._doubleTapDetected=!1):this._previousTouchEventArgs=this._currentTouchEvent,this._currentTouchEvent=i),r=o.onTouchEnd(i,this._previousTouchEventArgs),r.isTouchClick||r.isTouchDoubleClick){this._eventHandlerManager.temporarilyDisableBrowserClicks();if(u.a.getTouchAndHoldAdapter(i.sourceElement).cancelTouchAndHoldIfNecessary(i),this.doubleTapFixEnabled&&this.doubleTapIsEnabled)this._doubleTapDetected=r.isTouchDoubleClick;else{n(3245).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SelectWordOnDoubleTapIsEnabled")&&a.rawEvent&&(r.isTouchDoubleClick?this._previousTouchEventArgs=null:this._previousTouchEventArgs=i)}}}else e===l.a.touchCancel&&o.onTouchCancel(i);if(r.isTouchClick||r.isTouchDoubleClick){this._inTouchClick=!0;const e=this.processClick(r.clickArgs,r.isTouchClick,r.isTouchDoubleClick);return this._inTouchClick=!1,e}return!1},this.onMsPointerDown=e=>{this._inTouchClick=2===d.a(e)},this._eventHandlerManager=s.EventHandlerManager.instance,this._focusManager=c.FocusManager.instance(),s.EventHandlerManager.instance.registerOnBeforeEventProcessed(l.a.msPointerDown,this.onMsPointerDown),s.EventHandlerManager.instance.registerOnBeforeEventProcessed(l.a.browserPointerDown,this.onMsPointerDown)}}T._instance=null,(0,a.a)(T,"ClickInputManager",i.a,[84,83,11])},6808:function(e,t,n){"use strict";n.d(t,{a:function(){return C}});var a=n(100),i=n(3792),o=n(3094),r=n(7531),s=n(2929),l=n(6012),c=n(1163);class d extends s.a{get clientPoint(){return this._clientPoint}set trackingData(e){this._trackingData=e}get trackingData(){return this._trackingData}set activeCellChangedBetweenMouseDownAndMouseUp(e){this._activeCellChangedBetweenMouseDownAndMouseUp=e}get activeCellChangedBetweenMouseDownAndMouseUp(){return this._activeCellChangedBetweenMouseDownAndMouseUp}static create(e,t,n){t.rawEvent;let a,i;if(e===l.a.touchContextMenu)a=3,i=s.a.getClientPointFromTouchEvent(t);else{0;const e=t.rawEvent;a=n,i=c.a.isMac||!e?new Sys.UI.Point(t.clientX,t.clientY):new Sys.UI.Point(e.clientX,e.clientY)}return new d(t,s.a.getSourceElement(t),i,a)}constructor(e,t,n,a){super(l.a.contextMenu,t,e,a),this._clientPoint=n,this._activeCellChangedBetweenMouseDownAndMouseUp=!1}}(0,a.a)(d,"ContextMenuEventArgs",s.a,[]);var u=n(6923),p=n(9865),g=n(9855),h=n(8817),m=n(4706),_=n(657),S=n(680),f=n(3245);class C extends r.a{initializeForElement(e){super.initializeForElement(e),this._eventHandlerManager.initializeEventForElement(l.a.contextMenu,e,2,this.onContextMenu),this._eventHandlerManager.initializeEventForElement(l.a.touchContextMenu,e,2,this.onContextMenu)}deinitializeForElement(e){super.deinitializeForElement(e),this._eventHandlerManager.deinitializeEventForElement(e,l.a.contextMenu),this._eventHandlerManager.deinitializeEventForElement(e,l.a.touchContextMenu)}registerHandler(e,t,n){this._eventHandlerManager.registerHandler(l.a.contextMenu,e,2,this.onContextMenu,t,n),this._eventHandlerManager.initializeForElementInternal(l.a.touchContextMenu,e,2,this.onContextMenu)}unregisterHandler(e,t){this._eventHandlerManager.unregisterHandler(l.a.contextMenu,e,t),this._eventHandlerManager.deinitializeForElementInternal(e,l.a.touchContextMenu)}fireContextMenu(e){const t=e.srcElement||e.target,n=new Sys.UI.DomEvent(e);this._eventHandlerManager.simulateBubblingEvent(l.a.contextMenu,t,n)}static get instance(){return C._instance||(C._instance=new C),C._instance}static disposeInputManager(){S.a.safeDispose(C._instance),C._instance=null}constructor(){super(),this._dragInputManager=null,this._gestureInputManager=null,this._lastInputMethodHeard=0,this.isSuppressingMenus=!1,this.onContextMenu=(e,t,n)=>{if(!this.isEnabled)return!1;if(n&&m.a.isOneNoteInkingImprovementsEnabled(n.target))return!0;if(n.target&&1===n.target.nodeType&&Sys.UI.DomElement.containsCssClass(n.target,C.allowBrowserContextMenu))return!1;if(this.isSuppressingMenus||f.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MobileEmbedViewerIsEnabled"))return r.a.cancelEvent(n),!0;if(_.TaskManager.instance.isYielding)return!0;const a=this._eventHandlerManager.processEvent(l.a.contextMenu,t,d.create(e,n,this._lastInputMethodHeard));return a&&(r.a.cancelEvent(n),e===l.a.touchContextMenu&&(h.a.cancelAllPendingClicks(),this._eventHandlerManager.temporarilyDisableBrowserClicks(),this._cancelPointersOnContextMenu&&(this._dragInputManager.cancelPendingPointerEvents(),this._gestureInputManager.instance&&this._gestureInputManager.instance.cancelPendingPointerEvents()))),a},this.onPointerEventHeard=e=>{this._lastInputMethodHeard=e.inputSource},this.onKeyEventHeard=e=>{this._lastInputMethodHeard=1},this._eventHandlerManager=p.EventHandlerManager.instance,g.a.instance.registerOnBeforeEventProcessed(l.a.pointerDown,this.onPointerEventHeard),g.a.instance.registerOnBeforeEventProcessed(l.a.pointerUp,this.onPointerEventHeard),p.EventHandlerManager.instance.registerOnBeforeEventProcessed(l.a.keyDown,this.onKeyEventHeard),p.EventHandlerManager.instance.registerOnBeforeEventProcessed(l.a.keyUp,this.onKeyEventHeard),this._cancelPointersOnContextMenu=!1,f.AFrameworkApplication.appSettingsManager&&(this._cancelPointersOnContextMenu=f.AFrameworkApplication.isMultiTouchGestureEnabled()&&f.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MultiTouchCancelPointersOnContextMenu")),this._cancelPointersOnContextMenu&&(this._dragInputManager=u.a.instance,this._gestureInputManager=(0,i.h)(o.a))}}C.allowBrowserContextMenu="AllowBrowserContextMenu",C._instance=null,(0,a.a)(C,"ContextMenuInputManager",r.a,[])},5278:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(6776),o=n(2734),r=n(6094),s=n(5861),l=n(9858);const c="name",d="type",u="tabIndex";class p{dispose(){this._currentElement=null,Array.clear(this._validTags),this._validTags=null,this._root=null,this._cachedFirstElement=null,this._cachedLastElement=null}addValidTag(e){Array.add(this._validTags,e)}get currentElement(){return this._currentElement}trySetCurrentElement(e){return this.setCurrentElement(e,!1)}forceSetCurrentElement(e){this.setCurrentElement(e,!0)}setCurrentElement(e,t){let n=!0;if(e&&(this.currentElement!==e||t)){if(!this.isFileInputElement(e)&&!o.a.tryFocus(e))return this._currentElement=null,!0;if(1===e.nodeType&&3===r.a.getTag(e)){const t=s.a.getAttributeValue(e,d);switch(null==t?"text":l.a.toLower(t)){case"password":case"text":e.select();break;case"file":n=!1}}}return this.handleTabIndexOnSetCurrentElement(e),this._currentElement=e,!e&&i.AFrameworkApplicationConstants.activeFrame.applicationInstance.isFocusManagerBugFixEnabled&&(n=!1),n}isFileInputElement(e){if(1!==e.nodeType)return!1;if(3!==r.a.getTag(e))return!1;const t=s.a.getAttributeValue(e,d);return null!=t&&"file"===l.a.toLower(t)}get previousElement(){return p.findPreviousElement(this.currentElement,this._root(),this._validTags)}get nextElement(){return p.findNextElement(this.currentElement,this._root(),this._validTags)}get firstElement(){if(this._cachedFirstElement){if(this.rememberFirstElement)return this._cachedFirstElement;this._cachedFirstElement=null}const e=p.firstInElement(this._root(),this._validTags);return this.rememberFirstElement&&(this._cachedFirstElement=e),e}get lastElement(){if(this._cachedLastElement){if(this.rememberLastElement)return this._cachedLastElement;this._cachedLastElement=null}const e=p.lastInElement(this._root(),this._validTags);return this.rememberLastElement&&(this._cachedLastElement=e),e}handleTabIndexOnSetCurrentElement(e){s.a.isRadioInputElement(e)&&(s.a.hasFocusableTabIndex(e)||(p.setElementAsFocusable(e),this.setAllOtherRadioButtonInRadioGroupToNonFocusable(e)))}setAllOtherRadioButtonInRadioGroupToNonFocusable(e){let t=this.firstElement;for(;t;)p.shouldSetRadioButtonElementAsNonFocusableDueToOtherRadioButtonFocus(t,e)&&p.setElementAsNonFocusableDueToOtherRadioButtonFocus(t),t=p.findNextElement(t,this._root(),this._validTags)}static findNextElement(e,t,n){return p.findAdjacentElement(e,t,n,!0)}static findPreviousElement(e,t,n){return p.findAdjacentElement(e,t,n,!1)}static findAdjacentElement(e,t,n,a){if(!e)return null;let i=p.highestInvalidElement(e,t);if(!i){const t=r.a.getTag(e);if(!Array.contains(n,t)){const t=p.getFirstOrLastInElement(e,n,a);if(t&&t!==e)return t}i=e}return p.adjacentElementFromCurrent(i,t,n,a)}static highestInvalidElement(e,t){if(e===t||!e||1!==e.nodeType)return null;let n=p.highestInvalidElement(e.parentNode,t);return n||p.elementFocusable(e)||(n=e),n}static adjacentElementFromCurrent(e,t,n,a){let i=null,o=a?e.nextSibling:e.previousSibling;for(;o&&!i;)i=p.getFirstOrLastInElement(o,n,a),o=a?o.nextSibling:o.previousSibling;const r=e.parentNode;return!i&&r!==t&&r?p.adjacentElementFromCurrent(r,t,n,a):i}static firstInElement(e,t){return p.getFirstOrLastInElement(e,t,!0)}static lastInElement(e,t){return p.getFirstOrLastInElement(e,t,!1)}static getFirstOrLastInElement(e,t,n){let a=null;if(e&&1===e.nodeType&&p.elementFocusable(e)){const i=r.a.getTag(e);(Array.contains(t,i)||s.a.hasFocusableTabIndex(e))&&(a=e);let o=n?e.firstChild:e.lastChild;for(;o&&!a;)a=p.getFirstOrLastInElement(o,t,n),o=n?o.nextSibling:o.previousSibling}return a}static elementFocusable(e){let t=!0;if(1===r.a.getTag(e))try{s.a.hasFocusableTabIndex(e)||void 0!==s.a.getAttributeValue(e,"href")&&null!==s.a.getAttributeValue(e,"href")||(t=!1)}catch(e){0}else 8===r.a.getTag(e)?s.a.hasFocusableTabIndex(e)||(t=!1):s.a.isRadioInputElement(e)&&!s.a.hasFocusableTabIndex(e,!0)&&(t=!1);return t&&!e.disabled&&s.a.isVisible(e)}static shouldSetRadioButtonElementAsNonFocusableDueToOtherRadioButtonFocus(e,t){const n=s.a.getAttributeValue(t,c);return e.id!==t.id&&s.a.isRadioInputElement(e)&&s.a.getAttributeValue(e,c)===n}static setElementAsNonFocusableDueToOtherRadioButtonFocus(e){e.setAttribute(u,"-1")}static setElementAsFocusable(e){e.setAttribute(u,"0")}constructor(e){this._validTags=[],this._cachedFirstElement=null,this._cachedLastElement=null,this.rememberFirstElement=!1,this.rememberLastElement=!1,this._currentElement=null,this._root=e}}(0,a.a)(p,"DOMFocusListing",null,[92])},6923:function(e,t,n){"use strict";n.d(t,{a:function(){return P}});var a=n(100),i=n(3792),o=n(3094),r=n(5149),s=n(1520),l=n(5900),c=n(7531),d=n(7995);class u{constructor(){this.dragAdapters=new d.a}}(0,a.a)(u,"DragAdapterCache",null,[]);class p extends Sys.EventArgs{get triggeredExternally(){return this._triggeredExternally}constructor(e){super(),this._triggeredExternally=e}}(0,a.a)(p,"DragCancelEventArgs",Sys.EventArgs,[]);var g=n(2929);class h extends g.a{get beginMouseCapture(){return this._beginMouseCapture}set beginMouseCapture(e){this._beginMouseCapture=e}get caughtElement(){return this._caught}get mouseButton(){return this._button}get shiftKey(){return this._shiftKey}get ctrlKey(){return this._ctrlKey}get elementPoint(){return this._elementPoint||(this._elementPoint=g.a.getElementPoint(this._client,this.sourceElement)),this._elementPoint}get screenPoint(){return this._screen}get clientPoint(){return this._client}static createFromMouseEvent(e,t,n,a){if(n.rawEvent){const i=n.rawEvent,o=g.a.getSourceElement(n),r=new Sys.UI.Point(i.screenX,i.screenY),s=new Sys.UI.Point(i.clientX,i.clientY),l=null,c=g.a.getMouseButton(i),d=i.shiftKey,u=i.ctrlKey;return new h(e,o,t,n,l,r,s,c,d,u,a)}{const i=n.target,o=new Sys.UI.Point(n.screenX,n.screenY),r=new Sys.UI.Point(n.clientX,n.clientY),s=null,l=n.button,c=n.shiftKey,d=n.ctrlKey;return new h(e,i,t,n,s,o,r,l,c,d,a)}}static createFromTouchArgs(e){const t=e.innerEvent.rawEvent,n=t.shiftKey,a=t.ctrlKey;return new h(e.eventName,e.sourceElement,e.caughtElement,e.innerEvent,e.elementPoint,e.screenPoint,e.clientPoint,Sys.UI.MouseButton.leftButton,n,a,3)}constructor(e,t,n,a,i,o,r,s,l,c,d){super(e,t,a,d),this._beginMouseCapture=!1,this.preventEventDefaultOnDragPossible=!0,this._caught=n,this._elementPoint=i,this._screen=o,this._client=r,this._button=s,this._shiftKey=l,this._ctrlKey=c}}(0,a.a)(h,"DragEventArgs",g.a,[]);var m=n(9865),_=n(6012),S=n(629),f=n(2217),C=n(9855),y=n(2604),A=n(5976),b=n(4706),T=n(7547),v=n(657),w=n(6094),F=n(680),I=n(7958),E=n(1163),M=n(872),k=n(3245);class P extends c.a{get isMouseCaptured(){return!!this._capturedElement}get gestureInputManagerFuture(){return this._gestureInputManagerFuture||(this._gestureInputManagerFuture=(0,i.h)(o.a))}get stopWatchBuilder(){return k.AFrameworkApplication.activeFrame.theStopwatchBuilder}get mouseManager(){return f.a.instance}initializeForElement(e){super.initializeForElement(e),this._eventHandlerManager.initializeListForElement(_.a.dragEvents,e,this._eventProcessorPriority,this.onDragEvent)}deinitializeForElement(e){super.deinitializeForElement(e),this._eventHandlerManager.deinitializeListForElement(e,_.a.dragEvents)}suspend(){this.cancelDragInternal(),super.suspend()}registerCursorPinningTool(e){Array.add(this._cursorPinningTool,e)}registerDragAdapter(e,t,n=!1,a=!0){this.registerDragAdapterWithPriority(e,t,1,n,a)}registerDragAdapterWithPriority(e,t,n,a=!1,i=!0){i||this._skipPausingTaskManagerForAdapters.push(t);let o=this.getAdapterCache(e);o||(o=new u,this.setAdapterCache(e,o)),o.dragAdapters.length||this.registerDragRegion(e),o.dragAdapters.add(n,t),a&&Array.add(this._outOfWindowDraggableAdapters,t)}unregisterDragAdapter(e,t){const n=this.getAdapterCache(e);n&&(n.dragAdapters.remove(t),Array.remove(this._outOfWindowDraggableAdapters,t),n.dragAdapters.length||this.unregisterDragRegion(e)),Array.remove(this._skipPausingTaskManagerForAdapters,this._dragAdapter)}isFakeClick(e){if(void 0===e||!e)return!1;if(e.Visibility)return this._downDetected;if(this._downDetected){const t=e.screenX,n=e.screenY,a=this._lastDownX-t,i=this._lastDownY-n;if(a<-4||a>4||i<-4||i>4)return!0;0}return!1}get isInDrag(){return!!this._dragAdapter}startDrag(e,t){if(this._pauseTaskManagerDuringDrag=!Array.contains(this._skipPausingTaskManagerForAdapters,e),this._pauseTaskManagerDuringDrag&&(v.TaskManager.instance.pause(),this._taskManagerPauseCount++,this._timeTaskManagerPauseInDragInputManagerIsEnabled&&this.stopWatchBuilder&&(this.mouseManager&&this.mouseManager.registerHandler(_.a.mouseLeave,window.document.body,this.onMouseLeaveEvent),this._taskManagerPauseGuid=T.a.create(),this._taskManagerPauseStopwatch=this.stopWatchBuilder.makeAndStartStopwatch("Task","TaskManagerPause"),r.ULS.sendTraceTag(590194892,310,50,"Pausing TaskManager: _taskManagerPauseGuid: {0}",this._taskManagerPauseGuid.toString()))),3===t.inputSource){y.a.getTouchAndHoldAdapter(t.sourceElement).cancelTouchAndHold(),this._inTouchDrag=!0}this._dragAdapter=e,this._lastDownEvent=null,this._eventHandlerManager._isDragging=!0,Array.clear(this._dragCandidates)}cancelDrag(e=!1){(this.isInDrag||e)&&this.cancelDragInternal(!0)}cancelDragInternal(e){void 0===e&&(e=!1),this._endingDrag||this._callingDragAdapterDragEnd||(this._dragAdapter&&this._dragAdapter.onDragCancel(new p(e)),this._pauseTaskManagerDuringDrag=!0,this._downDetected=!1,this.endDrag())}endDrag(){this._endingDrag||(this._endingDrag=!0,this._dragAdapter=null,Array.clear(this._dragCandidates),this._lastDownEvent=null,this._inTouchDrag&&(this._isFromIE10Touch||this._eventHandlerManager.temporarilyDisableBrowserClicks(),this._inTouchDrag=!1),this._isFromIE10Touch=!1,this.browserReleaseCapture(),this._pauseTaskManagerDuringDrag&&this._taskManagerPauseCount>0&&(v.TaskManager.instance.resume(),this._taskManagerPauseCount--,this._taskManagerPauseStopwatch&&(this._taskManagerPauseStopwatch.stop(),r.ULS.sendTraceTag(590194893,310,50,"Resuming TaskManager: _taskManagerPauseGuid: {0}, AgeInMilliseconds: {1}",this._taskManagerPauseGuid.toString(),this._taskManagerPauseStopwatch.ageInMilliseconds),this._taskManagerPauseStopwatch=null,this.mouseManager&&this.mouseManager.unregisterHandler(_.a.mouseLeave,window.document.body,this.onMouseLeaveEvent))),this._endingDrag=!1,this._pauseTaskManagerDuringDrag=!0,this.resetCursor(),window.setTimeout((()=>{this._eventHandlerManager._isDragging=!1}),0))}shouldCancelDrag(e,t){if(e===_.a.mouseOut&&g.a.getSourceElement(t).ownerDocument===window.document){if(this._dragAdapter&&Array.contains(this._outOfWindowDraggableAdapters,this._dragAdapter))return!1;const e=new Sys.UI.Point(t.clientX,t.clientY);if(!I.a.isPointInElement(window.document.body,e))return!0}return!1}shouldEndDrag(e){return e===_.a.mouseUp||e===_.a.touchEnd}browserCapture(e){e.setCapture&&e.releaseCapture&&(this.isMouseCaptured&&this.browserReleaseCapture(),this._eventHandlerManager.initializeEventForElement(_.a.loseCapture,e,this._eventProcessorPriority,this.onLoseCapture),e.setCapture(),this._capturedElement=e)}browserReleaseCapture(){this.isMouseCaptured&&(this._eventHandlerManager.deinitializeEventForElement(this._capturedElement,_.a.loseCapture),this._capturedElement.releaseCapture(),this._capturedElement=null)}getAdapterCache(e){return M.a.getObject(e,this._inputDataName)}setAdapterCache(e,t){M.a.setObject(e,this._inputDataName,t)}isEventLandedBeyondSourceElement(e){return c.a.eventLandedBeyondSourceElement(e)}registerDragRegion(e){Array.add(this._dragRegions,e),9===e.nodeType?this._eventHandlerManager.initializeListForElement(_.a.dragEvents,e,this._eventProcessorPriority,this.onDocumentDragEvent):this._eventHandlerManager.initializeListForElement(_.a.dragEvents,e,this._eventProcessorPriority,this.onDragEvent)}unregisterDragRegion(e){Array.remove(this._dragRegions,e),e.nodeType,this._eventHandlerManager.deinitializeListForElement(e,_.a.dragEvents)}onDragEventInternal(e,t,n,a){const i=Array.contains(_.a.touchEvents,e)||this._isFromIE10Touch;if(i&&b.a.isMultiTouch(n))return this.cancelDragInternal(),!1;if(this._isMultiTouchGestureEnabled){if(this._cancelDragFromGestureInputManagerIsEnabled?this.cancelDragForMultiTouchPointerGesture:this._useGestureInputManagerPointerCache?!!this.gestureInputManagerFuture&&!!this.gestureInputManagerFuture.instance&&this.gestureInputManagerFuture.instance.handlingMultiTouchPointerGesture():this._pointerEventsCached.count>1)return this.cancelDragInternal(),!1}let o;if(9!==t.nodeType&&!({earlyReturnValue:o}=this.shouldProcessEvent(e,n)).returnValue)return o;if(this._dragAdapter){let a=!1;if(this.shouldCancelDrag(e,n))this._dragAdapter.onDragCancel(new p(!1)),a=!0;else if(this.shouldEndDrag(e)){const o=this.createDragEventArgs(e,t,n,i);if(!o)return!1;0,this._callingDragAdapterDragEnd=!0,this._dragAdapter.onDragEnd(o),this._callingDragAdapterDragEnd=!1,a=!0}else if(e===_.a.touchMove||e===_.a.mouseMove){const o=this.createDragEventArgs(e,t,n,i);if(!o)return!1;0;this._dragAdapter.onDragMove(o)?o.beginMouseCapture&&!this.isMouseCaptured&&this.browserCapture(t):(this._dragAdapter.onDragCancel(new p(!1)),a=!0)}return a&&this.endDrag(),c.a.cancelEvent(n),!0}if(this._lastDownEvent&&(this.shouldCancelDrag(e,n)||this.shouldEndDrag(e))&&this.cancelDragInternal(),e===_.a.mouseDown||e===_.a.touchStart){Array.add(this._dragCandidates,t);for(let o=n.target;o;o=o.parentNode){if(!Array.contains(this._dragRegions,o))continue;const r=this.createDragEventArgs(e,t,n,i);this._lastDownEvent=r;const s=this.getAdapterCache(t);if(!s)continue;let l=!1,c=!0;for(let e=0;e<s.dragAdapters.length;++e){const t=s.dragAdapters.get_item(e);if(r.beginMouseCapture=!0,t.isDragPossible(r)){l=!0,c=r.beginMouseCapture;break}}return l&&(c&&this.browserCapture(t),i||this.pinCursor(n),r.preventEventDefaultOnDragPossible&&(a&&n.preventDefault(),E.a.isFirefox&&S.FocusManager.tryFocus(document.defaultView))),!1}return!1}if((e===_.a.mouseMove||e===_.a.touchMove)&&this._lastDownEvent){const a=this.createDragEventArgs(e,t,n,i),o=a.screenPoint.x-this._lastDownEvent.screenPoint.x,r=a.screenPoint.y-this._lastDownEvent.screenPoint.y,s=this.getDragThreshHold(n,i);if(o<-s||o>s||r<-s||r>s){for(let e=0;e<this._dragCandidates.length;++e){const t=this._dragCandidates[e],i=this.getAdapterCache(t);if(i)for(let e=0;e<i.dragAdapters.length;++e){const t=i.dragAdapters.get_item(e);if(t.onDragStart(this._lastDownEvent))return t.onDragMove(a)?(this.startDrag(t,this._lastDownEvent),c.a.cancelEvent(n),!0):(t.onDragCancel(new p(!1)),this.cancelDragInternal(),!1)}}return this.cancelDragInternal(),!1}return!1}return!(!this.shouldEndDrag(e)&&!this.shouldCancelDrag(e,n))&&(this.cancelDragInternal(),!1)}shouldProcessEvent(e,t){let n;if(!this._dragAdapter&&e===_.a.mouseDown&&this.isEventLandedBeyondSourceElement(t))return n=!1,{returnValue:!1,earlyReturnValue:n};if(!this.isEnabled)return n=!1,{returnValue:!1,earlyReturnValue:n};if(!w.a.isValidElement(t.target)&&9!==t.target.nodeType)return n=!1,{returnValue:!1,earlyReturnValue:n};if(this._pauseTaskManagerDuringDrag&&v.TaskManager.instance.isYielding)return n=!1,{returnValue:!1,earlyReturnValue:n};if(e===_.a.mouseDown&&(this._downDetected=!0,this._lastDownX=t.screenX,this._lastDownY=t.screenY),e===_.a.click&&this._downDetected){if(this.isFakeClick(t.rawEvent))return this._downDetected=!1,c.a.cancelEvent(t),n=!0,{returnValue:!1,earlyReturnValue:n};this._downDetected=!1}else 0;return e!==_.a.mouseMove&&e!==_.a.touchMove||c.a.ensureAppAwakeIfAsleep(),this._supressEvents?(c.a.cancelEvent(t),n=!0,{returnValue:!1,earlyReturnValue:n}):(n=!0,{returnValue:!0,earlyReturnValue:n})}createDragEventArgs(e,t,n,a){let i;if(a&&b.a.isWebkitStyleTouchEvent(n)){const a=A.a.create(e,t,null,n);i=h.createFromTouchArgs(a)}else{const o=a?3:2;i=h.createFromMouseEvent(e,t,n,o)}return i}cancelPendingPointerEvents(){this._pointerEventsCached.clear()}pinCursor(e){for(let t=0;t<this._cursorPinningTool.length;++t){this._cursorPinningTool[t].pinCursor(e.target)}}resetCursor(){for(let e=0;e<this._cursorPinningTool.length;++e){this._cursorPinningTool[e].resetCursor()}}getDragThreshHold(e,t){return Sys.UI.DomElement.containsCssClass(e.target,"ewawebex")||E.a.isIPad?0:t?10:4}static get instance(){if(!P._instance){const e=P.dragInputManagerFactory||P.createDragInputManager;P._instance=e()}return P._instance}static createDragInputManager(){return new P}static disposeInputManager(){F.a.safeDispose(P._instance)}get dragAdapter(){return this._dragAdapter}constructor(){super(),this._inputDataName=l.a.dragAdapterCache,this._dragRegions=[],this._dragAdapter=null,this._endingDrag=!1,this._callingDragAdapterDragEnd=!1,this._lastDownEvent=null,this._dragCandidates=[],this._downDetected=!1,this._lastDownX=0,this._lastDownY=0,this._taskManagerPauseCount=0,this._cursorPinningTool=[],this._capturedElement=null,this._isFromIE10Touch=!1,this._pointerEventsCached=new s.a,this._eventProcessorPriority=0,this._inTouchDrag=!1,this._gestureInputManagerFuture=null,this._taskManagerPauseGuid=null,this._taskManagerPauseStopwatch=null,this._useGestureInputManagerPointerCache=!1,this._cancelDragFromGestureInputManagerIsEnabled=!1,this.cancelDragForMultiTouchPointerGesture=!1,this._pauseTaskManagerDuringDrag=!0,this.onLoseCapture=(e,t,n)=>(this.cancelDragInternal(),!0),this.onMouseLeaveEvent=e=>(this._pauseTaskManagerDuringDrag&&this._taskManagerPauseStopwatch&&r.ULS.sendTraceTag(589606977,310,50,"MouseLeave and not resuming TaskManager: _taskManagerPauseGuid: {0}, AgeInMilliseconds: {1}",this._taskManagerPauseGuid.toString(),this._taskManagerPauseStopwatch.ageInMilliseconds),!1),this.onDragEvent=(e,t,n)=>this.onDragEventInternal(e,t,n,!0),this.onDocumentDragEvent=(e,t,n)=>(this.onDragEventInternal(e,t,n,E.a.isFirefox),!1),this.onMsPointerUpOrCancelEventHeard=e=>{const t=e.rawEvent;if(null!=t){const e=t.pointerId;null!=e&&(r.ULS.sendTraceTag(594055954,310,50,"OnMsPointerUpOrCancelEventHeard: PointerId: {0}",e),this._pointerEventsCached.remove(e))}},this.onMsPointerDownEventHeard=e=>{if(this._isFromIE10Touch=3===C.a.getIeInputMethod(e),!this._useGestureInputManagerPointerCache){0;const t=e.rawEvent;if(null!=t){const e=t.pointerId;null==e||this._pointerEventsCached.contains(e)||(r.ULS.sendTraceTag(594055953,310,50,"OnMsPointerDownEventHeard: PointerId: {0}",e),this._pointerEventsCached.add(e))}}},this._eventHandlerManager=m.EventHandlerManager.instance,this._outOfWindowDraggableAdapters=[],this._skipPausingTaskManagerForAdapters=[],m.EventHandlerManager.instance.registerOnBeforeEventProcessed(_.a.msPointerDown,this.onMsPointerDownEventHeard),m.EventHandlerManager.instance.registerOnBeforeEventProcessed(_.a.browserPointerDown,this.onMsPointerDownEventHeard);const e=k.AFrameworkApplication.appSettingsManager;this._timeTaskManagerPauseInDragInputManagerIsEnabled=!!e&&e.getBooleanAppSetting("TimeTaskManagerPauseInDragInputManagerIsEnabled"),this._isMultiTouchGestureEnabled=k.AFrameworkApplication.isMultiTouchGestureEnabled(),this._isMultiTouchGestureEnabled&&(this._useGestureInputManagerPointerCache=e.getBooleanAppSetting("UseGestureInputManagerPointerCacheIsEnabled"),this._useGestureInputManagerPointerCache?this._cancelDragFromGestureInputManagerIsEnabled=e.getBooleanAppSetting("CancelDragFromGestureInputManagerIsEnabled")&&e.getBooleanAppSetting("UsePointerCaptureIsEnabled"):(this._eventProcessorPriority=1,m.EventHandlerManager.instance.registerOnBeforeEventProcessed(_.a.msPointerUp,this.onMsPointerUpOrCancelEventHeard),m.EventHandlerManager.instance.registerOnBeforeEventProcessed(_.a.browserPointerUp,this.onMsPointerUpOrCancelEventHeard),e.getBooleanAppSetting("MultiTouchRegisterForPointerCancelIsEnabled")&&(m.EventHandlerManager.instance.registerOnBeforeEventProcessed(_.a.msPointerCancel,this.onMsPointerUpOrCancelEventHeard),m.EventHandlerManager.instance.registerOnBeforeEventProcessed(_.a.browserPointerCancel,this.onMsPointerUpOrCancelEventHeard))))}}P._instance=null,P.dragInputManagerFactory=null,(0,a.a)(P,"DragInputManager",c.a,[])},2929:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i extends Sys.EventArgs{get clientPoint(){return null}get screenPoint(){return null}get elementPoint(){return null}get shiftKey(){return!1}get ctrlKey(){return!1}get sourceElement(){return this._source}get inputSource(){return this._inputSource}static getSourceElement(e){const t=e.rawEvent;if(!t)return e.target;const n=t.srcElement||t.target;return n?3===n.nodeType&&n.parentNode?n.parentNode:n:null}static getFirstTouchInfo(e){let t=null;return t=e.rawEvent?e.rawEvent:e,i.getFirstTouchInfoFromRawEvent(t)}static getFirstTouchInfoFromRawEvent(e){if(!e.touches)return null;let t=e.touches;return!t.length&&e.changedTouches&&(t=e.changedTouches),t[0]}static getClientPointFromTouchEvent(e){const t=e.clientX?e:i.getFirstTouchInfo(e);return new Sys.UI.Point(t.clientX,t.clientY)}static getScreenPointFromTouchEvent(e){const t=i.getFirstTouchInfo(e);return t?new Sys.UI.Point(t.screenX,t.screenY):new Sys.UI.Point(0,0)}static getElementPoint(e,t){const n=Sys.UI.DomElement.getLocation(t);return new Sys.UI.Point(e.x-n.x,e.y-n.y)}static getMouseButton(e){let t;const n=e.button;return t=void 0!==e.which?n:4===n?1:2===n?2:0,t}constructor(e,t,n,a){super(),this.userData=null,this.eventName=e,this.innerEvent=n,this._source=t,this._inputSource=a}}(0,a.a)(i,"EventHandlerArgs",Sys.EventArgs,[])},7939:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e,t){this.handler=e,this.userData=t}}(0,a.a)(i,"EventHandlerBinding",null,[])},9865:function(e,t,n){"use strict";n.r(t),n.d(t,{EventHandlerManager:function(){return v}});var a=n(100),i=n(3792);const o=(0,i.b)("Common.IEventHandlerRegistrationStrategy");var r=n(5149),s=n(7531),l=n(6984),c=n(7939);class d{constructor(e){this.proxyElement=e,this.eventProcessors={},this.eventNameBindings={}}}(0,a.a)(d,"EventHandlerProxyData",null,[]);class u{constructor(){this.eventHandlerBindings=[],this.domEventHandlerBindings=[],this.isHandlerRegistered=!1,this.isPersistent=0}}(0,a.a)(u,"EventNameBinding",null,[]);class p{getEventNameBinding(e){let t=this.eventHandlerProxyData.eventNameBindings[e];return t||(t=new u,this.eventHandlerProxyData.eventNameBindings[e]=t),t}constructor(e,t){var n,a;this.eventHandlerProxyData=new d(t),this.eventHandlerProxy=(n=e,a=this.eventHandlerProxyData,e=>{n(e,a)})}}(0,a.a)(p,"EventHandlerProxyCache",null,[]);var g=n(6012);class h{static isMouseEventName(e){return Array.contains(g.a.mouseEvents,e)}}(0,a.a)(h,"MouseInputManagerStatic",null,[]);var m=n(2604),_=n(7296),S=n(657),f=n(680),C=n(2088),y=n(7958),A=n(872),b=n(8079),T=n(6776);class v extends s.a{get processingEvent(){return!!this.eventBeingProcessed}get eventBeingProcessed(){return this._eventBeingProcessed}get lastClickEventTime(){return this._lastClickEventTime}get isDragging(){return this._isDragging}startIgnoringTaskManagerRunning(){b.a.instance.startIgnoringTaskManagerRunning()}stopIgnoringTaskManagerRunning(){b.a.instance.stopIgnoringTaskManagerRunning()}initializeListForElement(e,t,n,a){for(let i=0;i<e.length;i++)this.initializeEventForElement(e[i],t,n,a)}initializeEventForElement(e,t,n,a){this.initializeForElement(t),this.initializeForElementInternal(e,t,n,a)}initializeForElementInternal(e,t,n,a,i=!1){this.bindEventName(e,t,n,a,i).isPersistent++}deinitializeListForElement(e,t){for(let n=0;n<t.length;n++)this.deinitializeEventForElement(e,t[n])}deinitializeEventForElement(e,t){this.deinitializeForElement(e),this.deinitializeForElementInternal(e,t)}deinitializeForElementInternal(e,t,n=!1){if(t){const a=v.getEventNameBinding(t,e);if(!a)return void r.ULS.sendTraceTag(4032353,310,15,"No event name binding found on element {0}.",e);this.deinitializeEventNameBinding(e,t,a,n)}else{const t=v.retrieveHandlerProxyCache(e).eventHandlerProxyData.eventNameBindings;for(const n in t){const a={key:n,value:t[n]},i=a.key,o=a.value;o?o.isHandlerRegistered&&this.deinitializeEventNameBinding(e,i,o):r.ULS.sendTraceTag(4032354,310,15,"No event name binding found on element {0} and event name for binding {1}.",e,i||"null")}}}deinitializeEventNameBinding(e,t,n,a=!1){n.isPersistent--,this.releaseEventListenerIfUnused(t,e,a)}setOnEventInterruptedTask(e){this._onEventInterruptedTask=e}setOnExceptionOccurred(e){this._onExceptionOccurred=e}registerHandler(e,t,n,a,i,o,r=!1){this.registerHandlerInternal(e,t,new c.a(i,o),!0,n,a,r)}registerRawEventHandler(e,t,n){this.registerHandlerInternal(e,t,n,!1)}registerHandlerInternal(e,t,n,a,i=2,o=null,r=!1){const s=this.bindEventName(e,t,i,o,r);Array.add(a?s.eventHandlerBindings:s.domEventHandlerBindings,n)}unregisterHandler(e,t,n,a=!1){this.unregisterHandlerInternal(e,t,(e=>n===e.handler),!0,a)}unregisterRawEventHandler(e,t,n){this.unregisterHandlerInternal(e,t,(e=>n===e),!1)}unregisterHandlerInternal(e,t,n,a,i=!1){const o=v.getEventNameBinding(e,t);o&&(this.removeHandlersFromBinding(a?o.eventHandlerBindings:o.domEventHandlerBindings,e,t,n),this.releaseEventListenerIfUnused(e,t,i))}removeHandlersFromBinding(e,t,n,a=null){for(let t=e.length-1;t>=0;t--)a&&!a(e[t])||(Array.removeAt(e,t))}unregisterAllHandlers(e){const t=v.retrieveHandlerProxyCache(e);if(!t)return;const n=t.eventHandlerProxyData.eventNameBindings;for(const t in n){const a={key:t,value:n[t]},i=a.key,o=a.value;for(this.removeHandlersFromBinding(o.eventHandlerBindings,i,e),this.removeHandlersFromBinding(o.domEventHandlerBindings,i,e),this.releaseEventListenerIfUnused(i,e);o.isPersistent>0;)this.deinitializeForElementInternal(e,i)}}unregisterAllHandlersForDOMArray(e){for(let t=0;t<e.length;++t)this.unregisterAllHandlers(e[t])}registerOnBeforeEventProcessed(e,t){this._onBeforeEventProcessedCallbacks[e]||(this._onBeforeEventProcessedCallbacks[e]=[]);const n=this._onBeforeEventProcessedCallbacks[e];Array.add(n,t)}registerOnBeforeEventsProcessed(e,t){for(let n=0;n<e.length;++n)this.registerOnBeforeEventProcessed(e[n],t)}registerOnAfterEventProcessed(e,t){this._onAfterEventProcessedCallbacks[e]||(this._onAfterEventProcessedCallbacks[e]=[]);const n=this._onAfterEventProcessedCallbacks[e];Array.add(n,t)}registerOnAfterEventsProcessed(e,t){for(let n=0;n<e.length;++n)this.registerOnAfterEventProcessed(e[n],t)}registerOnAfterTouchEndProcessed(e){Array.add(this._onAfterTouchEndProcessedHandlers,e)}unregisterOnAfterTouchEndProcessed(e){Array.contains(this._onAfterTouchEndProcessedHandlers,e)&&Array.remove(this._onAfterTouchEndProcessedHandlers,e)}registerOnTouchMove(e){Array.add(this._onTouchMoveHandlers,e)}unregisterOnTouchMove(e){Array.contains(this._onTouchMoveHandlers,e)&&Array.remove(this._onTouchMoveHandlers,e)}bindEventName(e,t,n=2,a=null,i=!1){let o=v.retrieveHandlerProxyCache(t);if(o||(o=new p(this.eventProxy,t),v.storeHandlerProxyCache(t,o)),a){let t=!1;const i=o.eventHandlerProxyData;let r=i.eventProcessors[e];if(r){for(let e=0,n=r.length;e<n;e++)if(r.peekAt(e)===a){0,t=!0;break}}else i.eventProcessors[e]=r=new C.a;t||r.enqueue(n,a)}const r=o.getEventNameBinding(e);return r.isHandlerRegistered||g.a.isSimulated(e)||(this._eventHandlerRegistrationStrategy?this._eventHandlerRegistrationStrategy.addDomEventHandler(t,e,o.eventHandlerProxy,i):this.addDomEventHandler(t,e,o.eventHandlerProxy,i),r.isHandlerRegistered=!0),r}eventProxyInternal(e,t,n){if(t===g.a.mouseDown||t===g.a.msPointerDown||t===g.a.browserPointerDown||t===g.a.touchStart||t===g.a.keyDown){const e=new Date;T.AFrameworkApplicationConstants.latestActivityTime=e}if(!this.filterClickAndMouseEvents(t,e)&&(b.a.instance.ignoreTaskManagerRunningRefCount||!S.TaskManager.instance.isRunning||!this.handleEventInterruptedTask(e,t))&&(void 0!==n.eventProcessors[t]||this.hasDomEventHandlersToExecute(n,t))){if(this._eventBeingProcessed=t,this.executeOnBeforeEventProcessedCallbacks(e,t),this.executeDomEventHandlers(n,t,e),this.executeEventProcessors(n,t,e),this.executeOnAfterEventProcessedCallbacks(e,t),t===g.a.touchEnd)for(let e=0;e<this._onAfterTouchEndProcessedHandlers.length;++e){(0,this._onAfterTouchEndProcessedHandlers[e])()}if(t===g.a.touchMove)for(let e=0;e<this._onTouchMoveHandlers.length;++e){(0,this._onTouchMoveHandlers[e])()}this._eventBeingProcessed=null}}executeOnBeforeEventProcessedCallbacks(e,t){const n=this._onBeforeEventProcessedCallbacks[t];if(n){0;for(let t=0;t<n.length;++t)n[t](e)}}executeOnAfterEventProcessedCallbacks(e,t){const n=this._onAfterEventProcessedCallbacks[t];if(n){0;for(let t=0;t<n.length;++t)n[t](e)}}executeEventProcessors(e,t,n){const a=e.eventProcessors[t];if(void 0!==a)for(let i=0;i<a.length;i++){0;if(a.peekAt(i)(t,e.proxyElement,n))break}}hasDomEventHandlersToExecute(e,t){if(!e.eventNameBindings[t])return!1;const n=e.eventNameBindings[t].domEventHandlerBindings;return!!n&&n.length>0}executeDomEventHandlers(e,t,n){if(!this.hasDomEventHandlersToExecute(e,t))return;const a=e.eventNameBindings[t].domEventHandlerBindings;for(let e=0;e<a.length;e++){(0,a[e])(n)}}handleEventInterruptedTask(e,t){return this._onEventInterruptedTask&&this._onEventInterruptedTask(t),t!==g.a.touchStart&&t!==g.a.touchEnd||this.temporarilyDisableBrowserClicks(),t===g.a.touchEnd&&m.a.cancelAnyPendingTouchAndHold(),s.a.cancelEvent(e),!0}simulateBubblingEvent(e,t,n){let a=t,i=!1;for(0;!i&&a;){const t=v.retrieveHandlerProxyCache(a);if(t){const o=t.eventHandlerProxyData.eventProcessors[e];if(o)for(let t=0;t<o.length;t++){if(i=o.peekAt(t)(e,a,n)||i,i)break}}a=a.parentNode}}processEvent(e,t,n){let a=!1;const i=v.retrieveHandlerProxyCache(t).eventHandlerProxyData.eventNameBindings[e];if(i)for(let e=0;e<i.eventHandlerBindings.length&&!a;e++){const t=i.eventHandlerBindings[e];n.userData=t.userData,a=t.handler(n)}return a}releaseEventListenerIfUnused(e,t,n=!1){const a=v.retrieveHandlerProxyCache(t);const i=a.getEventNameBinding(e);if(i)try{i.isHandlerRegistered&&!i.eventHandlerBindings.length&&!i.domEventHandlerBindings.length&&i.isPersistent<=0&&(this._eventHandlerRegistrationStrategy?this._eventHandlerRegistrationStrategy.removeDomEventHandler(t,e,a.eventHandlerProxy,n):this.removeDomEventHandler(t,e,a.eventHandlerProxy,n),i.isHandlerRegistered=!1,delete a.eventHandlerProxyData.eventProcessors[e])}catch(a){r.ULS.sendTraceTag(51196386,310,15,"ReleaseEventListenerIfUnused: {0}",{Exception:a,ClassName:t.className,ID:t.id,eventName:e,useCapture:n})}else r.ULS.sendTraceTag(51196385,310,15,"binding is null when we try to release event listener")}filterClickAndMouseEvents(e,t){if(!this._clicksEnabled){if(e===g.a.click)return this.cancelBrowserClick(t),!0;if(h.isMouseEventName(e)&&!y.a.isTextField(t.rawEvent?t.rawEvent.srcElement:t.target))return s.a.cancelEvent(t),!0}return!1}temporarilyDisableBrowserClicks(){this._clicksEnabled=!1,this._enableClicksTask?(S.TaskManager.instance.deleteTask(this._enableClicksTask),S.TaskManager.instance.addTask(this._enableClicksTask)):(this._enableClicksTask=new _.a(2,1,v.maxClickDisabledTime,this.reenableBrowserClicks,13),S.TaskManager.instance.addTask(this._enableClicksTask))}forceReenableBrowserClicks(){this.reenableBrowserClicks(null)}cancelBrowserClick(e){s.a.cancelEvent(e),S.TaskManager.instance.deleteTask(this._enableClicksTask),this.reenableBrowserClicks(null)}enableEventHandling(e){this._isEventHandlingDisabled=!e}static get instance(){return v._instance||(v._instance=v.createEventHandlerManager()),v._instance}static createEventHandlerManager(){return new v(l.a.instance,(0,i.h)(o))}static disposeInputManager(){f.a.safeDispose(v._instance)}static getEventNameBinding(e,t){const n=v.retrieveHandlerProxyCache(t);if(!n)return null;return n.getEventNameBinding(e)}static retrieveHandlerProxyCache(e){return A.a.getObject(e,v.inputDataName)}static storeHandlerProxyCache(e,t){A.a.setObject(e,v.inputDataName,t)}constructor(e,t){super(),this._eventHandlerRegistrationStrategy=null,this._enableClicksTask=null,this._clicksEnabled=!0,this._isEventHandlingDisabled=!1,this._onBeforeEventProcessedCallbacks={},this._onAfterEventProcessedCallbacks={},this._onAfterTouchEndProcessedHandlers=[],this._onTouchMoveHandlers=[],this._onEventInterruptedTask=null,this._onExceptionOccurred=null,this._eventBeingProcessed=null,this.removeProxyElementIdFromEventDescription=!1,this._lastClickEventTime=0,this._isDragging=!1,this.eventProxy=(e,t)=>{if(this._isEventHandlingDisabled)return;const n=t,a=g.a.eventNameFromString(e.type);let i=a+"_"+n.proxyElement.tagName;this.removeProxyElementIdFromEventDescription||(i+="_"+n.proxyElement.id);if(!(!(null==e)&&!(void 0===e.rawEvent||null===e.rawEvent)&&e.rawEvent[s.a.markerFieldForEventsToBeIgnored]))if(this._onExceptionOccurred)try{this._cpuMeter.profileTopLevelTask((()=>{this.eventProxyInternal(e,a,n)}),i,0)}catch(e){r.ULS.sendTraceTag(17114121,310,10,"EventProxy: Exception during event {0}",i),this._onExceptionOccurred(e)}else this._cpuMeter.profileTopLevelTask((()=>{this.eventProxyInternal(e,a,n)}),i,0)},this.reenableBrowserClicks=e=>{this._clicksEnabled=!0,this._enableClicksTask=null},this._cpuMeter=e,t.execute((e=>{this._eventHandlerRegistrationStrategy=e}))}}v.initializeForElementRegistrationType=void 0,v.registerHandlerRegistrationType=void 0,v.browserRegistrationType=void 0,v.inputDataName="HandlerCache",v.maxClickDisabledTime=1e3,v._instance=null,(0,a.a)(v,"EventHandlerManager",s.a,[93])},4454:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8079);class o{dispose(){i.a.instance.stopIgnoringTaskManagerRunning()}constructor(){i.a.instance.startIgnoringTaskManagerRunning()}}(0,a.a)(o,"IgnoreTaskManagerRunningScope",null,[11])},8079:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static get instance(){return i._instance||(i._instance=new i),i._instance}get ignoreTaskManagerRunningRefCount(){return this._ignoreTaskManagerRunningRefCount}startIgnoringTaskManagerRunning(){this._ignoreTaskManagerRunningRefCount++}stopIgnoringTaskManagerRunning(){this._ignoreTaskManagerRunningRefCount>0&&this._ignoreTaskManagerRunningRefCount--}constructor(){this._ignoreTaskManagerRunningRefCount=0}}i._instance=null,(0,a.a)(i,"EventHandlerManagerStatic",null,[])},6012:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(1163),o=n(6362);class r{static get mouseWheel(){return r._mouseWheel||(i.a.isFirefox?r._mouseWheel="DOMMouseScroll":r._mouseWheel="mousewheel"),r._mouseWheel}static ensureEventNamesMapping(){r._eventNames||(r._eventNames=o.a.buildHashSet([r.aggregateEventTiming,r.aggregateEventTimingStart,r.aggregateEventTimingStop,r.beforeDeactivate,r.beforeKeyDown,r.beforeKeyPress,r.beforeKeyUp,r.blur,r.browserPointerCancel,r.browserPointerDown,r.browserPointerEnter,r.browserPointerLeave,r.browserPointerMove,r.browserPointerOut,r.browserPointerOver,r.browserPointerUp,r.change,r.click,r.compositionEnd,r.compositionStart,r.compositionUpdate,r.contextMenu,r.copy,r.cut,r.domSubtreeModified,r.doubleClick,r.dragLeave,r.dragStart,r.dragOver,r.dragEnter,r.drop,r.durationChange,r.error,r.ended,r.focus,r.freeze,r.input,r.keyDown,r.keyPress,r.keyUp,r.load,r.loseCapture,r.message,r.mouseDown,r.mouseEnter,r.mouseLeave,r.mouseMove,r.mouseOut,r.mouseOver,r.mouseUp,r.mouseWheel,r.msPointerCancel,r.msPointerDown,r.msPointerEnter,r.msPointerLeave,r.msPointerMove,r.msPointerOut,r.msPointerOver,r.msPointerUp,r.networkConnected,r.networkDisconnected,r.pageshow,r.pan,r.panStart,r.panMove,r.panEnd,r.panCancel,r.panUp,r.panDown,r.panRight,r.panLeft,r.paste,r.pause,r.pinch,r.pinchCancel,r.pinchEnd,r.pinchIn,r.pinchMove,r.pinchOut,r.pinchStart,r.play,r.playing,r.pointerDown,r.pointerEnter,r.pointerLeave,r.pointerMove,r.pointerOut,r.pointerOver,r.pointerUp,r.propertyChange,r.reportFrameTiming,r.resize,r.resume,r.scroll,r.scrollEnd,r.selectionChange,r.selectStart,r.submit,r.swcReady,r.swipe,r.reset,r.textInput,r.timeUpdate,r.touchCancel,r.touchContextMenu,r.touchEnd,r.touchMove,r.touchStart,r.unload,r.visibilityChange,r.wheel]))}static isValidEventName(e){return r.ensureEventNamesMapping(),!!r._eventNames[e]}static ensureIsSimulatedMapping(){r._isSimulated||(r._isSimulated=o.a.buildHashSet([r.beforeKeyDown,r.beforeKeyUp,r.beforeKeyPress,r.pan,r.pinch,r.swipe,r.touchContextMenu]))}static isSimulated(e){return r.ensureIsSimulatedMapping(),!!r._isSimulated[e]}static ensureIsInternalMapping(){r._isInternal||(r._isInternal=o.a.buildHashSet([r.touchContextMenu]))}static isInternalEvent(e){return r.ensureIsInternalMapping(),!!r._isInternal[e]}static eventNameFromString(e){let t=e;switch(t){case"textinput":t=r.textInput;break;case"dommousescroll":t=r.mouseWheel;break;case"domsubtreemodified":t=r.domSubtreeModified;break;case"mspointerdown":t=r.msPointerDown;break;case"mspointerup":t=r.msPointerUp;break;case"mspointermove":t=r.msPointerMove;break;case"mspointerover":t=r.msPointerOver;break;case"mspointerout":t=r.msPointerOut;break;case"mspointercancel":t=r.msPointerCancel;break;case"mspointerleave":t=r.msPointerLeave;break;case"mspointerenter":t=r.msPointerEnter}return t}}r.keyDown="keydown",r.keyUp="keyup",r.keyPress="keypress",r.beforeKeyDown="BeforeKeyDown",r.beforeKeyUp="BeforeKeyUp",r.beforeKeyPress="BeforeKeyPress",r.touchContextMenu="touchcontextmenu",r.compositionStart="compositionstart",r.compositionEnd="compositionend",r.compositionUpdate="compositionupdate",r.loseCapture="losecapture",r.pointerDown="msospPointerDown",r.pointerMove="msospPointerMove",r.pointerUp="msospPointerUp",r.pointerOver="msospPointerOver",r.pointerOut="msospPointerOut",r.pointerLeave="msospPointerLeave",r.pointerEnter="msospPointerEnter",r.browserPointerDown="pointerdown",r.browserPointerMove="pointermove",r.browserPointerUp="pointerup",r.browserPointerOver="pointerover",r.browserPointerOut="pointerout",r.browserPointerCancel="pointercancel",r.browserPointerLeave="pointerleave",r.browserPointerEnter="pointerenter",r.mouseDown="mousedown",r.mouseUp="mouseup",r.mouseMove="mousemove",r.mouseEnter="mouseenter",r.mouseLeave="mouseleave",r.mouseOver="mouseover",r.mouseOut="mouseout",r._mouseWheel=null,r.wheel="wheel",r.click="click",r.doubleClick="dblclick",r.touchStart="touchstart",r.touchMove="touchmove",r.touchEnd="touchend",r.touchCancel="touchcancel",r.msPointerDown="MSPointerDown",r.msPointerMove="MSPointerMove",r.msPointerUp="MSPointerUp",r.msPointerOver="MSPointerOver",r.msPointerOut="MSPointerOut",r.msPointerCancel="MSPointerCancel",r.msPointerLeave="MSPointerLeave",r.msPointerEnter="MSPointerEnter",r.textInput="textInput",r.drop="drop",r.dragStart="dragstart",r.dragOver="dragover",r.dragEnter="dragenter",r.dragLeave="dragleave",r.contextMenu="contextmenu",r.beforeDeactivate="beforedeactivate",r.domSubtreeModified="DOMSubtreeModified",r.message="message",r.focus="focus",r.input="input",r.blur="blur",r.freeze="freeze",r.resume="resume",r.pageshow="pageshow",r.change="change",r.propertyChange="propertychange",r.scroll="scroll",r.scrollEnd="scrollend",r.selectionChange="selectionchange",r.selectStart="selectstart",r.submit="submit",r.reset="reset",r.load="load",r.unload="unload",r.error="error",r.resize="resize",r.copy="copy",r.cut="cut",r.paste="paste",r.play="play",r.playing="playing",r.pause="pause",r.timeUpdate="timeupdate",r.durationChange="durationchange",r.ended="ended",r.aggregateEventTiming="aggregateeventtiming",r.aggregateEventTimingStart="aggregateeventtimingstart",r.aggregateEventTimingStop="aggregateeventtimingstop",r.reportFrameTiming="reportframetiming",r.visibilityChange="visibilitychange",r.networkConnected="online",r.networkDisconnected="offline",r.swcReady="swc:ready",r.pinch="pinch",r.pinchStart="pinchstart",r.pinchEnd="pinchend",r.pinchOut="pinchout",r.pinchIn="pinchin",r.pinchMove="pinchmove",r.pinchCancel="pinchcancel",r.pan="pan",r.panStart="panstart",r.panEnd="panend",r.panMove="panmove",r.panCancel="pancancel",r.panDown="pandown",r.panUp="panup",r.panLeft="panleft",r.panRight="panright",r.swipe="swipe",r._eventNames=null,r._isSimulated=null,r._isInternal=null,r.keyEvents=[r.keyDown,r.keyUp,r.keyPress,r.beforeKeyDown,r.beforeKeyUp,r.beforeKeyPress],r.keyTypedEvents=[r.keyDown,r.keyPress],r.mouseEvents=[r.mouseDown,r.mouseUp,r.mouseMove,r.mouseEnter,r.mouseLeave,r.mouseOver,r.mouseOut,r.mouseWheel],r.dragEvents=[r.mouseDown,r.mouseUp,r.mouseMove,r.mouseOut,r.touchStart,r.touchEnd,r.touchMove,r.click],r.dragDropEvents=[r.dragOver,r.drop],r.clickEvents=[r.click,r.doubleClick],r.touchEvents=[r.touchStart,r.touchEnd,r.touchMove,r.touchCancel],r.pointerEvents=[r.pointerDown,r.pointerEnter,r.pointerLeave,r.pointerMove,r.pointerUp,r.pointerOver,r.pointerOut],r.gesturePointerEvents=[r.browserPointerDown,r.browserPointerMove,r.browserPointerUp,r.browserPointerCancel],r.gestureMouseEvents=[r.mouseDown,r.mouseMove,r.mouseUp],r.networkEvents=[r.networkConnected,r.networkDisconnected],(0,a.a)(r,"EventNames",null,[])},3225:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var a=n(100),i=n(5149),o=n(2544),r=n(5072),s=n(3245),l=n(629),c=n(6336),d=n(988);class u{get f6KeyInput(){return this._f6KeyInput}set f6KeyInput(e){this._f6KeyInput=e}get f6ShiftKeyInput(){return this._f6ShiftKeyInput}set f6ShiftKeyInput(e){this._f6ShiftKeyInput=e}initializeOrder(e){this._navOrderList=e;const t=[];for(let n=0;n<e.length;n++)Array.add(t,!1);this._activeList=t,this._activeFocuses=[]}initializePriorityOrder(e){this._priorityOrderList=e}getHighestPriority(){let e=null,t=0;if(this._priorityOrderList||(this._priorityOrderList=this._navOrderList),!this._priorityOrderList)return null;for(;!e&&t<this._priorityOrderList.length;){const n=this._priorityOrderList[t],a=Array.indexOf(this._navOrderList,n);a>=0&&this._activeList[a]&&(e=n),t++}return e}activateFocus(e){if(this._navOrderList&&Array.contains(this._navOrderList,e)){const t=Array.indexOf(this._navOrderList,e);this._activeList[t]||(this._activeList[t]=!0,this.updateActiveFocuses())}else 0}deactivateFocus(e){if(this._navOrderList&&Array.contains(this._navOrderList,e)){const t=Array.indexOf(this._navOrderList,e);this._activeList[t]&&(this._activeList[t]=!1,this.updateActiveFocuses())}else 0}isFocusScopeActive(e){return Array.contains(this._activeFocuses,e)}updateActiveFocuses(){const e=[];for(let t=0;t<this._activeList.length;t++)this._activeList[t]&&Array.add(e,this._navOrderList[t]);this._activeFocuses=e}handleF6(e,t,n,a,i){return this.handleF6WithDirection(!0)}handleF6Shift(e,t,n,a,i){return this.handleF6WithDirection(!1)}resumeFocusWithDirection(e,t,n,a,o){let r="forward";o?r=o.toLowerCase():i.ULS.sendTraceTag(41502554,321,15,"Didn't find direction in message values");let s=0;return"backward"===r?s=this._activeFocuses.length-1:"forward"===r?s=0:i.ULS.sendTraceTag(41302162,321,15,"Received unknown direction to resume focus: "+r),l.FocusManager.instance().setScopeFromTop(this._activeFocuses[s]),32}handleF6WithDirection(e){c.a.mark(4696);let t=this.getCurrentIndex();if(-1===t)return 2;const n=this._onBeforeF6forScope[this._activeFocuses[t]];if(n&&n(e),this.setFocusableScope(t,e),t=this.getCurrentIndex(),-1!==t){const e=this._onPostF6forScope[this._activeFocuses[t]];e&&e()}return c.a.mark(4697),32}handleTabFromBottom(){let e=this.getCurrentIndex();return-1!==e&&(e--,e<0&&(e=this._activeFocuses.length-1),this._focusManager.setScopeFromBottom(this._activeFocuses[e]))}setFocusableScope(e,t){const n=e;let a;const i=t?1:-1,o=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsUIEmbedMode")&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SupportsAccessibilityLoop");do{if(a=null,(e+=i)>=this._activeFocuses.length){if(o){this.blurFocusAndSendMessage(!0);break}e=0}else if(e<0){if(o){this.blurFocusAndSendMessage(!1);break}e=this._activeFocuses.length-1}this._focusManager.setScopeFromTop(this._activeFocuses[e]);const t=this._focusManager.getCurrentRegion();t&&(a=t.listing)}while(a&&!a.firstElement&&e!==n)}blurFocusAndSendMessage(e){const t=e?"forward":"backward";this._focusManager.pushScope(s.AFrameworkApplication.postmessageFocusId,!1),s.AFrameworkApplication.get_hostPostmessengerFuture().execute((e=>{e.sendMessage("App_AccessibilityLoopComplete",{Direction:t})}))}getCurrentIndex(){let e=this._focusManager.currentScope.name;return e&&Array.contains(this._activeFocuses,e)||(e=this._focusManager.currentScope.containerScope,e&&Array.contains(this._activeFocuses,e))?Array.indexOf(this._activeFocuses,e):-1}hasFocus(){return-1!==this.getCurrentIndex()}addF6KeyBindings(e){const t=this._focusManager.getScope(e);t.bindAction(this.f6KeyInput,d.a.f6),t.bindAction(this.f6ShiftKeyInput,d.a.f6shift),this._f6Scopes[e]=t}hasF6KeyBindings(e){return e in this._f6Scopes}addF6(e,t=!0,n=!1){this.activateFocus(e),n&&this.reorderScopeAfterCurrent(e),this._focusManager.getScope(e).addDispose((()=>{this.deactivateFocus(e)})),t&&this.addF6KeyBindings(e)}reorderScopeAfterCurrent(e){if(this._navOrderList){const t=Array.indexOf(this._navOrderList,e);if(t>=0&&this._activeList[t]){const n=this.getCurrentIndex();if(-1!==n&&n>=0){const a=Array.indexOf(this._navOrderList,this._activeFocuses[n]);if(a>=0&&a!==t){Array.insert(this._navOrderList,a+1,e),Array.insert(this._activeList,a+1,!0);const n=t>a?t+1:t;Array.removeAt(this._navOrderList,n),Array.removeAt(this._activeList,n),this.updateActiveFocuses()}}}}}setOnBeforeF6(e,t){this._onBeforeF6forScope[e]=t}setOnPostF6(e,t){this._onPostF6forScope[e]=t}bindFocusToBrowser(e){const t=this._focusManager.getScope(e);t.bindAction(o.a.hashKey(r.a.VK_D,1),d.a.focusToBrowser),t.bindAction(o.a.hashKey(r.a.VK_F6,0),d.a.focusToBrowser),t.bindAction(o.a.hashKey(r.a.VK_F6,4),d.a.focusToBrowser)}static usable(){return!!s.AFrameworkApplication.activeFrame&&!!s.AFrameworkApplication.activeFrame.theFocusManager&&!!s.AFrameworkApplication.activeFrame.theF6Manager&&u.enabled}static get instance(){return u._instance||(u._instance=new u(l.FocusManager.instance())),u._instance}constructor(e){this._f6KeyInput=o.a.hashKey(r.a.VK_F6,0),this._f6ShiftKeyInput=o.a.hashKey(r.a.VK_F6,4),this._activeFocuses=null,this._f6Scopes={},this._navOrderList=null,this._priorityOrderList=null,this._activeList=null,this._onBeforeF6forScope={},this._onPostF6forScope={},this._focusManager=e}}u.enabled=!1,u._instance=null,(0,a.a)(u,"F6Manager",null,[85])},629:function(e,t,n){"use strict";n.r(t),n.d(t,{FocusManager:function(){return P}});var a=n(100),i=n(3792);const o=(0,i.b)("Common.IProcessInputStrategy");var r=n(5149),s=n(2544),l=n(5072),c=n(5018),d=n(1057),u=n(6012),p=n(7531),g=n(6094),h=n(7958),m=n(6776),_=n(5278),S=n(2734);class f{dispose(){this.listing.dispose(),this.listing=null,this._root=null;const e=this._focusHandledElements.length;for(let t=0;t<e;t++)p.a.removeHandler(this._focusHandledElements[t],"focus",this.focusEventHandler);Array.clear(this._focusHandledElements),this._focusHandledElements=null,this.scope=null}moveForward(){return h.a.clearSelectionIfNecessary(),this.listing.currentElement===this.listing.lastElement?this.looped?this.listing.trySetCurrentElement(this.listing.firstElement):(this.contained||m.AFrameworkApplicationConstants.activeFrame.theF6Manager.handleF6(0,null,2,null,null),!0):this.listing.trySetCurrentElement(this.listing.nextElement)}moveBackward(){return h.a.clearSelectionIfNecessary(),this.listing.currentElement===this.listing.firstElement?this.looped?this.listing.trySetCurrentElement(this.listing.lastElement):!!this.contained||m.AFrameworkApplicationConstants.activeFrame.theF6Manager.handleTabFromBottom():this.listing.trySetCurrentElement(this.listing.previousElement)}moveIntoFromTop(){this.listing.forceSetCurrentElement(this.listing.firstElement)}moveIntoFromBottom(){this.listing.forceSetCurrentElement(this.listing.lastElement)}moveIntoRestore(){const e=this.listing.currentElement;e&&_.a.elementFocusable(e)&&S.a.tryFocus(e)||this.listing.trySetCurrentElement(this.listing.firstElement)}rememberFocusStealers(){this.processFocusStealer(this._root())}processFocusStealer(e){if(void 0===e.tagName||null===e.tagName)return;const t=g.a.getTag(e);if(3===t||4===t||6===t||5===t)p.a.addHandler(e,"focus",this.focusEventHandler),Array.add(this._focusHandledElements,e);else{let t=e.firstChild;for(;t;)this.processFocusStealer(t),t=t.nextSibling}}constructor(e,t,n,a){this._focusHandledElements=[],this._blurHandledElements=[],this.looped=!1,this.contained=!1,this.enabled=!0,this.focusEventHandler=e=>{this._focusManager.setScope(this.scope.name),this.listing&&this.listing.trySetCurrentElement(e.target)},this.scope=e,this.listing=t,this._root=n,this._focusManager=a}}(0,a.a)(f,"FocusRegion",null,[11]);class C{constructor(){this.action=0,this.preventHandleExternally=!1,this.argumentsGenerator=null}}(0,a.a)(C,"ActionInfo",null,[]);var y=n(988);class A{get hasSetFocus(){return!!this._setFocus&&this._setFocus.length>0}get useBrowserClick(){return this._useBrowserClick}set useBrowserClick(e){this._useBrowserClick=e}dispose(){for(let e=0;e<this._dispose.length;e++)this._dispose[e]();this._actions=null,Array.clear(this._dispose),this._dispose=null,Array.clear(this._setFocus),this._setFocus=null,Array.clear(this._onFocus),this._onFocus=null,Array.clear(this._onBlur),this._onBlur=null}addDispose(e){Array.add(this._dispose,e)}addSetFocus(e){Array.add(this._setFocus,e)}clearSetFocus(){Array.clear(this._setFocus)}addOnFocus(e){Array.add(this._onFocus,e)}addOnBlur(e){Array.add(this._onBlur,e)}bindAction(e,t){this.bindActionWithArguments(e,t,null)}bindDefaultAction(e,t){const n=this._actions[this._defaultInput];if(this._defaultActionExclusionKeys=t,!n||n.action===y.a.doNothing){const t=new C;t.action=e,t.argumentsGenerator=null,t.preventHandleExternally=!!n,this._actions[this._defaultInput]=t}}bindActionWithArguments(e,t,n){const a=this._actions[e];if(a&&a.action!==y.a.doNothing){if(a.action===t||t===y.a.doNothing)return;r.ULS.sendTraceTag(41739609,310,15,"Key bound to two different actions. Key={0}, Action={1}, SecondAction={2} UICulture={3}.",e,t,a.action,m.AFrameworkApplicationConstants.uiCulture)}else{const i=new C;i.action=t,i.argumentsGenerator=n,i.preventHandleExternally=!!a,this._actions[e]=i}}unBindAction(e){delete this._actions[e]}getAction(e){return this._actions[e]}getDefaultAction(e){return Array.contains(this._defaultActionExclusionKeys,e)?null:this._actions[this._defaultInput]}runOnBlur(e){this.runFocusActions(this,e,this._onBlur)}runOnFocus(e){this.runFocusActions(e,this,this._onFocus)}runSetFocus(e){this.runFocusActions(e,this,this._setFocus)}runFocusActions(e,t,n){for(let a=0;a<n.length;a++)n[a](e,t)}constructor(e){this._actions={},this._defaultActionExclusionKeys=[],this._dispose=[],this._setFocus=[],this._onFocus=[],this._onBlur=[],this._useBrowserClick=!1,this._defaultInput="DEFAULT",this.parent=null,this.restoreFocusHandledExternally=!1,this.keyDownHandledExternally=!1,this.containerScope=null,this.name=e}}(0,a.a)(A,"FocusScope",null,[11]);class b{constructor(e,t){this.previousScope=e,this.nextScope=t}}(0,a.a)(b,"OnFocusScopeChangedEventArgs",null,[]);var T=n(6336),v=n(680),w=n(1163),F=n(9858),I=n(9611),E=n(2274),M=n(6362);const k=-1;class P extends S.a{add_onFocusScopeChanged(e){this._eventSource.addHandler(P.onFocusScopeChangedEventKey,e)}remove_onFocusScopeChanged(e){this._eventSource.removeHandler(P.onFocusScopeChangedEventKey,e)}add_onReactTransientUIFocusScopeRemoved(e){this._eventSource.addHandler(P.onReactTransientUIFocusScopeRemovedEventKey,e)}remove_onReactTransientUIFocusScopeRemoved(e){this._eventSource.removeHandler(P.onReactTransientUIFocusScopeRemovedEventKey,e)}get previousEditableScopeName(){return this._lastEditableFocusScope}addFocusableScope(e,t,n){const a=this.getScope(e);a.parent=t,a.addSetFocus(((t,a)=>{P.tryFocus(n)||(this.defaultScopeName&&e!==this.defaultScopeName?this.setScopeToDefault():"app"===this.defaultScopeName?this.setScope(null):this.setScope("app"))}))}get delegatesEnabled(){return this._delegatesEnabled&&!m.AFrameworkApplicationConstants.isShuttingDown}set delegatesEnabled(e){this._delegatesEnabled=e}dispose(){if(!this._isDisposed){null!==this._tabChecksDocument&&(this._tabChecksKeyInputManager.unregisterHandlerWithDocument(u.a.keyDown,this._tabChecksDocument,this._keyDownHandler),this._keyDownHandler=null,this._tabChecksDocument=null,this._tabChecksKeyInputManager=null);for(let e=0;e<this._scopes.length;e++)this.getScopeAtIndex(e).dispose();Array.clear(this._scopes),Array.clear(this._scopeNames),this._currentScopeIndex=k;for(let e=0;e<this._regionList.length;e++)this._regionList[e].dispose();Array.clear(this._regionList),this._regionList=null,this._regions=null,this._root=null,this._validTags&&(Array.clear(this._validTags),this._validTags=null),this._isDisposed=!0}}get currentScope(){return this._currentScopeIndex===k?null:this.getScopeAtIndex(this._currentScopeIndex)}setScope(e,t=!1){this.updateCurrentScope(e,!0,!1),this.clearScopeStackIfNewScope(e,t)}scopeChanged(e){this.updateCurrentScope(e,!1,!1),this.clearScopeStackIfNewScope(e)}forceScopeChange(e){this.updateCurrentScope(e,!0,!0),this.clearScopeStackIfNewScope(e)}setScopeFromTop(e){const t=this.getRegion(e);t&&!this.getScope(e).hasSetFocus||m.AFrameworkApplicationConstants.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&"EditingRibbonPanelFocus"===e?(this.scopeChanged(e),t.moveIntoFromTop()):this.setScope(e)}setScopeFromBottom(e){const t=this.getRegion(e);return t?(this.scopeChanged(e),t.moveIntoFromBottom(),!0):(this.scopeChanged(e),!1)}setScopeRestore(e,t){if(!this.canScopeReceiveFocus(e))return!1;const n=this.getRegion(e);return n?(this.scopeChanged(e),t&&n.moveIntoRestore()):this.setScope(e),!0}canScopeReceiveFocus(e){return!P.f6Manager.hasF6KeyBindings(e)||(P.f6Manager.isFocusScopeActive(e)||e in this._editableFocusScopesActiveStateMap&&this._editableFocusScopesActiveStateMap[e])}processInput(e){const t=s.a.hashEvent(e);if(t){let n=null;const a=this._processInputStrategyFuture?this._processInputStrategyFuture.instance:null;n=a?a.findAction(this,this.currentScope,t):this.findAction(this.currentScope,t),E.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")&&(n||(n=this.findDefaultAction(this.currentScope,t)));let i=null,o=null;if(n){if(n.argumentsGenerator&&(i=n.argumentsGenerator()),this._actionManager.commandLocation=6,this._actionManager.invocationMethod=1,E.AFrameworkApplication_AppSettingsManager.appSettingsManager&&(E.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("AddEventTelemetryEnabled")||d.ActionManager.isInteractivePerfRecordingEnabled())&&(o={},o.event=e.rawEvent,o.name=d.ActionManager.actionIdResolverDelegate?d.ActionManager.actionIdResolverDelegate(n.action):"",d.ActionManager.isInteractivePerfRecordingEnabled())){o.name=o.name;const t=d.ActionManager.trackInteractiveEventsDelegate(e.rawEvent,o.name,[{key:"Scope",value:"fm"}]);t&&(o.interactive_uid=t)}if(this.recordKeyCounter(e),this.addTriggerTimeTelemetryEnabled&&e&&e.rawEvent){let t=0;if(e.rawEvent.srcElement&&e.rawEvent.srcElement.ownerDocument){if(e.rawEvent.srcElement.ownerDocument!==window.document){const n=this.getPerformanceNowByDOMDocument(e.rawEvent.srcElement.ownerDocument),a=this.getPerformanceNowByDOMDocument(window.document);t=n&&a?a-n:null}t&&(o=o||{},o.TriggerTime=e.rawEvent.timeStamp+t)}}}else 0;if(E.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShortcutKeyForAddinOnWordEnabled",!1)){const r=a?.handleInputUsingAddinHandler(e,t,n,i,o);if(r)return 32}if(n){let e;return e=a?a.handleInputAction(n.action,i,o):this._actionManager.processActionWithData(n.action,2,i,o),4===e&&n.preventHandleExternally?32:e}}return 4}focusToBrowser(e,t,n,a,i){return this.pushScope(P.browserFocusId,!0),4}addSwitchingTask(e){Array.add(this._switchingTasks,e)}addScope(e){if(!Array.contains(this._scopeNames,e)){const t=new A(e);Array.add(this._scopeNames,e),Array.add(this._scopes,t)}}removeScope(e){if(Array.contains(this._scopeNames,e)){const t=this.getScopeIndex(e);t===this._currentScopeIndex?this.setScope(null):t<this._currentScopeIndex&&this._currentScopeIndex--,this.getScopeAtIndex(t).dispose();const n=this._regions[e];n&&(this._regions[e]=null,Array.remove(this._regionList,n),n.dispose()),Array.removeAt(this._scopes,t),Array.removeAt(this._scopeNames,t)}}getScope(e){return e?(this.addScope(e),this.getScopeAtIndex(this.getScopeIndex(e))):null}pushScope(e,t){this._currentScopeIndex!==k&&Array.insert(this._scopeStack,0,this.currentScope.name),this.updateCurrentScope(e,t,!1)}popScope(e,t=!0){let n=null;if(this._scopeStack.length>0)if(this.currentScope&&this.currentScope.name===e){const e=this._scopeStack[0],a=this.getScope(e);this.restoreToPreviousScope(!a.restoreFocusHandledExternally&&t)&&(n=this.currentScope.name)}else 0;E.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")&&"ReactTransientUI"===e&&this._eventSource.raiseEvent(P.onReactTransientUIFocusScopeRemovedEventKey),n||(n=P.f6Manager.getHighestPriority(),n&&this.setScopeRestore(n,t))}peekNonReactTransientUiScope(){for(let e=0;e<this._scopeStack.length;e++)if("ReactTransientUI"!==this._scopeStack[e])return this._scopeStack[e];return""}tryGrabFocus(e){const t=!!this.currentScope&&this.currentScope.name===e;return t&&this.popScope(e),t}focusLastEditableSurface(){m.AFrameworkApplicationConstants.activeFrame.restoreFocusAfterExecutingActionFromRibbon()}addEditableFocusScope(e){this._editableFocusScopesActiveStateMap[e]=!1}activateEditableFocusScope(e){e in this._editableFocusScopesActiveStateMap&&(this._editableFocusScopesActiveStateMap[e]=!0)}deactivateEditableFocusScope(e){e in this._editableFocusScopesActiveStateMap&&(this._editableFocusScopesActiveStateMap[e]=!1)}isEditableFocusScopeActivated(e){return e in this._editableFocusScopesActiveStateMap&&this._editableFocusScopesActiveStateMap[e]}restoreToPreviousScope(e){let t=!1;if(this._scopeStack.length){let n=this._scopeStack[0];if(Array.removeAt(this._scopeStack,0),Array.contains(this._scopeNames,n)){const a=this.getScope(n);!a.containerScope||a.name in this._editableFocusScopesActiveStateMap&&this._editableFocusScopesActiveStateMap[a.name]||(n=a.containerScope),t=this.setScopeRestore(n,e),t||(t=this.restoreToPreviousScope(e))}else t=this.restoreToPreviousScope(e)}else this.setScopeToDefault();return t}tryChangeScopeOnStealingFocusEvent(e,t,n,a){(t||g.a.isEditable(a.sourceElement))&&(this.scopeChanged(e),n&&a.innerEvent.stopPropagation())}buildRegion(e,t,n){return this.buildRegionWithDelegate((()=>e),t,n)}buildRegionWithDelegate(e,t,n){this.removeRegion(t);const a=new f(t,n,e,P.instance());return this._regions[t.name]=a,Array.add(this._regionList,a),t.bindAction(this._tabInput,y.a.regionMoveForward),t.bindAction(this._tabShiftInput,y.a.regionMoveBackward),a}removeRegion(e){if(this._regions[e.name]){const t=this._regions[e.name];Array.remove(this._regionList,t),t.dispose(),this._regions[e.name]=null,e.unBindAction(this._tabInput),e.unBindAction(this._tabShiftInput)}}getRegion(e){let t=e,n=null;for(;t&&!n;)n=this._regions[t],n||(t=this.getScope(t).parent);return n}getCurrentRegion(){return void 0===this.currentScope||null===this.currentScope?null:this.getRegion(this.currentScope.name)}tabIntoRegionTop(e){const t=this.getCurrentRegion();for(let n=0;n<this._regionList.length;n++){const a=this._regionList[n];if(a.enabled&&a.listing.firstElement===e&&a!==t)return this.scopeChanged(a.scope.name),a.listing.forceSetCurrentElement(e),!0}return!1}tabIntoRegionBottom(e){const t=this.getCurrentRegion();for(let n=0;n<this._regionList.length;n++){const a=this._regionList[n];if(a.enabled&&a.listing.lastElement===e&&a!==t)return this.scopeChanged(a.scope.name),a.listing.forceSetCurrentElement(e),!0}return!1}setupTabChecks(e,t,n,a){this._root=t,this._validTags=n,this._tabChecksDocument=e,this._tabChecksKeyInputManager=a,this._tabChecksKeyInputManager.registerHandlerWithDocument(u.a.keyDown,this._tabChecksDocument,this._keyDownHandler,null)}checkTab(e){if(null!=e&&"body"!==F.a.toLower(e.tagName)){T.a.mark(4698);const t=n(5278).a.findNextElement(e,this._root,this._validTags),a=!!t&&(this.tabIntoRegionTop(t)||e===n(5278).a.firstInElement(this._root,this._validTags)&&this.tabIntoRegionTop(e));return T.a.mark(4699),a}return!1}checkTabShift(e){if(null!=e&&"body"!==F.a.toLower(e.tagName)){T.a.mark(4698);const t=n(5278).a.findPreviousElement(e,this._root,this._validTags),a=!!t&&(this.tabIntoRegionBottom(t)||e===n(5278).a.lastInElement(this._root,this._validTags)&&this.tabIntoRegionBottom(e));return T.a.mark(4699),a}return!1}getPerformanceNowByDOMDocument(e){let t=null;const n=e.defaultView;if(n){const e=n.performance;if(e){e.now&&(t=e.now())}}return t}get addTriggerTimeTelemetryEnabled(){return!this._addTriggerTimeTelemetryEnabled&&E.AFrameworkApplication_AppSettingsManager.appSettingsManager&&(this._addTriggerTimeTelemetryEnabled=E.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("AddTriggerTimeTelemetryEnabled")),!!this._addTriggerTimeTelemetryEnabled&&this._addTriggerTimeTelemetryEnabled}runSwitchingTasks(e,t){for(let n=0;n<this._switchingTasks.length;n++){(0,this._switchingTasks[n])(e,t)}}setScopeToDefault(){this.defaultScopeName&&this.setScope(this.defaultScopeName)}updateCurrentScope(e,t,n){let a=this.currentScope;const i=this.currentScope;if(!a&&e||a&&(a.name!==e||n)){if(e&&this.addScope(e),a&&this.delegatesEnabled&&this._currentWithDelegates&&this.runOnBlur(a,e?this.getScope(e):null),e in this._editableFocusScopesActiveStateMap&&(this._lastEditableFocusScope=e),t&&this.delegatesEnabled&&this.runSwitchingTasks(a,this.getScope(e)),this._currentScopeIndex=this.getScopeIndex(e),this._currentScopeIndex!==k){const e=a;a=this.currentScope,this.delegatesEnabled?(t&&this.runSetFocus(a,e),this.runOnFocus(a,e),this._currentWithDelegates=!0):this._currentWithDelegates=!1}0,this._eventSource.raiseEvent(P.onFocusScopeChangedEventKey,new b(i,this.getScope(e)))}else 0}getScopeIndex(e){return Array.contains(this._scopeNames,e)?Array.indexOf(this._scopeNames,e):k}getScopeAtIndex(e){return e===k?null:this._scopes[e]}findAction(e,t){if(!e)return null;let n=e.getAction(t);return!n&&e.parent&&(n=this.findAction(this.getScope(e.parent),t)),n}findDefaultAction(e,t){if(!e)return null;return e.getDefaultAction(t)}runOnBlur(e,t){e.runOnBlur(t);const n=this.getScope(e.parent);n&&this.runOnBlur(n,t)}runOnFocus(e,t){const n=this.getScope(e.parent);n&&this.runOnFocus(n,t),e.runOnFocus(t)}runSetFocus(e,t){const n=this.getScope(e.parent);n&&this.runSetFocus(n,t),e.runSetFocus(t)}clearScopeStackIfNewScope(e,t=!1){this._scopeStack.length>0&&(this._scopeStack[0]===e||t)&&Array.clear(this._scopeStack)}static usable(){return!!m.AFrameworkApplicationConstants.activeFrame&&!!P._instance}static instance(){return P._instance||(P._instance=new P((0,i.h)(o)))}static get f6Manager(){return m.AFrameworkApplicationConstants.activeFrame?m.AFrameworkApplicationConstants.activeFrame.theF6Manager:null}static trySetActive(e){try{return e.setActive(),!0}catch(e){return!1}}static trySetActiveIfNotFocus(e){w.a.browserSupportsSetActive(e)?P.trySetActive(e):P.tryFocus(e),r.ULS.sendTraceTag(505537571,310,50,"browserSupportsSetActive: {0}.",w.a.browserSupportsSetActive(e))}static tryBlur(e){try{return e.blur(),!0}catch(e){return!1}}static tryBlurActiveElement(){try{return document.activeElement.blur(),!0}catch(e){return!1}}static registerActions(e){e.addAction(y.a.blockIfFocusedTextField,I.a.frame,P.blockIfFocusedTextField),e.addActionWithFlags(y.a.blockIfNotFocusedTextField,I.a.frame,P.blockIfNotFocusedTextField,96)}static registerShortcuts(e){e.getScope("app").bindAction(s.a.hashKey(l.a.vK_Backspace,0),y.a.blockIfNotFocusedTextField)}static blockIfFocusedTextField(e,t,n,a,i){const o=document.body.ownerDocument,r=h.a.getActiveElement(o);return r&&h.a.isTextField(r)?32:4}static blockIfNotFocusedTextField(e,t,n,a,i){const o=document.body.ownerDocument,r=h.a.getActiveElement(o);return r&&h.a.isTextField(r)?4:32}static moveForwardAction(e,t,n,a,i){const o=P.instance().getCurrentRegion();return o?o.moveForward()?32:4:(r.ULS.sendTraceTag(19261475,310,10,"CurrentRegion is null with scope name {0}.",P.instance().currentScope?P.instance().currentScope.name:"[NotExist]"),8)}static moveBackwardAction(e,t,n,a,i){const o=P.instance().getCurrentRegion();return o?o.moveBackward()?32:4:(r.ULS.sendTraceTag(19261504,310,10,"CurrentRegion is null with scope name {0}.",P.instance().currentScope?P.instance().currentScope.name:"[NotExist]"),8)}logKeyInputCounter(){if(P.keyInputCounter){const e=[],t=[];P.keyInputCounter.forEach(((n,a)=>{const i=n.length;i>0&&n[i-1].isPastEvent()&&(n.forEach((t=>{e.push(t)})),t.push(a))})),e.length&&r.ULS.sendTraceTag(508130112,801,50,M.a.toJSON(e)),t.forEach((e=>{P.keyInputCounter.delete(e)}))}}recordKeyCounter(e){if(!(E.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("EnableRecordingCountOfKeyInput")&&e&&e.rawEvent&&window.requestIdleCallback))return;const t=D.generateKey(e);let n=[];if(P.keyInputCounter.has(t)){n=P.keyInputCounter.get(t);const e=n.length;e>0&&!n[e-1].isPastEvent()?n[e-1].recordHit():n.push(new D(t))}else n.push(new D(t));P.keyInputCounter.set(t,n),this.enqueueTask(this.logKeyInputCounter)}enqueueTask(e,t=void 0){P.taskList.push({handler:e,data:t}),P.taskHandle||(window.requestIdleCallback?P.taskHandle=window.requestIdleCallback(this.runTaskQueue,{timeout:1e3}):(P.keyInputCounter.clear(),P.taskList=[],P.taskHandle=void 0))}runTaskQueue(e){for(;(e.timeRemaining()>0||e.didTimeout)&&P.taskList.length;){const e=P.taskList.shift();try{e.handler(e.data)}catch(e){return P.keyInputCounter.clear(),P.taskList=[],void(P.taskHandle=void 0)}}if(P.taskList.length)try{P.taskHandle=window.requestIdleCallback(this.runTaskQueue,{timeout:1e3})}finally{P.keyInputCounter.clear(),P.taskList=[],P.taskHandle=void 0}else P.taskHandle=void 0}static disposeInputManager(){v.a.safeDispose(P._instance)}static reset(){P._instance=null}constructor(e){super(),this._highlightedScopes=void 0,this._highlightedElements=void 0,this._highlightActivated=void 0,this._tabInput=s.a.hashKey(l.a.vK_Tab,0),this._tabShiftInput=s.a.hashKey(l.a.vK_Tab,4),this._scopeNames=[],this._scopes=[],this._scopeStack=[],this._regions={},this._regionList=[],this._switchingTasks=[],this._delegatesEnabled=!0,this._currentWithDelegates=!1,this._root=null,this._validTags=null,this._tabChecksDocument=null,this._tabChecksKeyInputManager=null,this._isDisposed=!1,this._addTriggerTimeTelemetryEnabled=null,this._eventSource=new c.a,this._editableFocusScopesActiveStateMap={document:!0,CommentPane:!1,FloatingContainersHostFocusScope:!1},this._lastEditableFocusScope=null,this.inSetFocus=!1,this.inForceSetFocus=!1,this.keyDownHandler=e=>{if(this.currentScope&&this.currentScope.keyDownHandledExternally)return!1;const t=e.innerEvent,n=s.a.hashEvent(t),a=t.target;return n===this._tabInput&&this.checkTab(a)||n===this._tabShiftInput&&this.checkTabShift(a)};const{AFrameworkApplication_ActionManager:t}=n(1510);this._actionManager=t.theActionManager,this._currentScopeIndex=k,this.defaultScopeName=null,this._actionManager.addAction(y.a.regionMoveForward,I.a.frame,P.moveForwardAction),this._actionManager.addAction(y.a.regionMoveBackward,I.a.frame,P.moveBackwardAction),this._keyDownHandler=this.keyDownHandler,this._processInputStrategyFuture=e}}P.keyInputCounter=new Map,P.browserFocusId="Browser",P.editingFocusId="editing",P._instance=null,P.onFocusScopeChangedEventKey="OnFocusScopeChanged",P.onReactTransientUIFocusScopeRemovedEventKey="OnReactTransientUIFocusScopeRemoved",P.taskList=[],P.taskHandle=void 0,(0,a.a)(P,"FocusManager",S.a,[11,94]);class D{static generateKey(e){return e?`${String.fromCharCode(e.keyCode)}${e.ctrlKey?"_ctrl":""}${e.altKey?"_alt":""}${e.shiftKey?"_shift":""}`:""}isPastEvent(){return Date.now()-this.lastHit>D.threshold}recordHit(){this.count++,this.lastHit=Date.now()}constructor(e){this.keyName=e,this.count=1,this.lastHit=Date.now()}}D.threshold=500,(0,a.a)(D,"KeyCounterData",null,[])},2734:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static tryFocus(e){try{return e.focus(),!0}catch(e){return!1}}}(0,a.a)(i,"FocusManagerStatic",null,[])},8765:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.IKeyMoveAdapter")},5900:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.touchClickAdapterCache="#t",i.touchAndHoldAdapterCache="#th",i.gestureAdapterCache="#g",i.dragAdapterCache="#d",(0,a.a)(i,"InputDataNameConstants",null,[])},7531:function(e,t,n){"use strict";n.d(t,{a:function(){return l}});var a=n(100),i=n(2929),o=n(5861),r=n(4397);const s="InputCancelled";class l{static get _eventSource(){return r.a.eventSource}static set _eventSource(e){r.a.eventSource=e}get isEnabled(){return this._isEnabled}set isEnabled(e){this._isEnabled=e}dispose(){for(this.releaseCapture(),this.resume();this._controlledElements.length>0;)this.deinitializeForElement(this._controlledElements[0]);Array.clear(this._controlledElements),l._refCount--}suspend(){this._supressEvents=!0}resume(){this._supressEvents=!1}registerPostEventCallback(e){this._postEventCallback=e}releaseCapture(){}initializeForElement(e){Array.add(this._controlledElements,e)}deinitializeForElement(e){Array.remove(this._controlledElements,e)}addDomEventHandler(e,t,n,a=!1){a?e.addEventListener(t,n,a):$addHandler(e,t,n)}removeDomEventHandler(e,t,n,a=!1){a?e.removeEventListener(t,n,a):$removeHandler(e,t,n)}static add_onInputCancelled(e){l._eventSource.addHandler(s,e)}static remove_onInputCancelled(e){l._eventSource.removeHandler(s,e)}static setEnsureAppAwakeCallback(e){l._ensureAppAwakeCallback=e}static setEnsureAppAwakeIfAsleepCallback(e){l._ensureAppAwakeIfAsleepCallback=e}static ensureAppAwake(){l._ensureAppAwakeCallback&&l._ensureAppAwakeCallback()}static ensureAppAwakeIfAsleep(){l._ensureAppAwakeIfAsleepCallback&&l._ensureAppAwakeIfAsleepCallback()}static addHandler(e,t,a){const{EventHandlerManager:i}=n(9865);i.instance.registerRawEventHandler(t,e,a)}static removeHandler(e,t,a){const{EventHandlerManager:i}=n(9865);i.instance.unregisterRawEventHandler(t,e,a)}static registerEventsToBeIgnored(e,t){const{EventHandlerManager:a}=n(9865);a.instance.initializeListForElement(t,e,0,((e,t,n)=>(n.rawEvent[l.markerFieldForEventsToBeIgnored]=!0,!1)))}static unregisterEventsToBeIgnored(e,t){const{EventHandlerManager:a}=n(9865);a.instance.deinitializeListForElement(e,t)}static removeAllHandlers(e){$clearHandlers(e)}static cancelEventNoPreventDefault(e){r.a.cancelEventInternal(e,!1)}static cancelEvent(e){r.a.cancelEvent(e)}static cancelEventInternal(e,t){return r.a.cancelEventInternal(e,t)}static eventLandedBeyondSourceElement(e){const t=e.rawEvent,a=i.a.getSourceElement(e);if(!a.ownerDocument)return!1;if(Sys.UI.DomElement.containsCssClass(a,"ignore-scroll-bounds-check"))return!1;let r=!1,s=a.clientWidth,l=a.clientHeight;const c=n(6776).AFrameworkApplicationConstants.getCurrentZoom();if(s*=c,l*=c,s&&l){if(s===a.offsetWidth&&l===a.offsetHeight)return!1;const e=o.a.getElementBounds(a),n=new Sys.UI.Bounds(e.x,e.y,s,l);if(o.a.isBoundsEqual(e,n))return!1;const i=new Sys.UI.Point(t.clientX,t.clientY);r=!o.a.isPointInBounds(n,i)}return r}constructor(){this._controlledElements=[],this._isEnabled=!0,this._allocationCallstack=null,this._postEventCallback=()=>{},l._refCount++,this._supressEvents=!1}}l.markerFieldForEventsToBeIgnored="shouldBeIgnoredByMsospHandlers",l._refCount=0,l._ensureAppAwakeIfAsleepCallback=null,l._ensureAppAwakeCallback=null,l._allocatedInputManagers=void 0,l._trackedKeys=void 0,l._uniqueTrackedKeys=void 0,l._trackedMap=void 0,l._nextUniqueId=void 0,l.isLeakDetectionEnabled=void 0,l.cancelEventHandler=r.a.cancelEvent,(0,a.a)(l,"InputManager",null,[11])},4397:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(6012),o=n(5018);class r{static get eventSource(){return this._eventSource}static set eventSource(e){this._eventSource=e}static cancelEvent(e){r.cancelEventInternal(e,!0)}static cancelEventInternal(e,t){if(e.stopPropagation(),t&&e.preventDefault(),e.rawEvent&&e.rawEvent.keyCode)try{e.rawEvent.keyCode=0}catch(e){}Array.contains(i.a.keyTypedEvents,e.type)&&r._eventSource.raiseEvent("InputCancelled")}}r._eventSource=new o.a,(0,a.a)(r,"InputManagerStatic",null,[])},6295:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var a,i=n(100);!function(e){e[e.notDefined=-1]="notDefined",e[e.unknown=0]="unknown",e[e.keyboard=1]="keyboard",e[e.mouse=2]="mouse",e[e.touch=3]="touch",e[e.pen=4]="pen",e[e.voice=5]="voice",e[e.selectionchange=6]="selectionchange",e[e.crossSlide=9]="crossSlide"}(a||(a={})),(0,i.b)("InputMethod",a)},5072:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(1163);class o{static get vK_SemiColon(){return i.a.isFirefox?o.VK_FirefoxSemiColonAndColon:186}static get vK_EqualSign(){return i.a.isFirefox?o.VK_FirefoxEquals:187}static get vK_Hyphen(){return i.a.isFirefox?o.VK_FirefoxMinus:189}static get keyCodePairs(){return o._keyCodePairs||(o._keyCodePairs={undefined:o.VK_UNDEFINED,backspace:o.vK_Backspace,tab:o.vK_Tab,enter:o.vK_Enter,shift:o.vK_Shift,control:o.vK_Control,ctrl:o.vK_Ctrl,alt:o.vK_Alt,pause:o.vK_Pause,capslock:o.vK_CapsLock,esc:o.vK_Esc,escape:o.vK_Escape,space:o.vK_Space,spacebar:o.vK_Spacebar,pageup:o.vK_PageUp,pagedown:o.vK_PageDown,end:o.vK_End,home:o.vK_Home,left:o.vK_Left,leftarrow:o.vK_LeftArrow,up:o.vK_Up,uparrow:o.vK_UpArrow,right:o.vK_Right,rightarrow:o.vK_RightArrow,down:o.vK_Down,downarrow:o.vK_DownArrow,ins:o.vK_Ins,insert:o.vK_Insert,0:o.VK_0,1:o.VK_1,2:o.VK_2,3:o.VK_3,4:o.VK_4,5:o.VK_5,6:o.VK_6,7:o.VK_7,8:o.VK_8,9:o.VK_9,a:o.VK_A,b:o.VK_B,c:o.VK_C,d:o.VK_D,e:o.VK_E,f:o.VK_F,g:o.VK_G,h:o.VK_H,i:o.VK_I,j:o.VK_J,k:o.VK_K,l:o.VK_L,m:o.VK_M,n:o.VK_N,o:o.VK_O,p:o.VK_P,q:o.VK_Q,r:o.VK_R,s:o.VK_S,t:o.VK_T,u:o.VK_U,v:o.VK_V,w:o.VK_W,x:o.VK_X,y:o.VK_Y,z:o.VK_Z,windows:o.vK_Windows,openapple:o.vK_OpenApple,meta:o.vK_Meta,contextmenu:o.vK_ContextMenu,numpad0:o.vK_NumPad0,numpad1:o.vK_NumPad1,numpad2:o.vK_NumPad2,numpad3:o.vK_NumPad3,numpad4:o.vK_NumPad4,numpad5:o.vK_NumPad5,numpad6:o.vK_NumPad6,numpad7:o.vK_NumPad7,numpad8:o.vK_NumPad8,numpad9:o.vK_NumPad9,numpadmultiply:o.vK_NumPadMultiply,numpadplus:o.vK_NumPadPlus,numpadminus:o.vK_NumPadMinus,numpaddot:o.vK_NumPadDot,numpaddivide:o.vK_NumPadDivide,f1:o.VK_F1,f2:o.VK_F2,f3:o.VK_F3,f4:o.VK_F4,f5:o.VK_F5,f6:o.VK_F6,f7:o.VK_F7,f8:o.VK_F8,f9:o.VK_F9,f10:o.VK_F10,f11:o.VK_F11,f12:o.VK_F12,del:o.vK_Del,delete:o.vK_Delete,numlock:o.vK_NumLock,scrolllock:o.vK_ScrollLock,printscreen:o.vK_PrintScreen,semicolon:o.vK_SemiColon,equalsign:o.vK_EqualSign,comma:o.vK_Comma,dash:o.vK_Dash,hyphen:o.vK_Hyphen,period:o.vK_Period,slash:o.vK_Slash,backquote:o.vK_BackQuote,leftbracket:o.vK_LeftBracket,backslash:o.vK_BackSlash,rightbracket:o.vK_RightBracket,singlequote:o.vK_SingleQuote,f13:o.VK_F13,f14:o.VK_F14,f15:o.VK_F15,f16:o.VK_F16,f17:o.VK_F17,f18:o.VK_F18,f19:o.VK_F19,f20:o.VK_F20,f21:o.VK_F21,f22:o.VK_F22,f23:o.VK_F23,f24:o.VK_F24})}static fromString(e){const t=o.keyCodePairs[e];return t||0}static isAlphanumericKeyCode(e){return e>=48&&e<=57||e>=65&&e<=90}}o.VK_UNDEFINED=0,o.vK_Backspace=8,o.vK_Tab=9,o.vK_Enter=13,o.vK_Shift=16,o.vK_Control=17,o.vK_Ctrl=17,o.vK_Alt=18,o.vK_Pause=19,o.vK_CapsLock=20,o.vK_RightCtrl=25,o.vK_Esc=27,o.vK_Escape=27,o.vK_Space=32,o.vK_Spacebar=32,o.vK_PageUp=33,o.vK_PageDown=34,o.vK_End=35,o.vK_Home=36,o.vK_Left=37,o.vK_LeftArrow=37,o.vK_Up=38,o.vK_UpArrow=38,o.vK_Right=39,o.vK_RightArrow=39,o.vK_Down=40,o.vK_DownArrow=40,o.vK_Ins=45,o.vK_Insert=45,o.VK_0=48,o.VK_1=49,o.VK_2=50,o.VK_3=51,o.VK_4=52,o.VK_5=53,o.VK_6=54,o.VK_7=55,o.VK_8=56,o.VK_9=57,o.VK_A=65,o.VK_B=66,o.VK_C=67,o.VK_D=68,o.VK_E=69,o.VK_F=70,o.VK_G=71,o.VK_H=72,o.VK_I=73,o.VK_J=74,o.VK_K=75,o.VK_L=76,o.VK_M=77,o.VK_N=78,o.VK_O=79,o.VK_P=80,o.VK_Q=81,o.VK_R=82,o.VK_S=83,o.VK_T=84,o.VK_U=85,o.VK_V=86,o.VK_W=87,o.VK_X=88,o.VK_Y=89,o.VK_Z=90,o.vK_Windows=91,o.vK_OpenApple=91,o.vK_Meta=91,o.vK_ContextMenu=93,o.vK_NumPad0=96,o.vK_NumPad1=97,o.vK_NumPad2=98,o.vK_NumPad3=99,o.vK_NumPad4=100,o.vK_NumPad5=101,o.vK_NumPad6=102,o.vK_NumPad7=103,o.vK_NumPad8=104,o.vK_NumPad9=105,o.vK_NumPadMultiply=106,o.vK_NumPadPlus=107,o.vK_NumPadMinus=109,o.vK_NumPadDot=110,o.vK_NumPadDivide=111,o.VK_F1=112,o.VK_F2=113,o.VK_F3=114,o.VK_F4=115,o.VK_F5=116,o.VK_F6=117,o.VK_F7=118,o.VK_F8=119,o.VK_F9=120,o.VK_F10=121,o.VK_F11=122,o.VK_F12=123,o.vK_Del=127,o.vK_Delete=127,o.vK_NumLock=144,o.vK_ScrollLock=145,o.vK_PrintScreen=154,o.vK_Comma=188,o.vK_Dash=189,o.vK_Period=190,o.vK_Slash=191,o.vK_BackQuote=192,o.vK_LeftBracket=219,o.vK_BackSlash=220,o.vK_RightBracket=221,o.vK_SingleQuote=222,o.VK_IME=229,o.VK_INVALID_BEGIN=256,o.VK_INVALID_END=61439,o.VK_FirefoxMinus=173,o.VK_FirefoxEquals=61,o.VK_FirefoxSemiColonAndColon=59,o.VK_F13=61440,o.VK_F14=61441,o.VK_F15=61442,o.VK_F16=61443,o.VK_F17=61444,o.VK_F18=61445,o.VK_F19=61446,o.VK_F20=61447,o.VK_F21=61448,o.VK_F22=61449,o.VK_F23=61450,o.VK_F24=61451,o._keyCodePairs=null,(0,a.a)(o,"KeyCode",null,[])},2544:function(e,t,n){"use strict";n.d(t,{a:function(){return I}});var a=n(100),i=n(5149),o=n(8511),r=n(6012),s=n(5072),l=n(7531),c=n(7939),d=n(9865),u=n(2929),p=n(1163);class g extends u.a{get commandKey(){const e=this.innerEvent.rawEvent;return!!e&&(p.a.isMac?e.metaKey:e.ctrlKey)}get isCopy(){if(this.commandKey){const e=this.innerEvent.rawEvent;if(e&&e.keyCode===s.a.VK_C)return!0}return!1}get isCut(){if(this.commandKey){const e=this.innerEvent.rawEvent;if(e&&e.keyCode===s.a.VK_X)return!0}return!1}get isFind(){if(this.commandKey){const e=this.innerEvent.rawEvent;if(e&&e.keyCode===s.a.VK_F)return!0}return!1}static create(e,t){return new g(e,u.a.getSourceElement(t),t)}constructor(e,t,n){super(e,t,n,1)}}(0,a.a)(g,"KeyEventArgs",u.a,[]);var h=n(5018);class m extends h.a{add_onCtrlKeyDown(e){this.addHandler(m.onCtrlKeyDownEventKey,e)}remove_onCtrlKeyDown(e){this.removeHandler(m.onCtrlKeyDownEventKey,e)}add_onCtrlKeyUp(e){this.addHandler(m.onCtrlKeyUpEventKey,e)}remove_onCtrlKeyUp(e){this.removeHandler(m.onCtrlKeyUpEventKey,e)}static instance(){return m._instance||(m._instance=new m)}constructor(){super()}}m.onCtrlKeyDownEventKey="OnCtrlKeyDown",m.onCtrlKeyUpEventKey="OnCtrlKeyUp",m._instance=null,(0,a.a)(m,"PressCtrlKeyEvent",h.a,[]);var _=n(3299);class S{static getAnInstanceWithResolvedDependencies(){return new _.a((()=>new S))}static get instance(){return S._instance.value}constructor(){this.keyCode=0}}S._instance=S.getAnInstanceWithResolvedDependencies(),(0,a.a)(S,"PressOnlyKeyArgs",null,[]);class f extends h.a{add_onKeyCodeWasPressedOnly(e){this.addHandler(f.onKeyCodeWasPressedOnlyEventKey,e)}remove_onKeyCodeWasPressedOnly(e){this.removeHandler(f.onKeyCodeWasPressedOnlyEventKey,e)}static instance(){return f._instance||(f._instance=new f)}constructor(){super()}}f.onKeyCodeWasPressedOnlyEventKey="OnKeyCodeWasPressedOnly",f._instance=null,(0,a.a)(f,"PressOnlyKeyEvent",h.a,[]);var C=n(6534),y=n(657),A=n(680),b=n(7958),T=n(9858),v=n(988),w=n(4397),F=n(3026);class I extends l.a{get lastKeyStroke(){return this._keyInputManagerHelperInstance.lastKeyStroke}set lastKeyStroke(e){this._keyInputManagerHelperInstance.lastKeyStroke=e}get lastKeyStrokeTimestamp(){return this._keyInputManagerHelperInstance.lastKeyStrokeTimestamp}set lastKeyStrokeTimestamp(e){this._keyInputManagerHelperInstance.lastKeyStrokeTimestamp=e}get currentKeyEvent(){return this._currentEventArgs}initializeForElement(e){super.initializeForElement(e),this._eventHandlerManager.initializeListForElement(r.a.keyEvents,e.ownerDocument,2,this.onKeyEvent)}deinitializeForElement(e){super.deinitializeForElement(e),this._eventHandlerManager.deinitializeListForElement(e.ownerDocument,r.a.keyEvents)}registerHandler(e,t,n){this.registerHandlerWithCaptureOption(e,t,n)}registerHandlerWithCaptureOption(e,t,n,a=!1){this._eventHandlerManager.registerHandler(e,t,2,this.onKeyEvent,n,null,a)}registerHandlerForAllKeyEvents(e,t,...n){const a=e=>!!Array.contains(n,e.innerEvent.keyCode)&&(e.eventName!==r.a.keyUp||t(e));for(const t of this._keyEvents)this.registerHandler(t,e,a);return a}registerHandlerWithData(e,t,n,a){this._eventHandlerManager.registerHandler(e,t,2,this.onKeyEvent,n,a)}registerHandlerWithDocument(e,t,n,a=null){this._eventHandlerManager.registerHandler(e,t,2,this.onKeyEvent,n,a)}unregisterHandler(e,t,n){this.unregisterHandlerWithCaptureOption(e,t,n)}unregisterHandlerWithCaptureOption(e,t,n,a=!1){this._eventHandlerManager.unregisterHandler(e,t,n,a)}unregisterHandlerForAllKeyEvents(e,t){for(const n of this._keyEvents)this.unregisterHandler(n,e,t)}unregisterHandlerWithDocument(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)}capture(e,t){this._capturedHandler=new c.a(e,t)}releaseCapture(){this._capturedHandler=null}resume(){super.resume(),this._forwardKeyPressToKeyDown=!0}fireKeyEvent(e,t,n,a){const i=1==(1&a),o=2==(2&a),s=4==(4&a),l=8==(8&a);if(t.createEvent){const a=t.createEvent("KeyboardEvent");let c="";switch(e){case r.a.keyDown:c="keydown";break;case r.a.keyUp:c="keyup";break;case r.a.keyPress:c="keypress"}if(a.initKeyEvent)a.initKeyEvent(c,!0,!0,t.parentWindow,o,i,s,l,n,0);else if(a.initKeyboardEvent){const e=T.a.charCodeAt(T.a.toUpper(T.a.fromCharCode(n)),0);let r=T.a.getHexString(e);for(;r.length<4;)r="0"+r;r="U+"+r,a.initKeyboardEvent(c,!1,!0,t.defaultView,r,0,o,i,s,l,!1)}t.dispatchEvent(a)}else if(t.createEventObject){let a="";switch(e){case r.a.keyDown:a="keydown";break;case r.a.keyUp:a="keyup";break;case r.a.keyPress:a="keypress"}const c=t.createEventObject();c.keyCode=n,c.altKey=i,c.ctrlKey=o,c.shiftKey=s,c.metaKey=l,t.body.fireEvent("on"+a,c)}}rerouteKeyEvent(e,t,n){this.onKeyEvent(t,n,e)}processKeyActions(e){if(y.TaskManager.instance.isYielding){if(i.ULS.sendTraceTag(24699481,324,50,"Key event dropped."),I.additionalDroppedKeyLoggingIsEnabled){const e=y.TaskManager.instance;if(e){const t={};t.YieldingOperationName=e.yieldOperationName,C.d(v.a.droppedKey,void 0,void 0,void 0,void 0,void 0,t)}this._currentEventArgs&&(this._currentEventArgs.isCopy?i.ULS.sendTraceTag(539342808,324,15,"Unprocessed copy."):this._currentEventArgs.isCut?i.ULS.sendTraceTag(539342809,324,15,"Unprocessed cut."):this._currentEventArgs.isFind&&i.ULS.sendTraceTag(525336835,324,15,"Unprocessed find."))}return!0}const t=this._focusManager.processInput(e);return 4!==t&&(w.a.cancelEvent(e),2!==t)}onKeyEventInternal(e,t,a){const{FocusManager:i}=n(629),{AFrameworkApplicationConstants:o}=n(6776);let s=!1;if(i.instance().tryGrabFocus(o.postmessageFocusId),p.a.isMac&&p.a.isFirefox)if(e===r.a.keyDown)this._forwardKeyPressToKeyDown=!1,this._lastKeyDownReceived=a.keyCode;else if(e===r.a.keyPress){if(this._forwardKeyPressToKeyDown&&!s){const e=a.keyCode;a.keyCode=this._lastKeyDownReceived,s=this.processKeyEvent(a,r.a.keyDown,t),a.keyCode=e}this._forwardKeyPressToKeyDown=!0}if(e===r.a.keyPress&&p.a.isFirefox){if(!(n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("BypassNonPrintableKeysCheckForKeyPressEvent")&&!!window.event)&&I.getKeyCodeFromDomEvent(a)||a.altKey||a.ctrlKey||I.getFieldFromDomEvent(a,"metaKey"))return!1}return e===r.a.keyDown&&p.a.isIPad&&(p.a.iPadOsVersion<=6||t===window.document)&&window.focus(),s||(s=this.processKeyEvent(a,e,t)),s}processKeyEvent(e,t,n){if(!this.isEnabled)return!1;if(this._supressEvents)return w.a.cancelEvent(e),!0;if(this.lastKeyStroke=new Date,this.lastKeyStrokeTimestamp=b.a.getTickCount(),l.a.ensureAppAwake(),this._capturedHandler)return this._currentEventArgs=g.create(t,e),this._capturedHandler.handler(this._currentEventArgs),w.a.cancelEvent(e),this._currentEventArgs=null,!0;const a=I.getBeforeKeyEventName(t);this._currentEventArgs=g.create(a,e);let i=this._eventHandlerManager.processEvent(a,n,this._currentEventArgs);return i?(this._currentEventArgs=null,!1):(t===r.a.keyDown&&(this._keyDownValues.add(e.keyCode),i=this.processKeyActions(e),this.raiseKeyDownEvents(e)),t===r.a.keyUp&&this.keyUpHandler(e),i||(this._currentEventArgs=g.create(t,e),i=this._eventHandlerManager.processEvent(t,n,this._currentEventArgs)),i&&w.a.cancelEvent(e),this._currentEventArgs=null,i)}raiseKeyDownEvents(e){e.keyCode===(p.a.isMac?s.a.vK_Meta:s.a.vK_Ctrl)&&this._pressCtrlKeyEvent.raiseEvent(m.onCtrlKeyDownEventKey)}keyUpHandler(e){if(1===this._keyDownValues.count&&Array.contains(this._pressOnlyKeys,e.keyCode))if(!I.keyCodeCheckPressOnlyKeyIsEnabled||this._keyDownValues.contains(e.keyCode)){const t=S.instance;t.keyCode=e.keyCode,this._pressOnlyKeyEvent.raiseEvent(f.onKeyCodeWasPressedOnlyEventKey,t)}else i.ULS.sendTraceTag(578318552,324,15,"_keyDownValues missing a key");this._keyDownValues=new o.a,e.keyCode===(p.a.isMac?s.a.vK_Meta:s.a.vK_Ctrl)&&this._pressCtrlKeyEvent.raiseEvent(m.onCtrlKeyUpEventKey)}setAltRight(e){const t=I.getFieldFromDomEvent(e,"location");this._isAltRight=null==t||1!==t}handleAltGr(e,t){return(e||t)&&this._isAltRight?":G":":A"}static get keyCodeCheckPressOnlyKeyIsEnabled(){const{AFrameworkApplication_AppSettingsManager:e}=n(2274);return null==I._keyCodeCheckPressOnlyKeyIsEnabled&&(I._keyCodeCheckPressOnlyKeyIsEnabled=!!e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("KeyCodeCheckPressOnlyKeyIsEnabled")),I._keyCodeCheckPressOnlyKeyIsEnabled}static get additionalDroppedKeyLoggingIsEnabled(){const{AFrameworkApplication_AppSettingsManager:e}=n(2274);return null==I._additionalDroppedKeyLoggingIsEnabled&&(I._additionalDroppedKeyLoggingIsEnabled=!!e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("AdditionalDroppedKeyLoggingIsEnabled")),I._additionalDroppedKeyLoggingIsEnabled}static get commandKeyModifier(){return p.a.isMac?8:2}static get instance(){return I._instance||(I._instance=I.getInstance()),I._instance}static get usable(){return!!I._instance}static getInstance(){const{FocusManager:e}=n(629);return new I(d.EventHandlerManager.instance,e.instance(),f.instance(),m.instance(),F.KeyInputManagerHelper.instance)}static disposeInputManager(){A.a.safeDispose(I._instance),I._instance=null}static isKeyEventName(e){return Array.contains(r.a.keyEvents,e)}static isImeKeyPress(e){let t;return t=void 0===e.innerEvent.keyCode||null===e.innerEvent.keyCode?e.innerEvent.charCode:e.innerEvent.keyCode,T.a.isEastAsianChar(t)}static getBeforeKeyEventName(e){switch(e){case r.a.keyDown:return r.a.beforeKeyDown;case r.a.keyUp:return r.a.beforeKeyUp;case r.a.keyPress:return r.a.beforeKeyPress;default:return e}}static hashEvent(e){e.keyCode===s.a.vK_Alt&&I.instance.setAltRight(e);const t=e.keyCode!==s.a.vK_Ctrl&&e.ctrlKey,a=e.keyCode!==s.a.vK_Windows&&I.getFieldFromDomEvent(e,"metaKey"),o=void 0===e.keyCode||null===e.keyCode?s.a.VK_UNDEFINED:e.keyCode;if(n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("LogCtrlAltKey")&&e.altKey&&t){let t=!0;e.keyCode!=s.a.vK_Alt&&e.keyCode!=s.a.vK_Ctrl&&(t=!1),i.ULS.sendTraceTag(507007433,324,50,"CtrlAltOnly:"+t)}return I.hash(o,e.altKey,t,e.shiftKey,a,!0)}static hasKeyModifiers(e){if(e&&e.innerEvent.rawEvent){const t=e.innerEvent.rawEvent;return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey}return!1}static hashKeyString(e){const t=e.indexOf(":"),n=(-1===t?e:e.substring(0,t)).toLowerCase();let a=s.a.fromString(n).toString()+(t>0?e.substr(t):"");return a=a.replace(":X",p.a.isMac?":M":":C"),a}static hashKey(e,t){return I.hash(e,1==(1&t),2==(2&t),4==(4&t),8==(8&t),!1)}static hash(e,t,n,a,i,o){let r=e.toString();return t&&(r+=o?I.handleAltGrHelper(n,i):":A"),a&&(r+=":S"),n&&(r+=":C"),i&&(r+=":M"),r}static handleAltGrHelper(e,t){return I.instance.handleAltGr(e,t)}static getKeyCodeFromDomEvent(e){return e?e.rawEvent?e.rawEvent.keyCode:e.keyCode:0}static getFieldFromDomEvent(e,t){return e?e.rawEvent?e.rawEvent[t]:e[t]:null}constructor(e,t,n,a,i=null){super(),this._keyEvents=[r.a.keyUp,r.a.keyDown,r.a.keyPress],this._keyDownValues=new o.a,this._pressOnlyKeys=[s.a.vK_Ctrl,s.a.vK_RightCtrl,s.a.vK_Shift,s.a.vK_Alt,s.a.vK_ContextMenu],this._currentEventArgs=null,this._forwardKeyPressToKeyDown=!0,this._lastKeyDownReceived=-1,this._isAltRight=!1,this._keyInputManagerHelperInstance=new F.KeyInputManagerHelper,this.onKeyEvent=(e,t,n)=>{const a=this.onKeyEventInternal(e,t,n);return this._postEventCallback(),a},i&&(this._keyInputManagerHelperInstance=i),this._eventHandlerManager=e,this._focusManager=t,this._supressEvents=!1,this._capturedHandler=null,this._pressOnlyKeyEvent=n,this._pressCtrlKeyEvent=a}}I._keyCodeCheckPressOnlyKeyIsEnabled=null,I._additionalDroppedKeyLoggingIsEnabled=null,I._instance=null,(0,a.a)(I,"KeyInputManager",l.a,[90,83,11])},3026:function(e,t,n){"use strict";n.r(t),n.d(t,{KeyInputManagerHelper:function(){return o}});var a=n(100),i=n(7958);class o{static get instance(){return o._instance||(o._instance=new o)}get lastKeyStroke(){return this._lastKeyStroke}set lastKeyStroke(e){this._lastKeyStroke=e}get lastKeyStrokeTimestamp(){return this._lastKeyStrokeTimestamp}set lastKeyStrokeTimestamp(e){this._lastKeyStrokeTimestamp=e}constructor(){this.lastKeyStroke=new Date,this.lastKeyStrokeTimestamp=i.a.getTickCount()}}o._instance=null,(0,a.a)(o,"KeyInputManagerHelper",null,[])},2217:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var a=n(100),i=n(5149),o=n(629),r=n(9865),s=n(7531),l=n(7939),c=n(6012),d=n(2929),u=n(1163);class p extends d.a{get mouseButton(){return this._button}get clientPoint(){return this._client}get screenPoint(){return this._screen}get elementPoint(){return this._element||(this._element=d.a.getElementPoint(this._client,this.sourceElement)),this._element}get wheelData(){return this._wheel}get caughtElement(){return this._caught}get shiftKey(){return this._shiftKey}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get commandKey(){return u.a.isMac?this._metaKey:this._ctrlKey}static create(e,t,n,a){if(a.rawEvent){const i=a.rawEvent,o=d.a.getSourceElement(a),r=new Sys.UI.Point(i.screenX,i.screenY),s=new Sys.UI.Point(i.clientX,i.clientY);let l=0;return e!==c.a.mouseWheel&&e!==c.a.wheel||(i.wheelDelta?(l=-i.wheelDelta/120,window.self.opera&&(l*=-1)):l=i.detail/3),new p(e,d.a.getMouseButton(i),s,null,r,l,o,t,i.shiftKey,i.altKey,i.ctrlKey,i.metaKey,n,a)}{const i=d.a.getSourceElement(a),o=new Sys.UI.Point(a.screenX,a.screenY),r=new Sys.UI.Point(a.clientX,a.clientY),s=!1,l=0;return new p(e,a.button,r,null,o,l,i,t,a.shiftKey,a.altKey,a.ctrlKey,s,n,a)}}static changeUserData(e,t){e.userData=t}constructor(e,t,n,a,i,o,r,s,l,c,d,u,p,g){super(e,r,g,2),this._client=n,this._element=a,this._screen=i,this._caught=s,this._wheel=o,this._button=t,this._shiftKey=l,this._altKey=c,this._ctrlKey=d,this._metaKey=u,this.userData=p}}(0,a.a)(p,"MouseEventArgs",d.a,[]);var g=n(657),h=n(6094),m=n(680),_=n(3245);class S extends s.a{initializeForElement(e){super.initializeForElement(e),this._eventHandlerManager.initializeListForElement(c.a.mouseEvents,e,2,this.onMouseEvent)}deinitializeForElement(e){super.deinitializeForElement(e),this._eventHandlerManager.deinitializeListForElement(e,c.a.mouseEvents)}registerHandler(e,t,n,a){this.registerHandlerWithCaptureOption(e,t,n,a,!1)}registerHandlerWithCaptureOption(e,t,n,a,i=!1){this._eventHandlerManager.registerHandler(e,t,2,this.onMouseEvent,n,a,i)}unregisterHandler(e,t,n){this.unregisterHandlerWithCaptureOption(e,t,n,!1)}unregisterHandlerWithCaptureOption(e,t,n,a=!1){this._eventHandlerManager.unregisterHandler(e,t,n,a)}capture(e,t){this._capturedHandler=new l.a(e,t)}releaseCapture(){this._capturedHandler=null}addControlFocus(e,t,n=!1,a=!1){const i=t=>(this._focusManager.tryChangeScopeOnStealingFocusEvent(e,a,n,t),!1);this.registerHandler(c.a.mouseDown,t,i,null),this._focusManager.getScope(e).addDispose((()=>{this.unregisterHandler(c.a.mouseDown,t,i)}))}static get instance(){return S._instance||(S._instance=new S),S._instance}static disposeInputManager(){m.a.safeDispose(S._instance),S._instance=null}static fireMouseEvent(e,t,n,a){const i=S.createMouseEvent(e,t,n,a);t.dispatchEvent?t.dispatchEvent(i):t.fireEvent&&t.fireEvent("on"+e,i)}static createMouseEvent(e,t,n,a){let i=null;if(window.document.createEvent)i=window.document.createEvent("MouseEvents"),i.initMouseEvent(e,!0,!0,window.self,0,n.x+Sys.UI.DomElement.getLocation(t).x+window.self.screenX,n.y+Sys.UI.DomElement.getLocation(t).y+window.self.screenY,n.x+Sys.UI.DomElement.getLocation(t).x,n.y+Sys.UI.DomElement.getLocation(t).y,!1,!1,!1,!1,a,null);else if(window.document.createEventObject)switch(i=window.document.createEventObject(),i.offsetX=n.x,i.offsetY=n.y,i.clientX=n.x+Sys.UI.DomElement.getLocation(t).x,i.clientY=n.y+Sys.UI.DomElement.getLocation(t).y,i.screenX=n.x+Sys.UI.DomElement.getLocation(t).x+window.screenX,i.screenY=n.y+Sys.UI.DomElement.getLocation(t).y+window.screenY,a){case 0:i.button=1;break;case 1:i.button=4;break;case 2:i.button=2}return i}constructor(){super(),this.onMouseEvent=(e,t,n)=>{if(e!==c.a.click&&e!==c.a.doubleClick&&e!==c.a.mouseWheel||o.FocusManager.instance().tryGrabFocus(_.AFrameworkApplication.postmessageFocusId),!this.isEnabled)return!1;if(!h.a.isValidElement(n.target))return!1;if(g.TaskManager.instance.isYielding)return i.ULS.sendTraceTag(24699482,324,50,"Mouse event dropped."),!1;if(e===c.a.mouseMove&&s.a.ensureAppAwakeIfAsleep(),this._supressEvents)return s.a.cancelEvent(n),!0;let a=null,r=!1;return this._capturedHandler?(a=p.create(e,t,this._capturedHandler.userData,n),r=this._capturedHandler.handler(a),r&&s.a.cancelEvent(n),r):(a=p.create(e,t,null,n),r=this._eventHandlerManager.processEvent(e,t,a),r&&s.a.cancelEvent(n),r)},this._supressEvents=!1,this._capturedHandler=null,this._eventHandlerManager=r.EventHandlerManager.instance,this._focusManager=o.FocusManager.instance()}}S._inputDataName="#m",S._instance=null,(0,a.a)(S,"MouseInputManager",s.a,[])},794:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});const a=e=>{if(null!=e){switch(e.toString().toLowerCase()){case"4":case"mouse":return 4;case"3":case"pen":return 3;case"2":case"touch":return 2}}return 0},i=e=>{let t=0;return e?(t=e.rawEvent?a(e.rawEvent.pointerType):a(e.pointerType),t):t}},9855:function(e,t,n){"use strict";n.d(t,{a:function(){return m}});var a=n(100),i=n(5149);class o{markPointerDownEventTime(){this._lastMsPointerDownTime=this._currentTimeGetter()}markMouseDownEventTime(){const e=this._currentTimeGetter()-this._lastMsPointerDownTime;e>250&&this._ulsReporter(e)}static getAnInstance(){return new o(o.getCurrentTime,o.reportToUls)}static getCurrentTime(){return(new Date).getTime()}static reportToUls(e){i.ULS.sendTraceTag(4248472,310,15,"msPointerDown before mousedown was {0}ms",e)}constructor(e,t){this._lastMsPointerDownTime=0,this._currentTimeGetter=e,this._ulsReporter=t}}(0,a.a)(o,"MissingPointerEventsTracker",null,[]);var r=n(7531),s=n(2929),l=n(9865),c=n(6012),d=n(794),u=n(1163);class p extends s.a{get mouseButton(){return this._button}get shiftKey(){return this._shiftKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get commandKey(){return u.a.isMac?this._metaKey:this._ctrlKey}get clientPoint(){return this._clientPoint}get pointerId(){return this._pointerId}get isPenEvent(){return this._isPenEvent}get preventDismissTransientUI(){return this._preventDismissTransientUI}static create(e,t,n,a,i){let o,r,l=!1;if(n.rawEvent){const e=n.rawEvent;o=s.a.getMouseButton(e),r=new Sys.UI.Point(e.clientX,e.clientY),l=e.metaKey,void 0!==e.clientX&&null!==e.clientX&&void 0!==e.clientX&&null!==e.clientX||3!==a||(r=s.a.getClientPointFromTouchEvent(n))}else o=n.button,r=new Sys.UI.Point(n.clientX,n.clientY);const c=n.shiftKey,d=n.ctrlKey;return new p(e,o,r,t,n,a,c,d,l,i)}constructor(e,t,n,a,i,o,r,s,l,c){let u;if(super(e,a,i,o),this._pointerId=0,this._button=t,this._clientPoint=n,this._shiftKey=r,this._ctrlKey=s,this._metaKey=l,this._preventDismissTransientUI=c,i.rawEvent){u=i.rawEvent.pointerId}else u=i.pointerId;this._pointerId=null!=u?u:-1;const p=d.a(i);this._isPenEvent=!(null==p)&&3===p}}(0,a.a)(p,"PointerEventArgs",s.a,[]);var g=n(680),h=n(3245);class m extends r.a{setupPointerEventDicts(e,t){this._pointerEventToBrowserEvents[e]=t;for(let n=0;n<t.length;++n)this._browserEventToPointerEvent[t[n]]=e}initializeForElement(e){super.initializeForElement(e);const t=c.a.pointerEvents;for(let n=0;n<t.length;++n)this.initializeBrowserEvents(t[n],e)}deinitializeForElement(e){super.deinitializeForElement(e);const t=c.a.pointerEvents;for(let n=0;n<t.length;++n)this.deInializeBrowserEvents(t[n],e)}registerHandler(e,t,n){this.registerHandlerWithCaptureOption(e,t,n,!1)}registerHandlerWithData(e,t,n,a){this.registerHandlerInternal(e,t,n,a)}registerHandlerWithCaptureOption(e,t,n,a=!1){this.registerHandlerInternal(e,t,n,null,a)}unregisterHandler(e,t,n){this.unregisterHandlerWithCaptureOption(e,t,n,!1)}unregisterHandlerWithCaptureOption(e,t,n,a=!1){this._eventHandlerManager.unregisterHandler(e,t,n,a),this.deInializeBrowserEvents(e,t,a)}registerOnBeforeEventProcessed(e,t){const n=this._pointerEventToBrowserEvents[e],a=this.buildOnBeforeEventProcessedHandler(t);this._eventHandlerManager.registerOnBeforeEventsProcessed(n,a)}registerHandlerInternal(e,t,n,a,i=!1){this._eventHandlerManager.registerHandler(e,t,2,this.onPointerEvent,n,a,i),this.initializeBrowserEvents(e,t,i)}buildOnBeforeEventProcessedHandler(e){return t=>{if(h.AFrameworkApplication.theTaskManager.isYielding)return;const n=c.a.eventNameFromString(t.type);if(this.shouldIgnoreDuplicateEvent(n))return;const a=this.buildPointerEventArgs(n,t);e(a)}}initializeBrowserEvents(e,t,n=!1){const a=this._pointerEventToBrowserEvents[e];if(null!=a)for(let e=0;e<a.length;++e)this._eventHandlerManager.initializeForElementInternal(a[e],t,2,this.onPointerEvent,n)}deInializeBrowserEvents(e,t,n=!1){const a=this._pointerEventToBrowserEvents[e];if(null!=a)for(let e=0;e<a.length;++e)this._eventHandlerManager.deinitializeForElementInternal(t,a[e],n)}shouldIgnoreDuplicateEvent(e){const t=e.startsWith("MSPointer");if(this._browserPointerEventsEnabled&&t)return!0;const n=e.startsWith("mouse");return(this._browserPointerEventsEnabled||this._msPointerEventsEnabled)&&n}buildPointerEventArgs(e,t){let n;n=t.rawEvent?s.a.getSourceElement(t):t.target;let a=m.getIeInputMethod(t);0===a&&(a=Array.contains(c.a.touchEvents,e)?3:2);const i=this.preventDismissTransientUIs?.()??!1,o=this._browserEventToPointerEvent[e];return p.create(o,n,t,a,i)}static get instance(){return m._instance||(m._instance=new m),m._instance}static set instance(e){m._instance=e}static disposeInputManager(){g.a.safeDispose(m._instance)}static getIeInputMethod(e){const t=d.a(e);if(null!=t)switch(t){case 4:case 3:return 2;case 2:return 3}return 0}constructor(){super(),this._browserPointerEventsEnabled=window.navigator.pointerEnabled,this._msPointerEventsEnabled=window.navigator.msPointerEnabled,this._missingPointerEventsTracker=o.getAnInstance(),this.onPointerEvent=(e,t,n)=>{if(h.AFrameworkApplication.theTaskManager.isYielding)return i.ULS.sendTraceTag(24699483,324,50,"Pointer event dropped."),!1;if(e!==c.a.msPointerDown&&e!==c.a.browserPointerDown||this._missingPointerEventsTracker.markPointerDownEventTime(),(this._msPointerEventsEnabled||this._browserPointerEventsEnabled)&&e===c.a.mouseDown&&this._missingPointerEventsTracker.markMouseDownEventTime(),this.shouldIgnoreDuplicateEvent(e))return!1;const a=this.buildPointerEventArgs(e,n),o=this._eventHandlerManager.processEvent(a.eventName,t,a);return o&&r.a.cancelEvent(n),o},this._eventHandlerManager=l.EventHandlerManager.instance,this._pointerEventToBrowserEvents={},this._browserEventToPointerEvent={},this._browserPointerEventsEnabled?(this.setupPointerEventDicts(c.a.pointerDown,[c.a.browserPointerDown,c.a.touchStart,c.a.mouseDown]),this.setupPointerEventDicts(c.a.pointerMove,[c.a.browserPointerMove,c.a.mouseMove]),this.setupPointerEventDicts(c.a.pointerUp,[c.a.browserPointerUp,c.a.mouseUp]),this.setupPointerEventDicts(c.a.pointerOver,[c.a.browserPointerOver,c.a.mouseOver]),this.setupPointerEventDicts(c.a.pointerOut,[c.a.browserPointerOut,c.a.mouseOut]),this.setupPointerEventDicts(c.a.pointerEnter,[c.a.browserPointerEnter,c.a.mouseEnter]),this.setupPointerEventDicts(c.a.pointerLeave,[c.a.browserPointerLeave,c.a.mouseLeave])):this._msPointerEventsEnabled?(this.setupPointerEventDicts(c.a.pointerDown,[c.a.msPointerDown,c.a.touchStart,c.a.mouseDown]),this.setupPointerEventDicts(c.a.pointerMove,[c.a.msPointerMove,c.a.mouseMove]),this.setupPointerEventDicts(c.a.pointerUp,[c.a.msPointerUp,c.a.mouseUp]),this.setupPointerEventDicts(c.a.pointerOver,[c.a.msPointerOver,c.a.mouseOver]),this.setupPointerEventDicts(c.a.pointerOut,[c.a.msPointerOut,c.a.mouseOut]),this.setupPointerEventDicts(c.a.pointerEnter,[c.a.msPointerEnter,c.a.mouseEnter]),this.setupPointerEventDicts(c.a.pointerLeave,[c.a.msPointerLeave,c.a.mouseLeave])):(this.setupPointerEventDicts(c.a.pointerDown,[c.a.touchStart,c.a.mouseDown]),this.setupPointerEventDicts(c.a.pointerMove,[c.a.mouseMove]),this.setupPointerEventDicts(c.a.pointerUp,[c.a.mouseUp]),this.setupPointerEventDicts(c.a.pointerOver,[c.a.mouseOver]),this.setupPointerEventDicts(c.a.pointerOut,[c.a.mouseOut]),this.setupPointerEventDicts(c.a.pointerEnter,[c.a.mouseEnter]),this.setupPointerEventDicts(c.a.pointerLeave,[c.a.mouseLeave]))}}m._instance=null,(0,a.a)(m,"PointerInputManager",r.a,[82,83,11])},4414:function(e,t,n){"use strict";n.r(t),n.d(t,{TouchAndHoldAdapter:function(){return a.a}});var a=n(2604)},2604:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(6012),o=n(4706),r=n(7296),s=n(657),l=n(872),c=n(5900);class d{get touchAndHoldBeforeTouchEndSatisfied(){return this._touchAndHoldBeforeTouchEndSatisfied}beginTouchAndHold(e,t,n=!1){this._touchAndHoldTask?s.TaskManager.instance.resetInterval(this._touchAndHoldTask,o.a.touchAndHoldTimeThreshold):(this._touchAndHoldTask=new r.a(0,1,o.a.touchAndHoldTimeThreshold,this.onTouchAndHold,14),this._touchAndHoldTask.customData=t,s.TaskManager.instance.addTask(this._touchAndHoldTask)),this._beginTouchAndHoldEvent=e,this._touchAndHoldReleasedAtPointerUp=n}cancelTouchAndHoldIfNecessary(e){if(e.eventName===i.a.touchStart||e.eventName===i.a.touchCancel)this.cancelTouchAndHold();else if(e.eventName===i.a.touchEnd)this._touchAndHoldReleasedAtPointerUp&&this.touchAndHoldBeforeTouchEndSatisfied||this.cancelTouchAndHold();else if(e.eventName===i.a.touchMove){if(this._beginTouchAndHoldEvent){const t=Math.abs(e.screenPoint.x-this._beginTouchAndHoldEvent.screenPoint.x),n=Math.abs(e.screenPoint.y-this._beginTouchAndHoldEvent.screenPoint.y),a=t>o.a.touchAndHoldDistanceThreshold,i=n>o.a.touchAndHoldDistanceThreshold;(a||i)&&this.cancelTouchAndHold()}}else 0}cancelTouchAndHold(){this._touchAndHoldTask&&(s.TaskManager.instance.deleteTask(this._touchAndHoldTask),this._touchAndHoldTask=null),this.touchAndHoldBeforeTouchEndSatisfied&&(this._touchAndHoldBeforeTouchEndSatisfied=!1),this.clearTouchAndHoldOnPointerUpState()}clearTouchAndHoldOnPointerUpState(){this._beginTouchAndHoldEvent=null,this._touchAndHoldReleasedAtPointerUp=!1}static getTouchAndHoldAdapter(e){let t=l.a.getObject(e,d.touchAndHoldAdapterDataName);return t||(t=new d,l.a.setObject(e,d.touchAndHoldAdapterDataName,t)),t}static cancelAnyPendingTouchAndHold(){for(let e=0;e<d._constructedAdapters.length;++e)d._constructedAdapters[e].cancelTouchAndHold()}constructor(){this._beginTouchAndHoldEvent=null,this._touchAndHoldTask=null,this._touchAndHoldReleasedAtPointerUp=!1,this._touchAndHoldBeforeTouchEndSatisfied=!1,this.onTouchAndHold=e=>{if(!this._touchAndHoldReleasedAtPointerUp){(0,e.customData)(this._beginTouchAndHoldEvent),this._beginTouchAndHoldEvent=null}this._touchAndHoldTask=null,this._touchAndHoldBeforeTouchEndSatisfied=!0},Array.add(d._constructedAdapters,this)}}d.touchAndHoldAdapterDataName=c.a.touchAndHoldAdapterCache,d._constructedAdapters=[],(0,a.a)(d,"TouchAndHoldAdapterImpl",null,[])},8817:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var a=n(100),i=n(5149),o=n(6601),r=n(7531),s=n(6580),l=n(872),c=n(5900),d=n(3245);class u{onTouchStart(e,t){u._sClickPossible=!0,this._clickPendingPoint=new Sys.UI.Point(e.elementPoint.x,e.elementPoint.y),!this.doubleTapFixEnabled&&this.isDoubleClick(e,t)&&r.a.cancelEventInternal(e.innerEvent,!0)}onTouchMove(e){this._clickPendingPoint&&(this._clickPendingPoint=Math.pow(this._clickPendingPoint.x-e.elementPoint.x,2)+Math.pow(this._clickPendingPoint.y-e.elementPoint.y,2)<=100?this._clickPendingPoint:null)}onTouchEnd(e,t){const n=new s.a;if(this._clickPendingPoint&&u._sClickPossible){0,n.isTouchClick=!0,n.clickArgs=o.a.createFromTouchArgs(e);let a=e;this.isDoubleClick(e,t)&&(n.isTouchDoubleClick=!0,a=null),this._lastClickEvent=a}return this._clickPendingPoint=null,n}onTouchCancel(e){this._clickPendingPoint=null}cancelPendingClick(){this._clickPendingPoint=null}get doubleTapFixEnabled(){return null!=this.__cached_doubleTapFixEnabled_0_b9f71c9b?this.__cached_doubleTapFixEnabled_0_b9f71c9b:this.__cached_doubleTapFixEnabled_0_b9f71c9b=d.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TouchClickAdapterDoubleTapFix",!1)??!1}isDoubleClick(e,t){if(!this.doubleTapFixEnabled&&e.innerEvent.rawEvent===t?.innerEvent?.rawEvent)return!1;let a=!!this._lastClickEvent&&e.timestamp.getTime()-this._lastClickEvent.timestamp.getTime()<=u.doubleTapTimeThreshold&&Math.abs(e.screenPoint.x-this._lastClickEvent.screenPoint.x)<=40&&Math.abs(e.screenPoint.y-this._lastClickEvent.screenPoint.y)<=40;if(n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("SelectWordOnDoubleTapIsEnabled")&&!a&&t){if(e.caughtElement.nodeName!==t.caughtElement.nodeName&&(Sys.UI.DomElement.containsCssClass(e.caughtElement,u.attachedToBeginningClassName)||Sys.UI.DomElement.containsCssClass(t.caughtElement,u.attachedToBeginningClassName)))return i.ULS.sendTraceTag(594043422,324,15,"Potential false double-tap on floating element avoided"),!1;a=e.timestamp.getTime()-t.timestamp.getTime()<=u.doubleTapTimeThreshold&&Math.abs(e.screenPoint.x-t.screenPoint.x)<=40&&Math.abs(e.screenPoint.y-t.screenPoint.y)<=40}return a}static getTouchClickAdapter(e){let t=l.a.getObject(e,u.touchClickAdapterDataName);return t||(t=new u,l.a.setObject(e,u.touchClickAdapterDataName,t)),t}static cancelAllPendingClicks(){u._sClickPossible=!1}constructor(){this._lastClickEvent=null,this._clickPendingPoint=null}}u.touchClickAdapterDataName=c.a.touchClickAdapterCache,u.doubleTapTimeThreshold=1e3,u._sClickPossible=!0,u.attachedToBeginningClassName="AttachedToBeginning",(0,a.a)(u,"TouchClickAdapter",null,[])},6580:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.isTouchClick=!1,this.isTouchDoubleClick=!1,this.clickArgs=null}}(0,a.a)(i,"TouchClickResult",null,[])},5976:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(2929);class o extends i.a{get action(){return this.eventName}get clientPoint(){return this._client}get screenPoint(){return this._screen}get elementPoint(){return this._element||(this._element=i.a.getElementPoint(this._client,this.sourceElement)),this._element}get caughtElement(){return this._caught}get timestamp(){return this._timestamp}static create(e,t,n,a){const r=i.a.getSourceElement(a),s=i.a.getClientPointFromTouchEvent(a),l=i.a.getScreenPointFromTouchEvent(a);return new o(e,s,null,l,r,t,n,a)}constructor(e,t,n,a,i,o,r,s){super(e,i,s,3),this._timestamp=new Date,this._client=t,this._element=n,this._screen=a,this._caught=o,this.userData=r}}(0,a.a)(o,"TouchEventArgs",i.a,[])},4706:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var a=n(100),i=n(5149),o=n(7531),r=n(6012),s=n(7995);class l{canHandleEvent(e){for(let t=0;t<this.touchAdapters.length;t++){if(this.touchAdapters.get_item(t).canHandleEvent(e))return!0}return!1}getFirstAdapter(e){for(let t=0;t<this.touchAdapters.length;t++){const n=this.touchAdapters.get_item(t);if(n.canHandleEvent(e))return n}return null}addAdapter(e,t){this.touchAdapters.add(e,t)}removeAdapter(e){this.touchAdapters.remove(e)}isEmpty(){return!this.touchAdapters.length}constructor(e){this.touchAdapters=new s.a,this.target=e}}(0,a.a)(l,"TouchAdapterRegister",null,[]);var c=n(5976),d=n(6534),u=n(657),p=n(6094),g=n(680),h=n(7958),m=n(1163),_=n(988);class S extends o.a{initializeForElement(e){super.initializeForElement(e),this._eventHandlerManager.initializeListForElement(r.a.touchEvents,e,0,this.onTouchEvent)}deinitializeForElement(e){super.deinitializeForElement(e),this._eventHandlerManager.deinitializeListForElement(e,r.a.touchEvents)}registerHandler(e,t,n,a){this._eventHandlerManager.registerHandler(e,t,2,this.onTouchEvent,n,a)}unregisterHandler(e,t,n){this._eventHandlerManager.unregisterHandler(e,t,n)}setShowContextMenuOnTouchEnd(e){this._shouldShowContextMenuOnTouchEnd=e}canHandleEvent(e){if(this._touchAdapter&&(r.a.touchEnd===e.action||r.a.touchMove===e.action))return!0;for(let t=e.innerEvent.target;t;t=t.parentNode){const n=this.getRegisterEntry(t);if(n&&n.canHandleEvent(e))return!0}return!1}onHandleEvent(e){let t=!1;if(this._touchAdapter)return r.a.touchEnd===e.action?(t=this._touchAdapter.onTouchEnd(e),this._touchAdapter=null,o.a.cancelEvent(e.innerEvent)):e.action===r.a.touchMove&&(t=this._touchAdapter.onTouchMove(e),o.a.cancelEvent(e.innerEvent)),t;if(r.a.touchStart===e.action){for(let t=e.innerEvent.target;t;t=t.parentNode){this._firstDownEvent=e;const t=this.getRegisterEntry(e.caughtElement);if(!t)continue;const n=t.getFirstAdapter(e);if(n)return this._touchAdapter=n,n.onTouchStart(e)}return t}return t}fireTouchContextMenuEvent(e){const t=e.srcElement||e.target,n=new Sys.UI.DomEvent(e);this._eventHandlerManager.simulateBubblingEvent(r.a.touchContextMenu,t,n)}addControlFocus(e,t,n=!1,a=!1){const i=t=>(this._focusManager.tryChangeScopeOnStealingFocusEvent(e,a,n,t),!1);this.registerHandler(r.a.touchStart,t,i,null),this._focusManager.getScope(e).addDispose((()=>{this.unregisterHandler(r.a.touchStart,t,i)}))}registerTouchRegion(e){Array.add(this._touchRegions,e),this._eventHandlerManager.initializeListForElement(r.a.touchEvents,e.target,0,this.onTouchEvent)}unregisterTouchRegion(e){Array.remove(this._touchRegions,e),this._eventHandlerManager.deinitializeListForElement(e.target,r.a.touchEvents)}registerTouchAdapterWithPriority(e,t,n){let a=this.getRegisterEntry(e);a||(a=new l(e)),a.isEmpty()&&this.registerTouchRegion(a),a.addAdapter(n,t)}unregisterTouchAdapter(e,t){const n=this.getRegisterEntry(e);n&&(n.removeAdapter(t),n.isEmpty()&&this.unregisterTouchRegion(n))}getRegisterEntry(e){for(let t=0;t<this._touchRegions.length;t++)if(this._touchRegions[t].target===e)return this._touchRegions[t];return null}static get instance(){return S._instance||(S._instance=new S)}static disposeInputManager(){g.a.safeDispose(S._instance)}static logTouchStartIfNeeded(){const{AFrameworkApplication:e}=n(3245);S._haveLoggedTouchStart||(i.ULS.sendTraceTag(42821152,324,15,"Touch input used in session"),e.theActionManager.processActionWithData(_.a.touchStart,2,null),S._haveLoggedTouchStart=!0)}static logMultiTouchIfNeeded(){S._haveLoggedMultiTouch||(d.d(_.a.multiTouch),S._haveLoggedMultiTouch=!0)}static isMultiTouch(e){const t=S.getTouchArrayFromEvent(e);return!!t&&t.length>1}static isOneNoteInkingImprovementsEnabled(e=null){const{AFrameworkApplication:t}=n(3245);return t.appSettingsManager.getBooleanAppSetting("OneNoteInkingWithMouseOrTouchIsEnabled")?!!S.isEventOnInkCaptureElement&&S.isEventOnInkCaptureElement(e):t.appSettingsManager.getBooleanAppSetting("OneNoteInkingImprovementsIsEnabled")&&S.isInInkingMode}static isWebkitStyleTouchEvent(e){return!!S.getTouchArrayFromEvent(e)}static getTouchArrayFromEvent(e){const t=e.rawEvent;return t?t.touches:null}constructor(){super(),this._touchRegions=[],this._touchAdapter=null,this._firstDownEvent=null,this._shouldShowContextMenuOnTouchEnd=!1,this.onTouchEvent=(e,t,a)=>{const{AFrameworkApplication:s}=n(3245),{TouchAndHoldAdapter:l}=n(4414);if(!this.isEnabled)return!1;if(a&&S.isOneNoteInkingImprovementsEnabled(a.target))return!0;if(u.TaskManager.instance.isYielding)return i.ULS.sendTraceTag(24699484,324,50,"Touch event dropped."),!1;if(this._supressEvents)return o.a.cancelEvent(a),!0;if(S.isMultiTouch(a)&&(s.appSettingsManager.getBooleanAppSetting("LogMultiTouchIsEnabled")&&S.logMultiTouchIfNeeded(),l.cancelAnyPendingTouchAndHold(),!this._touchRegions.length))return!1;const d=c.a.create(e,t,null,a);if(this._touchRegions.length>0&&this.canHandleEvent(d)){if(!this.onHandleEvent(d))return!1}const g=n(4414).TouchAndHoldAdapter.getTouchAndHoldAdapter(d.sourceElement);g.cancelTouchAndHoldIfNecessary(d),e===r.a.touchStart&&(g.beginTouchAndHold(d,this.onTouchAndHold,this._shouldShowContextMenuOnTouchEnd),S.logTouchStartIfNeeded()),e===r.a.touchEnd&&(m.a.isIPad&&(m.a.iPadOsVersion<=6||6!==p.a.getTag(h.a.getActiveElement(window.document)))&&window.focus(),this._shouldShowContextMenuOnTouchEnd&&g.touchAndHoldBeforeTouchEndSatisfied&&(this.fireTouchContextMenuEvent(d.innerEvent.rawEvent),g.cancelTouchAndHold()),this._touchAdapter&&(this._touchAdapter.onTouchEnd(d),this._touchAdapter=null,o.a.cancelEvent(a)));const _=this._eventHandlerManager.processEvent(e,t,d);return _&&o.a.cancelEvent(a),_},this.onTouchAndHold=e=>{this.fireTouchContextMenuEvent(e.innerEvent.rawEvent)};const{FocusManager:e}=n(629),{EventHandlerManager:t}=n(9865);this._eventHandlerManager=t.instance,this._focusManager=e.instance()}}S._haveLoggedTouchStart=!1,S._haveLoggedMultiTouch=!1,S.touchAndHoldTimeThreshold=400,S.touchAndHoldDistanceThreshold=10,S._instance=null,S.isInInkingMode=!1,S.isEventOnInkCaptureElement=null,S._touchPoints=void 0,(0,a.a)(S,"TouchInputManager",o.a,[])},9645:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8281);class o extends i.a{get ControlType(){return 14}constructor(){super(),this.LabelText=null,this.IconName=null,this.IsBanner=null}}(0,a.a)(o,"LabelProps",i.a,[])},6534:function(e,t,n){"use strict";n.d(t,{b:function(){return A},a:function(){return b},d:function(){return C},c:function(){return y},e:function(){return S}});var a,i=n(3792),o=n(5385),r=n(5149),s=n(6295),l=n(92),c=n(100);!function(e){e[e.count=0]="count",e[e.avg=1]="avg",e[e.sum=2]="sum"}(a||(a={})),(0,c.b)("ScorecardAggregateMethod",a);var d=n(8650),u=n(3774),p=n(5434),g=n(5018);const h="OtelUserAction";class m{add_onActionEventHandler(e){this._actionEventSource.addHandler(h,e)}remove_onActionEventHandler(e){this._actionEventSource.removeHandler(h,e)}raiseEvent(e){this._actionEventSource.raiseEvent(h,e)}static get instance(){return m._instance||(m._instance=new m)}constructor(){this._actionEventSource=new g.a}}m._instance=null,(0,c.a)(m,"UserActionObserver",null,[]);var _=n(5665);const S="",f=()=>{let e=null;const t=(0,i.h)(o.a);return t&&t.execute((t=>{t.actionManagerLoggingEnabled&&(e=t)})),e?e.contentType:"Unknown"},C=(e,t=!0,n=S,a=0,i=0,o=0,c=null)=>{const g=u.a.commandIdResolver(e)||u.a.actionIdResolver(e)||"";if(g.length>0){const r=f();m.instance.raiseEvent(new d.a(g,n,Date.now(),i,a,r)),_.a.sendUserActionEvent(p.a.createUserActionCustomData(g,n,s.a[a],l.a[i],c,e,null,t,o))}else r.ULS.sendTraceTag(51500117,383,15,"Could not determine action name for actionId: "+e+". Dropping this action")},y=(e,t=!0,n=S,a=0,i=0,o=0,c=null,g=window.event)=>{const h=u.a.commandIdResolver(e)||u.a.actionIdResolver(e)||"";if(h.length>0){const r=f();let u="",S="";if(c)for(const e of c)"ControlId"===e.name?u=e.string:"TerminalParentControlId"===e.name&&(S=e.string);m.instance.raiseEvent(new d.a(h,n,Date.now(),i,a,r,u,S)),_.a.sendUserActionEvent(p.a.createUserActionEvent(h,n,s.a[a],l.a[i],c,e,null,t,o),g)}else r.ULS.sendTraceTag(51500118,383,15,"Could not determine action name for actionId: "+e+". Dropping this action")},A=(e,t=!0,n=0,a=null)=>{e&&e.length?_.a.sendActivityEvent(p.a.createActivityEvent(e,t,n,a)):r.ULS.sendTraceTag(588124555,383,15,"Dropping Otel activity because the name is null or empty.")},b=(e,t=null,n=0,i=!0,o=0,s=null,l=!1)=>{if(null==e||!e.length)return void r.ULS.sendTraceTag(588124556,383,15,"Dropping Otel activity for experiment because the name is null or empty.");if(null==t){if(0!==n)return void r.ULS.sendTraceTag(588124557,383,15,"Dropping Otel activity for experiment because the activityValue for ({0}) is null when scorecardAggregateMethod is set to ({1}).",e,a[n]);t=1}const c=[{name:"WAC_Experiment",string:a[n]},{name:"WAC_Experiment_Value",double:t},{name:"WAC_Experiment_EventName",string:"WAC_Exp_"+e+"_"+a[n]},{name:"WAC_Experiment_AggregateOnlySucceeded",bool:l}];s?s.push.apply(s,c):s=c,_.a.sendActivityEvent(p.a.createActivityEvent(e,i,o,s))}},9086:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8281);class o extends i.a{constructor(){super(),this.UpdateDynamically=!1,this.Title=null,this.MaxWidth=null,this.MenuSectionList=null,this.AriaLabel=null,this.MenuHeaderSection=null,this.MenuFooterSection=null,this.ShouldAutoOpen=!1,this.AriaRoleDescription=null,this.MenuTargetDescriptor=null,this.IsFlexLayout=!1}}(0,a.a)(o,"MenuProps",i.a,[])},7257:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8281);class o extends i.a{constructor(){super(),this.ControlsId=null,this.Title=null,this.TitleId=null,this.Theme=null,this.DisplayMode=null,this.ShowMenuSectionSeparator=!0,this.ShowMenuSectionTitleIcon=!0,this.ShowMenuSectionTitleBackground=!0,this.MenuSectionTitleFocusable=!0,this.Lang=null,this.ControlList=null}}(0,a.a)(o,"MenuSectionProps",i.a,[])},9505:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a,i=n(100),o=n(5149),r=n(3245),s=n(965);!function(e){e.PairwiseBroker="PairwiseBroker",e.ParentFrame="ParentFrame"}(a||(a={})),(0,i.b)("ParentAuthSupport",a);const l="UiHostSpecifiedAuthTokenStrategy";class c{static ensureAppSettings(){if(c.appSettingsVersion<0){c.appSettingsVersion=0;try{const e=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("OAuthManagerServiceSettings");null!=e&&""!==e&&(c.appSettings=s.b(e),c.appSettingsVersion=c.appSettings._Version,c.overwriteAppIdMapping()),o.ULS.sendTraceTag(572298006,3e3,100,"AppSettings: {0}",e)}catch(e){o.ULS.sendTraceTag(572298007,3e3,15,"AppSettings failed to load: {0}",e.message)}}}static ensureDocSettings(){if(c.docSettingsVersion<0){r.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady&&(c.docSettingsVersion=0);try{const e=r.AFrameworkApplication.appSettingsManager.getStringAppSetting("OAuthManagerDocumentSettings");null!=e&&""!==e&&(c.docSettings=s.b(e),c.docSettingsVersion=c.docSettings._Version),o.ULS.sendTraceTag(572298008,3e3,100,"DocSettings: {0}",e)}catch(e){o.ULS.sendTraceTag(572298009,3e3,15,"DocSettings failed to load: {0}",e.message)}}}static overwriteAppIdMapping(){r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthAugLoopUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.AugLoop=c.appSettings.AppMapping.Core),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthBayBridgeUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.BayBridge=c.appSettings.AppMapping.Core),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthConsentUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.Consent=c.appSettings.AppMapping.Core),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthLokiUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.Loki=c.appSettings.AppMapping.Core),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthMakerUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.Maker=c.appSettings.AppMapping.Core),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthPowerQueryWebUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.PowerQueryWeb=c.appSettings.AppMapping.Core),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthPPTDesignerUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.PPTDesigner=c.appSettings.AppMapping.Core),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthPrintUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.Print=c.appSettings.AppMapping.Core),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthSearchUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.Search=c.appSettings.AppMapping.Core),r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OauthSpeechUsesCoreEnabled",!1)&&(c.appSettings.AppMapping.Speech=c.appSettings.AppMapping.Core)}static get clientVersion(){return 7}static get appVersion(){return c.ensureAppSettings(),c.appSettingsVersion}static get docVersion(){return c.ensureDocSettings(),c.docSettingsVersion}static get appMapping(){return c.ensureAppSettings(),c.appSettings.AppMapping}static get authority(){return c.ensureAppSettings(),c.appSettings.Authority}static get enableConsoleLogging(){return c.ensureAppSettings(),c.appSettings.EnableConsoleLogging}static get corePFTData(){if(c.ensureAppSettings(),c.appVersion>=8)return c.appSettings.CorePFTData;if(c.appVersion>=7){const e=c.appSettings.CorePFTData;return e.WacAppCluster="",e}return{IsEnabled:!0,Application:"e03a13ee-9730-4cae-8525-47559c8cf18a",Endpoint:"",WacAppCluster:""}}static get hostPageSupportsPairwiseBroker(){return c.ensureAppSettings(),c.appVersion>=10?r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseAuthTokenStrategyParameter",!1)&&"PairwiseBroker"===c.appSettings.HostSpecifiedAuthTokenStrategy:r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseAuthTokenStrategyParameter",!1)&&"PairwiseBroker"===r.AFrameworkApplication.appSettingsManager.getStringAppSetting(l)}static get hostPageSupportsAuth(){c.ensureAppSettings();const e=c.appSettings.HostSpecifiedAuthTokenStrategy;if(c.appVersion>=4){if(!c._hostPageSupportsAuthValidated&&c.appSettings.HostPageSupportsAuth||c.appVersion>=10&&!c._hostPageSupportsAuthValidated&&r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseAuthTokenStrategyParameter",!1)&&"ParentFrame"===e){const e=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365ConsumerHost"),t=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsO365CommercialHost");if(e||t)try{const n=r.AFrameworkApplication.postMessageOrigin.toLowerCase(),a=c.appSettings.GetAuthTokenFromParentOriginList;if(null!=a){for(const e of a){if(new RegExp("^"+e+"/?$").test(n)){c._hostPageSupportsAuth=!0;break}}if(r.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogPostMessageOriginNotInAllowlist")&&!c._hostPageSupportsAuth){const a=new URL(n);o.ULS.sendTraceTag(505710302,3e3,15,"PostMessageOrigin not in allowlist: hostname={0} isO365ConsumerHost={1} isO365CommercialHost={2}",a.hostname,e,t)}}}catch(e){o.ULS.sendTraceTag(570729249,3e3,15,"Failed to validate origin: {0}",e.message)}}const t=r.AFrameworkApplication.appSettingsManager.getStringAppSetting(r.AFrameworkApplication.uiHostSettingName),n=r.AFrameworkApplication.appSettingsManager.getStringAppSetting(r.AFrameworkApplication.uiHostIntegrationTypeSettingName);return"teams"!==t&&"assignments"!==t||c._hostPageSupportsAuth||o.ULS.sendTraceTag(505702298,3e3,15,"OAuthManagerSettings: HostPageSupportsAuth is false for teams session, uiHost={0} uiHostIntegrationType={1} hostSpecifiedAuthTokenStrategy={2}",t,n,e),c._hostPageSupportsAuthValidated=!0,c._hostPageSupportsAuth}return r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UiHostSupportsAuthToken")||r.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseAuthTokenStrategyParameter",!1)&&"ParentFrame"===r.AFrameworkApplication.appSettingsManager.getStringAppSetting(l)}static get isEnabled(){return c.ensureAppSettings(),c.appSettings.IsEnabled}static get mockTokenForAutomation(){return c.ensureAppSettings(),c.appSettings.MockTokenForAutomation}static get promiseTimeoutInMs(){return c.ensureAppSettings(),c.appSettings.PromiseTimeoutInMs}static get maxInitRetries(){return c.ensureAppSettings(),c.appVersion>=11?c.appSettings.MaxInitRetries:3}static get tokenRefreshManagerIntervalInMs(){return c.ensureAppSettings(),c.appVersion>=12?c.appSettings.TokenRefreshManagerIntervalInMs:6e4}static get tokenRefreshManagerTimeBeforeExpirationToRefreshInMs(){return c.ensureAppSettings(),c.appVersion>=12?c.appSettings.TokenRefreshManagerTimeBeforeExpirationToRefreshInMs:3e5}static get sharedAuthFilePath(){return c.ensureAppSettings(),c.appSettings.SharedAuthFilePath}static get sharedAuthRedirectPath(){return c.ensureAppSettings(),c.appSettings.SharedAuthRedirectPath}static get sharedAuthOrigin(){return c.ensureAppSettings(),c.appSettings.SharedAuthOrigin}static get teamsSDXEnabledSSOList(){return c.ensureAppSettings(),c.appSettings.TeamsSDXEnabledSSOList}static get testInformation(){return c.ensureAppSettings(),c.appSettings.TestInformation}static get wacFrameTeamsElectronSSO(){return c.ensureAppSettings(),c.appSettings.WacFrameTeamsElectronSSO}static get oAuthLoginHint(){return c.ensureDocSettings(),c.docSettingsVersion>=3?c.docSettings.OAuthLoginHint:null}static get lokiAlternateAuthToken(){return c.ensureDocSettings(),c.docSettingsVersion>=4?c.docSettings.LokiAlternateAuthToken:null}static get lokiAlternateAuthTokenTTL(){return c.ensureDocSettings(),c.docSettingsVersion>=4?c.docSettings.LokiAlternateAuthTokenTTL:-1}get lokiAlternateAuthToken(){return c.lokiAlternateAuthToken}get lokiAlternateAuthTokenTTL(){return c.lokiAlternateAuthTokenTTL}}c.appSettingsVersion=-1,c.appSettings=null,c.docSettingsVersion=-1,c.docSettings=null,c._hostPageSupportsAuth=!1,c._hostPageSupportsAuthValidated=!1,(0,i.a)(c,"OAuthManagerSettings",null,[])},2388:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(1163),o=n(1509),r=n(2274);class s{static isAllowedPlatformForOpenInClient(){return i.a.isWindows||i.a.isMac||i.a.isAndroid||i.a.isIPad||i.a.isIPhone}static getNormalizedSessionOrigin(){let e=0,t=0;if(!r.AFrameworkApplication_AppSettingsManager.appSettingsManager)return"";switch((r.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting(n(6776).AFrameworkApplicationConstants.uiHostSettingName)||"").toLowerCase()){case"teams":e=524288;break;case"onedrive":e=131072;break;case"owa":e=262144;break;case"assignments":e=65536;break;default:e=0}switch((r.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("FileSource")||"").toLowerCase()){case"exchangeonline":t=1;break;case"exchangeonlineconsumer":t=2;break;case"onedrivewopi":t=4;break;case"sharepointonline":t=8;break;default:t=0}const a=t|e;return String.format("{0}{1}{2}",s.sessionOriginTeamPrefix.toString(),"_",a.toString())}}s.sessionOriginTeamPrefix=o.a.createFromString("B5F65EF9-A5B1-4887-A968-C779537C8303"),(0,a.a)(s,"OpenInClientUtils",null,[])},5434:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(5149),o=n(8555),r=n(92),s=n(6295),l=n(5901),c=n(2274);class d{static get MAX_SAFE_INTEGER(){return 9007199254740991}static isEnabledLogSessionStartAndEndDataFromClientToOTel(e){return 0===d.logSessionStartAndEndDataFromClientToOTelIsEnabled&&(d.logSessionStartAndEndDataFromClientToOTelIsEnabled=d.determineLogSessionStartAndEndDataFromClientToOTelIsEnabled(e)?2:1),2===d.logSessionStartAndEndDataFromClientToOTelIsEnabled}static determineLogSessionStartAndEndDataFromClientToOTelIsEnabled(e){return!!c.AFrameworkApplication_AppSettingsManager.appSettingsManager&&c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("LogSessionStartAndEndDataFromClientToOTel")}static isUserActionLoggingToOtelEnabled(e=null){return 0===d.userActionLoggingToOtelIsEnabled&&(d.userActionLoggingToOtelIsEnabled=d.determineUserActionLoggingToOtelIsEnabled(e)?2:1),2===d.userActionLoggingToOtelIsEnabled}static determineUserActionLoggingToOtelIsEnabled(e=null){return!!c.AFrameworkApplication_AppSettingsManager.appSettingsManager&&c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting(d.getUberBRSControllingUserActionLoggingToOtel())}static getUberBRSControllingUserActionLoggingToOtel(){return"WACUserActionToOtelIsEnabled"}static getOtelActivityEventTableName(){return d.getOtelNonUserActionEventTableName()}static getOtelNonUserActionEventTableName(){let e=(0,o.a)(String,n(6776).AFrameworkApplicationConstants.sessionStartInfoSettings.Application)||"";return e="Office."+e+(""===e?"":".")+"Online.NonUserInitiatedAction",e}static getOtelNonUserActionEventTablePrefix(){let e=(0,o.a)(String,n(6776).AFrameworkApplicationConstants.sessionStartInfoSettings.Application)||"";return e="Office."+e+(""===e?"":".")+"Online.NonUser.",e}static dictionaryToDataFields(e,t=null,n=null){if(!e)return null;const a=new Array(0);try{for(const i in e){const o={key:i,value:e[i]};if(n&&n.contains(o.key))continue;const r=t&&t.containsKey(o.key)?t.get_item(o.key):l.g.String,s=d.getDataField(o.key,o.value?o.value.toString():null,r);s&&Array.add(a,s)}}catch(e){i.ULS.sendTraceTag(39978634,207,15,"Exception: "+e)}return a}static recordToDataFields(e,t){if(!e)return[];const n=[],a=e=>{switch(typeof e){case"boolean":return l.g.Boolean;case"number":return l.g.Double}return e instanceof Date?l.g.Date:l.g.String};try{for(const[i,o]of Object.entries(e)){const e={key:i,value:o},r=t?.[i]?t[i]:a(o),s=d.getDataField(e.key,null===e.value||void 0===e.value?null:e.value.toString(),r);s&&n.push(s)}}catch(e){i.ULS.sendTraceTag(39978634,207,15,"Exception: "+e)}return n}static getDataField(e,t,n){if(!t||!e)return null;let a=null;switch(n){case l.g.Boolean:a={name:e,bool:Boolean.parse(t.toString())};break;case l.g.Int64:{const n=parseInt(t);isNaN(n)||(a={name:e,int64:n});break}case l.g.Double:{const n=parseFloat(t);isNaN(n)||(a={name:e,double:n});break}case l.g.String:a={name:e,string:t};break;case l.g.Date:{const n=Date.parse(t);isNaN(n)||(a={name:e,date:new Date(n).getTime()});break}}return a}static shouldReplaceWithUnknownValue(e){let t=!0;if(e&&(t=!e.length,!t)){const n=e.toLowerCase();t="notdefined"===n||"unknown"===n}return t}static sanitizeValues(e,t,n){return d.shouldReplaceWithUnknownValue(e)&&(e=d.unknownValueString),d.shouldReplaceWithUnknownValue(t)&&(t=d.unknownValueString),d.shouldReplaceWithUnknownValue(n)&&(n=d.unknownValueString),{parentName:e,triggerMethod:t,commandSurface:n}}static sanitizeValue(e){return d.shouldReplaceWithUnknownValue(e)&&(e=d.unknownValueString),e}static createUserActionCustomData(e,t=null,n=null,a=null,i=null,o=null,r=null,s=null,l=null){return d.createUserActionEvent(e,t,n,a,d.dictionaryToDataFields(i),o,r,s,l)}static createUserActionEvent(e,t=null,n=null,a=null,i=null,o=null,r=null,s=null,l=null){return({parentName:t,triggerMethod:n,commandSurface:a}=d.sanitizeValues(t,n,a)),{actionName:e,parentName:t,triggerMethod:n,commandSurface:a,dataFields:i,actionId:o,timeOffsetMs:r,succeeded:s,durationMs:l}}static createActivityEvent(e,t,n,a){return{name:e,succeeded:t,durationMs:n,dataFields:a}}static createNonUserAction(e,t,n,a,i,o,l,c){n=d.sanitizeValue(n);const u=[{name:"ActionName",string:e},{name:"CommandSurface",string:r.a[i]},{name:"ParentName",string:n},{name:"TriggerMethod",string:s.a[a]},{name:"StartTime",double:o},{name:"EndTime",double:l},{name:"Succeeded",bool:t}];return u.push.apply(u,d.dictionaryToDataFields(c)),{name:e&&e.length>0?d.getOtelNonUserActionEventTablePrefix()+e:d.getOtelNonUserActionEventTableName(),durationMs:l-o>0?l-o:0,dataFields:u}}static shouldRegisterOtelListener(e){return!!c.AFrameworkApplication_AppSettingsManager.appSettingsManager&&c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OtelPipelineIsEnabled")&&d.isUserActionLoggingToOtelEnabled(e)}static oldActionsPipelineIsEnabled(){return 0===d.oldActionsPipelineStatusIsEnabled&&(d.oldActionsPipelineStatusIsEnabled=c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OldPipelineActionLoggingDisabled")?1:2,1===d.oldActionsPipelineStatusIsEnabled&&i.ULS.sendTraceTag(51140033,383,15,"OldPipelineActionLoggingDisabled is true, actions / bSqm actions will not be logged.")),2===d.oldActionsPipelineStatusIsEnabled}static logFlightsInOtelSessionStartEndIsEnabled(){return!!c.AFrameworkApplication_AppSettingsManager.appSettingsManager&&c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("LogFlightsInOtelSessionStartEndIsEnabled")}}d.unknownValueString="",d.logSessionStartAndEndDataFromClientToOTelIsEnabled=0,d.userActionLoggingToOtelIsEnabled=0,d.oldActionsPipelineStatusIsEnabled=0,(0,a.a)(d,"OtelUtils",null,[])},4361:function(e,t,n){"use strict";n.d(t,{a:function(){return m}});var a=n(100),i=n(5149),o=n(6996),r=n(385);class s{constructor(e,t,n){this.packageInstance=e,this.status=t,this.appStatusForInitialization=n}}(0,a.a)(s,"PackageRegistration",null,[]);var l=n(7296),c=n(9611),d=n(988),u=n(657);class p{get name(){return this.basePackage.name}init(){this.basePackage.init()}dispose(){this.basePackage.dispose()}configure(e){this.basePackage.configure(e)}constructor(e){this.initType="synchronous",this.basePackage=e}}(0,a.a)(p,"SyncPackage",null,[96]);class g{get name(){return this.basePackage.name}async initializeAsync(){this.basePackage.init()}dispose(){this.basePackage.dispose()}configure(e){this.basePackage.configure(e)}constructor(e){this.initType="async",this.basePackage=e}}(0,a.a)(g,"FlightedAsyncPackage",null,[97]);class h{get name(){return this.basePackage.name}async initializeAsync(){await this.basePackage.initializeAsync()}dispose(){this.basePackage.dispose()}configure(e){this.basePackage.configure(e)}constructor(e){this.initType="async",this.basePackage=e}}(0,a.a)(h,"AsyncPackage",null,[97]);class m{registerActions(e){e.addActionWithFlags(d.a.queryPackageInitialized,c.a.frame,this.queryPackageInitialized,96)}callQueryPackageInitialized(e){if(!this._readyToInit)return 2;let t;return({value:t}=this._packages.tryGetValue(e)).returnValue&&t.status>=3?32:2}registerAsyncPackage(e,t=0){const n=new h(e),a=new s(n,0,t);this.registerPackageInternal(a,!1)}registerPackage(e,t=0,n=!1){if(this._asyncPackageChangeGates.includes(e.name)&&this._isFeatureGateEnabledFunc("AsyncPackageEnabled"+e.name))return void this.registerAsyncPackage(new g(e),t);if(Object.keys(this._asyncFlightToPackages).find((t=>this._isFlightEnabled(t)&&this._asyncFlightToPackages[t].includes(e.name))))return void this.registerAsyncPackage(new g(e),t);const a=new p(e),i=new s(a,0,t);this.registerPackageInternal(i,n)}registerPackageInternal(e,t){const n=e.packageInstance;this._packages.containsKey(n.name)?i.ULS.sendTraceTag(508387585,306,10,"Package name '{0}' was already registered with the PackageLifecycleManager",n.name):(this._packages.set_item(n.name,e),this._isSettingEnabledFunc("InitializePackagesInTask")&&!t?this._readyToConfigure&&!this._taskSet&&this.scheduleTask():(this._readyToConfigure&&this.configurePackage(n),this._readyToInit&&this.initializePackage(n)))}scheduleTask(){const e=new l.a(2,1,0,(e=>{if(!this._readyToConfigure||!this._readyToInit)return i.ULS.shipAssertTag(508387584,324,!1),void(this._retriedTask||(this._retriedTask=!0,this.scheduleTask()));this._taskSet=!1,this.notifyReadyToConfigure(this._container),this.notifyReadyToInit()}),95);u.TaskManager.instance.addTask(e),this._taskSet=!0}notifyReadyToConfigure(e){this._readyToConfigure=!0,this._container=e;for(const e of this._packages)0===e.value.status&&this.configurePackage(e.value.packageInstance)}configurePackage(e){const t=this._packages.get_item(e.name);i.ULS.shipAssertTag(508387555,306,!!t&&0===t.status,e.name),this._isTelemetryRecordingOn&&this.logPackageConfigTime(e.name),e.configure(this._container),t.status=1}registerOnPackageInit(e,t){this._readyToInit&&this._packages.containsKey(e)&&3===this._packages.get_item(e).status?t():this._pendingOnInitCallbacks[e]=t}stopReadyToInit(){this._readyToInit=!1}stopReadyToConfigure(){this._readyToConfigure=!1}notifyReadyToInit(e=!1){this._readyToInit=!0;for(const t of this._packages){if(this._isSettingEnabledFunc("InitializePackagesInTask")&&!e){if(0===t.value.status){this._taskSet||this.scheduleTask();continue}}else 0;t.value.status<2&&this.initializePackage(t.value.packageInstance)}}initPackagesSynchronously(){this._readyToInit&&this.notifyReadyToInit(!0)}initializePackage(e){const t=e.name,n=this._packages.get_item(t);i.ULS.shipAssertTag(508387553,306,!!n&&n.status<3,t);const a=()=>{if(this._isTelemetryRecordingOn&&this.logPackageInitTime(t),"async"!==e.initType){if(e.init(),n.status=3,t in this._pendingOnInitCallbacks){(0,this._pendingOnInitCallbacks[t])()}}else{n.status=2;(async()=>{if(await e.initializeAsync(),n.status=3,t in this._pendingOnInitCallbacks){(0,this._pendingOnInitCallbacks[t])()}})().catch((e=>{if(!(e&&e.reason&&e.reason instanceof Error))throw e;window.reportError(e.reason.error)}))}};0!==n.appStatusForInitialization&&this._isSettingEnabledFunc("Box4DelayedPackageInitEnabled")?(n.status=2,this._appLifecycleManager.executeWhen(n.appStatusForInitialization,a)):a()}tryInitializePackage(e){let t;if(({value:t}=this._packages.tryGetValue(e)).returnValue){if(t.status<2)return this.initializePackage(t.packageInstance),!0;if(3===t.status)return!0}return i.ULS.sendTraceTag(508387552,306,15,"Failed to initialize {0} package.",e),!1}dispose(){for(const e of this._packages)3===e.value.status&&(e.value.packageInstance.dispose(),e.value.status=4)}logContainerTelemetry(){if(!!this._container&&!!n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager&&n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("ContainerTelemetryIsEnabled")&&!this._isContainerTelemetryLogged){let e=this._container.getContainerLog();const t=3e3,n=m.zeroPad(Math.ceil(e.length/t).toString(),3);for(let a=1;e.length>0;a++)i.ULS.sendTraceTag(508387551,324,50,"Chunk {0} of {1} ContainerTelemetry: {2}",m.zeroPad(a.toString(),3),n,e.substr(0,t)),e=e.substr(t);this._isContainerTelemetryLogged=!0}}static get instance(){return m._singletonInstance||(m._singletonInstance=new m(r.a.get_instance(),(e=>{const{AFrameworkApplication_AppSettingsManager:t}=n(2274);return!!t.appSettingsManager&&t.appSettingsManager.getBooleanAppSetting(e)}),(e=>{const{AFrameworkApplication_AppSettingsManager:t}=n(2274);return!!t.appSettingsManager&&t.appSettingsManager.isChangeGateEnabled(e)}),(e=>{const{AFrameworkApplication_AppSettingsManager:t}=n(2274);return!!t.appSettingsManager&&t.appSettingsManager.getBooleanFeatureGate(e,!1)})))}static zeroPad(e,t){let n="";for(let a=e.length;a<t;a++)n+="0";return n+e}logPackageConfigTime(e){window.PackageRegistrationTelemetryConfig||(window.PackageRegistrationTelemetryConfig={}),window.PackageRegistrationTelemetryConfig[e+"_ConfigTime"]=Date.now()}logPackageInitTime(e){window.PackageRegistrationTelemetryInit||(window.PackageRegistrationTelemetryInit={}),window.PackageRegistrationTelemetryInit[e+"_InitTime"]=Date.now()}constructor(e,t,a,i){this._packages=new o.a,this._taskSet=!1,this._retriedTask=!1,this._pendingOnInitCallbacks={},this._readyToInit=!1,this._readyToConfigure=!1,this._container=null,this._isContainerTelemetryLogged=!1,this._isTelemetryRecordingOn=!1,this._asyncFlightToPackages={},this.queryPackageInitialized=(e,t,n,a,i)=>this.callQueryPackageInitialized(i);const{AFrameworkApplication_AppShutDown:r}=n(2118);this._asyncPackageChangeGates=["Ppt.SmartLookup","OneNote.Insights","WordEditor.Insights"],this._asyncFlightToPackages["Microsoft.Office.WordOnline.MakeDLL34AsyncInit"]=["WordEditor.SmartLookup","Box4.OfficeTemplates","Box4.Equations","WordEditor.SyncToPresenter","WordEditor.UploadFromPC","WordEditor.Copilot.Boot","WordEditor.AddInCommands","WordEditor.CustomXml","WordEditor.Designer","WordEditor.DocumentAssemblyEditor","WordEditor.Extension","WordEditor.ImmersiveReaderLauncher","WordEditor.NeuralRewrite","WordEditor.OcsConnectionStatusPackage","WordEditor.OcsVectorClockTelemetry","WordEditor.Policy","WordEditor.ProactiveUxGovernance","WordEditor.ReadingTime","Box4.WordPrediction","WordEditor.SignalAggregator","WordEditor.Transcription","WordEditor.Transformation","WordEditor.Translator","Syntex.Contracts","WordEditor.DictationHost","WordEditor.DictationCommands","Box4.DocumentComponentMetrics","Box4.Emojis","WordEditor.FidelityMetrics","WordEditor.CanvasContextual","WordEditor.EmergencyView","WordEditor.ItemPreview","WordEditor.LinkControl","WordEditor.EquationTools","Box4.HeadlessPlatform"],this._appLifecycleManager=e,this._isSettingEnabledFunc=t,this._isFeatureGateEnabledFunc=a,this._isFlightEnabled=i,r.subscribeToBeforeAppShutDown(((e,t)=>{this.logContainerTelemetry()}))}}m._singletonInstance=null,(0,a.a)(m,"PackageLifecycleManager",null,[98])},7827:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var a=n(100),i=n(5149),o=n(625),r=n(1520),s=n(7531),l=n(3245);class c{isSameError(e){return!!e&&this.message===e.message&&this.source===e.source&&this.line===e.line&&this.column===e.column&&this.stackReference===e.stackReference&&this.stack===e.stack}toString(){return String.format("Message: {0}",this.message)}constructor(e,t,n,a,i,o,r=null){this.message=e,this.source=t,this.line=n,this.column=a,this.stackReference=i,this.stack=o,this.error=r}}(0,a.a)(c,"PageErrorEvent",null,[]);class d{constructor(e,t,n){this.eventCode=e,this.userData=t,this.eventObject=n}}(0,a.a)(d,"PageEventArgs",null,[]);class u{constructor(e,t){this.handler=e,this.userData=t}}(0,a.a)(u,"PageEventHandlerRecord",null,[]);var p=n(965),g=n(1163),h=n(8349),m=n(4934),_=n(7449);class S extends s.a{dispose(){this.getOnBeforeNavigateWebkitString=null,this.unregisterDomEvents(),super.dispose()}registerDomEvents(){this._registered||(this._oldOnError=window.onerror,l.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.UnhandledRejectionKPI")&&this._extendedHealth.logKpiUsage({kpiName:this._unhandledRejectionKpiName,kpiType:_.b.FailureBased}),window.onerror=(0,o.a)(this,this.onError,"onError"),window.onunhandledrejection=(0,o.a)(this,this.onUnhandledRejection,"onUnhandledRejection"),Sys.Application.add_unload((0,o.a)(this,this.onNavigate,"onNavigate")),$addHandler(window,"beforeunload",this.getOnBeforeNavigateCallback()),$addHandler(window,"resize",this.onResize),(this.shouldUsePageHide||g.a.isIPad)&&$addHandler(window,"pagehide",this.onPagehide),this._registered=!0)}registerIFrame(e){Array.add(this._iFrameRecs,e)}unregisterDomEvents(){if(this._registered){window.onerror=this._oldOnError;for(let e=0;e<this._iFrameRecs.length;e++){const t=this._iFrameRecs[e],n=this.getIFrameContentWindow(t.iFrame);n&&(n.onerror=t.oldOnError)}Array.clear(this._iFrameRecs),$removeHandler(window,"resize",this.onResize),$removeHandler(window,"beforeunload",this.getOnBeforeNavigateCallback()),Sys.Application.remove_unload((0,o.a)(this,this.onNavigate,"onNavigate")),this.shouldUsePageHide?$removeHandler(window,"pagehide",this.onPagehide):g.a.isIPad&&$addHandler(window,"pagehide",this.onPagehide),this._registered=!1}}getIFrameContentWindow(e){let t=null;try{t=e.contentWindow}catch(e){}return t}getOnBeforeNavigateCallback(){let e;if(g.a.isWebKit){e=this.onBeforeNavigateWebkit}else e=(0,o.a)(this,this.onBeforeNavigate,"onBeforeNavigate");return e}unregisterAllHandlers(e){for(let e=0;e<5;e++)Array.clear(this._handlers[e])}registerHandler(e,t,n){this._handlers[e]&&Array.add(this._handlers[e],new u(t,n))}unregisterHandler(e,t){const n=this._handlers[e];if(n)for(let e=0;e<n.length;++e){if(n[e].handler===t)return void Array.removeAt(n,e)}}onUnhandledRejection(e){try{let t=null,n=null,a=null;e&&(t=e.reason,t&&(n=t.stack,n&&(a={name:"unhandledRejection",stack:n,file:"unhandledRejection",message:e.reason.toString()}))),l.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.UnhandledRejectionKPI")&&this._extendedHealth.logKpiFailure({kpiName:this._unhandledRejectionKpiName,errorName:"PromiseRejectionUnhandled"}),i.ULS.sendExceptionTraceTag(522803233,201,15,a,"There was an unhandled promise rejection. Reason = {0}",h.a.getScrubbedHttpErrorDetails(t)),this._handlers[4].length>0&&this.invokeHandlers(4,e)}catch(e){i.ULS.sendExceptionTraceTag(522803234,201,10,e,"There was an unhandled exception while handling the unhandled rejection.")}}onError(e,t,n,a,o){try{0;let r=null,s=null,l=null;if(o)r=o.stack,l=o;else try{const e=window.event.error;e&&(l=e,r=e.stack)}catch(e){i.ULS.sendTraceTag(21561472,201,15,"Unable to grab the global error.stack property from Window.Event. Exception Message = {0}.",e.message)}if(!r){S.logCrossDomainScripErrorIfNeeded(e,t,n,a);try{s=arguments.callee.caller.caller}catch(e){i.ULS.sendTraceTag(17662367,201,15,"Exception thrown in PageManager.OnError. Message:{0}. callStack:{1}.",e.message,e.stack)}i.ULS.sendTraceTag(18104455,201,15,"Stack from exception object is null. Exception object = {0}. StackReference = {1}",o,s),t&&(r=String.format("    at unknown ({0}:{1}:{2})",t,n,null!=a?a:0))}s||r||i.ULS.sendTraceTag(18104456,201,15,"Stack and stackReference objects are null.");const d=new c(e,t,n,null!=a?a:0,s,r,l);if(this._handlers[3].length>0)return this.invokeHandlers(3,d),!0}catch(e){i.ULS.sendTraceTag(21283668,201,10,"There was an unhandled exception while handling the error. Exception Message = {0}.",e.message)}return!1}onBeforeNavigate(e){i.ULS.sendTraceTag(7161411,306,50,"OnBeforeNavigate fired");window.self.ignoreOnBeforeUnloadEvent?window.self.ignoreOnBeforeUnloadEvent=!1:this.invokeHandlers(1,e)}onNavigate(e,t){i.ULS.sendTraceTag(7161412,306,50,"OnNavigate fired"),this.invokeHandlers(2,t)}invokeHandlers(e,t){const n=this._handlers[e];for(let a=0,i=n.length;a<i;a++){const i=n[a];i.handler(new d(e,i.userData,t))}}static logCrossDomainScripErrorIfNeeded(e,t,n,a){if(n||a||t&&""!==t||!e.startsWith("Script error")){if(e.startsWith("Script error")){let o=t,r=t;try{t&&""!==t&&(o=-1!==t.lastIndexOf("/")&&t.length-t.lastIndexOf("/")-1>=0?t.substring(o.lastIndexOf("/")+1,t.length-t.lastIndexOf("/")-1):o,r=-1!==t.indexOf(":")&&t.indexOf(":")+3<=t.length?t.substring(t.indexOf(":")+3,t.length-t.indexOf(":")-3):r,r=-1!==r.indexOf("/")?r.substring(0,r.indexOf("/")):r)}catch(e){i.ULS.sendTraceTag(539772957,306,15,"Script error was observed with details, Unable to extract file details. {0}",e)}i.ULS.sendTraceTag(540034826,306,15,"Script error was observed with details- message:[{0}], source:[{1}], line:[{2}], column:[{3}], fileName:[{4}], cdn:[{5}]  ",e,t,n,a,o,r)}}else{const e=document.getElementsByTagName("Script");if(e){const t=new r.a,n=new r.a;for(let a=0;a<e.length;a++){const i=e[a],o=i.getAttribute("src")?i.getAttribute("src").toString():"";n.add(o);const r=i.getAttribute("crossorigin");o.startsWith("http")&&!r&&t.add(o)}t.count>0&&i.ULS.sendTraceTag(21283667,201,10,"The following javascript files do not have CORS set up correctly = {0}",p.c(t))}else i.ULS.sendTraceTag(540034825,306,15,"Script tags were absent when 'Script error' was observed. Unable to decide on failing scripts.")}}get shouldUsePageHide(){return null!=this.__cached_shouldUsePageHide_0_987d9857?this.__cached_shouldUsePageHide_0_987d9857:this.__cached_shouldUsePageHide_0_987d9857=l.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.UsePageHide")}constructor(){super(),this._iFrameRecs=[],this._oldOnError=null,this._registered=!1,this.getOnBeforeNavigateWebkitString=null,this._unhandledRejectionKpiName="UnhandledRejection",this.onBeforeNavigateWebkit=e=>(this.onBeforeNavigate(e),this.getOnBeforeNavigateWebkitString?this.getOnBeforeNavigateWebkitString():null),this.onResize=e=>{window.setTimeout(this.runResizeHandlers,0)},this.runResizeHandlers=()=>{this.invokeHandlers(0,null)},this.onPagehide=e=>{i.ULS.sendTraceTag(7161413,306,50,"OnPagehide fired"),this.invokeHandlers(2,e)},this._handlers=new Array(5);for(let e=0;e<5;e++)this._handlers[e]=[];this._extendedHealth=m.a.getInstance({crewAlias:"jalock_org_fte",featureName:"PromiseRejections",areaName:"Infrastructure"}),this.registerDomEvents()}}(0,a.a)(S,"PageManager",s.a,[])},2219:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var a=n(100),i=n(3245),o=n(9858);class r{process(){return this._hasBeenProcessed||(this.endTime?this._isEndedNormal=!0:(this.endTime=new Date,this._isEndedNormal=!1),this.duration=this.endTime.getTime()-this.beginTime.getTime(),this._hasBeenProcessed=!0),this.duration.toString()}addChild(e){Array.add(this.children,e),e.parent=this}removeChild(e){Array.remove(this.children,e)}addAttribute(e,t){this.attributes||(this.attributes={}),this.attributes[e]=t}toFixedLengthString(e,t){let n=e.toString();const a=t-n.length;for(let e=0;e<a;e++)n="0"+n;return n}toFormatedTimeString(e){const t=e.getUTCFullYear(),n=e.getUTCMonth()+1,a=e.getUTCDate(),i=e.getUTCHours(),o=e.getUTCMinutes(),r=e.getUTCSeconds(),s=e.getUTCMilliseconds();return String.format("{0}-{1}-{2} {3}:{4}:{5}.{6}",this.toFixedLengthString(t,4),this.toFixedLengthString(n,2),this.toFixedLengthString(a,2),this.toFixedLengthString(i,2),this.toFixedLengthString(o,2),this.toFixedLengthString(r,2),this.toFixedLengthString(s,3))}toStatistics(e,t,n){let a="";for(let t=0;t<e;t++)a+="  ";if(this.isFromServer)return a+this.serverMeasurements+"\n";let i=n;i||(i=this.beginTime);const r=this.beginTime.getTime()-i.getTime();let s=a+String.format('<{0} {1}="{2}" {3}="{4}" {5}="{6}"',"o","n",o.a.xmlEncode(this.title),"t",o.a.xmlEncode(r.toString()),"d",o.a.xmlEncode(this.process()));if(n||(s+=String.format(' {0}="{1}" {2}="{3}"',"m",o.a.xmlEncode(t),"ts",o.a.xmlEncode(this.toFormatedTimeString(i)))),this.attributes){const e=this.attributes;for(const t in e){const n={key:t,value:e[t]};let a="";a=n.value.toString(),s+=String.format(' {0}="{1}"',n.key,a)}}let l="";if(this._isEndedNormal||(l+=String.format("<{0}>{1}</{0}>\n","Error","Inaccurate")),this.children&&this.children.length>0)for(let n=0;n<this.children.length;n++)l+=this.children[n].toStatistics(e+1,t,i);return""===l?s+=" />\n":(s+=">\n",s+=l,s+=a+String.format("</{0}>\n","o")),s}constructor(e,t){this._isEndedNormal=!1,this.duration=0,this.title=null,this.serverMeasurements=null,this.beginTime=null,this.endTime=null,this.parent=null,this.children=[],this.isFromServer=!1,this.attributes=null,t?(this.serverMeasurements=e,this.isFromServer=!0):(this.title=e,this.isFromServer=!1),this._hasBeenProcessed=!1}}(0,a.a)(r,"Measurement",null,[]);var s=n(7212);class l{write(e){i.AFrameworkApplication.collectPageStats&&(this._isStopWriting||(this._currentSize+e.length>1048576&&(this._isStopWriting=!0,e="ShowPageStats message size reaches 1MB. Stop writing."),Array.add(this._buffer,e),this._currentSize+=e.length,s.a.pageStatsControl&&s.a.pageStatsControl.isDialogDisplayed()&&s.a.pageStatsControl.displayStatisticIncremental(e)))}read(){return i.AFrameworkApplication.collectPageStats?this._buffer.join(""):null}constructor(){this._buffer=[],this._currentSize=0,this._isStopWriting=!1}}(0,a.a)(l,"PageStatsBuffer",null,[]);n(5149);var c=n(625),d=n(6012),u=n(6796);n(7442);class p{init(){i.AFrameworkApplication.showPageStats&&(this._initialized||(s.a.activeFrame.theClickInputManager.registerHandlerWithData(d.a.click,this._controlElement,(0,c.a)(this,this.pageStatsControlClickHandler,"pageStatsControlClickHandler"),this),s.a.activeFrame.add_onResize((0,c.a)(this,this.resizeHandler,"resizeHandler")),s.a.registerControl(this),this._initialized=!0))}resizeHandler(){}dispose(){i.AFrameworkApplication.showPageStats&&(this._initialized&&(s.a.activeFrame.theMouseInputManager&&s.a.activeFrame.theClickInputManager.unregisterHandler(d.a.click,this._controlElement,(0,c.a)(this,this.pageStatsControlClickHandler,"pageStatsControlClickHandler")),s.a.activeFrame.remove_onResize((0,c.a)(this,this.resizeHandler,"resizeHandler")),s.a.unregisterControl()),this._target.removeChild(this._controlElement),this._controlElement=null)}isDialogDisplayed(){return!!i.AFrameworkApplication.showPageStats&&!!this._pageStatsDialog}displayStatisticIncremental(e){i.AFrameworkApplication.showPageStats&&this._pageStatsDialog&&this._pageStatsDialog.appendText(e)}pageStatsControlClickHandler(e){return!!i.AFrameworkApplication.showPageStats&&(this.createPageStatsDialog(),!0)}createPageStatsDialog(){this._pageStatsDialog=new u.PageStatsDialog(this,s.a.bufferedStats())}dialogClosed(){i.AFrameworkApplication.showPageStats&&(this._pageStatsDialog=null)}constructor(e){this._controlElement=null,i.AFrameworkApplication.showPageStats&&(this._pageStatsDialog=null,this._target=e,this._initialized=!1)}}(0,a.a)(p,"PageStatsControl",null,[11]);const g="WACPageStatsButton";class h extends p{resizeHandler(){const e=n(7212).a.activeFrame.get_element().clientWidth-200,t=n(7212).a.activeFrame.get_element().clientHeight-180;this._controlElement.style.top=t.toString()+"px",this._controlElement.style.left=e.toString()+"px"}constructor(e){if(super(e),!i.AFrameworkApplication.showPageStats)return;const t=e.ownerDocument;this._controlElement=t.createElement("div"),this._controlElement.id=g,this._controlElement.className=g,this._controlElement.style.display="block",this._controlElement.innerText="",this._controlElement.style.zIndex="500";const a=n(7212).a.activeFrame.get_element().clientWidth-200,o=n(7212).a.activeFrame.get_element().clientHeight-180;this._controlElement.style.top=o.toString()+"px",this._controlElement.style.left=a.toString()+"px",e.appendChild(this._controlElement),this.init()}}(0,a.a)(h,"PageStatsFloatingButton",p,[]);var m=n(680);const _="Client";class S{static start(e){i.AFrameworkApplication.collectPageStats&&(s.a.activeFrame=e,S._isStarted=!0)}static stop(){m.a.safeDispose(s.a.pageStatsControl),s.a.pageStatsControl=null,s.a.pageStatsBuffer=null,S._inProgressMeasurement=null,S._rootMeasurement=null,s.a.activeFrame=null,S._isStarted=!1}static isEnabled(){return!!i.AFrameworkApplication.collectPageStats&&(!!S._isStarted&&(s.a.pageStatsBuffer||(s.a.pageStatsBuffer=new l),!s.a.pageStatsControl&&i.AFrameworkApplication.showPageStats&&(s.a.pageStatsControl=new h(document.getElementsByTagName("body")[0])),!0))}static beginRootMeasurement(e,t){if(S.isEnabled()){if(t||(t=new Date),S._inProgressMeasurement){0;let e=S._inProgressMeasurement;for(;e.parent;)e=e.parent;s.a.pageStatsBuffer.write(e.toStatistics(0,_,null)),S._inProgressMeasurement=null,S._rootMeasurement=null}S.beginMeasurement(e,t)}}static beginMeasurement(e,t){if(!S.isEnabled())return;t||(t=new Date);const n=new r(e,!1);n.beginTime=t,S._inProgressMeasurement?(S._inProgressMeasurement.addChild(n),S._inProgressMeasurement=n):(S._inProgressMeasurement=n,S._rootMeasurement=n)}static beginChildMeasurement(e,t){S.isEnabled()&&(t||(t=new Date),S._inProgressMeasurement&&S.beginMeasurement(e,t))}static endRootMeasurement(e){S.isEnabled()&&S._inProgressMeasurement&&(S._inProgressMeasurement.parent&&(S._inProgressMeasurement=S._rootMeasurement),S.endMeasurement(e))}static endMeasurement(e,t){if(S.isEnabled()&&S._inProgressMeasurement)if(t||(t=new Date),S._inProgressMeasurement.title,S._inProgressMeasurement.endTime=t,S._inProgressMeasurement.process(),S._inProgressMeasurement.parent){S._inProgressMeasurement;S._inProgressMeasurement=S._inProgressMeasurement.parent}else s.a.pageStatsBuffer.write(S._inProgressMeasurement.toStatistics(0,_,null)),S._inProgressMeasurement=null,S._rootMeasurement=null}static endChildMeasurement(e,t){S.isEnabled()&&S.endMeasurement(e,t)}static addServerMeasurements(e){if(S.isEnabled()&&""!==e)if(S._inProgressMeasurement){const t=new r(e,!0);S._inProgressMeasurement.addChild(t)}else s.a.pageStatsBuffer.write(e+"\n")}static addAttribute(e,t){S.isEnabled()&&S._inProgressMeasurement&&S._inProgressMeasurement.addAttribute(e,t)}}S._inProgressMeasurement=null,S._rootMeasurement=null,S._isStarted=!1,S.showPageStatsQueryParam="showpagestats",S.showPageStatsXHRHeader="X-ShowPageStats",S.pageStatsResponseXHRHeader="X-PageStats",(0,a.a)(S,"PageStats",null,[])},7212:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static get pageStatsBuffer(){return i._pageStatsBuffer}static set pageStatsBuffer(e){i._pageStatsBuffer=e}static get pageStatsControl(){return i._pageStatsControl}static set pageStatsControl(e){i._pageStatsControl=e}static get activeFrame(){return i._activeFrame}static set activeFrame(e){i._activeFrame=e}static bufferedStats(){return i._pageStatsBuffer.read()}static registerControl(e){i.pageStatsControl=e}static unregisterControl(){i.pageStatsControl=null}}i._pageStatsControl=null,i._activeFrame=null,i._pageStatsBuffer=null,(0,a.a)(i,"PageStatsStatic",null,[])},1251:function(e,t,n){"use strict";n.d(t,{a:function(){return g}});var a=n(100),i=n(6776),o=n(2274),r=n(385),s=n(5149),l=n(7481),c=n(1779),d=n(625),u=n(8555);class p{bindLoggingCommandHandler(){this._useFilteredCommandHandler?this._unregisterLoggingCommandHandlerAction=appChrome.api.bindUserTriggeredCommandHandler((0,d.a)(this,this.handleCommand,"handleCommand")):this._unregisterLoggingCommandHandlerAction=appChrome.api.bindCommandHandler((0,d.a)(this,this.handleCommand,"handleCommand"))}unbindLoggingCommandHandler(){this._unregisterLoggingCommandHandlerAction&&(this._unregisterLoggingCommandHandlerAction(),this._unregisterLoggingCommandHandlerAction=null)}handleCommand(e,t){if(t){if(!this.isUserAction(t,e))return;const n=this.getModifiedCommandId(e,t);this._commandsAttempted.add(n),this.logBlockedAction(n),this._onCommandExecutedOld&&this._onCommandExecutedOld(),this._onCommandExecuted&&this._onCommandExecuted(n),this.setActiveExecutionData(e,t)}}logCommandExecuted(e,t){const n=this.getModifiedCommandId(e,t);if(!this._firstCommandLogged&&this._commandsAttempted.contains(n)&&this.isUserAction(t,e)){let e=String.format("User executed command that was previously attempted and failed : {0}",n);this._callerForLogs&&(e+=String.format(", callerForLogs: {1}",this._callerForLogs)),s.ULS.sendTraceTag(591946008,324,50,e)}this._firstCommandLogged=!0}logBlockedAction(e){let t=String.format("Ignoring user action since SLR is not interactive yet : {0}",e);this._callerForLogs&&(t+=String.format(", callerForLogs: {1}",this._callerForLogs)),s.ULS.sendTraceTag(591946007,324,50,t)}setActiveExecutionData(e,t){this.activeBlockedCommand=e,this.activeCommandHandlerData=t}getModifiedCommandId(e,t){let n=e;return"MenuOpen"===e||"MenuClose"===e||"MenuPopulate"===e?n+=(0,u.a)(String,"-"+t.payload.launcherId):"TabSwitch"===e&&(n+=(0,u.a)(String,"-"+t.payload.tabId)),n}isUserAction(e,t){return!!e.payload&&!("isShadowRendering"in e.payload&&e.payload.isShadowRendering)}constructor(e=null,t=null,n=null){this._unregisterLoggingCommandHandlerAction=null,this._commandsAttempted=new l.a(c.a.get_ordinalIgnoreCase()),this._firstCommandLogged=!1,this._onCommandExecutedOld=e,this._onCommandExecuted=t,this._callerForLogs=n,this.activeBlockedCommand=null,this.activeCommandHandlerData=null,this._useFilteredCommandHandler=o.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("SharedOnline.ChangeGate.PRITriggeredCommandHandler")}}(0,a.a)(p,"ReactPerceivedInteractiveCommandHandler",null,[]);class g{static get perceivedInteractiveCommandHandler(){return g._perceivedInteractiveCommandHandler||(g._perceivedInteractiveCommandHandler=new p((()=>{appChrome.PRIToastManager.showToast(!i.AFrameworkApplicationConstants.hideHeaderEmbedded);const e=!o.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")||!o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1);!r.a.get_instance().isCompleted(7)&&e&&r.a.get_instance().executeWhen(7,(()=>{appChrome.PRIToastManager.dismissToast()}))}))),g._perceivedInteractiveCommandHandler}}g._perceivedInteractiveCommandHandler=null,(0,a.a)(g,"PerceivedInteractiveCommandHandler",null,[])},5721:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a={startWacBoot:"StartWacBoot",hostDuration:"HostDuration",hostPageFetchStart:"HostPageFetchStart",userClickedHostUI:"UserClickedHostUI",userClickTime:"UserClickTime",serverDiagnostics:"ServerDiagnostics",bootDiagnostics:"BootDiagnostics",eupl:"EUPL",ttvr:"TTVR",appTTVR:"AppTTVR",headerTTVR:"HeaderTTVR",ribbonTTVR:"RibbonTTVR",canvasTTVR:"CanvasTTVR",navigationPaneTTVR:"NavigationPaneTTVR",bootResourceStart:"BootResourceStart",bootResourceForContentEditableEnd:"BootResourceForContentEditableEnd",bootResourceForContentViewableStart:"BootResourceForContentViewableStart",bootResourceForContentViewableEnd:"BootResourceForContentViewableEnd",additionalBootResourceStart:"AdditionalBootResourceStart",additionalBootResourceEnd:"AdditionalBootResourceEnd",resourceDownload:"ResourceDownload",resourceDownloadStart:"ResourceDownloadStart",resourceDownloadDuration:"ResourceDownloadDuration",referenceTimestampMarkers:"ReferenceTimestampMarkers",firstSliceLoad:"FirstSliceLoad",firstSliceLoadStart:"FirstSliceLoadStart",firstSliceLoadDuration:"FirstSliceLoadDuration",secondSliceLoadStart:"SecondSliceLoadStart",secondSliceLoadDuration:"SecondSliceLoadDuration",collabSliceLoad:"CollabSliceLoad",collabSliceLoadStart:"CollabSliceLoadStart",collabSliceLoadDuration:"CollabSliceLoadDuration",coreResourceDownloadHighResTime:"CoreResourceDownloadHighResTime",coreResourceCacheHitData:"CoreResourceCacheHitData",contentFetch:"ContentFetch",contentFetchStart:"ContentFetchStart",contentRequestStartToFirstByteDuration:"ContentRequestStartToFirstByteDuration",contentResponseStart:"ContentResponseStart",contentDownloadDuration:"ContentDownloadDuration",serverContentResponseStart:"ServerContentResponseStart",checkFileInfoStartTime:"CheckFileInfoStartTime",checkFileInfoEndTime:"CheckFileInfoEndTime",getFlightedAppSettingsStartTime:"GetFlightedAppSettingsStartTime",getFlightedAppSettingsEndTime:"GetFlightedAppSettingsEndTime",acquireLockStartTime:"AcquireLockStartTime",acquireLockEndTime:"AcquireLockEndTime",getDocumentStartTime:"GetDocumentStartTime",getDocumentEndTime:"GetDocumentEndTime",initialRequestInvokedTime:"InitialRequestInvokedTime",initialResponseReceivedTime:"InitialResponseReceivedTime",initialResponseReadyTime:"InitialResponseReadyTime",skeletalDismissStart:"SkeletalDismissStart",skeletalDismissDuration:"SkeletalDismissDuration",fastViewOpenTime:"FastViewOpenTime",fastViewEntryPoint:"FastViewEntryPoint",fastViewDismissStart:"FastViewDismissStart",fastViewDismissDuration:"FastViewDismissDuration",contentViewable:"ContentViewable",contentViewableHiddenSSR:"ContentViewableHiddenSSR",contentEditableEnd:"ContentEditableEnd",editable:"Editable",contentEditable:"ContentEditable",coreEditingStart:"CoreEditingStart",coreEditingDuration:"CoreEditingDuration",browserFetchStartToContentViewableDuration:"StartToContentViewableDuration",browserFetchStartToContentEditableDuration:"StartToContentEditableDuration",documentLoadedTime:"DocumentLoadedTime",appInit:"AppInit",appInitStart:"AppInitStart",appInitDuration:"AppInitDuration",wopiPendingInitialize:"WopiPendingInitialize",wopiPendingComplete:"WopiPendingComplete",startSessionStart:"StartSessionStart",startSessionComplete:"StartSessionComplete",readyMessageReceiveTime:"ReadyMessageReceiveTime",completeMessageCreateTime:"CompleteMessageCreateTime",completeMessageSendTime:"CompleteMessageSendTime",isStartSessionFromWac:"IsStartSessionFromWac",appSettingsFetched:"AppSettingsFetched",frameNavigationStart:"FrameNavigationStart",frameFetchStart:"FrameFetchStart",frameDomainLookupStart:"FrameDomainLookupStart",frameDomainLookupEnd:"FrameDomainLookupEnd",frameConnect:"FrameConnect",frameConnectStart:"FrameConnectStart",frameSecureConnectionStart:"FrameSecureConnectionStart",frameConnectEnd:"FrameConnectEnd",frameRequest:"FrameRequest",frameRequestStart:"FrameRequestStart",frameResponse:"FrameResponse",frameResponseStart:"FrameResponseStart",frameDownloadDuration:"FrameDownloadDuration",frameRequestStartToFirstByteDuration:"FrameRequestStartToFirstByteDuration",frameTransferSize:"FrameTransferSize",frameDecodedSize:"FrameDecodedSize",frameEncodedSize:"FrameEncodedSize",frameResponseHighResTimeStamp:"FrameResponseHighResTimeStamp",inbound:"Inbound",inboundStart:"InboundStart",inboundEnd:"InboundEnd",parseResponse:"ParseResponse",parseResponseStart:"ParseResponseStart",parseResponseDuration:"ParseResponseDuration",parseResponseDeserialization:"ParseResponseDeserialization",parseResponseDeserializationStart:"ParseResponseDeserializationStart",parseResponseDeserializationDuration:"ParseResponseDeserializationDuration",pageViewSize:"PageViewSize",pageViewValidationStart:"PageViewValidationStart",pageViewValidationEnd:"PageViewValidationEnd",pageViewValidationDuration:"PageViewValidationDuration",pageViewValidation:"PageViewValidation",validationPhaseDurations:"ValidationPhaseDurations",renderDuration:"RenderDuration",navPaneValidation:"NavPaneValidation",navPaneValidationStart:"NavPaneValidationStart",navPaneValidationDuration:"NavPaneValidationDuration",navPaneValidationPhaseDurations:"NavPaneValidationPhaseDurations",navPaneRenderDuration:"NavPaneRenderDuration",pageViewInitSelection:"PageViewInitSelection",pageViewInitSelectionStart:"PageViewInitSelectionStart",scrollDuration:"Scroll Duration",scrollDurationStart:":Scroll:Start",scrollDurationEnd:":Scroll:End",getCellsStartToClientGetCellsFetchStartDuration:"GetCellsStartToClientGetCellsFetchStartDuration",getCellsBrowserStats:"GetCellsBrowserStats",getCellsBootOperations:"GetCellsBootOperations",graphObjectUsage:"GraphObjectUsage",paragraphUsage:"ParagraphUsage",metadataContentBytes:"ContentBytes",metadataEmptyDoc:"EmptyDoc",userActions:"UserActions",visiToggled:"VisiToggled",pageTargetSource:"PageTargetSource",isNewFile:"IsNewFile",newFileTemplateName:"TemplateName",newFileTemplateLcid:"TemplateLcid",surveyInitStart:"SurveyInitStart",surveyInitEnd:"SurveyInitEnd",lineageId:"LineageId",ranTransform:"RanTransform",getCellsServerRedirected:"getCellsServerRedirected",getCellsForceTransformFromBrowserCount:"GetCellsForceTransformFromBrowserCount",indexedDBErrorMessage:"IndexedDBErrorMessage",indexedDBOpenStart:"IndexedDBOpenStart",indexedDBOpenDuration:"IndexedDBOpenDuration",indexedDBUpgradeDuration:"IndexedDBUpgradeDuration",indexedDBOpenErrorDuration:"IndexedDBOpenErrorDuration",indexedDBGetDuration:"IndexedDBGetDuration",indexedDBGetErrorDuration:"IndexedDBGetErrorDuration",indexedDBPutStart:"IndexedDBPutStart",indexedDBPutDuration:"IndexedDBPutDuration",indexedDBPutErrorDuration:"IndexedDBPutErrorDuration",indexedDBCacheHitState:"IndexedDBCacheHitState",isContentSync:"IsContentSync",isHierarchySync:"IsHierarchySync",isHierarchySyncOutbound:"IsHierarchySyncOutbound",socketInitStart:"SocketInitStart",socketConnectDuration:"SocketConnectDuration",socketOpenDuration:"SocketOpenDuration",socketOpenTimeout:"SocketOpenTimeout",socketCloseBeforeOpen:"SocketCloseBeforeOpen",tenantId:"OneNoteTenantId",isEduUser:"IsEduUser",contentSyncFallbackMessage:"ContentSyncFallbackMessage",hierarchyFetch:"HierarchyFetch",hierarchyTransformation:"HierarchyTransformation",isDullScript:"IsDullScript",isWacBootNewJS:"IsWacBootNewJS",officeInitializationTime:"OfficeInitializationTime",modeSwitchTime:"ModeSwitchTime",isFallback:"IsFallback",isInstant:"IsInstant",hostInitDiagnostics:"HostInitializeDiagnostics",clientDiagnostics:"ClientDiagnostics",jsApiDiagnostics:"JsApiDiagnostics",digitalPrintSaveDuration:"DigitalPrintSaveDuration",digitalPrintTimeSpent:"DigitalPrintTimeSpent",swayPreviewRequestDuration:"SwayPreviewRequestDuration",swayPreviewFailedRequestDuration:"SwayPreviewFailedRequestDuration",swayCheckSwayLicenseRequestDuration:"SwayCheckSwayLicenseRequestDuration",swayCheckSwayLicenseFailedRequestDuration:"SwayCheckSwayLicenseRequestFailedDuration",ribbonInteractiveReady:"RibbonInteractiveReady",deepLinkingCommentSelected:"SharedCommentsDeepLinkComplete",isJsApi:"IsJsApi",bootstrapper:"Bootstrapper",navigationViewableCacheUsed:"NavigationViewableCacheUsed",navigationEditableCacheUsed:"NavigationEditableCacheUsed",clickOnSection:"ClickOnSection",sectionLoadSpinnerEnd:"SectionLoadSpinnerEnd",fishBowlLoadEnd:"FishBowlLoadEnd",pageListShown:"PageListShown",clickOnPage:"ClickOnPage",pageLoadingEnd:"PageLoadingEnd",pageLoadEUPL:"PageLoadEUPL",sectionGroupLoadingStart:"SectionGroupLoadingStart",sectionGroupLoadingEnd:"SectionGroupLoadingEnd",navPerf:"NavPerf",bootSSRHtmlStringLength:"BootSSRHtmlStringLength",networkType:"NetworkType",appStaticResourceMetrics:"AppStaticResources",asyncCssChromeReadyOnIdleResourceCount:"AsyncCssChromeReadyOnIdleResourceCount",asyncCssChromeReadyOnIdleQueryStart:"AsyncCssChromeReadyOnIdleQueryStart",asyncCssChromeReadyOnIdleQueryDuration:"AsyncCssChromeReadyOnIdleQueryDuration",asyncCssChromeReadyOnIdleApplyStart:"AsyncCssChromeReadyOnIdleApplyStart",asyncCssChromeReadyOnIdleApplyDuration:"AsyncCssChromeReadyOnIdleApplyDuration",onPollHitWhenResponseWasReadyButWasNotParsedCount:"OnPollHitWhenResponseWasReadyButWasNotParsedCount",onPollHitWhenResponseWasReadyStart:"OnPollHitWhenResponseWasReadyStart",wordBootPerfDebuggingMetrics:"WordBootPerfDebuggingMetrics",splashScreenShown:"SplashScreenShown",splashScreenShownHighResTime:"SplashScreenShownHighResTime",firstPaint:"FirstPaint",firstContentfulPaint:"FirstContentfulPaint",cloudFontFetchStart:"CloudFontFetchStart",cloudFontRequestStartToFirstByteDuration:"CloudFontRequestStartToFirstByteDuration",cloudFontResponseStart:"CloudFontResponseStart",cloudFontDownloadDuration:"CloudFontDownloadDuration",loadRibbonProcessStart:"LoadRibbonProcessStart",loadRibbonProcessEnd:"LoadRibbonProcessEnd",renderRibbonStart:"RenderRibbonStart",renderRibbonDuration:"RenderRibbonDuration",initializeWordRibbonStart:"InitializeWordRibbonStart",ribbonCommandDefinitionMappingStart:"RibbonCommandDefinitionMappingStart",ribbonCommandDefinitionMappingEnd:"RibbonCommandDefinitionMappingEnd",loadGraphicsEditorRibbonInitialLaunchProcessStart:"LoadGraphicsEditorRibbonInitialLaunchProcessStart",loadGraphicsEditorRibbonInitialLaunchProcessEnd:"LoadGraphicsEditorRibbonInitialLaunchProcessEnd",loadGraphicsEditorRibbonProcessStart:"LoadGraphicsEditorRibbonProcessStart",loadGraphicsEditorRibbonProcessEnd:"LoadGraphicsEditorRibbonProcessEnd",disposeEndAfterParse:"DisposeEndAfterParse",setInitialSelectionTaskAdded:"SetInitialSelectionTaskAdded",disposeStartAfterSetInitialSelection:"DisposeStartAfterSetInitialSelection",disposeEndAfterSetInitialSelection:"DisposeEndAfterSetInitialSelection",setupInitialFocusStart:"SetupInitialFocusStart",setupInitialFocusEnd:"SetupInitialFocusEnd",synchronizeWithFastViewStart:"SynchronizeWithFastViewStart",synchronizeWithFastViewEnd:"SynchronizeWithFastViewEnd",graphTransactionStart:"GraphTransactionStart",renderedOutlineView:"RenderedOutlineView",shouldRenderOutlineGroup:"ShouldRenderOutlineGroup",renderViewportContentTaskAdded:"RenderViewportContentTaskAdded",initialRenderViewportContentCompleted:"InitialRenderViewportContentCompleted",wacPerfObserver:"WacPerfObserver",reactNotificationManagerStart:"ReactNotificationManagerStart",reactNotificationManagerDuration:"ReactNotificationManagerDuration",networkDisconnectedStart:"NetworkDisconnectedStart",networkDisconnectedEnd:"NetworkDisconnectedEnd",loggingDuringBootDuration:"LoggingDuringBootDuration",isGetCellsBrowserCacheHit:"IsGetCellsBrowserCacheHit",browserCacheStalenessInDays:"BrowserCacheStalenessInDays",encryptedPasswordDialogPageDuration:"EncryptedPasswordDialogPageDuration",isEncryptedPasswordFlow:"IsEncryptedPasswordFlow",ppInitialPagesLoadingDuration:"PPFirstFivePagesLoadingDuration",ppApendingImageTagsDuration:"PPApendingImageTagsDuration",browserSideCacheDisplayDiagnostics:"browserSideCacheDisplayDiagnostics",browserSideCacheSaveDiagnostics:"browserSideCacheSaveDiagnostics",browserSideCacheDismissCacheViewDuration:"browserSideCacheDismissCacheViewDuration",browserSideCacheRemoveDiagnostics:"browserSideCacheRemoveDiagnostics",browserSideCacheDismissCacheViewDiagnostics:"browserSideCacheDismissCacheViewDiagnostics",appFullyLoaded:"AppInitStatus_appFullyLoaded",webpackRuntimeChunkStart:"webpackRuntimeChunkStart",webpackRuntimeChunkEnd:"webpackRuntimeChunkEnd",paragraphFontAnalysisStart:"ParagraphFontAnalysisStart",paragraphFontAnalysisEnd:"ParagraphFontAnalysisEnd",paragraphFontAnalysisDuration:"ParagraphFontAnalysisDuration"}},1615:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.NetworkTiming.IResourceTimingLogger")},9454:function(e,t,n){"use strict";n.d(t,{a:function(){return _}});var a=n(100),i=n(3792),o=n(1615),r=n(5149),s=n(8555),l=n(884),c=n(5721),d=n(2274),u=n(6776);class p{logToMdm(e,t){const n=this.prepareRequestPayload(e,t);u.AFrameworkApplicationConstants.theClientRequestManager.addRequest(d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl"),2,n,null,!1,1,null,null,null,void 0,void 0,void 0,void 0,"PerfTelemetry")}prepareRequestPayload(e,t){const n={},a={};return n.euplValue=e,n.perfEuplDimensions=t,a.type=this.requestType,a.payloadJson=JSON.stringify(n),JSON.stringify(a)}constructor(){this.requestType="PERF_EUPL"}}(0,a.a)(p,"EuplTelemetryLogger",null,[506]);class g{logToMdm(e,t){const n=this.prepareRequestPayload(e,t);u.AFrameworkApplicationConstants.theClientRequestManager.addRequest(d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl"),2,n,null,!1,1,null,null,null,void 0,void 0,void 0,void 0,"PerfTelemetry")}prepareRequestPayload(e,t){const n={},a={};return n.hostCallPerfValue=e,n.perfHostCallDimensions=t,a.type=this.requestType,a.payloadJson=JSON.stringify(n),JSON.stringify(a)}constructor(){this.requestType="PERF_HOSTCALLS"}}(0,a.a)(g,"HostCallsTelemetryLogger",null,[506]);class h{createPerfTelemetryLogger(e){let t=null;switch(e){case 0:t=new p;break;case 1:t=new g;break;default:t=null}return t}}(0,a.a)(h,"PerfTelemetryLoggerFactory",null,[300]);var m=n(965);class _{get pageLoadPerfMetrics(){return this._pageLoadPerfMetrics}get resourceTimingLoggerFuture(){return this._resourceTimingLoggerFuture||(this._resourceTimingLoggerFuture=(0,i.h)(o.a))}addMetrics(e,t){this.isValid(e)&&(this._pageLoadPerfMetrics[e]=t,this.removeProblematicProperties())}addMetadata(e,t){this._logged||(this._metadataDict||(this._metadataDict={}),this.isValidInDictionary(e,this._metadataDict)&&(this._metadataDict[e]=t))}isValid(e){return this.isValidInDictionary(e,this._pageLoadPerfMetrics)}isValidInDictionary(e,t){return!this._logged&&!(e in t)}addMetric(e,t){this.isValid(e)&&(this._pageLoadPerfMetrics[e]=t,this.removeProblematicProperties())}addMetricOnce(e,t){this.isValid(e)&&void 0===this._pageLoadPerfMetrics[e]&&(this._pageLoadPerfMetrics[e]=t,this.removeProblematicProperties())}addDurationMetric(e,t,n){if(this.isValid(t)&&e in this._pageLoadPerfMetrics){const a=this._pageLoadPerfMetrics[e];this._pageLoadPerfMetrics[t]=n-a}}getMetric(e){return this._pageLoadPerfMetrics?this._pageLoadPerfMetrics[e]:null}hasTabSwitched(){if(this.containsMetric(c.a.userActions)){return this.getMetric(c.a.userActions)[c.a.visiToggled]>0}return!1}containsMetric(e){return!this._logged&&e in this._pageLoadPerfMetrics}get hasLogged(){return this._logged}clearMetric(e){this._logged||delete this._pageLoadPerfMetrics[e]}log(){this._logged?r.ULS.shipAssertTag(19214609,324,!0,"Attempt to log after object is logged."):(this.resourceTimingLoggerFuture.execute((e=>{e.flush(),this.logImpl()})),this._logged=!0)}logImpl(){this.computeAndAddDurationMetrics(),this.addPerformanceObserverEntries(),this.removeProblematicProperties();let e=m.c(this._pageLoadPerfMetrics);const t=3e3,n=_.zeroPad(Math.ceil(e.length/t).toString(),3);for(let a=1;e.length>0;a++)r.ULS.sendTraceTag(19214611,324,50,"Chunk {0} of {1} PageLoadPerfRecorder: {2}",_.zeroPad(a.toString(),3),n,e.substr(0,t)),e=e.substr(t);if(this._pageLoadPerfMetrics=null,d.AFrameworkApplication_AppSettingsManager.appSettingsManager&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("AppStaticResourceMonitorIsEnabled")&&this.resourceTimingLoggerFuture.execute((e=>{let n=m.c(e.getAppResourceTimingMetrics());const a=_.zeroPad(Math.ceil(n.length/t).toString(),3);for(let e=1;n.length>0;e++)r.ULS.sendTraceTag(51652514,324,50,"Chunk {0} of {1} StaticContent: {2}",_.zeroPad(e.toString(),3),a,n.substr(0,t)),n=n.substr(t)})),d.AFrameworkApplication_AppSettingsManager.appSettingsManager&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("HashedResourcePathManagerLogOnExitIsEnabled")){const e=l.a.instance.getUnusedResourcesOnExit();e&&this.resourceTimingLoggerFuture.execute((n=>{let a=m.c(e);const i=_.zeroPad(Math.ceil(a.length/t).toString(),3);for(let e=1;a.length>0;e++)r.ULS.sendTraceTag(591015966,324,50,"Chunk {0} of {1} UnusedResources: {2}",_.zeroPad(e.toString(),3),i,a.substr(0,t)),a=a.substr(t)}));const n=l.a.instance.getVersionedAndNonSRIResourcesOnExit();n&&this.resourceTimingLoggerFuture.execute((e=>{r.ULS.sendTraceTag(508846852,306,50,JSON.stringify(n))}))}}removeProblematicProperties(){this._pageLoadPerfMetrics.HostInitializeDiagnostics?.unifiedUiHostDiagnostics?.perfNavigationTiming?.name&&delete this._pageLoadPerfMetrics.HostInitializeDiagnostics.unifiedUiHostDiagnostics.perfNavigationTiming.name,this._pageLoadPerfMetrics.HostPageLoadDiagnostics?.HostInitializeDiagnostics?.unifiedUiHostDiagnostics?.perfNavigationTiming?.name&&delete this._pageLoadPerfMetrics.HostPageLoadDiagnostics.HostInitializeDiagnostics.unifiedUiHostDiagnostics.perfNavigationTiming.name}logTelemetry(){this.resourceTimingLoggerFuture.execute((e=>{e.flush(),e.recordAppResourceTimingMetricsToKpi()})),d.AFrameworkApplication_AppSettingsManager.appSettingsManager&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("PerfHostCallsRemoteTelemetryProcessorIsEnabled")&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("AcquireLockHostCallLoggingIsEnabled")&&this.sendAcquireLockToMdm(),d.AFrameworkApplication_AppSettingsManager.appSettingsManager&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("PerfHostCallsRemoteTelemetryProcessorIsEnabled")&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("GetDocumentHostCallLoggingIsEnabled")&&this.sendGetDocumentToMdm(),d.AFrameworkApplication_AppSettingsManager.appSettingsManager&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("PerfHostCallsRemoteTelemetryProcessorIsEnabled")&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("GetContentBundleHostCallLoggingIsEnabled")&&this.sendGetContentBundleToMdm()}sendGetContentBundleToMdm(){this.logMetricValue("bundleRequestsData","GetContentBundle")}sendGetDocumentToMdm(){this.logMetricValue("fileRequestsData","GetDocument")}sendAcquireLockToMdm(){this.logMetricValue("fileRequestsData","AcquireLock")}logMetricValue(e,t){const n=this.getDictionaryFromDiagnostics(e,t);if(!n)return;const a=n.endTime,i=n.startTime;let o="";"requestStatus"in n&&(o=n.requestStatus);const r=a-i,s=this.getDimensions();s.HostCallName=t,s.RequestStatus=o;const l=(new h).createPerfTelemetryLogger(1);l&&l.logToMdm(r,s)}getDictionaryFromDiagnostics(e,t){let n=null;try{const a=this._pageLoadPerfMetrics[c.a.bootDiagnostics];if(!(e in a))return r.ULS.sendTraceTag(594626787,324,100,"Category {0} does not exist in BootDiagnostics",e),null;const i=a[e];if(!(t in i))return r.ULS.sendTraceTag(594626786,324,100,"Metric {0} does not exist under category {1} in BootDiagnostics",t,e),null;n=i[t]}catch(e){r.ULS.sendTraceTag(594626785,324,10,"Encountered the following exception when trying to get metric from boot diagnostics dictionary {0}",e)}return n}getDimensions(){const e={};e.Application=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.Application)||"",e.ApplicationMode=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.ApplicationMode)||"";const t=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.UserSessionApplicationMode)||"";return e.AppAndMode=e.Application+"-"+t,e.Browser=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.Browser)||"",e.BrowserMajorVersion=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.BrowserMajorVersion)||"",e.BrowserVersion=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.BrowserVersion)||"",e.Build=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.WFEVersion)||"",e.Datacenter=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.WACDatacenter)||"",e.Host=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.Host)||"",e.Ring=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.Ring)||"-1",e.IsSynthetic=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.IsSynthetic)||"",e.OS=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.OS)||"",e.RoutedVia=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.RoutedVia)||"",e.SessionOrigin=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionOriginParamName)||"",e.UiHost=(0,s.a)(String,u.AFrameworkApplicationConstants.sessionStartInfoSettings.UiHost)||"",e}computeAndAddDurationMetrics(){this._metadataDict&&(this._pageLoadPerfMetrics.Metadata=this._metadataDict),this.addDuration(c.a.userClickedHostUI,c.a.frameFetchStart,c.a.hostDuration),this.addDuration(c.a.frameFetchStart,c.a.contentViewable,c.a.browserFetchStartToContentViewableDuration),this.addDuration(c.a.frameFetchStart,c.a.contentEditable,c.a.browserFetchStartToContentEditableDuration),this.addGetCellsStartToClientGetCellsFetchStartDuration()}addPerformanceObserverEntries(){if(!d.AFrameworkApplication_AppSettingsManager.appSettingsManager||!d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("WacPerfObserverEntriesIsEnabled"))return;const e=window.wacPerfObserver;e&&this.addMetrics(c.a.wacPerfObserver,e)}addGetCellsStartToClientGetCellsFetchStartDuration(){if(c.a.contentFetchStart in this._pageLoadPerfMetrics&&c.a.frameResponseStart in this._pageLoadPerfMetrics&&c.a.frameFetchStart in this._pageLoadPerfMetrics){const e=this._pageLoadPerfMetrics[c.a.contentFetchStart],t=this._pageLoadPerfMetrics[c.a.frameResponseStart],n=this._pageLoadPerfMetrics[c.a.frameFetchStart];this._pageLoadPerfMetrics[c.a.getCellsStartToClientGetCellsFetchStartDuration]=e-(t-n)}}addDuration(e,t,n){if(t in this._pageLoadPerfMetrics){const a=this._pageLoadPerfMetrics[t];this.addDurationMetric(e,n,a)}}static get instance(){return _._instance||(_._instance=new _)}static zeroPad(e,t){let n="";for(let a=e.length;a<t;a++)n+="0";return n+e}constructor(){this._pageLoadPerfMetrics={},this._metadataDict=null,this._logged=!1,this._resourceTimingLoggerFuture=null}}_._instance=null,(0,a.a)(_,"PageLoadPerfRecorder",null,[100])},6336:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static get browserSupportsPerformanceMark(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.mark||null===window.performance.mark)}static start(){i._outputElement||(i._outputElement=document.getElementById("perf-markers"),i._outputElement||(i._outputElement=document.createElement("div"),i._outputElement.id="perf-markers",i._outputElement.style.display="none",document.body.appendChild(i._outputElement)),i.mark(1),i.mark(4808),i.mark(4809))}static isStarted(){return!!i._outputElement}static stop(){i.mark(4807),i._outputElement=null}static msWriteProfilerMark(e){window.self.msWriteProfilerMark&&window.self.msWriteProfilerMark(e)}static mark(e){if(!i._outputElement)return;const t=(new Date).format("MM/dd/yyyy HH:mm:ss.fffffff");i.exportToPerfMetricsDiv(e,t),i.browserSupportsPerformanceMark&&window.performance.mark(e.toString())}static exportToPerfMetricsDiv(e,t){if(!i._outputElement)return;const n=document.createElement("p"),a=document.createElement("span");a.className="time",a.innerText=t,n.appendChild(a);const o=document.createTextNode(" - ");n.appendChild(o);const r=document.createElement("span");r.className="marker",r.innerText=e.toString(),n.appendChild(r),i._outputElement.appendChild(n),i.msWriteProfilerMark(""+e)}}i._outputElement=null,(0,a.a)(i,"PerfMetrics",null,[])},1891:function(e,t,n){"use strict";n.d(t,{a:function(){return k}});var a=n(100),i=n(3792),o=n(1615),r=n(5149),s=n(353),l=n(385),c=n(4168),d=n(5467),u=n(6534),p=n(5721),g=n(9454);class h{getTimeOrigin(){return void 0!==window.performance&&null!==window.performance&&void 0!==window.performance.timeOrigin&&null!==window.performance.timeOrigin?window.performance.timeOrigin:void 0!==window.performance&&null!==window.performance&&void 0!==window.performance.timing.navigationStart&&null!==window.performance.timing.navigationStart?window.performance.timing.navigationStart:0}getTimeDelta(){return void 0!==window.performance&&null!==window.performance&&void 0!==window.performance.now&&null!==window.performance.now?window.performance.now():(new Date).getTime()-this.getTimeOrigin()}recordTimeStampAndDelta(e){const t=(new Date).getTime(),n=this.getTimeDelta();e+"_FirstTimeStamp"in this._ttvrMetrics||(this._ttvrMetrics[e+"_FirstTimeStamp"]=t,this._subcomponentTTVRReached[e]=!1),this.hasSubcomponentReachedTTVR(e)||(this._ttvrMetrics[e+"_LastTimeStamp"]=t,this._ttvrMetrics[e+"_TimeDelta"]=n)}hasSubcomponentReachedTTVR(e){return this._subcomponentTTVRReached[e]}reportSubcomponentTTVR(e){this._subcomponentTTVRReached[e]=!0}reportTTVR(){try{const e=[{name:"timeOrigin",double:this.getTimeOrigin()}],t=this._ttvrMetrics;for(const n in t){const a={key:n,value:t[n]};Array.add(e,{name:a.key,double:a.value})}u.b("SubcomponentsCanvas_TTVR",!0,0,e)}catch(e){r.ULS.sendTraceTag(556319394,306,15,"Record TTVR subcomponents for canvas metric error: "+e.toString())}}static get instance(){return h._instance||(h._instance=new h)}constructor(){this._ttvrMetrics={},this._subcomponentTTVRReached={}}}h._instance=null,h.trackChangesMetric="TrackChanges",h.commentsFishbowlMetric="CommentsFishbowl",h.atMentions="AtMentions",h.editorMarkupsSpelling="EditorMarkupsSpelling",h.editorMarkupsGrammar="EditorMarkupsGrammar",h.editorMarkupsAdvanced="EditorMarkupsAdvanced",(0,a.a)(h,"TTVRReporting",null,[]);var m=n(965),_=n(7958),S=n(6362),f=n(734),C=n(7449),y=n(6949),A=n(682),b=n(9800),T=n(3245),v=n(1600),w=n(4990);const F="g_jsLT",I="g_afterJs",E="AppLoadMetric",M="AppLoadState";class k{get pageLoadPerfRecorder(){return this._perfReportingConstantsInstance.pageLoadPerfRecorder}set pageLoadPerfRecorder(e){this._perfReportingConstantsInstance.pageLoadPerfRecorder=e}get bootKpiMetrics(){return this._perfReportingConstantsInstance.bootKpiMetrics}set bootKpiMetrics(e){this._perfReportingConstantsInstance.bootKpiMetrics=e}get isRealContentDisplayedForBoot(){return this._isRealContentDisplayedForBoot}get appIsInteractiveTask(){return this._appIsInteractiveTask.task}initWsaClient(e){if(this._wsaClient=e,this._timestampBaseline<Number.MAX_VALUE){this.updateBaseline(this._timestampBaseline);const e=this._datapoints;for(const t in e){const n={key:t,value:e[t]},a=Number.parseInvariant(n.key);this._wsaClient.setDw(a,n.value)}}}recordResourceDownloadStart(){const e=window.g_firstByte;if(null!=e){const t=e.getTime();this.recordTimestamp(k.DATAID_BSQM_RESOURCEDOWNLOADSTART,t),this.pageLoadPerfRecorder.addMetric(p.a.resourceDownloadStart,t)}}recordResourceDownloadEnd(){const e=window[F],t=window[I],n=null!=e?e.getTime():0,a=null!=t?t.getTime():0,i=Math.max(n,a);if(i>0){const e=n>a?F:I;this.measureMarks(p.a.resourceDownload,"g_firstByte",e),this.recordTimestamp(k.DATAID_BSQM_RESOURCEDOWNLOADEND,i),this.pageLoadPerfRecorder.addDurationMetric(p.a.resourceDownloadStart,p.a.resourceDownloadDuration,i)}}recordPaintTimings(){if(!k.browserSupportsPerformanceTiming||!k.browserSupportsPerformanceGetEntriesByType)return;const e=window.performance.getEntriesByType("paint");for(const t of e)switch(t.name){case"first-paint":this.pageLoadPerfRecorder.addMetric(p.a.firstPaint,t.startTime);break;case"first-contentful-paint":this.pageLoadPerfRecorder.addMetric(p.a.firstContentfulPaint,t.startTime)}}recordBootResourceTimings(){if(!k.browserSupportsPerformanceTiming||!k.browserSupportsPerformanceGetEntriesByType)return;const e=window.performance.getEntriesByType("resource"),t=window.performance.timing.navigationStart;let n=0,a=0,i=!1;for(const o of e)"script"!==o.initiatorType&&"link"!==o.initiatorType||t+o.startTime>T.AFrameworkApplication.bootTime||(i?(o.startTime<n&&(n=o.startTime),o.responseEnd>a&&(a=o.responseEnd)):(n=o.startTime,a=o.responseEnd,i=!0));if(!i)return;this.pageLoadPerfRecorder.addMetric(p.a.bootResourceStart,n),this.pageLoadPerfRecorder.addMetric(p.a.bootResourceForContentEditableEnd,a);const o=window.g_bootScriptsStartTime;if(null!=o){const e=o.getTime();this.pageLoadPerfRecorder.addMetric(p.a.bootResourceForContentViewableStart,e)}const r=window.g_bootScriptsEndTime;if(null!=r){const e=r.getTime();this.pageLoadPerfRecorder.addMetric(p.a.bootResourceForContentViewableEnd,e)}}addMark(e){return this._perfReportingConstantsInstance.addMark(e)}getPerfEntriesByName(e){let t=[];return k.browserSupportsPerformanceGetEntriesByName&&(t=window.performance.getEntriesByName(e)),t}measureMarks(e,t,n,a=!1){let i=null;if(k.browserSupportsPerformanceMarkAndMeasure)try{window.performance.measure(e,t,n),a&&(i=window.performance.getEntriesByName(e,"measure"))}catch(e){}return i}recordContentFetchStart(e){this.recordTimestamp(k.DATAID_BSQM_CONTENTFETCHSTART,e)}recordContentFetchEnd(e){this.recordTimestamp(k.DATAID_BSQM_CONTENTFETCHEND,e)}recordContentToModelConversion(){this.recordTimestamp(k.DATAID_BSQM_CONTENTTOMODELCONVERSIONEND,(new Date).getTime())}recordAppInitStart(e){this.recordTimestamp(k.DATAID_BSQM_APPINITCODESTART,e),this.pageLoadPerfRecorder.addMetric(p.a.appInitStart,e)}recordAppInitEnd(){this.postBootState("AppInitEnd"),T.AFrameworkApplication.get_hostPostmessengerFuture().execute((e=>e.sendMessage("App_InitEnd",null)));const e=(new Date).getTime();this.addMark(p.a.appInitDuration),this.measureMarks(p.a.appInit,p.a.appInitStart,p.a.appInitDuration),this.recordTimestamp(k.DATAID_BSQM_APPINITCODEEND,e),this.pageLoadPerfRecorder.addDurationMetric(p.a.appInitStart,p.a.appInitDuration,e)}recordDocumentLoadedTime(e){return this._perfReportingConstantsInstance.recordDocumentLoadedTime(e)}recordOfficeFrameRequestStart(){void 0!==window.performance&&null!==window.performance&&void 0!==window.performance.timing&&null!==window.performance.timing&&this.pageLoadPerfRecorder.addMetric(p.a.frameRequestStart,window.performance.timing.requestStart)}recordSplashScreenShown(){this.sendBeaconForBootPhase("SplashScreenShown"),this.postBootState("SplashScreenShown"),T.AFrameworkApplication.get_hostPostmessengerFuture().execute((e=>e.sendMessage("App_SplashScreenShown",null)));const e=window.g_cssLT,t=window.__startTime,n=window.g_splashScreenShown,a=null!=n?n.getTime():Math.max(null!=e?e.getTime():0,null!=t?t.getTime():0);a>0&&(this.recordTimestamp(k.DATAID_BSQM_SPLASHSCREENSHOWN,a),this.pageLoadPerfRecorder.addMetric(p.a.splashScreenShown,a));const i=window.g_splashScreenShownHighResTime;i>0&&this.pageLoadPerfRecorder.addMetric(p.a.splashScreenShownHighResTime,i)}recordContentViewableHiddenSSR(e){this.pageLoadPerfRecorder.addMetric(p.a.contentViewableHiddenSSR,e)}recordFastViewEntryPoint(e){this.pageLoadPerfRecorder.addMetric(p.a.fastViewEntryPoint,e)}recordContentDisplayed(e){this.sendBeaconForBootPhase("RecordContentDisplayed"),this.postBootState("ContentDisplayed"),this.recordContentDisplayedAfterBeaconSent(e);try{const t=window.g_splashScreenShown,n=null!=t?t.getTime():0;e-n>4e3&&b.a.logUniqueUsage("CfSplashScreenText;TFSplashScreenTextOne;TFSplashScreenTextTwo")}catch(e){r.ULS.sendExceptionTraceTag(508872718,306,15,e,"Failed to record splashScreenShownDurationMs.")}}recordPerceivedContentDisplayed(e){this.recordContentDisplayedAfterBeaconSent(e,!1)}recordContentDisplayedAfterBeaconSent(e,t=!0){if(this._isAppInteractive&&t){const e=this.getSessionStartInfo();k.logBootFinished(this.userSessionId,e),this.logBootstrapperMetrics(e)}this._isRealContentDisplayedForBoot=t,this.isContentDisplayTimeAlreadySet||(this.recordTimestamp(k.DATAID_BSQM_CONTENTDISPLAYED,e),this.pageLoadPerfRecorder.addMetric(p.a.contentViewable,e),this.isContentDisplayTimeAlreadySet=!0,this.dispatchAppMetricReportedEvent(p.a.contentViewable,e))}recordContentDisplayedFromHostWindowRendering(e){this.isRealContentDisplayedForBoot?(this.recordTimestamp(k.DATAID_BSQM_CONTENTDISPLAYED,e),this.pageLoadPerfRecorder.clearMetric(p.a.contentViewable),this.pageLoadPerfRecorder.addMetric(p.a.contentViewable,e),this.isContentDisplayTimeAlreadySet=!0,this.dispatchAppMetricReportedEvent(p.a.contentViewable,e)):this.recordContentDisplayedAfterBeaconSent(e),this.pageLoadPerfRecorder.addMetric(p.a.browserFetchStartToContentViewableDuration,0)}recordInteractivityContentDisplayed(e){this.recordDatapoint(k.DATAID_BSQM_INTERACTIVITYCONTENTDISPLAYED,e)}recordAppInteractive(e){this.sendBeaconForBootPhase("RecordAppInteractive"),this.postBootState("AppInteractive"),this.recordAppInteractiveAfterBeaconSent(e),d.Health.instance.removeQosPillar(f.a[f.a.Boot])}recordAppInteractiveAfterBeaconSent(e){if(this.isRealContentDisplayedForBoot){const e=this.getSessionStartInfo();k.logBootFinished(this.userSessionId,e),this.logBootstrapperMetrics(e)}this._isAppInteractive=!0,this._appIsInteractiveTask.setResult(!0),this.recordTimestamp(k.DATAID_BSQM_APPINTERACTIVE,e),T.AFrameworkApplication.appSettingsManager&&T.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacPerfObserverEntriesIsEnabled")&&(this.addStableInteractiveEventListener(),this.dispatchAppInteractiveEvent(),this.dispatchAppMetricReportedEvent(p.a.contentEditable,e)),T.AFrameworkApplication.appSettingsManager&&T.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9142601_QuietWindowTrackingIsEnabled")&&this.addQuietWindowEventListener(),this.addAppLoadStateEventListener(),this.addAppLoadMetricReportEventListener(),this.addAppLoadTraceEventListener(),this.pageLoadPerfRecorder.addMetric(p.a.contentEditable,e)}recordUserClickedInHostUi(e){this.pageLoadPerfRecorder.addMetric(p.a.userClickedHostUI,e),this.recordTimestamp(k.DATAID_BSQM_USERCLICKEDHOSTUI,e)}recordWacIframeGeneratedInHost(e){this.recordTimestamp(k.DATAID_BSQM_HOSTIFRAMEGENERATED,e)}recordHostPageFetchStart(e){this.pageLoadPerfRecorder.addMetric(p.a.hostPageFetchStart,e),this.recordTimestamp(k.DATAID_BSQM_HOSTPAGEFETCHSTART,e)}recordHostPageRedirectCount(e){const t=k.DATAID_BSQM_HOSTPAGEREDIRECTCOUNT;this.recordDatapoint(t,e)}recordEditClickedInWebApp(e){this.recordTimestamp(k.DATAID_BSQM_EDITINWEBAPPCLICKED,e)}recordViewClickedInWebApp(e){this.recordTimestamp(k.DATAID_BSQM_VIEWINWEBAPPCLICKED,e)}recordBrowserFetchStart(e){this.recordTimestamp(k.DATAID_BSQM_BROWSERFETCHSTART,e)}recordBrowserNavigationStart(e){this.recordTimestamp(k.DATAID_BSQM_BROWSERNAVIGATIONSTART,e)}recordWacRenderTimeFromBrowserFetchStart(e){let t;({timestampMs:t}=this.tryGetBrowserFetchStart()).returnValue&&this.recordWacRenderTime(e-t),this.recordLegacyWacRenderTimeIfNeeded()}recordWacRenderTime(e){this.recordDatapoint(k.DATAID_BSQM_WACRENDERTIME,e)}recordLegacyWacRenderTimeIfNeeded(){T.AFrameworkApplication.reportRenderTime(null,!k.browserSupportsPerformanceTiming)}recordWindowVisibilityMetrics(e=null){let t=0;if(e||(e=this.getWindowVisibilityMetricsModule()),!e)return r.ULS.sendTraceTag(21307853,326,10,"visibilitymetrics module not found"),t;const n=e.metrics;if(!n)return r.ULS.sendTraceTag(21307854,326,10,"visibilitymetrics lookup failed"),t;r.ULS.sendTraceTag(21307855,326,50,"WindowVisibilityMetrics: {0}",n);const a=this.getVisibilityToggledTime(n);if(a){t=a.getTime();const e={VisiToggled:t};this.pageLoadPerfRecorder.addMetrics(p.a.userActions,e)}return this.hasQueuedStopVisibilityMetrics||(this.hasQueuedStopVisibilityMetrics=!0,l.a.get_instance().executeWhen(8,(()=>{e.stop()}))),t}recordNewFileMetrics(e,t,n){if(this.pageLoadPerfRecorder.addMetric(p.a.isNewFile,e),e){const e=t||"blank",a=n||"";this.pageLoadPerfRecorder.addMetric(p.a.newFileTemplateName,e.toUpperCase()),this.pageLoadPerfRecorder.addMetric(p.a.newFileTemplateLcid,a)}}recordHostInitDiagnostics(e){this.pageLoadPerfRecorder.addMetrics(p.a.hostInitDiagnostics,e)}recordClientDiagnostics(e){this.pageLoadPerfRecorder.addMetrics(p.a.clientDiagnostics,e)}recordJsApiDiagnostics(e){this.pageLoadPerfRecorder.addMetric(p.a.jsApiDiagnostics,e)}tryGetBrowserFetchStart(){let e;return e=0,k.browserSupportsPerformanceTiming?(e=window.performance.timing.fetchStart>0?window.performance.timing.fetchStart:window.performance.timing.navigationStart,{returnValue:!0,timestampMs:e}):{returnValue:!1,timestampMs:e}}recordTimestamp(e,t){e.toString()in this._timestamps&&r.ULS.sendTraceTag(3515215,306,15,"Timestamp recorded twice: "+e),this._timestamps[e.toString()]=t,t<this._timestampBaseline?this.updateBaseline(t):this._wsaClient&&this._wsaClient.setDw(e,t-this._timestampBaseline)}updateBaseline(e){if(this._timestampBaseline=e,!this._wsaClient)return;this._wsaClient.setDw(k.DATAID_BSQM_TIMESTAMPBASELINEHIGH,Math.floor(e/4294967296)),this._wsaClient.setDw(k.DATAID_BSQM_TIMESTAMPBASELINELOW,e%4294967296);const t=this._timestamps;for(const e in t){const n={key:e,value:t[e]},a=Number.parseInvariant(n.key),i=n.value-this._timestampBaseline;this._wsaClient.setDw(a,i)}}recordDatapoint(e,t){this._wsaClient?this._wsaClient.setDw(e,t):this._datapoints[e.toString()]=t}logBootstrapperMetrics(e){e&&(this.pageLoadPerfRecorder.addMetric(p.a.isJsApi,e.IsJsApi||""),this.pageLoadPerfRecorder.addMetric(p.a.bootstrapper,e.Bootstrapper||""))}getSessionStartInfo(){const e=T.AFrameworkApplication.appSettingsManager.appSettings.SessionStartInfoJson;return e?m.b(e.toString()):{}}dispatchAppInteractiveEvent(){y.a.browserSupportsCustomEvent()&&c.a.dispatch("WacAppInteractive")}dispatchAppMetricReportedEvent(e,t){return this._perfReportingConstantsInstance.dispatchAppMetricReportedEvent(e,t)}addAppLoadStateEventListener(){c.a.addEventListener(window,"Wac-AppLoadStateReport",this.recordAppLoadStateInActivity),r.ULS.sendTraceTag(545837839,306,50,"Listener added for event type Wac-AppLoadStateReport")}addAppLoadMetricReportEventListener(){c.a.addEventListener(window,"Wac-AppLoadMetricReport",this.recordAppLoadMetricReportInActivity),r.ULS.sendTraceTag(545837843,306,50,"Listener added for event type Wac-AppLoadMetricReport")}getClickTimeIfExists(){return this.pageLoadPerfRecorder.containsMetric(p.a.userClickedHostUI)?this.pageLoadPerfRecorder.getMetric(p.a.userClickedHostUI):this.pageLoadPerfRecorder.containsMetric(p.a.userClickTime)?this.pageLoadPerfRecorder.getMetric(p.a.userClickTime):0}getFrameFetchStartIfExists(){return this.pageLoadPerfRecorder.containsMetric(p.a.frameFetchStart)?this.pageLoadPerfRecorder.getMetric(p.a.frameFetchStart):0}getFrameNavigationStartIfExists(){return this.pageLoadPerfRecorder.containsMetric(p.a.frameNavigationStart)?this.pageLoadPerfRecorder.getMetric(p.a.frameNavigationStart):0}getDocPageNavigationStartIfExists(){return this.pageLoadPerfRecorder.containsMetric("DocPageNavigationStart")?this.pageLoadPerfRecorder.getMetric("DocPageNavigationStart"):0}getPowerPointHostDiagnostics(){return m.c({DocPageNavigationStart:this.pageLoadPerfRecorder.getMetric("DocPageNavigationStart"),DocPageFetchStart:this.pageLoadPerfRecorder.getMetric("DocPageFetchStart"),DocPageRequestStart:this.pageLoadPerfRecorder.getMetric("DocPageRequestStart"),DocPageResponseStart:this.pageLoadPerfRecorder.getMetric("DocPageResponseStart"),DocPageResponseEnd:this.pageLoadPerfRecorder.getMetric("DocPageResponseEnd"),UserClickTime:this.pageLoadPerfRecorder.getMetric("UserClickTime")})}getHostDiagnosticsDataByApp(e){let t="";if(e)t=e;else{t=this.getSessionStartInfo().Application}let n="";switch(t){case"Excel":n=this.pageLoadPerfRecorder.getMetric("HostPageLoadDiagnostics");break;case"Word":n=this.pageLoadPerfRecorder.getMetric("HostInitializeDiagnostics");break;case"OneNote":n=T.AFrameworkApplication.appSettingsManager&&T.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9870112_JsonSerializationForHostDiagnosticsPropertyIsEnabled")?m.c(this.pageLoadPerfRecorder.getMetric("HostInitializeDiagnostics")):this.pageLoadPerfRecorder.getMetric("HostInitializeDiagnostics");break;case"PowerPoint":n=this.getPowerPointHostDiagnostics()}return n}recordAppLoadMetric(e,t){if(e)try{const n=e.metric.toString(),a=e.time,i=e.monitor?e.monitor.toString():"",o=this.getClickTimeIfExists(),s=this.getFrameFetchStartIfExists(),l=this.getFrameNavigationStartIfExists(),c=this.getDocPageNavigationStartIfExists();let d=0,g=0,h=0,_=0;const S=[{name:"metric",string:n},{name:"monitor",string:i},{name:"error",string:e.error?e.error.toString():""},{name:"clickTime",double:o},{name:"timeOrigin",double:t},{name:"time",double:a},{name:"frameFetchStart",double:s},{name:"frameNavigationStart",double:l},{name:"DocPageNavigationStart",double:c}],f=this.getSessionStartInfo(),C=f.Application;if(T.AFrameworkApplication.isTTVRForOneNoteEnabled()&&"OneNote"===C&&("visually-ready"===e.metric?this.pageLoadPerfRecorder.addMetric(p.a.appTTVR,a):"visually-ready-header"===e.metric?this.pageLoadPerfRecorder.addMetric(p.a.headerTTVR,a):"visually-ready-ribbon"===e.metric?this.pageLoadPerfRecorder.addMetric(p.a.ribbonTTVR,a):"visually-ready-canvas"===e.metric?this.pageLoadPerfRecorder.addMetric(p.a.canvasTTVR,a):"visually-ready-navigationPane"===e.metric&&this.pageLoadPerfRecorder.addMetric(p.a.navigationPaneTTVR,a)),e.measures){const t=e.measures;for(const e in t){const n={key:e,value:t[e]};Array.add(S,{name:n.key,double:n.value?n.value:0})}}if("stable-interactivity"===n){const t=this.pageLoadPerfRecorder.containsMetric(p.a.contentViewable)?this.pageLoadPerfRecorder.getMetric(p.a.contentViewable):0,n=this.pageLoadPerfRecorder.containsMetric(p.a.contentEditable)?this.pageLoadPerfRecorder.getMetric(p.a.contentEditable):0;if(Array.add(S,{name:p.a.contentViewable,double:t}),Array.add(S,{name:p.a.contentEditable,double:n}),(0,w.a)()){if(e.measures){const t=e.measures;for(const e in t){const n={key:e,value:t[e]};switch(n.key){case"visually-ready":d=n.value;break;case"longTasksCount":g=n.value;break;case"longTasksDuration":h=n.value;break;case"longestTaskDuration":_=n.value}}}let a=0,i=0,r=0,u=0;switch(C){case"Excel":a=JSON.parse(this.getHostDiagnosticsDataByApp(C)).HostInitializeDiagnostics.hostPageNavigationStartTime||0,i=l||0;break;case"Word":{const e=JSON.stringify(this.getHostDiagnosticsDataByApp(C));a=JSON.parse(e).hostPageNavigationStartTime||0;i=this.pageLoadPerfRecorder.getMetric(p.a.bootDiagnostics).officeFrameRequestStartTime||0;break}case"PowerPoint":a=c||0,i=l||0}if(0===l)this.recordPasMetric("visually-ready.E2E",0),this.recordPasMetric("E2E TTVR",0),this.recordPasMetric("TTFB",0),this.recordPasMetric("appTimeForContentDisplayed",0);else{r=Math.max(Math.round(l-a),0);const e=this.pageLoadPerfRecorder.containsMetric(p.a.frameResponseStart)?this.pageLoadPerfRecorder.getMetric(p.a.frameResponseStart):0;this.recordPasMetric("E2E TTVR",Math.round(r+d)),this.recordPasMetric("visually-ready.E2E",Math.round(r+d)),this.recordPasMetric("TTFB",0===e?0:Math.max(Math.round(e-l),0)),this.recordPasMetric("appTimeForContentDisplayed",0===t?0:Math.max(Math.round(t-l),0))}if(0===o?0!==a&&0!==i&&(u=Math.max(Math.round(i-a),0)):u=0===i?0:Math.max(Math.round(i-o),0),this.recordPasMetric("hostTime",u),0===a?(this.recordPasMetric("clickToFrameFetchStart",0),this.recordPasMetric("clickToFrameNavigationStart",0),this.recordPasMetric("clickToDocPageNavigationStart",0),this.recordPasMetric("EUPL",0),this.recordPasMetric("clickToContentInteractive",0)):(this.recordPasMetric("clickToFrameFetchStart",0===s?0:Math.max(Math.round(s-a),0)),this.recordPasMetric("clickToFrameNavigationStart",r),this.recordPasMetric("clickToDocPageNavigationStart",0===c?0:Math.max(Math.round(c-a),0)),this.recordPasMetric("EUPL",0===t?0:Math.max(Math.round(t-a),0)),this.recordPasMetric("clickToContentInteractive",0===n?0:Math.max(Math.round(n-a),0))),this.recordPasMetric("longTasksCount",g),this.recordPasMetric("longTasksDuration",h),this.recordPasMetric("longestTaskDuration",_),T.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8251235_addSessionDetailsToPASRunsIsEnabled")){const e={};e.hostName=f.Host||"",e.uiHost=f.UiHost||"",e.uiHostIntegrationType=f.UiHostIntegrationType||"",e.sessionOrigin=f.SessionOrigin||"",e.ring=f.Ring||"",e.WACDatacenter=f.WACDatacenter||"",e.appVersion=f.ApplicationVersion||T.AFrameworkApplication.buildVersion,e.sessionId=f.WACSessionID||"",e.flightId=T.AFrameworkApplication.appSettingsManager.appSettings.FlightId||"",this.recordPasMetric("pageTimingsMetadata",e),this.recordPasMetric("bootStrapper",f.Bootstrapper||"")}}}e.componentsData&&Array.add(S,{name:"componentsDataJson",string:m.c(e.componentsData)}),e.nonReportingComponentData&&Array.add(S,{name:"nonReportingComponentDataJson",string:m.c(e.nonReportingComponentData)}),T.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RumShepherdHostDiagnosticLoggingIsEnabled",!1)&&Array.add(S,{name:"hostDiagnosticsData",string:this.getHostDiagnosticsDataByApp()});const y=T.AFrameworkApplication.flightId?T.AFrameworkApplication.flightId.split(";"):new Array(0);Array.add(S,{name:"Flights",string:m.c(y)}),Array.add(S,{name:"ProtectedFile",string:T.AFrameworkApplication.protectedFile}),Array.add(S,{name:"HostTopology",string:v.d(T.AFrameworkApplication.dataPlumber)});const A=T.AFrameworkApplication.appSettingsManager.getStringAppSetting("StaticLoadPrefetchEnabled");void 0!==A&&Array.add(S,{name:"StaticLoadPrefetch",string:A}),T.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("IsBootedFromSWCacheFlagLoggingCG")&&!0===f.isBootedFromSWCache&&Array.add(S,{name:"IsBootedFromSWCache",string:"true"}),f.IsDotNetBoot&&Array.add(S,{name:"IsDotNetBoot",string:f.IsDotNetBoot.toString()});const b=n.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(""),F=E+b;r.ULS.sendTraceTag(545837846,306,50,"Logging activity: {0} with data: {1}",F,m.c(e));const I=!e.error||"si-error"==e.error;if(u.a(F,a,1,I,0,[...S],!0),b.startsWith("VisuallyReady")&&"rAF"!=i&&o>0&&a>0&&l>0&&t>0){const e=l-o;if(e<6e4){const t="AppLoadE2EMetric"+b,n=a+e;u.a(t,n,1,I,0,[...S],!0)}}}catch(e){r.ULS.sendTraceTag(577843343,306,15,"RecordAppLoadMetric error: "+e.toString())}}recordPasMetric(e,t){const n=n=>{window._pageTimings?window._pageTimings[e]=t:T.AFrameworkApplication.get_hostPostmessengerFuture().execute((n=>{n.sendMessage("WacAppPerfMetric",{name:e,time:t})}))};_.a.requestIdleCallbackExists()?window.requestIdleCallback(n):n(new IdleDeadline)}addAppLoadTraceEventListener(){c.a.addEventListener(window,"Wac-AppLoadTrace",this.flushAppLoadTrace),r.ULS.sendTraceTag(545837847,306,50,"Listener added for event type Wac-AppLoadTrace")}addStableInteractiveEventListener(){c.a.addEventListener(window,"WacStableInteractive",this.recordPerfObserverMetricsInKpi),T.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9104993_BytesToTTSIInPASEnabled")&&(0,w.a)()&&(window.addEventListener("WacStableInteractive",this.reportBytesToStableInteractiveToPAS),window.addEventListener("StableInteractivityDetected",this.reportBytesToStableInteractiveToPAS))}addQuietWindowEventListener(){c.a.addEventListener(window,"onQuietWindowReached",this.reportQuietWindow)}sendBeaconForBootPhase(e){"undefined"!=typeof _bB&&"function"==typeof _bB.sendBeacon&&_bB.sendBeacon(e,"BootPhaseCompleted")}postBootState(e){try{let t=!1;t="undefined"!=typeof _bB&&"function"==typeof _bB.postBootState,t&&_bB.postBootState(e)}catch(e){0}}getWindowVisibilityMetricsModule(){return window.self.WindowVisibilityMetrics}getVisibilityToggledTime(e){if("hidden"===e.initialVisibility)return e.initializeTime;const t=e.events;if(t&&t.length>0){return t[0].time}return null}isPerfMarked(e){return this.getPerfEntriesByName(e).length>0}getLastPerfEntryByName(e){const t=this.getPerfEntriesByName(e),n=t.length>0?t[t.length-1].startTime.toString():"";return window.performance.clearMarks(e),n}reportNavTelemetryInKpi(e){if(k.browserSupportsPerformanceGetEntriesByName){const t=new Map;for(const n of e)t.set(n,this.getLastPerfEntryByName(n));d.Health.instance.recordKpiUsage(p.a.navPerf,C.b.FailureBased,"",t)}}reportQuietWindow(){(0,i.h)(o.a).execute((e=>{try{e.flush();const t=e.getAggregatedMetricsForQWT();if(0===Object.keys(t).length)return;const n=T.AFrameworkApplication.quietWindowTrackedFiles;for(const e of Object.keys(t))n.has(e)&&(k.lastResponseEnd=Math.max(k.lastResponseEnd,t[e]),n.delete(e));if(k.qwtWaitTimeTimeOut||(k.qwtWaitTimeTimeOut=window.setTimeout((()=>k.qwtWaitTimeExceeded=!0),6e4)),!k.qwtWaitTimeExceeded&&n.size>0)return void window.setTimeout((()=>this.reportQuietWindow()),1e3);window.clearTimeout(k.qwtWaitTimeTimeOut),k.qwtWaitTimeTimeOut=null;const a=e.getAggregatedNetworkMetrics(k.lastResponseEnd,!0);a.TTQW=k.lastResponseEnd,(0,w.a)()&&this.recordPasMetric("bytesToQWT",a),u.a("AggregatedNetworkDataOnQuietWindow",a.decodedBytes,1,void 0,void 0,Object.keys(a).map((e=>({name:e,["fileNames"===e?"string":"TTQW"===e?"double":"int64"]:a[e]}))),!1)}catch(e){r.ULS.sendExceptionTraceTag(506806924,306,15,e,"Failed to report quiet window.")}}))}reportAggregatedNetworkData(e,t,n="",a="",s=E+"AggregatedNetwork"){(0,i.h)(o.a).execute((i=>{try{i.flush();const o=[{name:"metric",string:e},{name:"time",double:t}],r=i.getAggregatedNetworkMetrics(t);for(const e in r){const t={key:e,value:r[e]};Array.add(o,{name:t.key,int64:t.value})}""!==n&&""!==a&&(Array.add(o,{name:"component",string:n}),Array.add(o,{name:"subComponent",string:a})),u.a(s,r.transferredBytes,1,void 0,void 0,o,!1)}catch(e){r.ULS.sendExceptionTraceTag(509670338,306,15,e,"Failed to report aggregated network data")}}))}static get instance(){return k._instance||(k._instance=new k(g.a.instance,A.a.instance))}static get browserSupportsPerformanceMarkAndMeasure(){return A.a.browserSupportsPerformanceMarkAndMeasure}static get browserSupportsPerformanceTiming(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.timing||null===window.performance.timing)}static get browserSupportsPerformanceGetEntriesByType(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.getEntriesByType||null===window.performance.getEntriesByType)}static get browserSupportsPerformanceGetEntriesByName(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)}static logBootFinished(e,t=null){const n={};n.UserSessionId=e;try{if(!t){if(!T.AFrameworkApplication.appSettingsManager.appSettings.SessionStartInfoJson)return void r.ULS.sendTraceTag(36718624,306,10,"PerfReporting.LogBootFinished: SessionStartInfoJson is null");t=m.b(T.AFrameworkApplication.appSettingsManager.appSettings.SessionStartInfoJson.toString())}n.Application=t.Application||"",n.ApplicationModeExtended=t.ApplicationModeExtended||"",n.UserSessionApplicationMode=t.UserSessionApplicationMode||"",n.ApplicationVersion=t.ApplicationVersion||"",n.Browser=t.Browser||"",n.BrowserMajorVersion=t.BrowserMajorVersion||"",n.Host=t.Host||"",n.IsSynthetic=t.IsSynthetic||"",n.Ring=t.Ring||"",n.WACDatacenter=t.WACDatacenter||"",n.UiHost=t.UiHost||"",n.UiHostIntegrationType=t.UiHostIntegrationType||"",t.EmbedModes&&(n.EmbedModes=t.EmbedModes);const e=n.Application,a=n.ApplicationModeExtended?n.ApplicationModeExtended.toUpperCase():"";if("Excel"===e&&"UNIFIED"===a&&(r.ULS.sendTraceTag(39933443,306,15,"PerfReporting.LogBootFinished: SessionStarts[ApplicationModeExtended] remained UNIFIED"),T.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelFixupApplicationModeOnBootFinishedAndSessionEnd")))switch(T.AFrameworkApplication.activeFrame.mode){case 2:n.ApplicationModeExtended="EDIT";break;case 1:n.ApplicationModeExtended="VIEW";break;default:r.ULS.sendTraceTag(34219405,306,15,"PerfReporting.LogBootFinished: ActiveFrame.Mode is FrameMode.None")}}catch(e){const t={Context:"Deserializing SessionStartInfoJson for BootFinished logging"};t.ExceptionMessage=e.message,r.ULS.sendTraceTag(22552780,306,15,"{0}",t)}r.ULS.sendTraceTag(6959176,306,20,"SessionBootFinished: {0}",n),r.ULS.host.flushAsynchronous()}static reportPerfMetricsInKpi(e,t){const n=new Map;for(const e in t){const a={key:e,value:t[e]};try{n.set(a.key,a.value.toString())}catch(e){n.set(a.key,"")}}n.set("ProtectedFile",T.AFrameworkApplication.protectedFile.toString()),n.set("HostTopology",v.d(T.AFrameworkApplication.dataPlumber)),d.Health.instance.recordKpiUsage(e,C.b.FailureBased,"wacberf",n)}constructor(e,t=null){this._timestampBaseline=Number.MAX_VALUE,this._timestamps={},this._datapoints={},this._wsaClient=null,this._isAppInteractive=!1,this._appIsInteractiveTask=new s.a,this.isContentDisplayTimeAlreadySet=!1,this.hasQueuedStopVisibilityMetrics=!1,this.userSessionId=null,this._isRealContentDisplayedForBoot=!1,this._bytesToTTSIHasBeenLogged=!1,this._perfReportingConstantsInstance=null,this.recordAppLoadStateInActivity=e=>{r.ULS.sendTraceTag(545837841,306,50,"Handler running for event type Wac-AppLoadStateReport");const t=e.detail,n=t.time,a=[{name:"time",double:n},{name:"areAllMetricsReported",string:t.allMetricsReported.toString()}];t.metrics&&Array.add(a,{name:"metrics",string:m.c(t.metrics)}),t.components&&Array.add(a,{name:"components",string:m.c(t.components)}),Array.add(a,{name:"clickTime",double:this.getClickTimeIfExists()}),Array.add(a,{name:"frameFetchStart",double:this.getFrameFetchStartIfExists()}),Array.add(a,{name:"frameNavigationStart",double:this.getFrameNavigationStartIfExists()}),Array.add(a,{name:"DocPageNavigationStart",double:this.getDocPageNavigationStartIfExists()}),Array.add(a,{name:"ProtectedFile",string:T.AFrameworkApplication.protectedFile}),Array.add(a,{name:"HostTopology",string:v.d(T.AFrameworkApplication.dataPlumber)});const i=M;r.ULS.sendTraceTag(545837842,306,50,"Logging activity: {0} with data: {1}",M,m.c(t));const o=t.allMetricsReported;u.a(i,n,1,o,0,a,!0)},this.recordAppLoadMetricReportInActivity=e=>{T.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubComponentTTVRIsEnabled",!1)&&h.instance.reportTTVR(),r.ULS.sendTraceTag(545837845,306,50,"Handler running for event type Wac-AppLoadMetricReport");const t=e.detail,n=t.timeOrigin;if(this.recordAppLoadMetric(t,n),"visually-ready"===t.metric){let e="",n="";if(T.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",!1)){for(const n in t.measures)if(t.measures[n]===t.time){e=n;break}let a=0;const i=t.componentsData.find((t=>t.id===e));i&&i.subComponents?.forEach((e=>{e.states&&e.states["visually-ready"]>a&&(n=e.id,a=e.states["visually-ready"])}))}this.reportAggregatedNetworkData("visually-ready",t.time,e,n),l.a.get_instance().setAppInitializationStatus(20)}try{if(t.auxMetrics){const e=t.auxMetrics;for(let t=0;t<e.length;t++)this.recordAppLoadMetric(e[t],n)}}catch(e){r.ULS.sendTraceTag(587560797,306,15,"RecordAppLoadMetricReportInActivity error: "+e.toString())}},this.flushAppLoadTrace=e=>{r.ULS.sendTraceTag(545837849,306,50,"Handler running for event type Wac-AppLoadTrace");const t=e.detail;try{if(!t.traces)return;const e=t.traces;for(let t=0;t<e.length;t++){const n=e[t],a=n.message.toString();n.level;r.ULS.sendTraceTag(571790407,306,50,a)}}catch(e){r.ULS.sendTraceTag(571790408,306,15,"FlushAppLoadTrace error: "+e.toString())}},this.reportBytesToStableInteractiveToPAS=e=>{this._bytesToTTSIHasBeenLogged||(0,i.h)(o.a).execute((t=>{try{t.flush();const n=t.getAggregatedNetworkMetrics(e.timeStamp);this.recordPasMetric("bytesToTTSI",n),this._bytesToTTSIHasBeenLogged=!0}catch(e){r.ULS.sendExceptionTraceTag(506819416,306,15,e,"Failed to report aggregated network data to PAS")}}))},this.recordPerfObserverMetricsInKpi=e=>{if(!T.AFrameworkApplication.appSettingsManager||!T.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacPerfObserverEntriesIsEnabled"))return;const t=window.wacPerfObserver;if(S.a.isNullOrEmpty(t))return void r.ULS.sendTraceTag(592734347,306,15,"wacPerfObserver entries is null or empty");k.reportPerfMetricsInKpi("PerfObserver",t);const n=this.bootKpiMetrics;for(const e in n){const t={key:e,value:n[e]};k.reportPerfMetricsInKpi(t.key,t.value)}},this._perfReportingConstantsInstance=t||new A.a(e),this.reportQuietWindow=this.reportQuietWindow.bind(this)}}k.qwtWaitTimeExceeded=!1,k.lastResponseEnd=0,k.DATAID_BSQM_TIMESTAMPBASELINEHIGH=11040,k.DATAID_BSQM_TIMESTAMPBASELINELOW=11041,k.DATAID_BSQM_RESOURCEDOWNLOADSTART=11031,k.DATAID_BSQM_RESOURCEDOWNLOADEND=11032,k.DATAID_BSQM_CONTENTFETCHSTART=11033,k.DATAID_BSQM_CONTENTFETCHEND=11034,k.DATAID_BSQM_APPINITCODESTART=11036,k.DATAID_BSQM_APPINITCODEEND=11037,k.DATAID_BSQM_SPLASHSCREENSHOWN=11035,k.DATAID_BSQM_CONTENTDISPLAYED=11038,k.DATAID_BSQM_INTERACTIVITYCONTENTDISPLAYED=11337,k.DATAID_BSQM_APPINTERACTIVE=11039,k.DATAID_BSQM_USERCLICKEDHOSTUI=11028,k.DATAID_BSQM_HOSTIFRAMEGENERATED=11042,k.DATAID_BSQM_EDITINWEBAPPCLICKED=11029,k.DATAID_BSQM_VIEWINWEBAPPCLICKED=11043,k.DATAID_BSQM_BROWSERFETCHSTART=11044,k.DATAID_BSQM_HOSTPAGEFETCHSTART=11221,k.DATAID_BSQM_HOSTPAGEREDIRECTCOUNT=11219,k.DATAID_BSQM_CONTENTTOMODELCONVERSIONEND=11220,k.DATAID_BSQM_WACRENDERTIME=9086,k.DATAID_BSQM_BROWSERNAVIGATIONSTART=11338,k._instance=null,(0,a.a)(k,"PerfReporting",null,[])},682:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(4168),o=n(6949),r=n(5721),s=n(9454),l=n(2274);class c{static get instance(){return c._instance||(c._instance=new c(s.a.instance))}get pageLoadPerfRecorder(){return this._pageLoadPerfRecorder}set pageLoadPerfRecorder(e){this._pageLoadPerfRecorder=e}get bootKpiMetrics(){return this._bootKpiMetrics}set bootKpiMetrics(e){this._bootKpiMetrics=e}recordDocumentLoadedTime(e){this.pageLoadPerfRecorder.addMetric(r.a.documentLoadedTime,e),this.dispatchAppMetricReportedEvent(r.a.documentLoadedTime,e)}dispatchAppMetricReportedEvent(e,t){if(!o.a.browserSupportsCustomEvent())return;const n={metric:e,value:t};i.a.dispatch("WacAppMetricReported",n)}addMark(e){c.browserSupportsPerformanceMarkAndMeasure&&window.performance.mark(e)}static get browserSupportsPerformanceMarkAndMeasure(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.mark||null===window.performance.mark||void 0===window.performance.measure||null===window.performance.measure)}addReportKpiMetricsEventListener(){i.a.addEventListener(window,"WacBootKpiMetricsReported",(e=>{if(!l.AFrameworkApplication_AppSettingsManager.appSettingsManager||!l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("WacPerfObserverEntriesIsEnabled")||!e.detail)return;const t=e.detail.metrics,n=e.detail.kpiName;if(n){n in this._bootKpiMetrics||(this._bootKpiMetrics[n]={});const e=this._bootKpiMetrics[n];for(const n in t){const a={key:n,value:t[n]};e[a.key]=a.value}}}))}constructor(e){this._bootKpiMetrics={},this._pageLoadPerfRecorder=e,this.addReportKpiMetricsEventListener()}}c._instance=null,(0,a.a)(c,"PerfReportingConstants",null,[])},9442:function(e,t,n){"use strict";n.r(t),n.d(t,{PrivacyDialogManager:function(){return P}});var a=n(100),i=n(3792),o=n(7096),r=n(1682),s=n(5149),l=n(7162),c=n(7531),d=n(3563),u=(n(7442),n(9675));class p{static get commercialTrustCenterDialogHtmlTemplate(){return p.dialogHtmlFormat}}p.dialogHtmlFormat="<div class='TrustCenterDialogOuterContainer' id='PrivacySettingsContainer'> <div class='UIFontDialogTitle PrivacyDialogTitle' id='PrivacyDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='\"\"' id='PrivacyDialogSubTitleContainer'> <label id='PrivacyDialogSubTitle' class='WACDialogLabel' >{1}</label> </div> <br/> <div class='TrustCenterDialogInfoContainer' id='InfoContainer'> <div class='\"\"' id='InfoMessageBlock'> <div class='WACDialogIcon' id='TopInfoIconArea'> <div class='clip24x24' id='TopInfoIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='TopIconInfo' title='{4}' class='{3}' role='img' src={2} /> </div> </div> <div class='TrustCenterDialogInfoText' id='InfoMessageArea'> <label id='MessageInfo' class='\"\"' >{5}</label> </div> </div> </div> <br/> <div class='TrustCenterDialogExperiencesContainer' id='{6}'> <div class='UIFontDialogTextLarge PrivacyDialogTitle' id='OptionalExperiencesTitleArea'> <label id='OptionalExperiencesTitle' class='WACDialogLabel' >{7}</label> </div> <div class='WACDialogRow' id='OptionalExperiencesSubTitleArea'> <label id='OptionalExperiencesSubTitle' class='WACDialogLabel' >{8}</label> </div> <div class='WACDialogRow' id='LearnMoreLinkRow'> <a id='LearnMoreLinkId' class='LearnMoreLink' href={10} target='_blank' >{9}</a> </div> <div class='WACDialogCheckBoxDiv' id='EnableExperiencesCheckBox'> <input type='checkbox' id='{11}' class='WACDialogCheckBox' title='{12}'></input> <label id='\"\"' class='WACDialogLabel' for='{11}' >{12}</label> </div> <br/> <div class='{13}' id='CheckboxInfoContainer'> <div class='\"\"' id='CheckboxInfoMessage'> <div class='WACDialogIcon' id='BottomInfoIconArea'> <div class='clip24x24' id='BottomInfoIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='BottomIconInfo' title='{4}' class='{3}' role='img' src={2} /> </div> </div> <div class='TrustCenterDialogInfoText' id='ExperiencesInfoRow'> <label id='ExperiencesInfo' class='\"\"' >{14}</label> </div> </div> <a id='PrivacyStatementLinkId' class='PrivacyStatementLink' href={16} target='_blank' >{15}</a> </div> <br/> </div>",(0,a.a)(p,"CommercialTrustCenterDialogHtml",null,[]);var g=n(8103),h=n(5374);const m="EnableConnectedExperiencesCheckbox",_="ConnectedExperiencesID",S="TrustCenterDialogInfoContainer",f="TrustCenterExperiencesDisabledDialogInfoContainer",C="https://go.microsoft.com/fwlink/?linkid=2090814",y="https://go.microsoft.com/fwlink/?linkid=2090462";class A{initializeAndShowDialog(e,t,a){const{PrivacyDialogManager:i}=n(9442);i.recordSessionPrivacyActivity(2097152),this._callback=a,this._userPrivacySettings=t;{const t=new d.CustomDialog(!1,!1,A.useReactDialog);this.setupCustomDialog(t,e)}}setupCustomDialog(e,t){const{AFrameworkApplication:a}=n(3245);if(e.dialogId="CommercialTrustCenterDialog",e.buttonsOption=1,A.useReactDialog){const n={id:e.dialogId,bodyControls:{optionalConnectedExperiencesCheckboxProps:{label:(0,g.a)("PrivacySettingsDialogCheckboxText")},learnMoreLinkProps:{text:(0,g.a)("PrivacyDialogLearnMore"),handler:{href:C,target:"_blank"}},privacyStatementLinkProps:{text:(0,g.a)("PrivacySettingsDialogMicrosoftPrivacyStatement"),handler:{href:y,target:"_blank"}}},title:(0,g.a)("PrivacySettingsDialogHeader"),subTitle:(0,g.a)("PrivacySettingsDialogSubHeader"),infoMessage:t?(0,g.a)("PrivacySettingsDialogMessage"):(0,g.a)("PrivacySettingsDialogAdminDisabled"),optionalExperiencesEnabled:t,optionalExperiencesTitle:(0,g.a)("PrivacySettingsDialogExperiencesTitle"),optionalExperiencesSubTitle:(0,g.a)("PrivacySettingsDialogExperiencesMessage"),optionalExperiencesInfoMessage:(0,g.a)("PrivacySettingsDialogWarning"),optionalExperiencesCheckboxInitialValue:2!==this._userPrivacySettings.controllerServicesStateRoaming,onOptionalExperiencesCheckboxChanged:this.recordSessionPrivacyActivityOnStateChange};e.initializeAndShow((0,g.a)("PrivacySettingsDialogTitle"),this.reactDialogHandler,n)}else{const n=2!==this._userPrivacySettings.controllerServicesStateRoaming?S:f;e.dialogHtml=u.a.formatHtml(p.commercialTrustCenterDialogHtmlTemplate,(0,g.a)("PrivacySettingsDialogHeader"),(0,g.a)("PrivacySettingsDialogSubHeader"),a.imageClusterPath,(0,h.c)(A.iconName),(0,g.a)("DialogInfo"),t?(0,g.a)("PrivacySettingsDialogMessage"):(0,g.a)("PrivacySettingsDialogAdminDisabled"),_,(0,g.a)("PrivacySettingsDialogExperiencesTitle"),(0,g.a)("PrivacySettingsDialogExperiencesMessage"),(0,g.a)("PrivacyDialogLearnMore"),C,m,(0,g.a)("PrivacySettingsDialogCheckboxText"),n,(0,g.a)("PrivacySettingsDialogWarning"),(0,g.a)("PrivacySettingsDialogMicrosoftPrivacyStatement"),y);const i={};if(i[m]=2!==this._userPrivacySettings.controllerServicesStateRoaming,t?e.initializeAndShow((0,g.a)("PrivacySettingsDialogTitle"),this.dialogHandler_PrivacySettingsAdminEnabled,i):e.initializeAndShow((0,g.a)("PrivacySettingsDialogTitle"),this.dialogHandler_PrivacySettingsAdminDisabled,i),this.setUpCheckbox(),!t){document.getElementById(_).style.display="none"}}}setUpCheckbox(){this.enableConnectedExperiencesCheckbox=document.getElementById(m),c.a.addHandler(this.enableConnectedExperiencesCheckbox,"click",this.onConnectedExperiencesCheckChanged)}static get useReactDialog(){const{AFrameworkApplication:e}=n(3245);return e.activeFrame.applicationInstance.isReactDialogEnabled&&e.activeFrame.applicationInstance.isReactCommercialTrustCenterDialogEnabled}constructor(){this.enableConnectedExperiencesCheckbox=null,this._userPrivacySettings=null,this._callback=null,this.onConnectedExperiencesCheckChanged=e=>{const t=document.getElementById("CheckboxInfoContainer");this.enableConnectedExperiencesCheckbox&&t&&(this.recordSessionPrivacyActivityOnStateChange(this.enableConnectedExperiencesCheckbox.checked),t.className=this.enableConnectedExperiencesCheckbox.checked?S:f)},this.dialogHandler_PrivacySettingsAdminEnabled=(e,t)=>{const{PrivacyDialogManager:a}=n(9442);if(a.recordSessionPrivacyActivity(4194304),1===e&&t){this._userPrivacySettings.controllerServicesStateRoaming=t[m]?1:2;const e=new Date;this._userPrivacySettings.controllerServicesTimeRoaming=e.toISOString(),this._callback(this._userPrivacySettings)}},this.dialogHandler_PrivacySettingsAdminDisabled=(e,t)=>{const{PrivacyDialogManager:a}=n(9442);a.recordSessionPrivacyActivity(4194304)},this.reactDialogHandler=(e,t)=>{const{PrivacyDialogManager:a}=n(9442);if(a.recordSessionPrivacyActivity(4194304),1===e&&t&&t.optionalExperiencesEnabled){this._userPrivacySettings.controllerServicesStateRoaming=t.optionalExperiencesCheckboxChecked?1:2;const e=new Date;this._userPrivacySettings.controllerServicesTimeRoaming=e.toISOString(),this._callback(this._userPrivacySettings)}},this.recordSessionPrivacyActivityOnStateChange=e=>{const{PrivacyDialogManager:t}=n(9442);e?t.recordSessionPrivacyActivity(67108864):t.recordSessionPrivacyActivity(134217728)}}}A.iconName="Info_24x24x32",(0,a.a)(A,"CommercialTrustCenterDialog",null,[]);var b=n(1096),T=n(625),v=n(3696),w=n(6776);const F="https://go.microsoft.com/fwlink/?linkid=2100681";class I{initializeAndShowDialog(e){const{PrivacyDialogManager:t}=n(9442);e?t.recordSessionPrivacyActivity(268435456):t.recordSessionPrivacyActivity(536870912);{const t=new v.StandardDialog;this.setupStandardDialog(t,e)}}setupStandardDialog(e,t){const n=w.AFrameworkApplicationConstants.activeFrame.applicationInstance.isReactDialogEnabled&&w.AFrameworkApplicationConstants.activeFrame.applicationInstance.isReactRefreshDialogEnabled;e.buttonsOption=4,e.setButtonText(1,(0,g.a)("RefreshRequiredDialogRefreshButton")),e.setButtonText(2,(0,g.a)("RefreshRequiredDialogNotNowButton")),e.dialogId="RefreshRequiredDialog";const a=document.createElement("span");a.id="RefreshRequiredDialogContent";const i=document.createElement("span");if(i.innerText=(0,g.a)("RefreshRequiredDialogText"),a.appendChild(i),a.appendChild(document.createElement("br")),a.appendChild(document.createElement("br")),t){const e=document.createElement("span");e.innerText=(0,g.a)("RefreshRequiredDialogAnonymousText"),a.appendChild(e),a.appendChild(document.createElement("br")),a.appendChild(document.createElement("br"))}const o=document.createElement("a");if(o.href=F,o.innerText=(0,g.a)("RefreshRequiredDialogLinkText"),o.target="_blank",a.appendChild(o),n){const n=[],a=[];Array.add(n,(0,g.a)("RefreshRequiredDialogText")),t&&Array.add(n,(0,g.a)("RefreshRequiredDialogAnonymousText")),Array.add(n,"{0}"),Array.add(a,{type:"AppLinkProps",id:"RefreshRequiredAnchorElement",text:(0,g.a)("RefreshRequiredDialogLinkText"),handler:{href:F,target:"_blank"}}),e.addAdditionalTextBodyContent(n,a)}e.messageBox((0,g.a)("RefreshRequiredDialogTitle"),null,0,(0,T.a)(this,this.dialogHandler,"dialogHandler"),n?null:a)}dialogHandler(e,t){const{PrivacyDialogManager:a}=n(9442);a.recordSessionPrivacyActivity(1073741824),1===e&&w.AFrameworkApplicationConstants.activeFrame.applicationInstance.privacyRefreshRequested()}}(0,a.a)(I,"RefreshRequiredDialog",null,[]);var E=n(2409);const M="PrivNote",k="1";class P{static get useReactCommercialPrivacyNoticeDialog(){const{AFrameworkApplication:e}=n(3245);return e.activeFrame.applicationInstance.isReactDialogEnabled&&e.activeFrame.applicationInstance.isReactCommercialPrivacyNoticeDialogEnabled}static showCommercialPrivacyNoticeDialog(e,t){let n=null;n=P.useReactCommercialPrivacyNoticeDialog?new b.ReactCommercialPrivacyNoticeDialog:new l.CommercialPrivacyNoticeDialog,P.setupICommercialPrivacyNoticeDialog(n,e,t)}static setupICommercialPrivacyNoticeDialog(e,t,n){e.initializeAndShowDialog((()=>{P.saveLocally(k),t.userPrivacySettingsRoamedNoticeShown=1,t.controllerServicesStateRoaming=1;const e=new Date;t.controllerServicesTimeRoaming=e.toISOString(),P.savePrivateNoticeShown(n,t)}))}static showPrivacyNoticeBusinessBar(e,t){const{AFrameworkApplication:a}=n(3245);P.recordSessionPrivacyActivity(128),a.activeFrame.applicationInstance.addGdprBusinessBarWithCloseCallback((0,g.a)("AnonymousBusBarPrivacyNotice"),(0,g.a)("PrivacyDialogLearnMore"),"2090814",(n=>{P.recordSessionPrivacyActivity(256),P.saveLocally(k),e.controllerServicesStateRoaming=1,P.savePrivateNoticeShown(t,e)}))}static showPrivacyNoticeRoamingBusinessBar(e,t){const{AFrameworkApplication:a}=n(3245);P.recordSessionPrivacyActivity(32),a.activeFrame.applicationInstance.addGdprBusinessBarWithCloseCallback((0,g.a)("RoamedSettingsBusBarPrivacyNotice"),"","",(e=>{P.recordSessionPrivacyActivity(64)})),P.saveLocally(k),e.userPrivacySettingsRoamedNoticeShown=1,P.savePrivateNoticeShown(t,e)}static savePrivateNoticeShown(e,t){e.saveSettings(t).then((e=>(e?P.recordSessionPrivacyActivity(512):P.recordSessionPrivacyActivity(1024),null)),(e=>(P.recordSessionPrivacyActivity(1024),null)))}static showCommercialTrustCenterDialog(){(0,i.h)(r.a).execute((e=>{e.getSettings().then((t=>{P.recordUserPrivacySettingsDataSourceForSession(t);const n=new A;return P.tryGetAdminControllerConnectedServicesState(!0).then((a=>(n.initializeAndShowDialog(a,t,(t=>{s.ULS.sendTraceTag(51258457,306,50,"PrivacyDialogManager.ShowCommercialTrustCenterDialog Callback, userPrivacySettingsModified = {0}",t),e.saveSettings(t).then((e=>{if(e){P.recordSessionPrivacyActivity(16777216);const e=0!==t.src;P.showRefreshRequiredDialog(e)}return null}),(e=>(P.recordSessionPrivacyActivity(33554432),s.ULS.sendTraceTag(50917390,306,10,"PrivacyDialogManager.ShowCommercialTrustCenterDialog: Error Saving Settings, error: {0}",e.toString()),null)))})),null))),null}))}))}static showRefreshRequiredDialog(e){(new I).initializeAndShowDialog(e)}static showPrivacyDialogIfNecessary(){P.showPrivacyDialog()}static showPrivacyDialog(){P.shouldShowPrivacyNotice().then((e=>new Promise((t=>{e?(P._seenThisSession=!0,(0,i.h)(r.a).execute((e=>{e.getSettings().then((n=>(P.recordUserPrivacySettingsDataSourceForSession(n),t(P.showFRENotice(n,e)),null)))}))):t(!1)}))),(e=>(s.ULS.sendTraceTag(541188375,306,10,"PrivacyDialogManager.ShowPrivacyDialogIfNecessary: Error during ShouldShowPrivacyNotice {0}",JSON.stringify(e)),P.recordSessionPrivacyActivity(32768),P.logPrivacyNoticeResult(),new Promise(((e,t)=>{e(!1)}))))).then((e=>(s.ULS.sendTraceTag(51258458,306,50,"PrivacyDialogManager.ShowPrivacyDialogIfNecessary: Notice shown = {0}",e.toString()),P.logPrivacyNoticeResult(),null)),(e=>(s.ULS.sendTraceTag(51258459,306,10,"PrivacyDialogManager.ShowPrivacyDialogIfNecessary: Error showing notice {0}",e.toString()),P.recordSessionPrivacyActivity(32768),P.logPrivacyNoticeResult(),null)))}static shouldShowPrivacyNotice(){const{AFrameworkApplication:e}=n(3245),t=-1!==window.location.href.indexOf("&wd_pn=1"),a=new Promise(((e,t)=>{e(!1)})),i=new Promise(((e,t)=>{e(!0)}));return t?(P.recordSessionPrivacyActivity(2),i):e.mightNeedPrivacyDialog?(P.recordSessionPrivacyActivity(1),e.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled")?P._seenThisSession?a:e.appSettingsManager.getBooleanAppSetting("IsAnonymousUser")&&!P.canWriteHasSeenNotice()?(P.recordSessionPrivacyActivity(4096),a):(e.privacyDialogAlreadySeen&&(P.recordSessionPrivacyActivity(16384),P.saveLocally(k)),P._seenLocally=P.hasSeenLocally(k),P._seenLocally&&P.recordSessionPrivacyActivity(8192),P._seenLocally||e.privacyDialogAlreadySeen?a:P.tryGetAdminControllerConnectedServicesState(!1)):(P.recordSessionPrivacyActivity(2048),a)):a}static logPrivacyNoticeResult(){const e=n(3245).AFrameworkApplication.dataPlumber.PrivacyNotice,t={};1&e&&(t.MightBeNeeded=1),2&e&&(t.Forced=1),4&e&&(t.CommercialUsersShown=1),8&e&&(t.CommercialUsersTrustCenterClicked=1),16&e&&(t.CommercialUsersDismissed=1),32&e&&(t.SettingsRoamedBusinessBarShown=1),64&e&&(t.SettingsRoamedBusinessBarDismissed=1),128&e&&(t.BusinessBarForAnonymousUsersShown=1),256&e&&(t.BusinessBarForAnonymousUsersDismissed=1),512&e&&(t.SaveNoticeShownSucceeded=1),1024&e&&(t.SaveNoticeShownFailed=1),2048&e&&(t.NotShown_OCPSDisabled=1),4096&e&&(t.NotShown_CantWriteCachedCookie=1),8192&e&&(t.NotShown_AlreadySeenFromCachedCookie=1),16384&e&&(t.NotShown_AlreadySeenFromHost=1),32768&e&&(t.PrivacyNoticeError=1),65536&e&&(t.OCPSCCSDisabled=1),131072&e&&(t.OCPSFailure=1),262144&e&&(t.UserSettingsSourceRoaming=1),524288&e&&(t.UserSettingsSourceCookie=1),1048576&e&&(t.UserSettingsSourceQUeryParam=1),s.ULS.sendTraceTag(37357660,306,50,"PrivacyDialogmanager.LogPrivacyNoticeResult: {0}",t)}static canWriteHasSeenNotice(){return P.saveLocally("-1"),P.hasSeenLocally("-1")}static hasSeenLocally(e){return E.a.get(M)===e}static saveLocally(e){const t=n(3245).AFrameworkApplication.appSettingsManager.getStringAppSetting("PrivacyCookieDomain")||"";E.a.setWithAllTheThings(M,e,E.a.maxComplianceAllowedRetentionInDays,"/",t)}static tryGetAdminControllerConnectedServicesState(e=!0){return new Promise(((t,n)=>{(0,i.h)(o.a).execute((a=>{a.getBooleanPolicySetting("ControllerConnectedServicesEnabled",e).then((e=>(t(e),e||P.recordSessionPrivacyActivity(65536),null)),(e=>(n(e),P.recordSessionPrivacyActivity(131072),null)))}))}))}static showFRENotice(e,t){const{AFrameworkApplication:a}=n(3245);if(null==e)return!1;if(0===e.src){if(1===e.userPrivacySettingsRoamedNoticeShown)return!1;if(0===e.controllerServicesStateRoaming)return P.showCommercialPrivacyNoticeDialog(e,t),!0;if(0===e.userPrivacySettingsRoamedNoticeShown)return P.showPrivacyNoticeRoamingBusinessBar(e,t),!0}else if(1===e.src&&0===e.controllerServicesStateRoaming&&a.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"))return P.showPrivacyNoticeBusinessBar(e,t),!0;return!1}static recordSessionPrivacyActivity(e){const{AFrameworkApplication:t}=n(3245);t.dataPlumber.PrivacyNotice|=e}static recordUserPrivacySettingsDataSourceForSession(e){switch(e.src){case 0:P.recordSessionPrivacyActivity(262144);break;case 1:P.recordSessionPrivacyActivity(524288);break;case 2:P.recordSessionPrivacyActivity(1048576)}}}P._seenThisSession=!1,P._seenLocally=!1,(0,a.a)(P,"PrivacyDialogManager",null,[])},7162:function(e,t,n){"use strict";n.r(t),n.d(t,{CommercialPrivacyNoticeDialog:function(){return p}});var a=n(100),i=(n(5149),n(7531)),o=n(3563),r=(n(7442),n(9675));class s{static get commercialPrivacyNoticeDialogHtmlTemplate(){return s.dialogHtmlFormat}}s.dialogHtmlFormat="<div class='PrivacyNoticeDialogContainer' id='PrivacyNoticeContainerId'> <div class='\"\"' id='{0}'> <svg xmlns='http://www.w3.org/2000/svg' class='MsDialogLogo' viewBox='0 0 99 21'><path class='HC c74' d='M34.94384 12.1124l-.59342 1.6608h-.03374a15.86223 15.86223 0 0 0-.56213-1.64266l-3.1758-7.96679h-3.1049V16.83h2.0478V9.0436c0-.48062-.01031-1.0614-.03057-1.72611-.01055-.33629-.04861-.60582-.058-.811h.045c.10406.4772.21219.84074.29036 1.084L33.57659 16.83h1.43266L38.789 7.507a8.2553 8.2553 0 0 0 .2602-1.00052h.04492c-.04934.9227-.09132 1.76588-.097 2.27472V16.83h2.18466V4.16375h-2.98185zM43.23858 7.75293h2.13529v9.07703h-2.13529zM44.32818 3.89545a1.28731 1.28731 0 0 0-.90968.35668 1.17694 1.17694 0 0 0-.38108.89053 1.14511 1.14511 0 0 0 .37691.87288 1.30076 1.30076 0 0 0 .91385.34783 1.31646 1.31646 0 0 0 .91793-.34758 1.13946 1.13946 0 0 0 .38181-.87313 1.19956 1.19956 0 0 0-.37138-.88073 1.27358 1.27358 0 0 0-.92836-.36648zM52.93294 7.66212a5.91561 5.91561 0 0 0-1.19319-.12789 5.26835 5.26835 0 0 0-2.59678.62421 4.20113 4.20113 0 0 0-1.7121 1.761 5.60038 5.60038 0 0 0-.58863 2.60829 4.81649 4.81649 0 0 0 .57156 2.33827 4.01747 4.01747 0 0 0 1.59784 1.61566 4.76026 4.76026 0 0 0 2.33414.56726 5.10923 5.10923 0 0 0 2.57564-.60285l.02823-.01646v-1.95585l-.08958.06553a4.01826 4.01826 0 0 1-1.04469.5437 3.16174 3.16174 0 0 1-1.02312.19835 2.62927 2.62927 0 0 1-1.99855-.7791 3.02828 3.02828 0 0 1-.73738-2.15814 3.14318 3.14318 0 0 1 .7683-2.2158 2.61573 2.61573 0 0 1 2.0025-.82649 3.42846 3.42846 0 0 1 2.03294.70694l.08958.06505V8.01264l-.02871-.01619a3.53811 3.53811 0 0 0-.988-.33433zM59.96821 7.59536a2.18731 2.18731 0 0 0-1.42788.512 2.88955 2.88955 0 0 0-.82155 1.21724h-.0226V7.75293h-2.135V16.83h2.135v-4.64348a3.23654 3.23654 0 0 1 .53217-1.92787 1.63252 1.63252 0 0 1 1.381-.72928 2.51241 2.51241 0 0 1 .64211.09425 1.6279 1.6279 0 0 1 .49781.20129l.08984.0648V7.73722l-.03461-.01472a2.21076 2.21076 0 0 0-.83629-.12714zM65.76756 7.53423a4.73981 4.73981 0 0 0-3.53323 1.30366 4.8866 4.8866 0 0 0-1.27666 3.55874 4.62871 4.62871 0 0 0 1.24622 3.397 4.52193 4.52193 0 0 0 3.34472 1.2553 4.61146 4.61146 0 0 0 3.4635-1.32158 4.87659 4.87659 0 0 0 1.27641-3.5234 4.75509 4.75509 0 0 0-1.19763-3.42251 4.41 4.41 0 0 0-3.32333-1.24721zm1.69763 6.98912a2.16529 2.16529 0 0 1-1.7941.758 2.292 2.292 0 0 1-1.83879-.77224 3.28324 3.28324 0 0 1-.66079-2.18268 3.41139 3.41139 0 0 1 .66079-2.2396 2.25617 2.25617 0 0 1 1.82135-.785 2.2219 2.2219 0 0 1 1.77349.75063 3.34221 3.34221 0 0 1 .64729 2.22145 3.56448 3.56448 0 0 1-.60924 2.24944zM75.02376 11.50364a4.64261 4.64261 0 0 1-1.28156-.66645.93192.93192 0 0 1-.25872-.69907.7783.7783 0 0 1 .32844-.64681 1.47116 1.47116 0 0 1 .91951-.2597A3.75721 3.75721 0 0 1 75.82669 9.4a3.5299 3.5299 0 0 1 .95633.44332l.08836.06015V7.92966l-.03438-.01473a4.71358 4.71358 0 0 0-.97056-.27048 5.95145 5.95145 0 0 0-1.06507-.11022 3.90841 3.90841 0 0 0-2.504.774 2.46926 2.46926 0 0 0-.97524 2.01379 2.80966 2.80966 0 0 0 .21036 1.12521 2.25421 2.25421 0 0 0 .64606.84416 5.62313 5.62313 0 0 0 1.31374.73491 9.79062 9.79062 0 0 1 1.09256.5091 1.51226 1.51226 0 0 1 .48085.395.88377.88377 0 0 1 .13427.5145c0 .61022-.45681.90649-1.39643.90649a3.84033 3.84033 0 0 1-1.18167-.216 4.45107 4.45107 0 0 1-1.21016-.61366l-.08958-.06455v2.0813l.03265.01521a5.36515 5.36515 0 0 0 1.14606.354 6.138 6.138 0 0 0 1.22365.14139 4.15062 4.15062 0 0 0 2.64391-.77812 2.51712 2.51712 0 0 0 .98431-2.06215 2.36906 2.36906 0 0 0-.52948-1.55943 4.53616 4.53616 0 0 0-1.79947-1.14574zM83.09416 7.53423a4.7402 4.7402 0 0 0-3.53323 1.30366 4.88764 4.88764 0 0 0-1.27666 3.55874 4.62784 4.62784 0 0 0 1.24647 3.397 4.52149 4.52149 0 0 0 3.34472 1.2553 4.61122 4.61122 0 0 0 3.46325-1.32158 4.87564 4.87564 0 0 0 1.27666-3.5234 4.75413 4.75413 0 0 0-1.19788-3.42251 4.41 4.41 0 0 0-3.32333-1.24721zm1.69789 6.98912a2.16569 2.16569 0 0 1-1.79411.758 2.29291 2.29291 0 0 1-1.839-.77224 3.28319 3.28319 0 0 1-.66054-2.18268 3.41139 3.41139 0 0 1 .66079-2.2396 2.25548 2.25548 0 0 1 1.82135-.785 2.22224 2.22224 0 0 1 1.77349.75063 3.34221 3.34221 0 0 1 .64729 2.22145 3.56611 3.56611 0 0 1-.60927 2.24944zM99 9.49425V7.75293h-2.16229V5.04546l-.07289.02234-2.031.62176-.04.01229v2.05108H91.49V6.6103a1.811 1.811 0 0 1 .354-1.21038 1.244 1.244 0 0 1 .99-.40526 2.307 2.307 0 0 1 .94012.21428l.07953.03534V3.41019l-.0373-.01327a3.65779 3.65779 0 0 0-1.201-.161 3.52356 3.52356 0 0 0-1.70329.40944 2.91321 2.91321 0 0 0-1.16926 1.15585 3.43992 3.43992 0 0 0-.41409 1.6952v1.25652H87.823v1.74132h1.50569V16.83H91.49V9.49425h3.2038v4.66187c0 1.91953.90551 2.8928 2.69152 2.8928a4.4019 4.4019 0 0 0 .9178-.10187 2.5365 2.5365 0 0 0 .66841-.21207L99 16.71877v-1.75826l-.08787.05866a1.5096 1.5096 0 0 1-.43472.18975 1.66121 1.66121 0 0 1-.42686.07242 1.15891 1.15891 0 0 1-.92023-.33506 1.8056 1.8056 0 0 1-.29261-1.16669V9.49425z'/><path fill='#f05226' d='M0-.06719h10.0444v10.0444H0z'/><path fill='#80bb42' d='M11.09009-.06719h10.04415V9.97698H11.09009z'/><path fill='#339fd9' d='M0 11.02682h10.04415v10.04417H0z'/><path fill='#fdb816' d='M11.09009 11.02682h10.04415v10.04417H11.09009z'/></svg> </div> <div class='PrivacyNoticeDialogInnerContainer' id='PrivacyNoticeInnerContainerId'> <div class='UIFontDialogTitle PrivacyDialogTitle' id='PrivacyDialogTitle'> <div class='WACDialogSectionTitle'>{1}</div> </div> <div class='WACDialogRow' id='ThanksBlock'> <div class='\"\"' id='ThanksTextRow'> <label id='ThanksText' class='WACDialogLabel' >{2}</label> </div> <div class='\"\"' id='AdminInfoRow'> <label id='AdminInfo' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRow' id='LearnMoreLinkRow'> <a id='LearnMoreLinkId' class='LearnMoreLink' href={5} target='_blank' >{4}</a> </div> </div> <div class='WACDialogRow' id='AdjustBlock'> <div class='\"\"' id='AdjustBlockText'> <label id='AdjustText' class='WACDialogLabel' >{6}</label> </div> <div class='\"\"' id='AdjustBlockLink'> <a id='{7}' class='AccountPrivacyLink' href=# target='_self' >{8}</a> </div> </div> <div class='WACDialogRow' id='ServicesAgreementBlock'> <div class='\"\"' id='ServicesAgreementText'> <label id='AgreementText' class='WACDialogLabel' >{9}</label> </div> <div class='\"\"' id='ServicesAgreementLink'> <a id='ServicesAgreementLinkId' class='ServicesAgreementLink' href={11} target='_blank' >{10}</a> </div> </div> </div> </div>",(0,a.a)(s,"CommercialPrivacyNoticeDialogHtml",null,[]);var l=n(6124),c=n(8103);const d="TrustCenterLinkId",u="MSDialogLogoId";class p{initializeAndShowDialog(e){const{PrivacyDialogManager:t}=n(9442);t.recordSessionPrivacyActivity(4),this._callback=e;this.dialog=new o.CustomDialog,this.setupCustomDialog(),this.setupCustomDialog()}setupCustomDialog(){this.dialog.dialogHtml=r.a.formatHtml(s.commercialPrivacyNoticeDialogHtmlTemplate,u,(0,c.a)("PrivacyNoticeDialogTitle"),(0,c.a)("PrivacyNoticeDialogMessageText"),(0,c.a)("PrivacyNoticeDialogMessageSubText"),(0,c.a)("PrivacyDialogLearnMore"),"https://go.microsoft.com/fwlink/?linkid=2090814",(0,c.a)("PrivacyNoticeDialogSettingsLocation"),d,(0,c.a)("PrivacyNoticeDialogSettingsLink"),(0,c.a)("PrivacyNoticeDialogServicesAgreementText"),(0,c.a)("PrivacyNoticeDialogServiesAgreementLink"),"https://go.microsoft.com/fwlink/?linkid=2093457"),this.dialog.dialogId="CommercialPrivacyNoticeDialog",this.dialog.buttonsOption=0,this.dialog.setButtonText(1,(0,c.a)("Close")),this.dialog.initializeAndShow("",this.dialogHandler,null);const e=document.getElementById(d);i.a.addHandler(e,"click",this.onTrustCenterClicked);const t=document.getElementById(u);t&&(t.setAttribute(l.a.ariaRoleAttribute,l.a.ariaImageRole),t.setAttribute("title",(0,c.a)("PrivacySettingsDialogMicrosoftLogoAltText")))}constructor(){this.dialog=null,this._callback=null,this.onTrustCenterClicked=e=>{const{PrivacyDialogManager:t}=n(9442);t.recordSessionPrivacyActivity(8),this.dialog&&(this.dialog.hide(),this.dialog=null,t.showCommercialTrustCenterDialog())},this.dialogHandler=(e,t)=>{const{PrivacyDialogManager:a}=n(9442);a.recordSessionPrivacyActivity(16),this.dialog=null,this._callback()}}}(0,a.a)(p,"CommercialPrivacyNoticeDialog",null,[313])},1096:function(e,t,n){"use strict";n.r(t),n.d(t,{ReactCommercialPrivacyNoticeDialog:function(){return r}});var a=n(100),i=n(3696),o=n(8103);class r extends i.StandardDialog{initializeAndShowDialog(e){const{PrivacyDialogManager:t}=n(9442);t.recordSessionPrivacyActivity(4),this._callback=e,this.dialogId="CommercialPrivacyNoticeDialog",this.buttonsOption=0,this.setButtonText(1,(0,o.a)("Close")),this.showMicrosoftLogo=!0;const a=[],i=[];Array.add(a,(0,o.a)("PrivacyNoticeDialogMessageText")),Array.add(a,(0,o.a)("PrivacyNoticeDialogMessageSubText")),Array.add(a,"{0}"),Array.add(i,{type:"AppLinkProps",id:"LearnMoreLinkId",text:(0,o.a)("PrivacyDialogLearnMore"),handler:{href:"https://go.microsoft.com/fwlink/?linkid=2090814",target:"_blank"}}),Array.add(a,""),Array.add(a,(0,o.a)("PrivacyNoticeDialogSettingsLocation")),Array.add(a,"{0}");const r=this.onTrustCenterClicked;Array.add(i,{type:"AppLinkProps",id:"TrustCenterLinkId",text:(0,o.a)("PrivacyNoticeDialogSettingsLink"),onExecute:r}),Array.add(a,""),Array.add(a,(0,o.a)("PrivacyNoticeDialogServicesAgreementText")),Array.add(a,"{0}"),Array.add(i,{type:"AppLinkProps",id:"ServicesAgreementLinkId",text:(0,o.a)("PrivacyNoticeDialogServiesAgreementLink"),handler:{href:"https://go.microsoft.com/fwlink/?linkid=2093457",target:"_blank"}}),this.addAdditionalTextBodyContent(a,i),this.messageBox((0,o.a)("PrivacyNoticeDialogTitle"),null,0,this.dialogHandler,null)}constructor(){super(),this._callback=null,this.onTrustCenterClicked=e=>{const{PrivacyDialogManager:t}=n(9442);t.recordSessionPrivacyActivity(8),this.hide(),t.showCommercialTrustCenterDialog()},this.dialogHandler=(e,t)=>{const{PrivacyDialogManager:a}=n(9442);a.recordSessionPrivacyActivity(16),this._callback()}}}(0,a.a)(r,"ReactCommercialPrivacyNoticeDialog",i.StandardDialog,[313])},1801:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(2274),o=n(9969);class r{static markListAsReadyAndNotify(){this.listReady=!0,window.dispatchEvent(new CustomEvent("onQuietWindowReached"))}static listenForChunkLoads(){i.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9426033_QuietWindowTracker")&&window.addEventListener("qwt_onChunkLoaded",(e=>{e.detail&&"string"==typeof e.detail.fileName&&r.trackFile(e.detail.fileName)}))}static trackFile(e){if(this.listReady||!e.includes(".js")&&!e.includes(".css"))return;const t=o.a.getPageName(e).toLowerCase();this.fileList.add(t),this.timeOutId&&window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout((()=>r.markListAsReadyAndNotify()),3e3)}static getTrackedFiles(){return this.listReady?this.fileList:new Set}}r.fileList=new Set,r.listReady=!1,(0,a.a)(r,"QuietWindowTracker",null,[])},3946:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(7689),o=n(5301),r=n(6372);class s{static get isEnabled(){return r.a.isEnabled}static get scriptPath(){return r.a.scriptPath}static get fileSuffix(){return r.a.fileSuffix}static get appChromeBasePath(){return r.a.appChromeBasePath}static getPath(e,t=!0){return r.a.getPath(e,t)}static isKnownScript(e,t){for(const n of e)if(n.identifier===t||n.dependencies&&i.a.contains(n.dependencies,t))return!0;return!1}static getLocalizationPath(e){return r.a.getPath(String.format("localization/{0}",o.a.getCultureInfo(e).name.toLowerCase()))}}(0,a.a)(s,"AppChromeOverrideUtilities",null,[])},6372:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(2274);class o{static get isEnabled(){return!!i.AFrameworkApplication_AppSettingsManager.appSettingsManager&&i.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("AppChromeOverrideEnabled")||!1}static get scriptPath(){return i.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("AppChromeOverrideIsCombinedBundle")?this.getPath("",!1):this.getPath("webpack")}static getPath(e,t=!0){return String.format("{0}{1}{2}",this.appChromeBasePath,e,t?"/":"")}static get appChromeBasePath(){return i.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("AppChromeBaseUrlOverride")}static get fileSuffix(){return i.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("AppChromeMinificationOverride")}}(0,a.a)(o,"AppChromeOverrideUtilitiesStatic",null,[])},6101:function(e,t,n){"use strict";n.d(t,{a:function(){return u},b:function(){return g},c:function(){return c},d:function(){return d},e:function(){return f},f:function(){return S},g:function(){return h},h:function(){return p},i:function(){return m}});var a=n(625),i=n(100);class o{constructor(){this.isChangeGateEnabled=null}}(0,i.a)(o,"ChangeGatesManager",null,[]);class r{constructor(){this.getBooleanFeatureGate=null,this.getStringFeatureGate=null,this.getIntFeatureGate=null}}(0,i.a)(r,"FeatureGateManager",null,[]);var s=n(4004),l=n(2409);const c=()=>!!(window.appChrome&&appChrome.api&&appChrome.actions&&appChrome.selectors),d=e=>c()&&!!appChrome.actions[e],u=e=>c()&&!!appChrome.api[e],p=e=>c()&&!!appChrome.selectors[e],g=e=>c()&&!!appChrome[e],h=e=>{var t;window.appChromeInitialized||(u("setCookieWithExpirationCallback")&&u("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback(((e,t)=>l.a.setWithExpiration(e,t,l.a.maxComplianceAllowedRetentionInDays))),appChrome.api.setGetCookieValueCallback((e=>l.a.get(e)))),appChrome.setAppSettings(n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings),m(),_(),appChrome.api.setWebpackPublicPath(n(6776).AFrameworkApplicationConstants.staticContentScriptNameBase),n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled")?appChrome.setScriptLoader(appResourceLoader.loadChunk):appChrome.setScriptLoader((0,a.a)(e,e.loadScript,"loadScript")),appChrome.api.initializeLogger(new s.a),n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.FixingInitializationDuplication")&&(t=!0,window.appChromeInitialized=t))},m=()=>{u("setFeatureGateManager")&&appChrome.api.setFeatureGateManager(Object.assign(new r,{getBooleanFeatureGate:(0,a.a)(n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager,n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:(0,a.a)(n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager,n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:(0,a.a)(n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager,n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringFeatureGate,"getStringFeatureGate")}))},_=()=>{u("setChangeGatesManager")&&appChrome.api.setChangeGatesManager(Object.assign(new o,{isChangeGateEnabled:(0,a.a)(n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager,n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled,"isChangeGateEnabled")}))},S=e=>{if(e)switch(e.location){case"ContextMenu":return 19;case"Floatie":return 9;case"SingleLineRibbon":return 14;case"MultilineRibbon":return 15;case"Overflow":return 16;case"TellMe":return 17;case"FarPeripheralControls":return 18;case"Header":return 21;case"FileMenu":return 22;case"StatusBar":return 7;case"ViewerToolbar":return 27;case"SingleLineToolBar":return 31;case"TaskPane":return 12;case"Canvas":return 30;default:return 2}return 2},f=()=>"Multiline"===appChrome.selectors.getRibbonMode()?"Multiline":"SingleLine"},5965:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.target=null,this.content=null,this.title=null,this.primaryButtonProps=null,this.secondaryButtonProps=null,this.showCloseIcon=null,this.calloutProps=null,this.hasFocusableControls=null,this.useTeachingStyles=null,this.preventLightDismiss=null,this.hasDynamicSizing=null,this.jumpToCalloutTargetButtonEnabled=null,this.useCoachmark=null,this.onFullRenderComplete=null}}(0,a.a)(i,"CalloutParameters",null,[])},5709:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.message=null,this.title=null}}(0,a.a)(i,"CommonToastParameters",null,[])},5324:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.displayTimeoutSeconds=null,this.onExpire=null}}(0,a.a)(i,"ExpirationOptions",null,[])},5970:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.expirationOptions=null,this.onShow=null,this.telemetryId=null,this.navigationalOptions=null}}(0,a.a)(i,"NotificationOptions",null,[])},637:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var a=n(100),i=n(5149),o=n(5018),r=n(3245),s=n(385),l=n(2378),c=n(6984),d=n(5072),u=n(2544);class p{constructor(){this.whitelistedControlIds=null}}(0,a.a)(p,"StatusBarProps",null,[]);var g=n(1307),h=n(9611),m=n(988);const _="RSBIE";class S{buildReactStatusBar(e,t){const n={};n.StatusBarBuildStartTime=Date.now(),window.setTimeout((()=>{if(n.FirstTimeoutCallbackExecutionStartTime=Date.now(),c.a.instance.profileFunction((()=>{g.a.getStatusBarAPIAsync().then((a=>{n.StatusBarApiResolutionTime=Date.now();const o=Object.assign(new p,{whitelistedControlIds:t.whitelistedControlIds});return a.initializeNewStatusBar(e,o,this._statusBarId),this._reactStatusBarAPI=a,this._reactStatusBarInitialized=!0,n.ReactStatusBarInitializedTime=Date.now(),window.setTimeout((()=>{n.SecondTimeoutCallbackExecutionStartTime=Date.now(),c.a.instance.profileFunction((()=>{const e=new Array(0);if(t.trimmedIds){const n=t.trimmedIds;for(const t in n){const a={key:t,value:n[t]};e.push(appChrome.actions.updateControlHiddenState(a.key,a.value))}appChrome.api.dispatch(e,this.getRelevantSurfaces())}n.PollingStartTime=Date.now(),this.poll(),n.PollingEndTime=Date.now(),i.ULS.sendTraceTag(509748573,813,50,JSON.stringify(n))}),"RSB:I2")}),0),r.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&this.raiseReactStatusBarInitializedEvent(),null})).catch((e=>(i.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API"),null)))}),"RSB:I1"),t.statusBarFocusId&&e){S._hasRegisteredTabHandlers||(r.AFrameworkApplication.theActionManager.addAction(m.a.statusBarMoveForward,h.a.frame,this.statusBarTabAction),r.AFrameworkApplication.theActionManager.addAction(m.a.statusBarMoveBackward,h.a.frame,this.statusBarTabAction),S._hasRegisteredTabHandlers=!0);const n=l.a.initializeCuiScope(t.statusBarFocusId,t.setFocusAction,e,!1,!0,!0);n.keyDownHandledExternally=!0,this.rebindTabHandlers(n,m.a.statusBarMoveForward,m.a.statusBarMoveBackward)}}),0)}getRelevantSurfaces(){return this._relevantSurfacesMappingEnabled?4:void 0}poll(){this._reactStatusBarInitialized&&this._updateRibbonControls&&window.setTimeout((()=>{this._updateRibbonControls(this._reactStatusBarAPI.selectors.getStatusBarControlsMap(this._statusBarId),7)}),0)}setControlVisibility(e,t){this._reactStatusBarInitialized&&window.setTimeout((()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(e,t),this.getRelevantSurfaces())}),0)}pollControl(e){this._reactStatusBarInitialized&&this._updateRibbonControls&&window.setTimeout((()=>{const t=this._reactStatusBarAPI.selectors.getStatusBarControlsMap(this._statusBarId);if(t[e]){const n={};n[e]=t[e],this._updateRibbonControls(n,7)}}),0)}rebindTabHandlers(e,t,n){const a=u.a.hashKey(d.a.vK_Tab,0),i=u.a.hashKey(d.a.vK_Tab,4);e.unBindAction(a),e.unBindAction(i),e.bindAction(a,t),e.bindAction(i,n)}invokeOrRegisterOnReactStatusBarInitialized(e){this._reactStatusBarInitialized?e():this._eventSource&&this._eventSource.addHandler(_,e)}raiseReactStatusBarInitializedEvent(){this._eventSource&&(this._eventSource.raiseEvent(_),this._eventSource.dispose(),this._eventSource=null)}constructor(e,t,n=!0){this._eventSource=new o.a,this._relevantSurfacesMappingEnabled=!1,this.statusBarTabAction=(e,t,n,a,i)=>4,this._reactStatusBarInitialized=!1,this._reactStatusBarAPI=null,this._updateRibbonControls=t.updateRibbonControls,this._statusBarId=t.statusBarId,this._relevantSurfacesMappingEnabled=r.AFrameworkApplication.appSettingsManager?.getBooleanAppSetting("RelevantSurfacesMappingEnabled"),n?s.a.get_instance().executeWhen(7,(()=>{this.buildReactStatusBar(e,t)})):this.buildReactStatusBar(e,t)}}S._hasRegisteredTabHandlers=!1,(0,a.a)(S,"ReactStatusBar",null,[])},8315:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.updateRibbonControls=null,this.trimmedIds=null,this.whitelistedControlIds=null,this.isViewer=!1,this.statusBarId=null,this.statusBarFocusId=null,this.setFocusAction=null}}(0,a.a)(i,"ReactStatusBarInitOptions",null,[])},6166:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e){this.type=null,this.type=e}}(0,a.a)(i,"CustomContentProps",null,[])},3263:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}(0,a.a)(i,"ICalloutProps",null,[]);(0,a.a)(class{},"ILayerProps",null,[]);(0,a.a)(class{},"ILayerStyles",null,[])},9557:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e){this.src=null,this.ariaLabel=null,this.alt=null,this.src=e}}(0,a.a)(i,"ImageProps",null,[])},9037:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(6776),o=n(6101);class r{}(0,a.a)(r,"ShyComponentState",null,[]);class s{static changeShyRibbonState(e,t){if(i.AFrameworkApplicationConstants.activeFrame&&i.AFrameworkApplicationConstants.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&o.h("getShyState")){const n=appChrome.selectors.getShyState();n.isActive&&n.state===e&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new r,{state:t})))}}}(0,a.a)(s,"ShyRibbon",null,[])},9606:function(e,t,n){"use strict";n.d(t,{a:function(){return l},b:function(){return o},c:function(){return r},d:function(){return s},e:function(){return c}});var a=n(2274);let i;const o=()=>void 0!==i?i:i=a.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.isStaticRibbonUiEnabled",!1),r=()=>o()&&!!window.staticRibbon&&!!staticRibbon.api,s=()=>r()&&staticRibbon.api.isStaticRibbonVisible(),l=(e="StaticRibbonContainer",t=!0)=>{s()&&staticRibbon.api.renderStaticRibbon(document.getElementById(e),t)},c=(e,t)=>{s()&&staticRibbon.api.setTrimmedControlIds(t?[]:[e],t?[e]:[])}},1307:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(3792),o=n(9223),r=n(2274),s=n(6101),l=n(6776),c=n(9606);class d{static isUXAutoChunkRefactorEnabled(){return r.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("UXAutoChunkIsEnabled")}static setAppChromeProvider(e){d._appChromeProvider=e}static setAppChromeProviderDelegate(e){d._appChromeProviderDelegate=e}static setIntlBootOptions(e){d._intlBootOptions=e}static isLoaded(){return!!d._uiSurfacesAPI}static isContextualUILoaded(){return this.isUXAutoChunkRefactorEnabled()?!!d._contextualUIAPI:!!d._uiSurfacesAPI}static isDialogAPILoaded(){return!!d._dialogAPI}static getUISurfacesAPI(){return appChrome.loadUISlice20().then((e=>(d._uiSurfacesAPI=e,e)))}static loadScripts(){if(this.isUXAutoChunkRefactorEnabled())throw new Error("UISurfaces.loadScripts() should not be called");if(d.isLoaded())return Promise.resolve(d._uiSurfacesAPI);if(d._appChromeProvider)return d._appChromeProvider.then((e=>d.getUISurfacesAPI()));if(d._appChromeProviderDelegate){return d._appChromeProviderDelegate().then((e=>d.getUISurfacesAPI()))}let e;if(r.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled"))e=d.getDynamicBundleAppChromeIntlPromise();else{e=(0,i.a)(o.a).getScriptLoader().loadScript("appChrome")}return e.then((e=>((!l.AFrameworkApplicationConstants.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled||r.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTOThemeBugFix")&&(0,c.b)())&&(r.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled")?s.g(null):s.g((0,i.a)(o.a).getScriptLoader())),d.getUISurfacesAPI())))}static loadAppChrome(){if(d._appChromeProvider)return d._appChromeProvider;if(d._appChromeProviderDelegate)return d._appChromeProviderDelegate();if(d._appChromePromise)return d._appChromePromise;let e;return e=r.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled")?d.getDynamicBundleAppChromeIntlPromise():(0,i.a)(o.a).getScriptLoader().loadScript("appChrome"),d._appChromePromise=e.then((e=>{(!l.AFrameworkApplicationConstants.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled||r.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTOThemeBugFix")&&(0,c.b)())&&(r.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled")?s.g(null):s.g((0,i.a)(o.a).getScriptLoader()))})),d._appChromePromise}static async getContextualAPIAsync(){return d.isUXAutoChunkRefactorEnabled()?(d._contextualUIAPI||(await d.loadAppChrome(),d._contextualUIAPI=await appChrome.loadContextualUI()),d._contextualUIAPI):d.loadScripts().then((e=>d._uiSurfacesAPI.contextualUI))}static async getTaskPaneAPIAsync(){return d.isUXAutoChunkRefactorEnabled()?(d._taskPaneAPI||(await d.loadAppChrome(),d._taskPaneAPI=await appChrome.loadTaskPane()),d._taskPaneAPI):d.loadScripts().then((e=>d._uiSurfacesAPI.taskPane))}static async getDialogAPIAsync(){return d.isUXAutoChunkRefactorEnabled()?(d._dialogAPI||(await d.loadAppChrome(),d._dialogAPI=await appChrome.loadDialog()),d._dialogAPI):d.loadScripts().then((e=>(d._dialogAPI=d._uiSurfacesAPI.dialog,d._dialogAPI)))}static async getStatusBarAPIAsync(){return d.isUXAutoChunkRefactorEnabled()?(d._statusBarAPI||(await d.loadAppChrome(),d._statusBarAPI=await appChrome.loadStatusBar()),d._statusBarAPI):d.loadScripts().then((e=>(d._statusBarAPI=d._uiSurfacesAPI.statusBar,d._statusBarAPI)))}static async getMessageBarAPIAsync(){return d.isUXAutoChunkRefactorEnabled()?(d._messageBarAPI||(await d.loadAppChrome(),d._messageBarAPI=await appChrome.loadMessageBar()),d._messageBarAPI):d.loadScripts().then((e=>(d._messageBarAPI=d._uiSurfacesAPI.messageBar,d._messageBarAPI)))}static async getDictationFloatieUIAsync(){return d.isUXAutoChunkRefactorEnabled()?(d._dictationFloatieUIAPI||(await d.loadAppChrome(),d._dictationFloatieUIAPI=await appChrome.loadDictationFloatie()),d._dictationFloatieUIAPI):d.loadScripts().then((e=>d._uiSurfacesAPI.dictationFloatieUI))}static async getNotificationsAPIAsync(){return l.AFrameworkApplicationConstants.activeFrame.applicationInstance.isReactNotificationsEnabled?d.isUXAutoChunkRefactorEnabled()?(d._notificationsApi||(await d.loadAppChrome(),d._notificationsApi=appChrome.loadNotifications().then((e=>{const t=document.createElement("div");return l.AFrameworkApplicationConstants.activeFrame.get_element().appendChild(t),e.initializeCalloutNotifications(t),e}))),d._notificationsApi):(d._notificationsApi||(d._notificationsApi=d.loadScripts().then((e=>{const t=document.createElement("div");return l.AFrameworkApplicationConstants.activeFrame.get_element().appendChild(t),e.notifications.initializeCalloutNotifications(t),d._uiSurfacesAPI.notifications}))),d._notificationsApi):Promise.reject("React Notifications not enabled")}static async getRulerAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._rulerAPI||(await d.loadAppChrome(),d._rulerAPI=await appChrome.loadRuler()),d._rulerAPI):d.loadScripts().then((e=>(d._rulerAPI=d._uiSurfacesAPI.ruler,d._rulerAPI)))}static async getReactPdfAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._reactPdfAPI||(await d.loadAppChrome(),d._reactPdfAPI=await appChrome.loadReactPdf()),d._reactPdfAPI):d.loadScripts().then((e=>(d._reactPdfAPI=d._uiSurfacesAPI.reactPdf,d._reactPdfAPI)))}static async getFloatingHelpAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._floatingHelpAPI||(await d.loadAppChrome(),d._floatingHelpAPI=await appChrome.loadFloatingHelp()),d._floatingHelpAPI):d.loadScripts().then((e=>(d._floatingHelpAPI=d._uiSurfacesAPI.floatingHelp,d._floatingHelpAPI)))}static async getOcvFeedbackAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._ocvFeedbackAPI||(await d.loadAppChrome(),d._ocvFeedbackAPI=await appChrome.loadOcvFeedbackModal()),d._ocvFeedbackAPI):d.loadScripts().then((e=>d._uiSurfacesAPI.ocvFeedbackModal))}static async getCopilotAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._copilotAPI||(await d.loadAppChrome(),d._copilotAPI=await appChrome.loadCopilot()),d._copilotAPI):d.loadScripts().then((e=>d._uiSurfacesAPI.copilot))}static async getContextualCardAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._contextualCard||(await d.loadAppChrome(),d._contextualCard=await appChrome.loadContextualCard()),d._contextualCard):d.loadScripts().then((e=>d._uiSurfacesAPI.contextualCard))}static async getCopilotNudgeAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._copilotNudge||(await d.loadAppChrome(),d._copilotNudge=await appChrome.loadCopilotNudge()),d._copilotNudge):d.loadScripts().then((e=>d._uiSurfacesAPI.copilotNudge))}static async getCopilotKeepItAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._copilotKeepIt||(await d.loadAppChrome(),d._copilotKeepIt=await appChrome.loadCopilotKeepIt()),d._copilotKeepIt):d.loadScripts().then((e=>d._uiSurfacesAPI.copilotKeepIt))}static async getCopilotSkittleAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._copilotSkittle||(await d.loadAppChrome(),d._copilotSkittle=await appChrome.loadCopilotSkittle()),d._copilotSkittle):d.loadScripts().then((e=>d._uiSurfacesAPI.copilotSkittle))}static async getCopilotFlyoutSummaryAPI(){return d.isUXAutoChunkRefactorEnabled()?(d._copilotProactiveFlyoutSummary||(await d.loadAppChrome(),d._copilotProactiveFlyoutSummary=await appChrome.loadCopilotProactiveFlyoutSummary()),d._copilotProactiveFlyoutSummary):d.loadScripts().then((e=>d._uiSurfacesAPI.copilotProactiveFlyoutSummary))}static async getLiveMeetingAPI(){return d.loadScripts().then((e=>d._uiSurfacesAPI.liveMeeting))}static getDynamicBundleAppChromeIntlPromise(){return(0,c.b)()&&appResourceLoader.loadIntlBootResources&&d._intlBootOptions?Promise.all([appResourceLoader.loadChunk("appChrome"),appResourceLoader.loadIntlBootResources(d._intlBootOptions)]):appResourceLoader.loadChunk("appChrome")}}d._appChromePromise=null,d._appChromeProvider=null,d._appChromeProviderDelegate=null,d._uiSurfacesAPI=null,d._contextualUIAPI=null,d._taskPaneAPI=null,d._dialogAPI=null,d._statusBarAPI=null,d._messageBarAPI=null,d._dictationFloatieUIAPI=null,d._notificationsApi=null,d._rulerAPI=null,d._reactPdfAPI=null,d._floatingHelpAPI=null,d._ocvFeedbackAPI=null,d._liveMeetingAPI=null,d._intlBootOptions=null,d._contextualCard=null,d._copilotAPI=null,d._copilotNudge=null,d._copilotSkittle=null,d._copilotProactiveFlyoutSummary=null,d._copilotKeepIt=null,(0,a.a)(d,"UISurfaces",null,[])},4004:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(5149);class o{sendTraceTag(e,t,n,a){i.ULS.sendTraceTag(e,t,n,a)}shipAssertTag(e,t,n,a){i.ULS.shipAssertTag(e,t,n,a)}debugAssertTag(e,t,n,a){0}debugTraceTag(e,t,n,a){0}}(0,a.a)(o,"UlsExternalLogger",null,[102])},2469:function(e,t,n){"use strict";n.d(t,{a:function(){return g}});var a=n(100),i=n(3245),o=n(1207),r=n(9442),s=n(719),l=n(7958),c=n(988),d=n(4671),u=n(7146),p=n(884);class g extends d.a{static registerActions(e){const t=i.AFrameworkApplication.theActionManager,n=g.redirectAction;t.addActionWithFlags(c.a.help,e,n,65536),t.addActionWithFlags(c.a.privacyLink,e,n,65536),t.addActionWithFlags(c.a.openTermsOfUseLink,e,n,65536),t.addActionWithFlags(c.a.showThirdPartyNotices,e,n,65536),t.addActionWithFlags(c.a.showTrustCenter,e,n,65536),t.addActionWithFlags(c.a.frenchAccessibilityStatement,e,n,65536),t.addActionWithFlags(c.a.italianAccessibilityStatement,e,n,65536),t.addActionWithFlags(c.a.openConsumerHealthPolicyLink,e,n,65536)}static registerAction(e,t){const n=i.AFrameworkApplication.theActionManager,a=g.redirectAction;n.addAction(t,e,a)}static redirectAction(e,t,n,a,d){let h=4;switch(e){case c.a.accessibilityHelp:h=7;break;case c.a.help:case c.a.privacyLink:case c.a.openTermsOfUseLink:case c.a.showThirdPartyNotices:case c.a.showTrustCenter:case c.a.frenchAccessibilityStatement:case c.a.italianAccessibilityStatement:case c.a.openConsumerHealthPolicyLink:break;default:return 2}if(1===n)return 32;switch(e){case c.a.privacyLink:i.AFrameworkApplication.privacyUrl&&l.a.safelyOpenWindow(i.AFrameworkApplication.privacyUrl,void 0,void 0,"Redirect.PrivayLink");break;case c.a.openTermsOfUseLink:i.AFrameworkApplication.termsUrl&&l.a.safelyOpenWindow(i.AFrameworkApplication.termsUrl,void 0,void 0,"Redirect.OpenTermsOfUseLink");break;case c.a.help:g.showHelp("");break;case c.a.showThirdPartyNotices:l.a.safelyOpenWindow(u.a.instance.isShippingFrom1JSEnabled?p.a.instance.getResourceUrlShippingFrom1JS("thirdPartyNotices.html"):o.a.staticContentHost+i.AFrameworkApplication.scriptFolderPath+"TPN\\thirdPartyNotices.html","_blank",s.a,"Redirect.ShowThirdPartyNotices");break;case c.a.showTrustCenter:r.PrivacyDialogManager.showCommercialTrustCenterDialog();break;case c.a.frenchAccessibilityStatement:{const e=i.AFrameworkApplication.appSettingsManager.getStringAppSetting("FrenchAccessibilityStatementUrl");e&&l.a.safelyOpenWindow(e,"_blank",void 0,"Redirect.FrenchAccessibilityStatement");break}case c.a.italianAccessibilityStatement:{const e=i.AFrameworkApplication.appSettingsManager.getStringAppSetting("ItalianAccessibilityStatementUrl");e&&l.a.safelyOpenWindow(e,"_blank",void 0,"Redirect.ItalianAccessibilityStatement");break}case c.a.openConsumerHealthPolicyLink:i.AFrameworkApplication.consumerHealthPolicyUrl&&l.a.safelyOpenWindow(i.AFrameworkApplication.consumerHealthPolicyUrl,void 0,void 0,"Redirect.OpenConsumerHealthPolicyLink");break;default:s.c(g.application,i.AFrameworkApplication.lcid,h)}return 32}}(0,a.a)(g,"Redirect",d.a,[])},4671:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(719),o=n(6776);class r{static isHelpAvailable(){return!0}static toFwlink(e){i.d(!1,e,o.AFrameworkApplicationConstants.lcid,null,null)}static showHelp(e){i.b(r.application,o.AFrameworkApplicationConstants.lcid,e,o.AFrameworkApplicationConstants.useParentHelpFunction)}static toDebugOnlyLink(e){0}}r.application=0,(0,a.a)(r,"RedirectStatic",null,[])},5832:function(e,t,n){"use strict";n.d(t,{a:function(){return m}});var a=n(100),i=n(5149),o=n(884),r=n(1493),s=n(5557),l=n(2274),c=n(1207),d=n(7689),u=n(6776),p=n(6372),g=n(7146),h=n(1801);class m{static getScriptFileNameWithDebugExtension(e){const{appSettingsManager:t}=l.AFrameworkApplication_AppSettingsManager,n=t.containsAppSetting("IsServerFlavorDebug")?t.getBooleanAppSetting("IsServerFlavorDebug"):Boolean(!1),a=t.isChangeGateEnabled("OfficeVSO:8917822_FixDebugExtension")?u.AFrameworkApplicationConstants.scriptDebugExtension:"debug.",i=n?a:"";return String.format(e,i)}static get overrideBaseUrlForDullscriptv2IsEnabled(){return null==m._overrideBaseUrlForDullscriptv2IsEnabled&&(m._overrideBaseUrlForDullscriptv2IsEnabled=!!l.AFrameworkApplication_AppSettingsManager.appSettingsManager&&l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverrideBaseUrlForDullscript_v2",!1)),m._overrideBaseUrlForDullscriptv2IsEnabled}static get hashedScriptUrlForLocalizedResourcesFixEnabled(){return null==m._hashedScriptUrlForLocalizedResourcesFixEnabled&&(m._hashedScriptUrlForLocalizedResourcesFixEnabled=!!l.AFrameworkApplication_AppSettingsManager.appSettingsManager&&l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("HashedScriptUrlForLocalizedResourcesFixEnabled")),m._hashedScriptUrlForLocalizedResourcesFixEnabled}static scriptUrlFromName(e,t,n,a,i,o){if(!n&&0===t)throw Error.format("ScriptUrlFromName: ScriptBase is not set for ScripNameFormat.ScriptBase");if(4===t)return m.addCompressionDictionaryTransportQueryParameter(e);let r=m.getFileName(e,t,n,i,o),s="{0}";switch(t){case 0:m.overrideBaseUrlForDullscriptv2IsEnabled&&(s="https://localhost:8080/",r=r.replace("debug.","Debug."));break;case 2:case 7:p.a.isEnabled&&7===t&&(s=p.a.scriptPath);break;case 5:case 9:case 6:case 8:{let n=o;e.indexOf("?")>=0&&(n=o.replace("?","&")),8===t&&(r=m.hashedScriptUrlForLocalizedResourcesFixEnabled?String.format("{0}/{1}",i,r):String.format("{0}\\{1}",i,r)),6===t&&(s=m.getContentBaseUrl());break}}return l.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9142601_QuietWindowTrackingIsEnabled")&&h.a.trackFile(s+r),s=String.format(s,m.overrideStaticContentScriptNameBase(a,r)),s+=r,m.addCompressionDictionaryTransportQueryParameter(s)}static hashedScriptUrlFromName(e,t,n,a,i,o){return l.AFrameworkApplication_AppSettingsManager.appSettingsManager&&l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("SubresourceIntegrityIsEnabled")?m.hashedScriptUrlFromNameNew(e,t,n,a,i,o):m.hashedScriptUrlFromNameOld(e,t,n,a,i,o)}static hashedScriptUrlFromNameOld(e,t,n,a,i,o){let r=".min";if(l.AFrameworkApplication_AppSettingsManager.appSettingsManager.containsAppSetting("IsServerFlavorDebug")&&(r=l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IsServerFlavorDebug")?"":".min"),4===t)return m.addCompressionDictionaryTransportQueryParameter(e);let s=a;const c=".js"+o,d=e+c;let h="",_=null;switch(t){case 0:if(l.AFrameworkApplication_AppSettingsManager.appSettingsManager&&l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OverrideBaseUrlForDullscript"))s=m.getScriptFileNameWithDebugExtension(n)+d,s="https://localhost:8080/"+s.toLowerCase().replace("ewa.","EwaDS.").replace("debug.","Debug.");else{if(h=m.getScriptFileNameWithDebugExtension(n)+d,_=m.getAdjustedUrlWithHash(a,h),_)break;s=m.tryAdjustFileNameBaseWithHash(s,h),s+=h}break;case 1:if(h=n+d,_=m.getAdjustedUrlWithHash(a,h),_)break;s=m.tryAdjustFileNameBaseWithHash(s,h),s+=h;break;case 2:case 7:if(h=String.format("{0}{1}{2}",e,r,c),_=m.getAdjustedUrlWithHash(a,h),_)break;s=p.a.isEnabled&&6===t?p.a.scriptPath:m.tryAdjustFileNameBaseWithHash(s,h),s+=h;break;case 3:if(h=String.format("{0}\\{1}",i,d),m.hashedScriptUrlForLocalizedResourcesFixEnabled&&(h=String.format("{0}/{1}",i,d)),g.a.instance.isShippingFrom1JSEnabled&&!u.AFrameworkApplicationConstants.wd1jsIsEnabled&&(h=d),_=m.getAdjustedUrlWithHash(a,h),_)break;s=m.tryAdjustFileNameBaseWithHash(s,h),s+=h;break;case 5:case 9:case 6:{let n=o,i=e;const r=e.indexOf("?");if(r>=0&&(n=o.replace("?","&"),i=e.substring(0,r)),h=String.format("{0}{1}",e,n).replace("debug.","Debug."),6===t)s=m.getContentBaseUrl();else{if(_=m.getAdjustedUrlWithHash(a,h),_)break;s=m.tryAdjustFileNameBaseWithHash(s,i)}s+=h;break}}return m.addCompressionDictionaryTransportQueryParameter(_??s)}static hashedScriptUrlFromNameNew(e,t,n,a,i,o){if(4===t)return m.addCompressionDictionaryTransportQueryParameter(e);let r=a,s=m.getFileName(e,t,n,i,o),c=null;switch(r=m.overrideStaticContentScriptNameBase(a,s),t){case 0:if(l.AFrameworkApplication_AppSettingsManager.appSettingsManager&&l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OverrideBaseUrlForDullscript"))r=m.getScriptFileNameWithDebugExtension(n)+e+".js"+o,r="https://localhost:8080/"+r.toLowerCase().replace("ewa.","EwaDS.").replace("debug.","Debug.");else{if(c=m.getAdjustedUrlWithHash(a,s),c)break;r=m.tryAdjustFileNameBaseWithHash(r,s),r+=s}break;case 1:case 2:case 7:case 3:if(c=m.getAdjustedUrlWithHash(a,s),c)break;r=m.tryAdjustFileNameBaseWithHash(r,s),r+=s;break;case 5:case 9:case 6:{let n=o;if(e.indexOf("?")>=0&&(n=o.replace("?","&")),s=String.format("{0}{1}",e,n).replace("debug.","Debug."),6===t)r=m.getContentBaseUrl();else{if(c=m.getAdjustedUrlWithHash(a,s),c)break;r=m.tryAdjustFileNameBaseWithHash(r,s)}r+=s;break}}l.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9142601_QuietWindowTrackingIsEnabled")&&h.a.trackFile(c??r);const d=c??r;return m.addCompressionDictionaryTransportQueryParameter(d)}static getFileName(e,t,n,a,i){let o=".min";l.AFrameworkApplication_AppSettingsManager.appSettingsManager.containsAppSetting("IsServerFlavorDebug")&&(o=l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IsServerFlavorDebug")?"":".min");const r=".js"+i,c=e+r;let d="";switch(t){case 4:{const t=e.indexOf(u.AFrameworkApplicationConstants.scriptFolderPath);if(t>0){const n=t+u.AFrameworkApplicationConstants.scriptFolderPath.length,a=e.indexOf("?"),i=a>0?a:e.length;d=e.substring(n,i)}break}case 0:d=l.AFrameworkApplication_AppSettingsManager.appSettingsManager&&l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OverrideBaseUrlForDullscript")?"":m.getScriptFileNameWithDebugExtension(n)+c;break;case 1:d=n+c;break;case 2:case 7:d=String.format("{0}{1}{2}",e,o,r);break;case 3:if(g.a.instance.isShippingFrom1JSEnabled&&!u.AFrameworkApplicationConstants.wd1jsIsEnabled){d=c;break}d=String.format("{0}\\{1}",a,c),m.hashedScriptUrlForLocalizedResourcesFixEnabled&&(d=String.format("{0}/{1}",a,c));break;case 5:case 9:case 6:case 8:{let t=e;const n=e.indexOf("?");n>=0&&(t=e.substring(0,n)),d=t;break}}return d&&""!==d||s.b(574359374,200,15,"Script fileName is null or empty"),d}static getAdjustedUrlWithHash(e,t){if(g.a.instance.isShippingFrom1JSEnabled&&u.AFrameworkApplicationConstants.wd1jsIsEnabled){const n=m.overrideStaticContentScriptNameBase(e,t);if(n.includes("wd1js"))return n+t}return o.a.instance.getResourceUrlShippingFrom1JS(t)}static tryAdjustFileNameBaseWithHash(e,t){if(r.a(t,"Gc2HostPpt"))return e;if(l.AFrameworkApplication_AppSettingsManager.appSettingsManager&&l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UseGc2HostPptWithOptimizedLoading",!1)&&r.a(t,"Gc2HostPptWithOptimizedLoading"))return e;const n=o.a.instance.getHashedAppResourceHost(u.AFrameworkApplicationConstants.scriptFolderPath+t);return n?n+u.AFrameworkApplicationConstants.scriptFolderPath:e}static getContentBaseUrl(){let e="https://localhost:8080";return l.AFrameworkApplication_AppSettingsManager.appSettingsManager&&(e=l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("ContentBaseUrl")||"https://localhost:8080"),e+"/"}static overrideStaticContentScriptNameBase(e,t){if(!u.AFrameworkApplicationConstants.wd1jsIsEnabled)return e;const n=m.extractScriptFolderPath(c.a.staticContentHost,e);if(m.isInExceptionListForWD1JS(n+t)){const t=l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("StaticContentHostNonOverriden")||"";return""===t?e:t+n}return e}static extractScriptFolderPath(e,t){if(!t.startsWith(e))throw i.ULS.sendTraceTag(508396297,306,10,"ExtractScriptFolderPath: Host {0} is not part of URL {1}.",e,t),Error.format("ExtractScriptFolderPath: Host is not part of URL.");return t.replace(e,"")}static isInExceptionListForWD1JS(e){if(!m._wd1jsOverrideExceptionList){m.wd1jsCheckHelloFile();const e=l.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("WdOverrideExceptionList")||"";let t=JSON.parse(e);t=d.a.map(t,(e=>e.toLowerCase())),m._wd1jsOverrideExceptionList=new Set(t)}e=(e=e.toLowerCase()).replace(m.backslashRegex,"/");const t=m.localizationRegex.exec(e);t&&(e=e.replace(t[2],"<lcid>"));const n=m._wd1jsOverrideExceptionList.has(e);return i.ULS.sendTraceTag(506282450,306,50,`wd1js file: ${e} exception: ${n}`),n}static wd1jsCheckHelloFile(){if(m.staticContentHostIsLocal)return;let e=c.a.staticContentHost.slice(0,c.a.staticContentHost.indexOf("/wd1js/"));e=String.format("{0}/wd1js/hello.txt",e);const t=new XMLHttpRequest;if(t.open("HEAD",e,!1),t.send(null),200!==t.status)throw Error.format("WD1JS: PR does not exist in 1CDN, make sure that you're modifying a supported package.")}static get staticContentHostIsLocal(){return-1!==c.a.staticContentHost.indexOf("localhost")}static addCompressionDictionaryTransportQueryParameter(e){const t=window.g_wscdt;if(void 0!==t&&!e.match("[?&]wscdt=")){const n=e.indexOf("?");e+=(n>-1?"&":"?")+"wscdt="+t}return e}}m._overrideBaseUrlForDullscriptv2IsEnabled=null,m._hashedScriptUrlForLocalizedResourcesFixEnabled=null,m._wd1jsOverrideExceptionList=null,m.localizationRegex=new RegExp("(App_Scripts|resources)?\\/?(\\d{4,}|[a-zA-Z]+-[a-zA-Z]+)\\/(.+)"),m.backslashRegex=new RegExp("\\\\","g"),(0,a.a)(m,"ScriptUrlGenerator",null,[])},507:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(5149),o=n(2274),r=n(884),s=n(3946),l=n(6776),c=n(7146),d=n(2764),u=n(9800);class p{static resolveScript(e,t){let n;if(n=s.a.isEnabled?p.resolveScriptFromLocalhost(e,t):r.a.instance.isEnabled?p.resolveHashedScript(e,t):p.resolveScriptCore(e,t),u.a.logUniqueUsage("9d8ii465;fb57i154"),o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsAppResourceLoaderTrustedTypesPolicyEnabled",!1))try{return d.b.createScriptURL(n)}catch{const{origin:e}=new URL(n,document.baseURI);return i.ULS.sendTraceTag(506029762,201,15,"ScriptUrlResolver: TrustedTypes policy does not allow loading URL: "+e),o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.ScriptUrlResolverBlock",!1)?"":n}return n}static resolveScriptCore(e,t){let n=l.AFrameworkApplicationConstants.staticContentScriptNameBase;n+=t?l.AFrameworkApplicationConstants.lcid+"/":p.getBaseURLSuffix();return n+e+p.getMinSuffix(t)+".js"}static resolveScriptFromLocalhost(e,t){let n=t?s.a.getLocalizationPath(l.AFrameworkApplicationConstants.lcid):s.a.scriptPath;return t||(n+=p.getBaseURLSuffix()),n+e+s.a.fileSuffix+".js"}static resolveHashedScript(e,t){const n=p.getMinSuffix(t);let a=l.AFrameworkApplicationConstants.scriptFolderPath;if(c.a.instance.isShippingFrom1JSEnabled){const t=r.a.instance.getResourceUrlShippingFrom1JS(e+n+".js");if(t)return t}a+=t?l.AFrameworkApplicationConstants.lcid+"/":p.getBaseURLSuffix(),a+=e+n+".js";const o=r.a.instance.getHashedAppResourceHost(a);return o||i.ULS.sendTraceTag(523355659,306,50,"Failed to get hashed host URL for "+a+", fallback to versioned URL"),o?o+a:p.resolveScriptCore(e,t)}static getBaseURLSuffix(){if(!o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("AppChromeOverrideIsCombinedBundle")&&!o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IsCombinedBundleEnabled")){if(o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("UXAutoChunkIsEnabled"))return"ac/";if(o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IsWebpack5RibbonEnabled"))return"wp5/"}return""}static getMinSuffix(e){let t;return o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IsCombinedBundleEnabled")?"":(t=o.AFrameworkApplication_AppSettingsManager.appSettingsManager.containsAppSetting("IsServerFlavorDebug")&&o.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IsServerFlavorDebug")?"":".min",t)}}(0,a.a)(p,"ScriptUrlResolver",null,[])},7905:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a,i=n(100),o=n(5149),r=n(5018);!function(e){e[e.accessToken=0]="accessToken",e[e.scheduledShutdown=1]="scheduledShutdown"}(a||(a={})),(0,i.b)("SessionExpirationReason",a);var s=n(525),l=n(6776);const c="BSE";class d{add_sessionExpiredDetected(e){this._eventSource.addHandler(this.sessionExpiredDetectedEventKey,e)}remove_sessionExpiredDetected(e){this._eventSource.removeHandler(this.sessionExpiredDetectedEventKey,e)}add_sessionAboutToExpireDetected(e){this._eventSource.addHandler(this.sessionAboutToExpireDetectedEventKey,e)}remove_sessionAboutToExpireDetected(e){this._eventSource.removeHandler(this.sessionAboutToExpireDetectedEventKey,e)}add_onBeforeSessionEndEvent(e){this._eventSource.addHandler(c,e)}remove_onBeforeSessionEndEvent(e){this._eventSource.removeHandler(c,e)}checkAndTriggerSessionHasExpired(){return this.checkAndTriggerSessionHasExpiredForReason(1,l.AFrameworkApplicationConstants.scheduledShutdownTtl,l.AFrameworkApplicationConstants.accessTokenExpirationPromptSeconds)||this.checkAndTriggerSessionHasExpiredForReason(0,l.AFrameworkApplicationConstants.accessTokenTtl,l.AFrameworkApplicationConstants.accessTokenExpirationPromptSeconds,!0)}checkAndTriggerSessionHasExpiredForReason(e,t,n,a=!1){let i=this.isSessionExpired(t);return a&&i&&this.cancelSessionExpiration&&0===this._ignoreOverride&&(this._ignoreOverride=1,i=!this.cancelSessionExpiration(),this._ignoreOverride=i?2:0),i?this.logAndRaiseEvent(!0,t,n,e):this.isSessionAboutToExpire(t,n)&&this.logAndRaiseEvent(!1,t,n,e),i}get isSessionExpiredDueToScheduledShutdown(){return this._sessionExpirationEventSourceStatic.isSessionExpiredDueToScheduledShutdown}get isSessionAboutToExpireDueToScheduledShutdown(){return this._sessionExpirationEventSourceStatic.isSessionAboutToExpireDueToScheduledShutdown}isSessionExpired(e){return this._sessionExpirationEventSourceStatic.isSessionExpired(e)}isSessionAboutToExpire(e,t){return this._sessionExpirationEventSourceStatic.isSessionAboutToExpire(e,t)}logAndRaiseEvent(e,t,n,i){e?this._sessionExpiredLogged||(o.ULS.sendTraceTag(20492681,201,50,"SessionHasExpired: {0}",{Reason:a[i],TTL:t,TimeNow:(new Date).getTime(),BootTime:l.AFrameworkApplicationConstants.bootTime}),this._sessionExpiredLogged=!0):this._sessionAboutToExpireLogged||(o.ULS.sendTraceTag(20492682,201,50,"SessionAboutToExpire: {0}",{Reason:a[i],ExpirationPromptSeconds:n,TTL:t,TimeNow:(new Date).getTime(),BootTime:l.AFrameworkApplicationConstants.bootTime}),this._sessionAboutToExpireLogged=!0),this._eventSource.raiseEvent(e?this.sessionExpiredDetectedEventKey:this.sessionAboutToExpireDetectedEventKey)}raiseBeforeSessionEndEvent(){this._eventSource.raiseEvent(c)}dispose(){this._eventSource.dispose()}static get instance(){return d._singletonInstance||(d._singletonInstance=new d(s.a.instance))}constructor(e=null){this._sessionExpiredLogged=!1,this._sessionAboutToExpireLogged=!1,this._ignoreOverride=0,this._eventSource=new r.a,this.sessionExpiredDetectedEventKey="SED",this.sessionAboutToExpireDetectedEventKey="SATED",this.cancelSessionExpiration=null,this._sessionExpirationEventSourceStatic=null,this._sessionExpirationEventSourceStatic=e||new s.a}}d._singletonInstance=null,(0,i.a)(d,"SessionExpirationEventSource",null,[11])},525:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(6776);class o{static get instance(){return o._singletonInstance||(o._singletonInstance=new o)}get isSessionExpiredDueToScheduledShutdown(){return i.AFrameworkApplicationConstants.isScheduledShutdownEnabled()&&i.AFrameworkApplicationConstants.scheduledShutdownTtl>0&&(new Date).getTime()>=i.AFrameworkApplicationConstants.scheduledShutdownTtl}isSessionExpired(e){return!!this.isSessionExpiredDueToScheduledShutdown||e>0&&(new Date).getTime()>=e}isSessionAboutToExpire(e,t){return!!this.isSessionAboutToExpireDueToScheduledShutdown||(i.AFrameworkApplicationConstants.isWopiTokenRefreshEnabled&&i.AFrameworkApplicationConstants.wopiTokenExpiresAfterMinutes>0?!this.isSessionExpired(e)&&(new Date).getTime()>=i.AFrameworkApplicationConstants.wopiTokenLastRefreshTime+60*i.AFrameworkApplicationConstants.wopiTokenExpiresAfterMinutes*1e3:!this.isSessionExpired(e)&&e>0&&(new Date).getTime()>=e-1e3*t)}get isSessionAboutToExpireDueToScheduledShutdown(){return i.AFrameworkApplicationConstants.isScheduledShutdownEnabled()&&i.AFrameworkApplicationConstants.scheduledShutdownTtl>0&&(new Date).getTime()>=i.AFrameworkApplicationConstants.scheduledShutdownTtl-1e3*i.AFrameworkApplicationConstants.scheduledShutdownPromptSeconds}}o._singletonInstance=null,(0,a.a)(o,"SessionExpirationEventSourceStatic",null,[])},311:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(5149);class o{constructor(){this.AvgOnConnectTime=0,this.MaxOnConnectTime=0,this.OnConnectCount=0,this.AvgOnConnectTime=0,this.MaxOnConnectTime=0,this.OnConnectCount=0}}(0,a.a)(o,"GraphNodeConnectPerf",null,[]);var r=n(965);class s{initGraphNodeConnectPerf(){this.GraphNodeConnectPerf=new o}markAsCoauthSession(){this.IsCoauthSession=!0}markAsRealEditSession(){this.IsRealEdit=!0}setAccessType(e){this.AccessType=e}markRunawayDatalossSystemStarted(e=null){e||(e=new Date),this.RunawayDatalossSystemStartedAt=e.getTime()}markAsActiveCoauthSession(){this.HasReceivedInboundReplications=!0}markAsMixedCoauthSession(){this.IsMixedCoauthSession=!0}markTabFrozen(e=null){e||(e=new Date),this.TabLastFrozenAt=e.getTime()}markEmergencyViewDeployed(e=null){e||(e=new Date),this.EmergencyViewLastDeployedAt=e.getTime()}fillFromAppSettings(e){this.ApplicationVersion=e.getStringAppSetting("BuildVersion")||"0.0.0.0",this.HostResponseStats=this.parseHostResponseStats(e.getStringAppSetting("HostResponseStats")),this.ClientThrottlingProtection=e.getStringAppSetting("ClientThrottlingProtection")||"",this.HostServiceLevel=e.getStringAppSetting("HostServiceLevel")||"",this.RequestedCallThrottling=e.getStringAppSetting("RequestedCallThrottling")||"",this.WacServiceLevel=e.getStringAppSetting("WacServiceLevel")||"",this.SharingStatus=e.getStringAppSetting("SharingStatus")||""}parseHostResponseStats(e){try{if(e)return r.b(e)||{}}catch(t){i.ULS.sendTraceTag(589857932,201,10,"Exception thrown from JsonSerializer.SecureDeserialize for responseStats:{0}. Exception:{1}",e,t)}return{}}handleOnSettingsRefresh(e,t){this.fillFromAppSettings(t.newRefreshedSettingsGetter)}constructor(){this.ApplicationVersion=null,this.IsCoauthSession=!1,this.IsRealCoauthSession=!1,this.IsRealEdit=!1,this.HasReceivedInboundReplications=!1,this.HostResponseStats=null,this.AccessType=null,this.SessionMergeInfo=0,this.CookieComplianceBanner=0,this.PrivacyNotice=0,this.Feedback=0,this.FrameMode=null,this.RenavigationReason=null,this.HasDataLoss=!1,this.ClientThrottlingProtection=null,this.HostServiceLevel=null,this.RequestedCallThrottling=null,this.WacServiceLevel=null,this.MemoryUsageData=null,this.SharingStatus=null,this.HadSettingsRefresh=!1,this.IsMixedCoauthSession=!1,this.WacSessionDatacenter=null,this.TabLastFrozenAt=0,this.EmergencyViewLastDeployedAt=0,this.DssLineageId=null,this.PaginatedDurationMs=0,this.DataLossSeverity=0,this.GraphNodeConnectPerf=null,this.HostProtocol=null,this.DataLossSeverityDetail=null,this.RunawayDatalossSystemStartedAt=0,this.AccessType="",this.ApplicationVersion="",this.IsCoauthSession=!1,this.IsRealCoauthSession=!1,this.IsRealEdit=!1,this.HasReceivedInboundReplications=!1,this.SessionMergeInfo=0,this.FrameMode="",this.CookieComplianceBanner=0,this.PrivacyNotice=0,this.HasDataLoss=!1,this.HostResponseStats=null,this.MemoryUsageData=null,this.IsMixedCoauthSession=!1,this.TabLastFrozenAt=0,this.EmergencyViewLastDeployedAt=0,this.DssLineageId="",this.PaginatedDurationMs=0,this.DataLossSeverity=0,this.GraphNodeConnectPerf=null,this.HostProtocol="",this.DataLossSeverityDetail="",this.RunawayDatalossSystemStartedAt=0}}(0,a.a)(s,"SessionFinishedDataPlumber",null,[])},9317:function(e,t,n){"use strict";n.d(t,{a:function(){return h}});var a=n(100),i=n(3792),o=n(9588),r=n(5149),s=n(5018),l=n(871);class c extends Sys.EventArgs{constructor(e,t){super(),this.oldNetworkState=e,this.newNetworkState=t}}(0,a.a)(c,"AppNetworkConnectivityChangedEventArgs",Sys.EventArgs,[]);var d=n(965),u=n(2274),p=n(6776),g=n(525);class h{get isExpired(){return!!g.a.instance.isSessionExpiredDueToScheduledShutdown||this._getAccessTokenExpiry()>0&&(new Date).getTime()>=this._getAccessTokenExpiry()}get isKickedOut(){return this._isKickedOut}get isViable(){return!(this.isKickedOut||this.isExpired)}get isNetworkConnected(){return 0===this.networkState}get hasEmergencyViewModeBeenDeployed(){return this._isInEmergencyViewMode}set hasEmergencyViewModeBeenDeployed(e){this._isInEmergencyViewMode=e}kickOut(e=null){this.isKickedOut||(this._isKickedOut=!0,this._eventSource.raiseEvent(h.kickOutEventKey,e,this))}add_onKickedOut(e){this._eventSource.addHandler(h.kickOutEventKey,e)}remove_onKickedOut(e){this._eventSource.removeHandler(h.kickOutEventKey,e)}add_onSessionExpiringNetworkResumed(e){this._eventSource.addHandler(h.sessionExpiringNetworkResumedEventKey,e)}remove_onSessionExpiringNetworkResumed(e){this._eventSource.removeHandler(h.sessionExpiringNetworkResumedEventKey,e)}add_preemptivelyTokenRefresh(e){this._eventSource.addHandler(h.preemptiveTokenRefreshEventKey,e)}remove_preemptivelyTokenRefresh(e){this._eventSource.removeHandler(h.preemptiveTokenRefreshEventKey,e)}isTokenRefreshRequired(){return(g.a.instance.isSessionExpired(p.AFrameworkApplicationConstants.accessTokenTtl)||g.a.instance.isSessionAboutToExpire(p.AFrameworkApplicationConstants.accessTokenTtl,p.AFrameworkApplicationConstants.accessTokenExpirationPromptSeconds))&&!this.isKickedOut}raiseTokenRefreshIfNecessary(){this.isWopiTokenRefreshEnabled&&this.isTokenRefreshRequired()&&this._eventSource.raiseEvent(h.sessionExpiringNetworkResumedEventKey)}add_onAppNetworkChanged(e){this._eventSource.addHandler(h.appNetworkChangedEventKey,e)}remove_onAppNetworkChanged(e){this._eventSource.removeHandler(h.appNetworkChangedEventKey,e)}changeAppNetworkStatus(e){if(e===this.networkState)return;const t=this.networkState;this.networkState=e,2!==e&&0!==e||this.raiseTokenRefreshIfNecessary(),this.isKickedOut||this._eventSource.raiseEvent(h.appNetworkChangedEventKey,new c(t,e))}raisePreemptiveTokenRefreshEvent(){this._eventSource.raiseEvent(h.preemptiveTokenRefreshEventKey)}addTokenRefreshErrorToMap(e){this._isVerboseLoggingEnabled&&r.ULS.sendTraceTag(527791642,217,50,"Adding Error to Token Refresh Error Map: "+e.toString()),e.toString()in this._tokenRefreshErrorMap?this._tokenRefreshErrorMap[e.toString()]=this._tokenRefreshErrorMap[e.toString()]+1:this._tokenRefreshErrorMap[e.toString()]=1,this._isVerboseLoggingEnabled&&r.ULS.sendTraceTag(527791643,217,50,"TokenRefreshError Map State: "+d.c(this._tokenRefreshErrorMap))}getTokenRefreshErrorToReport(){this._isVerboseLoggingEnabled&&r.ULS.sendTraceTag(527791644,217,50,"TokenRefreshError Map State: "+d.c(this._tokenRefreshErrorMap));const e=u.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("SessionExpiredVetoCleanUpEnabled")??!1;if(!e&&"78"in this._tokenRefreshErrorMap)return 78;if(u.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("WopiTokenRevokedTokenExperiment")&&u.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("ShowTokenRevocationErrorMessage")&&"79"in this._tokenRefreshErrorMap)return 79;if(e){if("78"in this._tokenRefreshErrorMap)return 78;if("73"in this._tokenRefreshErrorMap)return 73}let t=28,n=0;const a=this._tokenRefreshErrorMap;for(const e in a){const i={key:e,value:a[e]},o=i.value;o>n&&(t=Number.parseInvariant(i.key),n=o)}return t}resetTokenRefreshErrors(){this._tokenRefreshErrorMap={}}static get instance(){return h._singletonInstance||(h._singletonInstance=new h((()=>p.AFrameworkApplicationConstants.accessTokenTtl),u.AFrameworkApplication_AppSettingsManager.appSettingsManager||new l.a({})))}constructor(e,t){this._eventSource=new s.a,this._isKickedOut=!1,this.lastTokenRefreshError=null,this.hasPostProcessingAfterTokenRefreshCompleted=!0,this.handleVisibilityChange=(e,t)=>{t.report("SessionStatusManager.IsViable",this.isViable),t.report("SessionStatusManager.IsNetworkConnected",this.isNetworkConnected),t.report("SessionStatusManager.IsExpired",this.isExpired),0===t.newState&&this.isNetworkConnected&&this.raiseTokenRefreshIfNecessary()},this._getAccessTokenExpiry=e,this.networkState=0,this._tokenRefreshErrorMap={},this.isWopiTokenRefreshEnabled=t.getBooleanAppSetting("WOPITokenRefreshIsEnabled"),this._isVerboseLoggingEnabled=t.getBooleanAppSetting("VerboseLoggingForTokenRefreshIsEnabled"),(0,i.h)(o.a).execute((e=>{e.add_onVisibilityStateChange(this.handleVisibilityChange)})),this._isInEmergencyViewMode=!1}}h._singletonInstance=null,h.kickOutEventKey="kickedOut",h.sessionExpiringNetworkResumedEventKey="SEP",h.appNetworkChangedEventKey="ANCEK",h.preemptiveTokenRefreshEventKey="PTREK",(0,a.a)(h,"SessionStatusManager",null,[80])},1313:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(5149),o=n(5018),r=n(3245),s=n(2409),l=n(6915),c=n(7958);class d{add_authenticationLost(e){this._eventSource.addHandler("L",e)}remove_authenticationLost(e){this._eventSource.removeHandler("L",e)}add_authenticationRestored(e){this._eventSource.addHandler("R",e)}remove_authenticationRestored(e){this._eventSource.removeHandler("R",e)}get hasSubscribers(){return this._eventSource.hasSubscribers}get isAuthenticated(){return this.hasCookie()}hasCookie(){return!!s.a.get("PPLState")}authenticationCheck(){const e=this.hasCookie();if(e===this._hadCookie)return;let t;this._hadCookie?(t="L",i.ULS.sendTraceTag(5822149,200,50,"Authentication: Lost")):(t="R",i.ULS.sendTraceTag(5822150,200,50,"Authentication: Restored")),this._eventSource.raiseEvent(t,Sys.EventArgs.Empty,this),this._hadCookie=e}static get instance(){return d._instance||(d._instance=new d)}static performSignIn(){const e=r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx",t=new l.a(e);t.addParam("prompt","1"),r.AFrameworkApplication.addCommonUrlParameters(t),c.a.safelyOpenWindow(t.toString(),"LoginWindow",void 0,"SignOutResponse.PerfromSignIn")}constructor(){this._eventSource=new o.a,d._instance=this,this._hadCookie=this.hasCookie()}}d._instance=null,(0,a.a)(d,"SignOutResponse",null,[118])},7547:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(9858),o=n(1509);class r{equals(e){return!!e&&this.n===e.n&&this.guid.equals(e.guid)}toString(){return this._stringRepresentation||(this._stringRepresentation="{"+this.guid+"}{"+this.n+"}")}static create(){return!r._lastGuid||r._lastExtension>=255?(r._lastGuid=o.a.create(),r._lastExtension=1):r._lastExtension++,new r(r._lastGuid,r._lastExtension)}static indexOf(e,t){for(let n=0;n<e.length;n++)if(e[n].equals(t))return n;return-1}static createFromString(e){return new r(o.a.createFromString(i.a.substring(e,1,37)),parseInt(i.a.substring(e,39,e.length-1)))}static get nil(){return r._nil||(r._nil=new r(o.a.nil,0))}static areEqual(e,t){return e?e.equals(t):!t}constructor(e,t){this._stringRepresentation=null,this.guid=e,this.n=t}}r._nil=null,r._lastGuid=null,r._lastExtension=0,(0,a.a)(r,"ExtendedGuid",null,[])},2246:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(3245),o=n(6915),r=n(6362);class s{static urlForNamedObject(e,t=!1){if(!s._isInited)return null;const n=new o.a(s._serviceUrl);n.addParam("n",e),n.addParam("v",s._variation),n.addParam(i.AFrameworkApplication.userSessionIdQueryParam,i.AFrameworkApplication.userSessionId),i.AFrameworkApplication.buildVersion&&n.addFullParam(i.AFrameworkApplication.getBrowserBuildRequestQueryParam()),t&&n.addParam("DataUrlEnabled","true");return n.toString()+"&"+s._baseDocQueryParam+s._extraUrlParams}static initWithExtraUrlParameters(e,t,n,a){s.init(e,t,n),s._extraUrlParams=a}static getHeaders(){return s._headers}static initHeaders(e){s._headers||(s._headers={}),r.a.forEach(e,((e,t,n)=>{s._headers[e]=t}),null)}static init(e,t,n){s._isInited=!0,s._serviceUrl=e,s._variation=n,s._baseDocQueryParam=t}}s._serviceUrl=null,s._baseDocQueryParam=null,s._variation=null,s._extraUrlParams="",s._isInited=!1,s._headers=null,(0,a.a)(s,"NamedObject",null,[])},7296:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get priority(){return this._priority}get taskType(){return this._type}get interval(){return this._tickInterval}set interval(e){this._tickInterval=e}get idleTimeout(){return this._idleTaskTimeout}get loggingName(){return this.name?this.taskItemId.toString()+"_"+this.name:this.taskItemId.toString()}get acceptableTickRange(){return null!=this._acceptableTickRange?this._acceptableTickRange:this._taskManagerUtils?this._taskManagerUtils.getDefaultTaskAcceptableTickRange(this):0}set acceptableTickRange(e){this._acceptableTickRange=e}get lastProcessed(){return this._lastProcessed}get nextIntervalTime(){return this.lastProcessed+this.interval}get lastDelayTick(){return this._lastDelayTick}get queueTick(){return this._lastDelayTick+this._tickInterval}get isDeleted(){return this._deleted}set isDeleted(e){this._deleted=e}get taskItemId(){return this._taskItemId}generateTelemetryKey(){return this.taskItemId+"_"+this.priority}process(){this._lastProcessed=this._lastProcessed+this.interval,this._lastDelayTick=this.getTimeStamp()-this._lastProcessed,this._process&&this._process(this);const e=this.getTimeStamp();this._lastProcessed=Math.max(e,this._lastProcessed)}onEnqueue(e){this._taskManagerUtils=e,5!==this._priority||e&&e.isOnIdleTasksEnabled()||(this._priority=4),0===this.priority?this._lastProcessed=this.getTimeStamp():this._runImmediately?this._runImmediately=!1:this._lastProcessed=Math.max(this.getTimeStamp(),this._lastProcessed),this._deleted=!1}shouldOnIdleTaskBePromoted(e){if(5!==this.priority||this._idleTaskTimeout<=0)return!1;return e-this.nextIntervalTime>this._idleTaskTimeout}getTimeStamp(){return this._taskManagerUtils?this._taskManagerUtils.getTimeStamp():0}static create(e,t,n,a,o=0,r=null,s=!1){return new i(e,t,n,a,o,r,s,0)}static createOnIdle(e,t,n,a=0,o=0,r=null){return new i(5,e,t,n,o,r,!1,a)}constructor(e,t,n,a,i=0,o=null,r=!1,s=0){this._description=null,this._acceptableTickRange=null,this._lastDelayTick=0,this._deleted=!1,this._taskManagerUtils=null,this.customData=null,this.data=null,this._priority=e,this._type=t,this._tickInterval=n,this._process=a,this._runImmediately=r,this._lastProcessed=0,this._taskItemId=i,this.name=o,this._idleTaskTimeout=s}}(0,a.a)(i,"TaskItem",null,[])},657:function(e,t,n){"use strict";n.r(t),n.d(t,{TaskManager:function(){return w}});var a=n(100);class i{get isYielding(){return!1}get isRunning(){return!1}get isCallbackRunning(){return!1}set isCallbackRunning(e){}get hasStopped(){return!1}get timeToWaitAfterLastKeyStroke(){return 0}set timeToWaitAfterLastKeyStroke(e){}get runningTaskItemID(){return null}get yieldResponseOperation(){return null}get pendingTaskCount(){return 0}addTask(e){0}deleteTask(e){0}pause(){0}delayTasks(e){0}pauseForAnimation(e){0}resume(){0}yield(e){0}stop(){0}restart(){0}addAggregator(e,t){0}resetInterval(e,t){0}removeTasks(e){0}get maximumTimeOfOneCpuWakeUp(){return 0}set maximumTimeOfOneCpuWakeUp(e){}startToCollectTaskDetails(){}getDiagnosticStateForLogging(){return{}}add_onStartRunningForDiagnostics(e){}remove_onStartRunningForDiagnostics(e){}add_onStopRunningForDiagnostics(e){}remove_onStopRunningForDiagnostics(e){}}(0,a.a)(i,"NoOpTaskManager",null,[122]);var o=n(5149),r=n(5018),s=n(6984),l=n(5861);class c{getTimeStamp(){return l.a.getTickCount()}isOnIdleTasksEnabled(){return null==c._isOnIdleTasksEnabled&&(window.g_isOnIdleEnabled?c._isOnIdleTasksEnabled=l.a.requestIdleCallbackExists():c._isOnIdleTasksEnabled=!1),c._isOnIdleTasksEnabled}isOnIdleTasksDeadlineTelemetryEnabled(){return null==c._isOnIdleTasksDeadlineTelemetryEnabled&&(window.g_isOnIdleTasksDeadlineTelemetryEnabled?c._isOnIdleTasksDeadlineTelemetryEnabled=!0:c._isOnIdleTasksDeadlineTelemetryEnabled=!1),c._isOnIdleTasksDeadlineTelemetryEnabled}getDefaultTaskAcceptableTickRange(e){let t;const n=e.interval;return t=n<=1e3?0:n<=5e3?Math.floor(n/2):2500,t}static get defaultUtils(){return c._defaultInstance=c._defaultInstance?c._defaultInstance:new c,c._defaultInstance}}c._defaultInstance=null,c._isOnIdleTasksEnabled=null,c._isOnIdleTasksDeadlineTelemetryEnabled=null,(0,a.a)(c,"TaskManagerUtils",null,[507]);var d,u,p,g,h=n(2274),m=n(6915),_=n(1163),S=n(6776);class f{static sendBeaconTraceTag(e,t,n,a,...i){let r;try{r=i&&i.length?String.format.apply(null,[a].concat(i)):a}catch(e){o.ULS.sendTraceTag(525100375,383,10,"SendBeaconTraceTag failed to format message. Exception:{0}",e),r=a}if(_.a.browserSupportsSendBeacon()){const a={};a.message=r,a.eventId=e,a.categoryId=t,a.level=n,a.clientVersion=S.AFrameworkApplicationConstants.buildVersion,f.sendBeaconRequest("TraceMsg",a)}else o.ULS.sendTraceTag(e,t,n,r)}static sendBeaconRequest(e,t){const n=new m.a(f.beaconServiceUrl);n.addOrReplaceParam("WebMethod",e),n.addOrReplaceParam(S.AFrameworkApplicationConstants.userSessionIdQueryParam,S.AFrameworkApplicationConstants.userSessionId),n.addOrReplaceParam(S.AFrameworkApplicationConstants.noAuthQueryParam,"1");const a=JSON.stringify(t);try{window.navigator.sendBeacon(n.toString(),a),o.ULS.sendTraceTag(525100376,383,50,"SendBeaconRequest: succeeded, Url: {0}, PayloadIsNullOrUndefined: {1}",n.toString(),null==a)}catch(e){o.ULS.sendTraceTag(525100377,383,10,"SendBeaconRequest: failed, Reason: {0}, Url: {1}, PayloadIsNullOrUndefined: {2}",e.message||"Unknown",n.toString(),null==a)}}}f.beaconServiceUrl="BeaconService.ashx",(0,a.a)(f,"SendBeaconUtils",null,[]),function(e){e[e.defaultID=0]="defaultID",e[e.onTextEntered=1]="onTextEntered",e[e.authenticationCheck=2]="authenticationCheck",e[e.removeAriaRoleAttribute=3]="removeAriaRoleAttribute",e[e.delayedDispose=4]="delayedDispose",e[e.flush=5]="flush",e[e.closeApplication=6]="closeApplication",e[e.messageCallBack=7]="messageCallBack",e[e.pingTask=8]="pingTask",e[e.callbackProcess=9]="callbackProcess",e[e.styleSheetLoadTask=10]="styleSheetLoadTask",e[e.findSheet=11]="findSheet",e[e.uncaughtException=12]="uncaughtException",e[e.reenableBrowserClicks=13]="reenableBrowserClicks",e[e.onTouchAndHold=14]="onTouchAndHold",e[e.removeAttribute=15]="removeAttribute",e[e.retireNotification=16]="retireNotification",e[e.updateTop=17]="updateTop",e[e.toggleAnimationTask=18]="toggleAnimationTask",e[e.aggregatorTask=19]="aggregatorTask",e[e.downloadQueueTask=20]="downloadQueueTask",e[e.putApplicationToSleep=21]="putApplicationToSleep",e[e.processUpdate=22]="processUpdate",e[e.fixupAfterMagnifierDrag=23]="fixupAfterMagnifierDrag",e[e.hybridCleanup=24]="hybridCleanup",e[e.typingProcess=25]="typingProcess",e[e.delayUpdateGraphCallback=26]="delayUpdateGraphCallback",e[e.fixupAfterCursor=27]="fixupAfterCursor",e[e.updateCaretPosition=28]="updateCaretPosition",e[e.tryAriaNotifyParagraphLockedTask=29]="tryAriaNotifyParagraphLockedTask",e[e.debugRefreshActiveView=30]="debugRefreshActiveView",e[e.delayedMergeOperation=31]="delayedMergeOperation",e[e.onImageLoadRetry=32]="onImageLoadRetry",e[e.checkAndDeleteEphemeralOutline=33]="checkAndDeleteEphemeralOutline",e[e.regainFocus=34]="regainFocus",e[e.loadPage=35]="loadPage",e[e.renderVisibleOutlineGroupsTaskFired=36]="renderVisibleOutlineGroupsTaskFired",e[e.setInitialSelection=37]="setInitialSelection",e[e.scrollToParagraph=38]="scrollToParagraph",e[e.refreshAuthorInfoRenderers=39]="refreshAuthorInfoRenderers",e[e.refreshOutlineSize=40]="refreshOutlineSize",e[e.restoreAfterCursoring=41]="restoreAfterCursoring",e[e.run=42]="run",e[e.aReplicationScheduler=43]="aReplicationScheduler",e[e.enableAccessibilityNotifications=44]="enableAccessibilityNotifications",e[e.updateCommandUI=45]="updateCommandUI",e[e.makeRequest=46]="makeRequest",e[e.deferredUnloadUnusedGraphspaces=47]="deferredUnloadUnusedGraphspaces",e[e.recheckParagraphTask=48]="recheckParagraphTask",e[e.retryCurrentRequest=49]="retryCurrentRequest",e[e.initialRecordProcess=50]="initialRecordProcess",e[e.find=51]="find",e[e.findInternal=52]="findInternal",e[e.processDirtyNodes=53]="processDirtyNodes",e[e.highlightPages=54]="highlightPages",e[e.search=55]="search",e[e.hideToolTip=56]="hideToolTip",e[e.presenceUpdated=57]="presenceUpdated",e[e.updateNotificationTask=58]="updateNotificationTask",e[e.retryCheckUserRoamingRights=59]="retryCheckUserRoamingRights",e[e.docxSaveMonitor=60]="docxSaveMonitor",e[e.anonymousCreationSignInWarning=61]="anonymousCreationSignInWarning",e[e.findCurrentPageFromIp=62]="findCurrentPageFromIp",e[e.wordCountTask=63]="wordCountTask",e[e.activityAggregation=64]="activityAggregation",e[e.activityLoggingThrottler=65]="activityLoggingThrottler",e[e.selectionWordCountTask=66]="selectionWordCountTask",e[e.activityAutoEnd=67]="activityAutoEnd",e[e.flattenRevisions=68]="flattenRevisions",e[e.triggerSaveProofingInfo=69]="triggerSaveProofingInfo",e[e.renderPresenceUpdates=70]="renderPresenceUpdates",e[e.renderRttUpdates=71]="renderRttUpdates",e[e.onScrollRenderPresenceUpdates=72]="onScrollRenderPresenceUpdates",e[e.hideChatToast=73]="hideChatToast",e[e.proofingResume=74]="proofingResume",e[e.replicateActivityContainerNode=75]="replicateActivityContainerNode",e[e.focusOnLatestActivity=76]="focusOnLatestActivity",e[e.notebookSearch=77]="notebookSearch",e[e.taskCallback=78]="taskCallback",e[e.logPlt=79]="logPlt",e[e.persistentStateUpdated=80]="persistentStateUpdated",e[e.persistentStateClearedEvent=81]="persistentStateClearedEvent",e[e.contentControlRemoveWhenEditTask=82]="contentControlRemoveWhenEditTask",e[e.augLoopFirePreparedEventsForClientLambdas=83]="augLoopFirePreparedEventsForClientLambdas",e[e.nodeTraverserTask=84]="nodeTraverserTask",e[e.switchToContentSyncAfterSectionCreation=85]="switchToContentSyncAfterSectionCreation",e[e.oneNoteContentOutboundTask=86]="oneNoteContentOutboundTask",e[e.resumeAssistantTileBatchingTask=87]="resumeAssistantTileBatchingTask",e[e.activityUpdate=88]="activityUpdate",e[e.fileNameChecker=89]="fileNameChecker",e[e.powerPointDefaultID=90]="powerPointDefaultID",e[e.clientRequestManagerTimeoutCallbackProcess=91]="clientRequestManagerTimeoutCallbackProcess",e[e.officeSharedCommentsUtilsAddedTask=92]="officeSharedCommentsUtilsAddedTask",e[e.waitForFeedbackPackageDownload=93]="waitForFeedbackPackageDownload",e[e.clientRequestWithRetryRequest=94]="clientRequestWithRetryRequest",e[e.packageLifecycleManagerScheduleTask=95]="packageLifecycleManagerScheduleTask",e[e.requestPostBootAppSettings=96]="requestPostBootAppSettings",e[e.tellMeCachedRefreshMenuTask=97]="tellMeCachedRefreshMenuTask",e[e.requestTokensOnce=98]="requestTokensOnce",e[e.dummyTask=99]="dummyTask",e[e.checkToMakeSureDialogWasOpened=100]="checkToMakeSureDialogWasOpened",e[e.switchToBackupMode=101]="switchToBackupMode",e[e.determineLogsToSendOnReconnect=102]="determineLogsToSendOnReconnect",e[e.determineLogsToSendAtBoot=103]="determineLogsToSendAtBoot",e[e.sendOfflineLogs=104]="sendOfflineLogs",e[e.sendOfflineLogsV2=105]="sendOfflineLogsV2",e[e.createNewActorLogThumbnailPerfData=106]="createNewActorLogThumbnailPerfData",e[e.retryHelperStartNextRetryTask=107]="retryHelperStartNextRetryTask",e[e.inactivityManagerInactiveLoop=108]="inactivityManagerInactiveLoop",e[e.readFromMruTask=109]="readFromMruTask",e[e.fileUploaderReplicatePlaceholder=110]="fileUploaderReplicatePlaceholder",e[e.userActivityHostNotification=111]="userActivityHostNotification",e[e.userActivityHostNotificationRegister=112]="userActivityHostNotificationRegister",e[e.editNotification=113]="editNotification",e[e.firstRunExperienceUIManagerOnBlurTask=114]="firstRunExperienceUIManagerOnBlurTask",e[e.chatClientFactoryOnAvailablityChanged=115]="chatClientFactoryOnAvailablityChanged",e[e.afoApiAdapterTask=116]="afoApiAdapterTask",e[e.startDownloadFirstSlice=117]="startDownloadFirstSlice",e[e.consolidatedDataChangedEventTask=118]="consolidatedDataChangedEventTask",e[e.updateTableDOMElements=119]="updateTableDOMElements",e[e.deleteEphemeralOutline=120]="deleteEphemeralOutline",e[e.workspaceUpdateTask=121]="workspaceUpdateTask",e[e.aInteractiveViewShowFloatie=122]="aInteractiveViewShowFloatie",e[e.richTextContentControlAcetateAcetate=123]="richTextContentControlAcetateAcetate",e[e.picturePasteRequestSucceeded=124]="picturePasteRequestSucceeded",e[e.box4ImageStewardForceInboundSucceeded=125]="box4ImageStewardForceInboundSucceeded",e[e.editingViewUpdates=126]="editingViewUpdates",e[e.waitForSlice1AndFullCheck=127]="waitForSlice1AndFullCheck",e[e.yieldOperation=128]="yieldOperation",e[e.floatingCommentManagerDoUpdate=129]="floatingCommentManagerDoUpdate",e[e.intelligentPlaceholderProcessSelectionChange=130]="intelligentPlaceholderProcessSelectionChange",e[e.augLoopFirePreparedEventsForOperations=131]="augLoopFirePreparedEventsForOperations",e[e.abortLongRunningGetCells=132]="abortLongRunningGetCells",e[e.setTimeout=133]="setTimeout",e[e.setInterval=134]="setInterval",e[e.logSessionStatus=135]="logSessionStatus",e[e.commentManagerSetSelection=136]="commentManagerSetSelection",e[e.commentModelUpdateCommentFloatingContainer=137]="commentModelUpdateCommentFloatingContainer",e[e.zoomToPageWidth=138]="zoomToPageWidth",e[e.dhcDeletionOnResolve=139]="dhcDeletionOnResolve",e[e.startDownloadCollabSlice=140]="startDownloadCollabSlice",e[e.cudIntentsForAnnotations=141]="cudIntentsForAnnotations",e[e.clearAnnotationStorageTask=142]="clearAnnotationStorageTask",e[e.reseedTask=143]="reseedTask",e[e.transformationSuggestionTask=144]="transformationSuggestionTask",e[e.clientPagination=145]="clientPagination",e[e.canvasContextualUxManagerDelayShow=146]="canvasContextualUxManagerDelayShow",e[e.canvasContextualUxManagerUpdateTargetAnchor=147]="canvasContextualUxManagerUpdateTargetAnchor",e[e.canvasContextualRedrawInitialSuggestions=148]="canvasContextualRedrawInitialSuggestions",e[e.canvasContextualTooltipSelectionChangeHandler=149]="canvasContextualTooltipSelectionChangeHandler",e[e.canvasContextualSuggestionAcceptFadeOut=150]="canvasContextualSuggestionAcceptFadeOut",e[e.canvasContextualSuggestionAcceptClear=151]="canvasContextualSuggestionAcceptClear",e[e.neuralRewriteServiceTimeoutCheck=152]="neuralRewriteServiceTimeoutCheck",e[e.intelligentPlaceholderAutoOpenPane=153]="intelligentPlaceholderAutoOpenPane",e[e.floatingCommentsSuppressPositioningOnScroll=154]="floatingCommentsSuppressPositioningOnScroll",e[e.memoryProfileTelemetry=155]="memoryProfileTelemetry",e[e.clientPaginationUpdatePageEnds=156]="clientPaginationUpdatePageEnds",e[e.visibilityManager=157]="visibilityManager",e[e.updatePersistedAnnotationRanges=158]="updatePersistedAnnotationRanges",e[e.applyFormatPainter=159]="applyFormatPainter",e[e.logHangs=160]="logHangs",e[e.logCrashes=161]="logCrashes",e[e.designerFixInconsistencies=162]="designerFixInconsistencies",e[e.designerApplyTheme=163]="designerApplyTheme",e[e.refreshAppSettings=164]="refreshAppSettings",e[e.findRenderableIndicators=165]="findRenderableIndicators",e[e.showAdornmentText=166]="showAdornmentText",e[e.designerAcceptAll=167]="designerAcceptAll",e[e.designerRejectAll=168]="designerRejectAll",e[e.designerReviewChanges=169]="designerReviewChanges",e[e.measurePerfInPagination=170]="measurePerfInPagination",e[e.designerAccept=171]="designerAccept",e[e.designerReject=172]="designerReject",e[e.lockFlightLogging_Deprecated=173]="lockFlightLogging_Deprecated",e[e.canvasContextualHoverInvoke=174]="canvasContextualHoverInvoke",e[e.logStaleDeepLinkComment=175]="logStaleDeepLinkComment",e[e.setChangeSummariesRequestTimeout=176]="setChangeSummariesRequestTimeout",e[e.smartLookupTokenRefresh=177]="smartLookupTokenRefresh",e[e.updateStatusBarEmergencyViewItem=178]="updateStatusBarEmergencyViewItem",e[e.pollViabilityForEmergencyView=179]="pollViabilityForEmergencyView",e[e.showEmergencyViewCallout=180]="showEmergencyViewCallout",e[e.showTooltipForIndicator=181]="showTooltipForIndicator",e[e.catchUpBeginDocumentTraversal=182]="catchUpBeginDocumentTraversal",e[e.textPredictionSaveRoamingSetting=183]="textPredictionSaveRoamingSetting",e[e.textPredictionLocalPredictionInit=184]="textPredictionLocalPredictionInit",e[e.textPredictionLocalPredictionContext=185]="textPredictionLocalPredictionContext",e[e.textPredictionLocalPredictionPredict=186]="textPredictionLocalPredictionPredict",e[e.textPredictionTriggerSurvey=187]="textPredictionTriggerSurvey",e[e.textPredictionTelemetry=188]="textPredictionTelemetry",e[e.paginatedDisplayUpdate=189]="paginatedDisplayUpdate",e[e.changeDesignerRole=190]="changeDesignerRole",e[e.rerenderDocumentForModifyStyle=191]="rerenderDocumentForModifyStyle",e[e.rtcHostNotificationSubscribe=192]="rtcHostNotificationSubscribe",e[e.signalAggregatorTask=193]="signalAggregatorTask",e[e.rtcHostNotificationTransitionToPolling=194]="rtcHostNotificationTransitionToPolling",e[e.grammarSuggestionsLogActivityTask=195]="grammarSuggestionsLogActivityTask",e[e.updateExternalContentFloatiePosition=196]="updateExternalContentFloatiePosition",e[e.updateMru=197]="updateMru",e[e.rerenderDocumentForModifyDefaultTabStop=198]="rerenderDocumentForModifyDefaultTabStop",e[e.paginatedViewportManagement=199]="paginatedViewportManagement",e[e.editorsTableNotificationHandlerCleanup=200]="editorsTableNotificationHandlerCleanup",e[e.queueApplyTrackChangeConfirmationTask=201]="queueApplyTrackChangeConfirmationTask",e[e.applyTrackChangeConfirmationTask=202]="applyTrackChangeConfirmationTask",e[e.externalContentAddImageBlobSucceeded=203]="externalContentAddImageBlobSucceeded",e[e.externalContentEditorForceInboundSucceeded=204]="externalContentEditorForceInboundSucceeded",e[e.networkNavigatorPollTask=205]="networkNavigatorPollTask",e[e.dismissFastView=206]="dismissFastView",e[e.dismissSplashScreen=207]="dismissSplashScreen",e[e.revertDesignerTheme=208]="revertDesignerTheme",e[e.reRenderDocumentForListDefinitionUpdate=209]="reRenderDocumentForListDefinitionUpdate",e[e.initialNumberingTask=210]="initialNumberingTask",e[e.designerSnoozeContextualSuggestions=211]="designerSnoozeContextualSuggestions",e[e.runawayDataLossMonitor=212]="runawayDataLossMonitor",e[e.disableDesignerPasteOption=213]="disableDesignerPasteOption",e[e.otelLoadWebWorker=214]="otelLoadWebWorker",e[e.updatePasteFloatiePosition=215]="updatePasteFloatiePosition",e[e.wordEditorWatchDogManager=216]="wordEditorWatchDogManager",e[e.unsubscribeSmartPasteFromAugloop=217]="unsubscribeSmartPasteFromAugloop",e[e.refitToPageWidthOnCommentPaneToggle=218]="refitToPageWidthOnCommentPaneToggle",e[e.attemptToCaptureHtmlCanvasView=219]="attemptToCaptureHtmlCanvasView",e[e.attemptToSaveHtmlCanvasViewToCache=220]="attemptToSaveHtmlCanvasViewToCache",e[e.noActionTrackChangeDismissTracker=221]="noActionTrackChangeDismissTracker",e[e.renderNativePrintout=222]="renderNativePrintout",e[e.renderInNextAnimationFrame=223]="renderInNextAnimationFrame",e[e.pptoAddMRUFont=224]="pptoAddMRUFont",e[e.loadContentIntoGraphSpaceNode=225]="loadContentIntoGraphSpaceNode",e[e.pptoDesignerAction=226]="pptoDesignerAction",e[e.fidelityCompatibilityViewTransitionTimeout=228]="fidelityCompatibilityViewTransitionTimeout",e[e.pptoCloseTextEditView=229]="pptoCloseTextEditView",e[e.dismissCanvasSkeletalUX=230]="dismissCanvasSkeletalUX",e[e.wordInvalidateBreakVisiMarkers=233]="wordInvalidateBreakVisiMarkers",e[e.wordCopilotCursorSuggestionsUpdatePosition=234]="wordCopilotCursorSuggestionsUpdatePosition",e[e.autoSaveToastShownResetTask=235]="autoSaveToastShownResetTask",e[e.citationsFloodgateSurveyTask=236]="citationsFloodgateSurveyTask",e[e.floodgateSurveyForAutoRenameSentiment=237]="floodgateSurveyForAutoRenameSentiment",e[e.floodgateSurveyForNewThemes=238]="floodgateSurveyForNewThemes",e[e.canvasCacheAppLoadMetricReport=239]="canvasCacheAppLoadMetricReport",e[e.browserSideCacheCleanup=240]="browserSideCacheCleanup",e[e.launchCacheView=241]="launchCacheView",e[e.canvasCacheRemover=242]="canvasCacheRemover",e[e.navigationPaneFocusTask=243]="navigationPaneFocusTask",e[e.insertFileUploaderToastDismissTask=244]="insertFileUploaderToastDismissTask",e[e.checklistFloodgateSurveyTask=245]="checklistFloodgateSurveyTask",e[e.tableCellResizeFromRibbonFPS=246]="tableCellResizeFromRibbonFPS",e[e.openPersonalizedSettingsDialog=247]="openPersonalizedSettingsDialog",e[e.initializeInteractivityTracker=248]="initializeInteractivityTracker",e[e.helpTeachingCallout=249]="helpTeachingCallout",e[e.uploadFromPCPackageProxy_loadUploadFromPCJs=250]="uploadFromPCPackageProxy_loadUploadFromPCJs",e[e.miniTemplateIndicatorPackageProxy_loadMiniTemplateIndicatorJs=251]="miniTemplateIndicatorPackageProxy_loadMiniTemplateIndicatorJs",e[e.emitFidelityMetric=252]="emitFidelityMetric",e[e.showMiniTemplateOptionsInRibbon=253]="showMiniTemplateOptionsInRibbon",e[e.onDemandPackageLoadingTask=254]="onDemandPackageLoadingTask"}(d||(d={})),(0,a.b)("TaskItemID",d),function(e){e[e.realtime=0]="realtime",e[e.aboveNormal=1]="aboveNormal",e[e.normal=2]="normal",e[e.background=3]="background",e[e.low=4]="low",e[e.onIdle=5]="onIdle",e[e.lastPriority=6]="lastPriority",e[e.customized=7]="customized"}(u||(u={})),(0,a.b)("TaskItemPriority",u),function(e){e[e.oneShot=1]="oneShot",e[e.continuous=2]="continuous"}(p||(p={})),(0,a.b)("TaskItemType",p);class C{constructor(e){this.TI=d[e.taskItemId],this.TT=p[e.taskType],this.TP=u[e.priority],this.TC=0,this.SC=0,this.TD=0,this.TN=e.name}}(0,a.a)(C,"TaskItemTelemetry",null,[]);class y{static get LoggingForTaskManagerEnabled(){return null!=y.__cached_LoggingForTaskManagerEnabled_0_24cf60aa?y.__cached_LoggingForTaskManagerEnabled_0_24cf60aa:y.__cached_LoggingForTaskManagerEnabled_0_24cf60aa=h.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LoggingForTaskManagerEnabled",!1)}static get addingBeforeUnloadListener(){return null!=y.__cached_addingBeforeUnloadListener_1_24cf60aa?y.__cached_addingBeforeUnloadListener_1_24cf60aa:y.__cached_addingBeforeUnloadListener_1_24cf60aa=(window.addEventListener("beforeunload",g.logAddedTaskToTaskManager),g.LoggingForTaskManagerEnabled)}static get isLoggingForSlowTasksEnabled(){return null!=y.__cached_isLoggingForSlowTasksEnabled_2_24cf60aa?y.__cached_isLoggingForSlowTasksEnabled_2_24cf60aa:y.__cached_isLoggingForSlowTasksEnabled_2_24cf60aa=(()=>{const e=g.LoggingForTaskManagerEnabled&&h.AFrameworkApplication_AppSettingsManager.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.LoggingForSlowTasksInTaskManagerEnabled");return e&&window.addEventListener("beforeunload",g.logSlowTasks),e})()}static recordAndProcessTask(e){let t=0;if(g.LoggingForTaskManagerEnabled&&(t=performance.now()),e.process(),g.LoggingForTaskManagerEnabled){const n=e.generateTelemetryKey(),a=this.taskItemLogMap[n];if(a){const e=performance.now(),n=e-t;a.TD+=n,g.isLoggingForSlowTasksEnabled&&n>=100&&(a.SC++,this.addToSlowTasks(a,t,e))}}}static recordTaskItemDetailsForLogging(e){var t;if(!g.LoggingForTaskManagerEnabled)return;const n=e.generateTelemetryKey();n&&g.addingBeforeUnloadListener&&((t=this.taskItemLogMap)[n]||(t[n]=new C(e))).TC++}static addToSlowTasks(e,t,n){g.slowTasksTelemetry.push({...e,startMs:t,endMs:n}),g.slowTasksTelemetry.length>100&&window.requestIdleCallback(g.logSlowTasks)}}g=y,y.taskItemLogMap={},y.slowTasksTelemetry=[],y.logAddedTaskToTaskManager=()=>{if(g.taskItemLogMap){const t=(e=g.taskItemLogMap,Object.values(e)),n=JSON.stringify(t);f.sendBeaconTraceTag(506523905,218,50,`TaskManager: TaskItem Details :${n}`)}var e},y.logSlowTasks=()=>{f.sendBeaconTraceTag(506012128,218,20,JSON.stringify(g.slowTasksTelemetry)),g.slowTasksTelemetry=[]},(0,a.a)(y,"TaskManagerPerfMonitor",null,[]);const A="OnStartRunningForDiagnostics",b="OnStopRunningForDiagnostics";class T{registerListener(e){this._listeners.push(e)}unregisterListener(e){Array.remove(this._listeners,e)}notifyOnBeforeTask(e){this._listeners.forEach((t=>t.onBeforeTask(e)))}notifyOnCrashedTask(e,t){this._listeners.forEach((n=>n.onCrashedTask(e,t)))}notifyOnAfterTask(e){this._listeners.forEach((t=>t.onAfterTask(e)))}dispose(){this._disposed=!0,this._disposedSince=new Date,this._queues=[[],[],[],[],[],[],[]],this.updateNextWakeUpIfNecessary()}get isYielding(){return this._isYielding}get yieldOperation(){return this._yieldOperation}get isRunning(){return this._isRunning||this._isCallbackRunning}get isCallbackRunning(){return this._isCallbackRunning}set isCallbackRunning(e){this._isCallbackRunning=e,!this._callbackRunningSince&&e?this._callbackRunningSince=new Date:e||(this._callbackRunningSince=null)}get hasStopped(){return this._hasStopped}get timeToWaitAfterLastKeyStroke(){return this._timeToWaitAfterLastKeyStroke}set timeToWaitAfterLastKeyStroke(e){this._timeToWaitAfterLastKeyStroke=e}get runningTaskItemID(){return this._runningTaskItemID}get yieldResponseOperation(){return this._yieldResponseOperation}get yieldOperationName(){return this.yieldOperation?this.yieldOperation.operationName:null}get pendingTaskCount(){return this._queues.reduce(((e,t)=>e+t.length),0)}get isLoggingPendingTaskCountsEnabled(){return null!=this.__cached_isLoggingPendingTaskCountsEnabled_0_483074d2?this.__cached_isLoggingPendingTaskCountsEnabled_0_483074d2:this.__cached_isLoggingPendingTaskCountsEnabled_0_483074d2=h.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanAppSetting("LogPendingTaskCountsInTaskManagerEnabled")}logPendingTaskCounts(){if(this.isLoggingPendingTaskCountsEnabled){const e=h.AFrameworkApplication_AppSettingsManager.appSettingsManager.getIntAppSetting("LogPendingTaskSamplingTimeGap",3e4);if(Date.now()-this._lastTimeTaskQueueLengthLogged>e){const e=[];for(let t=0;t<this._queues.length;++t)e.push({type:t,length:this._queues[t].length});o.ULS.sendTraceTag(508122908,218,50,`TaskManager: Queue Status :${JSON.stringify(e)}`),this._lastTimeTaskQueueLengthLogged=Date.now()}}}get pauseRef(){return this._pauseRef}get resumeTasksTimeoutId(){return this._resumeTasksTimeoutId}get componentName(){return 4}get componentDependencies(){return this._componentDependencies}addTask(e){if(this._disposed)o.ULS.sendTraceTag(7078544,218,15,"TaskManager: Not adding task as it has been disposed. {0}",{Id:e.taskItemId,Name:e.name});else{if(!(e.isDeleted&&Array.indexOf(this._queues[e.priority],e)>=0)){let t=e.priority;this._taskManagerUtils.isOnIdleTasksEnabled()||5!==e.priority||(t=4),Array.add(this._queues[t],e)}y.recordTaskItemDetailsForLogging(e),e.onEnqueue(this._taskManagerUtils),this.hasStopped&&o.ULS.sendTraceTag(7078545,218,50,"TaskManager: Added task when TaskManager is stopped. {0}",{Id:e.taskItemId}),this.updateNextWakeUpIfNecessary(),this._startToCollectTaskDetails&&this._cpuMeter.onTaskAdded(e)}}deleteTask(e){if(this._disposed)return void 0;if(e.isDeleted=!0,this._isProcessing&&this._processingQueue===e.priority)return void(this._pendingDeletes=!0);const t=Array.indexOf(this._queues[e.priority],e);t>-1&&(t<=this._lastProcessedTasks[e.priority]&&this._lastProcessedTasks[e.priority]--,Array.removeAt(this._queues[e.priority],t)),this.updateNextWakeUpIfNecessary()}processOnIdleTasks(e){if(!this._taskManagerUtils.isOnIdleTasksEnabled())return;if(this._requestIdleCallbackId=0,!this.canProcessTasks())return;if(this._isProcessing)return void this.requestIdleCallback();const t=this._taskManagerUtils.getTimeStamp();this._cpuMeter.onBeforeProcess(),this._isProcessing=!0,this._processingSince||(this._processingSince=new Date),this._processingQueue=5,this.processQueueTasks(this._processingQueue,!1,t,e),this._isProcessing=!1,this._processingQueue=-1,this._processingSince=null,this._cpuMeter.onAfterProcess(),this.updateNextWakeUpIfNecessary()}requestIdleCallback(){this._taskManagerUtils.isOnIdleTasksEnabled()&&(this._requestIdleCallbackId||(this._requestIdleCallbackId=T._originalRequestIdleCallback((e=>{this.processOnIdleTasks(e.timeRemaining())}),null)))}cancelIdleCallbackIfScheduled(){this._taskManagerUtils.isOnIdleTasksEnabled()&&this._requestIdleCallbackId>0&&(T._originalCancelIdleCallback(this._requestIdleCallbackId),this._requestIdleCallbackId=0)}callProcessTask(e){this._isRunning=!0,this.raiseOnStartRunningForDiagnostics(),this.notifyOnBeforeTask(e),this._runningSince||(this._runningSince=new Date);try{this._runningTaskItemID=e.taskItemId,this._processingTask=e,this._cpuMeter.profileTopLevelTask((()=>y.recordAndProcessTask(e)),e.loggingName,Math.round(e.lastDelayTick),e)}catch(t){throw this.notifyOnCrashedTask(e,t),t}finally{this._runningTaskItemID=null,this._isRunning=!1,this.raiseOnStopRunningForDiagnostics(),this.notifyOnAfterTask(e),this._runningSince=null}}shouldTaskBeExecuted(e,t,n){return!(!e||e.isDeleted)&&(n?e.shouldOnIdleTaskBePromoted(t):t+e.acceptableTickRange>e.nextIntervalTime)}lastUserKeystrokeTimestamp(){return this._keyInputManager&&this._keyInputManager.lastKeyStroke?this._keyInputManager.lastKeyStrokeTimestamp:0}processQueueTasks(e,t,n,a){let i=this._queues[e].length;if(!i)return a;this._processingQueue=e;const o=this._queues[e];let r=this._lastProcessedTasks[e],s=i;do{r+=1,r=r>=i?0:r;const e=o[r];if(this.shouldTaskBeExecuted(e,n,t)){new Date;const t=this._taskManagerUtils.getTimeStamp();2!==e.taskType&&(Array.removeAt(o,r),i--,r--),this.callProcessTask(e);const n=this._taskManagerUtils.getTimeStamp()-t;a-=n,this.updateAggregator(e.taskItemId,Math.round(n))}s--}while(i>0&&s>0&&a>0);return this._lastProcessedTasks[e]=r,this._processingQueue=-1,a}cleanupQueuePendingDeletedTasks(e){if(!this._pendingDeletes)return;let t=this._lastProcessedTasks[e];const n=this._queues[e];for(let e=0;e<n.length;e++){n[e].isDeleted&&(Array.removeAt(n,e),e<=t&&t--,e--)}this._pendingDeletes=!1,this._lastProcessedTasks[e]=t}pause(){this.pauseRef||(this._pausedSince=new Date),this._pauseRef=this.pauseRef+1,this.updateNextWakeUpIfNecessary()}delayTasks(e){-1===this.resumeTasksTimeoutId?this.pause():T._originalClearTimeout(this.resumeTasksTimeoutId),this._resumeTasksTimeoutId=T._originalSetTimeout((()=>this.delayEnableTasks()),e)}delayEnableTasks(){this._resumeTasksTimeoutId=-1,this.resume()}pauseForAnimation(e){this.pause(),T._originalSetTimeout((()=>this.afterAnimationPause()),e)}afterAnimationPause(){this.resume()}resume(){this._pauseRef=this.pauseRef-1,this.pauseRef<0&&(this._pauseRef=0),this.pauseRef||(this._pausedSince=null),this.updateNextWakeUpIfNecessary()}yield(e){this.isYielding&&o.ULS.sendTraceTag(7078546,218,15,"TaskManager: Yield was called when already yielding"),this._isYielding=!0,this._yieldingSince||(this._yieldingSince=new Date),this._yieldOperation=e,T._originalSetTimeout(this.yieldResponse,0),this.updateNextWakeUpIfNecessary()}isCurrentlyDeactivated(){return this.isYielding||this.hasStopped||this._disposed||this.pauseRef>0}canProcessTasks(){return!this.isCurrentlyDeactivated()}stop(){this._hasStopped=!0,this._stoppedSince||(this._stoppedSince=new Date),this.updateNextWakeUpIfNecessary()}restart(){this.hasStopped&&!this._disposed&&(this._hasStopped=!1,this._stoppedSince=null,this.updateNextWakeUpIfNecessary())}resetInterval(e,t,n){const a=this._queues[e.priority],i=Array.indexOf(a,e);-1!==i?(a[i].interval=t,a[i].acceptableTickRange=n,a[i].onEnqueue(this._taskManagerUtils),this.updateNextWakeUpIfNecessary()):o.ULS.sendTraceTag(7078547,218,15,"TaskManager: Can't reset interval for task because it's not present in the taskmanager. {0}",{Id:e.taskItemId})}addAggregator(e,t){this._taskAggregators.set(e,t)}removeTasks(e){for(const t of this._queues)for(let n=t.length-1;n>=0;n--){const a=t[n];e(a)&&this.deleteTask(a)}}startToCollectTaskDetails(){this._startToCollectTaskDetails=!0}updateAggregator(e,t){const n=this._taskAggregators.get(e);n&&n.track(t,e.toString())}updateNextWakeUpIfNecessary(){if(this._isProcessing||this._isRunning)return void 0;if(this.isCurrentlyDeactivated())return this.clearTimeoutInternalIfSet(),void this.cancelIdleCallbackIfScheduled();const e=this.lastUserKeystrokeTimestamp(),t=this._taskManagerUtils.getTimeStamp();let n=-1,a=-1,i=!1,o=!1,r=!1;for(let e=0;e<7;e++)for(let s=0;s<this._queues[e].length;s++){const l=this._queues[e][s];if(!l||l.isDeleted)Array.removeAt(this._queues[e],s),s--;else{const e=l.nextIntervalTime-t;if(this._taskManagerUtils.isOnIdleTasksEnabled()&&5===l.priority&&!l.shouldOnIdleTaskBePromoted(t)){r=r||e<10;continue}(!i||e<n)&&(n=e,i=!0),0===l.priority&&(!o||e<a)&&(a=e,o=!0)}}if(r?this.requestIdleCallback():this.cancelIdleCallbackIfScheduled(),!i)return void this.clearTimeoutInternalIfSet();const s=e+this.timeToWaitAfterLastKeyStroke-t;n<s&&(n=s),o&&n>a&&(n=a),n<0&&(n=0),n<10&&(n=0),this.clearTimeoutInternalIfSet();const l=Math.round(n);this._timerId=T._originalSetTimeout(this.process,l),this._timerSet=!0;const c=new Date;this._timerSetSince||(this._timerSetSince=c),this._timerSetAt=c,this._timerLength=l}clearTimeoutInternalIfSet(){this._timerSet&&(T._originalClearTimeout(this._timerId),this._timerSet=!1,this._timerSetSince=null,this._timerLength=-1)}getQueueLength(e){return this._queues[e].length}getDiagnosticStateForLogging(){const e={};this.pauseRef>0&&(e.PA=1,this._pausedSince&&(e.PAS=this._pausedSince.toISOString())),this.isYielding&&(e.Y=1,this._yieldingSince&&(e.YS=this._yieldingSince.toISOString()),e.YC=this.yieldOperation.getOperationChainDescription()),this.hasStopped&&(e.S=1,this._stoppedSince&&(e.SS=this._stoppedSince.toISOString())),this._disposed&&(e.D=1,this._disposedSince&&(e.DS=this._disposedSince.toISOString())),this._isProcessing&&(e.PR=1,this._processingSince&&(e.PRS=this._processingSince.toISOString())),this._isRunning&&(e.R=1,this._runningSince&&(e.RS=this._runningSince.toISOString())),this._timerSet&&(e.TS=1,this._timerSetSince&&(e.TSS=this._timerSetSince.toISOString()),this._timerSetAt&&(e.TSA=this._timerSetAt.toISOString()),e.TI=this._timerId,e.TL=this._timerLength),this._isCallbackRunning&&(e.ICR=1,this._callbackRunningSince&&(e.ICRS=this._callbackRunningSince.toISOString()));const t={};for(let e=0;e<this._queues.length;e++){const n=this._queues[e];n&&(t["Q"+e]=n.length)}return e.Q=t,null!=this.runningTaskItemID&&(e.RTID=this.runningTaskItemID),e}add_onStartRunningForDiagnostics(e){this._eventSource.addHandler(A,e)}remove_onStartRunningForDiagnostics(e){this._eventSource.removeHandler(A,e)}add_onStopRunningForDiagnostics(e){this._eventSource.addHandler(b,e)}remove_onStopRunningForDiagnostics(e){this._eventSource.removeHandler(b,e)}raiseOnStartRunningForDiagnostics(){h.AFrameworkApplication_AppSettingsManager.appSettingsManager&&h.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("TaskManagerEventingIsEnabled")&&this._eventSource.raiseEvent(A)}raiseOnStopRunningForDiagnostics(){h.AFrameworkApplication_AppSettingsManager.appSettingsManager&&h.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("TaskManagerEventingIsEnabled")&&this._eventSource.raiseEvent(b)}static createTaskManagerImpl(){const{KeyInputManagerHelper:e}=n(3026);return new T(s.a.instance,e.instance,c.defaultUtils)}static keepOriginalWindowFunc(){if(!T._isOriginalWindowFuncSet){const e=window.setTimeout,t=window.clearTimeout;if(T._originalSetTimeout=(t,n)=>e(t,n),T._originalClearTimeout=e=>{t(e)},c.defaultUtils.isOnIdleTasksEnabled()){const e=window.requestIdleCallback,t=window.cancelIdleCallback;T._originalRequestIdleCallback=(t,n)=>e(t,n),T._originalCancelIdleCallback=e=>{t(e)}}T._isOriginalWindowFuncSet=!0}}constructor(e,t,n){this._listeners=[],this._disposed=!1,this._isProcessing=!1,this._processingQueue=0,this._eventSource=new r.a,this._queues=[[],[],[],[],[],[],[]],this._lastProcessedTasks=[-1,-1,-1,-1,-1,-1,-1],this._pendingDeletes=!1,this._pausedSince=null,this._yieldingSince=null,this._stoppedSince=null,this._disposedSince=null,this._callbackRunningSince=null,this._timerSetAt=null,this._timerSetSince=null,this._processingSince=null,this._processingTask=null,this._lastTimeTaskQueueLengthLogged=0,this._runningSince=null,this._timerLength=0,this._isRunning=!1,this._isCallbackRunning=!1,this._taskAggregators=new Map,this._timerId=0,this._requestIdleCallbackId=0,this._startToCollectTaskDetails=!1,this._isYielding=!1,this._yieldOperation=null,this._hasStopped=!1,this._runningTaskDescription=null,this._isTTVRAchieved=!1,this._runningTaskItemID=null,this._yieldResponseOperation=null,this._pauseRef=0,this._resumeTasksTimeoutId=-1,this._componentDependencies=null,this.process=()=>{this.logPendingTaskCounts(),this._timerSet=!1,this._timerSetAt=null,this._timerSetSince=null;const e=this._taskManagerUtils.getTimeStamp();if(!this.canProcessTasks())return;let t=this.maximumTimeOfOneCpuWakeUp;const n=e-this.lastUserKeystrokeTimestamp()<this.timeToWaitAfterLastKeyStroke,a=this._queues[0].length>0;if(!n||a){this._cpuMeter.onBeforeProcess(),this._isProcessing=!0,this._processingSince||(this._processingSince=new Date);let i=6;n&&a&&(i=0);try{for(let n=0;n<=i&&t>0;n++)5!==n&&(this._taskManagerUtils.isOnIdleTasksEnabled()&&4===n&&(t=this.processQueueTasks(5,!0,e,t),this.cleanupQueuePendingDeletedTasks(5)),t>0&&(t=this.processQueueTasks(n,!1,e,t),this.cleanupQueuePendingDeletedTasks(n)))}catch(e){if(this._processingTask){const e="TaskManager: processing task has not finished due to unhandled exception"+this._processingTask.taskItemId;o.ULS.sendTraceTag(556800133,218,15,e)}throw e}finally{this._isProcessing=!1,this._processingSince=null,this._processingTask=null,this._cpuMeter.onAfterProcess()}}this.updateNextWakeUpIfNecessary()},this.yieldResponse=()=>{this._isRunning=!0,this.raiseOnStartRunningForDiagnostics(),this._runningSince||(this._runningSince=new Date),this._yieldResponseOperation=this.yieldOperation;const e=this.yieldOperation;this._yieldOperation=null,this._isYielding=!1,this._yieldingSince=null;try{if(e){const t=e.operationName?"128_"+e.operationName:"128";e.updateStartTime(),this._cpuMeter.profileTopLevelTask((()=>e.run()),t,+new Date-+e.startTime)}}finally{0,this._yieldResponseOperation=null,this._isRunning=!1,this.raiseOnStopRunningForDiagnostics(),this._runningSince=null}this.updateNextWakeUpIfNecessary()},this._cpuMeter=e,this._keyInputManager=t,this._taskManagerUtils=n,this._timerSet=!1,this.maximumTimeOfOneCpuWakeUp=50,this._timeToWaitAfterLastKeyStroke=250,T.keepOriginalWindowFunc()}}T._isOriginalWindowFuncSet=!1,T._originalSetTimeout=null,T._originalClearTimeout=null,T._originalRequestIdleCallback=null,T._originalCancelIdleCallback=null,(0,a.a)(T,"TaskManagerImpl",null,[309,122,11,310]);var v=n(680);class w{static get instance(){return w._instanceToReturn||(w._realTaskManager=T.createTaskManagerImpl(),w._instanceToReturn=w._realTaskManager),w._instanceToReturn}static dispose(){w._instanceToReturn=new i,v.a.safeDispose(w._realTaskManager),w._realTaskManager=null}static keepOriginalWindowFuncInTaskManager(){T.keepOriginalWindowFunc()}}w._realTaskManager=null,w._instanceToReturn=null,(0,a.a)(w,"TaskManager",null,[])},2518:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(1207),o=n(2693),r=n(3245);class s extends o.a{static getStaticScriptPath(){return i.a.staticContentHost+r.AFrameworkApplication.scriptFolderPath}static getStaticContentQueryParameter(){return i.a.staticContentQueryParameter}static AssertStringTag(e,t,n){0}static RegisterErrorHandler(e){r.AFrameworkApplication.registerTestHarnessErrorHandler(e)}static LogThroughClient(e){0}}s.userSessionData=null,(0,a.a)(s,"TestHarnessInterface",o.a,[])},2693:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(6776);class o{static loadTestHarness(){const e=document.createElement("script");e.type="text/javascript",i.AFrameworkApplicationConstants.useCrossOriginStaticScripts&&e.setAttribute("crossorigin","anonymous"),e.src=o.webToadHostName+"/Scripts/TestHarness.js",document.body.appendChild(e)}static isBrowserUnderWebToadRun(e,t){e=e.toLowerCase();const n=String.format("[?&]{0}=",o.runIdParam),a=String.format("[?&]{0}=",o.scenarioIdParam),i=String.format("[?&]{0}=",o.userSessionDataParam);return(e.search(new RegExp(n))>-1||!!t(o.runIdParam))&&(e.search(new RegExp(a))>-1||!!t(o.scenarioIdParam))||e.search(new RegExp(i))>-1}}o.webToadHostName=null,o.runIdParam="wdrunid",o.scenarioIdParam="wdscenarioid",o.userSessionDataParam="wdusersessiondata",(0,a.a)(o,"TestHarnessInterfaceConstants",null,[])},3435:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8574);class o extends i.a{get ControlType(){return 2}constructor(){super(),this.UpdateHtmlPostToggle=!1,this.AriaLabel=null,this.ToggleUsingIcon=!1,this.StylingParameters=null}}(0,a.a)(o,"ToggleButtonProps",i.a,[])},7057:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(9123),o=n(1163);class r{get useRelativePositioning(){return this._useRelativePositioning}get finalX(){return this._finalX}set_finalX(e){return this._finalX=e,e}get isXConstant(){return this._isXConstant}animateX(e,t,n){this._useRightAttributeForX=n,e!==t?(this._isXConstant=!1,this.setInitialX(e,n),this.set_finalX(t)):this.maintainConstantX(e,n)}maintainConstantX(e,t){this._isXConstant=!0,this.setInitialX(e,t),this.set_finalX(e)}setInitialX(e,t){t?this._useRelativePositioning?this.element.style.marginRight=e+"px":this.element.style.right=e+"px":this._useRelativePositioning?this.element.style.marginLeft=e+"px":this.element.style.left=e+"px"}animateXRight(e,t,n){this._useRightAttributeForX=!n,e!==t?(this._isXConstant=!1,this.setInitialXRight(e,n),this.set_finalX(t)):this.maintainConstantXRight(e,n)}maintainConstantXRight(e,t){this._isXConstant=!0,this.setInitialXRight(e,t),this.set_finalX(e)}setInitialXRight(e,t){t?this._useRelativePositioning?this.element.style.marginLeft=e+"px":this.element.style.left=e+"px":this._useRelativePositioning?this.element.style.marginRight=e+"px":this.element.style.right=e+"px"}get useRightAttributeForX(){return this._useRightAttributeForX}get finalY(){return this._finalY}set_finalY(e){return this._finalY=e,e}get isYConstant(){return this._isYConstant}animateY(e,t){e!==t?(this._isYConstant=!1,this.setInitialY(e),this.set_finalY(t)):this.maintainConstantY(e)}maintainConstantY(e){this._isYConstant=!0,this.setInitialY(e),this.set_finalY(e)}setInitialY(e){this._useRelativePositioning?this.element.style.marginTop&&""!==this.element.style.marginTop&&this.element.style.marginTop===e+"px"||(this.element.style.marginTop=e+"px"):this.element.style.top&&""!==this.element.style.top&&this.element.style.top===e+"px"||(this.element.style.top=e+"px")}get finalHeight(){return this._finalHeight}set_finalHeight(e){return this._finalHeight=e,e}get isHeightConstant(){return this._isHeightConstant}animateHeight(e,t){e!==t?(this._isHeightConstant=!1,this.element.style.height&&""!==this.element.style.height&&this.element.style.height!==t+"px"||this.setInitialHeight(e),this.set_finalHeight(t)):this.maintainConstantHeight(e)}maintainConstantHeight(e){this._isHeightConstant=!0,this.setInitialHeight(e),this.set_finalHeight(e)}setInitialHeight(e){this.element.style.height=e+"px"}get finalWidth(){return this._finalWidth}set_finalWidth(e){return this._finalWidth=e,e}get isWidthConstant(){return this._isWidthConstant}animateWidth(e,t){e!==t?(this._isWidthConstant=!1,this.element.style.width&&""!==this.element.style.width&&this.element.style.width!==t+"px"||this.setInitialWidth(e),this.set_finalWidth(t)):this.maintainConstantWidth(e)}maintainConstantWidth(e){this._isWidthConstant=!0,this.setInitialWidth(e),this.set_finalWidth(e)}setInitialWidth(e){this.element.style.width=e+"px"}get finalOpacity(){return this._finalOpacity}set_finalOpacity(e){return this._finalOpacity=e,e}animateOpacity(e,t){this.setInitialOpacity(e),this.set_finalOpacity(t)}setInitialOpacity(e){o.a.setOpacity(this.element,e)}get finalScrollTop(){return this._finalScrollTop}set_finalScrollTop(e){return this._finalScrollTop=e,e}get isScrollTopConstant(){return this._isScrollTopConstant}animateScrollTop(e,t){e!==t?(this._isScrollTopConstant=!1,this.getScrollTopValue()===t&&this.setScrollTopValue(e),this.set_finalScrollTop(t)):this.maintainConstantScrollTop(e)}maintainConstantScrollTop(e){this._isScrollTopConstant=!0,this.setScrollTopValue(e),this.set_finalScrollTop(e)}setScrollTopValue(e){this.element.scrollTop=e}getScrollTopValue(){return this.element.scrollTop}setScrollTop(){isNaN(this.finalScrollTop)||this.setScrollTopValue(this.finalScrollTop)}setScrollLeft(){isNaN(this.finalScrollLeft)||this.setScrollLeftValue(this.finalScrollLeft)}get finalScrollLeft(){return this._finalScrollLeft}set_finalScrollLeft(e){return this._finalScrollLeft=e,e}get isScrollLeftConstant(){return this._isScrollLeftConstant}animateScrollLeft(e,t){e!==t?(this._isScrollLeftConstant=!1,this.getScrollLeftValue()===t&&this.setScrollLeftValue(e),this.set_finalScrollLeft(t)):this.maintainConstantScrollLeft(e)}maintainConstantScrollLeft(e){this._isScrollLeftConstant=!0,this.setScrollLeftValue(e),this.set_finalScrollLeft(e)}setScrollLeftValue(e){this.element.scrollLeft=e}getScrollLeftValue(){return this.element.scrollLeft}get finalRotateZ(){return this._finalRotateZ}set_finalRotateZ(e){return this._finalRotateZ=e,e}get isRotateZConstant(){return this._isRotateZConstant}animateRotateZ(e,t){e!==t?(this._isRotateZConstant=!1,this.setInitialRotateZ(e),this.set_finalRotateZ(t)):this.maintainConstantRotateZ(e)}maintainConstantRotateZ(e){this._isRotateZConstant=!0,this.setInitialRotateZ(e),this.set_finalRotateZ(e)}setInitialRotateZ(e){i.a.setRotation(this.element,e)}constructor(e,t){this._finalOpacity=Number.NaN,this._finalX=Number.NaN,this._finalY=Number.NaN,this._finalHeight=Number.NaN,this._finalWidth=Number.NaN,this._finalScrollTop=Number.NaN,this._finalScrollLeft=Number.NaN,this._finalRotateZ=Number.NaN,this._useRelativePositioning=!1,this._isXConstant=!1,this._useRightAttributeForX=!1,this._isYConstant=!1,this._isHeightConstant=!1,this._isWidthConstant=!1,this.isOpacityConstant=!1,this._isScrollTopConstant=!1,this._isScrollLeftConstant=!1,this._isRotateZConstant=!1,this.type=e,this.element=t,"relative"===this.element.style.position&&(this._useRelativePositioning=!0)}}(0,a.a)(r,"AAnimationEvent",null,[])},6935:function(e,t,n){"use strict";n.r(t),n.d(t,{CrashDialog:function(){return o}});var a=n(100),i=n(3696);class o extends i.StandardDialog{prepareDialog(){this.overlayCss=this.overlayCss+" WACDialogOverlayUnhandledError",super.prepareDialog(),Sys.UI.DomElement.addCssClass(this._divMessageBox,"WACDialogUnhandledError")}constructor(){super()}}(0,a.a)(o,"CrashDialog",i.StandardDialog,[])},3563:function(e,t,n){"use strict";n.r(t),n.d(t,{CustomDialog:function(){return f}});var a=n(100),i=n(1450),o=n(3696),r=n(4852),s=n(9858),l=n(205),c=n(8103),d=n(9800),u=n(6776),p=n(2274),g=n(2594),h=n(4069);const m=(_="domPurifyHTML",(0,g.a)(_,{createHTML:(e,t)=>(0,h.a)(e,t)},S));var _,S;class f extends i.a{get canBePreempted(){return!0}setControlValue(e,t){switch(s.a.toLower(e.tagName)){case"input":switch(s.a.toLower(e.type)){case"text":case"hidden":case"password":case"number":e.value=t;break;case"checkbox":case"radio":e.checked=t;break;default:e.innerText=t}break;case"textarea":e.value=t;break;case"select":e.selectedIndex=t;break;case"img":e.src=t;break;default:e.innerText=t}}getControlValue(e){let t;switch(s.a.toLower(e.tagName)){case"input":switch(s.a.toLower(e.type)){case"text":case"hidden":case"password":case"number":t=e.value;break;case"checkbox":case"radio":t=e.checked;break;default:t=e.innerText}break;case"textarea":t=e.value;break;case"select":t=e.selectedIndex;break;case"img":t=e.src;break;default:t=e.innerText}return t}setInnerHtml(){d.a.logUniqueUsage("efb1a590;e7deb809");const e=p.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.isInnerHTMLWordEditorPolicyEnabled",!1)??!1;this._textElement.innerHTML=e?m.createHTML(this.dialogHtml):this.dialogHtml,this.onInnerHtmlSet()}setDialogProperties(e){this.prepareDialog(),this.sizeAndPositionDialog(),this.setInnerHtml(),this._titleText.innerText=e}prepareDialog(){super.prepareDialog(),Sys.UI.DomElement.addCssClass(this._divMessageBox,this._customCssClass);const e=document.createElement("div");e.id=this.myId("WACDialogHtmlPanel"),e.className="WACDialogHtmlPanel",this._body.appendChild(e),this._textElement=document.createElement("div"),this._textElement.id=this.myId("WACDialogText"),e.appendChild(this._textElement)}sizeAndPositionDialog(){const e=i.a.posTop+(this.getPageHeight()-f._defaultHeight)/2-12,t=i.a.posLeft+(this.getPageWidth()-f._defaultWidth)/2-12;this.sizeAndPositionDialogWorker(e,t)}sizeAndPositionDialogWorker(e,t){const n=e,a=t;"DL"!==this._windowMode&&(this._divMessageBox.style.top=(n<0?0:n)+"px"),"DP"!==this._windowMode&&(u.AFrameworkApplicationConstants.isRtl?this._divMessageBox.style.right=(a<0?0:a)+"px":this._divMessageBox.style.left=(a<0?0:a)+"px"),this._divMessageBox.style.display="Block"}onInnerHtmlSet(){}onReactComponentLoaded(){}showDialog(e,t=null){this.initializeAndShow(e,t,null)}initializeAndShow(e,t=null,n=null){this.dialogId=void 0===this.dialogId||null===this.dialogId?r.a.randomBetween(0,Number.MAX_VALUE).toString():this.dialogId,this._useReactDialog?this.reactInitializeAndShow(e,t,n):this.legacyInitializeAndShow(e,t,n)}reactInitializeAndShow(e,t,n){n=this.setupReactCustomDialogControlValues(e,t,n),this.show(n)}legacyInitializeAndShow(e,t,n){if(this._messageBoxHandler=this.baseDialogHandler,this._customDialogHandler=t,this._controlValues=n,this.setDialogProperties(e),n)for(const e in n){const t={key:e,value:n[e]},a=document.getElementById(t.key);a&&this.setControlValue(a,t.value)}this.show()}updateDialog(e,t,n){this._useReactDialog&&this.reactUpdate$3(e,t,n)}reactUpdate$3(e,t,n){n=this.setupReactCustomDialogControlValues(e,t,n),this.update(n)}setupReactCustomDialogControlValues(e,t,n){return null==n||(this._customDialogHandler=t,this._reactDialogHandler=this.reactBaseDialogHandler,n.headerText=n.headerText||e,n.type="CustomDialogProps",n.id=n.id||this.dialogId,n.resultHandler=this._reactDialogHandler),n}dispose(){this._textElement=null,super.dispose()}setFailed(e,t){const n=new o.StandardDialog;n.buttonsOption=0,n.showWarning((0,c.a)("DefaultDialogTitle"),e,t)}static formatHtml(e,...t){return String.format.apply(null,[e].concat(l.d(l.c(l.a(t),s.a.htmlEncode))))}constructor(e=!1,t=!1,a=!1,i=!1,o=!0){super(e,t,a,i,o),this._textElement=null,this._customDialogHandler=null,this._reactDialogHandler=null,this._controlValues=null,this._customCssClass="",this.dialogHtml=null,this.autoSize=!1,this.baseDialogHandler=e=>{const t=this._controlValues;for(const e in t){const n={key:e,value:t[e]},a=document.getElementById(n.key);a&&(this._controlValues[n.key]=this.getControlValue(a))}this._hideOnButtonClick&&this.hide(),this._customDialogHandler&&this._customDialogHandler(e,this._controlValues),this._hideOnButtonClick&&(this._customDialogHandler=null)},this.reactBaseDialogHandler=(e,t)=>{const{TaskManager:a}=n(657);this._hideOnButtonClick&&this.hide(),this._customDialogHandler&&this._customDialogHandler(e,t),this._hideOnButtonClick&&(this._customDialogHandler=null)}}}f._defaultWidth=350,f._defaultHeight=200,(0,a.a)(f,"CustomDialog",i.a,[])},1450:function(e,t,n){"use strict";n.d(t,{a:function(){return V}});var a=n(100),i=n(3792),o=n(8765);const r=(0,i.b)("Common.UI.IDialogMenuRootUser");var s,l=n(5149),c=n(625),d=n(9123),u=n(6776);class p{isDragPossible(e){return!0}onDragStart(e){const t=e.clientPoint.x,n=e.clientPoint.y,a=this._moveElement.offsetLeft,i=this._moveElement.offsetTop,o=this.getMargin(this._moveElement);return this._cursorOffsetX=t-a+o.x,this._cursorOffsetY=n-i+o.y,!0}onDragMove(e){let t=e.clientPoint.x-this._cursorOffsetX,n=e.clientPoint.y-this._cursorOffsetY;const a=u.AFrameworkApplicationConstants.activeFrame.getDOMElement();if(this._moveElementMarginSet||(this._moveElementMargin=this.getMargin(this._moveElement),this._moveElementMarginSet=!0),t+this._moveElementMargin.x<0)t=-this._moveElementMargin.x;else{const e=a.offsetWidth-this._moveElement.offsetWidth-this._moveElementMargin.x;t>e&&(t=e)}if(n+this._moveElementMargin.y<0)n=-this._moveElementMargin.y;else{const e=a.offsetHeight-this._moveElement.offsetHeight-this._moveElementMargin.y;n>e&&(n=e)}return u.AFrameworkApplicationConstants.isRtl?this._moveElement.style.right=a.offsetWidth-t-this._moveElement.offsetWidth+"px":this._moveElement.style.left=t+"px",this._moveElement.style.top=n+"px",!0}onDragEnd(e){}onDragCancel(e){}getMargin(e){const t=d.a.getCurrentStyle(e);if(!t)return new Sys.UI.Point(0,0);const n=t.marginTop,a=t.marginLeft,i=parseInt(n);let o=parseInt(a);if(u.AFrameworkApplicationConstants.isRtl){const e=t.marginRight;o-=parseInt(e)}return new Sys.UI.Point(isNaN(o)?0:o,isNaN(i)?0:i)}constructor(e){this._cursorOffsetX=0,this._cursorOffsetY=0,this._moveElementMargin=null,this._moveElementMarginSet=!1,this._moveElement=e}}(0,a.a)(p,"MoveDragAdapter",null,[296]),function(e){e[e.cancel=0]="cancel",e[e.action=1]="action",e[e.ok=1]="ok",e[e.yes=1]="yes",e[e.secondaryAction=2]="secondaryAction",e[e.retry=2]="retry",e[e.no=2]="no",e[e.tertiaryAction=3]="tertiaryAction",e[e.quaternaryAction=4]="quaternaryAction"}(s||(s={})),(0,a.b)("DialogButton",s);var g=n(6012),h=n(629),m=n(7531),_=n(5072),S=n(2544),f=n(6534),C=n(5434),y=n(6101),A=n(988);var b=n(383),T=n(6094),v=n(7958),w=n(9858),F=n(9611),I=n(6124),E=n(8103),M=n(1307),k=n(5374),P=n(9037),D=n(7989),R=n(9675);const x="WACDialogOuterContainer",L="WACDialogOuterContainer",U="WACDialogPanel",O="WACDialogOverlay",B="WACDialogTitleText",N="WACButton WACDialogButtonNormal",W="WACDialogCheckboxDivHighlight",H="DialogMenuId";class V extends Sys.UI.Control{static get currentDialog(){return D.a}static set currentDialog(e){(0,D.b)(e)}static get isFocusScopeFixEnabled(){return null!=V.__cached_isFocusScopeFixEnabled_0_058afa0f?V.__cached_isFocusScopeFixEnabled_0_058afa0f:V.__cached_isFocusScopeFixEnabled_0_058afa0f=(()=>{const{AFrameworkApplication:e}=n(3245);return e.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsDialogFocusScopeFixEnabled",!0)??!1})()}static isDialogOpen(){return!!D.a?.isShowing}static isSDXDialog(){return!!D.a?.isSDXDialog}onReactComponentLoaded(){}get fullDialogFocusId(){const e=this.isModalDialog?"/modal":"/modeless";return R.a.dialogFocusId+e}get dialogElement(){return D.a?D.a._divMessageBox:null}get dialogOuterContainer(){return this._divOuterDialogContainer}get menuLaunchPoint(){return D.a?D.a._menuLaunchPoint:null}get closeAnchor(){return this._closeAnchor}get closeIconElement(){return this._closeIconElement}get dialogOnKeyDownHandler(){return this._dialogOnKeyDownHandler?this._dialogOnKeyDownHandler:(0,c.a)(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")}set dialogOnKeyDownHandler(e){this._dialogOnKeyDownHandler=e}get dialogOnKeyPressHandler(){return this._dialogOnKeyPressHandler?this._dialogOnKeyPressHandler:(0,c.a)(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")}set dialogOnKeyPressHandler(e){this._dialogOnKeyPressHandler=e}get dialogOnKeyUpHandler(){return this._dialogOnKeyUpHandler?this._dialogOnKeyUpHandler:(0,c.a)(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")}set dialogOnKeyUpHandler(e){this._dialogOnKeyUpHandler=e}get buttonsOption(){return this._buttonsOption}set buttonsOption(e){this._buttonsOption=e,this.hideAllButtons();try{switch(this._buttonsOption){case 0:this.initializeButton(1,this._okText);break;case 1:this.initializeButton(1,this._okText),this.initializeButton(0,this._cancelText);break;case 2:this.initializeButton(1,this._okText),this.initializeButton(0,this._cancelText),this.initializeButton(2,this._retryText);break;case 3:this.initializeButton(1,this._yesText),this.initializeButton(0,this._cancelText),this.initializeButton(2,this._noText);break;case 4:this.initializeButton(1,this._yesText),this.initializeButton(2,this._noText);break;case 6:this.initializeButton(0,this._cancelText);break;case 7:this.initializeButton(1,this._permanentlyDeleteText),this.initializeButton(0,this._cancelText);break;case 8:this.initializeButton(1,this._shareAndNotifyText),this.initializeButton(0,this._cancelText);break;case 9:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(0,this._cancelText);break;case 10:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(3,this._tertiaryActionText),this.initializeButton(0,this._cancelText);break;case 11:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText);break;case 12:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(3,this._tertiaryActionText);break;case 13:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(3,this._tertiaryActionText),this.initializeButton(4,this._quaternaryActionText);break;case 14:this.initializeButton(2,this._secondaryActionText),this.initializeButton(1,this._actionText),this.initializeButton(0,this._cancelText)}}catch(e){switch(this._buttonsOption){case 0:this.initializeButton(1,null);break;case 1:this.initializeButton(1,null),this.initializeButton(0,null);break;case 2:case 3:this.initializeButton(1,null),this.initializeButton(0,null),this.initializeButton(2,null);break;case 4:this.initializeButton(1,null),this.initializeButton(2,null);break;case 6:this.initializeButton(0,null)}}}get width(){return this._width}set width(e){this._width=e}get overlayCss(){return this._overlayCssClass}set overlayCss(e){this._overlayCssClass=e}get btnAction(){return this._btnAction}set btnAction(e){this._btnAction=e}get canBePreempted(){return!1}get hasRovingTabIndex(){return!1}get menuRootUser(){return this._menuRootUser||(this._menuRootUser=(0,i.j)(r))||l.ULS.sendTraceTag(20824577,207,10,"Could not resolve IDialogMenuRootUser"),this._menuRootUser}get keyMoveAdapter(){return this._keyAdapter||(this._keyAdapter=(0,i.j)(o.a))||l.ULS.sendTraceTag(21516489,207,10,"Could not resolve dialog KeyMoveAdapter"),this._keyAdapter}get dismissFocusScope(){return this._dismissFocusScope}set dismissFocusScope(e){this._dismissFocusScope=e}prepareDialog(){const{AFrameworkApplication:e}=n(3245);if(this.isModalDialog&&!this._overlayElement&&(this._overlayElement=this._document.createElement("div"),this._overlayElement.id=this.myId(O),this._overlayElement.className=this._overlayCssClass),this._divOuterDialogContainer)for(;this._divOuterDialogContainer.firstChild;)this._divOuterDialogContainer.removeChild(this._divOuterDialogContainer.firstChild);else this._divOuterDialogContainer=this._document.createElement("div"),this._divOuterDialogContainer.id=this.myId(x),this._divOuterDialogContainer.className=L;if(this._divInnerDialogContainer=this._document.createElement("div"),this._divInnerDialogContainer.id=this.myId("WACDialogInnerContainer"),this._divInnerDialogContainer.className="WACDialogInnerContainer",this._divMessageBox=this._document.createElement("div"),this._divMessageBox.id=this.myId(U),e.activeFrame&&e.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled?this._divMessageBox.className="MLRVisualRefresh "+this._dialogPanelCssClass:this._divMessageBox.className=this._dialogPanelCssClass,this._dialogParentId&&(this._divMessageBox.className=this._divMessageBox.className+" FullDocumentPanel"),e.accessibilityUseRoleDialog?this._divMessageBox.setAttribute(I.a.ariaRoleAttribute,I.a.ariaDialogRole):this._divMessageBox.setAttribute(I.a.ariaRoleAttribute,I.a.ariaAlertDialogRole),this._divMessageBox.setAttribute(I.a.ariaLabelledByAttribute,this.myId(B)),this.isModalDialog&&this.setAriaAttributeForDialog("aria-modal","true"),this._clickManager=e.activeFrame?e.activeFrame.theClickInputManager:null,this._keyInputManager=e.activeFrame?e.activeFrame.theKeyInputManager:null,this._menuLaunchPoint=this._document.createElement("div"),this._menuLaunchPoint.className="WACDialogMenuLaunchPoint",this._divMessageBox.appendChild(this._menuLaunchPoint),this._divMessageBoxTitle=this._document.createElement("div"),this._divMessageBoxTitle.id=this.myId("WACDialogTitlePanel"),this._divMessageBoxTitle.className="WACDialogTitlePanel",this._titleText=this._document.createElement("div"),this._titleText.id=this.myId(B),this._titleText.className="WACDialogTitleText",this._divMessageBoxTitle.appendChild(this._titleText),this.hasCloseGlyph&&(this._closeAnchor=this._document.createElement("a"),this.closeAnchor.className="WACGlyph WACDialogCloseAnchor",this.closeAnchor.setAttribute(I.a.ariaRoleAttribute,I.a.ariaButtonRole),this.closeAnchor.title=this._closeText,this._divMessageBoxTitle.appendChild(this.closeAnchor),e.activeFrame&&e.activeFrame.applicationInstance.isInHighContrastMode()||e.appSettingsManager.isChangeGateEnabled("OfficeVSO:9670734_cancelButtonHighContrastFix")&&window&&window.matchMedia&&window.matchMedia("(forced-colors: active)").matches?(this._closeIconElement=this._document.createElement("span"),this.closeIconElement.setAttribute("Unselectable","on"),this.closeIconElement.className="WACDialogCloseIcon clip16x16",this.closeIconElement.style.zIndex="0",this.closeIconElement.style.display="inline-block",b.a.renderIcon("CancelGlyph_16",this.closeIconElement),this.closeIconElement.setAttribute(I.a.ariaRoleAttribute,I.a.ariaPresentationRole)):this._closeIconElement=(0,k.a)(16,16,"ClosePaneGlyph_16x16x32","WACDialogCloseIcon",!0,""),this.closeAnchor.appendChild(this.closeIconElement)),this.hasTitleBar||(this._divMessageBoxTitle.style.display="none"),this._divMessageBox.appendChild(this._divMessageBoxTitle),this._bodyPanel=this._document.createElement("div"),this._bodyPanel.id=this.myId("WACDialogBodyPanel"),this._bodyPanel.className="WACDialogBodyPanel",this._divMessageBox.appendChild(this._bodyPanel),this._body=this._document.createElement("div"),this._body.id=this.myId("WACDialogBodyContent"),this._body.className="WACDialogBodyContent",this._bodyPanel.appendChild(this._body),this.hasButtonPanel&&(this._buttonPanel=this._document.createElement("div"),this._buttonPanel.id=this.myId("WACDialogButtonPanel"),this._buttonPanel.className="WACDialogButtonPanel",this._divMessageBox.appendChild(this._buttonPanel),this._btnAction=this.prepareButton(1,V._actionButtonId),this._buttonDisplay[2]&&(this._btnSecondary=this.prepareButton(2,V._secondaryButtonId)),this._buttonDisplay[3]&&(this._btnTertiary=this.prepareButton(3,V._tertiaryButtonId)),this._buttonDisplay[4]&&(this._btnQuaternary=this.prepareButton(4,V._quaternaryButtonId)),this._buttonDisplay[0]&&(this._btnCancel=this._document.createElement("button"),this._buttons[0]=this._btnCancel,this._btnCancel.id=this.myId(V._cancelButtonId),this._btnCancel.className=N,this.setButtonProperties(this._btnCancel,0),this._buttonPanel.appendChild(this._btnCancel))),this._overlayElement&&this._outerBody.insertBefore(this._overlayElement,this._outerBody.firstChild),this._dialogParentId){const e=document.getElementById(this._dialogParentId);e?e.insertBefore(this._divOuterDialogContainer,e.firstChild):this._outerBody.insertBefore(this._divOuterDialogContainer,this._outerBody.firstChild)}else this._outerBody.insertBefore(this._divOuterDialogContainer,this._outerBody.firstChild);this._divOuterDialogContainer.appendChild(this._divInnerDialogContainer),this.isModalDialog&&this._overlayElement.addEventListener("mousedown",(e=>{e.preventDefault(),e.stopPropagation(),this._divMessageBox.focus()})),this._divInnerDialogContainer.appendChild(this._divMessageBox),this._windowScrollHandler||(this._windowScrollHandler=this.scrollFix,this._windowResizeHandler=(0,c.a)(this,this.sizeFix,"sizeFix"),m.a.addHandler(window.self,"scroll",this._windowScrollHandler),m.a.addHandler(window.self,"resize",this._windowResizeHandler)),this._dragAdapter=new p(this._divMessageBox),e.activeFrame&&e.activeFrame.theDragInputManager.registerDragAdapter(this._divMessageBoxTitle,this._dragAdapter),V.areRegionComposerAPIsAvailable()&&this.registerForRegionComposerEvents()}prepareButton(e,t){const n=this._document.createElement("button");return this._buttons[e]=n,n.id=this.myId(t),14===this.buttonsOption&&2===e?n.className="WACButton WACDialogButtonNormal WACAlignLeftButton":n.className=N,this.setButtonProperties(n,e),this._buttonPanel.appendChild(n),n}addMultiScreenClassNames(e){"DL"===e?(Sys.UI.DomElement.addCssClass(this._divMessageBox,"DL"),Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DP")):"DP"===e?(Sys.UI.DomElement.addCssClass(this._divMessageBox,"DP"),Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DL")):(Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DP"),Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DL"))}registerForRegionComposerEvents(){const{AFrameworkApplication:e}=n(3245);this._windowMode=e.activeFrame.adaptiveLayoutInstance.getWindowMode(),this._rectsWithoutKeyboard=e.activeFrame.adaptiveLayoutInstance.getWindowRectsWithoutKeyboard(),this.addMultiScreenClassNames(this._windowMode),e.activeFrame.adaptiveLayoutInstance.registerBoundingWindowRectsChanged("legacyDialog",((e,t)=>{const{AFrameworkApplication:a}=n(3245);this._rectsWithoutKeyboard=a.activeFrame.adaptiveLayoutInstance.getWindowRectsWithoutKeyboard(),this._windowMode=t,this.addMultiScreenClassNames(t),this.reSizeDialog()})),this._isRegisteredWithRegionComposer||this.reSizeDialog(),this._isRegisteredWithRegionComposer=!0}unRegisterForRegionComposerEvents(){const{AFrameworkApplication:e}=n(3245);this._isRegisteredWithRegionComposer&&(e.activeFrame.adaptiveLayoutInstance.unregisterBoundingWindowRectsChanged("legacyDialog",null),this._isRegisteredWithRegionComposer=!1)}getMaxHeight(e){const t=n(3245).AFrameworkApplication.activeFrame.adaptiveLayoutInstance.getKeyboardSegment();if(t){const n=t.left?0:t.height;return"DL"===this._windowMode?e:e-n}return e}needsToAvoidKeyboard(){if(this._rectsWithoutKeyboard&&this._rectsWithoutKeyboard.length>=1){const e=this._rectsWithoutKeyboard[0].height;if(this.getMaxHeight(e)!==e)return!0}return!1}getPageHeight(){if(V.areRegionComposerAPIsAvailable()&&this.needsToAvoidKeyboard()){const e=this._rectsWithoutKeyboard[0].height;return this.getMaxHeight(e)}return V.pageHeight}getPageWidth(){return V.areRegionComposerAPIsAvailable()&&"DP"===this._windowMode&&this._rectsWithoutKeyboard.length>=1?this._rectsWithoutKeyboard[0].width:V.pageWidth}centerDialog(){const{AFrameworkApplication:e}=n(3245);if(!this._divMessageBox)return void l.ULS.sendTraceTag(17688785,306,10,"_divMessageBox is null in CenterDialog()");const t=this._divMessageBox.style.zIndex;if(this._divMessageBox.style.zIndex="-9999",this._divMessageBox.offsetWidth<this.getPageWidth()){const t=String.format("{0}px",Math.floor(-this._divMessageBox.offsetWidth/2));e.isRtl?this._divMessageBox.style.marginRight=t:this._divMessageBox.style.marginLeft=t,"DP"!==this._windowMode&&(e.isRtl?this._divMessageBox.style.right="50%":this._divMessageBox.style.left="50%")}if(this._divMessageBox.offsetHeight<this.getPageHeight()&&this._divMessageBox.offsetTop>=0)if("DL"!==this._windowMode&&(this._divMessageBox.style.top="50%"),V.areRegionComposerAPIsAvailable()&&this.needsToAvoidKeyboard()){const e=this.getMaxHeight(this._rectsWithoutKeyboard[0].height);this._divMessageBox.style.marginTop=String.format("{0}px",Math.floor((e-this._divMessageBox.clientHeight)/2)),this._divMessageBox.style.top="unset"}else this._divMessageBox.style.marginTop=String.format("{0}px",Math.floor(-this._divMessageBox.offsetHeight/2));else V.areRegionComposerAPIsAvailable()&&this.needsToAvoidKeyboard()&&(this._divMessageBox.style.top="unset");this._divMessageBox.style.zIndex=String(t)}cleanUp(){}dispose(){this._isShowing=!1,this.unRegisterForRegionComposerEvents(),this._useReactDialog?this.reactDispose():this.legacyDispose(),Sys.Component.prototype.dispose.call(this)}reactDispose(){const{AFrameworkApplication:e}=n(3245);this._isDisposingAsync||(this._isDisposingAsync=!0,M.a.getDialogAPIAsync().then((e=>(e.dispose(),this.removeElement(this._divOuterDialogContainer),this._divOuterDialogContainer=null,(0,D.b)(null),this._disposed=!0,this._dialogValues=null,this.cleanUp(),this._isDisposingAsync=!1,null)))),!e.activeFrame&&this._divOuterDialogContainer&&this.removeElement(this._divOuterDialogContainer)}legacyDispose(){const{AFrameworkApplication:e}=n(3245);this._disposed||(null!==this._windowScrollHandler&&(m.a.removeHandler(window.self,"scroll",this._windowScrollHandler),m.a.removeHandler(window.self,"resize",this._windowResizeHandler),this._windowScrollHandler=null,this._windowResizeHandler=null),e.activeFrame&&e.activeFrame.theDragInputManager&&this._divMessageBoxTitle&&this._dragAdapter&&e.activeFrame.theDragInputManager.unregisterDragAdapter(this._divMessageBoxTitle,this._dragAdapter),this._dragAdapter=null,this._clickManager=null,this._keyInputManager=null,this._keyAdapter&&this._keyAdapter.inMoveMode&&this._keyAdapter.exitMoveMode(),this._keyAdapter=null,this._divMessageBox&&T.a.elementAttached(this._divMessageBox)&&this.removeElement(this._divOuterDialogContainer),this._divOuterDialogContainer=null,this._divInnerDialogContainer=null,this._divMessageBox=null,this._btnAction=null,this._btnCancel=null,this._btnSecondary=null,this._btnTertiary=null,this._btnQuaternary=null,this._overlayElement=null,this._divMessageBoxTitle=null,this._buttonPanel=null,this._document=null,this._body=null,this._titleText=null,this._outerBody=null,this._closeAnchor=null,this._closeIconElement=null,(0,D.b)(null),this._disposed=!0)}removeElement(e){e&&e.parentNode&&e.parentNode.removeChild(e)}hideAllButtons(){this.setButtonVisiblity(1,!1),this.setButtonVisiblity(0,!1),this.setButtonVisiblity(2,!1),this.setButtonVisiblity(3,!1),this.setButtonVisiblity(4,!1)}dialogDefaultEnterKeyHandler(e){const{AFrameworkApplication:t}=n(3245);if(e.innerEvent.keyCode===Sys.UI.Key.enter&&"a"!==e.sourceElement.tagName.toLowerCase()){if(t.dialogDefaultEnterBehaviorIsEnabled&&this.hasButtons){const e=this.getButtonElement(this.getDefaultButton());this.executeDismissButton(e,1)}return!0}return!1}keyHandlerWithAction(e,t){if(e.innerEvent.ctrlKey||e.innerEvent.altKey||e.innerEvent.keyCode>=_.a.VK_F1&&e.innerEvent.keyCode<=_.a.VK_F12)return!1;if(e.eventName===g.a.keyUp&&this._keystrokeOnButtonPending){const n=e.innerEvent.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||t(e),this._keystrokeOnButtonPending=!1}return e.eventName===g.a.keyDown&&(this._keystrokeOnButtonPending=!0),!0}onCheckboxFocusOrBlur(e){if(!e)return void l.ULS.sendTraceTag(18465239,306,10,"event is null in OnCheckboxFocusOrBlur");const t=e.target;e.type===g.a.focus?Sys.UI.DomElement.addCssClass(t.parentNode,W):Sys.UI.DomElement.removeCssClass(t.parentNode,W)}attachFocusHandlersForCheckbox(e){if(e){const t=e.getElementsByTagName("input");if(t)for(let e=0;e<t.length;e++){const n=t[e];"checkbox"===w.a.toLower(n.type)&&(m.a.addHandler(n,g.a.focus,(0,c.a)(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")),m.a.addHandler(n,g.a.blur,(0,c.a)(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")))}}}detachFocusHandlersForCheckbox(e){if(e){const t=e.getElementsByTagName("input");if(t)for(let e=0;e<t.length;e++){const n=t[e];"checkbox"===w.a.toLower(n.type)&&(m.a.removeHandler(n,g.a.focus,(0,c.a)(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")),m.a.removeHandler(n,g.a.blur,(0,c.a)(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")))}}}executeDismissButton(e,t=0){let n=1;e===this._btnAction?n=1:e===this._btnCancel?n=0:e===this._btnSecondary?n=2:e===this._btnTertiary?n=3:e===this._btnQuaternary&&(n=4),this.validateAndHide(n,t)}logTelemetryInfo(e,t){if(this.ulsLogTelemetryInfo("Dialog"+s[e]),!C.a.isUserActionLoggingToOtelEnabled())return;const n=(e=>{let t=0;switch(e){case 0:t=A.a.dialogCancel;break;case 1:t=A.a.dialogAction;break;case 2:t=A.a.dialogSecondaryAction;break;case 3:t=A.a.dialogTertiaryAction}return t})(e);n?(f.d(n,!0,f.e,t,8),l.ULS.sendTraceTag(39978636,207,50,"Dialog action logged")):l.ULS.sendTraceTag(51500119,207,15,"Dialog action ID not found for DialogButton value: ",e)}ulsLogTelemetryInfo(e){const{AFrameworkApplication:t}=n(3245);if(!C.a.oldActionsPipelineIsEnabled())return;const a={};a.WacSessionId=t.userSessionId,a.ActionName=e,l.ULS.sendTraceTag(35489762,207,50,JSON.stringify(a))}validateAndHide(e,t=0){this.logTelemetryInfo(e,t),(0===e||this.validate())&&(this._messageBoxHandler&&this._messageBoxHandler(e),this._hideOnButtonClick&&this.hide())}initializeButton(e,t){this.setButtonVisiblity(e,!0),this.setButtonState(e,!0),this.setButtonText(e,t)}setButtonProperties(e,t){const n=t;e.setAttribute("type","button"),e.disabled=!this._buttonState[n],e.style.display=this._buttonDisplay[n]?"inline":"none",e.innerText=this._buttonText[n]}reSizeDialog(){const{AFrameworkApplication:e}=n(3245);e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("WacAutoFitNonModalDialogIsEnabled")?this.autoFitDialog()&&this.centerDialog():this._divMessageBox?(this.resetDialogStyle(),this._divMessageBox.clientWidth>this.getPageWidth()&&(this._divMessageBox.style.width=String.format("{0}px",this.getPageWidth()),this._divMessageBox.style.overflowX="scroll",this._divMessageBox.style.minWidth="0px"),this._divMessageBox.offsetParent&&this._divMessageBox.clientHeight+this._divMessageBox.offsetParent.offsetTop>this.getPageHeight()&&(this._divMessageBox.style.marginTop=-this._divMessageBox.offsetParent.offsetTop+"px"),this._divMessageBox.clientHeight>this.getPageHeight()&&(this._divMessageBox.style.height=String.format("{0}px",this.getPageHeight()),this._divMessageBox.style.overflowY="scroll"),this.centerDialog()):l.ULS.sendTraceTag(19409122,306,10,String.format("_divMessageBox is null in ResizeDialog(), already disposed: {0}",this._disposed))}autoFitDialog(){return this._divMessageBox?(this.resetDialogStyle(),this._divMessageBox.clientWidth>this.getPageWidth()&&(this._divMessageBox.style.width=String.format("{0}px",this.getPageWidth()),this._divMessageBox.style.overflowX="scroll",this._divMessageBox.style.minWidth="0px"),this._divMessageBox.offsetParent&&this._divMessageBox.clientHeight+this._divMessageBox.offsetParent.offsetTop>this.getPageHeight()&&(this._divMessageBox.style.marginTop=-this._divMessageBox.offsetParent.offsetTop+"px"),this._divMessageBox.clientHeight>this.getPageHeight()&&(this._divMessageBox.style.height=String.format("{0}px",this.getPageHeight()),this._divMessageBox.style.overflowY="scroll"),!0):(l.ULS.sendTraceTag(591013784,306,10,String.format("_divMessageBox is null in AutoFitDialog(), already disposed: {0}",this._disposed)),!1)}resetDialogStyle(){const{AFrameworkApplication:e}=n(3245);this._divMessageBox.style.height="auto",this._divMessageBox.style.width="auto",this._divMessageBox.style.overflowY="hidden",this._divMessageBox.style.overflowX="hidden",this._divMessageBox.style.marginTop="",this._divMessageBox.style.top="",e.isRtl?(this._divMessageBox.style.right="",this._divMessageBox.style.marginRight=""):(this._divMessageBox.style.left="",this._divMessageBox.style.marginLeft="")}sizeFix(e){this._overlayElement&&(this._overlayElement.style.height=String.format("{0}px",V.pageHeight),this._overlayElement.style.width=String.format("{0}px",V.pageWidth)),this._menuRootUser&&this._menuRootUser.closeDialogMenu(H),this.reSizeDialog()}setButtonVisiblity(e,t){const n=e;this._buttonDisplay[n]=t,this._buttons[n]&&(this._buttons[n].style.display=t?"inline":"none")}getButtonElement(e){let t=null;switch(e){case 0:t=this._btnCancel;break;case 1:t=this._btnAction;break;case 2:t=this._btnSecondary;break;case 3:t=this._btnTertiary;break;case 4:t=this._btnQuaternary}return t}setAriaAttributeForDialog(e,t){const{AFrameworkApplication:a}=n(3245);this._useReactDialog||(this._divMessageBox&&e&&t?this._divMessageBox.setAttribute(e,t):l.ULS.sendTraceTag(19449870,306,10,String.format("Invalid state in SetAriaAttributeForDialog(), _divMessageBox == null {0}, already disposed: {1}, AFrameworkApplication.ActiveFrame == null: {2}, ariaAttribute == null: {3}, value == null: {4}",!this._divMessageBox,this._disposed,!a.activeFrame,!e,!t)))}get hasButtons(){return 5!==this._buttonsOption}get hasCloseGlyph(){return this._hasCloseGlyph}set hasCloseGlyph(e){this._hasCloseGlyph=e}get isShowing(){return this._isShowing}get isModalDialog(){return this._isModalDialog}get dialogId(){return this._id}set dialogId(e){this._id=e}myId(e){return this._clientId+e}validate(){return!0}showOverlay(){this._overlayElement&&(this._overlayElement.style.height="100%",this._overlayElement.style.width="100%",this._overlayElement.style.top="0",this._overlayElement.style.left="0",this._overlayElement.style.display="block",this._showTransparentOverlay&&(this._overlayElement.style.opacity=".0"))}placeOverlayAboveDialog(){this._overlayElement&&(this._overlayElement.style.zIndex=String(parseInt(this._divOuterDialogContainer.style.zIndex)+1),this.showOverlay())}unblockOverlay(){this._overlayElement&&(this._overlayElement.style.display="none")}attachDialogEvents(){const{AFrameworkApplication:e}=n(3245);this.hasCloseGlyph&&!this._closeClickHandler&&this._clickManager&&(this._closeClickHandler=this.closeHandler,this._clickManager.registerHandler(g.a.click,this.closeIconElement,this._closeClickHandler)),this._divMessageBox&&this.attachFocusHandlersForCheckbox(this._divMessageBox),this.hasButtons&&(!this._buttonClickHandler&&this._clickManager&&(this._buttonClickHandler=this.clickHandler,this._clickManager.registerHandler(g.a.click,this._btnAction,this._buttonClickHandler),this._btnCancel&&this._clickManager.registerHandler(g.a.click,this._btnCancel,this._buttonClickHandler),this._btnSecondary&&this._clickManager.registerHandler(g.a.click,this._btnSecondary,this._buttonClickHandler),this._btnTertiary&&this._clickManager.registerHandler(g.a.click,this._btnTertiary,this._buttonClickHandler),this._btnQuaternary&&this._clickManager.registerHandler(g.a.click,this._btnQuaternary,this._buttonClickHandler)),!this._buttonKeyHandler&&this._keyInputManager&&(this._buttonKeyHandler=this.keyHandler,this._keyInputManager.registerHandler(g.a.keyDown,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.registerHandler(g.a.keyDown,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.registerHandler(g.a.keyDown,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.registerHandler(g.a.keyDown,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.registerHandler(g.a.keyDown,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.registerHandler(g.a.keyPress,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.registerHandler(g.a.keyPress,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.registerHandler(g.a.keyPress,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.registerHandler(g.a.keyPress,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.registerHandler(g.a.keyPress,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.registerHandler(g.a.keyUp,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.registerHandler(g.a.keyUp,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.registerHandler(g.a.keyUp,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.registerHandler(g.a.keyUp,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.registerHandler(g.a.keyUp,this._btnQuaternary,this._buttonKeyHandler)),this._divMessageBox&&this._keyInputManager&&(this._keyInputManager.registerHandler(g.a.keyDown,this._divMessageBox,this.dialogOnKeyDownHandler),this._keyInputManager.registerHandler(g.a.keyPress,this._divMessageBox,this.dialogOnKeyPressHandler),e.removeWacDialogKeyUpHandler||this._keyInputManager.registerHandler(g.a.keyUp,this._divMessageBox,this.dialogOnKeyUpHandler)))}detachDialogEvents(){const{AFrameworkApplication:e}=n(3245);this._closeClickHandler&&this._clickManager&&(this._clickManager.unregisterHandler(g.a.click,this.closeIconElement,this._closeClickHandler),this._closeClickHandler=null),this._divMessageBox&&this.detachFocusHandlersForCheckbox(this._divMessageBox),this._buttonClickHandler&&this._clickManager&&(this._clickManager.unregisterHandler(g.a.click,this._btnAction,this._buttonClickHandler),this._btnCancel&&this._clickManager.unregisterHandler(g.a.click,this._btnCancel,this._buttonClickHandler),this._btnSecondary&&this._clickManager.unregisterHandler(g.a.click,this._btnSecondary,this._buttonClickHandler),this._btnTertiary&&this._clickManager.unregisterHandler(g.a.click,this._btnTertiary,this._buttonClickHandler),this._btnQuaternary&&this._clickManager.unregisterHandler(g.a.click,this._btnQuaternary,this._buttonClickHandler),this._buttonClickHandler=null),this._buttonKeyHandler&&this._keyInputManager&&(this._keyInputManager.unregisterHandler(g.a.keyDown,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.unregisterHandler(g.a.keyDown,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.unregisterHandler(g.a.keyDown,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.unregisterHandler(g.a.keyDown,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.unregisterHandler(g.a.keyDown,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.unregisterHandler(g.a.keyPress,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.unregisterHandler(g.a.keyPress,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.unregisterHandler(g.a.keyPress,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.unregisterHandler(g.a.keyPress,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.unregisterHandler(g.a.keyPress,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.unregisterHandler(g.a.keyUp,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.unregisterHandler(g.a.keyUp,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.unregisterHandler(g.a.keyUp,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.unregisterHandler(g.a.keyUp,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.unregisterHandler(g.a.keyUp,this._btnQuaternary,this._buttonKeyHandler),this._divMessageBox&&(this._keyInputManager.unregisterHandler(g.a.keyDown,this._divMessageBox,this.dialogOnKeyDownHandler),this._keyInputManager.unregisterHandler(g.a.keyPress,this._divMessageBox,this.dialogOnKeyPressHandler),e.removeWacDialogKeyUpHandler||this._keyInputManager.unregisterHandler(g.a.keyUp,this._divMessageBox,this.dialogOnKeyUpHandler)),this._buttonKeyHandler=null)}show(e){const{AFrameworkApplication:t}=n(3245);if(this._disposed)throw Error.invalidOperation("This dialog has already been disposed and cannot be shown again");if(this.isShowing)return;this._useReactDialog&&null!=e?this.reactShow(e):(this._useReactDialog=!1,this.legacyShow()),t.activeFrame&&t.activeFrame.applicationInstance.isShyRibbonEnabled&&P.a.changeShyRibbonState(1,0),this._isShowing=!0;const a=t.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.IsSharedCustomDialogInvestigationEnabled")?`Dialog launched for Id: ${this.dialogId}. ControlValueId: ${e?.id}. IsReactDialog: ${this._useReactDialog}`:`Dialog launched for Id: ${this.dialogId}`;l.ULS.sendTraceTag(50402897,207,50,a),this.allowKeytips(!1)}update(e){const{AFrameworkApplication:t}=n(3245);this._useReactDialog&&null!=e?this.reactUpdate(e):(this._useReactDialog=!1,this.detachDialogEvents(),this.legacyShow()),t.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.IsSharedCustomDialogInvestigationEnabled")&&l.ULS.sendTraceTag(508078272,207,50,"Dialog updated for Id: {0}. ControlValueId: {1}. IsReactDialog: {2}",this.dialogId,e?.id,this._useReactDialog)}reactShow(e){this.addFocusScope(),e=this.setupReactControlValues(e),M.a.getDialogAPIAsync().then((t=>{t.show(e.id,e);const{AFrameworkApplication:a}=n(3245);return a.appSettingsManager?.isChangeGateEnabled("EnableReactComponentLoadedCallback")&&this.onReactComponentLoaded(),null}))}reactUpdate(e){e=this.setupReactControlValues(e),M.a.getDialogAPIAsync().then((t=>(t.update(e),null)))}setupReactControlValues(e){const{AFrameworkApplication:t}=n(3245);if(this._dialogValues=e,t.activeFrame){t.dismissSplashScreenImmediately(),t.activeFrame.beginModal(!1);const n={};n.activeDivZIndex=t.activeFrame.activeModalDivZIndex,e.dialogHostProperties=n}return e.dialogButtonsOption=void 0!==e.dialogButtonsOption&&null!==e.dialogButtonsOption?e.dialogButtonsOption:this.buttonsOption,e=this.addButtonProps(1,e),e=this.addButtonProps(2,e),e=this.addButtonProps(3,e),e=this.addButtonProps(4,e),(e=this.addButtonProps(0,e)).defaultExecutionButton=e.defaultExecutionButton||this._defaultButton,e.hideCloseButton=e.hideCloseButton||!this.hasCloseGlyph,e.canBeOverridden=e.canBeOverridden||this.canBePreempted,e.shouldOverrideExistingDialog=e.shouldOverrideExistingDialog||this._shouldPreemptExistingDialog,e.hidden=!1,e}addButtonProps(e,t){if(!this._buttonDisplay[e])return t;let n;switch(e){case 1:n="actionButtonProps";break;case 2:n="secondaryActionButtonProps";break;case 3:n="tertiaryActionButtonProps";break;case 4:n="quaternaryActionButtonProps";break;case 0:n="cancelButtonProps";break;default:return t}return t[n]=t[n]||{label:this._buttonText[e],disabled:!this._buttonState[e]},t}legacyShow(){const{AFrameworkApplication:e}=n(3245);if(e.activeFrame&&(e.activeFrame.prepareForDialog(),e.activeFrame.beginModal(!1),this._overlayElement&&(this._overlayElement.style.zIndex=String(e.activeFrame.activeModalDivZIndex)),this._divMessageBox.style.zIndex=String(e.activeFrame.activeModalUIZIndex),e.activeFrame.state=this.isModalDialog?1:2,V._dialogCloseHandler||(V._dialogCloseHandler=V.dialogClose,e.theActionManager.addAction(A.a.dialogClose,F.a.frame,V._dialogCloseHandler)),e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("AccessibleMovingDialogsEnabled")&&(V._dialogOpenMenuHandler||(V._dialogOpenMenuHandler=this.openDialogMenu,e.theActionManager.addAction(A.a.showDialogMenu,F.a.frame,V._dialogOpenMenuHandler)),V._dialogMoveModeHandler||(V._dialogMoveModeHandler=this.enterMovableMode,e.theActionManager.addAction(A.a.dialogMove,F.a.frame,V._dialogMoveModeHandler))),this.addFocusScope()),e.dismissSplashScreenImmediately(),V.setBackgroundVisibility("hidden"),this.showOverlay(),this.attachDialogEvents(),e.activeFrame&&e.activeFrame.applicationInstance.shouldResizeLegacyDialogBeforeFocus&&this.reSizeDialog(),this.hasButtons){const e=this.getButtonElement(this.getDefaultButton());this.setFocusOnElement(e)}e.activeFrame&&!e.activeFrame.applicationInstance.shouldResizeLegacyDialogBeforeFocus&&this.reSizeDialog()}addFocusScope(){if(h.FocusManager.usable()){const e=h.FocusManager.instance(),t=e.getScope(this.fullDialogFocusId);t.parent="app";const a=this._useReactDialog?this._divOuterDialogContainer:this._divMessageBox;0;const i=e.currentScope&&e.getCurrentRegion()&&e.getCurrentRegion().listing?e.getCurrentRegion().listing.currentElement:document.activeElement,o=["PreviewPanelOverlay","VersionHistoryOverlay","VersionHistoryHeader","CopilotCompose"],r=e.currentScope;T.a.isEditable(i)||r?.parent===h.FocusManager.editingFocusId||o.includes(r?.name)?(this._revertToLastScope=!0,e.pushScope(this.fullDialogFocusId,!1)):e.scopeChanged(this.fullDialogFocusId),this._useReactDialog||(t.bindAction(S.a.hashKey(_.a.vK_Escape,0),A.a.dialogClose),t.bindAction(S.a.hashKey(_.a.vK_Space,3),A.a.showDialogMenu));const s=new(n(5278).a)((()=>a));s.rememberFirstElement=!this.hasRovingTabIndex,s.addValidTag(3),s.addValidTag(2),s.addValidTag(4),s.addValidTag(1),s.addValidTag(6),s.addValidTag(5);const l=e.buildRegionWithDelegate((()=>a),e.getScope(this.fullDialogFocusId),s);if(l.rememberFocusStealers(),l.looped=this._tabOrderLooped,l.contained=!0,this._useReactDialog){t.keyDownHandledExternally=!0;const e=S.a.hashKey(_.a.vK_Tab,0),n=S.a.hashKey(_.a.vK_Tab,4);t.unBindAction(e),t.unBindAction(n),t.bindAction(e,A.a.doBrowserDefault),t.bindAction(n,A.a.doBrowserDefault)}}}removeFocusScope(){const{AFrameworkApplication:e}=n(3245);if(!h.FocusManager.usable()||e.isShuttingDown||V.isFocusScopeFixEnabled&&!this.isShowing)return;const t=h.FocusManager.instance();this._revertToLastScope?(this._revertToLastScope=!1,t.popScope(this.fullDialogFocusId)):this.dismissFocusScope?t.setScope(this.dismissFocusScope):e.activeFrame?.applicationInstance.dialogReturnsToPreviousEditableScope&&null!==t.previousEditableScopeName?t.setScope(t.previousEditableScopeName):t.setScope(t.defaultScopeName);const a=t.getRegion(this.fullDialogFocusId);a&&a.listing.trySetCurrentElement(null),t.removeScope(this.fullDialogFocusId)}setFocusOnElement(e){h.FocusManager.usable()?h.FocusManager.instance().getRegion(this.fullDialogFocusId).listing.forceSetCurrentElement(e):e.focus()}setButtonText(e,t){const n=e;this._buttonText[n]=t,this._buttons[n]&&(this._buttons[n].innerText=t)}getButtonText(e){return this._buttonText[e]}setButtonState(e,t){const n=e;this._buttonState[n]=t,this._buttons[n]&&(this._buttons[n].disabled=!t)}getButtonState(e){return this._buttonState[e]}setDefaultButton(e){this._defaultButton=e}getDefaultButton(){return this._defaultButton}setLabelledByForDialog(e){this.setAriaAttributeForDialog(I.a.ariaLabelledByAttribute,e)}setDescribedByForDialog(e){this.setAriaAttributeForDialog(I.a.ariaDescribedByAttribute,e)}hide(){this.hideInternal(!1)}hidePreservingMessageBoxElement(){this.hideInternal(!0)}hideInternal(e){this._isDisposingAsync||(this._useReactDialog?this.reactHideInternal(e):this.legacyHideInternal(e),this._disposeOnHide&&!e&&this.dispose())}reactHideInternal(e){const{AFrameworkApplication:t}=n(3245);e&&M.a.getDialogAPIAsync().then((e=>(e.hide(),null))),t.activeFrame&&(t.activeFrame.endModal(!1),t.activeFrame.state=0,this.removeFocusScope()),this._isShowing=!1,this.allowKeytips(!0)}legacyHideInternal(e){const{AFrameworkApplication:t}=n(3245);this.isShowing&&(t.activeFrame&&t.activeFrame.endModal(!1),this._overlayElement&&(this._overlayElement.style.zIndex="-1"),this._divMessageBox.style.zIndex="-1",V.setBackgroundVisibility("visible"),t.activeFrame&&(t.activeFrame.state=0,this.removeFocusScope()),this.detachDialogEvents(),e?(this._overlayElement.style.display="none",this._divMessageBox.style.display="none"):(this._overlayElement&&this.removeElement(this._overlayElement),this._divOuterDialogContainer?this.removeElement(this._divOuterDialogContainer):l.ULS.sendTraceTag(25247879,207,50,"DivOuterDialogContainer is null")),this._isShowing=!1,this.allowKeytips(!0))}allowKeytips(e){this.isReactRibbonEnvironmentEnabled&&y.a("allowKeytips")&&this.isModalDialog&&appChrome.api.allowKeytips(e)}static areRegionComposerAPIsAvailable(){const{AFrameworkApplication:e}=n(3245);return!!e.activeFrame&&e.activeFrame.applicationInstance.isRegionComposerEnabled&&!!e.activeFrame.adaptiveLayoutInstance}static setBackgroundVisibility(e){const t=["object"];for(let n=0;n<t.length;n++){const a=t[n],i=document.getElementsByTagName(a);for(let t=i.length-1;t>=0;t--)(!i[t].className||-1===i[t].className.indexOf(V._objectInDialogCssClass)&&-1===i[t].className.indexOf(V._addinIframeCssClass))&&(i[t].style.visibility=e)}}static dialogClose(e,t,n,a,i){const o=D.a;return o?1===n?32:o.hasCloseGlyph?(o.validateAndHide(0,1),32):2:16}static get pageWidth(){return window.document.documentElement.clientWidth}static get pageHeight(){return window.document.documentElement.clientHeight}static get posLeft(){return window.document.documentElement.scrollLeft}static get posTop(){return window.document.documentElement.scrollTop}static isNumber(e){return!isNaN(parseInt(e))}static isPositive(e){let t=!1;const n=parseInt(e);return!isNaN(n)&&n>=0&&(t=!0),t}constructor(e=!1,t=!1,a=!1,i=!1,o=!0){super(document.createElement("div")),this._id=null,this._dialogParentId=null,this._dialogPanelCssClass=U,this._messageBoxHandler=null,this._closeClickHandler=null,this._buttonClickHandler=null,this._buttonKeyHandler=null,this._clickManager=null,this._keyInputManager=null,this._dragAdapter=null,this._keyAdapter=null,this._windowScrollHandler=null,this._windowResizeHandler=null,this._btnAction=null,this._btnCancel=null,this._btnSecondary=null,this._btnTertiary=null,this._btnQuaternary=null,this._overlayElement=null,this._divOuterDialogContainer=null,this._divInnerDialogContainer=null,this._divMessageBox=null,this._bodyPanel=null,this._divMessageBoxTitle=null,this._buttonPanel=null,this._body=null,this._titleText=null,this._outerBody=null,this._menuLaunchPoint=null,this._okText="OK",this._cancelText="Cancel",this._closeText="Close",this._yesText="Yes",this._noText="No",this._retryText="Retry",this._permanentlyDeleteText="Permanently Delete",this._shareAndNotifyText="Share and notify",this._actionText="Action",this._secondaryActionText="Secondary Action",this._tertiaryActionText="Tertiary Action",this._quaternaryActionText="Quaternary Action",this._buttonText=new Array(3),this._buttonState=new Array(3),this._buttonDisplay=new Array(3),this._buttons=new Array(3),this._width=15,this._buttonsOption=0,this._keystrokeOnButtonPending=!1,this._revertToLastScope=!1,this._hasCloseGlyph=!1,this._windowMode="undefined",this._isRegisteredWithRegionComposer=!1,this._rectsWithoutKeyboard=[],this._disposed=!1,this._isDisposingAsync=!1,this._tabOrderLooped=!0,this._disposeOnHide=!0,this._hideOnButtonClick=!0,this._showTransparentOverlay=!1,this._dialogValues=null,this._closeAnchor=null,this._closeIconElement=null,this._dialogOnKeyDownHandler=null,this._dialogOnKeyPressHandler=null,this._dialogOnKeyUpHandler=null,this._overlayCssClass=O,this._menuRootUser=null,this._dismissFocusScope=null,this.isSDXDialog=!1,this._isShowing=!1,this.clickHandler=e=>(this.executeDismissButton(e.sourceElement,2),!0),this.keyHandler=e=>this.keyHandlerWithAction(e,this.executeDismissButtonFromArgs),this.executeDismissButtonFromArgs=e=>{this.executeDismissButton(e.sourceElement,1)},this.openDialogMenu=(e,t,n,a,i)=>{if(!this.menuLaunchPoint||!this.menuRootUser)return 16;V._dialogMenuInit||(this.menuRootUser.createDialogMenu(H,"1245654357","844297214"),V._dialogMenuInit=!0);const o=v.a.getElementLocation(this.menuLaunchPoint);return this.menuRootUser.showDialogMenuAt(H,o.x,o.y,1),32},this.enterMovableMode=(e,t,n,a,i)=>1===n?32:D.a&&this.keyMoveAdapter?(this.keyMoveAdapter.enterMoveMode(this.dialogElement),32):16,this.closeHandler=e=>(this.validateAndHide(0,2),!0),this.scrollFix=e=>{this._overlayElement&&(this._overlayElement.style.top=String.format("{0}px",V.posTop),this._overlayElement.style.left=String.format("{0}px",V.posLeft))};const{AFrameworkApplication:r}=n(3245);this._shouldPreemptExistingDialog=e,this._isModalDialog=o,this._useReactDialog=r.activeFrame?a&&r.activeFrame.applicationInstance.isReactDialogEnabled:a,D.a&&(D.a.canBePreempted||e)&&!i&&D.a.hide(),(0,D.b)(this);try{this._okText=(0,E.a)("DialogOk"),this._cancelText=(0,E.a)("DialogCancel"),this._closeText=(0,E.a)("DialogClose"),this._yesText=(0,E.a)("DialogYes"),this._noText=(0,E.a)("DialogNo"),this._retryText=(0,E.a)("DialogRetry"),this._permanentlyDeleteText=(0,E.a)("DialogPermanentlyDelete"),this._shareAndNotifyText=(0,E.a)("DialogShareAndNotify")}catch(e){}this.isReactRibbonEnvironmentEnabled=!!r.activeFrame&&(r.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled||r.activeFrame.applicationInstance.isReactSharedHeaderUxEnabled);try{this._outerBody=this.isReactRibbonEnvironmentEnabled&&!t||"PreviewPanelOverlay"===h.FocusManager.instance().currentScope.name?document.body:r.activeFrame.getDOMElement()}catch(e){this._outerBody=document.body}this._document=this._outerBody.ownerDocument,this._clientId=this.get_element().id,this.buttonsOption=1,this._defaultButton=1,this.hasTitleBar=!0,this.hasCloseGlyph=!0,this.hasButtonPanel=!0,this._useReactDialog&&(this._divOuterDialogContainer=this._document.createElement("div"),this._divOuterDialogContainer.id=this.myId(x),this._divOuterDialogContainer.className=L,this._outerBody.insertBefore(this._divOuterDialogContainer,this._outerBody.firstChild),M.a.getDialogAPIAsync().then((e=>(e.initialize(this._divOuterDialogContainer),null))))}}V._dialogMenuInit=!1,V.dialogFocusId="dialog",V._actionButtonId="WACDialogActionButton",V._secondaryButtonId="WACDialogSecondaryButton",V._tertiaryButtonId="WACDialogTertiaryButton",V._quaternaryButtonId="WACDialogQuaternaryButton",V._cancelButtonId="WACDialogCancelButton",V._objectInDialogCssClass="ObjectInDialog",V._addinIframeCssClass="AddinIframe",V._dialogCloseHandler=null,V._dialogOpenMenuHandler=null,V._dialogMoveModeHandler=null,(0,a.a)(V,"Dialog",Sys.UI.Control,[])},7442:function(e,t,n){"use strict";async function a(e,...t){switch(e){case 2:return new((await n.e(1).then(n.bind(n,3696))).StandardDialog)(...t);case 11:return new((await n.e(1).then(n.bind(n,3563))).CustomDialog)(...t);case 1:return new((await n.e(1).then(n.bind(n,5892))).DummyDialog);case 3:return new((await n.e(1).then(n.bind(n,6935))).CrashDialog);case 12:return new((await n.e(1).then(n.bind(n,6796))).PageStatsDialog)(...t);case 6:return new((await n.e(1).then(n.bind(n,3467))).SessionExpirationDialog)(...t);case 7:return new((await n.e(1).then(n.bind(n,7162))).CommercialPrivacyNoticeDialog);case 8:return new((await n.e(1).then(n.bind(n,1096))).ReactCommercialPrivacyNoticeDialog);case 9:return new((await n.e(1).then(n.bind(n,7607))).LoadingDialog)(...t);case 15:return new((await n.e(1).then(n.bind(n,9011))).SharedAuthConsentDialog)(...t);case 16:return new((await n.e(1).then(n.bind(n,7232))).ReactProgressDialog)(...t);default:throw new Error(`Unknown custom dialog type: ${String(e)}`)}}n.d(t,{a:function(){return a}})},8706:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5278),o=n(629);class r{dispose(){this._validElements=null}get currentElement(){return this._validElements[this._currentIndex]}trySetCurrentElement(e){return this.setCurrentElement(e,!1),!0}forceSetCurrentElement(e){this.setCurrentElement(e,!0)}setCurrentElement(e,t){e&&(this.currentElement!==e||t)&&(e.tabIndex=0,o.FocusManager.tryFocus(e)),Array.contains(this._validElements,e)&&(this._currentIndex=Array.indexOf(this._validElements,e))}get previousElement(){let e=this._currentIndex;do{if(e){if(!(e>0&&e<this._validElements.length)){0;break}e--}else e=this._validElements.length-1}while(!i.a.elementFocusable(this._validElements[e])&&e!==this._currentIndex);return this._validElements[e]}get nextElement(){let e=this._currentIndex;do{if(e===this._validElements.length-1)e=0;else{if(!(e>=0&&e<this._validElements.length-1)){0;break}e++}}while(!i.a.elementFocusable(this._validElements[e])&&e!==this._currentIndex);return this._validElements[e]}get firstElement(){let e=0;for(;!i.a.elementFocusable(this._validElements[e])&&e<this._validElements.length;)e++;return i.a.elementFocusable(this._validElements[e])?this._validElements[e]:null}get lastElement(){let e=this._validElements.length-1;for(;!i.a.elementFocusable(this._validElements[e])&&e>0;)e--;return i.a.elementFocusable(this._validElements[e])?this._validElements[e]:null}constructor(e){this._validElements=e,this._currentIndex=Array.indexOf(this._validElements,this.firstElement)}}(0,a.a)(r,"DialogFocusListing",null,[92])},7989:function(e,t,n){"use strict";n.d(t,{a:function(){return a},b:function(){return i}});let a=null;function i(e){a=e}},9675:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(205),o=n(9858);class r{static isNumber(e){return!isNaN(parseInt(e))}static get pageWidth(){return window.document.documentElement.clientWidth}static get pageHeight(){return window.document.documentElement.clientHeight}static formatHtml(e,...t){return String.format.apply(null,[e].concat(i.d(i.c(i.a(t),o.a.htmlEncode))))}}r.dialogFocusId="dialog",r.fontSizeInitialValue=-1,(0,a.a)(r,"DialogStatics",null,[])},2500:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(7057);class o extends i.a{constructor(e){super(2,e)}}(0,a.a)(o,"HideAnimationEvent",i.a,[])},3949:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("CommonUI.IBusinessBar")},1489:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(7057);class o extends i.a{constructor(e){super(3,e)}}(0,a.a)(o,"MoveAnimationEvent",i.a,[])},6796:function(e,t,n){"use strict";n.r(t),n.d(t,{PageStatsDialog:function(){return d}});var a=n(100),i=n(3563),o=n(3245),r=n(1450),s=n(9123);class l{}l.dialogHtml="<div class='WACDialogRow' id='PageStatsResultBlock'> <textarea id='PageStatsResult' class='PageStatsResult' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div> <div class='WACDialogCheckBoxDiv' id='PageStatsAutoApplyBlock'> <input type='checkbox' id='PageStatsAutoApplyCheckBox' class='WACDialogCheckBox' title='Apply showpagestats automatically'></input> <label id='\"\"' class='WACDialogLabel' for='PageStatsAutoApplyCheckBox' >Apply showpagestats automatically</label> </div>",(0,a.a)(l,"PageStatsDialogHtml",null,[]);var c=n(8103);class d extends i.CustomDialog{appendText(e){o.AFrameworkApplication.showPageStats&&(this._textAreaElement.value=this._textAreaElement.value+e)}getHeightMinusPadding(e,t){const n=s.a.getCurrentStyle(t),a=e-Number.parseInvariant(n.paddingTop.replace("px",""))-Number.parseInvariant(n.paddingBottom.replace("px",""));return a<0?0:a}getWidthMinusOffset(e,t){const n=e-t.offsetLeft;return n<0?0:n}getWidthMinusPadding(e,t){const n=s.a.getCurrentStyle(t),a=e-Number.parseInvariant(n.paddingLeft.replace("px",""))-Number.parseInvariant(n.paddingRight.replace("px",""));return a<0?0:a}setDialogProperties(e){super.setDialogProperties(e),this.setPageStatsDialogProperties()}setPageStatsDialogProperties(){let e=2*r.a.pageWidth/3;e=e>600?600:e,e=e<50?50:e;const t=Number.parseInvariant(this._divMessageBox.style.top.replace("px",""));let n=r.a.pageHeight-(t<0?0:t)-50;n=n<50?50:n,this._divMessageBox.style.width=String.format("{0}px",e),this._divMessageBox.style.height=String.format("{0}px",n);const a=this._body.parentNode;const i=this._textElement.children[0];const o=i.children[0],s=new Sys.UI.Bounds(0,0,0,0);s.height=this._divMessageBox.clientHeight-a.offsetTop-this._buttonPanel.offsetHeight,s.width=this.getWidthMinusOffset(this._divMessageBox.clientWidth,a),s.height=this.getHeightMinusPadding(s.height,a),s.height=this.getHeightMinusPadding(s.height,i),s.width=this.getWidthMinusPadding(s.width,a),o.style.height=String.format("{0}px",s.height),o.style.width=String.format("{0}px",s.width)}sizeFix(e){this.setPageStatsDialogProperties(),super.sizeFix(e)}constructor(e,t){super(),this.pageStatsDialogHandler=(e,t)=>{this._pageStatsControl.dialogClosed()},this.dialogHtml=l.dialogHtml,this.dialogId="PageStatsDialog",this.buttonsOption=0,this.setButtonText(1,(0,c.a)("DialogClose"));const n={PageStatsResult:t};this.initializeAndShow("ShowPageStats",this.pageStatsDialogHandler,n),this.setDescribedByForDialog(this.myId("PageStatsResultBlock")),this._textAreaElement=document.getElementById("PageStatsResult"),this._textAreaElement.focus(),this._pageStatsControl=e}}(0,a.a)(d,"PageStatsDialog",i.CustomDialog,[])},6912:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(1207);class o{get text(){return this._text}set text(e){this._text!==e&&(this._text=e,this._textSpan&&(this._textSpan.innerText=this._text,this.setImageAltText(this._text)))}get element(){return this._progressSpan}createAndAttach(e,t){this._progressSpan=document.createElement("span"),this._progressSpan.setAttribute("Unselectable","on"),this._imageElement=this.createImageElement(t,e),this._imageElement.setAttribute("Unselectable","on"),this._textSpan=this.createTextElement(),this._textSpan.setAttribute("Unselectable","on"),this.setCssClasses(),this._progressSpan.appendChild(this._textSpan),this._progressSpan.appendChild(this._imageElement),this.text=e}setCssClasses(){}createTextElement(){return document.createElement("span")}createImageElement(e,t){const n=document.createElement("img");return n.src=i.a.commonImage(e),n}setImageAltText(e){this._imageElement.alt=e}setTitle(e){this._imageElement.title=e}setVisibility(e,t){this._imageElement.style.display=e?"inline":"none",this._textSpan.style.display=t?"inline":"none"}dispose(){this._progressSpan=null,this._textSpan=null,this._imageElement=null}constructor(){this._text="",this._progressSpan=null,this._textSpan=null,this._imageElement=null}}(0,a.a)(o,"ImageAndTextControl",null,[11]);const r="WACProgressImage",s="WACProgressText",l="progress.gif";class c extends o{get isSmall(){return this._isSmall}set isSmall(e){this._isSmall!==e&&(this._isSmall=e,this.setImageCss(this._isSmall))}setCssClasses(){this._progressSpan.className="WACProgress",this._imageElement.className=r,this._textSpan.className=s}setImageCss(e){e?(this._imageElement.className="WACProgressSmallImage",this._imageElement.src=i.a.commonImage("progress16.gif"),this._textSpan.className="WACProgressSmallText"):(this._imageElement.className=r,this._imageElement.src=i.a.commonImage(l),this._textSpan.className=s)}constructor(e){super(),this._isSmall=!1,this.createAndAttach(e,l)}}(0,a.a)(c,"Progress",o,[])},6127:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(3245),o=n(3563),r=n(1207),s=n(7072);class l{}l.html="<div class='WACProgressRow' id='block1'> <img id='WACProgressImg' class='WACProgressIcon' role='presentation' /> <label id='WACProgressText' class='WACProgressTextPanel' >Loading</label> </div>",(0,a.a)(l,"ProgressDialogHtml",null,[]);var c=n(8103);class d extends o.CustomDialog{get message(){return this._progressMessage}set message(e){this._progressMessage=e}prepareDialog(){super.prepareDialog(),this._progressStatusAriaUpdateEnabled&&(this._divMessageBox.setAttribute(s.a.ariaRoleAttribute,"progressbar"),this._divMessageBox.setAttribute(s.a.ariaValueMinAttribute,"0"),this._divMessageBox.setAttribute(s.a.ariaValueMaxAttribute,"100"),this._divMessageBox.setAttribute(s.a.ariaValueNowAttribute,"0")),this.dialogHtml=l.html,this._divMessageBox.style.minWidth="120px",this._divMessageBox.style.maxWidth="400px",this._buttonPanel.className="WACProgressButtonSection",this.setDescribedByForDialog("WACProgressText"),this.hasCloseGlyph||this.hasButtons?this._divMessageBox.style.minWidth="300px":(this._divMessageBoxTitle.style.display="none",this._buttonPanel.style.display="none"),this.hasButtons||(this._divMessageBox.tabIndex=0)}showProgressDialog(e,t,n){this._progressDialogHandler=t,this._progressDialogHandlerData=n,this.initializeAndShow(e,this.baseDialogHandler$4,{WACProgressText:this.message,WACProgressImg:r.a.commonImage("progress.gif")}),this._divMessageBox.style.width="auto",this.hasButtons||this._divMessageBox.focus()}showCustomizedProgressDialog(e,t,n){this.initializeAndShow(e,t,n)}updateAriaNowValue(e){this.isShowing&&this._divMessageBox&&this._divMessageBox.setAttribute(s.a.ariaValueNowAttribute,String.format("{0}",e))}close(){this.hide()}constructor(e=!1){super(),this._progressMessage=(0,c.a)("DialogLoading"),this._progressDialogHandler=null,this._progressDialogHandlerData=null,this.baseDialogHandler$4=(e,t)=>{this._progressDialogHandler&&this._progressDialogHandler(this._progressDialogHandlerData)},this.dialogId="ProgressDialog",this.buttonsOption=6,this.setButtonText(0,(0,c.a)("DialogCancel")),this._progressStatusAriaUpdateEnabled=e}}(0,a.a)(d,"ProgressDialog",o.CustomDialog,[86]);var u=n(7232);class p{create(e=!1){return i.AFrameworkApplication.activeFrame&&i.AFrameworkApplication.activeFrame.applicationInstance.isReactDialogEnabled&&i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactProgressDialogIsEnabled")?new u.ReactProgressDialog(e):new d(e)}}(0,a.a)(p,"ProgressDialogFactory",null,[87])},7232:function(e,t,n){"use strict";n.r(t),n.d(t,{ReactProgressDialog:function(){return r}});var a=n(100),i=n(3563),o=n(8103);class r extends i.CustomDialog{get message(){return this._progressMessage}set message(e){this._progressMessage=e}showProgressDialog(e,t,n){this._title=e,this._progressDialogHandler=t,this._progressDialogHandlerData=n;const a={id:this.dialogId,bodyControls:this.getProgressDialogProps()};this.initializeAndShow(this._title,this.baseDialogHandler$4,a)}close(){this.hide()}showCustomizedProgressDialog(e,t,n){}updateAriaNowValue(e){this._valueNow=e;const t={id:this.dialogId,bodyControls:this.getProgressDialogProps()};this.updateDialog(this._title,this.baseDialogHandler$4,t)}getProgressDialogProps(){const e={};if(e.spinnerProps={type:"AppSpinnerProps",label:this.message},this._progressStatusAriaUpdateEnabled){const t=e.spinnerProps;t.minValue=0,t.maxValue=100,t.valueNow=this._valueNow}return e}constructor(e=!1){super(!1,!1,!0),this._progressMessage=(0,o.a)("DialogLoading"),this._progressDialogHandler=null,this._progressDialogHandlerData=null,this._title=null,this._valueNow=0,this.baseDialogHandler$4=(e,t)=>{this._progressDialogHandler&&this._progressDialogHandler(this._progressDialogHandlerData)},this.dialogId="ProgressDialog",this.buttonsOption=6,this._progressStatusAriaUpdateEnabled=e,this._progressStatusAriaUpdateEnabled&&(this._valueNow=0)}}(0,a.a)(r,"ReactProgressDialog",i.CustomDialog,[86])},383:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(6101);class o{static renderIcon(e,t){i.a("renderIcon")&&appChrome.api.renderIcon(e,t)}static renderCoPilotIcon(e,t){i.a("renderCoPilotIcon")&&appChrome.api.renderCoPilotIcon(e,t)}}(0,a.a)(o,"RenderIconUtility",null,[])},681:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(7057);class o extends i.a{constructor(e){super(6,e)}}(0,a.a)(o,"ShowAnimationEvent",i.a,[])},3696:function(e,t,n){"use strict";n.r(t),n.d(t,{StandardDialog:function(){return P}});var a=n(100),i=n(5149),o=n(625),r=n(1450),s=n(385);class l{}l.sessionIdString="sessionID",l.P1="p1",l.P2="p2",l.appMode="AppMode",l.appVersion="Version",l.isProd="isProd",l.isMac="isMac",l.isIPad="isIPad",l.flightId="FlightId",l.crash="Crash",l.featureName="FeatureName",l.featureData="FeatureData",l.error="Error",l.errorCode="ErrorCode",l.officeBrowserFeedbackComment="officeBrowserFeedbackComment",l.officeBrowserFeedbackContactInfoEmailInput="officeBrowserFeedbackContactInfoEmailInput",l.feedbackOverall="feedbackOverall",l.dismissHandler="DismissHandler",(0,a.a)(l,"CustomerFeedbackParams",null,[]);var c=n(7531),d=n(4361),u=n(6124),p=n(4852),g=n(988),h=n(8103),m=n(7296),_=n(657),S=n(6776),f=n(2274),C=n(4671),y=n(1307),A=n(5374);const b="WACDialogDontShow",T="WACDialogHelpLink",v="WACDialogFeedbackLink",w="WACDialogDownloadLink",F="WACDialogExtraLink",I="WACSaveErrorReportTitle",E="WACSaveErrorReportDescription",M="WACSaveErrorReportPrivacy",k="Common.App.CustomerFeedback";class P extends r.a{get isErrorDialog(){return this._isErrorDialog}set isErrorDialog(e){this._isErrorDialog=e}get isImprovedCrashDialogEnabled(){return f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IsBetterErrorHandlingEnabled")||f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IsCrashDialogImprovementEnabled")||f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IsWordImprovedCrashDialogEnabled")}get showMicrosoftLogo(){return this._showMicrosoftLogo}set showMicrosoftLogo(e){this._showMicrosoftLogo=e}get notifyHandlersBeforeDismiss(){return this._notifyHandlersBeforeDismiss}set notifyHandlersBeforeDismiss(e){this._notifyHandlersBeforeDismiss=e}set maxWidth(e){this._maxWidth=e}dispose(){this._iconPanel=null,this._textElement=null,this._textPanel=null,this._checkboxPanel=null,this._dontShowCheckBox=null,this._contentRow=null,this._helpLink&&(c.a.removeHandler(this._helpLink,"click",this.onHelpClickHandler),this._helpLink=null),this._feedbackLink&&(c.a.removeHandler(this._feedbackLink,"click",this._feedbackLinkClickHandler),this._feedbackLink=null,this._feedbackDescription=null,this._feedbackPanel=null,this._showFeedbackPanel=!1,this._feedbackUIParameters=null),this._resourcesLink&&(c.a.removeHandler(this._resourcesLink,"click",this._resourcesLinkClickHandler),this._resourcesLink=null,this._resourcesPanel=null),this._logsScriptPanel&&(this._logsScriptDescription=null,this._logsScript=null,this._logsScriptPanel=null),this._downloadLink&&(this._downloadLink=null,this._showDownloadLink=!1),this._privacyPolicyLink&&(c.a.removeHandler(this._privacyPolicyLink,"click",this._privacyPolicyLinkClickHandler),this._privacyPolicyLink=null,this._saveErrorReportDescription=null,this._saveErrorReportTitle=null,this._saveErrorReportPanel=null,this._showSaveErrorReportPanel=!1),super.dispose()}prepareDialog(){super.prepareDialog(),this._contentRow=this._document.createElement("div"),this._contentRow.className="WACDialogRow",this._body.appendChild(this._contentRow),this._iconPanel=this._document.createElement("div"),this._iconPanel.id=this.myId("WACDialogIconPanel"),this._iconPanel.className="WACDialogIcon",this._contentRow.appendChild(this._iconPanel),this._textPanel=this._document.createElement("div"),this._textPanel.id=this.myId("WACDialogTextPanel"),this._textPanel.className="WACDialogTextPanel",this._contentRow.appendChild(this._textPanel),this._textElement=this._document.createElement("div"),this._textElement.id=this.myId("WACDialogText"),this._textPanel.appendChild(this._textElement),f.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.BlueChickenDebugDialog")&&void 0!==f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("AppSpecificTroubleshootingURL")&&null!==f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("AppSpecificTroubleshootingURL")&&(this._showTroubleshootingResources=!0,this._logsScriptInnerText="wac uls latest"),this._showDownloadLink&&this.appendDownloadLink(),this._showHelpLink&&C.a.isHelpAvailable()&&this.appendHelpLink(),this._showFeedbackPanel&&this.appendFeedbackLinkPanel(),this._showTroubleshootingResources&&(this.appendLogsScript(),this.appendResourcesLinkPanel()),(this.showSessionId||this._showTroubleshootingResources)&&this.appendSessionId(),this._showSaveErrorReportPanel&&this.appendSaveErrorReportPanel()}getAdditionalMessageIds(){return this._showSaveErrorReportPanel?String.format("{0} {1} {2}",I,E,M):""}useSimpleErrorDialog(){return this.isErrorDialog&&!y.a.isDialogAPILoaded()&&!s.a.get_instance().isCompleted(7)}messageBoxImpl(e,t,n,a=null,i=null,o=null,r=!1){if(this.dialogId=void 0===this.dialogId||null===this.dialogId?p.a.randomBetween(0,Number.MAX_VALUE).toString():this.dialogId,this._useReactDialog){if(null==o&&!this.useSimpleErrorDialog())return void this.reactMessageBoxImpl(e,t,n,a,i,r);this._useReactDialog=!1,y.a.getDialogAPIAsync().then((e=>(e.dispose(),null)))}this.legacyMessageBoxImpl(e,t,n,a,i,o,r)}reactMessageBoxImpl(e,t,n,a=null,i=null,o=!1){this._messageBoxHandler=this.baseDialogHandler,this._standardDialogHandler=i;const r={type:"StandardDialogProps",id:this.dialogId,headerText:e,titleText:t,additionalBodyTextContent:this._additionalBodyTextContent,dialogIcon:this._dialogIcon,resultHandler:this._messageBoxHandler,messageAreaLink:this._showExtraLink?this.createReactLinkProps(F):null,downloadLink:this._showDownloadLink?this.createReactLinkProps(w):null,helpLink:this._showHelpLink&&C.a.isHelpAvailable()?this.createReactLinkProps(T):null,feedbackDescription:this._showFeedbackPanel&&!this._hideFeedbackDescription?this._feedbackDescriptionText:null,feedbackLink:this._showFeedbackPanel?this.createReactLinkProps(v):null,sessionId:this.showSessionId?String.format(this._sessionInfoText,S.AFrameworkApplicationConstants.userSessionId):null,permanentDismissCheckbox:this.isDismissable?this.createReactDismissCheckboxProps():null,saveErrorReportTitle:this._showSaveErrorReportPanel?this._saveErrorReportTitleText:null,saveErrorReportDescription:this._showSaveErrorReportPanel?this._saveErrorReportDescriptionText:null,privacyPolicyLink:this._showSaveErrorReportPanel?this.createReactLinkProps(M):null,renderMicrosoftLogoInHeader:this._showMicrosoftLogo,maxWidth:this._maxWidth,isClickableOutsideFocusTrap:!!f.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:9906798_V8DialogClickableOutsideFocusTrap")||void 0};o?this.update(r):this.show(r)}legacyMessageBoxImpl(e,t,n,a=null,o=null,r=null,s=!1){if(this.prepareDialog(),this._messageBoxHandler=this.baseDialogHandler,this._standardDialogHandler=o,t||null!=r||(t=" "),t){if(this._textElement.innerText=t,this._showExtraLink&&(this._extraLink=this._document.createElement("a"),this._extraLink.href=this._extraLinkUrl,this._extraLink.id=F,this._extraLink.innerText=this._extraLinkText,this._extraLink.target="_blank",this._textElement.appendChild(this._document.createTextNode(" ")),this._textElement.appendChild(this._extraLink)),this._additionalBodyTextContent?.textContent?.length>0&&(i.ULS.sendTraceTag(507253018,207,50,"StandardDialog.legacyMessageBoxImpl - directive was shown in legacy dialog."),this._additionalBodyTextContent.textContent.forEach((e=>{const t=this._document.createElement("p"),n=e.match(/\{(\d+)\}/);if(n){const a=parseInt(n[1]);if(!isNaN(a)&&this._additionalBodyTextContent.links?.length>a){e=this._additionalBodyTextContent.links[a].text;const n=this._document.createElement("a");n.innerText=e;const{onExecute:o,handler:r}=this._additionalBodyTextContent.links[a];o?(n.onclick=o,n.href="#"):r?.href?n.href=r.href:i.ULS.sendTraceTag(507064467,207,20,"StandardDialog.legacyMessageBoxImpl - the link was created without an onExecute function and without a handler."),t.appendChild(n)}}else t.innerText=e;this._textElement.appendChild(t)}))),t.trim().length>0){let e=this._textElement.id;const t=this.getAdditionalMessageIds();t&&t.length>0&&(e=String.format("{0} {1}",e,t)),this.setDescribedByForDialog(e)}}else this._textElement.appendChild(r);n?this._iconPanel.appendChild((0,A.a)(32,32,n,null,!0,a)):this._contentRow.removeChild(this._iconPanel),this._bodyPanel.style.maxWidth="375px",this._divMessageBox.style.display="Block",this.isDismissable&&this.setupCheckBoxPanel(),this._titleText.innerText=e,s?this.update():this.show()}showWarning(e,t,n=null){this.messageBox(e,t,1,n)}showError(e,t,a,o=null,r=!1,s=!1,c=!1){const{AFrameworkApplication:u}=n(3245);if(f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("ShowSessionIdOnError")&&(this.showSessionId=!0),i.ULS.sendTraceTag(38111394,207,50,"Show error dialog. ErrorType: {0}",e),r||u.reportError(e,void 0,u.errorDialogAdditionalQosVetos),this.shouldShowFeedbackLinkForError(e)&&S.AFrameworkApplicationConstants.activeFrame&&!this._removeFeedbackPanel)try{d.a.instance.tryInitializePackage(k),this._feedbackUIParameters=this._feedbackUIParameters?this._feedbackUIParameters:{},this._feedbackUIParameters[l.error]=!0,this._feedbackUIParameters[l.crash]=P.isCrashingErrorCode(e),this._feedbackUIParameters[l.errorCode]=e,this._showFeedbackPanel=!0}catch(e){i.ULS.sendTraceTag(537171360,207,10,"Failed to show 'Send Feedback' link. Exception: {0}",e)}const p=s?1:2;this._hideFeedbackDescription=c,this.isErrorDialog=!0,this.isImprovedCrashDialogEnabled?this.messageBox(t,a,0,o):this.messageBox(t,a,p,o)}showInformation(e,t,n=null){try{d.a.instance.tryInitializePackage(k),this._feedbackUIParameters=this._feedbackUIParameters?this._feedbackUIParameters:{},this._feedbackUIParameters[l.error]=!1,this._feedbackUIParameters[l.crash]=!1,this._showFeedbackPanel=S.AFrameworkApplicationConstants.showFeedbackButton}catch(e){i.ULS.sendTraceTag(537171361,207,10,"Failed to show 'Send Feedback' link. Exception: {0}",e)}this.messageBox(e,t,3,n)}showQuestion(e,t,n=null){this.messageBox(e,t,4,n)}messageBox(e,t,n,a=null,i=null){this._dialogIcon=n;let o=null,r=null;switch(n){case 2:o="CancelRequest_32x32x32",r=this._errorText;break;case 1:o="Risks_32x32x32",r=this._warningText;break;case 3:o="Info_32x32x32",r=this._infoText;break;case 4:o="OfficeAssistant_32x32x32",r=this._questionText}this.messageBoxImpl(e,t,o,r,a,i)}addHelpLink(e,t,n=null,a){this._showHelpLink=!0,this._helpLinkText=e,this._helpContextID=t,this._helpFwlinkId=n,this._helpClickHandler=a}addDownloadLink(e,t,n=null){this._showDownloadLink=!0,this._downloadLinkText=e,this._downloadLinkUrl=t,this._downloadLinkFileName=n}addExtraLink(e,t){this._showExtraLink=!0,this._extraLinkText=e,this._extraLinkUrl=t}addFeedbackLink(e,t=null,n=!0,a=null){this._showFeedbackPanel=S.AFrameworkApplicationConstants.showFeedbackButton,this._feedbackLinkText=e,this._feedbackLinkClickHandler=t||this._feedbackLinkClickHandler,this._hideFeedbackDescription=n,this._feedbackUIParameters=a}removeFeedbackPanel(){this._showFeedbackPanel=!1,this._removeFeedbackPanel=!0,this._hideFeedbackDescription=!0}addAdditionalTextBodyContent(e,t=null){this._additionalBodyTextContent={},this._additionalBodyTextContent.textContent=e,this._additionalBodyTextContent.links=t}addSaveErrorReportPanel(e,t,n,a){this._showSaveErrorReportPanel=!0,this._saveErrorReportTitleText=e,this._saveErrorReportDescriptionText=t,this._privacyPolicyLinkText=n,this._privacyPolicyLinkClickHandler=a}onFeedbackClickHandler(e){const{AFrameworkApplication_ActionManager:t}=n(1510);this._useReactDialog&&this.hidePreservingMessageBoxElement(),this._feedbackUIParameters||(this._feedbackUIParameters={}),this._feedbackUIParameters[l.dismissHandler]=(0,o.a)(this,this.onFeedbackUIClosed,"onFeedbackUIClosed"),f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("FeedbackDelayLoadHandlerEnabled")?this.invokeFeedbackHanlderAfterReady(this._feedbackUIParameters):t.theActionManager.processActionWithData(g.a.giveFeedback,2,this._feedbackUIParameters)}onFeedbackUIClosed(){this._useReactDialog&&this.show(this._dialogValues)}setupCheckBoxPanel(){const e=this.myId("WACDialogDontShowPanel"),t=this.myId(b),n=this.myId("WACDialogDontShowLabelText");this._checkboxPanel=this._document.createElement("div"),this._checkboxPanel.id=e,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._checkboxPanel);const a=this._document.createElement("div");a.className="WACDialogDontShowCheckboxDiv",this._checkboxPanel.appendChild(a),this._dontShowCheckBox=this._document.createElement("input"),this._dontShowCheckBox.type="checkbox",this._dontShowCheckBox.id=t,u.a.setAriaAttribute(this._dontShowCheckBox,u.a.ariaLabelledByAttribute,n),a.appendChild(this._dontShowCheckBox);const i=this._document.createElement("div");i.className="WACDialogDontShowLabelDiv",this._checkboxPanel.appendChild(i);const o=this._document.createElement("label");o.innerText=this.dismissLabel,o.id=n,o.setAttribute("for",t),i.appendChild(o)}shouldShowFeedbackLinkForError(e){return S.AFrameworkApplicationConstants.showFeedbackButton&&(P.isCrashingErrorCode(e)&&f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("ShowFeedbackLinkOnCrashDialog")||!P.isCrashingErrorCode(e)&&f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("ShowFeedbackLinkOnErrorDialog"))}createReactLinkProps(e){let t=null,n=null,a=null;switch(e){case F:t=this._extraLinkText,n={href:this._extraLinkUrl,target:"_blank"};break;case w:if(t=this._downloadLinkText,n={href:this._downloadLinkUrl},this._downloadLinkFileName){const e=this._downloadLinkFileName.trim();e.length>0&&(n.download=e)}break;case T:t=this._helpLinkText,a=this.onHelpClickHandler;break;case v:t=this._feedbackLinkText,a=this._feedbackLinkClickHandler;break;case M:t=this._privacyPolicyLinkText,a=this._privacyPolicyLinkClickHandler;break;default:return null}return{type:"AppLinkProps",id:e,text:t,handler:n,onExecute:a}}createReactDismissCheckboxProps(){const e=this.onCheckboxExecute;return{type:"AppCheckboxProps",id:b,label:this.dismissLabel,onExecute:e}}appendDownloadLink(){this._downloadLink=this._document.createElement("a"),this._downloadLink.href=this._downloadLinkUrl,this._downloadLink.id=w,this._downloadLink.innerText=this._downloadLinkText,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._downloadLink),this._textPanel.appendChild(this._document.createElement("br"))}appendHelpLink(){this._helpLink=this._document.createElement("a"),this._helpLink.href="#",this._helpLink.id=T,this._helpLink.innerText=this._helpLinkText,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._helpLink),c.a.addHandler(this._helpLink,"click",this.onHelpClickHandler)}appendSessionId(){const e=this._document.createElement("span");e.className="Selectable",e.innerText=String.format(this._sessionInfoText,S.AFrameworkApplicationConstants.userSessionId),e.id="WACDialogSessionInfo",this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(e)}appendFeedbackLinkPanel(){this._feedbackPanel=this._document.createElement("div"),this._feedbackPanel.id="WACDialogFeedbackPanel",this._feedbackLink=this._document.createElement("a"),this._feedbackLink.href="#",this._feedbackLink.id=v,this._feedbackLink.innerText=this._feedbackLinkText,c.a.addHandler(this._feedbackLink,"click",this._feedbackLinkClickHandler),this._hideFeedbackDescription||(this._feedbackDescription=this._document.createElement("span"),this._feedbackDescription.id="WACDialogFeedbackDescription",this._feedbackDescription.innerText=this._feedbackDescriptionText,this._feedbackPanel.appendChild(this._feedbackDescription),this._feedbackPanel.appendChild(this._document.createTextNode(" "))),this._feedbackPanel.appendChild(this._feedbackLink),this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._feedbackPanel)}appendLogsScript(){this._logsScriptPanel=this._document.createElement("div"),this._logsScriptPanel.id="WACLogsScriptPanel",this._logsScriptDescription=this._document.createElement("p"),this._logsScriptDescription.id="WACLogsScriptDescription",this._logsScriptDescription.innerText="Run the following command in your enlistment to see your BlueChicken errors and warnings",this._logsScript=this._document.createElement("code"),this._logsScript.id="WACLogsScriptId",this._logsScript.innerText=this._logsScriptInnerText,this._logsScriptPanel.appendChild(this._logsScriptDescription),this._logsScriptPanel.appendChild(this._document.createTextNode(" ")),this._logsScriptPanel.appendChild(this._logsScript),this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._logsScriptPanel)}appendResourcesLinkPanel(){this._resourcesPanel=this._document.createElement("div"),this._resourcesPanel.id="WACDialogFeedbackPanel",this._resourcesLink=this._document.createElement("a"),this._resourcesLink.href="#",this._resourcesLink.id="WACDialogFeedbackLink",this._resourcesLink.innerText="BlueChicken Troubleshooting Documentation",c.a.addHandler(this._resourcesLink,"click",this._resourcesLinkClickHandler),this._resourcesPanel.appendChild(this._resourcesLink),this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._resourcesPanel)}appendSaveErrorReportPanel(){this._saveErrorReportPanel=this._document.createElement("div"),this._saveErrorReportPanel.id="WACDialogSaveErrorReportPanel",this._saveErrorReportPanel.appendChild(this._document.createElement("br")),this._saveErrorReportTitle=this._document.createElement("div"),this._saveErrorReportTitle.id=this.myId(I),this._saveErrorReportTitle.innerText=this._saveErrorReportTitleText,this._saveErrorReportTitle.style.fontWeight="bold",this._saveErrorReportPanel.appendChild(this._saveErrorReportTitle),this._saveErrorReportDescription=this._document.createElement("div"),this._saveErrorReportDescription.id=this.myId(E),this._saveErrorReportDescription.innerText=this._saveErrorReportDescriptionText,this._saveErrorReportPanel.appendChild(this._saveErrorReportDescription),S.AFrameworkApplicationConstants.privacyUrl&&(this._saveErrorReportPanel.appendChild(this._document.createElement("br")),this._privacyPolicyLink=this._document.createElement("a"),this._privacyPolicyLink.id=this.myId(M),this._privacyPolicyLink.href="#",this._privacyPolicyLink.innerText=this._privacyPolicyLinkText,this._saveErrorReportPanel.appendChild(this._privacyPolicyLink),c.a.addHandler(this._privacyPolicyLink,"click",this._privacyPolicyLinkClickHandler)),this._textPanel.appendChild(this._saveErrorReportPanel)}static isCrashingErrorCode(e){switch(e){case 1:case 21:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 65:case 66:case 67:case 68:case 69:case 70:case 71:return!0;default:return!1}}areReady(e){const{AFrameworkApplication_ActionManager:t}=n(1510);return 32===t.theActionManager.processAction(e,1)}waitForReady(e,t,a=0,i=null){2!==n(1510).AFrameworkApplication_ActionManager.theActionManager.processAction(e,1)?t(this,null):a<20?_.TaskManager.instance.addTask(new m.a(2,1,500,(n=>{this.waitForReady(e,t,a+1,i)}),93)):i&&i()}invokeFeedbackHanlderAfterReady(e,t=g.a.giveFeedback){this.waitForReady(t,((a,i)=>{n(1510).AFrameworkApplication_ActionManager.theActionManager.processActionWithData(t,2,e)}),0,(()=>{i.ULS.sendTraceTag(20575889,201,10,"Feedback package is not available after timeout"),this.buttonsOption=0,this.showError(30,(0,h.a)("DefaultDialogTitle"),(0,h.a)("NetworkProblemInitialDialogDescription"),null)}))}static showRequiresSignInDialog(){const e=new P;e.buttonsOption=0,e.setButtonText(1,(0,h.a)("DialogClose")),e.messageBox((0,h.a)("DefaultDialogTitle"),(0,h.a)("NeedToSignIn"),3,null)}constructor(e){super(e,!1,!!S.AFrameworkApplicationConstants.activeFrame&&S.AFrameworkApplicationConstants.activeFrame.applicationInstance.isReactDialogEnabled&&s.a.get_instance().isCompleted(8)&&s.a.get_instance().isCompleted(7)),this._downloadLinkFileName=null,this._showHelpLink=!1,this._showFeedbackPanel=!1,this._showTroubleshootingResources=!1,this._removeFeedbackPanel=!1,this._helpLinkText=null,this._feedbackUIParameters=null,this._helpContextID=null,this._showDownloadLink=!1,this._showMicrosoftLogo=!1,this._downloadLinkText=null,this._downloadLinkUrl=null,this._standardDialogHandler=null,this._helpFwlinkId=null,this._hideFeedbackDescription=!1,this._feedbackLinkText="Give feedback to Microsoft",this._feedbackDescriptionText="Your feedback helps Microsoft improve Office",this._logsScriptInnerText=null,this._errorText="Error",this._warningText="Warning",this._infoText="Information",this._questionText="Question",this._sessionInfoText="Session ID: {0}",this._showSaveErrorReportPanel=!1,this._saveErrorReportTitleText=null,this._saveErrorReportDescriptionText=null,this._privacyPolicyLinkText=null,this._maxWidth=null,this._privacyPolicyLinkClickHandler=null,this._additionalBodyTextContent=null,this._iconPanel=null,this._textElement=null,this._textPanel=null,this._checkboxPanel=null,this._contentRow=null,this._dontShowCheckBox=null,this._helpLink=null,this._feedbackLink=null,this._resourcesLink=null,this._logsScriptDescription=null,this._feedbackPanel=null,this._resourcesPanel=null,this._logsScriptPanel=null,this._logsScript=null,this._feedbackDescription=null,this._downloadLink=null,this._saveErrorReportPanel=null,this._saveErrorReportTitle=null,this._saveErrorReportDescription=null,this._privacyPolicyLink=null,this._showExtraLink=!1,this._extraLinkText=null,this._extraLinkUrl=null,this._extraLink=null,this._dontShowCheckboxChecked=!1,this._dialogIcon=0,this.isDismissable=!1,this.dismissLabel="Don't show this dialog again.",this._isErrorDialog=!1,this.showSessionId=!1,this._notifyHandlersBeforeDismiss=!1,this.baseDialogHandler=e=>{let t=!1;this.isDismissable&&(t=this._useReactDialog?this._dontShowCheckboxChecked:this._dontShowCheckBox.checked),this.notifyHandlersBeforeDismiss||this._hideOnButtonClick&&this.hide(),this._standardDialogHandler&&this._standardDialogHandler(e,t),this.notifyHandlersBeforeDismiss&&this._hideOnButtonClick&&this.hide(),this._hideOnButtonClick&&(this._standardDialogHandler=null)},this.onHelpClickHandler=e=>{this._helpFwlinkId?C.a.toFwlink(this._helpFwlinkId):(this._helpClickHandler&&this._helpClickHandler(),C.a.showHelp(this._helpContextID))},this.onTroubleshootingResourcesClickHandler=e=>{C.a.toDebugOnlyLink(f.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("AppSpecificTroubleshootingURL"))},this.onCheckboxExecute=e=>{this._dontShowCheckboxChecked=e.checked||!this._dontShowCheckboxChecked},this._feedbackLinkClickHandler=(0,o.a)(this,this.onFeedbackClickHandler,"onFeedbackClickHandler"),this._resourcesLinkClickHandler=this.onTroubleshootingResourcesClickHandler;try{this.dismissLabel=(0,h.a)("DialogDoNotShow"),this._feedbackLinkText=(0,h.a)("ErrorDialogFeedbackLinkText"),this._feedbackDescriptionText=(0,h.a)("ErrorDialogFeedbackText"),this._errorText=(0,h.a)("DialogError"),this._warningText=(0,h.a)("DialogWarning"),this._infoText=(0,h.a)("DialogInfo"),this._questionText=(0,h.a)("DialogQuestion"),this._sessionInfoText=(0,h.a)("DialogSessionInfo")}catch(e){i.ULS.sendTraceTag(39321886,207,10,"Failed to get CommonUiStrings. Exception: {0}",e)}}}(0,a.a)(P,"StandardDialog",r.a,[])},350:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(5149),o=n(625),r=n(3245),s=n(6127),l=n(3696),c=n(1333),d=n(8103),u=n(9969);class p{start(e){p.showWaitUI(this.waitMessage,(0,o.a)(this,this.onCancel,"onCancel"));const{url:t,headers:n}=u.a.removeAccessTokensFromSource(this.requestUri);c.a.doRequestWithBodyAndHeaders(t,null,n,null,(0,o.a)(this,this.onComplete,"onComplete"),e,!1,!r.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.SkipXmlValidationInTranslationRequest"))}onCancel(e){this._cancelled=!0,p.dismissWaitUI()}onComplete(e,t,n){if(!this._cancelled)if(t||(t=e?"Success":"UnknownError"),"Success"===t)this.dismissWaitUIOnSuccess&&p.dismissWaitUI(),this.onSuccess(n);else{this.isDocumentIssue(t)?i.ULS.sendTraceTag(51708544,301,15,"Translation failed due to an issue in the document: "+t):i.ULS.sendTraceTag(39387393,301,10,"WordViewer translation failed: "+t),p.dismissWaitUI();const e=this.getErrorMessage(t);if(1!==r.AFrameworkApplication.activeFrame.state){r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReportConversionFailedErrorUnderAdditionalVetoes")&&r.AFrameworkApplication.reportError(3,void 0,["TranslationFailed"]);const t=new l.StandardDialog;t.buttonsOption=0,t.setButtonText(1,(0,d.a)("DialogClose")),t.showError(3,(0,d.a)("DefaultDialogTitle"),e,null)}this.propagateError(e)}}static showWaitUI(e,t){const n=new s.a;p._progressDialog=n.create(),p._progressDialog.message=e,p._progressDialog.showProgressDialog((0,d.a)("DefaultDialogTitle"),t,null)}static dismissWaitUI(){p._progressDialog&&(p._progressDialog.close(),p._progressDialog=null)}constructor(){this._cancelled=!1}}p._progressDialog=null,(0,a.a)(p,"TranslationRequest",null,[])},7128:function(e,t,n){"use strict";n.r(t),n.d(t,{WacAirSpace:function(){return C}});var a,i=n(100),o=n(7296);class r{get timeRemaining(){return this._timeRemaining}get animationEvent(){return this._animationEvent}get element(){return this._element?this._element:null}set_element(e){return this._element=e,e}get beforeHandler(){return this._beforeHandler}get afterHandler(){return this._afterHandler}set_afterHandler(e){return this._afterHandler=e,e}static create(e,t,n,a,i){return new r(e,t,n,a,i)}constructor(e,t,n,a,i){this._element=null,this._afterHandler=null,this._timeRemaining=e,this._animationEvent=t,this.set_element(n),this._beforeHandler=a,this.set_afterHandler(i)}}(0,i.a)(r,"AnimationHandlerArgs",null,[]);class s{get runTime(){return this._runTime}constructor(e){this._runTime=e}}(0,i.a)(s,"AnimationResultProperties",null,[]),function(e){e[e.onAlways=1]="onAlways",e[e.onHide=2]="onHide",e[e.onMove=3]="onMove",e[e.onOpacityChanged=4]="onOpacityChanged",e[e.onResize=5]="onResize",e[e.onShow=6]="onShow",e[e.onScroll=7]="onScroll",e[e.onRotate=8]="onRotate"}(a||(a={})),(0,i.b)("AnimationType",a);class l{get numberOfAnimationsRunning(){return this._numberOfAnimationsRunning}increaseAnimationCount(){this._numberOfAnimationsRunning=this.numberOfAnimationsRunning+1}decreaseAnimationCount(){this._numberOfAnimationsRunning=this.numberOfAnimationsRunning-1}delayAfterAnimationHandler(e){this._afterAnimationHandlerArgObjects[this._afterAnimationHandlerIndex]=e,this._afterAnimationHandlerIndex++}callDelayedAfterAnimationHandlers(){for(let e=0;e<this._afterAnimationHandlerIndex;e++){const t=this._afterAnimationHandlerArgObjects[e];t.afterHandler(t)}}constructor(e){this.animationArgs=e,this._numberOfAnimationsRunning=1,this._afterAnimationHandlerArgObjects=[],this._afterAnimationHandlerIndex=0}}(0,i.a)(l,"CurrentAnimation",null,[]);class c{static get animationAliases(){return c._animationAliases}static getAnimationToRun(e){return c._animationMapping[e]}static getAnimationRunTime(e){const t=c.getAnimationToRun(e);return c._animationTimes[t.toString()]}}c._animationMapping={"SHARED_QUICKESTCLASS&ONSHOW":1,"SHARED_QUICKCLASS&ONMOVE":6,"SHARED_QUICKCLASS&ONRESIZE":7,"SHARED_QUICKCLASS&ONOPACITYCHANGED":8,"SHARED_QUICKCLASS&ONSHOW":9,"SHARED_QUICKCLASS&ONHIDE":10,"SHARED_BASICCLASS&ONMOVE":11,"SHARED_BASICCLASS&ONRESIZE":12,"SHARED_BASICCLASS&ONOPACITYCHANGED":13,"SHARED_BASICCLASS&ONSHOW":14,"SHARED_BASICCLASS&ONHIDE":15,"SHARED_BASICCLASS&ONSCROLL":16,"ONENOTE_BASICCLASS&ONMOVE":22,"ONENOTE_BASICCLASS&ONRESIZE":23,"ONENOTE_BASICCLASS&ONOPACITYCHANGED":24,"ONENOTE_BASICCLASS&ONSHOW":25,"ONENOTE_BASICCLASS&ONHIDE":26,"SHARED_SLOWCLASS&ONMOVE":17,"SHARED_SLOWCLASS&ONRESIZE":18,"SHARED_SLOWCLASS&ONOPACITYCHANGED":19,"SHARED_SLOWCLASS&ONSHOW":20,"SHARED_INSTANTCLASS&ONOPACITYCHANGED":0,"UEX_UPPERCONTEXTUALTABDRAMATIC&ONSHOW":30,"CXE_UPPERCONTEXTUALTABVISUALREFRESH&ONSHOW":31,"CXE_UPPERCONTEXTUALTABVISUALREFRESH&ONHIDE":32,"UEX_CONTEXTUALTABMOVEMENT&ONMOVE":29,"MSOHELP_FOLLOWTHEDOTCLASS&ONMOVE":36,"MSOHELP_FOLLOWTHEDOTCLASS&ONOPACITYCHANGED":13,"MSOHELP_FOLLOWTHEDOTCLASS&ONHIDE":15,"MSOHELP_SPOTLIGHTCLASS&ONOPACITYCHANGED":13,"MSOHELP_SPOTLIGHTCLASS&ONSHOW":14,"MSOHELP_SPOTLIGHTCLASS&ONHIDE":15,"WAC_DELAYSHOWCLASS&ONSHOW":37,"WAC_DELAYMOVECLASS&ONMOVE":38,"WAC_RIBBONCLASS&ONMOVE":39,"WAC_RIBBONCLASS&ONSHOW":40,"WAC_RIBBONCLASS&ONHIDE":41,"UEX_WINDOWTRANSITION&ONMOVE":11,"UEX_WINDOWTRANSITION&ONRESIZE":12,"UEX_WINDOWTRANSITION&ONOPACITYCHANGED":13,"UEX_WINDOWTRANSITION&ONSHOW":14,"UEX_STEALTHUITRANSITION&ONMOVE":6,"UEX_STEALTHUITRANSITION&ONRESIZE":7,"VISIO_PAGEENTERING&ONMOVE":11,"VISIO_PAGEENTERING&ONOPACITYCHANGED":13,"VISIO_PAGEENTERING&ONRESIZE":12,"VISIO_PAGEENTERING&ONSHOW":14,"VISIO_PAGEENTERING&ONHIDE":15,"VISIO_PAGEENTERING&ONSCROLL":16,"VISIO_PAGEEXITING&ONRESIZE":12,"VISIO_PAGEEXITING&ONSHOW":14,"VISIO_PAGEEXITING&ONHIDE":15,"VISIO_PAGEEXITING&ONSCROLL":16},c._animationAliases={},c._animationTimes={0:0,1:.05,2:.167,3:.167,4:.167,5:.167,6:.1,7:.1,8:.1,9:.1,10:.1,11:.267,12:.267,13:.267,14:.267,15:.267,16:.267,17:.75,18:.75,19:.75,20:.75,21:1,22:.367,23:.367,24:.367,25:.367,26:.367,27:0,28:.05,29:.433,30:.1,31:.35,32:.267,33:.267,34:.3,35:.3,36:.75,37:.5,38:.267,39:.267,40:.267,41:.267},(0,i.a)(c,"WacAirSpaceAnimationClasses",null,[]);var d=n(3998);class u{animate(e){const{AFrameworkApplication:t}=n(3245),a=e.element,i=e.animationEvent,o=u.getAnimationClassAndEvent(e),r=c.getAnimationToRun(o),d=this.createAnimationState(i),p=new WacAnimation.Object(r,0,a,d,this.defaultAfterAnimationHandler,e),g=u.getAnimationRunTime(o);let h;return t.theTaskManager.pauseForAnimation(g),e.beforeHandler&&e.beforeHandler(e),this._animatingDomElements[a.id]?(h=this._animatingDomElements[a.id],h.increaseAnimationCount(),h.animationArgs=e):(h=new l(e),this._animatingDomElements[a.id]=h),d?p.RunAnimation():this.defaultAfterAnimationHandler(e),new s(g)}createAnimationState(e){let t=!1;const n=new WacAnimation.State;return isNaN(e.finalX)||e.isXConstant||(n.SetAttribute(1,e.finalX),n.SetAnimateRight(e.useRightAttributeForX),t=!0),isNaN(e.finalY)||e.isYConstant||(n.SetAttribute(2,e.finalY),t=!0),isNaN(e.finalHeight)||e.isHeightConstant||(n.SetAttribute(3,e.finalHeight),t=!0),isNaN(e.finalWidth)||e.isWidthConstant||(n.SetAttribute(4,e.finalWidth),t=!0),isNaN(e.finalOpacity)||e.isOpacityConstant||(n.SetAttribute(5,e.finalOpacity),t=!0),isNaN(e.finalScrollTop)||e.isScrollTopConstant||(n.SetAttribute(6,e.finalScrollTop),t=!0),isNaN(e.finalScrollLeft)||e.isScrollLeftConstant||(n.SetAttribute(7,e.finalScrollLeft),t=!0),isNaN(e.finalRotateZ)||e.isRotateZConstant||(n.SetAttribute(8,e.finalRotateZ),t=!0),t?n:null}static getAnimationRunTime(e){const t=c.getAnimationRunTime(e);return parseInt((1e3*t).toString())}static getAnimationClassAndEvent(e){const{WacAirSpace:t}=n(7128),i=e.element,o=e.animationEvent;if(!i||!i.className)return"";const r=i.className.split(" ");let s=null;for(const e of r)if(e.startsWith(t.animationClassPrefix)){s=e.substr(t.animationClassPrefix.length);break}if(s=u.resolveAnimationClass(s),!s||""===s.trim())return"";const l=a[o.type];return s.toUpperCase()+"&"+l.toUpperCase()}static resolveAnimationClass(e){if(!e)return null;let t=e.toUpperCase();for(let e=0;e<10;e++){const e=c.animationAliases[t];if(!e)return t;t=e}return null}constructor(){this._animatingDomElements={},this.defaultAfterAnimationHandler=e=>{const{AFrameworkApplication:t}=n(3245);if(t.isShuttingDown)return;const a=e.element;if(document.URL.endsWith("&WacAirReport=1")&&(0,d.a)(),!this._animatingDomElements[a.id])return void(e.afterHandler&&e.afterHandler(e));const i=this._animatingDomElements[a.id];i.decreaseAnimationCount(),i.numberOfAnimationsRunning<0||(e.afterHandler&&i.delayAfterAnimationHandler(e),i.numberOfAnimationsRunning||(i.callDelayedAfterAnimationHandlers(),delete this._animatingDomElements[a.id]))}}}(0,i.a)(u,"WacAirSpaceEngine",null,[]);var p=n(9123),g=n(6094),h=n(1163),m=n(1509),_=n(935),S=n(657),f=n(6776);class C extends _.a{static registerDomEvents(){$addHandler(window,"resize",C.onResize)}static onResize(e){C.temporarilyDisableAnimation(500)}static temporarilyDisableAnimation(e){if(!C.isAnimationTurnedOff()&&S.TaskManager.instance){C.toggleAnimation();const t=new o.a(4,1,e,C.toggleAnimationTask,18);0,S.TaskManager.instance.addTask(t)}}static toggleAnimationTask(e){C.toggleAnimation()}static animate(e,t,n){if(C.isAnimationTurnedOff())return C.moveElementWithoutAnimation(e,t,n),new s(0);try{if(!e.element)return null;if(!e.element.id||""===e.element.id.trim())return C.moveElementWithoutAnimation(e,t,n),new s(0);new WacAnimation.State;const a=r.create(-1,e,e.element,t,n);return C.initWacAirSpaceEngine(),f.AFrameworkApplicationConstants.theWacAirSpaceEngine.animate(a)}catch(a){return C.moveElementWithoutAnimation(e,t,n),new s(0)}}static isAnimationTurnedOff(){return!!h.a.isIPad||!C._isAnimationEnabled}static initWacAirSpaceEngine(){f.AFrameworkApplicationConstants.theWacAirSpaceEngine||(f.AFrameworkApplicationConstants.theWacAirSpaceEngine=new u)}static moveElementWithoutAnimation(e,t,n){const a=r.create(0,e,e.element,t,n);t&&t(a),C.setX(e),C.setY(e),C.setHeight(e),C.setWidth(e),C.setOpacity(e),C.setScroll(e),C.setRotateZ(e),n&&n(a)}static cloneElement(e,t,n){if(!e||!e.parentNode)return null;if(e.id&&-1!==e.id.indexOf("_clone"))return e;let a=document.getElementById(e.id+"_clone");if(!a){a=document.createElement("div");const i=e.style;let o=C.isCssSizeInPixels(i.top)?g.a.parseCssSizeDouble(i.top):e.offsetTop;const r=e.parentNode;r.offsetTop>o&&(o=r.offsetTop);const s=C.isCssSizeInPixels(i.left)?g.a.parseCssSizeDouble(i.left):e.offsetLeft,l=C.isCssSizeInPixels(i.width)?g.a.parseCssSizeDouble(i.width):e.offsetWidth?e.offsetWidth:r.offsetWidth,c=C.isCssSizeInPixels(i.height)?g.a.parseCssSizeDouble(i.height):e.offsetHeight?e.offsetHeight:r.offsetHeight,d=p.a.getCurrentStyle(e).zIndex,u=a.style;u.position="absolute",u.display=i.display,u.top=o+"px",u.left=s+"px",null!=l&&(u.width=l+"px"),null!=c&&(u.height=c+"px"),u.zIndex=d,g.a.copyChildNodes(e,a),a.className=e.className+" AirspaceClone",a.id=e.id+"_clone",t&&h.a.setOpacity(e,0),n?r.insertBefore(a,e):r.appendChild(a)}return a}static setContextVariable(e,t){if(e&&""!==e.trim())try{(new WacAnimation.ContextVariableManager).SetContextVariable(e.toUpperCase(),t)}catch(e){throw e}}static setAnimationClass(e,t){e&&(Sys.UI.DomElement.addCssClass(e,C.animationClassPrefix+t),C.assignUniqueId(e))}static removeAnimationClass(e,t){Sys.UI.DomElement.removeCssClass(e,C.animationClassPrefix+t)}static assignUniqueId(e){e.id&&""!==e.id.trim()||(e.id="WacAirSpace"+m.a.create())}static setX(e){isNaN(e.finalX)||(e.useRightAttributeForX?e.useRelativePositioning?e.element.style.marginRight=e.finalX+"px":e.element.style.right=e.finalX+"px":e.useRelativePositioning?e.element.style.marginLeft=e.finalX+"px":e.element.style.left=e.finalX+"px")}static setY(e){isNaN(e.finalY)||(e.useRelativePositioning?e.element.style.marginTop=e.finalY+"px":e.element.style.top=e.finalY+"px")}static setHeight(e){isNaN(e.finalHeight)||(e.element.style.height=e.finalHeight+"px")}static setWidth(e){isNaN(e.finalWidth)||(e.element.style.width=e.finalWidth+"px")}static setOpacity(e){isNaN(e.finalOpacity)||h.a.setOpacity(e.element,e.finalOpacity)}static setScroll(e){e.setScrollTop(),e.setScrollLeft()}static setRotateZ(e){isNaN(e.finalRotateZ)||p.a.setRotation(e.element,e.finalRotateZ)}static isCssSizeInPixels(e){if(!e)return!1;const t=e.trim(),n=t.charAt(0),a=t.charAt(t.length-1);return!(n<"0"||n>"9")&&!((a<"0"||a>"9")&&!t.endsWith("px"))}}C.animationClassPrefix="WacAirSpace",(0,i.a)(C,"WacAirSpace",_.a,[])},935:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100);class i{get fps(){return this._fps}get min(){return this._min}get max(){return this._max}get stdDev(){return this._stdDev}get startTime(){return this._startTime}get endTime(){return this._endTime}get elementIds(){return this._elementIds}constructor(e,t,n,a,i,o,r){this._fps=e,this._min=t,this._max=n,this._stdDev=a,this._startTime=i,this._endTime=o,this._elementIds=r}}(0,a.a)(i,"AnimationStat",null,[]);class o{static toggleAnimation(){o._isAnimationEnabled=!o._isAnimationEnabled}static getAnimationStats(){const e=WacAnimation.Telemetry.GetRecentAnimationStats(),t=new Array(e.length);for(let n=0;n<e.length;n++){const a=e[n];if(a){const e=a[1],o=a[2],r=a[3],s=a[5],l=a[9],c=a[10],d=a[11];t[n]=new i(e,o,r,s,l,c,d)}}return t}}o._isAnimationEnabled=!0,(0,a.a)(o,"WacAirSpaceStatic",null,[])},3989:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(2998);class o{get includedString(){return this._includedString}replaceIn(e){return this._findReplacePair.performReplaceOn(e)}constructor(e,t){if(-1===e.indexOf("{"))throw Error.argument("find","find string needs to use curly braces");this._findReplacePair=new i.a(new RegExp(e,"gi"),t),this._includedString=e}}(0,a.a)(o,"UserStringReplacement",null,[]);var r=n(8103);class s{static formatResourceStrings(e){const t=e;const n=s.buildReplacements(),a=n.length;for(const e in t){const i={key:e,value:t[e]},o=i.value;if("string"==typeof o){let e=o;if(-1===e.indexOf("{"))continue;for(let t=0;t<a;t++)s.shouldSkipUnnecessaryRegexReplace&&n[t].includedString&&e.indexOf(n[t].includedString)<0||(e=n[t].replaceIn(e));t[i.key]=e}}}static formatSingleString(e){const t=s.buildReplacements(),n=t.length;let a=e;if(!a||-1===a.indexOf("{"))return a;for(let e=0;e<n;e++)s.shouldSkipUnnecessaryRegexReplace&&t[e].includedString&&a.indexOf(t[e].includedString)<0||(a=t[e].replaceIn(a));return a}static buildReplacements(){return s._replacements||(s._replacements=[new o("{webappfull}",s.applicationNameLong),new o(s._webappshort,s.applicationNameShort),new o("{richclientfull}",s.richClientNameLong),new o("{appshort}",s.applicationNameOnly),new o("{doctype}",s.documentType),new o("{doctypetitlecase}",s.documentTypeTitleCase),new o("{doctypeplural}",s.documentTypePlural),new o("{subdoctype}",s.subDocumentType),new o("{officefull}",(0,r.a)("OfficeNameLong")),new o("{officeshort}",(0,r.a)("OfficeNameShort")),new o("{onedrive}",(0,r.a)("OneDriveName")),new o("{brandingstring}",(0,r.a)("BrandingString")),new o("{brandingstringplural}",(0,r.a)("BrandingString")),new o("{skype}",(0,r.a)("SkypeName")),new o("{clpdoctype}",s.sensitivityLevelDocumentType||(0,r.a)("CLPDocumentTypeGeneric"))])}}s._webappshort="{webappshort}",s.applicationNameLong=null,s.applicationNameShort=null,s.documentType=null,s.documentTypeTitleCase=null,s.documentTypePlural=null,s.richClientNameLong=null,s.subDocumentType=null,s.applicationNameOnly=null,s.sensitivityLevelDocumentType=null,s.shouldSkipUnnecessaryRegexReplace=!1,s._replacements=null,(0,a.a)(s,"UserStringFormatter",null,[])},7072:function(e,t,n){"use strict";n.d(t,{a:function(){return _}});var a,i=n(100),o=n(5149),r=n(629),s=n(5072),l=n(2544);!function(e){e[e.title=0]="title",e[e.content=1]="content",e[e.notes=2]="notes",e[e.unknown=3]="unknown"}(a||(a={})),(0,i.b)("AccessibilityItemType",a);var c=n(7958),d=n(1163),u=n(988),p=n(6124),g=n(8103),h=n(2469),m=n(3245);class _ extends p.a{static addNotificationCallback(e){_.readyForNotifications?e():(_._notificationCallbacks||(_._notificationCallbacks=[]),Array.add(_._notificationCallbacks,e))}static get readyForNotifications(){return _._readyForNotifications}static set readyForNotifications(e){if(_._readyForNotifications=e,_._readyForNotifications&&_._notificationCallbacks){for(let e=0;e<_._notificationCallbacks.length;e++)_._notificationCallbacks[e]();_._notificationCallbacks=null}}static getF6NotificationString(e){const t=d.a.isMac?(0,g.a)("AccHelpDialogCommandKey"):(0,g.a)("AccHelpDialogCtrlKey"),n=String.format((0,g.a)("F6ToMoveAroundApp"),t);if(!e)return n;const a=d.a.isMac?(0,g.a)("AccHelpTipOptionKey"):(0,g.a)("AccHelpTipAltKey"),i=String.format((0,g.a)("AccessibilityHelpShortcut"),a);return String.format("{0} {1}",n,i)}static getCanvasDescribedByString(e){const t=d.a.isMac?(0,g.a)("AccHelpDialogCommandKey"):(0,g.a)("AccHelpDialogCtrlKey"),n=String.format((0,g.a)("F6ToLeaveEditingSurface"),t);return e?String.format("{0} {1}",n,(0,g.a)("AccessibilityHelpShortcut")):n}static appendSpanWithHiddenContext(e){const t=e.ownerDocument.createElement("span");_.hideElementFromSight(t),e.appendChild(t);const n=e.ownerDocument.createElement("span");e.appendChild(n);const a=e.ownerDocument.createElement("span");return _.hideElementFromSight(a),e.appendChild(a),n}static getTextWithHiddenContext(e){return e.children[1].innerText}static setTextWithHiddenContext(e,t,n){const a=n.indexOf("{0}");const i=n.substring(0,a);e.children[0].innerText=i,e.children[1].innerText=t;const o=n.substring(a+3,n.length);e.children[2].innerText=o}static appendHiddenLabel(e,t,n){const a=document.createElement("div");return _.hideElementFromSight(a),a.id=t,""!==n&&(a.innerText=n),a.setAttribute(_.ariaRoleAttribute,_.ariaPresentationRole),a.setAttribute(_.ariaHiddenAttribute,_.ariaTrueValue),e.appendChild(a),e.setAttribute(_.ariaLabelledByAttribute,t),a}static createHiddenDescriptionElement(e,t){const n=document.createElement("div");return _.hideElementFromSight(n),n.id=e,""!==t&&(n.innerText=t),n.setAttribute(_.ariaRoleAttribute,_.ariaDescriptionRole),n.setAttribute(_.ariaHiddenAttribute,_.ariaTrueValue),n}static appendHiddenDescribedBy(e,t,n,a){const i=_.createHiddenDescriptionElement(n,a);return e.appendChild(i),t.setAttribute(_.ariaDescribedByAttribute,i.id),i}static hideElementFromSight(e){e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex="-100"}static registerHelpActionAndShortcut(e,t=null){h.a.registerAction(e,u.a.accessibilityHelp);r.FocusManager.instance().getScope(n(3700).a.documentFocusID).bindAction(l.a.hashKey(s.a.VK_A,5),u.a.accessibilityHelp),m.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled")&&t&&_.createLiveRegionAnnouncement(t,(0,g.a)("AccHelpShortcutAnnouncement"))}static createLiveRegionAnnouncement(e,t){const n=document.createElement("div");n.setAttribute(_.ariaRoleAttribute,_.ariaMarqueeRole),n.setAttribute(_.ariaLiveAttribute,_.ariaPoliteLiveLevel),n.setAttribute(_.ariaAtomicAttribute,_.ariaTrueValue),n.className="WACAriaLiveRegion",e.appendChild(n),m.AFrameworkApplication.registerOnAfterSplashScreenDismissed((()=>{n.appendChild(document.createTextNode(t))}))}static getAccessiblityInfoForScreenReader(e,t,n,a,i,o,r){if(!(e&&t&&n&&a&&i&&o&&i))throw Error.argumentNull("rawAccessibilityInfo, allTitlePromptDic, allTitlesDic, allContentPromptDic, allContentsDic, allNotePromptDic or allNotesDic");_.parseoutAccessibilityInfo(e,t,n,a,i,o,r)}static getAccessibilityInfoForAccessibilityMode(e){if(!e)throw Error.argumentNull("rawAccessibilityInfo");return _.insertHeadingTagsInAccessibilityInfo(e)}static parseoutAccessibilityInfo(e,t,n,a,i,o,r){let s=0;for(;s<e.childNodes.length;){const l=e.childNodes[s];if("BR"===l.tagName){const c=_.getItemType(l);if(3!==c){let d,u;const p=l.getAttribute("id").toString().split("_")[1];0===c?(({titlePrompt:d,titleValue:u}=_.getTitleInfoForReader(e.childNodes[s-1])),t[p]=d,n[p]=u):1===c?(({itemPrompt:d,itemValue:u}=_.getContentOrNoteInfoForReader(e.childNodes[s-1],1)),a[p]=d,i[p]=u):2===c&&(({itemPrompt:d,itemValue:u}=_.getContentOrNoteInfoForReader(e.childNodes[s-1],2)),o[p]=d,r[p]=u)}}s++}}static insertHeadingTagsInAccessibilityInfo(e){let t=0;const n=new Array(e.childNodes.length);for(;t<e.childNodes.length;){const a=e.childNodes[t];if(a.innerHTML&&""!==a.innerHTML?n[t]=_.getOuterHTML(a):n[t]="","BR"===a.tagName){const e=_.getItemType(a);0===e?n[t-1]=_.attachHeadingTagForSpecifiedItem(n[t-1],0):1===e?n[t-1]=_.attachHeadingTagForSpecifiedItem(n[t-1],1):2===e&&(n[t-1]=_.attachHeadingTagForSpecifiedItem(n[t-1],2))}t++}return n.join("")}static getItemType(e){const t=new RegExp("^Title_[0-9]+$"),n=new RegExp("^Content_[0-9]+$"),a=new RegExp("^Notes_[0-9]+$"),i=e.getAttribute("id");return i?t.test(i.toString())?0:n.test(i.toString())?1:a.test(i.toString())?2:(o.ULS.sendTraceTag(7422981,1900,10,"current BR ID of '{0}' doesn't not match any of Title, Content or Notes",i.toString()),3):(o.ULS.sendTraceTag(7422980,1900,10,"Failed to find attribute of ID from BR Node!"),3)}static getOuterHTML(e){const t=document.createElement("P");return t.appendChild(e.cloneNode(!0)),t.innerHTML}static getItemPromptPattern(e){switch(e){case 0:return String.format("\\[{0} [0-9]+ {1}\\]",(0,g.a)("ScreenReader_PatternWord_Slide"),(0,g.a)("ScreenReader_PatternWord_Title"));case 1:return String.format("\\[{0} [0-9]+ {1}\\]",(0,g.a)("ScreenReader_PatternWord_Slide"),(0,g.a)("ScreenReader_PatternWord_Content"));case 2:return String.format("\\[{0} [0-9]+ {1}\\]",(0,g.a)("ScreenReader_PatternWord_Slide"),(0,g.a)("ScreenReader_PatternWord_Notes"));default:throw Error.invalidOperation(String.format("Unsupported item type of {0}",a[e]))}}static getTitleInfoForReader(e){let t,n;t=(0,g.a)("ScreenReader_UnknowSlideTitlePrompt"),n=(0,g.a)("ScreenReader_UnknowSlideTitle");try{if(2!==e.childNodes.length)o.ULS.sendTraceTag(7422982,1900,10,"Expect 2 Children which contains Slide # and Slide Title, but acutal content is {0}",c.a.dumpHtmlWithoutText(e));else{const a=e.childNodes[0].nodeValue;new RegExp(String.format("^{0}$",_.getItemPromptPattern(0)),"i").test(a)&&(t=a,"LI"!==e.childNodes[1].tagName||1!==e.childNodes[1].childNodes.length||"DIV"!==e.childNodes[1].childNodes[0].tagName||1!==e.childNodes[1].childNodes[0].childNodes.length?o.ULS.sendTraceTag(7422983,1900,10,"Expect TAG of LI and 1 Child Slide Title Info, but acutal Tag is {0} and content is {1}",e.childNodes[1].tagName,c.a.dumpHtmlWithoutText(e.childNodes[1])):(n=e.childNodes[1].childNodes[0].childNodes[0].nodeValue,n&&n.length||(n=(0,g.a)("ScreenReader_NoSlideTitle"))))}}catch(t){o.ULS.sendTraceTag(7422984,1900,10,"Failed to parse the slide # and title because of {0}, the acutal raw data is {1}",t.toString(),c.a.dumpHtmlWithoutText(e))}return{titlePrompt:t,titleValue:n}}static getContentOrNoteInfoForReader(e,t){let n,i;n=null,i=null;let r=null,s=null,l=null,d=null;switch(t){case 1:n=(0,g.a)("ScreenReader_UnknowSlideContentPrompt"),r=_.getItemPromptPattern(1),s="LI",l=(0,g.a)("ScreenReader_NoSlideContent"),d=(0,g.a)("ScreenReader_UnknowSlideContent");break;case 2:n=(0,g.a)("ScreenReader_UnknowSlideNotePrompt"),r=_.getItemPromptPattern(2),s="P",l=(0,g.a)("ScreenReader_NoSlideNote"),d=(0,g.a)("ScreenReader_UnknowSlideNote");break;default:throw Error.create(String.format("Don't support the type of {0} in GetContentOrNoteInfoForReader",a[t]))}const u=e.childNodes[0].nodeValue,p=new RegExp("^"+r+"$","i");if(p.test(u)){if(n=u,e.childNodes.length>1){const t=_.extractAllListItems(e);for(let e=0;e<t.length;e++){const n=t[e].tagName;n===s?i=i?String.format("{0} {1}",i,_.extractInnerText(t[e])):_.extractInnerText(t[e]):o.ULS.sendTraceTag(7476291,1900,10,"Expect Tag is {0} but got Tag of {1}.",s,n||"null")}}i&&i.length||(i=l)}else o.ULS.sendTraceTag(7476292,1900,10,"Cannot find the Prompt by Pattern of {0} from {1}",p.toString(),c.a.dumpHtmlWithoutText(e.childNodes[0])),i=d;return{itemPrompt:n,itemValue:i}}static attachHeadingTagForSpecifiedItem(e,t){let n=e,i=null,r=null,s=null;switch(t){case 0:r="h1",s="<ul>";break;case 1:r="h2",s="<ul>";break;case 2:r="h3",s="<ul>"}i=new RegExp(String.format("^{0}{1}",s,_.getItemPromptPattern(t)),"i");const l=e.match(i);if(l&&1===l.length){n=e.substring(0,s.length)+("<"+r+">"+e.substring(s.length,l[0].length)+"</"+r+">")+e.substring(l[0].length,e.length)}else o.ULS.sendTraceTag(7422985,1900,10,"Failed to find expected Slide {0} by pattern of {1}",a[t],i.toString());return n}static extractAllListItems(e){let t=e.childNodes;return"UL"===e.childNodes[1].tagName&&(t=e.childNodes[1].childNodes),t}static extractInnerText(e){let t=null;if(e.innerText)t=e.innerText;else if(e.innerHTML&&e.innerHTML.length>0){let n=e,a=1e3;for(;a>=0;a--){if(!n.childNodes.length){t=n.nodeValue;break}if(!n.childNodes[0].tagName||"SPAN"===n.childNodes[0].tagName){t=n.innerHTML;break}if(1!==n.childNodes.length){o.ULS.sendTraceTag(7476293,1900,15,"Unsupported Item format: {0}",c.a.dumpHtmlWithoutText(e));break}n=n.childNodes[0]}a<=0&&o.ULS.sendTraceTag(8263566,1900,15,"more than 1000 Nested level HTML object is NOT supported")}return t}}_.ariaAtomicAttribute="aria-atomic",_.ariaBusyAttribute=p.a.ariaBusyAttribute,_.ariaCheckedAttribute="aria-checked",_.ariaControlsAttribute="aria-controls",_.ariaDescribedByAttribute=p.a.ariaDescribedByAttribute,_.ariaDisabledAttribute="aria-disabled",_.ariaExpandedAttribute="aria-expanded",_.ariaHasPopupAttribute="aria-haspopup",_.ariaHiddenAttribute=p.a.ariaHiddenAttribute,_.ariaLabelAttribute="aria-label",_.ariaLabelledByAttribute=p.a.ariaLabelledByAttribute,_.ariaLevelAttribute="aria-level",_.ariaLiveAttribute="aria-live",_.ariaMultilineAttribute="aria-multiline",_.ariaOwnsAttribute="aria-owns",_.ariaPressedAttribute="aria-pressed",_.ariaPosInSetAttribute="aria-posinset",_.ariaReadOnlyAttribute="aria-readonly",_.ariaRoleDescription="aria-roledescription",_.ariaSelectedAttribute="aria-selected",_.ariaSetSizeAttribute="aria-setsize",_.ariaValueMaxAttribute="aria-valuemax",_.ariaValueMinAttribute="aria-valuemin",_.ariaValueNowAttribute="aria-valuenow",_.ariaAlertRole="alert",_.ariaAlertDialogRole=p.a.ariaAlertDialogRole,_.ariaApplicationRole="application",_.ariaButtonRole=p.a.ariaButtonRole,_.ariaCheckBoxRole="checkbox",_.ariaComboboxRole="combobox",_.ariaComplementaryRole="complementary",_.ariaDialogRole=p.a.ariaDialogRole,_.ariaDescriptionRole="description",_.ariaDocumentRole="document",_.ariaGridCellRole="gridcell",_.ariaGridRole="grid",_.ariaGroupRole="group",_.ariaHeadingRole="heading",_.ariaImageRole=p.a.ariaImageRole,_.ariaLinkRole="link",_.ariaListboxRole="listbox",_.ariaListRole="list",_.ariaListItemRole="listitem",_.ariaMainRole="main",_.ariaMarqueeRole="marquee",_.ariaMenuItemCheckBoxRole="menuitemcheckbox",_.ariaMenuItemRadioRole="menuitemradio",_.ariaMenuItemRole="menuitem",_.ariaMenuRole="menu",_.ariaNavigationRole="navigation",_.ariaNoteRole="note",_.ariaOptionRole="option",_.ariaProgressBarRole="progressbar",_.ariaRadioRole="radio",_.ariaRegionRole="region",_.ariaRowRole="row",_.ariaStatusRole="status",_.ariaTabRole="tab",_.ariaTabListRole="tablist",_.ariaTextboxAttribute="textbox",_.ariaTreeItemRole="treeitem",_.ariaTreeRole="tree",_.ariaToggleButtonRole="toggle",_.ariaLabelAttributeDismiss="dismiss",_.ariaFalseValue=p.a.ariaFalseValue,_.ariaTrueValue=p.a.ariaTrueValue,_.ariaUndefinedValue="undefined",_.ariaAssertiveLiveLevel="assertive",_.ariaOffLiveLevel="off",_.ariaPoliteLiveLevel="polite",_.str_TitleValueID="TitleValueID",_.str_ContentValueID="ContentValueID",_.str_NoteValueID="NoteValueID",_._readyForNotifications=!0,_._notificationCallbacks=null,(0,i.a)(_,"AccessibilityUtils",p.a,[])},6124:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(1163);class o{static setAriaAttribute(e,t,n){e&&(i.a.isIPad||e.setAttribute(t,n))}}o.ariaLabelledByAttribute="aria-labelledby",o.ariaRoleAttribute="role",o.ariaPresentationRole="presentation",o.ariaHiddenAttribute="aria-hidden",o.ariaBusyAttribute="aria-busy",o.ariaDescribedByAttribute="aria-describedby",o.ariaFalseValue="false",o.ariaTrueValue="true",o.ariaButtonRole="button",o.ariaAlertDialogRole="alertdialog",o.ariaDialogRole="dialog",o.ariaImageRole="img",(0,a.a)(o,"AccessibilityUtilsStatic",null,[])},1333:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var a=n(100),i=n(5149),o=n(3245),r=n(2219),s=n(7905),l=n(7296);class c{constructor(){this.maxRetryAttempts=22,this.retryIntervalInMSecs=1e3,this.retryIntervalLongInMSecs=2e4,this.retryTimeoutInMSecs=18e4}}(0,a.a)(c,"Config",null,[]);var d=n(8103);class u{send(e,t,n,a,i,o){this._url=e,this._callback=i,this._useAdvancedRetryLogic=o,this._body=t,this._headers=n,this._responseHeadersToSet=a,this.makeRequest(null)}retryRequest(e){const t=new l.a(2,1,e,this.makeRequest,94);o.AFrameworkApplication.theTaskManager.addTask(t)}retryOnFailure(e){this.retryRequest(e),u._retryCountFailure++}giveUp(e){i.ULS.sendTraceTag(524104658,301,15,"Request failed - giving up (failures "+u._retryCountFailure+"): "+this._url),this._callback(!1,null,e)}resetFailedRequestRetryLoop(){if(u._retryLoopUnderway=!1,u._retryCountFailure=0,u._notificationItem){this._notificationBar.removeEntry(u._notificationItem),u._notificationItem=null;const e=this._notificationBar.createEntry((0,d.a)("NetworkRestoredToast"),!1);e.image=3,this._notificationBar.addEntry(e)}}static doRequest(e,t,n,a=!0){return u.doRequestWithBodyAndHeaders(e,null,null,null,t,n,!1,a)}static doRequestWithNetworkFailureNotification(e,t,n,a=!0){return u.doRequestWithBodyAndHeaders(e,null,null,null,t,n,!0,a)}static doRequestWithBodyAndHeaders(e,t,n,a,i,r,l,c=!0){if(s.a.instance.checkAndTriggerSessionHasExpired()&&o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.holdRequestsWhenSessionHasExpired)return!1;return new u(r,c).send(e,t,n,a,i,l),!0}static isValidResponseXMLDoc(e){return!!e&&void 0!==e.selectSingleNode}constructor(e,t){this.shouldSetResponseXml=t,this._callback=null,this._url=null,this._retryCountForHttp200=0,this._retryCountForServiceBusy=0,this._useAdvancedRetryLogic=!1,this.pageStats="",this._headers=null,this._body=null,this._responseHeadersToSet=null,this.makeRequest=e=>{o.AFrameworkApplication.theClientRequestManager.addRequest(this._url,1,this._body,this._headers,this.shouldSetResponseXml,2,this.onRequestSucceeded,this.onRequestFailed,null,void 0,void 0,void 0,void 0,"16",void 0,void 0,void 0,void 0,this._responseHeadersToSet)},this.onRequestSucceeded=e=>{const t=u._retryCountFailure;this.resetFailedRequestRetryLoop();let n=e.data.responseXml,a=null;if(n){if(u.isValidResponseXMLDoc(n)||(n=Sys.Net.XMLDOM(e.data.responseData,!0)),void 0===n.selectSingleNode){let t=e.data.responseData||"[null]";return t.length>800&&(t=t.substring(0,400)+"[...]"+t.substring(t.length-400,t.length)),i.ULS.sendTraceTag(39387396,301,10,'Invalid docdata.xml retrieved.  Contents: "{0}"',t),void this.giveUp(e.data)}a=n.selectSingleNode("/docdata/status")}o.AFrameworkApplication.collectPageStats&&e.data.responseHeaders[r.a.pageStatsResponseXHRHeader]&&(this.pageStats+=e.data.responseHeaders[r.a.pageStatsResponseXHRHeader].toString());if(!!a&&("InProgress"===a.text&&this._retryCountForHttp200++<u._config.maxRetryAttempts||"ServiceBusy"===a.text&&this._retryCountForServiceBusy++<3))i.ULS.sendTraceTag(39387397,301,50,"Re-requesting; Status: {0}; Retry Count: {1}; Url: {2}",a.text,this._retryCountForHttp200+this._retryCountForServiceBusy,this._url),this.retryRequest(u._config.retryIntervalInMSecs*(this._retryCountForHttp200+this._retryCountForServiceBusy));else{const n=a?a.text:null;i.ULS.sendTraceTag(39387398,301,50,"Request Complete. Result: {0}; Url: {1}",n,this._url),t>4&&i.ULS.sendTraceTag(524104657,301,15,"Request Complete. Result: {0}; Url: {1}; Retry: {2}",n,this._url,t),o.AFrameworkApplication.collectPageStats&&""!==this.pageStats&&(e.data.responseHeaders[r.a.pageStatsResponseXHRHeader]=this.pageStats,this.pageStats=""),this._callback(!0,n,e.data)}},this.onRequestFailed=e=>{if(this._useAdvancedRetryLogic){u._retryLoopUnderway||(u._lastFailedRequestStamp=new Date,u._retryLoopUnderway=!0,u._retryCountFailure=1);if((new Date).getTime()-u._lastFailedRequestStamp.getTime()<u._config.retryTimeoutInMSecs){const e=u._retryCountFailure>=4?u._config.retryIntervalLongInMSecs:u._config.retryIntervalInMSecs;this.retryOnFailure(e),4===u._retryCountFailure&&(u._notificationItem=this._notificationBar.createEntry((0,d.a)("NetworkProblemToast"),!0),this._notificationBar.addEntry(u._notificationItem))}else this.giveUp(e.data)}else u._retryCountFailure<4?this.retryOnFailure(2*u._config.retryIntervalInMSecs):this.giveUp(e.data)},this._notificationBar=e}}u._lastFailedRequestStamp=null,u._retryLoopUnderway=!1,u._retryCountFailure=0,u._notificationItem=null,u._config=new c,(0,a.a)(u,"ClientRequestWithRetry",null,[])},9214:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get actionId(){return this._actionId}get contextId(){return this._contextId}get flags(){return this._flags}constructor(e,t,n){this._actionId=e,this._contextId=t,this._flags=n}}(0,a.a)(i,"CommandInfo",null,[])},2409:function(e,t,n){"use strict";n.d(t,{a:function(){return g}});var a,i=n(100),o=n(5149),r=n(8511);!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(a||(a={})),(0,i.b)("SameSite",a);var s=n(9969),l=n(6362),c=n(9858),d=n(2274);class u{getCookieValue(e){if(this._cachedValues.has(e))return this._cachedValues.get(e);let t="";if(void 0!==this._cachedCookieString)t=this.searchForCookieValue(e);else{const n=(e=>{const t=document.cookie;if(!e)return["",t];if(e.indexOf("=")>=0)throw Error.argumentOutOfRange();const n=""+t,a=new RegExp("(?:^|; )"+e+"=([^;]*)"),i=n.match(a);return!i||i.length<2?["",t]:[i[1],t]})(e);t=n[0],this._cachedCookieString=n[1]}return null!=e&&null!=t&&this._cachedValues.set(e,t),t}searchForCookieValue(e){if(!e)return"";if(e.indexOf("=")>=0)throw Error.argumentOutOfRange();const t=""+this._cachedCookieString,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),a=t.match(n);return!a||a.length<2?"":a[1]}invalidateCache(e){this._cachedValues.has(e)&&(this._cachedValues.delete(e),this._cachedCookieString=void 0)}removeCachedCookieValue(e){this.invalidateCache(e)}static instance(){return null==u._instance&&(u._instance=new u),u._instance}constructor(){this._cachedValues=new Map,this._cachedCookieString=document.cookie}}(0,i.a)(u,"CookieCache",null,[]);const p=864e5;class g{static getBool(e,t){const n=g.get(e);return"true"===n||"false"!==n&&t}static get(e){return u.instance().getCookieValue(e)}get(e){return g.get(e)}static sanitizeCookies(){if(d.AFrameworkApplication_AppSettingsManager.appSettingsManager&&(d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("SanitizeCookiesEnabled")||d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("SanitizeCookiesAtBootEnabled"))&&(g._cookiesToBeSanitized||g.computeCookiesToBeSanitized(),g._cookiesToBeSanitized)){const e=new Date(0),t=document.cookie;if(!t)return;for(const n of g._cookiesToBeSanitized)t.indexOf(n)>-1&&g.setStringOrDictionaryValueWithDomainInternal(n,g.get(n),null,e,"","")}}static set(e,t){return g.setWithExpiration(e,t,24)}static setWithoutExpiration(e,t,n,a){return g.setStringOrDictionaryValueWithDomain(e,t,null,null,n,a)}static setWithExpiration(e,t,n){return g.setWithExpirationAndPath(e,t,n,"")}static setWithExpirationAndPath(e,t,n,a){const i=new Date;return i.setTime(i.getTime()+n*p),g.setStringOrDictionaryValueWithDomain(e,t,null,i,a,"")}static setWithAllTheThings(e,t,n,a,i){const o=new Date;return o.setTime(o.getTime()+n*p),g.setStringOrDictionaryValueWithDomain(e,t,null,o,a,i)}setWithAllTheThings(e,t,n,a,i){return g.setWithAllTheThings(e,t,n,a,i)}static setWithExpirationMillisecondsAndPath(e,t,n,a){const i=new Date;return i.setTime(i.getTime()+n),g.setStringOrDictionaryValueWithDomain(e,t,null,i,a,"")}static setDictionaryValueWithDomain(e,t,n,a,i){return g.setStringOrDictionaryValueWithDomain(e,null,t,n,a,i)}static setStringOrDictionaryValueWithDomain(e,t,n,a,i,r,s=1,l=!0){return d.AFrameworkApplication_AppSettingsManager.appSettingsManager&&(d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("SanitizeCookiesEnabled")||d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("SanitizeCookiesAtClientEnabled"))&&(g._cookiesToBeSanitized||g.computeCookiesToBeSanitized(),g._cookiesToBeSanitized&&g._cookiesToBeSanitized.contains(e))?(o.ULS.sendTraceTag(577042052,209,15,"Not setting the cookie { 0 }",e),!1):(g.setStringOrDictionaryValueWithDomainInternal(e,t,n,new Date(0),i,r,s,!l),g.setStringOrDictionaryValueWithDomainInternal(e,t,n,a,i,r,s,l))}static setStringOrDictionaryValueWithDomainInternal(e,t,n,i,r,s,h=1,m=!0){if(e.indexOf("=")>=0)throw Error.argumentOutOfRange();let _="";const S=s;(s=g.getSharedDomain(s))&&(_=";domain="+escape(s));let f="";const C=new Date;C.setTime(C.getTime()+g.maxComplianceAllowedRetentionInDays*p),i>C&&(i=C),i&&(t||n)&&(f=";expires="+i.toUTCString());let y="";r&&(y=";path="+escape(r));let A="";document.URL.toLowerCase().startsWith("https://")&&(A=";Secure");let b="";0!==h&&(b=";SameSite="+a[h],""===A&&o.ULS.sendTraceTag(51262751,209,15,"New versions of Chrome will ignore insecure SameSite cookies, which we attempted to write. SameSite:{0}",h));let T="";m&&(T=";Partitioned",""===A&&o.ULS.sendTraceTag(507807042,209,15,"Attempted to use CHIPS in an insecure context. This will be ignored by Chromium."));let v=e+"="+(t?c.a.urlKeyValueEncode(t):n?l.a.join(g.encodeDictionary(n),"&","="):"");return document.cookie=v+_+f+y+A+b+T,d.AFrameworkApplication_AppSettingsManager.appSettingsManager&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("OfficeVSO:8202582_HonorSortOrderVariantCultures")&&(v+=";"),document.cookie&&-1!==document.cookie.indexOf(v)?(u.instance().invalidateCache(e),!0):1===h&&g.setStringOrDictionaryValueWithDomainInternal(e,t,n,i,r,S,0,m)}static remove(e){document.cookie=e+"=",u.instance().removeCachedCookieValue(e)}static getSharedDomain(e){let t=window.location.hostname;if(!(e=s.a.getOrigin(e)))return"";if(e=e.replace("http://","").replace("https://",""),t=t.replace("http://","").replace("https://",""),t===e)return"";const n=t.split("."),a=e.split(".");let i="",o=n.length-1,r=a.length-1;for(;o>=0&&r>=0;){const e=n[o];if(e!==a[r])break;i="."+e+i,o--,r--}return i}static encodeDictionary(e){const t={};if(!e)return t;for(const n in e){const a={key:n,value:e[n]};t[c.a.urlKeyValueEncode(a.key)]=c.a.urlKeyValueEncode(a.value)}return t}static computeCookiesToBeSanitized(){if(d.AFrameworkApplication_AppSettingsManager.appSettingsManager&&d.AFrameworkApplication_AppSettingsManager.appSettingsManager.containsAppSetting("CookiesToBeSanitized")){const e=d.AFrameworkApplication_AppSettingsManager.appSettingsManager.getListAppSetting("CookiesToBeSanitized");g._cookiesToBeSanitized=new r.a;for(let t=0;t<e.length;t++)g._cookiesToBeSanitized.add(e[t])}}constructor(){this.maxComplianceAllowedRetentionInDays=g.maxComplianceAllowedRetentionInDays}}g._cookiesToBeSanitized=null,g.maxComplianceAllowedRetentionInDays=365,(0,i.a)(g,"Cookie",null,[])},9123:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5149),o=n(3078);class r{static getCurrentStyle(e){let t=null;if(e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle&&(t=e.ownerDocument.defaultView.getComputedStyle(e,"")),!t){if(e.currentStyle)return e.currentStyle;r._isFirstNullCurrentStyle&&(i.ULS.sendTraceTag(6587334,210,15,"The current Style object from element was null"),r._isFirstNullCurrentStyle=!1)}return t}static copyStyle(e,t){t.className="",t.style.cssText="";const n=r.getCurrentStyle(e),a=t.style;for(const e in n){const t={key:e,value:n[e]};try{(0,o.a)(String,t.value)&&""!==t.value&&(a[t.key]=t.value)}catch(e){0}}}static setStyle(e,t,n){r.checkStyleExist(e,t)&&(e.style[t]=n)}static removeStyle(e,t){r.setStyle(e,t,"")}static clearStyles(e){e.removeAttribute("style")}static setRotation(e,t){const n="rotate("+t+"deg)";r.setTransform(e,n)}static setFlipTransForms(e,t,n){let a="";t&&(a+="scaleX(-1) "),n&&(a+="scaleY(-1) "),r.setTransform(e,a)}static setTransform(e,t){r.checkStyleExist(e,"transform")?e.style.transform=t:r.checkStyleExist(e,"msTransform")?e.style.msTransform=t:r.checkStyleExist(e,"MozTransform")?e.style.MozTransform=t:r.checkStyleExist(e,"webkitTransform")&&(e.style.webkitTransform=t)}static getTransform(e){return e&&e.style?r.checkStyleExist(e,"transform")?e.style.transform:r.checkStyleExist(e,"msTransform")?e.style.msTransform:r.checkStyleExist(e,"MozTransform")?e.style.MozTransform:r.checkStyleExist(e,"webkitTransform")?e.style.webkitTransform:null:null}static setTransformOrigin(e,t){r.checkStyleExist(e,"transform")?e.style["transform-origin"]=t:r.checkStyleExist(e,"msTransform")?e.style["-ms-transform-origin"]=t:r.checkStyleExist(e,"MozTransform")?(e.style["-moz-transform-origin"]=t,e.style.transformOrigin=t):r.checkStyleExist(e,"webkitTransform")&&(e.style["-webkit-transform-origin"]=t)}static checkStyleExist(e,t){return!(!e||void 0===e.style[t])}static setScale(e,t){const n="scale("+t+")";r.setTransform(e,n),r.setTransformOrigin(e,"0% 0%")}static parseIntDefaultZero(e){const t=parseInt(e);return!e||isNaN(t)?0:t}static isReducedAnimations(){const e=window&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;return e||!1}}r._isFirstNullCurrentStyle=!0,(0,a.a)(r,"CssUtils",null,[])},8582:function(e,t,n){"use strict";n.d(t,{a:function(){return a},b:function(){return i}});const a=e=>3===e.nodeType?e.nodeValue:e.textContent||e.innerText,i=e=>{if(!e||1!==e.nodeType)return null;if(e.outerHTML)return e.outerHTML;{const t=document.createElement("div"),n=e.cloneNode(!0);t.appendChild(n);const a=t.innerHTML;return t.removeChild(n),a}}},4236:function(e,t,n){"use strict";n.d(t,{a:function(){return _}});var a=n(100),i=n(5149),o=n(353),r=n(625),s=n(5018),l=n(9969);class c{get resourceUrl(){return this.defaultToHttp1OnError&&this.failures>0?c.adjustResourceUrlToHttp1(this._resourceUrl,this.attempt1CdnAdjustmentForHttp1Url,this.failures):this._resourceUrl}get failures(){return this._failures}get maxAttempts(){return this._maxAttempts}get defaultToHttp1OnError(){return!1}get attempt1CdnAdjustmentForHttp1Url(){return!1}onFinishedLoadingResource(e){}onError(){this._failures=this.failures+1}dispose(){}static adjustResourceUrlToHttp1(e,t=!1,a=0){const i=l.a.getHostname(e);let o=c.cdnRegex.exec(i);if(o&&1===o.length){const t=o[0],n=i.replace(t,t.slice(0,-1));return e.replace(i,n)}if(t){const t=n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("FallBack1CDNDomains");if(o=c.oneCdnRegex.exec(i),o&&1===o.length&&t&&t.length>0){const n=t.split(","),o=n[a%n.length];return e.replace(i,o)}}return e}constructor(e){this._failures=0,this._maxAttempts=0,this._resourceUrl=e}}c.cdnRegex=new RegExp("c[1-5]h"),c.oneCdnRegex=new RegExp("res-?.*?\\."),(0,a.a)(c,"ResourceRetryBehavior",null,[11]);class d extends c{shouldRetry(){return this.failures<this.maxAttempts}scheduleNextAttempt(e){e()}constructor(e){super(e),this._maxAttempts=3}}(0,a.a)(d,"DefaultRetryBehavior",c,[]);var u=n(680);class p extends Sys.EventArgs{constructor(e,t){super(),this.succeeded=e,this.resourceUrl=t}}(0,a.a)(p,"LoadFinishedEventArgs",Sys.EventArgs,[]);var g=n(2274);const h="LoadingFinished",m="LoadingStart";class _{get TCS(){return this._tcs}get isDownloading(){return 1===this.status}get isDownloaded(){return 2===this.status}get resourceUrl(){return this._resourceUrl}get dependencies(){return this._dependencies}get cdn(){return this._cdn}get status(){return this._status}get retryBehavior(){return this._retryBehavior}get hasFinishedRetries(){return this.retryBehavior.failures===this.retryBehavior.maxAttempts-1}get parentElement(){return this.couldGenerateLayout?document.body:document.getElementsByTagName("head")[0]}add_loadFinished(e){this._eventSource.addHandler(h,e)}remove_loadFinished(e){this._eventSource.removeHandler(h,e)}add_loadStart(e){this._eventSource.addHandler(m,e)}remove_loadStart(e){this._eventSource.removeHandler(m,e)}get loadFinishedTask(){return this._tcs.task}loadResource(){switch(this.status){case 2:this._eventSource.raiseEvent(h,new p(this._downloadResult,this.resourceUrl),this);break;case 0:if(this._eventSource.raiseEvent(m,Sys.EventArgs.Empty,this),this._status=1,this.dependencies){0;for(let e=0;2!==this.status&&e<this.dependencies.length;e++)this.dependencies[e].add_loadFinished(this.onDependencyLoaded),this.dependencies[e].loadResource()}else this.loadResourceInternal()}}loadResourceInternal(){this.cdn?(this.cdn.add_loadFinished(this.onCdnDownloadFinished),this.cdn.addReference()):this.addReference()}addEventHandlers(){$addHandler(this.element,"load",(0,r.a)(this,this.scriptOnLoad,"scriptOnLoad")),$addHandler(this.element,"error",(0,r.a)(this,this.scriptOnError,"scriptOnError")),$addHandler(this.element,"readystatechange",this.onReadyStateChange),this._handlersAdded=!0}finishedLoadingResource(e){-1!==this.resourceUrl.indexOf("cdn.office.net")?e&&g.AFrameworkApplication_AppSettingsManager.appSettingsManager&&g.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("LogResourceDownloadSuccess")?i.ULS.sendTraceTag(594073428,206,15,"{0}",{ResourceUrL:this.resourceUrl,Successful:e}):e||i.ULS.sendTraceTag(4563787,206,this.retryBehavior.failures===this.retryBehavior.maxAttempts?10:50,"{0}",{ResourceUrL:this.resourceUrl,Successful:e,Failures:this.retryBehavior.failures,MaxAttempts:this.retryBehavior.maxAttempts}):i.ULS.sendTraceTag(590410702,206,50,"Not cdn.office.net {0}",{Successful:e,Failures:this.retryBehavior.failures,MaxAttempts:this.retryBehavior.maxAttempts}),this.retryBehavior.onFinishedLoadingResource(e),this._downloadResult=e,this._status=2,this._eventSource.raiseEvent(h,new p(e,this.resourceUrl),this),this.dispose()}scriptOnLoad(e){this.finishedLoadingResource(!0)}scriptOnError(e){this.retryBehavior.onError(),this.retryBehavior.shouldRetry()?this.retryBehavior.scheduleNextAttempt((0,r.a)(this,this.reloadReference,"reloadReference")):this.finishedLoadingResource(!1),e&&(e.preventDefault(),e.stopPropagation())}dispose(){if(this.dependencies){for(let e=0;e<this.dependencies.length;e++)this.dependencies[e].remove_loadFinished(this.onDependencyLoaded);this._dependencies=null}this.cdn&&(this.cdn.remove_loadFinished(this.onCdnDownloadFinished),this._cdn=null),this.removeEventHandlers(),u.a.safeDispose(this.retryBehavior),this._retryBehavior=null,this._numberOfDependenciesLoaded=0}removeEventHandlers(){this._handlersAdded&&($removeHandler(this.element,"load",(0,r.a)(this,this.scriptOnLoad,"scriptOnLoad")),$removeHandler(this.element,"readystatechange",this.onReadyStateChange),$removeHandler(this.element,"error",(0,r.a)(this,this.scriptOnError,"scriptOnError")),this._handlersAdded=!1)}addReference(){this.parentElement?(this.element=this.createElement(),this.element||i.ULS.sendTraceTag(508686683,206,50,"{0}",{ResourceUrl:this.resourceUrl,CouldGenerateLayout:this.couldGenerateLayout}),this.ensureHidden(this.element),this.addEventHandlers(),this._shouldDownloadWithHighPriority&&this.parentElement.appendChild(this.createHighPriorityResourceElement()),this.parentElement.appendChild(this.element)):this.finishedLoadingResource(!1)}ensureHidden(e){this.couldGenerateLayout&&(e.style.visibility="hidden",e.style.position="fixed",e.style.top="-1000px")}constructor(e,t,n,a=null,r=!1){this.excludedScriptsForCheck=["common50.js","common.js","common50.min.js"],this._eventSource=new s.a,this._numberOfDependenciesLoaded=0,this._handlersAdded=!1,this._downloadResult=!1,this.element=null,this.onCdnDownloadFinished=(e,t)=>{t.succeeded?this.finishedLoadingResource(!0):this.addReference()},this.onDependencyLoaded=(e,t)=>{e.remove_loadFinished(this.onDependencyLoaded),2!==this.status&&(t.succeeded?++this._numberOfDependenciesLoaded>=this.dependencies.length&&this.loadResourceInternal():this.finishedLoadingResource(!1))},this.onReadyStateChange=e=>{const t=e.target.readyState;!t||"loaded"!==t&&"complete"!==t||this.finishedLoadingResource(!0)},this._resourceUrl=e,this._cdn=n,this._dependencies=t,this._retryBehavior=a||new d(e),this._shouldDownloadWithHighPriority=r,this._status=0,this._tcs=new o.a,this.add_loadFinished(((e,t)=>{t.succeeded?this._tcs.setResult(!0):this.retryBehavior.failures===this.retryBehavior.maxAttempts?this._tcs.setException(Error.create("Load resource failed. Resource URL: "+t.resourceUrl)):i.ULS.sendTraceTag(521216897,206,50,"{0}",{ResourceUrL:this.resourceUrl,Failures:this.retryBehavior.failures,MaxAttempts:this.retryBehavior.maxAttempts})}))}}(0,a.a)(_,"DelayLoadedResource",null,[11])},6094:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(1520),o=n(9858),r=n(2274),s=n(2594);const l=(c="emptyStringPolicyHTML",(0,s.a)(c,{createHTML:e=>""},d));var c,d;((e,t)=>{(0,s.a)(e,{createScriptURL:e=>""},t)})("emptyStringPolicyURL");var u=n(9800);class p{static ensureCSSClassOnElement(e,t){return!Sys.UI.DomElement.containsCssClass(e,t)&&(Sys.UI.DomElement.addCssClass(e,t),!0)}static removeCSSClassFromElement(e,t){return!!Sys.UI.DomElement.containsCssClass(e,t)&&(Sys.UI.DomElement.removeCssClass(e,t),!0)}static getChildById(e,t){if(!e||!t)return null;let n=e.firstChild;for(;n&&n.id!==t;)n=n.nextSibling;return n}static getChildByIdEndsWith(e,t){if(!e||!t)return null;let n=e.firstChild;for(;n&&!n.id.endsWith(t);)n=n.nextSibling;return n}static addAsFirstChild(e,t){if(!e||!t)return;const n=e.firstChild;n?e.insertBefore(t,n):e.appendChild(t)}static removeElement(e){e&&e.parentNode&&e.parentNode.removeChild(e)}static getLeafElements(e){const t=new i.a;if(e){const n=e.children;if(!n||!n.length)return t.add(e),t;for(let e=0,a=n.length;e<a;e++)t.addRange(p.getLeafElements(n[e]))}return t}static getAllElements(e,t){const n=new i.a;if(!e)return n;const a=e.childNodes.length;for(let i=0;i<a;++i)n.addRange(p.getAllElements(e.childNodes[i],t));return(t||1===e.nodeType)&&n.add(e),n}static getAllElementsCount(e,t){let n=0;if(!e)return n;const a=e.childNodes.length;for(let i=0;i<a;++i)n+=p.getAllElementsCount(e.childNodes[i],t);return(t||1===e.nodeType)&&n++,n}static getFirstChildByTagName(e,t){if(!e||!t)return null;t=o.a.toUpper(t);for(let n=0,a=e.childNodes.length;n<a;n++){const a=e.childNodes[n];if(1===a.nodeType&&o.a.toUpper(a.tagName)===t)return a}return null}static clearElement(e){if(e)try{for(;e.firstChild;)e.removeChild(e.lastChild)}catch(e){0}}static clearElementRecursively(e){if(e)for(;e.firstChild;)p.clearElementRecursively(e.lastChild),e.removeChild(e.lastChild)}static isDescendantOf(e,t){return!!e&&e.contains(t)}static setElementText(e,t){e&&(e.innerText="",t&&t.length>0&&(1===e.childNodes.length?e.replaceChild(e.ownerDocument.createTextNode(t),e.firstChild):e.appendChild(e.ownerDocument.createTextNode(t))))}static getDOMElementClassName(e){return e?e.className&&Object.getType(e.className)===String?e.className:1===e.nodeType&&e.getAttribute("class")?e.getAttribute("class").toString():"":""}static getFirstNodeValueByTagNameOrDefault(e,t){if(!e||!t)return null;const n=e.getElementsByTagName(t);return n&&n[0]&&n[0].firstChild?n[0].firstChild.nodeValue:null}static domTagToString(e){let t=null;switch(e){case 1:t="a";break;case 2:t="button";break;case 10:t="canvas";break;case 8:t="div";break;case 6:t="iframe";break;case 3:t="input";break;case 11:t="object";break;case 13:t="p";break;case 7:t="param";break;case 4:t="select";break;case 12:t="span";break;case 15:t="td";break;case 14:t="th";break;case 5:t="textarea"}return t}static get tagStrings(){return p._tagStrings||(p._tagStrings={},p._tagStrings.a=1,p._tagStrings.button=2,p._tagStrings.input=3,p._tagStrings.select=4,p._tagStrings.textarea=5,p._tagStrings.iframe=6,p._tagStrings.param=7,p._tagStrings.body=9,p._tagStrings.canvas=10),p._tagStrings}static createElementWithInnerTextSafe(e,t){let n=null;const a=p.domTagToString(e);return a&&(n=document.createElement(a),n.innerText=t),n}static createElementWithInnerText(e,t){const n=document.createElement(e);return n.innerText=t,n}static getAncestorContainingCssClass(e,t){if(!e||!t)return null;let n=e.parentNode;for(;n&&!Sys.UI.DomElement.containsCssClass(n,t);)n=n.parentNode;return n}static getAncestorByClassName(e,t){if(!e||!t)return null;let n=e.parentNode;for(;n&&n.className!==t;)n=n.parentNode;return n}static getFirstAncestorElement(e){if(!e)return null;let t=e;for(;t&&1!==t.nodeType;)t=t.parentNode;return t}static getChildByClassNameNonExclusive(e,t){if(!e||!t)return null;let n=e.firstChild;for(;n&&!Sys.UI.DomElement.containsCssClass(n,t);)n=n.nextSibling;return n}static getChildByClassName(e,t){if(!e||!t)return null;let n=e.firstChild;for(;n&&n.className!==t;)n=n.nextSibling;return n}static getChildByClassNameStartWith(e,t){if(!e||!t)return null;let n=e.firstChild;for(;n&&!p.getDOMElementClassName(n).startsWith(t);)n=n.nextSibling;return n}static getChildByClassNameStartWithRecursively(e,t){if(!e||!t)return null;let n=p.getChildByClassNameStartWith(e,t);if(!n)for(let a=0;a<e.childNodes.length&&!n;a++)n=p.getChildByClassNameStartWithRecursively(e.childNodes[a],t);return n}static getChildByIdStartWith(e,t){if(!e||!t)return null;let n=e.firstChild;for(;n&&!n.id.startsWith(t);)n=n.nextSibling;return n}static getChildrenByClassName(e,t){let n=e.firstChild;const a=new i.a;for(;n;)n.className&&n.className.trim()===t&&a.add(n),n=n.nextSibling;return a.toArray()}static parseCssSize(e){return!e||e.endsWith("%")||isNaN(parseInt(e))?0:parseInt(e)}static parseCssSizeDouble(e){return!e||e.endsWith("%")||isNaN(parseFloat(e))?0:parseFloat(e)}static setElementCssFloat(e,t){if(e)for(const n of p._cssFloatValues)if(n===t){const n=String.format("float: {0};",t),a=p._cssFloatRegex.exec(e.style.cssText);if(a){const t=a.toString();t!==n&&(e.style.cssText=e.style.cssText.replace(t,n));break}e.style.cssText+=n;break}}static setElementStyleTopInPixels(e,t){if(p.isValidElement(e)){const n=t+"px";e.style.top=n}}static setElementStyleLeftInPixels(e,t){if(p.isValidElement(e)){const n=t+"px";e.style.left=n}}static setElementStyleWidthInPixels(e,t){if(p.isValidElement(e)){const n=t+"px";e.style.width=n}}static setElementStyleHeightInPixels(e,t){if(p.isValidElement(e)){const n=t+"px";e.style.height=n}}static getElementStyleTopInPixels(e){return p.isValidElement(e)?p.getPixelSize(e.style.top):0}static getElementStyleLeftInPixels(e){return p.isValidElement(e)?p.getPixelSize(e.style.left):0}static getElementStyleWidthInPixels(e){return p.isValidElement(e)?p.getPixelSize(e.style.width):0}static getElementStyleHeightInPixels(e){return p.isValidElement(e)?p.getPixelSize(e.style.height):0}static getPixelSize(e){if(e&&-1!==e.indexOf("px")){const t=parseInt(o.a.substring(e,0,e.indexOf("px")));if(!isNaN(t))return t}return 0}static getChildrenByTagName(e,t){t=o.a.toUpper(t);const n=new i.a;for(let a=0,i=e.childNodes.length;a<i;a++){const i=e.childNodes[a];1===i.nodeType&&o.a.toUpper(i.tagName)===t&&n.add(i)}return n.toArray()}static copyChildNodes(e,t,n=!1){p.clearElement(t);const a=e.childNodes;if(a.length>0){const e=document.createDocumentFragment();for(let t=0,i=a.length;t<i;t++){const i=a[t];(n||"IFRAME"!==i.tagName)&&e.appendChild(i.cloneNode(!0))}t.appendChild(e)}}static clearElementHtml(e){if(e&&""!==e.innerHTML.toString()){u.a.logUniqueUsage("efb1a590;e7deb809");const t=r.AFrameworkApplication_AppSettingsManager.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.isInnerHTMLWordEditorPolicyEnabled",!1)??!1;e.innerHTML=t?l.createHTML(""):""}}static elementAttached(e){return!p.rootElementIfNotAttached(e)}static getRootElementIfNotAttached(e){return p.rootElementIfNotAttached(e)}static getTag(e){const t=p.tagStrings[o.a.toLower(e.tagName||"")];return null!=t?t:0}static isInDocument(e){return!!e&&!!e.parentNode&&!!e.parentNode.ownerDocument}static isValidElement(e){return!!e&&!!e.ownerDocument}static getElementText(e){if(!e)return"";if(3===e.nodeType){e.nodeValue;return e.nodeValue}let t="";for(let n=0,a=e.childNodes.length;n<a;n++)t+=p.getElementText(e.childNodes[n]);return t}static getElementTextLength(e,t=!1){if(t)return 1;if(3===e.nodeType){e.nodeValue;return e.nodeValue.length}let n=0;for(let t=0,a=e.childNodes.length;t<a;t++)n+=p.getElementTextLength(e.childNodes[t]);return n}static isListTag(e){if(!e)return!1;const t=e.tagName.toLocaleLowerCase();return"ol"===t||"ul"===t}static isEditable(e){return!!e&&(("INPUT"===e.tagName&&"button"!==e.getAttribute("type")&&"image"!==e.getAttribute("type")&&"checkbox"!==e.getAttribute("type")||"SELECT"===e.tagName||"true"===e.getAttribute("contenteditable")||"TEXTAREA"===e.tagName)&&!e.disabled)}static rootElementIfNotAttached(e){return 9===e.nodeType||1===e.nodeType&&"HTML"===e.tagName.toUpperCase()?null:e.parentNode&&p.elementHasChild(e.parentNode,e)?p.rootElementIfNotAttached(e.parentNode):e}static elementHasChild(e,t){for(let n=0,a=e.childNodes.length;n<a;n++)if(e.childNodes[n]===t)return!0;return!1}static getViewPortWidth(){return window.innerWidth}static getViewPortHeight(){return window.innerHeight}static setFormattedTextToPlaceholders(e,t,n,a=null){for(;e.hasChildNodes();)e.removeChild(e.firstChild);if(!n||void 0===n||!n.length)return void(e.innerText=t);const i=new RegExp("{(\\d+)}|(?:{{)+|(?:(?!{\\d+}|(?:{{)+).)+","g");t.replace(i,((t,i)=>{let o;if(i){let e;const r=parseInt(i);e=isNaN(r)||r>=n.length?t:n[r]||"",a?o=a(e):(o=document.createElement("span"),o.setAttribute("dir","auto"),o.innerText=e)}else o=document.createTextNode(t);return e.appendChild(o),null}))}}p._cssFloatValues=["left","right","none","initial","inherit"],p._cssFloatRegex=new RegExp("float: *[A-Za-z]+;"),p._tagStrings=null,(0,a.a)(p,"DomUtils",null,[])},4378:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(7296),o=n(4236);class r extends o.a{get couldGenerateLayout(){return!0}createElement(){const e=document.createElement("img");return e.setAttribute("src",this.resourceUrl),e}createHighPriorityResourceElement(){return null}reloadReference(){this.element.setAttribute("src",""),this.element.setAttribute("src",this.retryBehavior.resourceUrl)}constructor(e){super(e)}}(0,a.a)(r,"ImageResource",o.a,[]);var s=n(576),l=n(9611),c=n(988);class d{addStatusCallback(e){Array.contains(this._statusListeners,e)||Array.add(this._statusListeners,e)}removeStatusCallback(e){Array.contains(this._statusListeners,e)&&Array.remove(this._statusListeners,e)}updateQueueStatus(e){const t=[],n=[];for(;this._queue.length>0;){const e=Array.dequeue(this._queue);Array.enqueue(n,e),Array.add(t,e.resourceUrl)}this._queue=n;for(let n=0;n<this._statusListeners.length;n++){(0,this._statusListeners[n])(e,t)}}ensureTaskSet(){const{AFrameworkApplication:e}=n(3245);this._taskSet||(e.theTaskManager.addTask(this._downloadQueueTask),this._taskSet=!0)}add(e,t,a,i){const o=n(3245).AFrameworkApplication.theActionManager;0===a?o.addAction(e,t,this.actionHandlerStub):o.addActionWithFlags(e,t,this.actionHandlerStub,a);const r=e.toString()+t.toString();this._actionsToSlices[r]=i,Array.enqueue(this._queue,i),this.ensureTaskSet()}addImage(e){const t=new r(e);return Array.enqueue(this._queue,t),this.ensureTaskSet(),t}addResource(e){Array.enqueue(this._queue,e),this.downloadQueueTask(null),this._queue.length>0&&this.ensureTaskSet()}addHandler(e){Array.add(this._handlers,e)}addScriptReference(e){e.resourceUrl in this._scriptsAdded?e.TCS.setResult(!0):(e.loadResource(),this._scriptsAdded[e.resourceUrl]=e)}removeScriptReference(e){e in this._scriptsAdded&&delete this._scriptsAdded[e]}static onDemandLoadDialogDismissed(e,t,n,a,i){return 32}static get instance(){return d._instance||(d._instance=new d)}static enqueueActions(e,t){if(e&&t)for(let n=0;n<e.length;n++){const a=e[n];d.instance.add(a.actionId,a.contextId,a.flags,t)}}static enqueueMultipleActions(e,t){const a=s.a.create(n(3245).AFrameworkApplication.scriptUrlFromName(t,0));d.enqueueActions(e,a)}static enqueueImage(e){return d.instance.addImage(e)}static registerDispatchHandler(e){d.instance.addHandler(e)}static enqueueWithoutEnabling(e,t=null,a=0,i=!1,o=!1,r=null,l=!0){const c=n(3245).AFrameworkApplication.scriptUrlFromName(e,a),u=n(3245).AFrameworkApplication.sriHashFromName(e,a),p=s.a.create(c,null,null,null,i,o,r,l,!1,u);p.add_loadFinished(((e,n)=>{t&&t(e,n)})),d.instance.addResource(p)}static enqueueResourceWithoutEnabling(e){e.isDownloading||e.loadFinishedTask.isCompleted||d.instance.addResource(e)}static removeReferenceForRetryDownload(e){d.instance.removeScriptReference(e)}constructor(){this._actionsToSlices={},this._queue=[],this._handlers=[],this._scriptsAdded={},this._statusListeners=[],this._paused=!1,this._downloadQueueTask=null,this._taskSet=!1,this.downloadQueueTask=e=>{const{AFrameworkApplication:t}=n(3245);if(this.updateQueueStatus(String.format("Queue contains {0} elements",this._queue.length)),this._paused)return;const a=Array.dequeue(this._queue);a&&(this.updateQueueStatus(String.format("Retrieving {0}",a.resourceUrl)),this.addScriptReference(a)),this._queue.length<=0&&this._taskSet&&(t.theTaskManager.deleteTask(this._downloadQueueTask),this._taskSet=!1)},this.actionHandlerStub=(e,t,n,a,i)=>{if(this._handlers.length>0)for(let o=0;o<this._handlers.length;o++){const r=(0,this._handlers[o])(e,t,n,a,i);if(2!==r)return r}if(2===n){const o=e.toString()+t.contextId.toString(),r=this._actionsToSlices[o],l=r.resourceUrl,c=[];this._scriptsAdded[l]&&this._scriptsAdded[l].promote(e,t,n,a,i,this.actionHandlerStub);const d=new s.a(l,r.dependencies,r.cdn,r.loadValidationDelegate,e,t,n,a,i,this.actionHandlerStub);let u;for(Array.enqueue(c,d);u=Array.dequeue(this._queue);)u.resourceUrl!==l&&Array.enqueue(c,u);return this._queue=c,this.downloadQueueTask(null),64}return 1===n?32:2};const{AFrameworkApplication:e}=n(3245),t=n(3245).AFrameworkApplication.theActionManager;t.addAction(c.a.onDemandLoadingDialogCompleted,l.a.frame,d.onDemandLoadDialogDismissed),t.addAction(c.a.onDemandLoadingDialogCancelled,l.a.frame,d.onDemandLoadDialogDismissed),this._downloadQueueTask=new i.a(3,2,100,this.downloadQueueTask,20),this.ensureTaskSet()}}d._instance=null,(0,a.a)(d,"DownloadQueue",null,[])},3516:function(e,t,n){"use strict";n.d(t,{a:function(){return o},b:function(){return r},c:function(){return s}});var a=n(3245),i=n(3888);const o=()=>{const e=a.AFrameworkApplication.activeFrame.applicationInstance.officeAppType;return(3===e||1===e||2===e||4===e)&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PremiumUpsellIsEnabled")},r=(e,t,n,o=!1)=>{let r=1===t;return 1===e&&(r=2===a.AFrameworkApplication.activeFrame.mode),String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",i.a[e],r?"Editor":"Viewer",o?"Dime":"Unknown",n||"dimedefault")},s=e=>{switch(e){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},5368:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100);const i="Hidden";class o{static initialize(e){o._rootElement=e,Sys.UI.DomElement.addCssClass(o._rootElement,"HtmlScratchPad"),o.setHasLayout(!1)}static reset(){o._rootElement=null}static getScratchPad(e){let t=o.utilElements[e];return t||(t=o._rootElement.ownerDocument.createElement("div"),o._rootElement.appendChild(t),o.utilElements[e]=t),t}static releaseScratchPad(e){const t=o.utilElements[e];o._rootElement.removeChild(t),o.utilElements[e]=null}static beginScratchPadUse(){o._beginCount++,1===o._beginCount&&o.setHasLayout(!0)}static endScratchPadUse(){o._beginCount--,o._beginCount||o.setHasLayout(!1)}static setHasLayout(e){e?Sys.UI.DomElement.removeCssClass(o._rootElement,i):Sys.UI.DomElement.addCssClass(o._rootElement,i)}static get isInitialized(){return!!o._rootElement}}o._rootElement=null,o.utilElements={},o._beginCount=0,(0,a.a)(o,"HtmlScratchPadProvider",null,[])},680:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(7826);class o{static safeDisposeArray(e){if(e)for(let t=0,n=e.length;t<n;t++)o.safeDispose(e[t])}static safeDispose(e){if(e)try{e.dispose()}catch(e){0,(0,i.a)(e)}}}(0,a.a)(o,"IDisposableExtensions",null,[])},965:function(e,t,n){"use strict";n.d(t,{a:function(){return i},b:function(){return r},c:function(){return a},d:function(){return o}});const a=e=>JSON.stringify(e),i=e=>JSON.parse(e),o=e=>{let t;try{t=r(e)}catch(e){return t=null,{returnValue:!1,deserialized:t}}return{returnValue:!0,deserialized:t}},r=e=>JSON.parse(e)},7607:function(e,t,n){"use strict";n.r(t),n.d(t,{LoadingDialog:function(){return r}});var a=n(100),i=n(3696),o=n(8103);class r extends i.StandardDialog{display(){this._displayCount||(this.buttonsOption=6,this.setDefaultButton(0),this.showInformation((0,o.a)("DefaultDialogTitle"),(0,o.a)("DialogLoading"),this._loadingDialogHandler)),this._displayCount++}stopDisplay(){this._displayCount--,this._displayCount||(this.hide(),this.dispose())}constructor(e){super(),this._displayCount=0,this._loadingDialogHandler=e}}(0,a.a)(r,"LoadingDialog",i.StandardDialog,[])},956:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(5149);class o{getItem(e){try{if(o.isValidKey(e)&&this.localStorage)return this.localStorage.getItem(e)}catch(e){i.ULS.sendTraceTag(593512200,306,15,"LocalStorageWrapper Exception: {0} ",e.message)}return null}setItem(e,t){try{o.isValidKey(e)&&this.localStorage&&this.localStorage.setItem(e,t)}catch(e){i.ULS.sendTraceTag(593512199,306,15,"LocalStorageWrapper Exception: {0} ",e.message)}}removeItem(e){try{o.isValidKey(e)&&this.localStorage&&this.localStorage.removeItem(e)}catch(e){i.ULS.sendTraceTag(593512198,306,15,"LocalStorageWrapper Exception: {0} ",e.message)}}get localStorage(){let e=null;if(!this._localStorageNotWorking)try{localStorage&&(e=localStorage)}catch(e){this._localStorageNotWorking=!0}return e}static get instance(){return o._instance||(o._instance=new o),o._instance}static isValidKey(e){return!(null==e||e.length<=0)}constructor(){this._localStorageNotWorking=!1}}o._instance=null,(0,a.a)(o,"LocalStorageWrapper",null,[128])},4852:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static pointInBounds(e,t){return!(e.x<t.x||e.y<t.y)&&(e.x<=t.x+t.width&&e.y<=t.y+t.height)}static snapPointToBounds(e,t){const n=new Sys.UI.Point(e.x,e.y);return n.x<t.x&&(n.x=t.x),n.x>t.x+t.width&&(n.x=t.x+t.width),n.y<t.y&&(n.y=t.y),n.y>t.y+t.height&&(n.y=t.y+t.height),n}static distancePointToPoint(e,t){return Math.round(Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)))}static distancePointToBounds(e,t){const n=i.snapPointToBounds(e,t);return i.distancePointToPoint(e,n)}static distancePointToBoundsWithBias(e,t,n=50){const a=new Sys.UI.Point(e.x,e.y*n),o=new Sys.UI.Bounds(t.x,t.y*n,t.width,t.height*n);return i.distancePointToBounds(a,o)}static isBetween(e,t,n){return t<=e&&e<=n}static isEqualish(e,t){return Math.abs((e-t)/(t||1))<i.floatEqualish}static isCloseEnough(e,t,n){return Math.abs(e-t)<=n}static subtractPoint(e,t){return new Sys.UI.Point(e.x-t.x,e.y-t.y)}static addPoint(e,t){return new Sys.UI.Point(e.x+t.x,e.y+t.y)}static hasTimeElapsed(e,t){return(new Date).getTime()-e.getTime()>t}static randomBetween(e,t){return e+Math.floor(Math.random()*(t-e+1))}static randomUInt31(){return 1+Math.floor(2147483647*Math.random())}static sign(e){return e>0?1:e?-1:0}static radianToDegree(e){return e*(180/Math.PI)}static radianToSixtyThousandthDegree(e){return 6e4*i.radianToDegree(e)}static degreeToRadian(e){return e*(Math.PI/180)}static sixtyThousandthDegreeToRadian(e){return i.degreeToRadian(e/6e4)}static roundNumber(e,t){const n=Math.pow(10,t);return Math.floor(Math.round(e*n))/n}static ceiling(e){return Math.ceil(e)}static getUnionOfBounds(e){if(!e||!e.length)return new Sys.UI.Bounds(0,0,0,0);let t=e[0].x,n=e[0].y,a=e[0].x+e[0].width,i=e[0].y+e[0].height;for(let o=1;o<e.length;o++){t=e[o].x<t?e[o].x:t,n=e[o].y<n?e[o].y:n;const r=e[o].x+e[o].width,s=e[o].y+e[o].height;a=r>a?r:a,i=s>i?s:i}return new Sys.UI.Bounds(t,n,a-t,i-n)}}i.floatEpsilon=1.192093e-7,i.floatEqualish=1192093e-12,(0,a.a)(i,"MathUtils",null,[])},8829:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}(0,a.a)(i,"OAuthResult",null,[])},6654:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(3245);class o{static setExecuteState(e){o._notifyStateElement||(o._notifyStateElement=document.createElement("div"),o._notifyStateElement.id="WacExecuteState",o._notifyStateElement.style.display="none",document.body.appendChild(o._notifyStateElement)),o._notifyStateElement.innerText=e}static verifyExecuteState(){return i.AFrameworkApplication.theTaskManager.isYielding?(o.setExecuteState("Blocked"),!1):(o.setExecuteState("Allowed"),!0)}static ignoreExecuteState(){o.setExecuteState("Ignore")}static getExecuteState(){i.AFrameworkApplication.theTaskManager.isYielding?o.setExecuteState("InProgress"):o.setExecuteState("Complete")}static calcActionId(e){let t=5381,n=t;const a=e.length;for(let i=0;i<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==a-1);i+=2)n=4294967295&((n<<5)+n^e.charCodeAt(i+1));let i=t+35685*n+(23896*n<<16)&4294967295;return i<0&&(i+=4294967296),i}}o._notifyStateElement=null,(0,a.a)(o,"ObjectModelUtils",null,[])},4990:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(2409);const i=()=>!!window.location.search.match(new RegExp("wdpa=1","gi"))||"1"===a.a.get("EnableMetricLogging")},2088:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(3078),o=n(9974);class r{get isEmpty(){return!this._queue.length}get length(){return this._queue.length}peekAt(e){const t=this._queue[e];return t?t.data:null}removeAt(e){Array.removeAt(this._queue,e)}enqueue(e,t){let n=0;if(!this.isEmpty){let t,a,i=0,o=this._queue.length-1;do{if(t=Math.ceil((i+o)/2),a=this._queue[t],a.priority<e)i=t+1;else{if(!(a.priority>e))break;o=t-1}}while(i<=o);for(n=t;n<=o&&this._queue[n].priority<=e;)n++}Array.insert(this._queue,n,new o.a(e,t))}dequeue(){const e=this.peekAt(0);return e?(this.removeAt(0),e):null}static compare(e,t){if((0,i.a)(o.a,e)&&(0,i.a)(o.a,t)){const n=e,a=t;return n.priority<a.priority?-1:n.priority===a.priority?0:1}throw Error.create("Invalid parameter passed to Sort.Compare")}constructor(){this._queue=[]}}(0,a.a)(r,"PriorityQueue",null,[])},6915:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(4139),o=n(9858);class r{getParam(e){return i.a.getParameterValueDecoded(this._queryString,e)}addParam(e,t){this.addFullParam(o.a.urlKeyValueEncode(e)+"="+o.a.urlKeyValueEncode(t))}addOrReplaceParam(e,t){this._queryString=i.a.addOrReplaceParameterValue(this._queryString,o.a.urlKeyValueEncode(e),t?o.a.urlKeyValueEncode(t):null)}addFullParam(e){this._queryString+=(this._first?"?":"&")+e,this._first=!1}addOrReplaceFullParam(e){const t=e.split("=");if(2!==t.length)return void 0;const n=t[0],a=t[1];this._queryString=i.a.addOrReplaceParameterValue(this._queryString,n,a)}toString(){return this._queryString}constructor(e){this._queryString=e,this._first=-1===e.indexOf("?")}}(0,a.a)(r,"QueryStringBuilder",null,[])},719:function(e,t,n){"use strict";n.d(t,{a:function(){return o},b:function(){return s},c:function(){return r},d:function(){return l}});var a=n(9858),i=n(5861);const o="height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",r=(e,t,n)=>{u(e);switch(n){case 4:s(e,t,null,!1);break;case 7:2===e?l(!1,"325036",t,"",o):4===e&&l(!1,"864324",t,"",o)}},s=(e,t,n,a)=>{let i=p(e)+"WAEndUser";if(a){0;const e=n.indexOf("_")>0?n:i+"_"+n;return void(n?window.parent.HelpWindowKey(e):window.parent.HelpWindow())}if(n.indexOf("_")>0){const e=n.split("_");if(2!==e.length)return void 0;i=e[0],n=e[1]}n&&"home"===n.toLowerCase()&&(n="");let r="&p1="+i+"&apps=WDWAENDUSER%2CXLWAENDUSER%2CPPWAENDUSER%2CONWAENDUSER";n&&(r+="&HelpID="+n),l(!0,"rlidOfficeWebHelp",t,r,o)},l=(e,t,n,a,o)=>{let r=e?c(t,n):d(t,n);a&&(r+=a),o?i.a.safelyOpenWindow(r,"_blank",o,"RedirectUrl.OpenWindowToUrl.Blank"):i.a.safelyOpenWindow(r,void 0,void 0,"RedirectUtil.OpenWindowToUrl")},c=(e,t)=>"https://r.office.microsoft.com/r/"+e+"?clid="+t.toString()+"&ver=15",d=(e,t)=>"https://go.microsoft.com/fwlink/?LinkID="+e+"&clcid="+a.a.convertToHex(t,4),u=e=>{switch(e){case 1:return"Excel";case 2:return"Word";case 3:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return""}},p=e=>{switch(e){case 1:return"XL";case 2:return"WD";case 3:return"PP";case 4:return"ON";case 5:return"VI";default:return""}}},576:function(e,t,n){"use strict";n.d(t,{a:function(){return m}});var a=n(100),i=n(5149),o=n(1520),r=n(7442),s=n(4236),l=n(7607),c=n(9969),d=n(988),u=n(9800);class p{static createCDNPolicy(e,t){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy(e,{createScriptURL(e){const n=new URL(e).hostname,a=window.location.hostname;if(n===a||t.some((e=>n.endsWith(e))))return e;throw new TypeError(`Invalid CDN URL: ${n.replace(/\./g,"DOT")}`)}}):null}}(0,a.a)(p,"ContentSecurityPolicyHelper",null,[]);const g=p;var h=n(2764);class m extends s.a{get loadValidationDelegate(){return this._loadValidationDelegate}get couldGenerateLayout(){return!1}createElement(){return this.createElementWithLocation(this.resourceUrl)}reloadReference(){this.removeEventHandlers();const e=this.element.parentNode;e.removeChild(this.element),this.element=this.createElementWithLocation(c.a.addOrReplaceParameterValue(this.retryBehavior.resourceUrl,"retries",this.retryBehavior.failures.toString())),this.addEventHandlers(),e.appendChild(this.element)}createHighPriorityResourceElement(){const{AFrameworkApplication:e}=n(3245),t=document.createElement("link");return t.setAttribute("as","script"),t.setAttribute("rel","preload"),e.useCrossOriginStaticScripts&&!this._ignoreCrossOriginResourceSharing&&t.setAttribute("crossorigin","anonymous"),t.setAttribute("href",this.resourceUrl),t}createElementWithLocation(e){const{AFrameworkApplication:t}=n(3245),a=document.createElement("script");if(a.setAttribute("type","text/javascript"),t.useCrossOriginStaticScripts&&!this._ignoreCrossOriginResourceSharing&&(a.setAttribute("crossorigin","anonymous"),this._sriHash&&a.setAttribute("integrity",String.format("sha256-{0}",this._sriHash))),this._defer&&a.setAttribute("defer",""),this._async||(a.async=!1),this._cdnUrlPolicy&&a.setAttribute("src",this._cdnUrlPolicy.createScriptURL(e)),t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.setAttributeForWord",!1))try{a.setAttribute("src",h.b.createScriptURL(e))}catch(t){a.setAttribute("src",e)}else a.setAttribute("src",e);return this._actionId&&window.setTimeout(this.onLoadTimer.bind(this),500),a}finishedLoadingResource(e){const{AFrameworkApplication:t}=n(3245),a=e&&this._loadValidationDelegate?this._loadValidationDelegate():e;if(e&&!a&&(u.a.logUniqueUsage("RetryOnFailedVerification;RetryOnFailedVerificationCF"),t.appSettingsManager&&t.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryOnFailedVerification",!1)))return this.scriptOnError(null),void i.ULS.sendTraceTag(543273999,206,10,"Degrading success to failure");super.finishedLoadingResource(a),a&&(this._loadingDialogNeeded&&this._loadingDialog&&(this._loadingDialog.stopDisplay(),this._loadingDialogNeeded=!1,t.theActionManager.processAction(d.a.onDemandLoadingDialogCompleted,2)),this._actionId&&this._actionHandler&&this._actionHandler(this._actionId,this._context,this._behavior,this._reportingData,this._actionData)),this._actionId=0}onLoadTimer(){if(2!==this.status&&!this._loadingDialogNeeded){!1?(async()=>{try{this._loadingDialog=await(0,r.a)(9,this.loadingDialogHandler),this._loadingDialog.display(),this._loadingDialogNeeded=!0}catch(e){i.ULS.sendTraceTag(505718421,206,10,"Failed to create LoadingDialog asynchronously: {0}",e)}})():(this._loadingDialog=new l.LoadingDialog(this.loadingDialogHandler),this._loadingDialog.display(),this._loadingDialogNeeded=!0)}}promote(e,t,n,a,i,o){!this._actionId&&e&&(this._actionId=e,this._context=t,this._behavior=n,this._reportingData=a,this._actionData=i,this._actionHandler=o,window.setTimeout(this.onLoadTimer.bind(this),500))}static get_scriptResourceWithActions(){return m.scriptResourceWithActions}static create(e,t,n,a,i=!1,r=!1,s=null,l=!0,c=!1,d=null){const u=new m(e,t,n,a,0,null,1,null,null,null,i,r,s,l,c,d);return m.get_scriptResourceWithActions()||(m.scriptResourceWithActions=new o.a),m.get_scriptResourceWithActions().add(u),u}constructor(e,t,a,i,o,r,s,l,c,u,p=!1,h=!1,m=null,_=!0,S=!1,f=null){const{AFrameworkApplication:C}=n(3245);if(super(e,t,a,m,S),this._cdnUrlPolicy=null,this._loadingDialogNeeded=!1,this._loadingDialog=null,this.loadingDialogHandler=(e,t)=>{const{AFrameworkApplication:a}=n(3245);this._actionId=0,this._loadingDialogNeeded&&this._loadingDialog&&(this._loadingDialogNeeded=!1,this._loadingDialog.stopDisplay(),a.theActionManager.processAction(d.a.onDemandLoadingDialogCancelled,2))},this._loadValidationDelegate=i,this._actionId=o,this._context=r,this._behavior=s,this._reportingData=l,this._actionData=c,this._actionHandler=u,this._ignoreCrossOriginResourceSharing=p,this._defer=h,this._async=_,this._sriHash=f,C.appSettingsManager?.getBooleanAppSetting("EnableCDNUrlTrustedTypePolicy")){const e=C.appSettingsManager?.getListAppSetting("ListOfAllowedCDNDomainsforTrustedType");this._cdnUrlPolicy=g.createCDNPolicy("cdn-url#msosp",e)}}}m.scriptResourceWithActions=null,(0,a.a)(m,"ScriptResourceWithAction",s.a,[])},1493:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(e,t)=>-1!==e.indexOf(t)},9969:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(1520),o=n(6996),r=n(4139);class s extends r.a{static getParametersFromUrl(e,t){const n=new o.a;for(const a of t){const t=s.getParameterValueDecoded(e,a);t&&n.add(a,t)}return n}static removeParameter(e,t,n=!1){return s.addOrReplaceParameterValue(e,t,null,n)}static removeParameters(e,t){let n=e;for(const e of t)n=s.removeParameter(n,e);return n}static addParameterValue(e,t,a){const i=new(n(6915).a)(e);return i.addParam(t,a),i.toString()}static getAbsoluteUrl(e){const t=new Sys.Net.WebRequest;return t.set_url(e),t.getResolvedUrl()}static getOrigin(e){return s.executeHostPartRegExp(e,0)}static getHost(e){return s.executeHostPartRegExp(e,1)}static executeHostPartRegExp(e,t){if(!e)return"";const n=s._hostPartRegExp.exec(e);return n&&n.length>t?n[t]:""}static getHostname(e){if(!e)return"";const t=s._hostnamePartRegExp.exec(e);return t&&t.length>1?t[1]:""}static removeAllUrlParameters(e){if(!e)return"";const t=e.search(/[?#&]/g);return-1==t?e:e.substring(0,t)}static getFwLinkUrl(e){return s.addParameterValue("https://go.microsoft.com/fwlink/","LinkID",e)}static getFwLinkForUpsellFeatures(e){return e?s.getFwLinkUrl("862405")+String.format("&pc={0}",e):s.getFwLinkUrl("522402")}static getPageName(e){if(!e)return"";const t=-1===e.indexOf("#")?e.length:e.indexOf("#");let n=e.lastIndexOf("/",t);if(-1!==n&&n+1===e.indexOf("://")+3)return"";n+=1;let a=e.indexOf("?");if(a=a>=t?-1:a,-1!==a&&n>a)return"";const i=-1===a?t:a;return n>=i?"":e.substring(n,i)}static addOrReplaceParametersValue(e,t){for(const n of t)e=s.addOrReplaceParameterValue(e,n.key,n.value);return e}static isEndingWithSpecificUrl(e,t){const n=s.removeAllUrlParameters(e);for(let e=0;e<t.length;e++){const a=t[e];if(a&&n.endsWith(a))return!0}return!1}static hasParameterValue(e,t,n=!1){return!!s.getParameterValue(e,t,n)}static removeAccessTokensFromSource(e,t){const n=t?{...t}:{};let a=e;const o=new i.a;o.add("access_token"),o.add("access_token_ttl");const r=s.getParametersFromUrl(a,o);a=s.removeParameters(a,o);for(const e of r)n[e.key]=e.value;return{url:a,headers:n}}removeAccessTokensFromSource(e,t){return s.removeAccessTokensFromSource(e,t)}}s._hostPartRegExp=new RegExp("^[a-z+.-]+://([^/:]*(:[0-9]{1,5})?)","i"),s._hostnamePartRegExp=new RegExp("^[a-z+.-]+://([^/:]*)","i"),(0,a.a)(s,"UrlUtils",r.a,[])},4139:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(9858);class o{static addOrReplaceParameterValue(e,t,n,a=!1){if(e||(e=""),!t)return e;let i=e;const r=!n,s=i.indexOf("?");if(-1===s)return r?e:i+"?"+t+"="+n;const l=i.substr(s+1),c=o.addOrReplaceParameterValueInQueryParams(l,t,n,a);return i=i.replace(l,c),i}static getParameterValueDecoded(e,t){const n=o.getParameterValue(e,t);return null==n?n:unescape(n)}static getParameterValue(e,t,n=!1){const a=n?i.a.toLower(e):e,o=n?i.a.toLower(t):t;let r=a.indexOf("&"+o+"=");if(-1===r&&(r=a.indexOf("?"+o+"=")),-1===r)return null;const s=r+(t.length+2),l=e.indexOf("&",s);return-1===l?e.substr(s):e.substring(s,l)}static addOrReplaceParameterValueInQueryParams(e,t,n,a=!1){const i=!n;if(!t)return e;let o=e;const r=e.split("&"),s=t+"=",l=a?s.toLowerCase():s;let c=!1;for(let e=0;e<r.length;++e){if(0===(a?r[e].toLowerCase():r[e]).indexOf(l)){o=o.replace(r[e],i?"":s+n),c=!0;break}}return c||i||(e.length>0&&(o+="&"),o+=s+n),o}}(0,a.a)(o,"UrlUtilsStatic",null,[])},3429:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(5149),o=n(8555),r=n(576);class s extends r.a{addReference(){this.load()}reloadReference(){this.load()}load(){i.ULS.sendTraceTag(527837401,206,50,"Attempting to load resource {0}",this.resourceUrl),this._dynamicImport().then((()=>{this.scriptOnLoad(null)})).catch((e=>{i.ULS.sendTraceTag(527839232,206,this.hasFinishedRetries?10:50,"Url failed {0} Finished retrying {1} requestedUrl {2} isOnline {3}",e,this.hasFinishedRetries,this.resourceUrl,window.navigator.onLine),this.scriptOnError((0,o.a)(Sys.UI.DomEvent,e))}))}static create(e,t,n,a=null){return new s(e,t,n,a)}constructor(e,t,n,a=null){super(e,t,null,null,0,null,1,null,null,null,!1,!1,a,!1,!1),this._dynamicImport=n}}(0,a.a)(s,"WebpackScriptResourceWithAction",r.a,[])},7958:function(e,t,n){"use strict";n.d(t,{a:function(){return f}});var a=n(100),i=n(5149),o=n(2409),r=n(9123),s=n(8582),l=n(6094),c=n(4852);class d{constructor(e,t){this.x=e,this.y=t}}(0,a.a)(d,"UnroundedPoint",null,[]);var u=n(9969),p=n(1163),g=n(6362),h=n(9858),m=n(5861),_=n(6776),S=n(2274);class f extends m.a{static isPointInElement(e,t){return f.isPointInBounds(f.getElementBounds(e),t)}static isPointInBounds(e,t){return m.a.isPointInBounds(e,t)}static isBoundsEqual(e,t){return m.a.isBoundsEqual(e,t)}static getBoundingWidth(e){return f.getElementBounds(e).width}static getBoundingTop(e){return f.getElementBounds(e).y}static getBoundingLeft(e){return f.getElementBounds(e).x}static getBoundingBottom(e){const t=f.getElementBounds(e);return t.y+t.height}static getBoundingRight(e){const t=f.getElementBounds(e);return t.x+t.width}static getElementBounds(e){return m.a.getElementBounds(e)}static getElementUnroundedPointWidthAndHeight(e){let t,n;if(e){const a=e.getBoundingClientRect(),i=a.left,o=a.top;return t=a.right-i,n=a.bottom-o,{returnValue:new d(i,o),width:t,height:n}}return t=-1,n=-1,{returnValue:new d(-1,-1),width:t,height:n}}static getElementOffsetWidth(e){if(e){return e.offsetWidth}return 0}static getElementLocation(e){const t=f.getElementBounds(e);return new Sys.UI.Point(t.x,t.y)}static getElementAbsolutePosition(e,t,n){for(t=0,n=0;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:t,top:n}}static getElementAtPoint(e){return document.elementFromPoint(e.x,e.y)}static getOpacity(e){if(e){const t=r.a.getCurrentStyle(e);if(t&&t.opacity)return 100*parseFloat(t.opacity)}return 100}static setOpacity(e,t){e.style.opacity=100===t?"1":(.01*t).toString()}static addWhitespace(e,t,n){const a=t.ownerDocument.createTextNode(e),i=t.firstChild;n||!i?t.appendChild(a):t.insertBefore(a,i)}static dumpHtmlWithoutText(e){let t=e.nodeName;if(3===e.nodeType)t+=" ("+e.nodeValue.length+")";else if(""!==e.className&&(t+="."+e.className),e.childNodes.length>0){t+=" (";for(let n=0;n<e.childNodes.length;n++)t+=f.dumpHtmlWithoutText(e.childNodes[n])+(n===e.childNodes.length-1?")":",")}return t}static getParentWindow(e){return e.parentWindow||e.defaultView}static getWindowLocation(e){return void 0!==e.screenLeft?new Sys.UI.Point(e.screenLeft,e.screenTop):new Sys.UI.Point(e.screen.left,e.screen.top)}static getRelativeLocation(e,t){const n=Sys.UI.DomElement.getLocation(e),a=Sys.UI.DomElement.getLocation(t);let o=0,r=0,s=t;do{if(s=s.parentNode,!l.a.isValidElement(s))return i.ULS.sendTraceTag(24975303,306,10,String.format("Invalid walker element in GetRelativeLocation. Caller may have input a target (id:{0} type:{1} class:{2}) that is not a child of parent (id:{3} type:{4} class:{5}).",t.id,t.nodeType,t.className,e.id,e.nodeType,e.className)),new Sys.UI.Point(0,0);o+=s.scrollTop,r+=s.scrollLeft}while(s!==e);return new Sys.UI.Point(a.x-n.x+r,a.y-n.y+o)}static getRelativePoint(e,t,n){const a=f.getRelativeLocation(e,t);return new Sys.UI.Point(n.x-a.x+t.scrollLeft,n.y-a.y+t.scrollTop)}static getRelativeBounds(e,t,n){const a=new Sys.UI.Point(n.x,n.y),i=f.getRelativePoint(e,t,a);return new Sys.UI.Bounds(i.x,i.y,n.width,n.height)}static isSupportedInputType(e){return"text"===e||"password"===e||"search"===e||"url"===e}static isTextField(e){if(!e||1!==e.nodeType)return!1;const t=f.getInputTypeFromElement(e);return f.isSupportedInputType(t)||5===l.a.getTag(e)||"true"===e.getAttribute("contenteditable")}static selectAllTextInInput(e){if(void 0!==e.select&&null!==e.select)try{e.select()}catch(t){window.setTimeout((()=>{e.select()}),0)}else 0}static clearSelectionInInput(e){if(void 0!==e.setSelectionRange&&null!==e.setSelectionRange){const t=e.value.length;e.setSelectionRange(t,t)}}static selectAllTextInElement(e){try{if(p.a.supportsDomL2Selection){const t=window.self.getSelection();t.removeAllRanges();const n=e.ownerDocument.createRange();n.setStart(e.firstChild,0),n.setEnd(e.firstChild,s.a(e).length),t.addRange(n)}else 0}catch(e){i.ULS.sendTraceTag(38835597,306,10,"Exception caught in SelectAllTextInElement: {0}",e)}}static clearSelectionInElement(e){let t=!1;if(p.a.supportsDomL2Selection)try{return void window.self.getSelection().removeAllRanges()}catch(e){0,t=!0}if(t)try{const t=document.body.createTextRange();return t.moveToElementText(e),t.setEndPoint("EndToStart",t),void t.select()}catch(e){0}else 0}static clearSelectionIfNecessary(){const e=document.activeElement;e&&1===e.nodeType&&(3===l.a.getTag(e)&&"text"===e.getAttribute("type")||5===l.a.getTag(e))&&f.clearSelectionInInput(e)}static isFieldNullOrUndefined(e,t){return void 0===e[t]||null===e[t]}static executeDocumentCommand(e,t,a=!1,i=null){const o=new(n(4454).a);try{return e.execCommand(t,a,i)}finally{o&&o.dispose()}}static getActiveElement(e){let t=null;try{t=e.activeElement}catch(e){}return t}static isActiveElement(e){return!!e&&e===f.getActiveElement(e.ownerDocument)}static getCurrentSelectionRange(e){if(p.a.supportsDomL2Selection){const t=e.getSelection();if(t){if(t.rangeCount)try{return t.getRangeAt(0)}catch(e){return i.ULS.sendTraceTag(36491728,306,15,"Exception when calling getRangeAt."),null}}}return null}static isRangeAnIp(e){const t=e.startContainer,n=e.endContainer,a=e.startOffset,i=e.endOffset;if(t!==n){if(t.parentNode!==n.parentNode)return!1;const e=f.getOffsetInParent(t,a),o=f.getOffsetInParent(n,i);if(-1===e||-1===o)return!0;return e===o}return a===i}static getOffsetInParent(e,t){const n=e.parentNode;if(!n||!n.childNodes)return-1;let a=0;for(let i=0;i<n.childNodes.length;i++){let o=n.childNodes[i];if(o=n.childNodes[i],o===e)return a+t;o.nodeValue&&(a+=o.nodeValue.length)}return-1}static isRangeAtStartOfFrame(e){const t=e.startContainer;if(e.startOffset)return!1;let n=t;for(;n.parentNode&&(!n.tagName||"body"!==n.tagName.toLowerCase());){const e=n.parentNode;if(e.childNodes[0]!==n)return!1;n=e}return!0}static isRangeAtEndOfFrame(e){const t=e.endContainer;if(e.endOffset!==l.a.getElementTextLength(t))return!1;let n=t;for(;n.parentNode&&(!n.tagName||"body"!==n.tagName.toLowerCase());){const e=n.parentNode,t=e.childNodes.length-1;if(e.childNodes[t]!==n)return!1;n=e}return!0}static getCommonDataToPost(e,t=!1){const n=S.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings,a=S.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("IgnoreAccessTokenInPostRequestIsEnabled");t=t&&a;const i={};if(_.AFrameworkApplicationConstants.accessToken&&!t&&(i[_.AFrameworkApplicationConstants.accessTokenParamName]=_.AFrameworkApplicationConstants.accessToken),_.AFrameworkApplicationConstants.accessTokenTtl&&(i[_.AFrameworkApplicationConstants.accessTokenTtlParamName]=_.AFrameworkApplicationConstants.accessTokenServerExpirationTime.toString()),e&&n[f.miniCheckTtlParamName]){Number.parseInvariant(n[f.miniCheckTtlParamName])>(new Date).getTime()&&(i[f.miniCheckDataInfoParamName]=n[f.miniCheckDataInfoParamName],i[f.miniCheckSignatureInfoParamName]=n[f.miniCheckSignatureInfoParamName],i[f.miniCheckTtlParamName]=n[f.miniCheckTtlParamName])}if(_.AFrameworkApplicationConstants.hostCanary&&(i[f.hostCanaryParamname]=_.AFrameworkApplicationConstants.hostCanary),n.SessionStartInfoJson){const e=JSON.parse(n.SessionStartInfoJson).Bootstrapper;if(e){const t=JSON.parse(e);i.jsapibuild=t.JsApiBuild||"",i.owlver=t.OwlVersion||"",i.owlro=t.OwlRollout||""}}n.FeatureStatus&&(i.feature_status=n.FeatureStatus),_.AFrameworkApplicationConstants.isUIEmbedMode&&(i.uiembed="1"),S.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("PassUserIdOwnerIdViaPdcCookieIsEnabled")&&(f.loggableUserIdAppSettingName in n&&(i[f.loggableUserIdViaPdcParamName]=n[f.loggableUserIdAppSettingName]),f.loggableOwnerIdAppSettingName in n&&(i[f.loggableOwnerIdViaPdcParamName]=n[f.loggableOwnerIdAppSettingName]));const o=S.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting(_.AFrameworkApplicationConstants.hostUIControlSettingName);o&&(i.huictrls=o);const r=S.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting("HostInstallAddIns");return r&&(i.host_install_addins=r),_.AFrameworkApplicationConstants.isControllerServicesQueryParamNeeded&&(i[_.AFrameworkApplicationConstants.controllerServicesParamName]="1"),i}static removePostParamsFromUrl(e,t){for(const n in t){const a={key:n,value:t[n]};e=u.a.removeParameter(e,a.key)}return e}static openWindow(e,t,n=!0,a=36e5,r=null,s=!1){const l=f.getCommonDataToPost(n,s);if(!g.a.count(l)){return!!f.safelyOpenWindow(t,f.windowTargetToString(e),void 0,"OpenWindow")}let d=f.removePostParamsFromUrl(t,l);if(1===e){const t="pdc"+c.a.randomBetween(0,32767).toString(16);d=u.a.addOrReplaceParameterValue(d,"pdcn",t),r&&(_.AFrameworkApplicationConstants.dataPlumber.RenavigationReason=r,d=u.a.addOrReplaceParameterValue(d,_.AFrameworkApplicationConstants.sessionOriginParamName,r,!0));const n=new Date;n.setTime(n.getTime()+a);const s=!(S.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("WordDisableCookiesOnAppModeSwitchIsEnabled")&&"AppModeSwitch"===r);return _.AFrameworkApplicationConstants.accessToken&&_.AFrameworkApplicationConstants.accessToken.length||i.ULS.sendTraceTag(591693726,306,10,"Access token is null or empty"),s&&o.a.setDictionaryValueWithDomain(t,l,n,"/",d)?window.location.replace(new URL(d)):(s||i.ULS.sendTraceTag(591685456,306,50,"Navigating without cookies because of config WordDisableCookiesOnAppModeSwitchIsEnabled"),f.postToWindow(f.windowTargetToString(e),d,l)),!0}return f.postToWindow(f.windowTargetToString(e),d,l),!0}static get safelyOpenWindow(){return m.a.safelyOpenWindow}static openWindowWithAttributes(e,t,n,a,i,o=!0){const r=i?f.getCommonDataToPost(o):null;if(!i||!r||!g.a.count(r))return f.safelyOpenWindow(t,f.windowTargetToString(e),a,"OpenWindowWithAttributes");f._accessTokenHash||(f._accessTokenHash=h.a.calcHashCode(_.AFrameworkApplicationConstants.accessToken)),f._openWindowCount++;const s=(n||"wacwindow")+f._accessTokenHash+f._openWindowCount,l=f.removePostParamsFromUrl(t,r);return f.postToWindowWithAttributes(l,s,a,r)}static postToWindowWithAttributes(e,t,n,a){let i=null;return i=f.safelyOpenWindow("",t,n,"PostToWindowWithAttributes"),f.postToWindow(t,e,a),i}static postToWindow(e,t,n=null){n=n||{},f._postWindowForm&&(document.body.removeChild(f._postWindowForm),f._postWindowForm=null),f._postWindowForm=document.createElement("form"),f._postWindowForm.action=t,f._postWindowForm.method="post",f._postWindowForm.target=e;for(const e in n){const t=document.createElement("input");t.type="hidden",t.setAttribute("name",e),t.setAttribute("value",n[e]),f._postWindowForm.appendChild(t)}document.body.appendChild(f._postWindowForm),f._postWindowForm.submit()}static windowTargetToString(e){switch(e){case 1:return"_self";case 2:return"_parent";case 3:return"_top";case 4:return"_blank";default:return""}}static setButtonEnabledState(e,t){null!=e&&e.disabled!==!t&&(e.disabled=!t,t?Sys.UI.DomElement.removeCssClass(e,"DisabledButton"):Sys.UI.DomElement.addCssClass(e,"DisabledButton"))}static getWindowPerformanceTimingObject(){const e=window.self.performance||null;return e&&e.timing||null}static setOuterEdge(e,t,n){n?e.style.right=t+"px":e.style.left=t+"px"}static rtlInvertIfNecessary(e){return _.AFrameworkApplicationConstants.isRtl?-e:e}static followHyperlinkWithNoReferrer(e){if(p.a.supportsNoReferrer()){const t=document.createElement("a");t.target="_blank",t.href=e,t.setAttribute("rel","noreferrer"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}else f.safelyOpenWindow(e,void 0,void 0,"FollowHyperlinkWithNoReferrer")}static leftBoundsOverlapsRightBounds(e,t,n){return f.leftBoundsOverlapsRightBoundsByAmount(e,t,n)>=1}static leftBoundsOverlapsRightBoundsByAmount(e,t,n){const a=n?t:e,i=n?e:t,o=new Sys.UI.Point(i.x,i.y);return a.x+a.width-o.x}static getLinkAroundElement(e){return e&&1===e.nodeType?"A"===e.tagName.toUpperCase()?e:f.getLinkAroundElement(e.parentNode):null}static downloadFile(e){f._downloadFrame||(f._downloadFrame=document.createElement("iframe"),f._downloadFrame.id="DownloadFileFrame",f._downloadFrame.style.cssText="height:0;width:0;display:none",document.body.appendChild(f._downloadFrame)),f._downloadFrame.src=e}static measureTimeToNextFrame(e,t){const n=m.a.getTickCount();window.requestAnimationFrame((a=>{window.setTimeout((()=>{const a=m.a.getTickCount()-n;i.ULS.sendTraceTag(40637981,340,50,"Action: {0}, ControlId: {1}, TimeToFirstFrame: {2}",t,e,a)}),0)}))}static requestIdleCallbackExists(){return m.a.requestIdleCallbackExists()}static cancelIdleCallbackExists(){return!!window.cancelIdleCallback}static isElementTopInViewport(e){const t=l.a.getViewPortHeight(),n=f.getBoundingTop(e);return n>=0&&n<=t}static getTickCount(){return m.a.getTickCount()}static generateOWLUrlParameters(e){if(S.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting(f.isJsApiParamName)&&e.add("jsApi","1"),S.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.SessionStartInfoJson){const t=JSON.parse(S.AFrameworkApplication_AppSettingsManager.appSettingsManager.appSettings.SessionStartInfoJson).Bootstrapper;if(t){const n=JSON.parse(t);e.add("jsapiver",n.JsApiVersion||""),e.add("muv",n.MetaUiHostVersion||"")}}const t=S.AFrameworkApplication_AppSettingsManager.appSettingsManager.getStringAppSetting(_.AFrameworkApplicationConstants.uiHostIntegrationTypeSettingName);t&&e.add("uihit",t);return S.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting(f.uiHostSupportsAuthToken)&&e.add("sat","1"),e}}f.miniCheckDataInfoParamName="mci",f.miniCheckTtlParamName="mcttl",f.miniCheckSignatureInfoParamName="mcsi",f.hostCanaryParamname="cy",f.loggableUserIdViaPdcParamName="loggable_user_id",f.loggableOwnerIdViaPdcParamName="loggable_owner_id",f.loggableUserIdAppSettingName="LoggableUserId",f.loggableOwnerIdAppSettingName="LoggableOwnerId",f.isJsApiParamName="IsJsApi",f.uiHostIntegrationTypeSettingName=_.AFrameworkApplicationConstants.uiHostIntegrationTypeSettingName,f.uiHostSupportsAuthToken="UiHostSupportsAuthToken",f._openWindowCount=0,f._accessTokenHash=0,f._postWindowForm=null,f._downloadFrame=null,f.circularJSONStringify=e=>{const t=new WeakSet;return JSON.stringify(e,((e,n)=>{if("object"==typeof n&&null!==n){if(t.has(n))return"[Circular]";t.add(n)}return n}))},(0,a.a)(f,"WindowUtils",m.a,[])},5861:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(5149),o=n(1163),r=n(9123),s=n(6094),l=n(9858);class c{static getAttributeValue(e,t){return null!=e?e.getAttribute(t):null}static isVisible(e){return 7!==s.a.getTag(e)&&"hidden"!==c.getInputTypeFromElement(e)&&c.styleVisible(r.a.getCurrentStyle(e)||e.style)}static styleVisible(e){return!("none"===l.a.toLower(e.display)||"hidden"===l.a.toLower(e.visibility)||"collapse"===l.a.toLower(e.visibility))}static hasFocusableTabIndex(e,t=!1){const n=c.getAttributeValue(e,"tabIndex");if(null!=n){const e=parseInt(n);return!isNaN(e)&&e>=0}return!!t}static isRadioInputElement(e){return"radio"===c.getInputTypeFromElement(e)}static getInputTypeFromElement(e){if(!e||3!==s.a.getTag(e))return null;const t=e,n=t.type;return null==n?null:l.a.toLower(t.type)}static requestIdleCallbackExists(){return!!window.requestIdleCallback}static getTickCount(){try{if(o.a.supportsPerformanceNow)return window.performance.now()}catch(e){i.ULS.sendTraceTag(50677923,306,15,"Calling Window.Performance.Now() failed with exception: {0}",e.toString())}return(new Date).getTime()}static getElementBounds(e){if(e)try{const t=e.getBoundingClientRect(),n=t.left,a=t.top,i=t.right,o=t.bottom;return new Sys.UI.Bounds(n,a,i-n,o-a)}catch(e){throw i.ULS.sendTraceTag(40138062,306,50,"Failed to get element bounds {0}",e),e}return new Sys.UI.Bounds(0,0,0,0)}static isBoundsEqual(e,t){return e.width===t.width&&e.height===t.height&&e.x===t.x&&e.y===t.y}static isPointInBounds(e,t){return t.x>=e.x&&t.y>=e.y&&t.x<e.x+e.width&&t.y<e.y+e.height}static safelyOpenWindow(e,t=null,n="",a=""){let o=null;try{o=window.open(e,t,n),o||i.ULS.sendTraceTag(506819924,306,50,"New window instance is null for window: {0}",a)}catch(e){i.ULS.sendTraceTag(590881243,306,15,"Window.Open failed with error: {0}, while trying to open: {1}",e,a)}return o}}(0,a.a)(c,"WindowUtilsConstants",null,[])},8444:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(3299),o=n(7146),r=n(3798),s=n(5557),l=n(5832),c=n(3245);class d{getVersionedResourceUrl(e,t,n){const a=l.a.overrideStaticContentScriptNameBase(c.AFrameworkApplication.staticContentScriptNameBase,n);if(a.includes("wd1js"))return l.a.addCompressionDictionaryTransportQueryParameter(a+n);const i=t?e+"/"+t:e,d=o.a.instance.resourceShippingFrom1JSVersionedMap[i.toLowerCase()];if(d||s.b(507609821,200,10,"getHashShippingFrom1JS failed to find versioned resouce for {0}",i),d&&o.a.instance.versionedResourceDomainShippingFrom1JS){const e=o.a.instance.versionedResourceDomainShippingFrom1JS+d;return l.a.addCompressionDictionaryTransportQueryParameter(r.a.getBrotliResourceUrl(n?e+"/"+n:e).toLowerCase())}}static getLazySingletonInstance(){return new i.a((()=>new d))}static get instance(){return d._singletonInstance.value}}d._singletonInstance=d.getLazySingletonInstance(),(0,a.a)(d,"VersionedResourcePathManager",null,[])},9588:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Common.App.VisibilityManagement.IVisibilityManager")},3660:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(5018);class o{add_onWacAadTokenRefreshed(e){this._eventSource.addHandler(this.wacAadTokenRefreshedEventKey,e)}remove_onWacAadTokenRefreshed(e){this._eventSource.removeHandler(this.wacAadTokenRefreshedEventKey,e)}raiseWacAadTokenRefreshed(){this._eventSource.raiseEvent(this.wacAadTokenRefreshedEventKey)}dispose(){this._eventSource.dispose()}static get instance(){return o._singletonInstance||(o._singletonInstance=new o)}constructor(){this.wacAadTokenRefreshedEventKey="WacAadTokenRefreshed",this._eventSource=new i.a}}o._singletonInstance=null,(0,a.a)(o,"WacAadAuthTokenEventSource",null,[11])},1196:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5018);const o="Resize";class r{add_onResize(e){this._eventSource.addHandler(o,e)}remove_onResize(e){this._eventSource.removeHandler(o,e)}notifyResize(){this._eventSource.raiseEvent(o)}dispose(){$removeHandler(window,"resize",this.resizeHandler),this._eventSource.dispose(),this._eventSource=null}constructor(){this.resizeHandler=e=>{this._eventSource.raiseEvent(o)},this._eventSource=new i.a,$addHandler(window,"resize",this.resizeHandler)}}(0,a.a)(r,"WindowResizeEventSource",null,[53,11])},1634:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100);class i{get statusText(){return""}setRequestCompleted(e){this._requestCompletedCallback=e}onRequestCompleted(){this._requestCompletedCallback&&this._requestCompletedCallback()}constructor(){this._requestCompletedCallback=null}}(0,a.a)(i,"CrossDomainRequestBase",null,[]);class o extends i{get contentType(){return this._request.getResponseHeader("Content-Type")}get responseText(){return this._request.responseText}get statusCode(){return this._request.status}get statusText(){return this._request.statusText}abort(){this._request.abort()}getResponseHeader(e){return this._request.getResponseHeader(e)}send(e){this._request.send(e)}open(e,t){this._request.open(e,t,!0)}constructor(){super(),this.onReadyStateChange=()=>{4===this._request.readyState&&this.onRequestCompleted()},this._request=new XMLHttpRequest,this._request.onreadystatechange=this.onReadyStateChange}}(0,a.a)(o,"XMLHttpCrossDomainRequest",i,[]);class r extends i{get contentType(){return this._request.contentType}get responseText(){return this._request.responseText}get statusCode(){return this._statusCode}abort(){this._statusCode=-1,this._request.abort()}send(e){this._request.send(e)}open(e,t){this._request.open(e,t)}getResponseHeader(e){return"Content-Type"===e?this._request.contentType:null}safeSetStatusCode(e){this._statusCode||(this._statusCode=e)}constructor(){super(),this._statusCode=0,this.onLoad=()=>{this.safeSetStatusCode(200),this.onRequestCompleted()},this.onError=()=>{this.safeSetStatusCode(400),this.onRequestCompleted()},this.onTimeout=()=>{this.safeSetStatusCode(408),this.onRequestCompleted()},this._request=new XDomainRequest,this._request.onload=this.onLoad,this._request.onerror=this.onError,this._request.ontimeout=this.onTimeout}}(0,a.a)(r,"XDomainCrossDomainRequest",i,[]);class s{static get browserSupportsCrossDomainRequests(){return!!s.requestGenerator}static get requestGenerator(){if(!s._requestGenerator){let e=null;void 0!==(new XMLHttpRequest).withCredentials?e=()=>new o:"undefined"!=typeof XDomainRequest&&(e=()=>new r),s._requestGenerator=e}return s._requestGenerator}static create(){return s.browserSupportsCrossDomainRequests?s.requestGenerator():null}}s._requestGenerator=null,(0,a.a)(s,"CrossDomainRequestBaseStatic",null,[])},3311:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(1634),o=n(3245);class r extends Sys.Net.WebRequestExecutor{get_started(){return this._state>0}get_aborted(){return 2===this._state}get_responseAvailable(){return 5===this._state}get_timedOut(){return 3===this._state}get_statusCode(){return this._request.statusCode}get_statusText(){return this._request.statusText}get_responseData(){return this._request.responseText}get_xml(){return this._parsedXml||(this._parsedXml=this.parseXmlResponse()),this._parsedXml}abort(){this.finishWebRequest(2,!0)}getAllResponseHeaders(){const e=this._request.contentType;return e&&e.length>0?String.format("Content-Type:{0}",e):""}getResponseHeader(e){return r.corsSimpleResponseHeadersOnlyIsEnabled&&!r.isSimpleHeader(e)?null:this._request.getResponseHeader(e)}executeRequest(){this._state=1;const e=this.get_webRequest(),t=e.get_httpVerb();if(this._request=i.a.create(),!this._request)return void this.finishWebRequest(4,!1);this._request.setRequestCompleted(this.onRequestCompleted),this._request.open(t,e.getResolvedUrl());const n=e.get_timeout();n>0&&window.setTimeout(this.onTimeout,n),this._request.send("POST"===t.toUpperCase()?e.get_body():"")}finishWebRequest(e,t){1===this._state&&(this._state=e,t&&this._request.abort(),this.get_webRequest().completed(Sys.EventArgs.Empty))}parseXmlResponse(){const e=Sys.Net.XMLDOM(this.get_responseData());if(!e||!e.documentElement)return null;const t=e.documentElement;return"http://www.mozilla.org/newlayout/xml/parsererror.xml"===t.namespaceUri&&"parsererror"===t.tagName||t.firstChild&&"parsererror"===t.firstChild.tagName?null:e}static isSimpleHeader(e){return e.toLowerCase()in r.simpleResponseHeaders||o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CorsLogResponseHeadersIsEnabled")&&Array.contains(o.AFrameworkApplication.appSettingsManager.getStringAppSetting("CorsGeneralResponseHeaders").split(","),e)}constructor(){super(),this._request=null,this._state=0,this._parsedXml=null,this.onRequestCompleted=()=>{this.finishWebRequest(5,!1)},this.onTimeout=()=>{this.finishWebRequest(3,!0)}}}r.simpleResponseHeaders={"cache-control":1,"content-language":1,"content-type":1,expires:1,"last-modified":1,pragma:1},r.corsSimpleResponseHeadersOnlyIsEnabled=!1,(0,a.a)(r,"Common.CrossDomainRequestExecutor",Sys.Net.WebRequestExecutor,[])},4176:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static isClientError(e){return e>=400&&e<=499}static isServerError(e){return e>=500&&e<=599}static isSuccess(e,t){return t?e>=200&&e<=299:e===i.OK_200}}i.accepted_202=202,i.ambiguous_300=300,i.badGateway_502=502,i.badRequest_400=400,i.conflict_409=409,i.continue_100=100,i.created_201=201,i.expectationFailed_417=417,i.forbidden_403=403,i.found_302=302,i.gatewayTimeout_504=504,i.gone_410=410,i.httpVersionNotSupported_505=505,i.internalServerError_500=500,i.lengthRequired_411=411,i.methodNotAllowed_405=405,i.moved_301=301,i.movedPermanently_301=301,i.multipleChoices_300=300,i.noContent_204=204,i.nonAuthoritativeInformation_203=203,i.notAcceptable_406=406,i.notFound_404=404,i.notImplemented_501=501,i.notModified_304=304,i.OK_200=200,i.partialContent_206=206,i.paymentRequired_402=402,i.preconditionFailed_412=412,i.proxyAuthenticationRequired_407=407,i.redirect_302=302,i.redirectKeepVerb_307=307,i.redirectMethod_303=303,i.requestedRangeNotSatisfiable_416=416,i.requestEntityTooLarge_413=413,i.requestTimeout_408=408,i.requestUriTooLong_414=414,i.resetContent_205=205,i.seeOther_303=303,i.serviceUnavailable_503=503,i.switchingProtocols_101=101,i.temporaryRedirect_307=307,i.tooManyRequest_429=429,i.unauthorized_401=401,i.unsupportedMediaType_415=415,i.unused_306=306,i.upgradeRequired_426=426,i.useProxy_305=305,i.insufficientStorage_507=507,(0,a.a)(i,"HttpStatusCode",null,[])},2609:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get shouldMarkOnTimeline(){return!!this.extraInfo&&this.extraInfo[i.keyOfFoundGetPutChanges]}constructor(e,t,n,a,i,o=null,r=null,s=null,l=!1,c=null,d=null,u=!1,p=null,g=null,h=null,m=!1){this.status=0,this.httpStatus=0,this.responseData=null,this.responseXml=null,this.responseObject=null,this.responseHeaders=null,this.enqueueTime=null,this.invokedTime=null,this.invokedTimeTicks=0,this.completedTime=null,this.completedTimeTicks=0,this.requestQueuedTimeoutTask=null,this.useFetch=!1,this.id=e,this.priority=t,this.request=n,this.responseHeadersToSet=a,this.shouldSetResponseXml=i,this.successCallback=o,this.failureCallback=r,this.invokedCallback=g,this.state=s,this.isSynchronous=l,this.requestorId=c||"",this.completionCallbackTask=null,this.name=d,this.forceSynchronousNotify=u,this.extraInfo=p,this.fetchRequestArgs=h,this.useFetch=m}}i.keyOfFoundGetPutChanges="FoundGetPutChanges",i.keyOfGetChanges="GetChanges",i.keyOfPutChanges="PutChanges",(0,a.a)(i,"RequestItem",null,[])},9084:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var a,i=n(100);!function(e){e[e.waiting=0]="waiting",e[e.executing=1]="executing",e[e.succeeded=2]="succeeded",e[e.failed=3]="failed",e[e.notFound=4]="notFound",e[e.preConditionFailed=5]="preConditionFailed",e[e.socketConnectionError=6]="socketConnectionError",e[e.timeOut=7]="timeOut",e[e.offlineMode=8]="offlineMode",e[e.serverError=9]="serverError",e[e.cancelled=10]="cancelled",e[e.clientError=11]="clientError",e[e.serverAuthenticationError=12]="serverAuthenticationError",e[e.expiredWithoutSending=13]="expiredWithoutSending",e[e.accessTokenExpired=14]="accessTokenExpired"}(a||(a={})),(0,i.b)("RequestStatus",a)},7689:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static get(e,t){return e[t]}static join(e,t){return e.join(t)}static joinList(e,t){return e.join(t)}static forEach(e,t){Array.forEach(e,t)}static clone(e){return Array.clone(e)}static contains(e,t){return Array.contains(e,t)}static isNullOrEmpty(e){return!e||!e.length}static isNullOrEmptyList(e){return!e||!e.length}static all(e,t){for(const n of e)if(!t(n))return!1;return!0}static any(e,t){for(const n of e)if(t(n))return!0;return!1}static mergeWithOptionalArray(e,t){if(null==t)return[e];const n=1+t.length,a=new Array(n);a[0]=e;for(let e=1;e<n;e++)a[e]=t[e-1];return a}static isArray(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}static toTypedArray(e){return e}static dump(e,t=!1,n=null){if(!t)return"";let a="";for(let t=0;t<e.length;t++){const i=e[t],o=n?n(i):i.toString();a+=String.format("[{0}] => {1}\n",t,o)}return a}static reduce(e,t,n){let a=n;for(let n=0;n<e.length;n++)a=t(a,e[n]);return a}static map(e,t){const n=new Array(e.length);for(let a=0;a<e.length;a++)n[a]=t(e[a]);return n}static take(e,t){const n=new Array(Math.min(t,e.length));for(let t=0;t<n.length;t++)n[t]=e[t];return n}static where(e,t){const n=[];for(const a of e)t(a)&&Array.add(n,a);return n}}(0,a.a)(i,"ArrayUtils",null,[])},1163:function(e,t,n){"use strict";n.d(t,{a:function(){return h}});var a=n(100),i=n(5149),o=n(8555);class r{get majorVersion(){return this._majorVersion}set majorVersion(e){this._majorVersion=e}get minorVersion(){return this._minorVersion}set minorVersion(e){this._minorVersion=e}constructor(){this._majorVersion=-1,this._minorVersion=-1}}(0,a.a)(r,"AndroidVersion",null,[]);class s{constructor(e,t){this.original=e,this.wrapped=t}}(0,a.a)(s,"TimerFunctionData",null,[]);var l=n(6949),c=n(2274),d=n(7220),u=n(7826),p=n(956);class g{isPasteSupportedNativelyOnTheBrowser(){return this.isPasteQuerySuccessful}static getInstance(){return null===this.instance&&(this.instance=new g),this.instance}constructor(){"true"===p.a.instance.getItem("isPasteNativelySupported")?this.isPasteQuerySuccessful=!0:(this.isPasteQuerySuccessful=document.queryCommandSupported("paste"),p.a.instance.setItem("isPasteNativelySupported",this.isPasteQuerySuccessful.toString()))}}g.instance=null,(0,a.a)(g,"PasteQuery",null,[]);class h{static $$cctor(){window.self;h._setTimeoutData=h.wrapTimerFunctionWithExceptionHandling("setTimeout"),h._setIntervalData=h.wrapTimerFunctionWithExceptionHandling("setInterval"),h._setImmediateData=h.wrapTimerFunctionWithExceptionHandling("setImmediate")}static get isUnsupportedBrowserVersion(){if(h.isChrome){const e=c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getDoubleAppSetting("MinimumSupportedVersionChromium",80);return!h.isChromeAtLeastWithMinor(e)}if(h.isChromiumEdge){const e=c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getDoubleAppSetting("MinimumSupportedVersionChromium",80);return!h.isEdgeAtLeastWithMinor(e)}if(h.isSafari){const e=c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getDoubleAppSetting("MinimumSupportedVersionSafari",13.1);return!h.isSafariAtLeastWithMinor(e)}if(h.isFirefox){const e=c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getDoubleAppSetting("MinimumSupportedVersionFirefox",78);return!h.isFirefoxAtLeastWithMinor(e)}return!1}static get supportsSynchronousXhrDuringNavigate(){return!h.isChrome}static isPasteSupportedNatively(){return g.getInstance().isPasteSupportedNativelyOnTheBrowser()}static get is64bitBrowser(){return this.userAgent.indexOf("Win64; x64;")>=0}static get isIEOnWindows64(){return!1}static get isFirefox(){return Sys.Browser.agent===Sys.Browser.Firefox}static get isFirefox3Up(){return h.firefoxVersion>=3}static get isFirefox4Up(){return h.firefoxVersion>=4}static get firefoxVersion(){if(h.isFirefox){const e=this.userAgent.toLowerCase(),t=e.indexOf("firefox/");if(t>=0){const n=t+8,a=e.length;return parseInt(e.substring(n,a))}}return 0}static get firefoxVersionMajorMinor(){if(h.isFirefox){const e=this.userAgent.toLowerCase(),t=e.indexOf("firefox/");if(t>=0){const n=t+8,a=e.length;return parseFloat(e.substring(n,a))}}return 0}static get isBingPreview(){return this.userAgent.toLowerCase().indexOf("bingpreview/")>=0}static isChromeAtLeast(e){if(h.isWebKit){const t=this.userAgent.toLowerCase(),n=t.indexOf("chrome/");if(n>=0){const a=n+7,i=t.indexOf(".",a);if(i>0)return parseInt(t.substring(a,i))>=e}}return!1}static isChromeAtLeastWithMinor(e){if(h.isWebKit){const t=this.userAgent.toLowerCase(),n=t.indexOf("chrome/");if(n>=0){const a=n+7,i=t.length;return parseFloat(t.substring(a,i))>=e}}return!1}static isEdgeAtLeastWithMinor(e){if(h.isChromiumEdge){const t=this.userAgent.toLowerCase(),n=t.indexOf("Edg/");if(n>=0){const a=n+7,i=t.length;return parseFloat(t.substring(a,i))>=e}}return!1}static isFirefoxAtLeastWithMinor(e){return!!h.isFirefox&&h.firefoxVersionMajorMinor>=e}static get isChrome76Up(){return h.isChromeAtLeast(76)}static get isChrome(){return this.userAgent.toLowerCase().indexOf("chrome/")>=0}static get isChromeiOS(){return this.userAgent.toLowerCase().indexOf("crios/")>=0}static get isFirefoxiOS(){return this.userAgent.toLowerCase().indexOf("fxios/")>=0}static get isSamsungInternet(){return this.userAgent.toLowerCase().indexOf("samsungbrowser/")>=0}static get isElectron(){return this.userAgent.toLowerCase().indexOf("electron/")>=0&&h.isChrome}static get electronVersion(){if(h.isElectron){const e=h._electronVersionRegularExpression.exec(window.navigator.appVersion);if(e&&2===e.length)return e[1]}return""}static get isTeamsElectron(){const e=this.userAgent.toLowerCase();return h.isElectron&&e.indexOf("teams/")>=0}static get isTeamsMobileiOS(){return this.userAgent.toLowerCase().indexOf("teamsmobile-ios")>=0}static get isTeamsAny(){return this.userAgent.toLowerCase().includes("teams")}static get isTeamsDesktop(){return this.userAgent.toLowerCase().indexOf("teams/")>=0}static get isChromeOrIEEdge(){return this.userAgent.toLowerCase().indexOf("chrome/")>=0}static get isWcosEdge(){if(null==h._isWcosEdge)try{h._isWcosEdge=null!=window.external&&null!=window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'==window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}return h._isWcosEdge}static get isOculusBrowser(){return!(!c.AFrameworkApplication_AppSettingsManager.appSettingsManager||!c.AFrameworkApplication_AppSettingsManager.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.OculusBrowserDetectionEnabled"))&&(void 0===h._isOculusBrowser&&(h._isOculusBrowser=h.includesUserAgentDataBrand("Oculus Browser")),h._isOculusBrowser)}static get isOculusPwa(){return void 0===h._isOculusPwa&&(h._isOculusPwa=h.isOculusBrowser&&window.matchMedia("(display-mode:standalone)").matches),h._isOculusPwa}static get supportsDomL2Selection(){return!0}static browserSupportsSetActive(e){return!!e&&!!e.setActive}static get supportsCompositionEvents(){return h.isSafari4Up||h.isChromeOrIEEdge||h.isIPhone||h.isIPad}static get supportsTextInputEvent(){return h.isSafari4Up||h.isChrome}static get supportsInputEvent(){return h.isSafari4Up||h.isChrome||h.isFirefox}static get supportsOpenInClientNpapiPlugin(){return h.isFirefox3Up}static get supportsOpenInClientForAllApps(){return(!h.isAndroid||!!c.AFrameworkApplication_AppSettingsManager.appSettingsManager&&c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OICForAndroidIsEnabled"))&&(!h.isWcosEdge||!!c.AFrameworkApplication_AppSettingsManager.appSettingsManager&&c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("OICForWCOSIsEnabled"))&&!h.isOculusBrowser}static get supportsPerformanceNow(){return!0}static get browserSupportsServiceWorker(){return!0}static browserSupportsSendBeacon(){return!0}static get alwaysInImeMode(){return h.isAndroid}static get supportsTextRange(){return!!window.self.document.body.createTextRange}static get supportsWordBreakingRange(){if(null!=h._supportsExpandOnRangeObjects)return h._supportsExpandOnRangeObjects;if(!h.supportsTextRange)return!1;const e=window.self.document.createRange();return h._supportsExpandOnRangeObjects=!!e.expand,h._supportsExpandOnRangeObjects}static get supportsPlacingIpInEmptySpan(){return!(h.isWebKit||c.AFrameworkApplication_AppSettingsManager.appSettingsManager&&c.AFrameworkApplication_AppSettingsManager.appSettingsManager.getBooleanAppSetting("EmptyLineFormattingFixForFirefoxIsEnabled")&&h.isFirefox)}static get isWebKit(){return Sys.Browser.agent===Sys.Browser.Safari}static get isWebKitOrIEEdge(){return Sys.Browser.agent===Sys.Browser.Safari}static isSafariAtLeast(e){if(h.isWebKit){const t=this.userAgent.toLowerCase(),n=t.indexOf("version/");if(n>=0){const a=n+8,i=t.length;return parseInt(t.substring(a,i))>=e}}return!1}static isSafariAtLeastWithMinor(e){if(h.isWebKit){const t=this.userAgent.toLowerCase(),n=t.indexOf("version/");if(n>=0){const a=n+8,i=t.length;return parseFloat(t.substring(a,i))>=e}}return!1}static get isSafari(){return h.isSafariAtLeast(1)}static get isSafari3Up(){return h.isSafariAtLeast(3)}static get isSafari4Up(){return h.isSafariAtLeast(4)}static get isSafari5Up(){return h.isSafariAtLeast(5)}static get isSafari9Up(){return h.isSafariAtLeast(9)}static get isSafari12Up(){return h.isSafariAtLeast(12)}static get isOpera12Older(){return Sys.Browser.agent===Sys.Browser.Opera}static get isOpera15Up(){return this.userAgent.indexOf("OPR")>=0}static get isOpera(){return h.isOpera12Older||h.isOpera15Up}static get networkInformation(){return h._networkInfo||(h._networkInfo=window.navigator.connection||{}),h._networkInfo}static get isWindows(){return this.userAgent.indexOf("Windows")>=0}static checkWindowsNTVersion(){if(h._ntVersionChecked)return;const e=new RegExp("Windows NT\\s+(\\d+(\\.\\d*)?)").exec(this.userAgent);h._ntVersionChecked=!0,h._ntVersion=-1,null!=e&&e.length>=2&&(h._ntVersion=parseFloat(e[1]),isNaN(h._ntVersion)&&(h._ntVersion=-1))}static get isWindowsVistaUp(){return h.checkWindowsNTVersion(),h._ntVersion>=6}static get isWindows8Up(){return h.checkWindowsNTVersion(),h._ntVersion>=6.2}static get isMac(){return l.a.isMac}static get isPpcMac(){return this.userAgent.indexOf("PPC Mac")>=0}static get isLinux(){return this.userAgent.indexOf("Linux")>=0}static get isIPad(){return null===h._isIPad&&(h._isIPad=this.userAgent.indexOf("iPad")>=0||h.isMac&&h.supportsTouch&&!h.isIPhone),h._isIPad}static get iPadOsVersion(){if(h.isIPad){const e=this.userAgent,t=e.indexOf(" CPU OS ");if(t>=0){const n=t+8,a=e.length,i=parseInt(e.substring(n,a));if(i!==Number.NaN)return i}}return 0}static get iPhoneOsMajorVersion(){if(h.isIPhone){const e=this.userAgent,t=e.indexOf("OS ");if(t>=0){const n=t+3,a=e.indexOf("_",n);if(a>0){const t=parseInt(e.substring(n,a));if(t!==Number.NaN)return t;i.ULS.sendTraceTag(589410829,306,10,"IPhone OS version NAN: {0}",e)}}}return 0}static get isIPhone(){return this.userAgent.indexOf("iPhone")>=0}static get isWindowsPhone(){return this.userAgent.indexOf("Windows Phone")>=0}static get isAndroid(){return this.userAgent.indexOf("Android")>=0}static get androidVersion(){const e=new r;if(!h.isAndroid)return e;let t="";try{t=this.userAgent.toUpperCase();const n=t.indexOf(h._androidVersionPrefix),a=t.substr(n+h._androidVersionPrefix.length+1).indexOf(h._androidVersionSuffix),i=t.substr(n+h._androidVersionPrefix.length+1,a).split(h._androidVersionSeparator);e.majorVersion=parseInt(i[0].trim(),10),e.minorVersion=1===i.length?0:parseInt(i[1].trim(),10)}catch(e){i.ULS.sendTraceTag(595079326,306,10,"UserAgent Parse Failure: {0}",t)}return e}static get isLocaleChina(){return"ZH-CN"===window.navigator.language.toUpperCase()}static get isChromeOS(){return this.userAgent.indexOf("CrOS ")>=0}static get chromeRevision(){if(h.isChrome){const e=this.userAgent.toLowerCase(),t=e.indexOf("chrome/");if(t>=0){const n=t+7,a=e.indexOf(".",n),i=e.substring(n,a);return parseInt(i)}}return 0}static get isMobile(){return h.isIPad||h.isAndroid}static get maxTouchPoints(){const e=window.navigator.maxTouchPoints;return null!=e?e:0}static get supportsTouch(){return h.isAndroid||h.maxTouchPoints>0}static get supportsMouse(){return!h.isIPad}static get selectionShowsThroughOpaqueContent(){return h.isMobile}static get isSupportedMacBrowser(){return h.isMac&&(h.isFirefox3Up||h.isSafari3Up)}static get supportsInlineSVG(){return h.supportsSVG&&(!h.isFirefox||h.isFirefox4Up)}static get supportsVML(){return!1}static get supportsSVG(){return!0}static get isMobileBrowser(){return this.userAgent.indexOf("Mobile")>=0}static get isChromiumEdge(){return null==this._isChromiumEdge&&(this._isChromiumEdge=this.userAgent.indexOf("Edg/")>=0||h.includesUserAgentDataBrand("Microsoft Edge")),this._isChromiumEdge}static get isWebview2(){return h.includesUserAgentDataBrand("Microsoft Edge WebView2")}static includesUserAgentDataBrand(e){return window.navigator.userAgentData?.brands.some((t=>t.brand===e))??!1}static setOpacity(e,t){e.style.opacity=t.toString()}static supportsNoReferrer(){return h.isWebKitOrIEEdge||h.isFirefox}static get setTimeoutData(){return h._setTimeoutData}static get setIntervalData(){return h._setIntervalData}static get setImmediateData(){return h._setImmediateData}static wrapTimerFunctionWithExceptionHandling(e){const t=window.self,n=(0,o.a)(Function,t[e]);return new s(n,((e,t)=>Sys.Application.get_isDisposing()?(i.ULS.sendTraceTag(595179603,210,50,"Unloading. Not queuing method [{0}] stack [{1}]",e,d.a.generateCallstack()),0):n(e,t)))}static executeCodeInTryCatchWithExceptionLogging(e){try{e()}catch(e){throw(0,u.a)(e),e}}static get supportsDocumentImplementationCreateHtmlDocument(){return!0}static get supportsFullscreen(){return!!(document.webkitRequestFullscreen||document.msRequestFullscreen||document.mozRequestFullScreen||document.requestFullscreen)}static isWebSocketSupported(){return"undefined"!=typeof WebSocket}static get supportsWindowAtob(){return!0}static get supportsMicrophoneAccessInIframe(){return h.isFirefox||h.isChrome}static get supports32BitsZIndex(){return null==h._supports32BitsZIndex&&(h._supports32BitsZIndex=h.isSafari4Up||h.isChrome||h.isFirefox),h._supports32BitsZIndex}static get browserNameForlogging(){return h._browserNameForLogging||(h.isTeamsElectron?h._browserNameForLogging="TeamsElectron":h.isElectron?h._browserNameForLogging="Electron":h.isChromiumEdge?h._browserNameForLogging="ChromiumEdge":h.isChrome&&window.chrome?h._browserNameForLogging="Chrome":h.isFirefox?h._browserNameForLogging="Firefox":h.isSafari3Up?h._browserNameForLogging="Safari3Up":h._browserNameForLogging="UnsupportedBrowser"),h._browserNameForLogging}static get browserCodeForLogging(){return h.isTeamsElectron?h._browserCodeForLogging=9:h.isElectron?h._browserCodeForLogging=7:h.isChromiumEdge?h._browserCodeForLogging=8:h.isChrome&&window.chrome?h._browserCodeForLogging=0:h.isFirefox?h._browserCodeForLogging=2:h.isSafari3Up?h._browserCodeForLogging=4:h._browserCodeForLogging=5,h._browserCodeForLogging}static get browserIdentifierForLogging(){return h.browserCodePrefix+h.browserCodeForLogging}static isSupportedPlugin(e){const t=window.navigator.plugins;if(!t||!t.length)return!1;for(let n=0;n<t.length;n++){if(t[n].name.toLowerCase().indexOf(e.toLowerCase())>=0)return!0}return!1}static get hasPdfReader(){return h.firefoxVersion>=18||h.isSupportedPlugin("Chrome PDF Viewer")||h.isSupportedPlugin("Microsoft Edge PDF Viewer")||h.isSupportedPlugin("WebKit built-in PDF")}static get cacheUserAgentIsEnabled(){return void 0!==this._cacheUserAgentIsEnabled||(this._cacheUserAgentIsEnabled=c.AFrameworkApplication_AppSettingsManager.appSettingsManager?.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.CacheUserAgentIsEnabled")),this._cacheUserAgentIsEnabled}static get userAgent(){return!1===this.cacheUserAgentIsEnabled?window.navigator.userAgent:(null!==this._userAgent||(this._userAgent=window.navigator.userAgent),this._userAgent)}}h._supports32BitsZIndex=null,h._supportsExpandOnRangeObjects=null,h._isWcosEdge=null,h._ntVersionChecked=!1,h._ntVersion=-1,h._browserNameForLogging=null,h._browserCodeForLogging=6,h._isChromiumEdge=null,h._cacheUserAgentIsEnabled=void 0,h._userAgent=null,h._isOculusBrowser=void 0,h._isOculusPwa=void 0,h.browserCodePrefix="BCX",h._androidVersionPrefix="ANDROID",h._androidVersionSeparator=".",h._androidVersionSuffix=";",h._electronVersionRegularExpression=new RegExp("Electron/(\\d+\\.\\d+\\.\\d+)"),h._networkInfo=null,h._isIPad=null,h._setTimeoutData=null,h._setIntervalData=null,h._setImmediateData=null,(0,a.a)(h,"BrowserUtils",null,[]),h.$$cctor()},6949:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static get isMac(){return window.navigator.userAgent.indexOf("Macintosh")>=0}static browserSupportsCustomEvent(){try{let e=!1;return e="CustomEvent"in window&&"function"==typeof window.CustomEvent,e}catch(e){return!1}}}(0,a.a)(i,"BrowserUtilsConstants",null,[])},499:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(5149);class o{static generateStack(e=0,t=10){const n=Error.stackTraceLimit;let a="";try{Error.stackTraceLimit=1+e+t,a=(new Error).stack||""}finally{Error.stackTraceLimit=n}for(let t=-1;""!==a&&t<e;t++)a=a.slice(a.indexOf("\n")+1);return a}static logStack(e,t,n,a=0,r=10){const s=o.generateStack(a,r);i.ULS.sendTraceTag(507277386,t,n,`${e}: ${s}`)}}(0,a.a)(o,"CallStackUtil",null,[])},5301:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(3299);class o{get LCID(){return this._lcid}get languageId(){return 1023&this._lcid}get languageName(){return o.get_languageIdMapping().value[this.languageId.toString()]?o.get_languageIdMapping().value[this.languageId.toString()].toString():this.displayName}get name(){return this._name}get formattingName(){return o.get_languageIdMapping().value[this.LCID.toString()]?o.get_languageIdMapping().value[this.LCID.toString()].toString():this.displayName}get displayName(){return this._displayName||(this._displayName=o.get_l_LanguageNames()[this._lcid]),this._displayName}get isNeutralCulture(){return this._neutral}static get_languageIdMapping(){return o._languageIdMapping||(o._languageIdMapping=new i.a((()=>({1281:"qps-ploc",1534:"qps-ploca",2559:"qps-plocm",20490:"es-PR",8251:"sms-FI",17418:"es-SV",17417:"en-MY",8218:"bs-Cyrl-BA",8204:"fr-RE",8202:"es-VE",8201:"en-JM",8200:"el-GR",8193:"ar-OM",6154:"es-PA",7227:"sma-SE",19466:"es-NI",16394:"es-BO",16393:"en-IN",16385:"ar-QA",7194:"sr-Cyrl-BA",7180:"fr-WINDIES",7178:"es-DO",7177:"en-ZA",7169:"ar-TN",12289:"ar-LB",6203:"sma-NO",15372:"fr-HT",15370:"es-PY",15369:"en-HK",15361:"ar-BH",6170:"sr-Latn-BA",6156:"fr-MC",18442:"es-HN",6153:"en-IE",6145:"ar-MA",4155:"smj-NO",11274:"es-AR",5179:"smj-SE",14348:"fr-MA",14346:"es-UY",14345:"en-ID",14337:"ar-AE",5146:"bs-Latn-BA",5132:"fr-LU",5130:"es-CR",5129:"en-NZ",5127:"de-LI",5124:"zh-MO",5121:"ar-DZ",31770:"sr",31748:"zh-HanT",22538:"es-419",10266:"sr-Cyrl-RS",10252:"fr-SN",10250:"es-PE",10249:"en-BZ",13324:"fr-ML",13322:"es-CL",13321:"en-PH",10241:"ar-SY",13313:"ar-KW",4122:"hr-BA",4108:"fr-CH",4106:"es-GT",4105:"en-CA",4103:"de-LU",4100:"zh-SG",3179:"quz-PE",4097:"ar-LY",1085:"yi-Hebr",1144:"ii-CN",2163:"ti-ET",21514:"es-US",2145:"ne-IN",3131:"se-FI",2143:"tzm-Latn-DZ",12314:"sr-Cyrl-ME",1070:"hsb-DE",1130:"yo-NG",12300:"fr-CI",1091:"uz-Latn-UZ",12298:"es-EC",12297:"en-ZW",2055:"de-CH",2052:"zh-CN",2115:"uz-Cyrl-UZ",9242:"sr-Latn-RS",3098:"sr-Cyrl-CS",2107:"se-SE",9228:"fr-CD",3084:"fr-CA",9226:"es-CO",3082:"es-ES",3081:"en-AU",2094:"dsb-DE",3079:"de-AT",2092:"az-Cyrl-AZ",1064:"tg-Cyrl-TJ",3076:"zh-HK",2155:"quz-EC",3073:"ar-EG",3072:"[Custom Culture]",1153:"mi-NZ",1119:"tzm-Arab-MA",1086:"ms-MY",2144:"ks-Deva",2077:"sv-FI",1053:"sv-SE",2141:"iu-Latn-CA",2074:"sr-Latn-CS",2073:"ru-MO",2072:"ro-MO",2137:"sd-Arab-PK",2070:"pt-PT",2068:"nn-NO",2067:"nl-BE",1073:"ts-ZA",2064:"it-CH",2129:"bo-BT",2128:"mn-Mong-CN",2060:"fr-BE",1132:"nso-ZA",1097:"ta-IN",2057:"en-GB",1164:"prs-AF",106:"yo",2118:"pa-Arab-PK",2117:"bn-BD",2049:"ar-IQ",2048:"[Language Not Specified]",1156:"gsw-FR",2110:"ms-BN",1054:"th-TH",2108:"ga-IE",1083:"se-NO",136:"wo",1114:"syr-SY",1148:"moh-CA",1145:"pap-AN",11290:"sr-Latn-ME",1075:"ve-ZA",1106:"cy-GB",1140:"gn-PY",1139:"ti-ER",1138:"om-Ethi-ET",120:"ii",1136:"ig-NG",1066:"vi-VN",1098:"te-IN",1169:"gd-GB",2087:"lt-LT",11276:"fr-CM",61:"yi",1060:"sl-SI",11273:"en-TT",1058:"uk-UA",128:"ug",1160:"wo-SN",1159:"rw-RW",1158:"qut-GT",1157:"sah-RU",11265:"ar-JO",1155:"co-FR",1154:"oc-FR",1117:"iu-Cans-CA",1152:"ug-CN",1115:"si-LK",1150:"br-FR",1113:"sd-Deva-IN",1112:"mni-IN",51:"ve",1146:"arn-CL",1109:"my-MM",115:"ti",1143:"so-SO",1142:"la-Latn",1141:"haw-US",1104:"mn-MN",2058:"es-MX",1102:"mr-IN",1137:"kr-NG",1100:"ml-IN",1135:"kl-GL",1134:"lb-LU",1133:"ba-RU",1096:"or-IN",1131:"quz-BO",1094:"pa-IN",1129:"ibb-NG",1128:"ha-Latn-NG",1127:"ff-NG",1126:"bin-NG",1125:"dv-MV",1124:"fil-PH",1123:"ps-AF",1122:"fy-NL",1121:"ne-NP",1120:"ks-Arab",1084:"gd-GB",1118:"am-ET",1082:"mt-MT",1116:"chr-Cher-US",1080:"fo-FO",1079:"ka-GE",1078:"af-ZA",1077:"zu-ZA",1111:"kok-IN",1110:"gl-ES",1074:"tn-ZA",1108:"lo-LA",1107:"km-KH",1071:"mk-MK",1105:"bo-CN",1069:"eu-ES",1103:"sa-IN",1067:"hy-AM",1101:"as-IN",1065:"fa-IR",1099:"kn-IN",1063:"lt-LT",1062:"lv-LV",1061:"et-EE",1095:"gu-IN",1059:"be-BY",1093:"bn-IN",1092:"tt-RU",1056:"ur-PK",1090:"tk-TM",1089:"sw-KE",1088:"ky-KG",1087:"kk-KZ",1052:"sq-AL",1051:"sk-SK",1050:"hr-HR",1049:"ru-RU",1048:"ro-RO",1081:"hi-IN",1046:"pt-BR",1045:"pl-PL",1044:"nb-NO",1043:"nl-NL",1076:"xh-ZA",1041:"ja-JP",1040:"it-IT",119:"so",1072:"st-ZA",1037:"he-IL",1036:"fr-FR",1035:"fi-FI",1068:"az-Latn-AZ",1033:"en-US",1032:"el-GR",1031:"de-DE",1030:"da-DK",1029:"cs-CZ",1028:"zh-TW",1027:"ca-ES",1026:"bg-BG",140:"prs",1024:"[No Proofing]",1057:"id-ID",50:"tn",1055:"tr-TR",135:"rw",134:"qut",133:"sah",132:"gsw",131:"co",130:"oc",129:"mi",1047:"rm-CH",127:"[Invariant Language]",126:"br",89:"sd",124:"moh",1042:"ko-KR",122:"arn",121:"pap",1039:"is-IS",1038:"hu-HU",118:"la",117:"haw",116:"gn",1034:"es-ES_tradnl",114:"om",113:"kr",112:"ig",111:"kl",110:"lb",109:"ba",108:"nso",107:"quz",1025:"ar-SA",105:"ibb",104:"ha",103:"ff",102:"bin",101:"dv",100:"fil",99:"ps",98:"fy",97:"ne",96:"ks",95:"tzm",94:"am",93:"iu",92:"chr",91:"si",90:"syr",85:"my",88:"mni",87:"kok",86:"gl",9275:"smn-FI",84:"lo",83:"km",82:"cy",81:"bo",80:"mn",79:"sa",78:"mr",77:"as",76:"ml",75:"kn",74:"te",73:"ta",72:"or",71:"gu",70:"pa",69:"bn",68:"tt",67:"uz",66:"tk",65:"sw",64:"ky",63:"kk",62:"ms",18441:"en-SG",60:"gd",59:"se",58:"mt",57:"hi",56:"fo",55:"ka",54:"af",53:"zu",52:"xh",31:"tr",47:"mk",49:"ts",48:"st",44:"az",46:"hsb",45:"eu",41:"fa",43:"hy",42:"vi",38:"lv",40:"tg",39:"lt",35:"be",37:"et",36:"sl",9225:"en-029",34:"uk",33:"id",32:"ur",29:"sv",30:"th",27:"sk",28:"sq",9217:"ar-YE",26:"hr",25:"ru",24:"ro",23:"rm",22:"pt",21:"pl",20:"no",19:"nl",18:"ko",17:"ja",16:"it",15:"is",14:"hu",13:"he",12:"fr",11:"fi",10:"es",9:"en",8:"el",7:"de",6:"da",5:"cs",4:"zh-HanS",3:"ca",2:"bg",1:"ar",0:"x-none"}))))}static initLanguages(){o._allCultures=[],o._lcidMap=[],o._localnameMap={},o.initLanguagesFromDictionary({"QPS-PLOC":1281,"QPS-PLOCA":1534,"QPS-PLOCM":2559,"AR-SA":1025,"BG-BG":1026,"CA-ES":1027,"ZH-TW":1028,"CS-CZ":1029,"DA-DK":1030,"DE-DE":1031,"EL-GR":1032,"EN-US":1033,"ES-ES":1034,"FI-FI":1035,"FR-FR":1036,"HE-IL":1037,"HU-HU":1038,"IS-IS":1039,"IT-IT":1040,"JA-JP":1041,"KO-KR":1042,"NL-NL":1043,"NB-NO":1044,"PL-PL":1045,"PT-BR":1046,"RM-CH":1047,"RO-RO":1048,"RU-RU":1049,"HR-HR":1050,"SK-SK":1051,"SQ-AL":1052,"SV-SE":1053,"TH-TH":1054,"TR-TR":1055,"UR-PK":1056,"ID-ID":1057,"UK-UA":1058,"BE-BY":1059,"SL-SI":1060,"ET-EE":1061,"LV-LV":1062,"LT-LT":1063,"TG-CYRL-TJ":1064,"FA-IR":1065,"VI-VN":1066,"HY-AM":1067,"AZ-LATN-AZ":1068,"EU-ES":1069,"HSB-DE":1070,"MK-MK":1071,"ST-ZA":1072,"TS-ZA":1073,"TN-ZA":1074,"VE-ZA":1075,"XH-ZA":1076,"ZU-ZA":1077,"AF-ZA":1078,"KA-GE":1079,"FO-FO":1080,"HI-IN":1081,"MT-MT":1082,"SE-NO":1083,"YI-HEBR":1085,"MS-MY":1086,"KK-KZ":1087,"KY-KG":1088,"SW-KE":1089,"TK-TM":1090,"UZ-LATN-UZ":1091,"TT-RU":1092,"BN-IN":1093,"PA-IN":1094,"GU-IN":1095,"OR-IN":1096,"TA-IN":1097,"TE-IN":1098,"KN-IN":1099,"ML-IN":1100,"AS-IN":1101,"MR-IN":1102,"SA-IN":1103,"MN-MN":1104,"BO-CN":1105,"CY-GB":1106,"KM-KH":1107,"LO-LA":1108,"MY-MM":1109,"GL-ES":1110,"KOK-IN":1111,"MNI-IN":1112,"SD-DEVA-IN":1113,"SYR-SY":1114,"SI-LK":1115,"CHR-CHER-US":1116,"IU-CANS-CA":1117,"AM-ET":1118,"TZM-ARAB-MA":1119,"KS-ARAB":1120,"NE-NP":1121,"FY-NL":1122,"PS-AF":1123,"FIL-PH":1124,"DV-MV":1125,"BIN-NG":1126,"FF-NG":1127,"HA-LATN-NG":1128,"IBB-NG":1129,"YO-NG":1130,"QUZ-BO":1131,"NSO-ZA":1132,"BA-RU":1133,"LB-LU":1134,"KL-GL":1135,"IG-NG":1136,"KR-NG":1137,"OM-ETHI-ET":1138,"TI-ET":1139,"GN-PY":1140,"HAW-US":1141,"LA-LATN":1142,"SO-SO":1143,"II-CN":1144,"PAP-AN":1145,"ARN-CL":1146,"MOH-CA":1148,"BR-FR":1150,"UG-CN":1152,"MI-NZ":1153,"OC-FR":1154,"CO-FR":1155,"GSW-FR":1156,"SAH-RU":1157,"QUT-GT":1158,"RW-RW":1159,"WO-SN":1160,"PRS-AF":1164,"GD-GB":1169,"KU-ARAB-IQ":1170,"AR-IQ":2049,"CA-ES-VALENCIA":2051,"ZH-CN":2052,"DE-CH":2055,"EN-GB":2057,"ES-MX":2058,"FR-BE":2060,"IT-CH":2064,"NL-BE":2067,"NN-NO":2068,"PT-PT":2070,"RO-MD":2072,"RU-MD":2073,"SR-LATN-CS":2074,"SV-FI":2077,"AZ-CYRL-AZ":2092,"DSB-DE":2094,"SE-SE":2107,"GA-IE":2108,"MS-BN":2110,"UZ-CYRL-UZ":2115,"BN-BD":2117,"PA-ARAB-PK":2118,"MN-MONG-CN":2128,"SD-ARAB-PK":2137,"IU-LATN-CA":2141,"TZM-LATN-DZ":2143,"KS-DEVA":2144,"NE-IN":2145,"QUZ-EC":2155,"TI-ER":2163,"AR-EG":3073,"ZH-HK":3076,"DE-AT":3079,"EN-AU":3081,"ES-419":22538},!1),o.initLanguagesFromDictionary({"ES-ES":3082,"FR-CA":3084,"SR-CYRL-CS":3098,"SE-FI":3131,"QUZ-PE":3179,"AR-LY":4097,"ZH-SG":4100,"DE-LU":4103,"EN-CA":4105,"ES-GT":4106,"FR-CH":4108,"HR-BA":4122,"SMJ-NO":4155,"AR-DZ":5121,"ZH-MO":5124,"DE-LI":5127,"EN-NZ":5129,"ES-CR":5130,"FR-LU":5132,"BS-LATN-BA":5146,"SMJ-SE":5179,"AR-MA":6145,"EN-IE":6153,"ES-PA":6154,"FR-MC":6156,"SR-LATN-BA":6170,"SMA-NO":6203,"AR-TN":7169,"EN-ZA":7177,"ES-DO":7178,"FR-WINDIES":7180,"SR-CYRL-BA":7194,"SMA-SE":7227,"AR-OM":8193,"EN-JM":8201,"ES-VE":8202,"FR-RE":8204,"BS-CYRL-BA":8218,"SMS-FI":8251,"AR-YE":9217,"EN-029":9225,"ES-CO":9226,"FR-CD":9228,"SR-LATN-RS":9242,"SMN-FI":9275,"AR-SY":10241,"EN-BZ":10249,"ES-PE":10250,"FR-SN":10252,"SR-CYRL-RS":10266,"AR-JO":11265,"EN-TT":11273,"ES-AR":11274,"FR-CM":11276,"SR-LATN-ME":11290,"AR-LB":12289,"EN-ZW":12297,"ES-EC":12298,"FR-CI":12300,"SR-CYRL-ME":12314,"AR-KW":13313,"EN-PH":13321,"ES-CL":13322,"FR-ML":13324,"AR-AE":14337,"EN-ID":14345,"ES-UY":14346,"FR-MA":14348,"AR-BH":15361,"EN-HK":15369,"ES-PY":15370,"FR-HT":15372,"AR-QA":16385,"EN-IN":16393,"ES-BO":16394,"EN-MY":17417,"ES-SV":17418,"EN-SG":18441,"ES-HN":18442,"ES-NI":19466,"ES-PR":20490,"ES-US":21514},!1),o.initLanguagesFromDictionary({AR:1,BG:2,CA:3,"ZH-CHS":4,CS:5,DA:6,DE:7,EL:8,EN:9,ES:10,FI:11,FR:12,HE:13,HU:14,IS:15,IT:16,JA:17,KO:18,NL:19,NO:20,PL:21,PT:22,RO:24,RU:25,HR:26,SK:27,SQ:28,SV:29,TH:30,TR:31,UR:32,ID:33,UK:34,BE:35,SL:36,ET:37,LV:38,LT:39,FA:41,VI:42,HY:43,AZ:44,EU:45,MK:47,ST:48,TS:49,VE:51,AF:54,KA:55,FO:56,HI:57,GD:60,YI:61,MS:62,KK:63,KY:64,SW:65,UZ:67,TT:68,PA:70,GU:71,TA:73,TE:74,KN:75,MR:78,SA:79,MN:80,MY:85,GL:86,KOK:87,MNI:88,SD:89,SYR:90,CHR:92,TZM:95,KS:96,NE:97,DV:101,BIN:102,FF:103,IBB:105,KR:113,OM:114,TI:115,GN:116,HAW:117,LA:118,SO:119,PAP:121,"X-NONE":127,"ZH-CHT":31748,SR:31770},!0)}static initLanguagesFromDictionary(e,t){for(const n in e){const a={key:n,value:e[n]},i=a.key,r=a.value,s=new o(i,r,t);Array.add(o._allCultures,s),o._lcidMap[r]=s,o._localnameMap[i.toUpperCase()]=s}}static get_l_LanguageNames(){return o._languageNames||(o._languageNames=[],o._languageNames[1025]=CommonStrings.arabic_Saudi_Arabia,o._languageNames[1026]=CommonStrings.bulgarian,o._languageNames[1027]=CommonStrings.catalan,o._languageNames[1028]=CommonStrings.chinese_Taiwan,o._languageNames[1029]=CommonStrings.czech,o._languageNames[1030]=CommonStrings.danish,o._languageNames[1031]=CommonStrings.german_Germany,o._languageNames[1032]=CommonStrings.greek,o._languageNames[1033]=CommonStrings.english_US,o._languageNames[1034]=CommonStrings.spanish_Spain_Traditional_Sort,o._languageNames[1035]=CommonStrings.finnish,o._languageNames[1036]=CommonStrings.french_France,o._languageNames[1037]=CommonStrings.hebrew,o._languageNames[1038]=CommonStrings.hungarian,o._languageNames[1039]=CommonStrings.icelandic,o._languageNames[1040]=CommonStrings.italian_Italy,o._languageNames[1041]=CommonStrings.japanese,o._languageNames[1042]=CommonStrings.korean,o._languageNames[1043]=CommonStrings.dutch_Netherlands,o._languageNames[1044]=CommonStrings.norwegian_Bokmal,o._languageNames[1045]=CommonStrings.polish,o._languageNames[1046]=CommonStrings.portuguese_Brazil,o._languageNames[1047]=CommonStrings.romansh,o._languageNames[1048]=CommonStrings.romanian,o._languageNames[1049]=CommonStrings.russian,o._languageNames[1050]=CommonStrings.croatian_Croatia,o._languageNames[1051]=CommonStrings.slovak,o._languageNames[1052]=CommonStrings.albanian,o._languageNames[1053]=CommonStrings.swedish_Sweden,o._languageNames[1054]=CommonStrings.thai,o._languageNames[1055]=CommonStrings.turkish,o._languageNames[1056]=CommonStrings.urdu,o._languageNames[1057]=CommonStrings.indonesian,o._languageNames[1058]=CommonStrings.ukrainian,o._languageNames[1059]=CommonStrings.belarusian,o._languageNames[1060]=CommonStrings.slovenian,o._languageNames[1061]=CommonStrings.estonian,o._languageNames[1062]=CommonStrings.latvian,o._languageNames[1063]=CommonStrings.lithuanian,o._languageNames[1064]=CommonStrings.tajik,o._languageNames[1065]=CommonStrings.persian,o._languageNames[1066]=CommonStrings.vietnamese,o._languageNames[1067]=CommonStrings.armenian,o._languageNames[1068]=CommonStrings.azerbaijani_Latin,o._languageNames[1069]=CommonStrings.basque,o._languageNames[1070]=CommonStrings.upper_Sorbian,o._languageNames[1071]=CommonStrings.macedonian,o._languageNames[1072]=CommonStrings.sesotho_South_Africa,o._languageNames[1073]=CommonStrings.xitsonga,o._languageNames[1074]=CommonStrings.setswana,o._languageNames[1075]=CommonStrings.venda,o._languageNames[1076]=CommonStrings.isiXhosa,o._languageNames[1077]=CommonStrings.isiZulu,o._languageNames[1078]=CommonStrings.afrikaans,o._languageNames[1079]=CommonStrings.georgian,o._languageNames[1080]=CommonStrings.faroese,o._languageNames[1081]=CommonStrings.hindi,o._languageNames[1082]=CommonStrings.maltese,o._languageNames[1083]=CommonStrings.sami_Northern_Norway,o._languageNames[1085]=CommonStrings.yiddish,o._languageNames[1086]=CommonStrings.malay_Malaysia,o._languageNames[1087]=CommonStrings.kazakh,o._languageNames[1088]=CommonStrings.kyrgyz,o._languageNames[1089]=CommonStrings.swahili,o._languageNames[1090]=CommonStrings.turkmen,o._languageNames[1091]=CommonStrings.uzbek_Latin,o._languageNames[1092]=CommonStrings.tatar,o._languageNames[1093]=CommonStrings.bangla_India,o._languageNames[1094]=CommonStrings.punjabi,o._languageNames[1095]=CommonStrings.gujarati,o._languageNames[1096]=CommonStrings.odia,o._languageNames[1097]=CommonStrings.tamil,o._languageNames[1098]=CommonStrings.telugu,o._languageNames[1099]=CommonStrings.kannada,o._languageNames[1100]=CommonStrings.malayalam,o._languageNames[1101]=CommonStrings.assamese,o._languageNames[1102]=CommonStrings.marathi,o._languageNames[1103]=CommonStrings.sanskrit,o._languageNames[1104]=CommonStrings.mongolian_Cyrillic,o._languageNames[1105]=CommonStrings.tibetan_China,o._languageNames[1106]=CommonStrings.welsh,o._languageNames[1107]=CommonStrings.khmer,o._languageNames[1108]=CommonStrings.lao,o._languageNames[1109]=CommonStrings.burmese,o._languageNames[1110]=CommonStrings.galician,o._languageNames[1111]=CommonStrings.konkani,o._languageNames[1112]=CommonStrings.manipuri,o._languageNames[1113]=CommonStrings.sindhi_Devanagari,o._languageNames[1114]=CommonStrings.syriac,o._languageNames[1115]=CommonStrings.sinhala,o._languageNames[1116]=CommonStrings.cherokee,o._languageNames[1117]=CommonStrings.inuktitut_Syllabics,o._languageNames[1118]=CommonStrings.amharic,o._languageNames[1119]=CommonStrings.tamazight_Arabic_Morocco,o._languageNames[1120]=CommonStrings.kashmiri_Arabic,o._languageNames[1121]=CommonStrings.nepali,o._languageNames[1122]=CommonStrings.frisian,o._languageNames[1123]=CommonStrings.pashto,o._languageNames[1124]=CommonStrings.filipino,o._languageNames[1125]=CommonStrings.divehi,o._languageNames[1126]=CommonStrings.edo,o._languageNames[1127]=CommonStrings.fulfulde,o._languageNames[1128]=CommonStrings.hausa,o._languageNames[1129]=CommonStrings.ibibio_Nigeria,o._languageNames[1130]=CommonStrings.yoruba,o._languageNames[1131]=CommonStrings.quechua_Bolivia,o._languageNames[1132]=CommonStrings.sesotho_sa_Leboa,o._languageNames[1133]=CommonStrings.bashkir,o._languageNames[1134]=CommonStrings.luxembourgish,o._languageNames[1135]=CommonStrings.greenlandic,o._languageNames[1136]=CommonStrings.igbo,o._languageNames[1137]=CommonStrings.kanuri,o._languageNames[1138]=CommonStrings.oromo,o._languageNames[1139]=CommonStrings.tigrigna_Ethiopia,o._languageNames[1140]=CommonStrings.guarani,o._languageNames[1141]=CommonStrings.hawaiian,o._languageNames[1142]=CommonStrings.latin,o._languageNames[1143]=CommonStrings.somali,o._languageNames[1144]=CommonStrings.yi_China,o._languageNames[1145]=CommonStrings.papiamentu,o._languageNames[1146]=CommonStrings.mapudungun,o._languageNames[1148]=CommonStrings.mohawk,o._languageNames[1150]=CommonStrings.breton,o._languageNames[1152]=CommonStrings.uyghur_China,o._languageNames[1153]=CommonStrings.maori,o._languageNames[1154]=CommonStrings.occitan,o._languageNames[1155]=CommonStrings.corsican,o._languageNames[1156]=CommonStrings.alsatian,o._languageNames[1157]=CommonStrings.sakha,o._languageNames[1158]=CommonStrings.kiche,o._languageNames[1159]=CommonStrings.kinyarwanda,o._languageNames[1160]=CommonStrings.wolof,o._languageNames[1164]=CommonStrings.dari_Afghanistan,o._languageNames[1169]=CommonStrings.scottish_Gaelic_United_Kingdom,o._languageNames[1170]=CommonStrings.central_Kurdish_Iraq,o._languageNames[1281]=CommonStrings.qpsPloc_Name,o._languageNames[1534]=CommonStrings.qpsPloca_Name,o._languageNames[2049]=CommonStrings.arabic_Iraq,o._languageNames[2051]=CommonStrings.valencian,o._languageNames[2052]=CommonStrings.chinese_China,o._languageNames[2055]=CommonStrings.german_Switzerland,o._languageNames[2057]=CommonStrings.english_UK,o._languageNames[2058]=CommonStrings.spanish_Mexico,o._languageNames[2060]=CommonStrings.french_Belgium,o._languageNames[2064]=CommonStrings.italian_Switzerland,o._languageNames[2067]=CommonStrings.dutch_Belgium,o._languageNames[2068]=CommonStrings.norwegian_Nynorsk,o._languageNames[2070]=CommonStrings.portuguese_Portugal,o._languageNames[2072]=CommonStrings.romanian_Moldova,o._languageNames[2073]=CommonStrings.russian_Moldova,o._languageNames[2074]=CommonStrings.serbian_Latin_Serbia_and_Montenegro_Former,o._languageNames[2077]=CommonStrings.swedish_Finland,o._languageNames[2092]=CommonStrings.azerbaijani_Cyrillic,o._languageNames[2094]=CommonStrings.lower_Sorbian,o._languageNames[2107]=CommonStrings.sami_Northern_Sweden,o._languageNames[2108]=CommonStrings.irish_Ireland,o._languageNames[2110]=CommonStrings.malay_Brunei_Darussalam,o._languageNames[2115]=CommonStrings.uzbek_Cyrillic,o._languageNames[2117]=CommonStrings.bangla_Bangladesh,o._languageNames[2118]=CommonStrings.punjabi_Pakistan,o._languageNames[2128]=CommonStrings.mongolian_Traditional_Mongolian_China,o._languageNames[2137]=CommonStrings.sindhi_Arabic,o._languageNames[2141]=CommonStrings.inuktitut_Latin,o._languageNames[2143]=CommonStrings.tamazight_Latin_Algeria,o._languageNames[2144]=CommonStrings.kashmiri,o._languageNames[2145]=CommonStrings.nepali_India,o._languageNames[2155]=CommonStrings.quechua_Ecuador,o._languageNames[2163]=CommonStrings.tigrigna_Eritrea,o._languageNames[2559]=CommonStrings.qpsPlocm_Name,o._languageNames[3073]=CommonStrings.arabic_Egypt,o._languageNames[3076]=CommonStrings.chinese_Hong_Kong_SAR,o._languageNames[3079]=CommonStrings.german_Austria,o._languageNames[3081]=CommonStrings.english_Australia,o._languageNames[3082]=CommonStrings.spanish_International_Sort,o._languageNames[3084]=CommonStrings.french_Canada,o._languageNames[3098]=CommonStrings.serbian_Cyrillic_Serbia_and_Montenegro_Former,o._languageNames[3131]=CommonStrings.sami_Northern_Finland,o._languageNames[3179]=CommonStrings.quechua_Peru,o._languageNames[4097]=CommonStrings.arabic_Libya,o._languageNames[4100]=CommonStrings.chinese_Singapore,o._languageNames[4103]=CommonStrings.german_Luxembourg,o._languageNames[4105]=CommonStrings.english_Canada,o._languageNames[4106]=CommonStrings.spanish_Guatemala,o._languageNames[4108]=CommonStrings.french_Switzerland,o._languageNames[4122]=CommonStrings.croatian_Bosnia_and_Herzegovina,o._languageNames[4155]=CommonStrings.sami_Lule_Norway,o._languageNames[5121]=CommonStrings.arabic_Algeria,o._languageNames[5124]=CommonStrings.chinese_Macao_SAR,o._languageNames[5127]=CommonStrings.german_Liechtenstein,o._languageNames[5129]=CommonStrings.english_New_Zealand,o._languageNames[5130]=CommonStrings.spanish_Costa_Rica,o._languageNames[5132]=CommonStrings.french_Luxembourg,o._languageNames[5146]=CommonStrings.bosnian_Latin,o._languageNames[5179]=CommonStrings.sami_Lule_Sweden,o._languageNames[6145]=CommonStrings.arabic_Morocco,o._languageNames[6153]=CommonStrings.english_Ireland,o._languageNames[6154]=CommonStrings.spanish_Panama,o._languageNames[6156]=CommonStrings.french_Monaco,o._languageNames[6170]=CommonStrings.serbian_Latin_Bosnia_and_Herzegovina,o._languageNames[6203]=CommonStrings.sami_Southern_Norway,o._languageNames[7169]=CommonStrings.arabic_Tunisia,o._languageNames[7177]=CommonStrings.english_South_Africa,o._languageNames[7178]=CommonStrings.spanish_Dominican_Republic,o._languageNames[7180]=CommonStrings.french_West_Indies,o._languageNames[7194]=CommonStrings.serbian_Cyrillic_Bosnia_and_Herzegovina,o._languageNames[7227]=CommonStrings.sami_Southern_Sweden,o._languageNames[8193]=CommonStrings.arabic_Oman,o._languageNames[8201]=CommonStrings.english_Jamaica,o._languageNames[8202]=CommonStrings.spanish_Venezuela,o._languageNames[8204]=CommonStrings.french_Reunion,o._languageNames[8218]=CommonStrings.bosnian_Cyrillic,o._languageNames[8251]=CommonStrings.sami_Skolt_Finland,o._languageNames[9217]=CommonStrings.arabic_Yemen,o._languageNames[9225]=CommonStrings.english_Caribbean,o._languageNames[9226]=CommonStrings.spanish_Colombia,o._languageNames[9228]=CommonStrings.french_Congo_DRC,o._languageNames[9242]=CommonStrings.serbian_Latin_Serbia,o._languageNames[9275]=CommonStrings.sami_Inari_Finland,o._languageNames[10241]=CommonStrings.arabic_Syria,o._languageNames[10249]=CommonStrings.english_Belize,o._languageNames[10250]=CommonStrings.spanish_Peru,o._languageNames[10252]=CommonStrings.french_Senegal,o._languageNames[10266]=CommonStrings.serbian_Cyrillic_Serbia,o._languageNames[11265]=CommonStrings.arabic_Jordan,o._languageNames[11273]=CommonStrings.english_Trinidad_and_Tobago,o._languageNames[11274]=CommonStrings.spanish_Argentina,o._languageNames[11276]=CommonStrings.french_Cameroon,o._languageNames[11290]=CommonStrings.serbian_Latin_Montenegro,o._languageNames[12289]=CommonStrings.arabic_Lebanon,o._languageNames[12297]=CommonStrings.english_Zimbabwe,o._languageNames[12298]=CommonStrings.spanish_Ecuador,o._languageNames[12300]=CommonStrings.french_Cote_dIvoire,o._languageNames[12314]=CommonStrings.serbian_Cyrillic_Montenegro,o._languageNames[13313]=CommonStrings.arabic_Kuwait,o._languageNames[13321]=CommonStrings.english_Philippines,o._languageNames[13322]=CommonStrings.spanish_Chile,o._languageNames[13324]=CommonStrings.french_Mali,o._languageNames[14337]=CommonStrings.arabic_UAE,o._languageNames[14345]=CommonStrings.english_Indonesia,o._languageNames[14346]=CommonStrings.spanish_Uruguay,o._languageNames[14348]=CommonStrings.french_Morocco,o._languageNames[15361]=CommonStrings.arabic_Bahrain,o._languageNames[15369]=CommonStrings.english_Hong_Kong_SAR,o._languageNames[15370]=CommonStrings.spanish_Paraguay,o._languageNames[15372]=CommonStrings.french_Haiti,o._languageNames[16385]=CommonStrings.arabic_Qatar,o._languageNames[16393]=CommonStrings.english_India,o._languageNames[16394]=CommonStrings.spanish_Bolivia,o._languageNames[17417]=CommonStrings.english_Malaysia,o._languageNames[17418]=CommonStrings.spanish_El_Salvador,o._languageNames[18441]=CommonStrings.english_Singapore,o._languageNames[18442]=CommonStrings.spanish_Honduras,o._languageNames[19466]=CommonStrings.spanish_Nicaragua,o._languageNames[20490]=CommonStrings.spanish_Puerto_Rico,o._languageNames[21514]=CommonStrings.spanish_United_States,o._languageNames[22538]=CommonStrings.spanish_Latin_America,o._languageNames[31748]=CommonStrings.chinese_Traditional,o._languageNames[31770]=CommonStrings.serbian,o._languageNames[1]=CommonStrings.arabic,o._languageNames[2]=CommonStrings.bulgarian,o._languageNames[3]=CommonStrings.catalan,o._languageNames[4]=CommonStrings.chinese_Simplified,o._languageNames[5]=CommonStrings.czech,o._languageNames[6]=CommonStrings.danish,o._languageNames[7]=CommonStrings.german,o._languageNames[8]=CommonStrings.greek,o._languageNames[9]=CommonStrings.english,o._languageNames[10]=CommonStrings.spanish,o._languageNames[11]=CommonStrings.finnish,o._languageNames[12]=CommonStrings.french,o._languageNames[13]=CommonStrings.hebrew,o._languageNames[14]=CommonStrings.hungarian,o._languageNames[15]=CommonStrings.icelandic,o._languageNames[16]=CommonStrings.italian,o._languageNames[17]=CommonStrings.japanese,o._languageNames[18]=CommonStrings.korean,o._languageNames[19]=CommonStrings.dutch,o._languageNames[20]=CommonStrings.norwegian,o._languageNames[21]=CommonStrings.polish,o._languageNames[22]=CommonStrings.portuguese,o._languageNames[24]=CommonStrings.romanian,o._languageNames[25]=CommonStrings.russian,o._languageNames[26]=CommonStrings.croatian,o._languageNames[27]=CommonStrings.slovak,o._languageNames[28]=CommonStrings.albanian,o._languageNames[29]=CommonStrings.swedish,o._languageNames[30]=CommonStrings.thai,o._languageNames[31]=CommonStrings.turkish,o._languageNames[32]=CommonStrings.urdu,o._languageNames[33]=CommonStrings.indonesian,o._languageNames[34]=CommonStrings.ukrainian,o._languageNames[35]=CommonStrings.belarusian,o._languageNames[36]=CommonStrings.slovenian,o._languageNames[37]=CommonStrings.estonian,o._languageNames[38]=CommonStrings.latvian,o._languageNames[39]=CommonStrings.lithuanian,o._languageNames[41]=CommonStrings.persian,o._languageNames[42]=CommonStrings.vietnamese,o._languageNames[43]=CommonStrings.armenian,o._languageNames[44]=CommonStrings.azerbaijani,o._languageNames[45]=CommonStrings.basque,o._languageNames[47]=CommonStrings.macedonian,o._languageNames[48]=CommonStrings.sesotho_sa_Leboa,o._languageNames[49]=CommonStrings.xitsonga,o._languageNames[51]=CommonStrings.venda,o._languageNames[54]=CommonStrings.afrikaans,o._languageNames[55]=CommonStrings.georgian,o._languageNames[56]=CommonStrings.faroese,o._languageNames[57]=CommonStrings.hindi,o._languageNames[60]=CommonStrings.irish,o._languageNames[61]=CommonStrings.yiddish,o._languageNames[62]=CommonStrings.malay,o._languageNames[63]=CommonStrings.kazakh,o._languageNames[64]=CommonStrings.kyrgyz,o._languageNames[65]=CommonStrings.kiswahili,o._languageNames[67]=CommonStrings.uzbek,o._languageNames[68]=CommonStrings.tatar,o._languageNames[70]=CommonStrings.punjabi,o._languageNames[71]=CommonStrings.gujarati,o._languageNames[73]=CommonStrings.tamil,o._languageNames[74]=CommonStrings.telugu,o._languageNames[75]=CommonStrings.kannada,o._languageNames[78]=CommonStrings.marathi,o._languageNames[79]=CommonStrings.sanskrit,o._languageNames[80]=CommonStrings.mongolian,o._languageNames[85]=CommonStrings.burmese,o._languageNames[86]=CommonStrings.galician,o._languageNames[87]=CommonStrings.konkani,o._languageNames[88]=CommonStrings.manipuri,o._languageNames[89]=CommonStrings.sindhi,o._languageNames[90]=CommonStrings.syriac,o._languageNames[92]=CommonStrings.cherokee,o._languageNames[95]=CommonStrings.tamazight,o._languageNames[96]=CommonStrings.kashmiri,o._languageNames[97]=CommonStrings.nepali,o._languageNames[101]=CommonStrings.divehi,o._languageNames[102]=CommonStrings.edo,o._languageNames[103]=CommonStrings.fulfulde,o._languageNames[105]=CommonStrings.ibibio,o._languageNames[113]=CommonStrings.kanuri,o._languageNames[114]=CommonStrings.oromo,o._languageNames[115]=CommonStrings.tigrigna,o._languageNames[116]=CommonStrings.guarani,o._languageNames[117]=CommonStrings.hawaiian,o._languageNames[118]=CommonStrings.latin,o._languageNames[119]=CommonStrings.somali,o._languageNames[121]=CommonStrings.papiamentu,o._languageNames[127]=CommonStrings.invariant_Language),o._languageNames}static get l_DevanagariScriptVowelUnicode(){return o._devanagariScriptVowelUnicode||(o._devanagariScriptVowelUnicode={},o._devanagariScriptVowelUnicode["%u094B"]=1,o._devanagariScriptVowelUnicode["%u0940"]=2,o._devanagariScriptVowelUnicode["%u0941"]=3,o._devanagariScriptVowelUnicode["%u0942"]=4,o._devanagariScriptVowelUnicode["%u0952"]=5,o._devanagariScriptVowelUnicode["%u0962"]=6,o._devanagariScriptVowelUnicode["%u0943"]=7,o._devanagariScriptVowelUnicode["%u0953"]=8,o._devanagariScriptVowelUnicode["%u0963"]=9,o._devanagariScriptVowelUnicode["%u0945"]=10,o._devanagariScriptVowelUnicode["%u0955"]=11,o._devanagariScriptVowelUnicode["%u0946"]=12,o._devanagariScriptVowelUnicode["%u0956"]=13,o._devanagariScriptVowelUnicode["%u0947"]=14,o._devanagariScriptVowelUnicode["%u0957"]=15,o._devanagariScriptVowelUnicode["%u0948"]=16,o._devanagariScriptVowelUnicode["%u0949"]=17,o._devanagariScriptVowelUnicode["%u093A"]=18,o._devanagariScriptVowelUnicode["%u094A"]=19,o._devanagariScriptVowelUnicode["%u093B"]=20,o._devanagariScriptVowelUnicode["%u094C"]=21,o._devanagariScriptVowelUnicode["%u093C"]=22,o._devanagariScriptVowelUnicode["%u094D"]=23,o._devanagariScriptVowelUnicode["%u093E"]=24,o._devanagariScriptVowelUnicode["%u094E"]=25,o._devanagariScriptVowelUnicode["%u093F"]=26,o._devanagariScriptVowelUnicode["%u094F"]=27,o._devanagariScriptVowelUnicode["%u0971"]=28,o._devanagariScriptVowelUnicode["%u0902"]=29,o._devanagariScriptVowelUnicode["%u0900"]=30,o._devanagariScriptVowelUnicode["%u0901"]=31,o._devanagariScriptVowelUnicode["%u0903"]=32),o._devanagariScriptVowelUnicode}static get invariantCulture(){return o.getCultureInfo(127)}static getCultures(e){o._allCultures||o.initLanguages();const t=[],n=0===e||2===e,a=0===e||1===e;for(let e=0;e<o._allCultures.length;e++){const i=o._allCultures[e];i.isNeutralCulture?n&&Array.add(t,i):a&&Array.add(t,i)}return t}static getCultureInfo(e){if(o._allCultures||o.initLanguages(),"number"==typeof e){const t=e;return o._lcidMap[t]}return e?o._localnameMap[e.toUpperCase()]:void 0}constructor(e,t,n){if(this._lcid=0,this._name=null,this._neutral=!1,this._displayName=null,1===arguments.length){const t=o.getCultureInfo(e);0,t?(this._name=t._name,this._lcid=t._lcid,this._displayName=t._displayName,this._neutral=t._neutral):(this._name="X-NONE",this._lcid=0,this._displayName="Unknown Culture",this._neutral=!0)}else this._name=e,this._lcid=t,this._neutral=n}}o._allCultures=null,o._lcidMap=null,o._localnameMap=null,o._languageNames=null,o._devanagariScriptVowelUnicode=null,o._languageIdMapping=null,(0,a.a)(o,"CultureInfo",null,[])},872:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(6362);const o="_customData";class r{static copyObjects(e,t){const n=e[o];if(!n)return;const a=i.a.getKeys(n);for(const n of a)r.setObject(t,n,r.getObject(e,n))}static getObject(e,t){const n=e[o];return n?n[t]:null}static setObject(e,t,n){let a=e[o];a||(a={},e[o]=a),a[t]=n}static removeObject(e,t){const n=e[o];n&&delete n[t]}static removeAllObjects(e){e[o]&&(e[o]=null)}}(0,a.a)(r,"CustomData",null,[])},6362:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(965);class o{static count(e){let t=0;for(const n in e)t++;return t}static forEach(e,t,n){for(const a in e){const i={key:a,value:e[a]};t(i.key,i.value,n)}}static any(e,t){for(const n in e){const a={key:n,value:e[n]};if(t(a.key,a.value))return!0}return!1}static isNullOrEmpty(e){return!e||o.isEmpty(e)}static isEmpty(e){for(const t in e)return!1;return!0}static getKeys(e){const t=[];for(const n in e){const a={key:n,value:e[n]};Array.add(t,a.key)}return t}static getValues(e){const t=[];for(const n in e){const a={key:n,value:e[n]};Array.add(t,a.value)}return t}static shallowCopy(e){if(!e)return null;const t={};for(const n in e){const a={key:n,value:e[n]};t[a.key]=a.value}return t}static toDictionary(...e){const t={};if(e&&e.length>0&&!(e.length%2))for(let n=0;n<e.length-1;n+=2)t[e[n]]=e[n+1];return t}static buildHashSet(e,t=null){if(t=t||{},e)for(const n of e)t[n]=!0;return t}static join(e,t,n){if(!e)return null;let a="";for(const i in e){const o={key:i,value:e[i]};""!==a&&(a+=t),a+=o.key+n+o.value}return a}static toJSON(e){return e?i.c(e):null}}(0,a.a)(o,"DictionaryUtils",null,[])},8349:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5149),o=n(7689);class r{static getScrubbedHttpErrorDetails(e,t=-1){try{let n;const a=typeof e;if(null==e)return"";if(o.a.isArray(e))n=o.a.map(e,(e=>r.getScrubbedHttpErrorDetails(e,t)));else if("object"===a){const a={},i=e;for(const e in i){const n={key:e,value:i[e]};a[n.key]=r.getScrubbedHttpErrorDetails(n.value,t)}n=a}else n="string"===a?r.getScrubbedHttpErrorDetailsForString(e,t):e;return n}catch(e){return i.ULS.sendExceptionTraceTag(509145746,306,50,e,"Failed to scrub input"),"Failed to scrub input"}}static getRedactedString(e){return String.format("### REDACTED ### - Reason: [{0}]",e)}static getScrubbedHttpErrorDetailsForString(e,t=-1){const n=e.toString().toLowerCase();return n.indexOf("<!doctype")>0?r.getRedactedString("Seems to contain HTML - Contains <!DOCTYPE"):n.indexOf("<html")>0?r.getRedactedString("Seems to contain HTML - Contains <html>"):t>=0&&n.length>t?r.getRedactedString(String.format("Error details content exceeded max length of {0}: Length: {1}",t,n.length)):e}}(0,a.a)(r,"LoggingUtils",null,[])},1600:function(e,t,n){"use strict";n.d(t,{a:function(){return r},b:function(){return i},c:function(){return o},d:function(){return a}});const a=e=>{let t="";if(e&&e.HostResponseStats){const e=n(3245).AFrameworkApplication.dataPlumber.HostResponseStats.Geo,a=n(3245).AFrameworkApplication.dataPlumber.HostResponseStats.Label;e&&e.length>0&&a&&a.length>0?t=e+"/"+a:e&&e.length>0&&(t=e)}return t},i=e=>e?String(e.HasReceivedInboundReplications):"Unknown",o=e=>e?e.HostProtocol:"None",r=e=>e?e.AccessType:"Unknown"},9858:function(e,t,n){"use strict";n.d(t,{a:function(){return l}});var a=n(100),i=n(2998),o=n(5149);class r{getLogLevel(e){let t;return""+e in this._logLevelMapping?t=this._logLevelMapping[""+e]:(t=200,o.ULS.shipAssertTag(6423762,200,!1,"Failed to find SharedLogLevel: {0}",e)),t}getLogCategory(e){let t;return""+e in this._logCategoryMapping?t=this._logCategoryMapping[""+e]:(t=200,o.ULS.shipAssertTag(6423763,200,!1,"Failed to find CommonLogCategory: {0}",e)),t}shouldTrace(e,t){const n=this.getLogCategory(e),a=this.getLogLevel(t);return o.ULS.shouldTrace(n,a)}traceTag(e,t,n,a,...i){const r=this.getLogCategory(t),s=this.getLogLevel(n);o.ULS.sendTraceTag.apply(null,[e,r,s,a].concat(i))}shipAssertTag(e,t,n,a,...i){const r=this.getLogCategory(t);o.ULS.shipAssertTag.apply(null,[e,r,n,a].concat(i))}traceMultiPartMessageTag(e,t,n,a,i){i=i||"";const o=3048-a.length;if(o<=0)return void this.traceTag(e,t,n,a+": "+i);const r=Math.ceil(i.length/o);if(r<=1)this.traceTag(e,t,n,a+": "+i);else for(let s=1,l=0,c=o;s<=r;s++,l=c,c+=o){const o=Math.min(i.length,c),d=i.substring(l,o),u=String.format("[{0} of {1}] {2}: {3}",s,r,a,d);this.traceTag(e,t,n,u)}}static get instance(){return r._instance||(r._instance=new r)}constructor(){this._logLevelMapping={},this._logLevelMapping[1]=10,this._logLevelMapping[2]=15,this._logLevelMapping[3]=20,this._logLevelMapping[4]=50,this._logLevelMapping[5]=100,this._logLevelMapping[6]=200,this._logCategoryMapping={},this._logCategoryMapping[1]=300,this._logCategoryMapping[2]=303,this._logCategoryMapping[3]=304,this._logCategoryMapping[4]=319,this._logCategoryMapping[5]=201,this._logCategoryMapping[6]=370,this._logCategoryMapping[7]=315,this._logCategoryMapping[8]=324}}r._instance=null,(0,a.a)(r,"XLog",null,[]);var s=n(8103);class l{static get_linkableProtocolList(){return l._linkableProtocolList||(l._linkableProtocolList=["http://","https://","file://","file:\\\\","ftp://",l.mailToProtocol,"news:",l.notesUnescaped,"\\\\","www.","onenote:","tel:","mms://",l.notesEscaped,"mssv://",l.bookmarkAnchorPrefix])}static get_urlKeyValueEncodeReplacements(){return l._urlKeyValueEncodeReplacements||(l._urlKeyValueEncodeReplacements=[i.a.createGlobalSearchFindReplacePair("!","%21"),i.a.createGlobalSearchFindReplacePair("'","%27"),i.a.createGlobalSearchFindReplacePair("\\(","%28"),i.a.createGlobalSearchFindReplacePair("\\)","%29"),i.a.createGlobalSearchFindReplacePair("\\*","%2A")])}static stripIgnoredLinkChars(e){return l.stripChars(e,l.ignoredLinkCharsStart,l.ignoredLinkCharsEnd)}static stripChars(e,t,n){let a;if(a=0,!e)return{returnValue:null,newStart:a};let i=e.length;for(;i>a&&-1!==n.indexOf(e.charAt(i-1));)i--;for(;a<i&&-1!==t.indexOf(e.charAt(a));)a++;return{returnValue:e.substr(a,i-a),newStart:a}}static isLinkable(e,t=!1){if(!e)return!1;let n;e=l.toLower(e),({newStart:n,returnValue:e}=l.stripIgnoredLinkChars(e));for(const n of l.get_linkableProtocolList())if((!t||!e.startsWith(l.notesUnescaped)||e.startsWith(l.notesEscaped))&&l.startsWith(e,n))return!0;return!1}static isEmail(e){return!!e&&e.length<=254&&l._emailRegex.test(e)}static isWhitespace(e){switch(e){case 12288:case 8197:case 32:case 13:case 10:case 65532:case 11:case 9:case 160:return!0}return!1}static isWhitespaceUnicode(e){switch(e){case" ":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":case"":return!0}return!1}static startsWith(e,t){return!!e&&!!t&&e.startsWith(t)}static convertToHex(e,t){let n=e.toString(16);for(;n.length<t;)n="0"+n;return l.toLower(n)}static removeSurroundingChar(e,t){return e&&e.length>=2&&e.charAt(0)===t&&e.charAt(e.length-1)===t&&(e=e.substr(1,e.length-2)),e}static encodeString(e,t){let n=e;const a=t.length;for(let e=0;e<a;++e)n=t[e].performReplaceOn(n);return n}static urlKeyValueEncode(e){let t=e;return t=encodeURIComponent(t),t=l.encodeString(t,l.get_urlKeyValueEncodeReplacements()),t}static get_romanOnes(){return l._romanOnes||(l._romanOnes=["","I","II","III","IV","V","VI","VII","VIII","IX"])}static get_romanTens(){return l._romanTens||(l._romanTens=["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"])}static get_romanHundreds(){return l._romanHundreds||(l._romanHundreds=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"])}static convertToRoman(e,t=!1){let n="";for(;e>=1e3;)n+="M",e-=1e3;const a=l.get_romanHundreds()[Math.floor(e/100)];e%=100;const i=l.get_romanTens()[Math.floor(e/10)];e%=10;const o=l.get_romanOnes()[e];let r=String.format("{0}{1}{2}{3}",n,a,i,o);return t&&(r=l.toLower(r)),r}static redactForLogging(e){return null==e?"(null)":"REDACTED:"+e.length}static convertFromRoman(e){e=l.toUpper(e);const t=new RegExp("^[IVXLCDM]+$"),n=e.match(t);if(!n||1!==n.length||n[0]!==e||e.length<1)return-1;let a=0,i=0;for(;a<e.length&&"M"===e.charAt(a);)a++;if(a>0){if(i=1e3*a,!(a<e.length))return i;e=e.substr(a)}return a=0,i+=({indexIntoParent:a}=l.convertIndividualPlaceValueFromRoman(l.get_romanHundreds(),e,a,100)).returnValue,a<e.length&&(e=e.substr(a),a=0,i+=({indexIntoParent:a}=l.convertIndividualPlaceValueFromRoman(l.get_romanTens(),e,a,10)).returnValue,a<e.length&&(e=e.substr(a),a=0,i+=({indexIntoParent:a}=l.convertIndividualPlaceValueFromRoman(l.get_romanOnes(),e,a,1)).returnValue)),e.length!==a&&(i=-1),i<1?-1:i}static convertIndividualPlaceValueFromRoman(e,t,n,a){for(let i=e.length-1;i>0;i--)if(l.startsWith(t,e[i]))return{returnValue:i*a,indexIntoParent:n+=e[i].length};return{returnValue:0,indexIntoParent:n}}static convertFromAlpha(e){const t=new RegExp("^([a-zA-Z])\\1{0,}$"),n=e.match(t);return!n||n.length<=1||n[0]!==e||e.length<1?-1:26*((e=e.toUpperCase()).length-1)+e.charCodeAt(0)-64}static convertToAlpha(e,t=!1){let n="";if(e<0)return n;n=l.fromCharCode(e%26+65);let a=Math.floor(e/26);if(a>0){const e=n.charAt(0);for(;a>0;)n+=e,a--}return t&&(n=l.toLower(n)),n}static isAlpha(e){const t=e.toString();return l.toLower(t)!==l.toUpper(t)}static isNumeric(e){return"0123456789".indexOf(e)>=0}static isAlphaNum(e){return l.isAlpha(e)||l.isNumeric(e)}static isLowSurrogateCharAt(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}static isHighSurrogateCharAt(e,t){return e.charCodeAt(t)>=55296&&e.charCodeAt(t)<=56319}static getMinimalDifferenceBoundsAtCp(e,t,n){let a,i,o=!0;const r=e.substr(n),s=t.substr(n),c=l.reverseString(r),d=l.reverseString(s),{firstDiffLeft:u,firstDiffRight:p}=l.getMinimalDifferenceBounds(c,d);return u<r.length&&u<s.length&&e.charCodeAt(n)===t.charCodeAt(n)&&(o=!1),o?(a=n,i=u):({firstDiffLeft:a,firstDiffRight:i}=l.getMinimalDifferenceBounds(e,t)),{firstDiffLeft:a,firstDiffRight:i}}static reverseString(e){let t="";for(let n=e.length-1;n>=0;n--)t+=e.charAt(n);return t}static getMinimalDifferenceBounds(e,t){let n,a,i,o;if(t=t||"",(e=e||"").length<t.length?(i=e,o=t):(i=t,o=e),o.startsWith(i))n=i.length,a=0;else if(o.endsWith(i))n=0,a=i.length;else{let o;for(o=0;o<e.length&&o<t.length;o++){const n=e.charCodeAt(o),a=t.charCodeAt(o);if(!(n===a||l.isWhitespace(n)&&l.isWhitespace(a)))break}for(n=o,o=0;o<e.length&&o<t.length;o++){const n=e.charCodeAt(e.length-o-1),a=t.charCodeAt(t.length-o-1);if(!(n===a||l.isWhitespace(n)&&l.isWhitespace(a)))break}a=o,n+a>i.length&&(a=i.length-n)}if(n>0){const a=n<e.length&&l.isLowSurrogateCharAt(e,n),i=n<t.length&&l.isLowSurrogateCharAt(t,n);(a||i)&&n--}if(a>1){const n=a<e.length&&l.isLowSurrogateCharAt(e,e.length-a),i=a<t.length&&l.isLowSurrogateCharAt(t,t.length-a);(n||i)&&a--}const s=n<e.length&&l.isLowSurrogateCharAt(e,n)||n<t.length&&l.isLowSurrogateCharAt(t,n),c=a>0&&(a<e.length&&l.isLowSurrogateCharAt(e,e.length-a)||a<t.length&&l.isLowSurrogateCharAt(t,t.length-a));return(s||c)&&r.instance.traceTag(6961039,5,4,"Consecutive low surrogate chars!"),{firstDiffLeft:n,firstDiffRight:a}}static checkStringIsNullOrEmpty(e){return!e||!e.length}static serializeStringDictionaryToJson(e){if(!e||!e.count)return"";const t=new Sys.StringBuilder;t.append("{");for(const n of e){if(!n.key||null===n.value)continue;const e=String.format('"{0}": "{1}",',n.key,n.value);t.append(e)}const n=t.toString(),a=n.length;return a>1?n.substring(0,a-1)+"}":""}static get _lineBreakRegExp(){return l._lineBreakRegularExpression||(l._lineBreakRegularExpression=new RegExp("[\r\n]+","g"))}static get unwantedCharsRegExp(){return l._unwantedCharsRegularExpression||(l._unwantedCharsRegularExpression=new RegExp("\\([^)]*\\)|[\\0-\\u001F\\!-/:-@\\[-`\\{-\\u00BF\\u0250-\\u036F\ud800-\\uFFFF]","g"))}static get phoneNumberRegExp(){return l._phoneNumberRegularExpression||(l._phoneNumberRegularExpression=new RegExp("^\\d+[\\d\\s]*(:?ext|x|)\\s*\\d+$","i"))}static get multipleWhitespaceRegExp(){return l._multipleWhitespaceRegularExpression||(l._multipleWhitespaceRegularExpression=new RegExp("\\s+","g"))}static get unsupportedTextRegExp(){return l._unsupportedTextRegularExpression||(l._unsupportedTextRegularExpression=new RegExp("[\\u0600-\\u06FF\\u0750-\\u077F\\u08A0-\\u08FF\\u1100-\\u11FF\\u3130-\\u318F\\uA960-\\uA97F\\uAC00-\\uD7AF\\uD7B0-\\uD7FF\\u3040-\\u309F\\u30A0-\\u30FF\\u3400-\\u4DBF\\u4E00-\\u9FFF\\uF900-\\uFAFF]|[\ud840-\ud869][\udc00-\uded6]"))}static get nbspRegExp(){return l._nbspRegExpression||(l._nbspRegExpression=new RegExp("","g"))}static get_htmlEncodeReplacements(){if(!l._htmlEncodeReplacements){const e="&<>'\"`",t=e.length;l._htmlEncodeReplacements=new Array(t);for(let n=0;n<t;n++){const t=new RegExp(e.charAt(n).toString(),"g");l._htmlEncodeReplacements[n]=new i.a(t,"&#"+l.charCodeAt(e,n)+";")}}return l._htmlEncodeReplacements}static get_htmlAttributeEncodeReplacements(){return l._htmlAttributeEncodeReplacements||(l._htmlAttributeEncodeReplacements=[i.a.createGlobalSearchFindReplacePair("&","&amp;"),i.a.createGlobalSearchFindReplacePair("<","&lt;"),i.a.createGlobalSearchFindReplacePair(">","&gt;"),i.a.createGlobalSearchFindReplacePair('"',"&quot;"),i.a.createGlobalSearchFindReplacePair("'","&#39;"),i.a.createGlobalSearchFindReplacePair("\r",""),i.a.createGlobalSearchFindReplacePair("\n","")])}static get_xmlEncodeReplacements(){return l._xmlEncodeReplacements||(l._xmlEncodeReplacements=[i.a.createGlobalSearchFindReplacePair("&","&amp;"),i.a.createGlobalSearchFindReplacePair("<","&lt;"),i.a.createGlobalSearchFindReplacePair(">","&gt;"),i.a.createGlobalSearchFindReplacePair("'","&apos;"),i.a.createGlobalSearchFindReplacePair('"',"&quot;")])}static get_htmlTextWhiteSpaceReplacements(){return l._htmlTextWhiteSpaceReplacements||(l._htmlTextWhiteSpaceReplacements=[i.a.createGlobalSearchFindReplacePair(" ",""),i.a.createGlobalSearchFindReplacePair("(?!)"," ")])}static get_httpHeaderSanitizationReplacements(){return l._httpHeaderSanitizationReplacements||(l._httpHeaderSanitizationReplacements=[i.a.createGlobalSearchFindReplacePair("\r",""),i.a.createGlobalSearchFindReplacePair("\n","")])}static areTextEqualIgnoreNbsp(e,t){return l.replaceNbsp(e)===l.replaceNbsp(t)}static replaceNbsp(e){return e?e.replace(l.nbspRegExp," "):null}static htmlEncode(e){return l.encodeString(e,l.get_htmlEncodeReplacements())}static htmlAttributeEncode(e){return l.encodeString(e,l.get_htmlAttributeEncodeReplacements())}static xmlEncode(e){return l.encodeString(e,l.get_xmlEncodeReplacements())}static getCssStyleFromDictionary(e){const t=new Sys.StringBuilder;for(const n in e){const a={key:n,value:e[n]};t.append(a.key),t.append(": "),t.append(a.value),t.append("; ")}return t.toString()}static encodeWhitespace(e){return l.encodeString(e,l.get_htmlTextWhiteSpaceReplacements())}static httpHeaderEncode(e){return l.encodeString(e,l.get_httpHeaderSanitizationReplacements())}static isValidWebImageProtocol(e){return!!e&&((e=l.toLower(e)).startsWith("http://")||e.startsWith("https://"))}static getFileNameWithoutExtension(e){if(!e)return null;const t=e.lastIndexOf(".");return t>=0&&t<e.length?e.substring(0,t):e}static getFileExtension(e){if(!e)return"";const t=e.lastIndexOf(".");return t>=0&&t<e.length?e.substring(t,e.length):""}static testGlobal(e,t){if(e.global){let n=!1;for(;e.test(t);)n=!0;return n}return e.test(t)}static matchGlobal(e,t){const n=[];let a=e.match(t);if(a&&Array.add(n,a),t.global)for(a=e.match(t);a;)Array.add(n,a),a=e.match(t);return n}static replaceAll(e,t,n){return e.replace(new RegExp(t,"g"),n)}static localeCompare(e,t){return e.localeCompare(t)-l._localeCompareOffset}static charAt(e,t){return e.charAt(t)}static tryGetCharAt(e,t){return!e||t<0||t>=e.length?null:e.substring(t,t+1)}static charCodeAt(e,t){return e.charCodeAt(t)}static codePointAt(e,t){return e.codePointAt(t)}static toUpper(e){return e.toUpperCase()}static toLower(e){return e.toLowerCase()}static toLowerForLocale(e,t){let n=e;return 1055!==t&&2092!==t&&1068!==t||(n=n.replace("I",""),n=n.replace("","i")),l.toLower(n)}static isLowerCase(e){return e.toLowerCase()===e}static isUpperCase(e){return e.toUpperCase()===e}static isNullOrEmpty(e){return!e}static removeAllWhitespace(e){let t="";for(let n=0;n<e.length;n++)l.isWhitespace(e.charCodeAt(n))||(t+=e.charAt(n).toString());return t}static indexOfWhiteSpace(e,t){if(!e)return-1;if((t=t<0?0:t)>=e.length)return-1;for(let n=t;n<e.length;n++)if(l.isWhitespace(e.charCodeAt(n)))return n;return-1}static lastIndexOfWhiteSpace(e,t){if(!e)return-1;if((t=t>e.length-1?e.length-1:t)<0)return-1;for(let n=t;n>=0;n--)if(l.isWhitespace(e.charCodeAt(n)))return n;return-1}static isEastAsianChar(e){return e>=19968&&e<=40959||e>=13312&&e<=19967||e>=12544&&e<=12591||e>=12352&&e<=12543||e>=4352&&e<=4607||e>=12592&&e<=12687||e>=44032&&e<=55203||e>=40960&&e<=42191}static isEastAsianCharExtended(e,t){return l.isCJKCharacter(l.codePointAt(e,t))}static isCJKCharacter(e){return l.isEastAsianChar(e)||e>=12688&&e<=12703||e>=63744&&e<=64255||e>=11904&&e<=12245||e>=12288&&e<=12351||e>=12032&&e<=12245||e>=131072&&e<=173791||e>=173824&&e<=177977||e>=177984&&e<=178205||e>=178208&&e<=183969||e>=183984&&e<=191456}static isThaiChar(e){return e>=3584&&e<=3711}static getHexString(e){return e.toString(16).toUpperCase()}static getInitials(e,t,n=!1){return e?(e=l.cleanupDisplayName(e),l.unsupportedTextRegExp.test(e)||!n&&l.phoneNumberRegExp.test(e)?"":l.getInitialsLatin(e,t)):""}static cleanupDisplayName(e){return(e=(e=e.replace(l.unwantedCharsRegExp,"")).replace(l.multipleWhitespaceRegExp," ")).trim()}static getInitialsLatin(e,t){let n="";const a=e.split(" ");return 2===a.length?(n+=a[0].charAt(0),n+=a[1].charAt(0)):3===a.length?(n+=a[0].charAt(0),n+=a[2].charAt(0)):a.length>0&&(n+=a[0].charAt(0)),t&&n.length>1&&(n=n.charAt(1)+""+n.charAt(0)),n.toUpperCase()}static stripPreTag(e){return e.replace(new RegExp("\\s*<pre>(.*)</pre>\\s*","i"),"$1")}static fromCharCode(e){return String.fromCharCode(e)}static from4CharCodes(e,t,n,a){return String.fromCharCode(e,t,n,a)}static escape(e){return escape(e)}static unescape(e){return unescape(e)}static right(e,t){return e.substr(t)}static substr(e,t,n){return e.substr(t,n)}static substring(e,t,n){return e.substring(t,n)}static trimToLength(e,t){return null===e?null:e.length>t?e.substring(0,t):e}static boundsToString(e){return e?"[L:"+e.x+", T:"+e.y+", R:"+(e.x+e.width)+", B:"+(e.y+e.height)+", W:"+e.width+", H:"+e.height+"]":""}static pointToString(e){return"("+e.x+","+e.y+")"}static padLeft(e,t,n){for(;e.length<t;)e=n+e;return e}static calcHashCode(e){if(!e)return 0;if(l._hashCodeCache[e])return l._hashCodeCache[e];let t=5381,n=t;const a=e.length;for(let i=0;i<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==a-1);i+=2)n=4294967295&((n<<5)+n^e.charCodeAt(i+1));let i=t+35685*n+(23896*n<<16)&4294967295;return i<0&&(i+=4294967296),l._hashCodeCache[e]=i,i}static formatNumberToString(e,t,n){let a;const i=e<0;if(6===t){a=l.generateAbsoluteValueString(e,n.percentDecimalDigits,n.percentDecimalSeparator,n.percentGroupSeparator,n.percentGroupSizes);const t=i?n.percentNegativePattern:n.percentPositivePattern;a=l.generatePercentString(a,n.percentSymbol,i,n.negativeSign,t)}else if(8===t){const t=new Array(2);t[0]=n.numberDecimalSeparator,a=l.generateTimespanString(e,t)}else a=l.generateAbsoluteValueString(e,n.numberDecimalDigits,n.numberDecimalSeparator,n.numberGroupSeparator,n.numberGroupSizes),a=l.generateNumberString(a,t,i,n.negativeSign,n.numberNegativePattern);return a}static generateAbsoluteValueString(e,t,n,a,i){let o="",r="";const s=Math.pow(10,t),l=Math.abs(Math.round(e*s)/s),c=Math.floor(l),d=(l*s-c*s)/s;if(c){const e=i.length;let t=0,n=c;for(;n>0;){const r=i[t];if(r){for(let e=0;e<r&&n>0;e++){o=(n%10).toString()+o,n=Math.floor(n/10)}n>0&&(o=a+o)}else o=n.toString()+o,n=0;t<e-1&&t++}}else o="0";let u="",p=Math.round(d*s)/s;for(let e=0;e<t;e++){const n=Math.floor(10*p);u+=n.toString();const a=Math.pow(10,t-e-1);p=Math.round(p*a*10-n*a)/a}let g=u.length;for(;g>0&&"0"===u.charAt(g-1);)g--;u=u.substring(0,Math.max(0,g)),""!==u&&(r+=n+u);return o+r}static generatePercentString(e,t,n,a,i){const o=l.placeholderForPercent(t,n,a,i);return String.format(o,e)}static generateTimespanString(e,t){return l.genTimeSpanFromSecond(e,t)}static generateNumberString(e,t,n,a,i){let o=e;if(n)switch(i){case 0:o="("+o+")";break;case 1:o=a+o;break;case 2:o=a+" "+o;break;case 3:o+=a;break;case 4:o=o+" "+a}return String.format(l.placeholderForNumberMeasurement(t),o)}static getExceptionMessage(e){const t=new Sys.StringBuilder,n=e.Exceptions;if(n&&n.length>0)for(const e of n)t.appendLine(e.message);else t.append(e.message);return t.toString()}static parseNumberAndUnitsFromString(e,t,n){let a,i;const o="[0-9]",r=o+"*"+("["+n.numberDecimalSeparator+"]")+"?"+o+"+",s=new RegExp(r,"g"),c=e.match(s);if(!c||1!==c.length)return a=Number.NaN,i=0,{number:a,unitType:i};let d="";const u=n.negativeSign;switch(n.numberNegativePattern){case 0:d="[(][ ]?"+r+"[ ]?[)]";break;case 1:case 2:d=u+"[ ]?"+r;break;case 3:case 4:d=r+"[ ]?"+u}const p=new RegExp(d,"g"),g=e.match(p),h=!!g;let m=h?e.replace(g[0],"{0}"):e.replace(c[0],"{0}");m=l.removeAllWhitespace(m),m=m.toLowerCase();let _=!1,S=0;if("{0}"===m)_=!0;else for(let e=0;e<t.length;e++){const a=t[e];let i="";if(6===a){const e=h?n.percentNegativePattern:n.percentPositivePattern;i=l.placeholderForPercent(n.percentSymbol,h,u,e)}else i=l.placeholderForNumberMeasurement(a);if(i=l.removeAllWhitespace(i),i=i.toLowerCase(),i===m){S=a,_=!0;break}}if(_){let e=(h?"-":"")+c[0];e=e.replace(n.numberDecimalSeparator,"."),a=parseFloat(e),i=isNaN(a)?0:S}else a=Number.NaN,i=0;return{number:a,unitType:i}}static placeholderForNumberMeasurement(e){let t="";switch(e){case 0:t="{0}";break;case 1:t=(0,s.a)("CentimeterUnitPlaceholder");break;case 2:t=(0,s.a)("CharacterUnitPlaceholder");break;case 3:t=(0,s.a)("InchUnitPlaceholder");break;case 4:t=(0,s.a)("LineUnitPlaceholder");break;case 5:t=(0,s.a)("PointUnitPlaceholder");break;case 7:t=(0,s.a)("PixelsUnitPlaceholder");break;case 9:t=(0,s.a)("DegreeUnitPlaceholder")}return t}static placeholderForPercent(e,t,n,a){let i="";if(t)switch(a){case 0:case 1:i=n+"{0}"+e;break;case 2:case 7:i=n+e+"{0}";break;case 3:case 10:i=e+n+"{0}";break;case 4:case 9:i=e+"{0}"+n;break;case 5:case 11:i="{0}"+n+e;break;case 6:case 8:i="{0}"+e+n}else switch(a){case 0:case 1:i="{0}"+e;break;case 2:case 3:i=e+"{0}"}return i}static isNumber(e){return!!l.ignoredNumbersCheck.exec(e)}static containsWhitespaceAtMost(e,t=0,n=-1){for(let a=t;a<n&&a<e.length;a++)if(!l.isWhitespace(e.charCodeAt(a)))return!1;return!0}static containsWhitespaceWithoutObjectReplacementSpace(e,t=0,n=-1){for(let a=t;a<n&&a<e.length;a++)if(65532===e.charCodeAt(a)||!l.isWhitespace(e.charCodeAt(a)))return!1;return!0}static genTimeSpanFromSecond(e,t){const n=Math.round(100*Math.abs(e)),a=Math.floor(n/100),i=n%100;return l.padLeft(a.toString(),2,"0")+t[0]+l.padLeft(i.toString(),2,"0")}static getRGBFromBGR(e){if(6!==e.length||!new RegExp("^[0-9A-F]{6}$","i").test(e))return e;return"#"+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}static cleanWhitespace(e){return e.replace(l.multipleWhitespaceRegExp,"")}}l.mailToProtocol="mailto:",l.notesUnescaped="notes:",l.notesEscaped="notes://",l.bookmarkAnchorPrefix="bookmark://",l.ignoredLinkCharsStart="(['\"",l.ignoredLinkCharsEnd="#%&*{}:<>?+.;(),!']\"",l._emailRegex=new RegExp("\\S+@\\S+\\.[\\w]+"),l._linkableProtocolList=null,l._urlKeyValueEncodeReplacements=null,l._romanOnes=null,l._romanTens=null,l._romanHundreds=null,l._hashCodeCache={},l._localeCompareOffset="A".localeCompare("A"),l._htmlEncodeReplacements=null,l._htmlAttributeEncodeReplacements=null,l._xmlEncodeReplacements=null,l._htmlTextWhiteSpaceReplacements=null,l._httpHeaderSanitizationReplacements=null,l._lineBreakRegularExpression=null,l._unwantedCharsRegularExpression=null,l._phoneNumberRegularExpression=null,l._multipleWhitespaceRegularExpression=null,l._unsupportedTextRegularExpression=null,l._nbspRegExpression=null,l.jsonEscapedCharacters=[new i.a(new RegExp("\\\\","g"),"\\\\"),new i.a(new RegExp('\\"',"g"),'\\"')],l.ignoredNumbersCheck=new RegExp("^[\\d\\s\\.\\,\\+\\-]+$"),(0,a.a)(l,"StringUtils",null,[])},1509:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(5149),o=n(9858);class r{static rotateLeft(e,t){return e<<t|e>>>32-t}static convertHex(e){const t=new Sys.StringBuilder;let n,a;for(n=7;n>=0;n--)a=e>>>4*n&15,t.append(a.toString(16));return t.toString()}static utf8Encode(e){e=e.replace("\r\n","\n");let t="";for(let n=0;n<e.length;n++){const a=o.a.charCodeAt(e,n);a<128?t+=o.a.fromCharCode(a):a>127&&a<2048?(t+=o.a.fromCharCode(a>>6|192),t+=o.a.fromCharCode(63&a|128)):(t+=o.a.fromCharCode(a>>12|224),t+=o.a.fromCharCode(a>>6&63|128),t+=o.a.fromCharCode(63&a|128))}return t}static generateSHA1(e){let t,n,a,i,s,l,c,d,u=1732584193,p=4023233417,g=2562383102,h=271733878,m=3285377520,_=0;const S=new Array(80),f=(e=r.utf8Encode(e)).length,C=[];for(t=0;t<f-3;t+=4)n=o.a.charCodeAt(e,t)<<24|o.a.charCodeAt(e,t+1)<<16|o.a.charCodeAt(e,t+2)<<8|o.a.charCodeAt(e,t+3),Array.add(C,n);switch(f%4){case 0:_=2147483648;break;case 1:_=o.a.charCodeAt(e,f-1)<<24|8388608;break;case 2:_=o.a.charCodeAt(e,f-2)<<24|o.a.charCodeAt(e,f-1)<<16|32768;break;case 3:_=o.a.charCodeAt(e,f-3)<<24|o.a.charCodeAt(e,f-2)<<16|o.a.charCodeAt(e,f-1)<<8|128}for(Array.add(C,_);C.length%16!=14;)Array.add(C,0);for(Array.add(C,f>>29),Array.add(C,f<<3&4294967295),a=0;a<C.length;a+=16){for(t=0;t<16;t++)S[t]=C[a+t];for(t=16;t<=79;t++)S[t]=r.rotateLeft(S[t-3]^S[t-8]^S[t-14]^S[t-16],1);for(i=u,s=p,l=g,c=h,d=m,t=0;t<=19;t++)_=r.rotateLeft(i,5)+(s&l|~s&c)+d+S[t]+1518500249&4294967295,d=c,c=l,l=r.rotateLeft(s,30),s=i,i=_;for(t=20;t<=39;t++)_=r.rotateLeft(i,5)+(s^l^c)+d+S[t]+1859775393&4294967295,d=c,c=l,l=r.rotateLeft(s,30),s=i,i=_;for(t=40;t<=59;t++)_=r.rotateLeft(i,5)+(s&l|s&c|l&c)+d+S[t]+2400959708&4294967295,d=c,c=l,l=r.rotateLeft(s,30),s=i,i=_;for(t=60;t<=79;t++)_=r.rotateLeft(i,5)+(s^l^c)+d+S[t]+3395469782&4294967295,d=c,c=l,l=r.rotateLeft(s,30),s=i,i=_;u=u+i&4294967295,p=p+s&4294967295,g=g+l&4294967295,h=h+c&4294967295,m=m+d&4294967295}const y=r.convertHex(u)+r.convertHex(p)+r.convertHex(g)+r.convertHex(h)+r.convertHex(m);return o.a.toLower(y)}}(0,a.a)(r,"SHA1",null,[]);class s{toString(){return this._uuid}equals(e){return!!e&&this._uuid===e.toString()}static get nameSpace_DNS(){return"6ba7b810-9dad-11d1-80b4-00c04fd430c8"}static get nameSpace_URL(){return"6ba7b811-9dad-11d1-80b4-00c04fd430c8"}static get nameSpace_OID(){return"6ba7b812-9dad-11d1-80b4-00c04fd430c8"}static get nameSpace_X500(){return"6ba7b814-9dad-11d1-80b4-00c04fd430c8"}static get nil(){return s._nilInstance||(s._nilInstance=new s("00000000-0000-0000-0000-000000000000"))}static createFromString(e){e=s.normalizeUuidString(e);return new s(e)}static createRaw(e){return new s(e||s.nil.toString(),!1)}static createV5Uuid(e){let t=r.generateSHA1(s.nameSpace_URL+e),n=parseInt(t.substring(16,17),16);n=3&n|8,t=t.substring(0,8)+"-"+t.substring(8,12)+"-5"+t.substring(13,16)+"-"+["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"][n]+t.substring(17,20)+"-"+t.substring(20,32);return new s(t)}static deriveFrom(e,t){const n=e._uuid.split("-"),a=t._uuid.split("-"),i=new Array(5);return i[0]=s.convertToHex(parseInt(n[0].substr(0,4),16)^parseInt(a[0].substr(0,4),16),4),i[0]+=s.convertToHex(parseInt(n[0].substr(4,4),16)^parseInt(a[0].substr(4,4),16),4),i[1]=s.convertToHex(parseInt(n[1],16)^parseInt(a[1],16),4),i[2]=s.convertToHex(parseInt(n[2],16)^parseInt(a[2],16),4),i[3]=s.convertToHex(parseInt(n[3],16)^parseInt(a[3],16),4),i[4]=s.convertToHex(parseInt(n[4].substr(0,4),16)^parseInt(a[4].substr(0,4),16),4),i[4]+=s.convertToHex(parseInt(n[4].substr(4,4),16)^parseInt(a[4].substr(4,4),16),4),i[4]+=s.convertToHex(parseInt(n[4].substr(8,4),16)^parseInt(a[4].substr(8,4),16),4),new s(i.join("-"))}static create(){const e=new Sys.StringBuilder;for(let t=0;t<4;t++){let n=Math.floor(4294967295*s.getRandomNumber());2===t&&(n=n%1073741824+2147483648),e.append(s.convertToHex(n,8))}const t=e.toString(),n=[t.substr(0,8),"-",t.substr(8,4),"-4",t.substr(12,3),"-",t.substr(16,4),"-",t.substr(20,12)];return new s(n.join(""))}static getRandomNumber(){let e,t="";window.self.crypto&&window.self.crypto.getRandomValues?t="crypto":window.self.msCrypto&&window.self.msCrypto.getRandomValues&&(t="msCrypto");const a=n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager?n(2274).AFrameworkApplication_AppSettingsManager.appSettingsManager.getIntAppSetting("MaxRandomUuidIterations",1e5):1e5;let o=0;do{if(o>a)throw Error.create("max random number generation iterations exceeded");if(""!==t)try{e=window.self[t].getRandomValues(new Uint32Array(1))[0]/4294967295}catch(n){s._errorLoggedInSession||(i.ULS.sendTraceTag(51447265,306,10,"crypto failed. fallback to random. exception: {0}",n),s._errorLoggedInSession=!0),t="",e=1}else e=Math.random();o++}while(1===e);return e}static convertToHex(e,t){let n=e.toString(16);for(;n.length<t;)n="0"+n;return n}static compare(e,t){return e.toString()===t.toString()}static isValid(e){try{if(36!==e.length)return!1;return 5===e.split("-").length}catch(e){return!1}}static normalizeUuidString(e){let t;return t=e.replace(" ",""),t=t.replace("{",""),t=t.replace("}",""),t=t.toLowerCase(),t}constructor(e,t=!0){this._uuid=t?s.isValid(e)?e:s.nil.toString():e}}s.uuidTotalCount=void 0,s._nilInstance=null,s._errorLoggedInSession=!1,(0,a.a)(s,"Uuid",null,[])},4051:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(3245);function i(e){const t="number"==typeof e?`Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_${e}_OnDemandTokenIsEnabled`:`Microsoft.Office.SharedOnline.ChangeGate.${e}`;return()=>!a.AFrameworkApplication.appSettingsManager||!a.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_9370010_OnDemandTokenIsEnabled")||!a.AFrameworkApplication.appSettingsManager.isChangeGateEnabled(t)}},5665:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static getInstance(){return i._singleton||i.setInstance(otel.TelemetryFactoryGlobal.createInstance()),i._singleton}static setInstance(e){if(!e)throw Error.argumentNull("telemetryLogger");i._singleton=e}static sendTelemetryEvent(e){i.getInstance().sendTelemetryEvent(e)}static sendDirectNumericEvent(e){i.getInstance().sendDirectNumericEvent(e)}static sendCustomerContentEvent(e){i.getInstance().sendCustomerContentEvent(e)}static sendActivityEvent(e){i.getInstance().sendActivityEvent(e)}static sendOtelEvent(e){i.getInstance().sendOtelEvent(e)}static sendOtelCustomerContent(e){i.getInstance().sendOtelCustomerContent(e)}static sendOtelDirectNumeric(e){i.getInstance().sendOtelDirectNumeric(e)}static sendUserActionEvent(e,t=window.event){i.interactivityTrackerLogger?.(e.actionName,t,e.actionId,e.parentName,e.triggerMethod,e.commandSurface),i.getInstance().sendUserActionEvent(e)}static sendTellMeUserActionEvent(e,t=""){e.name=i.getTellMeActivityName(e.actionName,t),i.sendUserActionEvent(e)}static sendTellMeActivityEvent(e,t=""){e.name=i.getTellMeActivityName(e.name,t),i.sendActivityEvent(e)}static getTellMeActivityName(e,t){let n="";return n=e&&e.length>0?"Office.TellMe."+t+e:"Office.TellMe."+t+"NoActionName",n}static addNamespaceMapping(e,t){i.getInstance().addNamespaceMapping(e,t)}static setDNMToken(e,t){i.getInstance().setDNMToken(e,t)}static setEnabledState(e){i.getInstance().setEnabledState(e)}static setOtelWorkerEnabledState(e,t){i.getInstance().setOtelWorkerEnabledState(e,t)}static registerEventHandler(e){i.getInstance().registerEventHandler(e)}static shutdown(){return i.getInstance().shutdown()}static startOtelWorker(){return i.getInstance().startOtelWorker()}static addSink(e){i.getInstance().addSink(e)}static hasValidLogger(){return i.getInstance().hasValidLogger()}static isMeasuresEnabled(){return i.getInstance().isMeasuresEnabled()}}i._singleton=null,(0,a.a)(i,"Telemetry",null,[])},8779:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e){this.MessageId=e,this.SendTime=0,this.CorrelationId="",this.Values={}}}(0,a.a)(i,"CrossDocumentMessage",null,[])},6566:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.refresh="refresh",(0,a.a)(i,"HostExecutableActions",null,[])},2650:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Postmessage.IHostPostmessenger")},8510:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get messageId(){return this._messageId}get values(){return this._values}get userSessionId(){return this._userSessionId}get shouldRetry(){return this._shouldRetry}get ackMessageId(){return this._ackMessageId}get maxAttempts(){return this._maxAttempts}get ackTimeoutMs(){return this._ackTimeoutMs}static createMessage(e,t,n){const a=new i;return a._messageId=e,a._values=t,a._userSessionId=n,a._shouldRetry=!1,a}static createRetriableMessage(e,t,n,a,o="Ack",r=1e3){const s=new i;return s._messageId=e,s._values=t,s._userSessionId=n,s._shouldRetry=!0,s._ackMessageId=o,s._maxAttempts=a,s._ackTimeoutMs=r,s}constructor(){this._messageId=null,this._values=null,this._userSessionId=null,this._shouldRetry=!1,this._ackMessageId=null,this._maxAttempts=0,this._ackTimeoutMs=0}}(0,a.a)(i,"PostMessageData",null,[])},5985:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=()=>!!window.self.postMessage},4908:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static sendTraceTagNoop(e,t,n,...a){}static debugAssertTagNoop(e,t,n=null,...a){}}i.sendTraceTag=i.sendTraceTagNoop,i.debugAssertTag=i.debugAssertTagNoop,(0,a.a)(i,"BULS",null,[])},1962:function(e,t,n){"use strict";n.d(t,{a:function(){return h}});var a=n(100),i=n(3245),o=n(9969),r=n(9858),s=n(1509);class l{constructor(e,t){this.message=e,this.eventArgs=t}}(0,a.a)(l,"CrossDocumentEventArgs",null,[]);var c=n(8779),d=n(5985),u=n(4908);const p="ACK_RECEIVED";class g{}g.test=void 0,g.unitTest=void 0,(0,a.a)(g,"CrossDocumentConstants",null,[]);class h{get targetOrigin(){return this._targetOrigin}get targetWindow(){return this._targetWindow}enable(){return d.a()?(this.internalEnableReceiving(),this.createReceivingAllowList(),this.createFreeSendingAllowList(),u.a.sendTraceTag(5018252,2,"Enabled."),!0):(u.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1)}isEnabled(){return this._enabled}internalEnableReceiving(){u.a.debugAssertTag(5018253,!!this._messageEventHandler,null),this._messageListener=this.messageListener,this._messageEventHandler.attachHandler(this._messageListener,null)}disable(){this._enabled=!1,this._receivingAllowList=[],this._freeReceivingAllowList=[],this._freeSendingAllowList=[],this._originAllowList=[],this._targetWindow=null,this._targetOrigin="",this._messageEventHandler.detachHandler(this._messageListener),this._messageCallbacks={},this._eventCallbacks={}}dispose(){this.disable()}createReceivingAllowList(){}createFreeSendingAllowList(){}isMessageReceivingAllowed(e){return!!this._receivingAllowList&&Array.contains(this._receivingAllowList,e)||this.isMessageFreeReceivingAllowed(e)}isMessageFreeReceivingAllowed(e){return!!this._freeReceivingAllowList&&Array.contains(this._freeReceivingAllowList,e)}addAllowedReceivingMessage(e){return u.a.debugAssertTag(5018259,!!this._receivingAllowList,null),Array.add(this._receivingAllowList,e),u.a.sendTraceTag(5018260,2,"Allow receiving : {0}",e),!0}addAllowedFreeReceivingMessage(e){return u.a.debugAssertTag(5018261,!!this._freeReceivingAllowList,null),Array.add(this._freeReceivingAllowList,e),u.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",e),!0}isMessageFreeSendingAllowed(e){return!!this._freeSendingAllowList&&Array.contains(this._freeSendingAllowList,e)}addAllowedFreeSendingMessage(e){return u.a.debugAssertTag(5018263,!!this._freeSendingAllowList,null),Array.add(this._freeSendingAllowList,e),u.a.sendTraceTag(5018264,2,"Allow free sending: {0}",e),!0}isOriginAllowed(e){const t=o.a.getOrigin(e);return!!t&&!!this._originAllowList&&Array.contains(this._originAllowList,t)}addAllowedOrigin(e){if(u.a.debugAssertTag(5018265,!!this._originAllowList,null),e===h.anyDomain)return u.a.debugAssertTag(5018266,!1,null),!1;let t=o.a.getOrigin(e);return t?(i.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(t=r.a.toLower(t)),Array.add(this._originAllowList,t),u.a.sendTraceTag(5018268,2,"Add origin:{0}",t),!0):(u.a.sendTraceTag(5018267,4,"Get origin fail:{0}",e),!1)}send(e,t=null){let n=this.targetOrigin;if(t){const e=o.a.getOrigin(t);if(!e)return!1;n=e}return this.sendToWindow(e,this.targetWindow,n)}sendMessage(e,t,n=""){return n=n&&""!==n?n:s.a.create().toString(),this.send(this.packMessage(e,t,n,i.AFrameworkApplication.userSessionId))}postMessage(e){const t=s.a.create().toString();if(!i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RetryablePostMessagingIsEnabled")||!e.shouldRetry)return this.send(this.packMessage(e.messageId,e.values,t,e.userSessionId));if(!this._messageCallbacks[e.ackMessageId]){this.addAllowedReceivingMessage(e.ackMessageId);const t=this.ackMessageHandler;this.registerCallback(e.ackMessageId,t)}return this._ackedMessages[t]="",this.postMessageInternal(e,t,1)}postMessageInternal(e,t,n){return""!==t&&t in this._ackedMessages&&this._ackedMessages[t]===p?(delete this._ackedMessages[t],!0):n>e.maxAttempts?(u.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',e.ackMessageId,t),delete this._ackedMessages[t],!1):(u.a.sendTraceTag(40716251,n>1?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',e.maxAttempts-n,e.messageId,t),n++,window.setTimeout((()=>{this.postMessageInternal(e,t,n)}),e.ackTimeoutMs),e.values.ackExpected=!0,this.send(this.packMessage(e.messageId,e.values,t,e.userSessionId)))}packMessage(e,t,n,a){const i=new c.a(e);return i.CorrelationId=n,t&&(i.Values=t),i.Values.wdUserSession=a,i}sendToWindow(e,t,n){if(u.a.debugAssertTag(5018269,!!e,null),!this._enabled)return!1;if(u.a.debugAssertTag(5018270,!!t,null),u.a.debugAssertTag(5018271,!!n,null),!t||!n)return u.a.debugAssertTag(5018272,!1,null),!1;if(n===h.anyDomain&&!this.isMessageFreeSendingAllowed(e.MessageId))return u.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{id:e.MessageId}),!1;const a=new Date;e.SendTime=a.getTime();let i="";try{i=Sys.Serialization.JavaScriptSerializer.serialize(e)}catch(e){return u.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{Exception:e.message}),!1}const o=h.sendMessage(t,i,n),r={id:e.MessageId,origin:n};return u.a.sendTraceTag(5018275,2,"Send {0}. {1}",o?"succeeded":"failed",r),o}registerCallback(e,t){return u.a.debugAssertTag(5018304,!!t,null),u.a.debugAssertTag(5018305,!!this._messageCallbacks&&!!this._eventCallbacks,null),!!this._enabled&&(this.isMessageReceivingAllowed(e)?(this._messageCallbacks[e]!==t&&(u.a.debugAssertTag(5018307,!this._messageCallbacks[e]&&!this._eventCallbacks[e],null),this._messageCallbacks[e]=t,delete this._eventCallbacks[e]),!0):(u.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{id:e}),!1))}registerEventCallback(e,t){return u.a.debugAssertTag(40420062,!!t,null),u.a.debugAssertTag(40420063,!!this._eventCallbacks&&!!this._messageCallbacks,null),!!this._enabled&&(this.isMessageReceivingAllowed(e)?(this._eventCallbacks[e]!==t&&(u.a.debugAssertTag(40420065,!this._messageCallbacks[e]&&!this._eventCallbacks[e],null),this._eventCallbacks[e]=t,delete this._messageCallbacks[e]),!0):(u.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{id:e}),!1))}unregisterCallback(e){return!!this._enabled&&(this._messageCallbacks[e]&&delete this._messageCallbacks[e],this._eventCallbacks[e]&&delete this._eventCallbacks[e],!0)}getMessageFromEvent(e){const t=new Date;if(this.logReceivedMessage(e),!e.origin||!e.source||void 0===e.data||null===e.data)return u.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const n=this.jsonStringToMessage(e.data);if(!n)return null;if(!this.isOriginAllowed(e.origin)){if(!this.isMessageFreeReceivingAllowed(n.MessageId))return u.a.sendTraceTag(5018309,1,"{0}",{id:n.MessageId}),null;if(e.source!==this.targetWindow)return u.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}return u.a.debugAssertTag(5018311,!!n.Values,null),n.Values.m_Source=e.source,n.Values.m_Origin=e.origin,n.Values.m_ReceivedTime=t.getTime(),n}jsonStringToMessage(e){if(!e)return null;let t=null;try{t=Sys.Serialization.JavaScriptSerializer.deserialize(e,!0)}catch(e){return h._deserFailureLogCount<2&&(u.a.sendTraceTag(5018312,2,"Deser failed"),h._deserFailureLogCount++),null}if(!t)return u.a.debugAssertTag(5018313,!1,null),null;for(let e=0;e<h.crossDocumentMessageRequiredFields.length;e++)if(!t[h.crossDocumentMessageRequiredFields[e]])return"MessageId"!==h.crossDocumentMessageRequiredFields[e]&&u.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",h.crossDocumentMessageRequiredFields[e]),null;if(t.Values)try{t.Values}catch(e){return u.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",e.message),null}else u.a.sendTraceTag(41502556,2,"No values in message");const n=t.MessageId;if(!this.isMessageReceivingAllowed(n))return u.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{id:n}),null;const a=t.SendTime,i=(new Date).getTime()-a;if(a<0)return u.a.sendTraceTag(520435660,2,"{0}",{t:a,id:n}),null;i>6e4&&u.a.sendTraceTag(520435659,2,"{0}",{t:a,delta:i,id:n}),i<-300&&u.a.sendTraceTag(520435658,2,"{0}",{t:a,delta:i,id:n});const o=new c.a;return o.MessageId=t.MessageId,o.SendTime=t.SendTime,o.CorrelationId=t.CorrelationId,t.Values&&(o.Values=t.Values),u.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",o.MessageId,o.SendTime,o.CorrelationId),o}logReceivedMessage(e){u.a.sendTraceTag(5018318,1,String.format("Received: {0}",{origin:e.origin,data:e.data,source:e.source}))}static sendMessage(e,t,n){if(!d.a())return u.a.debugAssertTag(5018319,!1,null),!1;try{return e.postMessage(t,n),!0}catch(e){u.a.sendTraceTag(5018320,4,"{0}",{exception:e.message})}return!1}constructor(e,t,n,a){this._name="",this._ackedMessages={},this._messageListener=null,this.ackMessageHandler=e=>{const t=e.CorrelationId;""!==t&&t in this._ackedMessages&&(u.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this._ackedMessages[t],t),this._ackedMessages[t]=p)},this.messageListener=e=>{const t=this.getMessageFromEvent(e);if(!t)return!1;if(this._messageCallbacks[t.MessageId]){const e=this._messageCallbacks[t.MessageId];return this._messageEventHandler.invokeCallback(e,t),!0}if(this._eventCallbacks[t.MessageId]){const n=this._eventCallbacks[t.MessageId],a=new l(t,e);return this._messageEventHandler.invokeEventCallback(n,a),!0}return!1},this._receivingAllowList=[],this._freeReceivingAllowList=[],this._freeSendingAllowList=[],this._originAllowList=[],this._targetWindow=e,this._targetOrigin=t,this._messageCallbacks={},this._eventCallbacks={},this._messageEventHandler=n,h._id++,a&&a(),this._enabled=this.enable()}}h.crossDocumentMessageRequiredFields=["MessageId","SendTime"],h.anyDomain="*",h._id=0,h._deserFailureLogCount=0,(0,a.a)(h,"CrossDocumentMessenger",null,[11,135])},6489:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(625),o=n(3894);class r extends o.a{executeRequest(){const e=this.get_webRequest();this.verifyRequestValidity(e),this._xmlHttpRequest=new XMLHttpRequest,this._xmlHttpRequest.onreadystatechange=(0,i.a)(this,this.onReadyStateChange,"onReadyStateChange"),this._xmlHttpRequest.open(e.get_httpVerb(),e.getResolvedUrl(),!0),this.setResponseType(!0),this._xmlHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.processXMLHttpRequest(e)}constructor(){super()}}(0,a.a)(r,"Common.AsynchronousXMLHttpExecutor",o.a,[])},3894:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(5149);class o extends Sys.Net.WebRequestExecutor{clearTimer(){this._timer&&(window.clearTimeout(this._timer),this._timer=0)}onReadyStateChange(){if(4===this._xmlHttpRequest.readyState){try{if(void 0===this._xmlHttpRequest.status)return void 0}catch(e){return void 0}this.clearTimer(),this._responseAvailable=!0,this.get_webRequest().completed(Sys.EventArgs.Empty),this._xmlHttpRequest&&(this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest=null)}}verifyRequestValidity(e){if(this._started)throw Error.invalidOperation(String.format(Sys.Res.cannotCallOnceStarted,"executeRequest"));if(!e)throw Error.argumentNull("webRequest",Sys.Res.nullWebRequest)}setResponseType(e){(e&&window.navigator.userAgent.indexOf("IEMobile/11")>=0||Sys.Browser.agent===Sys.Browser.InternetExplorer&&void 0!==window.document.documentMode&&window.document.documentMode>=10)&&(this._xmlHttpRequest.responseType="msxml-document",this._xmlHttpRequest.responseType||i.ULS.sendTraceTag(50406866,200,10,"BaseXMLHttpExecutor.SetResponseType: Failed to set to msxml-document."))}processXMLHttpRequest(e){let t=e.get_body();const n=e.get_headers();if(n)for(const e in n){const t={key:e,value:n[e]};"function"!=typeof t.value&&this._xmlHttpRequest.setRequestHeader(t.key,t.value)}"post"===e.get_httpVerb().toLowerCase()&&(n&&n["Content-Type"]||this._xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t=t||"");const a=e.get_timeout();a>0&&(this._timer=window.setTimeout(this.onTimeout,a)),this._xmlHttpRequest.send(t),this._started=!0}get_aborted(){return this._aborted}get_responseAvailable(){return this._responseAvailable}get_started(){return this._started}get_timedOut(){return this._timedOut}getResponseHeader(e){let t=null;try{t=this._xmlHttpRequest.getResponseHeader(e)}catch(e){}return t=t||"",t}getAllResponseHeaders(){return this._xmlHttpRequest.getAllResponseHeaders()}get_responseData(){return this._xmlHttpRequest.responseText}get_statusCode(){try{return this._xmlHttpRequest.status}catch(e){return 0}}get_statusText(){return this._xmlHttpRequest.statusText}get_xml(){let e=this._xmlHttpRequest.responseXML;if(e&&e.documentElement)-1!==window.navigator.userAgent.indexOf("MSIE")&&void 0!==e.setProperty&&e.setProperty("SelectionLanguage","XPath");else if(e=Sys.Net.XMLDOM(this._xmlHttpRequest.responseText),!e||!e.documentElement)return null;return"http://www.mozilla.org/newlayout/xml/parsererror.xml"===e.documentElement.namespaceURI&&"parsererror"===e.documentElement.tagName||e.documentElement.firstChild&&"parsererror"===e.documentElement.firstChild.tagName?null:e}abort(){this._aborted||this._responseAvailable||this._timedOut||(this._aborted=!0,this.clearTimer(),this._xmlHttpRequest&&!this._responseAvailable&&(this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest.abort(),this._xmlHttpRequest=null,this.get_webRequest().completed(Sys.EventArgs.Empty)))}constructor(){super(),this._responseAvailable=!1,this._timer=0,this._timedOut=!1,this._aborted=!1,this._started=!1,this._xmlHttpRequest=null,this.onTimeout=()=>{this.get_responseAvailable()||(this.clearTimer(),this._timedOut=!0,this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest.abort(),this.get_webRequest().completed(Sys.EventArgs.Empty),this._xmlHttpRequest=null)}}}(0,a.a)(o,"BaseXMLHttpExecutor",Sys.Net.WebRequestExecutor,[])},9784:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i extends Sys.Net.WebRequestExecutor{setbUlsImprovementEnable(e){this._bUlsImprovementEnable=!0}verifyRequestValidity(e){if(this._started)throw Error.invalidOperation(String.format(Sys.Res.cannotCallOnceStarted,"executeRequest"));if(!e)throw Error.argumentNull("webRequest",Sys.Res.nullWebRequest)}get_aborted(){return!1}get_responseAvailable(){return this._responseAvailable}get_started(){return this._started}get_timedOut(){return!1}executeRequest(){const e=this.get_webRequest();this.verifyRequestValidity(e);let t=e.get_body();const n={};if(e.get_headers()){const t=e.get_headers();for(const e in t){const a={key:e,value:t[e]};"function"!=typeof a.value&&(n[a.key]=a.value)}}"post"===e.get_httpVerb().toLowerCase()&&(n["Content-Type"]||(n["Content-Type"]="application/x-www-form-urlencoded"),t=t||""),n["X-Requested-With"]="Fetch";const a={};a.body=t,a.headers=n,a.method=e.get_httpVerb(),this.addRequestParams(a),this._bUlsImprovementEnable||(a.mode="same-origin"),this._bUlsImprovementEnable?window.fetch(e.getResolvedUrl(),a).then((e=>(this._responseAvailable=!0,this._response=e,e.text())),(e=>null)).then((e=>(this.updateDataAndMarkRequestCompleted(e),null)),(e=>(this.get_webRequest().completed(Sys.EventArgs.Empty),null))):window.fetch(e.getResolvedUrl(),a).then((e=>(this._response=e,e.text())),(e=>null)).then((e=>(this._responseAvailable=!0,this.updateDataAndMarkRequestCompleted(e),null)),(e=>null)),this._started=!0}getResponseHeader(e){let t="";return this._response.headers.has(e)&&(t=this._response.headers.get(e)),t}getAllResponseHeaders(){const e={};return this._response.headers.forEach(((t,n,a)=>{e[t]=n})),this._response.headers.toString(),JSON.stringify(e)}get_responseData(){return this._data}get_statusCode(){return this._response.status}get_statusText(){return this._response.statusText}get_xml(){return null}abort(){0}updateDataAndMarkRequestCompleted(e){this._enableFixForFetchExecutor?(this._data=e,this.get_webRequest().completed(Sys.EventArgs.Empty)):(this.get_webRequest().completed(Sys.EventArgs.Empty),this._data=e)}addRequestParams(e){}constructor(e=!1){super(),this._responseAvailable=!1,this._started=!1,this._response=null,this._data=null,this._bUlsImprovementEnable=!1,this._enableFixForFetchExecutor=!1,this._enableFixForFetchExecutor=e}}(0,a.a)(i,"FetchExecutor",Sys.Net.WebRequestExecutor,[])},9878:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(9784);class o extends i.a{addRequestParams(e){e.keepalive=!0}constructor(){super()}}(0,a.a)(o,"FetchKeepAliveExecutor",i.a,[])},5330:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(625),o=n(3894);class r extends o.a{executeRequest(){const e=this.get_webRequest();this.verifyRequestValidity(e),this._xmlHttpRequest=new XMLHttpRequest,Sys.Browser.agent!==Sys.Browser.Firefox&&(this._xmlHttpRequest.onreadystatechange=(0,i.a)(this,this.onReadyStateChange,"onReadyStateChange")),this._xmlHttpRequest.open(e.get_httpVerb(),e.getResolvedUrl(),!1),this.setResponseType(!1),this.processXMLHttpRequest(e),this._xmlHttpRequest&&Sys.Browser.agent===Sys.Browser.Firefox&&this.onReadyStateChange()}constructor(){super()}}(0,a.a)(r,"Common.SynchronousXMLHttpExecutor",o.a,[])},4345:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(5149);class o{}(0,a.a)(o,"ExtraInfo",null,[]);class r{}(0,a.a)(r,"PerfOperation",null,[]);class s{get isRunning(){return!!this._startTime}get ageInMilliseconds(){return this._startTime?(new Date).getTime()-this._startTime.getTime():0}get id(){throw Error.notImplemented()}start(){return this._startTime=new Date,this._endTime=null,null}stop(){if(this._startTime){const e=(new Date).getTime()-this._startTime.getTime();i.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",{Operation:this._operation,Target:this._target,StartTime:this._startTime.toUTCString(),DurationInMilliseconds:e})}}reset(){this.stop(),this._startTime=null,this._endTime=null}isNullOrEmpty(e){return!e||""===e}logPerfOperation(e){const t=Sys.Serialization.JavaScriptSerializer.serialize(e);i.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",t)}stopEx(e,t=!1){if(this._endTime||(this._endTime=new Date),this._startTime){const n=this._endTime.getTime()-this._startTime.getTime();if(!e)return void this.logPerfOperation(this.createPivotedPerfOperation(this._target,n,null));const a=this.createPivotedExtraInfo("All","All",e),i=this.createPivotedExtraInfo(e.PivotName,"All",e);t||this.logPerfOperation(this.createPivotedPerfOperation(this._target,n,a)),this.isNullOrEmpty(e.PivotName)||this.isNullOrEmpty(e.PivotValue)||(this.logPerfOperation(this.createPivotedPerfOperation(this._target+"_"+e.PivotName+e.PivotValue,n,e)),this.logPerfOperation(this.createPivotedPerfOperation(this._target+"_"+e.PivotName+i.PivotValue,n,i))),this.isNullOrEmpty(e.CompositeName)||(t||this.logPerfOperation(this.createPivotedPerfOperation(e.CompositeName,n+e.CompositeDurationInMilliseconds,a)),this.isNullOrEmpty(e.PivotName)||this.isNullOrEmpty(e.PivotValue)||(this.logPerfOperation(this.createPivotedPerfOperation(e.CompositeName+"_"+e.PivotName+e.PivotValue,n+e.CompositeDurationInMilliseconds,e)),this.logPerfOperation(this.createPivotedPerfOperation(e.CompositeName+"_"+e.PivotName+"All",n+e.CompositeDurationInMilliseconds,i))))}}createPivotedExtraInfo(e,t,n){return Object.assign(new o,{PivotName:e,PivotValue:t,CompositeDurationInMilliseconds:n.CompositeDurationInMilliseconds,CompositeName:n.CompositeName,ExtraInfoContext:n.ExtraInfoContext})}createPivotedPerfOperation(e,t,n){return Object.assign(new r,{Operation:this._operation,Target:e,StartTime:this._startTime.toUTCString(),DurationInMilliseconds:t,ExtraInfo:n})}constructor(e,t){this._startTime=null,this._endTime=null,this._operation=e,this._target=t}}(0,a.a)(s,"Stopwatch",null,[143,144])},459:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get politeRegion(){return this._politeRegion||(this._politeRegion=this._domContainer.appendChild(i.createLiveRegion(this.getFullId("PoliteNotifier"))))}get assertiveRegion(){return this._assertiveRegion||(this._assertiveRegion=this._domContainer.appendChild(i.createLiveRegion(this.getFullId("AssertiveNotifier"),"assertive")))}get alertRegion(){return this._alertRegion||(this._alertRegion=this._domContainer.appendChild(i.createLiveRegion(this.getFullId("AlertNotifier"),"assertive","alert")))}getLiveRegion(e){return this.getLiveRegionInternal(e,!1,!1)}sendNotification(e,t,n=!1){this.sendNotificationInternal(e,t,!1,n)}sendNonInteruptiveNotification(e){this.sendNotificationInternal(e,!0,!0,!1)}sendNotificationInternal(e,t,n,a){const i=this.getLiveRegionInternal(t,n,a);i.firstChild&&i.removeChild(i.firstChild),e&&i.appendChild(document.createTextNode(e))}getFullId(e){return String.format("{0}_{1}",this._domContainer.id,e)}getLiveRegionInternal(e,t,n){return t?(n&&this.disposeAlertRegion(),this.alertRegion):e?(n&&this.disposeAssertiveRegion(),this.assertiveRegion):(n&&this.disposePoliteRegion(),this.politeRegion)}disposePoliteRegion(){this._politeRegion&&(this._domContainer.removeChild(this._politeRegion),this._politeRegion=null)}disposeAssertiveRegion(){this._assertiveRegion&&(this._domContainer.removeChild(this._assertiveRegion),this._assertiveRegion=null)}disposeAlertRegion(){this._alertRegion&&(this._domContainer.removeChild(this._alertRegion),this._alertRegion=null)}dispose(){this._domContainer.removeChild(this._politeRegion),this._politeRegion=null,this._domContainer.removeChild(this._assertiveRegion),this._assertiveRegion=null,this._domContainer.removeChild(this._alertRegion),this._alertRegion=null}static createLiveRegion(e,t="polite",n="marquee",a=!0){const i=document.createElement("div");return i.id=e,i.setAttribute("role",n),i.setAttribute("aria-live",t),i.setAttribute("aria-atomic",a?"true":"false"),i.className="WACAriaLiveRegion",i}constructor(e){this._politeRegion=null,this._assertiveRegion=null,this._alertRegion=null,this._domContainer=e}}(0,a.a)(i,"AriaNotifier",null,[142,11])},9005:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static invalidOperation(e){return Error.invalidOperation(e)}static notImplemented(){return Error.notImplemented()}static argument(e,t=null){return Error.argument(t,e)}}(0,a.a)(i,"ExceptionFactory",null,[])},3888:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var a,i=n(100);!function(e){e[e.unknown=0]="unknown",e[e.excel=1]="excel",e[e.powerPoint=2]="powerPoint",e[e.word=3]="word",e[e.oneNote=4]="oneNote",e[e.visio=5]="visio"}(a||(a={})),(0,i.b)("OfficeAppType",a)},2280:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(5149),o=n(3299);var r=n(9005),s=n(625);class l{get isSingleton(){return this._isSingleton}get instance(){return this._instance}as(e){let t;return t="string"==typeof e?e:e.resolutionId,this.storeInRegistrationCache(t)}linkFuture(e){Array.add(this._futures,e)}singleInstance(){return this._isSingleton=!0,this}usingFactory(e){return this._factory=e,this}usingTypeResolver(e){return this.usingResolveCallback((0,s.a)(e,e.createInstance,"createInstance"))}usingResolveCallback(e){return this.usingFactory((()=>e(this._container,!1)))}internalCreate(){if(this.isSingleton){if(!this._instance){this._instance=this.createInstance();for(let e=0;e<this._futures.length;e++)this._futures[e].setInstance(this._instance)}return this._instance}return this.createInstance()}createInstance(){if(this._futures.length>0&&!this.isSingleton)throw r.a.invalidOperation("Futures can only be used for singleton types");let e;if(!this._factory){const e=String.format("Type '{0}' does not have a factory function. Did you overwrite the default with with null?",this._serviceName);throw r.a.invalidOperation(e)}if(this._factoryBeingCalled){const e=String.format("Type '{0}' contains a circular reference in the IoC container.",this._serviceName);throw r.a.invalidOperation(e)}this._factoryBeingCalled=!0;try{e=this._factory()}finally{this._factoryBeingCalled=!1}if(this._isContainerTelemetryEnabled){const e=String.format(" [RS: {0} T: {1}]",this._serviceName,this.getCurrentTime());this._container.logNewInstanceMetadata(e)}return e}storeInRegistrationCache(e){let t;return this._registrationCache.storeRegistration(e,this),({future:t}=this._registrationCache.tryLookupFuture(e)).returnValue&&this.linkFuture(t),this}getCurrentTime(){return(new Date).toISOString()}constructor(e,t,n,a,i){let o;if(this._instance=null,this._factoryBeingCalled=!1,this._futures=[],this._isSingleton=!1,this._container=e,this._registrationCache=t,this._factory=i,this._serviceName=a,this._registrationCache.storeRegistration(a,this),({future:o}=this._registrationCache.tryLookupFuture(a)).returnValue&&this.linkFuture(o),this._isContainerTelemetryEnabled=n,this._isContainerTelemetryEnabled){const e=String.format(" [RG: {0} T: {1}]",a,this.getCurrentTime());this._container.logNewInstanceMetadata(e)}}}(0,a.a)(l,"ContainerRegistration",null,[332,333]);class c{storeFuture(e,t){this._futureCache[e]=t}storeRegistration(e,t){const n=e;this._cache[n]=t}tryLookupFuture(e){let t;const n=e;return n in this._futureCache?(t=this._futureCache[n],{returnValue:!0,future:t}):(t=null,{returnValue:!1,future:t})}tryLookupRegistration(e){let t;return e in this._cache?(t=this._cache[e],{returnValue:!0,registration:t}):(t=null,{returnValue:!1,registration:t})}constructor(e=null){this._cache={},this._registrations=void 0,this._allowedDuplicateRegistrationsFunc_DEBUG=null,this._futureCache={}}}(0,a.a)(c,"ContainerRegistrationCache",null,[]);var d=n(334);class u{get future(){return this._future}setInstance(e){this.future.instance=e}constructor(e,t,n){let a;if(this._future=d.a.create(n),({registration:a}=t.tryLookupRegistration(e)).returnValue){if(!a.isSingleton)throw r.a.invalidOperation("Futures can only be used for singleton types");a.instance?this.setInstance(a.instance):a.linkFuture(this)}}}(0,a.a)(u,"FutureRegistration",null,[334]);class p{isContaninerTelemetryEnabled(){try{return window.g_isContainerTelemetryEnabled}catch(e){return!1}}registerOnDemandResolveToken(e,t){e.resolutionMetadata?._ignoreOnDemandRegister?.()?e.resolutionMetadata.onDemandRegister?e.resolutionMetadata.onDemandRegister(this,e.identifier.resolutionId):i.ULS.sendTraceTag(507123105,306,10,`Type '${e.identifier.resolutionId}' did not provide a onDemandResolveToken in its registration. This item should provide it during register or in the resolve token.`):(this.addTryResolveTokenMapping(e),t?.forEach((t=>{const n="string"==typeof t?t:t.resolutionId;this._identifierToResolveTokenMap[n]=e})))}addTryResolveTokenMapping(e){this._identifierToResolveTokenMap[e.identifier.resolutionId]=e}register(e,t){let n;return n="string"==typeof t?t:t.identifier.resolutionId,new l(this,this._registractionCache,this._isContainerTelemetryEnabled,n,(()=>new e))}registerFactory(e,t){let n;return n="string"==typeof e?e:e.identifier.resolutionId,new l(this,this._registractionCache,this._isContainerTelemetryEnabled,n,t)}registerUsingResolveCallback(e,t,n){return this.register(e,n).usingResolveCallback(t)}registerUsingTypeResolver(e,t,n){return this.register(e,n).usingTypeResolver(t)}async resolveAsync(e){let t;return t="string"==typeof e.identifier?e.identifier:e.identifier.resolutionId,e.resolutionMetadata.resolvesToAwait&&await Promise.all(e.resolutionMetadata.resolvesToAwait.map((e=>async()=>{await this.resolveFuture(e).waitToResolve()}))),e.resolutionMetadata?._hasResolved||e.resolutionMetadata?.onDemandSingleton&&this.registerFactory(t,(async()=>await e.resolutionMetadata.onDemandSingleton(this))).singleInstance(),await this.resolve(t)}resolveAsyncLazy(e){return async()=>await this.resolveAsync(e)}resolve(e,t){let n,a;if("string"==typeof e)a=this.getRootStringId(e,!t);else{const n=this.getRootResolveToken(e);a=n.identifier.resolutionId;const{resolutionMetadata:o}=n;o&&!o._hasResolved&&(o._hasResolved=!0,o.onDemandSingleton?this.registerFactory(a,(()=>o.onDemandSingleton(this))).singleInstance():o.onDemandRegister&&!o._ignoreOnDemandRegister?.()&&(t&&(this._problematicIoCResolves.includes(a+"-fromLookup")||(i.ULS.sendTraceTag(506053923,306,50,`The following type was onDemandRegister with a tryResolve. Please ensure that we can remove the registerOnDemandToken before feature cleanup: ${a}`),this._problematicIoCResolves.push(a+"-fromLookup"))),o.onDemandRegister(this,a)))}try{if(this._typeResolutionStack.push(a),!({registration:n}=this._registractionCache.tryLookupRegistration(a)).returnValue){const e=String.format("Type '{0}' is not registered in the IoC container. Make sure you have registered the type.",a);try{throw r.a.argument(e,"T")}catch(t){throw i.ULS.sendExceptionTraceTag(558453718,201,10,t,"Browser - {0} TypeResolutionStack: {1}",e,this._typeResolutionStack.join("->")),t}}return n.internalCreate()}finally{this._typeResolutionStack.pop()}}resolveFuture(e){let t,n;return n="string"==typeof e?this.getRootStringId(e):this.getRootIdentifier(e).resolutionId,({future:t}=this._registractionCache.tryLookupFuture(n)).returnValue||(t=new u(n,this._registractionCache,this.getTokenResolveFunction(e)),this._registractionCache.storeFuture(n,t)),t.future}resolveLazy(e){let t;return t="string"==typeof e?this.getRootStringId(e):this.getRootIdentifier(e).resolutionId,new o.a((()=>this.resolve(t)))}tryResolve(e){let t,n;return n="string"==typeof e?this.getRootStringId(e):this.getRootIdentifier(e).resolutionId,this._identifierToResolveTokenMap[n]?this.resolve(this._identifierToResolveTokenMap[n],!0):({registration:t}=this._registractionCache.tryLookupRegistration(n)).returnValue?t.internalCreate():null}async tryResolveAsync(e){return e.resolutionMetadata.conditionToResolve&&!await e.resolutionMetadata.conditionToResolve()?null:await this.resolveAsync(e)}getContainerLog(){return this._containerRegistrationLog}logNewInstanceMetadata(e){this._isContainerTelemetryEnabled&&(this._containerRegistrationLog+=e)}testCouldResolve(e){const t=e;return"string"==typeof t?this.isTypeNameRegistered(t):this.isTypeNameRegistered(t.resolutionId)}testCouldResolveType(e){const t=e.getName();return this.isTypeNameRegistered(t)}isTypeNameRegistered(e){let t;return({registration:t}=this._registractionCache.tryLookupRegistration(e)).returnValue}static getAnInstance(){return new o.a((()=>new p))}getTokenResolveFunction(e){return"string"!=typeof e&&"resolveFunction"in e&&"function"==typeof e.resolveFunction?()=>e.resolveFunction(this):void 0}getRootStringId(e,t=!0){return this._identifierToResolveTokenMap[e]?(t&&!this._problematicIoCResolves.includes(e+"-string")&&(i.ULS.sendTraceTag(505952332,306,50,`The following type resolved with a string id. Please ensure these cases are handled before feature cleanup: ${e}`),this._problematicIoCResolves.push(e+"-string")),this._identifierToResolveTokenMap[e].identifier.resolutionId!=e&&(this._problematicIoCResolves.includes(e+"-aliasString")||(i.ULS.sendTraceTag(506053922,306,50,`The following type resolved via an alias. Please ensure these cases are handled before feature cleanup: ${e} -> ${this._identifierToResolveTokenMap[e].identifier.resolutionId}`),this._problematicIoCResolves.push(e+"-aliasString"))),this._identifierToResolveTokenMap[e].identifier.resolutionId):e}getRootResolveToken(e){return this._identifierToResolveTokenMap[e.identifier.resolutionId]?(this._identifierToResolveTokenMap[e.identifier.resolutionId]!=e&&(this._problematicIoCResolves.includes(e.identifier.resolutionId+"-alias")||(i.ULS.sendTraceTag(506053921,306,50,`The following type resolved via an alias. Please ensure these cases are handled before feature cleanup: ${e.identifier.resolutionId} -> ${this._identifierToResolveTokenMap[e.identifier.resolutionId].identifier.resolutionId}`),this._problematicIoCResolves.push(e.identifier.resolutionId+"-alias"))),this._identifierToResolveTokenMap[e.identifier.resolutionId]):e}getRootIdentifier(e){return this._identifierToResolveTokenMap[e.resolutionId]?(this._identifierToResolveTokenMap[e.resolutionId].identifier!=e&&(this._problematicIoCResolves.includes(e.resolutionId+"-aliasIdentifier")||(i.ULS.sendTraceTag(506053920,306,50,`The following type resolved via an alias. Please ensure these cases are handled before feature cleanup: ${e.resolutionId} -> ${this._identifierToResolveTokenMap[e.resolutionId].identifier.resolutionId}`),this._problematicIoCResolves.push(e.resolutionId+"-aliasIdentifier"))),this._identifierToResolveTokenMap[e.resolutionId].identifier):e}static get instance(){return p._instance.value}constructor(){this.allowedDuplicateRegistrations_DEBUG=null,this._registractionCache=null,this._containerRegistrationLog="",this._problematicIoCResolves=[],this._identifierToResolveTokenMap={},this._typeResolutionStack=new Array(0),this._registractionCache=new c,this._isContainerTelemetryEnabled=this.isContaninerTelemetryEnabled()}}p._instance=p.getAnInstance(),(0,a.a)(p,"Container",null,[147])},3792:function(e,t,n){"use strict";n.d(t,{a:function(){return u},b:function(){return o},c:function(){return l},d:function(){return c},e:function(){return s},f:function(){return m},g:function(){return d},h:function(){return g},i:function(){return h},j:function(){return p}});var a=n(2280),i=n(2274);function o(e){return{resolutionId:e,container:a.a.instance}}function r(e,t){return{resolutionId:"string"==typeof e?e:e.resolutionId,resolveFunction:t}}function s(e,t){"string"==typeof e&&(e=o(e));return{identifier:e,resolutionMetadata:t}}function l(e,t,n,a=i.AFrameworkApplication_AppSettingsManager.appSettingsManager){return{flightId:e,syncToken:t,asyncTokenPromise:n,featureGateChecker:a}}function c(e,t){"string"==typeof e&&(e=r(e));return{identifier:e,resolutionMetadata:t}}async function d(e){return await a.a.instance.resolveAsync(e)}function u(e){return a.a.instance.resolve(e)}function p(e){return a.a.instance.tryResolve(e)}function g(e){return a.a.instance.resolveFuture(e)}function h(e){return a.a.instance.resolveLazy(e)}function m(e,t=!0){return t?e.featureGateChecker&&e.featureGateChecker.getBooleanFeatureGate(e.flightId,!1)?e.asyncTokenPromise().then((e=>d(e))):{then:t=>{t(a.a.instance.resolve(e.syncToken))}}:{then:e=>{e(null)}}}},334:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(3299),o=n(353),r=n(5367);class s{get instance(){return this._tcs&&this._tcs.task.isCompleted?this._tcs.task.result:null}set instance(e){e instanceof Promise?e.then((e=>this.taskCompletionSource.setResult(e))):this.taskCompletionSource.setResult(e)}get taskCompletionSource(){return this._tcs||(this._tcs=new o.a)}execute(e){this._beforeExecute&&!this._executeHasCalled&&(this._beforeExecute(),this._executeHasCalled=!0),this.taskCompletionSource.task.CWOo((t=>{e(t.result)}),r.a.none,8)}waitToResolve(){return this.waitToResolveLazy.value}doWaitToResolve(){return new Promise((e=>{this.execute((t=>e(t)))}))}static create(e){return new s(e)}constructor(e){this._tcs=null,this.waitToResolveLazy=new i.a((()=>this.doWaitToResolve())),this._beforeExecute=null,this._executeHasCalled=!1,e&&(this._beforeExecute=e)}}(0,a.a)(s,"Future",null,[149])},9611:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static getNameFromId(e){switch(e){case i.frame:return"Frame";case i.set:return"Set";case i.testApplication:case i.testFrame:case i.testView:}return null}}i.frame=2147483648,i.set=2147483649,i.testApplication=void 0,i.testFrame=void 0,i.testView=void 0,(0,a.a)(i,"CommonContextIds",null,[])},392:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(6776);class o{init(e){this._parentOperation=e,this._parentOperation?(this._startTime=this._parentOperation.startTime,e.setChildOperation(this),this._isSynchronous=this._parentOperation.isSynchronous):(this._startTime=new Date,this._isSynchronous=!1),this._isCompleted=!1,this._isCanceled=!1}get inProgress(){return!(this._isCompleted||this.isCanceled)}get isCanceled(){return this._isCanceled}setIsCanceled(){this._isCanceled=!0,this._endTime=new Date}get isCompleted(){return this._isCompleted}setIsCompleted(){this._isCompleted=!0,this._endTime=new Date}get isSynchronous(){return this._isSynchronous}set isSynchronous(e){this._isSynchronous=e}get startTime(){return this._startTime}get endTime(){return this._endTime}get childOperation(){return this._childOperation}get operationName(){return this._operationName}get activeChildOperation(){return this.childOperation&&this.childOperation.inProgress?this.childOperation:null}getOperationChainDescription(){let e="",t=this;for(;t;)e+=t.getOperationDescription(),t=t.childOperation;return e}getOperationDescription(){return this.operationName+"|"}get timeoutExceeded(){let e;if(this.isSynchronous||i.AFrameworkApplicationConstants.isShuttingDown)e=!1;else if(this._parentOperation)e=this._parentOperation.timeoutExceeded;else{e=(new Date).getTime()-this.startTime.getTime()>this.timeSliceLengthMs}return e}get hasYielded(){const{TaskManager:e}=n(657);return!this._isSynchronous&&e.instance.isYielding}setDebugName(e){this._operationName=e}setChildOperation(e){this._childOperation=e}clearChildOperation(){this._childOperation=null}yield(){const{TaskManager:e}=n(657);this._parentOperation?this._parentOperation.yield():e.instance.yield(this)}updateStartTime(){this._startTime=new Date,this.childOperation&&this.childOperation.updateStartTime()}recycle(){this._childOperation=null}constructor(){this.timeSliceLengthMs=o.defaultTimeSliceLengthMs,this._parentOperation=null,this._isCompleted=!1,this._isSynchronous=!1,this._operationName=null,this._isCanceled=!1,this._startTime=null,this._endTime=null,this._childOperation=null}}o.defaultTimeSliceLengthMs=200,(0,a.a)(o,"AOperation",null,[47])},4262:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(3245);class o{get endpoint(){return this._endpoint}get scenario(){return this._scenario}get scenarioType(){return this._scenarioType}static create(e,t,n){return new o(e,t,n)}static createFromAppType(e,t,n=0){return new o(o.getOfficeEndpointFromAppType(e),t,n)}static createForCurrentApp(e,t=0){let n=1;return i.AFrameworkApplication.activeFrame&&i.AFrameworkApplication.activeFrame.applicationInstance&&(n=o.getOfficeEndpointFromAppType(i.AFrameworkApplication.activeFrame.applicationInstance.officeAppType)),new o(n,e,t)}static getOfficeEndpointFromAppType(e){switch(e){case 3:return 6;case 1:return 2;case 2:return 4;case 4:return 3;case 5:return 5;default:return 1}}constructor(e,t,n=0){this._endpoint=e,this._scenario=t,this._scenarioType=n}}o.endpointParamName="haep",o.scenarioParamName="hascn",o.scenarioTypeParamName="hascnt",(0,a.a)(o,"HostAttributionInfo",null,[])},5018:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(1520),o=n(6996);class r{get hasSubscribers(){return this.recordedEvents.count>0}get events(){return this._events||(this._events=new Sys.EventHandlerList)}get recordedEvents(){return this._recordedEvents||(this._recordedEvents=new o.a)}dispose(){this._events=null,this._recordedEvents=null}addHandler(e,t){this.recordedEvents.containsKey(e)||this.recordedEvents.set_item(e,new i.a),this.events.addHandler(e,t),this.recordedEvents.get_item(e).add(t)}removeHandler(e,t){if(this.recordedEvents.containsKey(e)){const n=this.recordedEvents.get_item(e);n.remove(t)&&(this.events.removeHandler(e,t),n.count||this.recordedEvents.remove(e))}}raiseEvent(e,t=null,n=null){const a=this.events.getHandler(e);return!!a&&(a(n||this,t||Sys.EventArgs.Empty),!0)}constructor(){this._events=null,this._recordedEvents=null}}(0,a.a)(r,"EventSource",null,[11])},2998:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{performReplaceOn(e){return e&&""!==e?e.replace(this.findExpression,this.replaceValue):e}static createGlobalSearchFindReplacePair(e,t){return new i(new RegExp(e,"g"),t)}constructor(e,t){this.findExpression=e,this.replaceValue=t}}(0,a.a)(i,"FindReplacePair",null,[])},7995:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(1520),o=n(9974);class r{add(e,t){let n;for(n=0;n<this._list.count;++n){if(this._list.get_item(n).priority>e)break}this._list.insert(n,new o.a(e,t))}remove(e){for(let t=0;t<this._list.count;++t){if(this._list.get_item(t).data===e)return void this._list.removeAt(t)}}get length(){return this._list.count}get_item(e){return this._list.get_item(e).data}constructor(){this._list=new i.a}}(0,a.a)(r,"PriorityList",null,[])},9974:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get priority(){return this._priority}get data(){return this._data}constructor(e,t){this._priority=e,this._data=t}}(0,a.a)(i,"PriorityQueueEntry",null,[])},869:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static centimetersToEmu(e){return Math.round(e/i.cmPerInch*i.emuPerInch)}static centimetersToMu(e){return e/i.cmPerInch*i.muPerInch}static inchesToMu(e){return e*i.muPerInch}static twipsToMu(e){return e*i.muPerInch/i.twipsPerInch}static eightsToMu(e){return e*i.muPerInch/i.eighthsPerInch}static muToInches(e){return e/i.muPerInch}static iuToInches(e){return e/i.iuPerInch}static muToPoints(e){const t=Math.round(e*i.twipsPerInch/i.muPerInch);return i.twipsToPoints(t)}static inchesToIu(e){return e*i.iuPerInch}static twipsToInches(e){return e/i.twipsPerInch}static inchesToTwips(e){return Math.round(e*i.twipsPerInch)}static eightsToInches(e){return e/i.eighthsPerInch}static inchesToEighths(e){return Math.round(e*i.eighthsPerInch)}static inchesToCentimeters(e){return e*i.cmPerInch}static centimetersToInches(e){return e/i.cmPerInch}static twipsToCentimeters(e){return e*i.cmPerInch/i.twipsPerInch}static centimetersToTwips(e){return Math.round(e*i.twipsPerInch/i.cmPerInch)}static eighthsToCentimeters(e){return e*i.cmPerInch/i.eighthsPerInch}static centimetersToEighths(e){return Math.round(e*i.eighthsPerInch/i.cmPerInch)}static emuToInches(e){return e/i.emuPerInch}static emuToMu(e){return e*i.muPerInch/i.emuPerInch}static emuToTwips(e){return e*i.twipsPerInch/i.emuPerInch}static emuToEighths(e){return e*i.eighthsPerInch/i.emuPerInch}static inchesToEmu(e){return Math.round(i.emuPerInch*e)}static muToEmu(e){return Math.round(e*i.emuPerInch/i.muPerInch)}static twipsToEmu(e){return Math.round(e*i.emuPerInch/i.twipsPerInch)}static eighthsToEmu(e){return Math.round(e*i.emuPerInch/i.eighthsPerInch)}static twipsToPoints(e){return e/20}static pointsToTwips(e){return Math.round(20*e)}static eighthsToPoints(e){return e/8}static pointsToEighths(e){return Math.round(8*e)}static pointsToMu(e){const t=i.pointsToTwips(e);return i.twipsToMu(t)}static pointsToInches(e){return e/i.pointsPerInch}static twipsFromValueAndUnits(e,t){let n=0;switch(t){case 3:n=i.inchesToTwips(e);break;case 1:n=i.centimetersToTwips(e)}return n}static valueFromTwipsAndUnits(e,t){let n=0;switch(t){case 3:n=i.twipsToInches(e);break;case 1:n=i.twipsToCentimeters(e)}return n}static radiansToDegrees(e){return e*(180/Math.PI)}static degreesToRadians(e){return e*(Math.PI/180)}static convertStringToUnitType(e){let t=0;switch(e){case"none":t=0;break;case"centimeter":t=1;break;case"character":t=2;break;case"inch":t=3;break;case"line":t=4;break;case"point":t=5;break;case"percent":t=6;break;case"pixels":t=7;break;case"timespan":t=8;break;case"degree":t=9;break;default:0,t=0}return t}static convertUnitTypeToString(e){switch(e){case 0:default:return"None";case 1:return"Centimeter";case 2:return"Character";case 3:return"Inch";case 4:return"Line";case 5:return"Point";case 6:return"Percent";case 7:return"Pixels";case 8:return"Timespan";case 9:return"Degree"}}}i.iuPerInch=2540,i.muPerInch=2,i.emuPerInch=914400,i.twipsPerInch=1440,i.eighthsPerInch=576,i.cmPerInch=2.54,i.pointsPerInch=72,(0,a.a)(i,"UnitConversion",null,[])},1105:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(0,n(3792).b)("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")},3987:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.parentId=null}}(0,a.a)(i,"BuildContext",null,[])},2142:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.trimmedIds=null,this.clientID=null}}(0,a.a)(i,"BuildOptions",null,[])},5755:function(e,t,n){"use strict";n.d(t,{a:function(){return Xe}});var a=n(100),i=n(5149),o=n(3078),r=n(1432),s=n(3245),l=n(965),c=n(1196),d=n(869);class u{constructor(e,t){this.units=e,this.specialTextStrings=t}}(0,a.a)(u,"SpinnerChildren",null,[]);var p=n(8002);class g{constructor(){this.Color=null,this.DisplayColor=null,this.Title=null}}(0,a.a)(g,"ColorCellInfo",null,[]);var h=n(3360),m=n(3455),_=n(7072),S=n(7977),f=n(3180),C=n(6990),y=n(4710);class A extends y.a{constructor(e,t,n){super(e,t),this.elmSelectedItem=n}}(0,a.a)(A,"DropDownComponentDom",y.a,[]);var b=n(5699),T=n(1903),v=n(6662);class w extends m.a{get dropDownDom(){return this._dropDownDom}get additionalMenuCssClass(){return"cui-dd-menu"}get propertiesAlt(){return T.d(this.properties$2.Alt)?T.a:this.properties$2.Alt}createComponentDomForDisplayMode(e){let t;const n=v.a.createElement("span");n.className="cui-dd",n.setAttribute("mscui:controltype",this.controlType),v.a.addToTabLoop(n);const a=v.a.createElement("span");a.className="cui-dd-text",a.style.width=this.isSmallWidth(e)?this.properties$2.SmallWidth:this.properties$2.Width,a.setAttribute(_.a.ariaHiddenAttribute,_.a.ariaTrueValue);const i=this.stateProperties[C.a.SelectedItemId];if(!T.d(i)){this.selectDropdownItemById(i);0}const o=v.a.createElement("a");o.setAttribute(_.a.ariaHiddenAttribute,_.a.ariaTrueValue),v.a.ensureCSSClassOnElement(o,"cui-dd-arrow-button"),o.id=this.id;const r=v.a.createElement("img");return t=this.isVisualRefreshEnabled?v.a.createClusteredImageContainerNew(2,this.root.properties.ImageDownArrow8by8,this.root.properties.ImageDownArrow8by8Class,r,!0,!1):v.a.createClusteredImageContainerNew(1,this.root.properties.ImageDownArrow,this.root.properties.ImageDownArrowClass,r,!0,!1),o.setAttribute("title",this.propertiesAlt),a.title=this.propertiesAlt,r.alt=this.propertiesAlt,n.appendChild(a),n.appendChild(o),o.appendChild(t),this._dropDownDom=new A(e,n,a),this.dropDownDom}setInitialAriaMenuLauncherAttributes(e){_.a.setAriaAttribute(e,_.a.ariaRoleAttribute,this.ariaRole),super.setInitialAriaMenuLauncherAttributes(e)}get controlType(){return S.a.dropDownControlType}get selectedControl(){return this._selectedControl}selectDropdownItem(e){if(this.selectedControl===e)return;this._selectedControl=e,this.stateProperties[C.a.SelectedItemId]=e.getMenuItemId();const t=e.getTextValue(),n=v.a.createElement("a");if(n.innerText=t,this.dropDownDom&&this.dropDownDom.elmSelectedItem){const e=this.dropDownDom.elmSelectedItem;if(e.hasChildNodes()){const t=e.firstChild;e.replaceChild(n,t)}else e.appendChild(n);_.a.setAriaAttribute(this.dropDownDom.elmControl,_.a.ariaLabelAttribute,this.propertiesAlt+" "+t)}}getItemById(e,t){let n;if((0,o.a)(f.a,e)){const n=e;if((0,o.a)(172,n.control)){const e=n.control;if(e.getMenuItemId()===t)return e}}const a=e.children;if(!T.d(a))for(const e of a)if(n=this.getItemById(e,t),n)return n;return null}executeDropdownItem(e,t,n,a,i){return!1}selectDropdownItemById(e){let t=!1;if(!T.d(e)&&!T.d(this.menu)){const n=this.getItemById(this.menu,e);T.d(n)||(this.selectDropdownItem(n),t=!0)}return t}get properties$2(){return this.controlProperties}constructClonedMenuLauncher(e,t,n){return new w(e,this.id,t,n)}constructClonedMenuLauncherForMenu(e,t,n){return new b.a(e,this.id,t,n)}isSmallWidth(e){return!T.d(this.properties$2.SmallWidth)&&e.startsWith("Small")}constructor(e,t,n,a){super(e,t,n,a),this._dropDownDom=null,this._selectedControl=null,this.addDisplayMode("Medium"),this.addDisplayMode("MenuTellMe"),this.addDisplayMode("Small"),this.stateProperties[C.a.SelectedItemId]=null}}(0,a.a)(w,"DropDown",m.a,[]);var F=n(383),I=n(1892);class E extends y.a{constructor(e){super(e),this.elmInput=null,this.elmBtnA=null,this.elmArwImg=null}}(0,a.a)(E,"ComboBoxComponentDom",y.a,[]);class M extends w{get comboBoxDom(){return this._comboBoxDom}get allowFreeForm(){return this._allowFreeForm}get autoCompleteDelay(){return this._autoCompleteDelay}createComponentDomForDisplayMode(e){const t=T.d(this.cbProperties.Alt)?"":this.cbProperties.Alt;let n=null,a=null,i=null;const o=v.a.createElement("span");o.className="cui-cb",o.setAttribute("mscui:controltype",this.controlType);const r=v.a.createSelectableElement("input");r.type="text",r.style.width=this.isSmallWidth(e)?this.cbProperties.SmallWidth:this.cbProperties.Width,r.className="cui-cb-input",r.setAttribute("autocomplete","off"),r.setAttribute("data-lpignore","true"),r.setAttribute("data-lpignore","true"),r.id=this.cbProperties.Id,r.title=t,this.inMenu=f.a.isDisplayModeMenu(e),this.setInitialAriaMenuLauncherAttributes(r),"true"===this.cbProperties.FillContainer&&(v.a.ensureCSSClassOnElement(r,"cui-cb-fill-input"),v.a.ensureCSSClassOnElement(o,"cui-cb-fill-container")),v.a.addToTabLoop(r);const l=v.a.createElement("a");v.a.ensureCSSClassOnElement(l,"cui-dd-arrow-button"),l.tabIndex=-1,l.setAttribute("role","presentation");let c=!1;return!T.b(this.cbProperties.ArrowImgId)&&(i=document.getElementById(this.cbProperties.ArrowImgId),i&&(n=document.createElement("span"),n.appendChild(i),c=!0)),c||(a=v.a.createElement("img"),this.isVisualRefreshEnabled?s.AFrameworkApplication.activeFrame.applicationInstance.isInHighContrastMode()?(n=document.createElement("span"),F.a.renderIcon("CommonControlChevronDown_8",n),n.setAttribute("class","cui-img-8by8"),n.setAttribute("style","margin-top: -5px"),n.setAttribute("style","margin-left: -1px")):n=v.a.createClusteredImageContainerNew(2,this.root.properties.ImageDownArrow8by8,this.root.properties.ImageDownArrow8by8Class,a,!0,!1):n=v.a.createClusteredImageContainerNew(1,this.root.properties.ImageDownArrow,this.root.properties.ImageDownArrowClass,a,!0,!1)),a&&(a.alt=t),l.title=t,o.appendChild(r),o.appendChild(l),l.appendChild(n),this._comboBoxDom=new E(e),this.comboBoxDom.elmControl=o,this.comboBoxDom.elmInput=r,this.comboBoxDom.elmBtnA=l,this.comboBoxDom.elmArwImg=i||a,this.comboBoxDom.elmIconContainer=n,this.comboBoxDom}ensureKeytipForControl(e,t){e.ensureKeytip(t,this.comboBoxDom.elmInput,this.parentKeytipsIds,this.parentKeytipsKeys)}get controlType(){return S.a.comboBoxControlType}get ariaRole(){return _.a.ariaComboboxRole}get menuItems(){return T.d(this._menuItems)&&(this._menuItems={}),this._menuItems}set menuItems(e){this._menuItems=e}get focusableElement(){return this.comboBoxDom?this.comboBoxDom.elmInput:null}selectDropdownItem(e){this.selectedControl!==e&&(this._selectedControl=e,this.comboBoxDom.elmInput.value=e.getTextValue(),this.behavior.isCommitChangeFixEnabled&&!this.allowFreeForm&&(this.stateProperties[I.a.Value]=e.getTextValue()))}commitPendingChange(){this.behavior.commitPendingChange()}get cbProperties(){return this.controlProperties}constructClonedMenuLauncher(e,t,n){return new M(e,this.id,t,n)}get isEditable(){return!0}constructor(e,t,n,a){if(super(e,t,n,a),this._comboBoxDom=null,this._allowFreeForm=!1,this._autoCompleteDelay=0,this._menuItems=null,T.d(this.cbProperties.AllowFreeForm)?this._allowFreeForm=!1:this._allowFreeForm="true"===this.cbProperties.AllowFreeForm.toLowerCase(),T.b(this.cbProperties.AutoComplete)&&(this.cbProperties.AutoComplete="true"),!T.b(this.cbProperties.AutoCompleteDelay))try{this._autoCompleteDelay=parseInt(this.cbProperties.AutoCompleteDelay)}catch(e){this._autoCompleteDelay=100}}}(0,a.a)(M,"ComboBox",w,[]);var k=n(1163);class P extends y.a{constructor(e){super(e),this.elmA=null}}(0,a.a)(P,"GalleryButtonComponentDom",y.a,[]);class D{buildControlDom(e,t){const n=new P(t);return({elmDefault:n.elmControl,elmDefaultA:n.elmA,elmDefaultImage:n.elmImage,elmDefaultImageCont:n.elmIconContainer}=this.buildGalleryButtonElements(e,t)),n}buildGalleryButtonElements(e,t){let n,a;const i=e.properties,o=T.d(i.Alt)?"":i.Alt,r=!T.d(i.InnerHTML),s=v.a.createElement(r?"div":"span");s.setAttribute("mscui:controltype",e.controlType),s.className="cui-gallerybutton cui-gallerybutton-"+v.a.galleryElementDimensionsToSizeString[e.elementDimensions],s.setAttribute("role","presentation");const l=v.a.createElement(r?"div":"a");if(e.shouldIgnoreTitle||(l.title=o),l.className="cui-gallerybutton-a",l.setAttribute(_.a.ariaRoleAttribute,e.ariaRole),n=null,a=null,T.d(i.Alt)||e.shouldIgnoreTitle||(l.title=i.Alt),r?l.tabIndex=0:v.a.addToTabLoop(l),s.appendChild(l),i.VerticalCenterAlign&&this.setAttributeToCenterAlignVertically(l),r)l.innerHTML=i.InnerHTML,v.a.setUnselectable(l,!0,!0);else{if(T.d(i.Image))throw Error.create("InnerHTML or Image must be defined for this GalleryButton");let t=7;switch(e.elementDimensions){case 1:t=4;break;case 2:t=6;break;case 3:t=7;break;case 5:t=8;break;case 6:t=9;break;case 9:t=5;break;case 10:t=15;break;case 11:t=13;break;case 12:t=12;break;case 13:t=16;break;case 14:t=17;break;case 16:t=19}n=v.a.createElement("img"),a=v.a.createClusteredImageContainerNew(t,i.Image,i.ImageClass,n,!0,!1),n.alt=o,l.appendChild(a)}return{elmDefault:s,elmDefaultA:l,elmDefaultImage:n,elmDefaultImageCont:a}}setAttributeToCenterAlignVertically(e){e.style.display="table",k.a.isSafari4Up&&(e.style.width="100%",e.style.height="100%")}}(0,a.a)(D,"GalleryButtonDomStrategy",null,[]);var R=n(5503);class x extends S.a{get ariaRole(){return this.inMenu?_.a.ariaGridCellRole:super.ariaRole}createComponentDomForDisplayMode(e){this.inMenu=f.a.isDisplayModeMenu(e);const t=new D;return this.componentDom=t.buildControlDom(this,e),this._displayMode=e,this.componentDom}get controlType(){return S.a.galleryButtonControlType}get focusableElement(){return this.componentDom?this.componentDom.elmA:null}get activatesOnPress(){return!0}getTextValue(){return this.properties.Alt}onStateChanged(){const e=this.stateProperties[R.a.On],t=this.stateProperties[R.a.IsRtl];v.a.toggleCSSClassOnElement(this.componentDom.elmControl,"cui-gallerybutton-highlighted",e),v.a.toggleCSSClassOnElement(this.componentDom.elmA,"cui-gallerybutton-a-ltr",1===t),v.a.toggleCSSClassOnElement(this.componentDom.elmA,"cui-gallerybutton-a-rtl",2===t);const n=this.inMenu?_.a.ariaSelectedAttribute:_.a.ariaPressedAttribute;_.a.setAriaAttribute(this.componentDom.elmA,n,e?_.a.ariaTrueValue:_.a.ariaFalseValue)}get properties(){return this.controlProperties}constructClonedControl(e,t){return new x(e,this.id,t,this.elementDimensions)}constructClonedControlForMenu(e,t){return s.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.Office_constructClonedControlForMenu")?null:new p.a(e,this.id,t)}constructor(e,t,n,a){super(e,t,n),this.componentDom=null,this._displayMode=null,this.classname="GalleryButton",this.addDisplayMode("Large"),this.addDisplayMode("Menu"),this.addDisplayMode("MenuTellMe"),this.elementDimensions=a}}(0,a.a)(x,"GalleryButton",S.a,[172]);var L=n(6522),U=n(7158),O=n(6912);class B extends U.a{buildControlDom(e,t){const n=S.a.createOuterElement("cui-menuloading",e);n.setAttribute("aria-label",e.controlProperties.LabelText);const a=new O.a("");return n.appendChild(a.element),new y.a(t,n)}constructor(){super()}}(0,a.a)(B,"LoadingIndicatorLabelDomStrategy",U.a,[]);var N=n(6094),W=n(5474);const H="cui-ctl-mediumlabel";class V extends U.a{get focusableElement(){return this._innerLinkElement}get properties(){return this._control.controlProperties}buildControlDom(e,t){this._control=e;const n=this.getSubsectionLabelClass(t),a=S.a.createOuterElement(n,e),i=this.properties.LabelCss;if(T.d(i)||(a.style.cssText=i),"MenuSaveButton"===t||"MenuDiagnostics"===t){const t=v.a.createElement("span");if(t.appendChild(document.createTextNode(this.properties.LabelText)),t.className=String.format("{0} {1}",H,"cui-btn-title"),(0,o.a)(W.a,e.root)||(t.className+=" UIFontBold"),t.style.display="block",a.appendChild(t),this.properties.Description){const e=v.a.createElement("span");e.appendChild(document.createTextNode(this.properties.Description)),e.className="cui-btn-menu-description UIFont",a.appendChild(e),e.style.display="block"}}else this.updateElementInternal(a,this.properties.LabelText);const r=new y.a(t,a,this);return r.elmLabel=a,r}getSubsectionLabelClass(e){let t;switch(e){case"MenuFileName":t="cui-ctl-filenamelabel cui-menusection-filenametitle";break;case"MenuDiagnostics":t=String.format("{0} {1}","cui-menusection-diagnostics-label",H);break;default:t=String.format("{0} {1}",H,"cui-menusection-subsectiontitle"),(0,o.a)(W.a,this._control.root)||"MenuSaveButton"!==e||(t+=" cui-ctl-menu")}return t}updateLabel(e,t){return this.updateElementInternal(e,t),!0}updateElementInternal(e,t){t?(e.style.display="block",this._innerLinkElement=this.updateChildDomElements(e,t)):e.style.display="none"}updateChildDomElements(e,t){N.a.clearElement(e);let n=null;const a=t.split("{0}");return this.concateChildNodesWithBr(e,a[0]),n=this.appendLinkChildNode(e),a.length>1&&this.concateChildNodesWithBr(e,a[1]),n}concateChildNodesWithBr(e,t){const n=t.split("\n");for(const t of n){const n=document.createElement("span");n.innerText=t,e.appendChild(n);const a=document.createElement("br");e.appendChild(a)}const a=e.lastChild;e.removeChild(a)}appendLinkChildNode(e){let t=null;if(this.properties.InnerLink&&this.properties.InnerLinkText){t=v.a.createElement("a"),t.className="cui-subsectionlabellink",t.href=this.properties.InnerLink,t.target="_blank";const n=this.properties.InnerLinkTitle;n&&n.length>0&&(t.title=n),t.appendChild(document.createTextNode(this.properties.InnerLinkText)),e.appendChild(t)}return t}constructor(){super(),this._innerLinkElement=null,this._control=null}}(0,a.a)(V,"MenuSubsectionLabelDomStrategy",U.a,[]);var G=n(3823),Q=n(3896);class q extends U.a{buildControlDom(e,t){const n=(new Q.a).buildControlDom(e,t),a=f.a.isDisplayModeMenu(t),i="MediumCompact"===t;return this.setCssClasses(n.elmControl,a,i),this.setAccessibilityInfo(n.elmControl,a),this.setImageBackgroundColor(n.elmImage,e.controlProperties.ImageBackColor),this.setLabelForTarget(n.elmLabel,e.controlProperties.For),n}setCssClasses(e,t,n){e.className=n?"cui-fslb cui-ctl-compact":"cui-fslb",t&&(v.a.ensureCSSClassOnElement(e,"cui-ctl-menu"),v.a.ensureCSSClassOnElement(e,"cui-ctl-menu16"))}setAccessibilityInfo(e,t){e.tabIndex=-1,t||_.a.setAriaAttribute(e,"aria-hidden","true"),e.title=""}setImageBackgroundColor(e,t){e&&""!==t&&(e.style.backgroundColor=t)}setLabelForTarget(e,t){e&&!T.b(t)&&e.setAttribute("for",t)}constructor(){super()}}(0,a.a)(q,"StandardLabelDomStrategy",U.a,[]);class K extends S.a{get focusableElement(){return this._focusableElement}createComponentDomForDisplayMode(e){let t=null;const n=this.getDomElementCreationStrategy(e);return n&&(t=n.buildControlDom(this,e),this._focusableElement=n.focusableElement),t}getDomElementCreationStrategy(e){switch(e){case"MenuMru":case"MenuTemplate":case"MenuSaveAs":case"MenuFileName":case"MenuSaveButton":case"MenuDiagnostics":return new V;case"MenuLoading":return new B;default:return new q}}get controlType(){return S.a.labelControlType}constructClonedControl(e,t){return new K(e,this.id,t)}constructor(e,t,n){super(e,t,n),this._focusableElement=null,this.classname="Label",this.addDisplayMode("Medium"),this.addDisplayMode("Medium14"),this.addDisplayMode("MediumCompact"),this.addDisplayMode("Small"),this.addDisplayMode("Small14"),this.addDisplayMode("Menu"),this.addDisplayMode("Menu16"),this.addDisplayMode("MenuMru"),this.addDisplayMode("MenuLoading"),this.addDisplayMode("MenuTemplate"),this.addDisplayMode("MenuTellMe"),this.addDisplayMode("MenuSaveAs"),this.addDisplayMode("MenuFileName"),this.addDisplayMode("MenuSaveButton"),this.addDisplayMode("MenuDiagnostics"),this.stateProperties[G.a.Visible]=this.visible}}(0,a.a)(K,"Label",S.a,[]);class z extends S.a{ensureValidDisplayMode(e){}createComponentDomForDisplayMode(e){return this._element=v.a.createElement("span"),this._element.className="cui-ctl cui-placeholder",new y.a(e,this._element)}get controlType(){return S.a.placeholderControlType}pollForStateAndUpdate(){}dispose(){super.dispose(),this._element=null}get properties(){return this.controlProperties}constructClonedControl(e,t){return new z(e,this.id,t)}constructor(e,t,n){super(e,t,n),this._element=null}}(0,a.a)(z,"Placeholder",S.a,[]);var j=n(625),Z=n(8326),X=n(9531),J=n(8585),Y=n(6012),$=n(5072),ee=n(2544),te=n(9855),ne=n(459);class ae{interactionEnd(){this._input.value=""}constructor(e){this._input=e}}(0,a.a)(ae,"ClearInputOnInteractionEndModule",null,[]);class ie{onInputBlur(e,t){return this.executeCommand(this._properties.InputBoxBlurCommand,t),!1}onInputFocus(e,t){return this.executeCommand(this._properties.InputBoxFocusCommand,t),!1}onInteractionBegin(e,t){return this._properties.InteractionBeginCommand&&this.executeCommand(this._properties.InteractionBeginCommand,null),!1}onRestoreFocus(e,t){return this._keyboardingState.escaping&&this.executeCommand(this._properties.RestoreFocusCommand,null),!1}executeCommand(e,t){const n=t?t.inputSource:0;this._root.executeCommand(e,{},this._getControlComponent(),n,!1)}constructor(e,t,n,a){this._root=e,this._properties=t,this._getControlComponent=n,this._keyboardingState=a}}(0,a.a)(ie,"FocusBlurEventsToCommandsAdapter",null,[]);var oe=n(629);class re{setFocus(e){return!(!this._searchBox.menuLaunched||!this._searchBox.menu)&&(this._searchBox.menu.setFocus(e),!0)}closeMenuStack(){this._searchBox.closeMenuStack()}blurInputField(){return oe.FocusManager.tryBlur(this._searchBox.inputField)}get escaping(){return this._searchBox.escaping}set escaping(e){this._searchBox.escaping=e}get processingKeystroke(){return this._searchBox.processingKeystroke}set processingKeystroke(e){this._searchBox._processingKeystroke=e}constructor(e){this._searchBox=e}}(0,a.a)(re,"FocusableMenu",null,[520]);class se{onKeyDown(e,t){if(!t||!t.innerEvent)return!1;const n=t.innerEvent.keyCode;return this.shouldMoveFocusToMenu(n)?this._target.setFocus(t.inputSource):n===$.a.vK_Escape?(this._target.escaping=!0,this._target.closeMenuStack(),this._target.blurInputField()):(n===$.a.vK_Tab&&(this._target.processingKeystroke=!0,this._target.closeMenuStack()),!1)}shouldMoveFocusToMenu(e){return e===$.a.vK_Enter||e===$.a.vK_Down}constructor(e){this._target=e}}(0,a.a)(se,"KeyboardNavigationModule",null,[]);class le{get escaping(){return this._searchBox.escaping}set escaping(e){this._searchBox.escaping=e}constructor(e){this._searchBox=e}}(0,a.a)(le,"KeyboardState",null,[521]);class ce{onInputKeyUp(e,t){let n=!1;return this._adapter.processingKeystroke=!0,this.textChanged()&&(this._adapter.inputText.trim()===ce.defaultValue&&this._adapter.closeMenuStack(),this.updateMenu(t.inputSource),n=!0),this._adapter.processingKeystroke=!1,n}updateMenu(e){this._oldInputText=this._adapter.inputText,this._adapter.pollForResults(e)}onSearchButtonClick(e,t){return this._adapter.focusSearchbox()}onInteractionBegin(){this.updateMenu(0)}onInteractionEnd(){this.updateMenu(0)}textChanged(){return this._oldInputText!==this._adapter.inputText}constructor(e){this._oldInputText=ce.defaultValue,this._adapter=e}}ce.defaultValue="",(0,a.a)(ce,"MenuUpdateModule",null,[]);class de{onInputBlur(e,t){return""===this._input.value&&(this._input.value=this._placeHolderText,this._placeholderTextActive=!0,v.a.ensureCSSClassOnElement(this._input,this._cssClass)),!1}onInputFocus(e,t){return this._placeholderTextActive&&(this._input.value="",this._placeholderTextActive=!1,v.a.removeCSSClassFromElement(this._input,this._cssClass)),!1}constructor(e,t,n){this._placeholderTextActive=!1,this._input=e,this._placeHolderText=t,this._cssClass=n,this.onInputBlur(null,null)}}(0,a.a)(de,"PlaceholderTextModule",null,[]);class ue{closeMenuStack(){this._searchBox.closeMenuStack()}pollForResults(e){this._searchBox.pollForResults(e)}focusSearchbox(){return oe.FocusManager.tryFocus(this._searchBox.inputField)}get inputText(){return this._searchBox.inputText}get processingKeystroke(){return this._searchBox.processingKeystroke}set processingKeystroke(e){this._searchBox._processingKeystroke=e}constructor(e){this._searchBox=e}}(0,a.a)(ue,"SeachBoxToUpdateableMenu",null,[522]);class pe{addHandler(e){Array.add(this._handlers,e)}removeHandler(e){Array.remove(this._handlers,e)}raiseEvent(e,t){for(const n of this._handlers)if(n&&n(t,e))return!0;return!1}constructor(){this._handlers=[]}}(0,a.a)(pe,"EventChain",null,[]);class ge{addHandler(e,t){this._eventMap[e]||(this._eventMap[e]=new pe),this._eventMap[e].addHandler(t)}removeHandler(e,t){this._eventMap[e]&&this._eventMap[e].removeHandler(t)}raiseEvent(e,t,n){const a=this._eventMap[e];return!!a&&a.raiseEvent(t,n)}dispose(){this._eventMap=null}constructor(){this._eventMap={}}}(0,a.a)(ge,"SearchBoxEventSource",null,[11]);class he extends m.a{get topLevelElement(){return this._topLevelElement}get inputField(){return this._inputField}get inputHasFocus(){return this._inputHasFocus}get mouseIsOver(){return this._mouseIsOver}get searchBoxBehavior(){return this.behavior}get additionalMenuCssClass(){return"cui-sb-menu"}get controlType(){return S.a.searchBoxControlType}get ariaRole(){return"SearchBox"}createComponentDomForDisplayMode(e){this._topLevelElement=v.a.createElement("span"),v.a.ensureCSSClassOnElement(this.topLevelElement,"cui-sb");const t=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMeRedesignIsEnabled");return t&&v.a.ensureCSSClassOnElement(this.topLevelElement,"tellme-flight"),this.topLevelElement.setAttribute("mscui:controltype",this.controlType),v.a.addToTabLoop(this.topLevelElement),this.topLevelElement.tabIndex=-1,this._inputField=v.a.createSelectableElement("input"),v.a.ensureCSSClassOnElement(this.inputField,"cui-sb-input"),this.inputField.setAttribute("data-lpignore","true"),t&&v.a.ensureCSSClassOnElement(this.inputField,"tellme-flight"),this.inputField.type="text",this.inputField.setAttribute("Autocomplete","off"),this.inputField.style.width=this.sbProperties.Width,this.inputField.id=this.sbProperties.Id,this.inputField.title=this.sbProperties.Alt,this.inputField.setAttribute("maxlength","256"),this.inputField.setAttribute("tabindex","0"),this._searchButton=v.a.createElement("a"),this._searchButton.setAttribute(_.a.ariaHiddenAttribute,_.a.ariaTrueValue),this._searchButton.id=this.id+"-icon",this._searchButton.tabIndex=-1,this.searchIcon=v.a.createElement("img"),this._ariaNotifier=new ne.a(this.topLevelElement),v.a.ensureCSSClassOnElement(this._searchButton,"cui-sb-image-button"),t&&v.a.ensureCSSClassOnElement(this._searchButton,"tellme-flight"),this._currentImageClass=t?this.sbProperties.DarkImage16by16Class:this.sbProperties.Image16by16Class,this._imageMask=v.a.createClusteredImageContainerNew(4,this.sbProperties.Image16by16,this._currentImageClass,this.searchIcon,!0,!1),v.a.ensureCSSClassOnElement(this._imageMask,"sb-img"),t&&this.topLevelElement.appendChild(this._searchButton),this._searchButton.appendChild(this._imageMask),this.topLevelElement.appendChild(this.inputField),t||this.topLevelElement.appendChild(this._searchButton),this.attachEvents(),this.attachModules(),new y.a(e,this.topLevelElement)}ensureKeytipForControl(e,t){e.ensureKeytip(t,this.inputField,this.parentKeytipsIds,this.parentKeytipsKeys)}attachModules(){const e=new ce(new ue(this));this.add_onInputKeyUp((0,j.a)(e,e.onInputKeyUp,"onInputKeyUp")),this.add_onSearchButtonClick((0,j.a)(e,e.onSearchButtonClick,"onSearchButtonClick"));const t=new ie(this.root,this.sbProperties,(()=>this.displayedComponent),new le(this));this.add_onInputBlur((0,j.a)(t,t.onInputBlur,"onInputBlur")),this.add_onInputFocus((0,j.a)(t,t.onInputFocus,"onInputFocus")),this.add_onInteractionBegin((0,j.a)(t,t.onInteractionBegin,"onInteractionBegin")),this.add_onInteractionEnd((0,j.a)(t,t.onRestoreFocus,"onRestoreFocus"));const n=new se(new re(this));this.add_onInputKeyDown((0,j.a)(n,n.onKeyDown,"onKeyDown"));const a=new ae(this.inputField);if(this.add_onInteractionEnd(he.actionToEventDelegate((0,j.a)(a,a.interactionEnd,"interactionEnd"))),this.add_onInteractionEnd(he.actionToEventDelegate((0,j.a)(e,e.onInteractionEnd,"onInteractionEnd"))),this.add_onInteractionBegin(he.actionToEventDelegate((0,j.a)(e,e.onInteractionBegin,"onInteractionBegin"))),"placeholder"in this.inputField)this.inputField.setAttribute("placeholder",this.sbProperties.PlaceholderText);else{const e=new de(this.inputField,this.sbProperties.PlaceholderText,"cui-sb-placeholder");this.add_onInputBlur((0,j.a)(e,e.onInputBlur,"onInputBlur")),this.add_onInputFocus((0,j.a)(e,e.onInputFocus,"onInputFocus"))}this.add_onMenuChange(this.onMenuChangedAriaNotification),this.add_onInputKeyDown(((e,t)=>v.a.preventDefaultKeyAction(t,$.a.vK_Esc))),this.add_onInputKeyDown(((e,t)=>m.a.prototype.onKeyDown.call(this,t))),this.add_onInputKeyUp(((e,t)=>S.a.prototype.onKeyUp.call(this,t)))}attachEvents(){X.a.instance.registerHandler(Y.a.focus,this.inputField,(0,j.a)(this,this.onInputBoxFocus,"onInputBoxFocus")),X.a.instance.registerHandler(Y.a.blur,this.inputField,(0,j.a)(this,this.onInputBoxBlur,"onInputBoxBlur")),ee.a.instance.registerHandler(Y.a.keyDown,this.inputField,(0,j.a)(this,this.onKeyDown,"onKeyDown")),ee.a.instance.registerHandler(Y.a.keyUp,this.inputField,(0,j.a)(this,this.onKeyUp,"onKeyUp")),te.a.instance.registerHandler(Y.a.pointerOver,this.topLevelElement,(0,j.a)(this,this.onSearchContainerMouseOver,"onSearchContainerMouseOver")),te.a.instance.registerHandler(Y.a.pointerOut,this.topLevelElement,(0,j.a)(this,this.onSearchContainerMouseOut,"onSearchContainerMouseOut")),J.a.instance.registerHandler(Y.a.click,this._searchButton,(0,j.a)(this,this.onButtonClick,"onButtonClick"))}raiseEvent(e,t){this._eventSource.raiseEvent(e,t)}addHandler(e,t){this._eventSource.addHandler(e,t)}removeHandler(e,t){this._eventSource.removeHandler(e,t)}add_onInputBlur(e){this.addHandler("Blur",e)}remove_onInputBlur(e){this.removeHandler("Blur",e)}add_onInputFocus(e){this.addHandler("Focus",e)}remove_onInputFocus(e){this.removeHandler("Focus",e)}add_onInputKeyUp(e){this.addHandler("KeyUp",e)}remove_onInputKeyUp(e){this.removeHandler("KeyUp",e)}add_onInputKeyDown(e){this.addHandler("KeyDown",e)}remove_onInputKeyDown(e){this.removeHandler("KeyDown",e)}add_onSearchButtonClick(e){this.addHandler("Click",e)}remove_onSearchButtonClick(e){this.removeHandler("Click",e)}add_onMenuChange(e){this.addHandler("MenuChanged",e)}remove_onMenuChange(e){this.removeHandler("MenuChanged",e)}add_onInteractionBegin(e){this.addHandler("InteractionBegin",e)}remove_onInteractionBegin(e){this.removeHandler("InteractionBegin",e)}add_onInteractionEnd(e){this.addHandler("InteractionEnd",e)}remove_onInteractionEnd(e){this.removeHandler("InteractionEnd",e)}onSearchContainerMouseOver(e){return this._mouseIsOver=!0,this.searchBoxBehavior&&this.searchBoxBehavior.onSearchContainerMouseOver(e),!1}onSearchContainerMouseOut(e){return this._mouseIsOver=!1,this.searchBoxBehavior&&this.searchBoxBehavior.onSearchContainerMouseOut(e),!1}onInputBoxBlur(e){return this._inputHasFocus=!1,this.searchBoxBehavior&&this.searchBoxBehavior.onInputBoxBlur(e),!1}onInputBoxFocus(e){return this._inputHasFocus=!0,this.escaping=!1,this._processingKeystroke=!1,this._ariaNotifier.sendNotification("",!1),this.searchBoxBehavior&&this.searchBoxBehavior.onInputBoxFocus(e),!1}onKeyUp(e){return this.searchBoxBehavior&&this.searchBoxBehavior.raiseInteractionBegin(),this._eventSource.raiseEvent("KeyUp",e)}onKeyDown(e){return this.searchBoxBehavior&&this.searchBoxBehavior.raiseInteractionBegin(),this._eventSource.raiseEvent("KeyDown",e)}onButtonClick(e){return this.searchBoxBehavior&&this.searchBoxBehavior.raiseInteractionBegin(),this._eventSource.raiseEvent("Click",e)}onMenuChanged(){this._eventSource.raiseEvent("MenuChanged",null)}launchMenu(e){super.launchMenu(e)}closeMenu(e=!0){this.searchBoxBehavior&&this.searchBoxBehavior.closeMenu()}closeMenuStack(){this.menuLaunched&&this.root.closeMenuStack(this),this.searchBoxBehavior&&this.searchBoxBehavior.raiseInteractionEnd()}pollForResults(e){this.sendNotifyAsyncMenuTrigger(),this.pollForDynamicMenu(e)}refreshMenu(){this.menuLaunched?super.refreshMenu():this.inputHasFocus&&this.launchMenu(0)}getCommandPopulateProperties(){const e={};return e.Value=this.inputField.value,e}get inputText(){return this.inputField.value}set inputText(e){this.inputField.value=e}get processingKeystroke(){return this._processingKeystroke}get sbProperties(){return this.controlProperties}getAccessibiltyText(){const e={};return this.root.executeCommand(this.sbProperties.AccessibilityTextCommand,e,this.displayedComponent,0,!1),e.Value}doDefaultAction(e,t,n){const a={};a.Value=this.inputField.value,this.root.executeCommand(this.sbProperties.Command,a,this.displayedComponent,t,!1)}get focusableElement(){return this.inputField}notifyCommandExecuted(e,t){if(this.searchBoxBehavior){const n=this.sbProperties.MenuControlExecutedCommand;this.searchBoxBehavior.notifyCommandExecuted(e,t,this.topLevelElement,n)}}constructClonedMenuLauncher(e,t,n){return new he(e,this.id,t,n)}get isEditable(){return!0}static actionToEventDelegate(e){return(t,n)=>(e(),!1)}constructor(e,t,n,a){super(e,t,n,a),this._topLevelElement=null,this._inputField=null,this._imageMask=null,this._searchButton=null,this.searchIcon=null,this._ariaNotifier=null,this._currentImageClass=null,this._inputHasFocus=!1,this._mouseIsOver=!1,this._processingKeystroke=!1,this.escaping=!1,this.onMenuChangedAriaNotification=(e,t)=>(this._ariaNotifier.sendNotification(this.getAccessibiltyText(),!1),!1),this.addDisplayMode("Medium"),this._sendFocusToMenuDrop=!1,t===Z.a.tellMeSearchBoxId&&(this.stateProperties.TakeFocusOnMenuNavigationEnd=!0),this._eventSource=new ge}}he.maxCharacterLimit=256,(0,a.a)(he,"SearchBox",m.a,[]);class me extends S.a{createComponentDomForDisplayMode(e){return this._elmSmall=v.a.createElement("span"),this._elmSmall.className="cui-separator",new y.a(e,this._elmSmall)}get controlType(){return S.a.separatorControlType}pollForStateAndUpdate(){this.enabled=!0}dispose(){super.dispose(),this._elmSmall=null}get properties(){return this.controlProperties}constructClonedControl(e,t){return new me(e,this.id,t)}constructor(e,t,n){super(e,t,n),this._elmSmall=null,this.addDisplayMode("Small")}}(0,a.a)(me,"Separator",S.a,[]);class _e extends y.a{constructor(e){super(e),this.elmInput=null}}(0,a.a)(_e,"SliderComponentDom",y.a,[]);class Se extends S.a{get sliderDom(){return this._sliderDom}createComponentDomForDisplayMode(e){return this._sliderDom=this.buildSliderDom(e),this.sliderDom}buildSliderDom(e){const t=v.a.createElement("span");t.className="cui-sldr",t.setAttribute("mscui:controltype",this.controlType);const n=v.a.createSelectableElement("input");n.type="range",n.className="cui-sldr-input",n.id=this.controlProperties.Id,n.value=this.controlProperties.Value;const a=v.a.createElement("span");a.className="cui-ctl-largelabel",v.a.setLargeControlText(a,this.controlProperties.LabelText,!1),a.id=this.controlProperties.LabelId,t.appendChild(n),t.appendChild(a);const i=new _e(e);return i.elmControl=t,i.elmInput=n,i.elmLabel=a,i}get controlType(){return S.a.sliderControlType}constructClonedControl(e,t){return new Se(e,this.id,t)}constructor(e,t,n){super(e,t,n),this._sliderDom=null,this.addDisplayMode("Large")}}(0,a.a)(Se,"Slider",S.a,[]);class fe extends y.a{constructor(e){super(e),this.elmInput=null,this.elmUpArrow=null,this.elmDownArrow=null,this.elmUpArrowImageContainer=null,this.elmDownArrowImageContainer=null,this.elmUpArrowImage=null,this.elmDownArrowImage=null}}(0,a.a)(fe,"SpinnerComponentDom",y.a,[]);class Ce{normalizeNumber(e){return e<this._min?this._min:e>this._max?this._max:e}get type(){return this._type}get min(){return this._min}get max(){return this._max}set max(e){this._max=e}get step(){return this._step}constructor(e,t,n,a){this._type=e,this._min=t,this._max=n,this._step=a}}(0,a.a)(Ce,"Unit",null,[]);class ye extends S.a{get spinnerDom(){return this._spinnerDom}get validUnits(){return this._validUnits}get validSpecialStrings(){return this._validSpecialStrings}createComponentDomForDisplayMode(e){return this._spinnerDom=this.buildSpinnerDom(e),this.spinnerDom}ensureKeytipForControl(e,t){e.ensureKeytip(t,this.spinnerDom.elmInput,this.parentKeytipsIds,this.parentKeytipsKeys)}buildSpinnerDom(e){let t,n;const a=v.a.createElement("span");a.className="cui-spn",a.setAttribute("mscui:controltype",this.controlType),a.setAttribute(_.a.ariaRoleAttribute,_.a.ariaPresentationRole);const i=v.a.createSelectableElement("input");i.className="cui-spn-txtbx",i.id=this.id,i.setAttribute("role","spinbutton"),i.setAttribute("type","text"),i.setAttribute("autocomplete","off"),i.setAttribute("data-lpignore","true"),a.appendChild(i);const o=v.a.createElement("span");o.className="cui-spn-arwbx",a.appendChild(o);const r=v.a.createElement("span");r.className="cui-spn-btnup",r.setAttribute(_.a.ariaHiddenAttribute,"true"),o.appendChild(r);const l=v.a.createElement("span");l.className="cui-spn-btndown",l.setAttribute(_.a.ariaHiddenAttribute,"true"),o.appendChild(l);const c=v.a.createElement("img");c.alt="";1===this.root.textDirection&&(i.style.direction="rtl"),this.isVisualRefreshEnabled?s.AFrameworkApplication.activeFrame.applicationInstance.isInHighContrastMode()?(t=v.a.createElement("span"),F.a.renderIcon("CommonControlChevronUp_8",t),t.setAttribute("class","cui-img-8by8"),s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Fluent2StyleIsEnabled")?t.setAttribute("style","margin-top: -7px"):t.setAttribute("style","margin-top: -5px")):t=v.a.createClusteredImageContainerNew(2,this.root.properties.ImageUpArrow8by8,this.root.properties.ImageUpArrow8by8Class,c,!0,!1):t=v.a.createClusteredImageContainerNew(1,this.root.properties.ImageUpArrow,this.root.properties.ImageUpArrowClass,c,!0,!1),v.a.ensureCSSClassOnElement(t,"cui-spn-imgcnt"),r.appendChild(t);const d=v.a.createElement("img");d.alt="",this.isVisualRefreshEnabled?s.AFrameworkApplication.activeFrame.applicationInstance.isInHighContrastMode()?(n=v.a.createElement("span"),F.a.renderIcon("CommonControlChevronDown_8",n),n.setAttribute("class","cui-img-8by8"),s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Fluent2StyleIsEnabled")?n.setAttribute("style","margin-top: -7px"):n.setAttribute("style","margin-top: -5px")):n=v.a.createClusteredImageContainerNew(2,this.root.properties.ImageDownArrow8by8,this.root.properties.ImageDownArrow8by8Class,d,!0,!1):n=v.a.createClusteredImageContainerNew(1,this.root.properties.ImageDownArrow,this.root.properties.ImageDownArrowClass,d,!0,!1),v.a.ensureCSSClassOnElement(n,"cui-spn-imgcnt"),l.appendChild(n);const u=this.properties.Alt;T.d(u)||(i.title=u);const p=this.properties.Width;T.d(p)||(i.style.width=p);const g=new fe(e);g.elmControl=a,g.elmInput=i,g.elmUpArrow=r,g.elmDownArrow=l,g.elmUpArrowImage=c,g.elmDownArrowImage=d,g.elmUpArrowImageContainer=t,g.elmDownArrowImageContainer=n;const h=this.properties.LabelledBy;return T.d(h)||i.setAttribute("aria-labelledby",h),g}get controlType(){return S.a.spinnerControlType}get needsAKeytip(){return!0}get focusableElement(){return this.spinnerDom?this.spinnerDom.elmInput:null}get properties(){return this.controlProperties}commitPendingChange(){this.behavior&&this.behavior.commitPendingChange()}constructClonedControl(e,t){return new ye(e,this.id,t,this.validUnits,this.validSpecialStrings)}get isEditable(){return!0}static createUnit(e,t,n,a){return new Ce(e,t,n,a)}constructor(e,t,n,a,i){super(e,t,n),this._spinnerDom=null,this.addDisplayMode("Medium"),this._validUnits=a,this._validSpecialStrings=i,this.behavior&&this.behavior.initialize()}}(0,a.a)(ye,"Spinner",S.a,[]);class Ae extends y.a{onImageLoad(){this.internalImageLoadHandler()}internalImageLoadHandler(){}constructor(e){super(e),this.elmButtonPart=null,this.elmMenuLauncherPart=null}}(0,a.a)(Ae,"SplitButtonComponentDom",y.a,[]);class be{buildControlDom(e,t){const n=new Ae(t);return this.populateControlDom(n,e,t),n}populateControlDom(e,t,n){let a,i,o;const r=({buttonElement:a,menuLauncherElement:i,buttonImageElement:o}=be.createTwoAnchorControlDOMElement(t,t.root,n,t.properties$2,!0)).returnValue;$addHandler(o,"load",(()=>{e.onImageLoad()})),e.elmControl=r,e.elmImage=o,e.elmButtonPart=a,e.elmMenuLauncherPart=i}static createTwoAnchorControlDOMElement(e,t,n,a,i){let o=a.LabelText;T.d(o)&&(o="");const r=v.a.createElement("span");r.className="Large"===n?"cui-ctl-large":"Medium"===n?"cui-ctl cui-ctl-medium":"Medium20"===n?"cui-ctl cui-ctl-medium20 cui-ctl-medium":"cui-ctl cui-ctl-small",r.setAttribute("mscui:controltype",e.controlType),r.setAttribute("aria-expanded","false");const s=v.a.createNoOpLink(),l=v.a.createNoOpLink();s.className="cui-ctl-a1",l.className="cui-ctl-a2",r.setAttribute("role",e.ariaRole),_.a.setAriaAttribute(r,"aria-haspopup","true"),s.setAttribute("role","button"),l.setAttribute("role","button"),l.setAttribute("aria-expanded","false"),_.a.setAriaAttribute(l,"aria-haspopup","true");const c=v.a.createElement("span");c.className="cui-ctl-a1Internal";const d=v.a.createElement("img");let u=null,p=null,g=0;d.alt="";let h=a.Alt;T.d(h)&&(h=o),r.title=h,("Medium"!==n&&"Medium20"!==n||h!==o)&&(s.title=h),"Large"===n&&h===o||(l.title=h),"Large"===n||"Menu32"===n?(u=a.Image32by32,p=a.Image32by32Class,g=5):"Medium20"===n?(u=a.Image20by20,p=a.Image20by20Class,g=13):(u=a.Image16by16,p=a.Image16by16Class,g=4);const m=v.a.createClusteredImageContainerNew(g,u,p,d,!0,!1);let S=null;("Small"!==n&&"Small14"!==n||i)&&(S=v.a.createElement("span"),"Small"!==n&&"Small14"!==n&&("Large"===n?(v.a.ensureCSSClassOnElement(S,"cui-ctl-largelabel"),v.a.setLargeControlText(S,o,i)):"Medium"!==n&&"Medium20"!==n||(v.a.ensureCSSClassOnElement(S,"cui-ctl-mediumlabel"),S.innerText=o)));let f=null;if(i){const n=v.a.createElement("img");n.alt="",f=e.isVisualRefreshEnabled?v.a.createClusteredImageContainerNew(2,t.properties.ImageDownArrow8by8,t.properties.ImageDownArrow8by8Class,n,!0,!1):v.a.createClusteredImageContainerNew(1,t.properties.ImageDownArrow,t.properties.ImageDownArrowClass,n,!0,!1)}r.appendChild(s),r.appendChild(l),s.appendChild(c),c.appendChild(m),T.d(S)||("Large"===n?l.appendChild(S):c.appendChild(S)),T.d(f)||("Large"===n?S.appendChild(f):l.appendChild(f)),r.tabIndex=0,s.tabIndex=-1,l.tabIndex=-1;return{returnValue:r,buttonElement:s,menuLauncherElement:l,buttonImageElement:d}}}(0,a.a)(be,"SplitButtonDomStrategy",null,[]);var Te=n(5837);class ve extends m.a{createComponentDomForDisplayMode(e){return(new be).buildControlDom(this,e)}forEachSplitButtonComponentDom(e){this.controlComponentDomCache.forEach((t=>{e(t)}))}onStateChanged(){this.setState(this.on&&this.enabled)}get displayedButtonElement(){const e=this.getDisplayedControlDom();return e?e.elmButtonPart:null}get displayedButtonImageElement(){const e=this.getDisplayedControlDom();return e?e.elmImage:null}get controlType(){return S.a.splitButtonControlType}get on(){return!!v.a.isTrue(this.properties$2.IsToggleSplit)&&this.stateProperties[Te.a.On]}set on(e){v.a.isTrue(this.properties$2.IsToggleSplit)&&(this.stateProperties[Te.a.On]=e,this.setState(e&&this.enabled))}setState(e){v.a.isTrue(this.properties$2.IsToggleSplit)&&this.forEachSplitButtonComponentDom((t=>{this.toggleCssClass(t,"cui-ctl-on",e)}))}toggleCssClass(e,t,n){v.a.toggleCSSClassOnElement(e.elmControl,t,n),v.a.toggleCSSClassOnElement(e.elmButtonPart,t,n),v.a.toggleCSSClassOnElement(e.elmMenuLauncherPart,t,n),this.updateAriaMenuLauncherPressedAttribute(e.elmControl,n),this.updateAriaMenuLauncherPressedAttribute(e.elmButtonPart,n)}get properties$2(){return this.controlProperties}updateAriaMenuLauncherPressedAttribute(e,t){_.a.setAriaAttribute(e,_.a.ariaPressedAttribute,t?_.a.ariaTrueValue:_.a.ariaFalseValue)}constructClonedMenuLauncher(e,t,n){return new ve(e,this.id,t,n)}constructClonedMenuLauncherForMenu(e,t,n){return new b.a(e,this.id,t,n)}getDisplayedControlDom(){const e=this.displayedComponent;if(!e)return null;return this.controlComponentDomCache.get_item(e.displayMode)}constructor(e,t,n,a){super(e,t,n,a),this.addDisplayMode("Large"),this.addDisplayMode("Medium"),this.addDisplayMode("Medium20"),this.addDisplayMode("Small"),this.addDisplayMode("Menu32"),this.addDisplayMode("Menu16"),this.addDisplayMode("Menu"),this.addDisplayMode("MenuTellMe"),this.on=!1}}(0,a.a)(ve,"SplitButton",m.a,[]);var we=n(8555);class Fe{get automaticDisplayColor(){return"Window"}get noFillStrokeColor(){return"WindowFrame"}get iconHeight(){return 16}get colorStripLeft(){return 0}get colorStripHeight(){return this.iconHeight/4}get colorStripTop(){return this.iconHeight-this.colorStripHeight}get colorStripAntiBlurStrokeOffset(){return.5}iconColorChanged(e,t){return!(T.b(t)&&T.b(e)||t===e)}drawColorStrip(e,t){if(!e)return void i.ULS.sendTraceTag(40421402,207,15,"IconColorManager.DrawColorStrip: HTMLCanvasElement is null. Bailing out...");const n=e.getContext("2d");if(n)if(t)try{n.clearRect(this.colorStripLeft,this.colorStripTop,e.width,this.colorStripHeight),n.strokeStyle=this.noFillStrokeColor,n.strokeRect(this.colorStripLeft+this.colorStripAntiBlurStrokeOffset,this.colorStripTop+this.colorStripAntiBlurStrokeOffset,e.width-2*this.colorStripAntiBlurStrokeOffset,this.colorStripHeight-2*this.colorStripAntiBlurStrokeOffset)}catch(t){i.ULS.sendTraceTag(40421404,207,15,String.format("IconColorManager.DrawColorStrip: a 2d context operation failed (clearRect or strokeRect) with element.Width='{0}'. Exception message: {1}",e.width,t.message))}else try{n.fillStyle=this.displayColor,n.fillRect(this.colorStripLeft,this.colorStripTop,e.width,this.colorStripHeight)}catch(t){i.ULS.sendTraceTag(40421405,207,15,String.format("IconColorManager.DrawColorStrip: a 2d context fillRect operation failed with fillStyle='{0}' and element.Width='{1}'. Exception message: {2}",this.displayColor,e.width,t.message))}else i.ULS.sendTraceTag(40421403,207,15,"IconColorManager.DrawColorStrip: element.GetContext did not return a 2d context. Bailing out...")}constructor(){this.displayColor=null}}(0,a.a)(Fe,"IconColorManager",null,[519]);var Ie=n(9858);class Ee extends y.a{constructor(e){super(e),this.elmCanvasPart=null}}(0,a.a)(Ee,"StatefulColorFlyoutAnchorComponentDom",y.a,[]);class Me{buildControlDom(e,t){const n=new Ee(t);return n.elmControl=({elmControlLabel:n.elmLabel,elmControlImage:n.elmImage,elmControlDescription:n.elmDescription,elmControlIconContainer:n.elmIconContainer}=S.a.createStandardControlDOMElement(e,e.root,t,e.controlProperties,this.hasArrow)).returnValue,this.populateCanvasElement(n,t),n}populateCanvasElement(e,t){e.elmCanvasPart=null;if(6!==S.a.getControlSize(t))return void i.ULS.sendTraceTag(40421406,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: Control.GetControlSize did not return ControlSize of Control16. Bailing out...");if(!e.elmImage)return void i.ULS.sendTraceTag(40421407,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: StatefulColorFlyoutAnchorComponentDom.ElmImage is null. Bailing out...");const n=e.elmImage.parentNode,a=v.a.createElement("canvas");if(!a)return void i.ULS.sendTraceTag(40421408,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: Utility.CreateElement did not create a HTMLCanvasElement. Bailing out...");a.height=16,a.width=16;const o=a.getContext("2d");if(o)try{o.clearRect(0,0,a.width,a.height),n.appendChild(a),e.elmCanvasPart=a}catch(e){i.ULS.sendTraceTag(40421410,207,15,String.format("StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: a 2d context operation of appending the canvas to StatefulColorFlyoutAnchorComponentDom.ElmImage failed. Exception message: {0}",e.message))}else i.ULS.sendTraceTag(40421409,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: element.GetContext did not return a 2d context. Bailing out...")}constructor(e=!0){this.hasArrow=e}}(0,a.a)(Me,"StatefulColorFlyoutAnchorDomStrategy",null,[]);class ke{}ke.Color="Color",ke.IntColor="IntColor",(0,a.a)(ke,"IconColorCommandProperties",null,[]);class Pe extends b.a{get properties$3(){return this.controlProperties}get currentIconColor(){return this.stateProperties[ke.Color]}set_currentIconColor(e){this.stateProperties[ke.Color]=e;const t=new RegExp("^-1$").test(e);return this.set_iconColorInt(t),this.iconColorManager.displayColor=t?this.iconColorManager.automaticDisplayColor:Ie.a.getRGBFromBGR(e),e}get iconColorInt(){return this.stateProperties[ke.IntColor]}set_iconColorInt(e){return this.stateProperties[ke.IntColor]=e,e}get controlType(){return S.a.statefulColorFlyoutAnchorControlType}selectDropdownItem(e){const t=(0,we.a)(S.a,e);t&&this.iconColorManager.iconColorChanged(t.stateProperties.Color,this.currentIconColor)&&(T.b(t.stateProperties.Color)?this.set_currentIconColor(this.properties$3.DefaultColor):this.set_currentIconColor(t.stateProperties.Color),this.iconColorManager.drawColorStrip(this.displayedButtonCanvasElement,this.iconColorInt))}constructClonedMenuLauncher(e,t,n){return new Pe(e,this.id,t,n)}createComponentDomForDisplayMode(e){const t=(new Me).buildControlDom(this,e);return this.populateControlDom(t,e),this.displayedButtonCanvasElement=t.elmCanvasPart,this.iconColorManager.drawColorStrip(this.displayedButtonCanvasElement,this.iconColorInt),t}constructor(e,t,n,a){super(e,t,n,a),this.displayedButtonCanvasElement=null,this.iconColorManager=new Fe,this.set_currentIconColor(this.properties$3.InitializationColor)}}(0,a.a)(Pe,"StatefulColorFlyoutAnchor",b.a,[356]);var De=n(1825);class Re extends Ae{internalImageLoadHandler(){const e=this.elmCanvasPart.getContext("2d");if(e){try{e.drawImage(this.elmImage,-this.elmImage.offsetLeft,-this.elmImage.offsetTop,this.elmCanvasPart.width,12,0,0,this.elmCanvasPart.width,12)}catch(e){return i.ULS.sendTraceTag(39986015,207,15,String.format("StatefulColorSplitButtonComponentDom.InternalImageLoadHandler: a 2d context drawImage operation failed. Exception message: {0}",e.message)),void this.setDefaultImageDisplay()}this.setDefaultImageDisplay("none")}else i.ULS.sendTraceTag(39986014,207,15,"StatefulColorSplitButtonComponentDom.InternalImageLoadHandler: ElmCanvasPart.GetContext did not return a 2d context. Bailing out...")}setDefaultImageDisplay(e=""){try{this.elmImage&&this.elmImage.style&&this.elmImage.style.display!==e&&(this.elmImage.style.display=e)}catch(t){i.ULS.sendTraceTag(39986016,207,15,String.format("StatefulColorSplitButtonComponentDom.SetDefualtImangeDisplay: ElmImage.Style.Display = {0} failed. Exception message: {1}",e,t.message))}}constructor(e){super(e),this.elmCanvasPart=null}}(0,a.a)(Re,"StatefulColorSplitButtonComponentDom",Ae,[]);class xe extends be{buildControlDom(e,t){const n=new Re(t);return this.populateControlDom(n,e,t),this.populateCanvasElement(n,t),n}populateCanvasElement(e,t){e.elmCanvasPart=null;const n=De.a.getControlSize(t);if(i.ULS.shipAssertTag(22315809,207,6===n,"Stateful color split button is implemented for 16X16px icons"),6!==n)return;const a=e.elmImage.parentNode,o=v.a.createElement("canvas");if(!o)return i.ULS.sendTraceTag(39986017,207,15,"StatefulColorSplitButtonComponentDom.PopulateCanvasElement: failed to create a canvas element. Bailing out..."),void e.setDefaultImageDisplay();o.height=16,o.width=16;const r=o.getContext("2d");if(!r)return i.ULS.sendTraceTag(39986018,207,15,"StatefulColorSplitButtonComponentDom.PopulateCanvasElement: element.GetContext did not return a 2d context. Bailing out..."),void e.setDefaultImageDisplay();try{r.clearRect(0,0,o.width,o.height),a.appendChild(o),e.elmCanvasPart=o}catch(t){i.ULS.sendTraceTag(39986019,207,15,String.format("StatefulColorSplitButtonComponentDom.PopulateCanvasElement: a 2d context ClearRect operation failed with element.Width='{0}', element.Height='{1}'. Exception message: {2}",o.width,o.height,t.message)),e.setDefaultImageDisplay()}}constructor(){super()}}(0,a.a)(xe,"StatefulColorSplitButtonDomStrategy",be,[]);class Le extends ve{get statefulColorSplitButtonProperties(){return this.controlProperties}get currentIconColor(){return this.stateProperties[ke.Color]}set_currentIconColor(e){this.stateProperties[ke.Color]=e;const t=new RegExp("^-1$").test(e);return this.set_iconColorInt(t),this.iconColorManager.displayColor=t?this.iconColorManager.automaticDisplayColor:Ie.a.getRGBFromBGR(e),e}get iconColorInt(){return this.stateProperties[ke.IntColor]}set_iconColorInt(e){return this.stateProperties[ke.IntColor]=e,e}get displayedButtonCanvasElement(){const e=this.getDisplayedControlDom();return e?e.elmCanvasPart:null}get controlType(){return S.a.statefulColorSplitButtonControlType}selectDropdownItem(e){const t=(0,we.a)(S.a,e);t&&this.iconColorManager.iconColorChanged(t.stateProperties.Color,this.currentIconColor)&&(T.b(t.stateProperties.Color)?this.set_currentIconColor(this.statefulColorSplitButtonProperties.DefaultColor):this.set_currentIconColor(t.stateProperties.Color),this.iconColorManager.drawColorStrip(this.displayedButtonCanvasElement,this.iconColorInt))}constructClonedMenuLauncher(e,t,n){return new Le(e,this.id,t,n)}constructClonedMenuLauncherForMenu(e,t,n){return new b.a(e,this.id,t,n)}createComponentDomForDisplayMode(e){const t=(new xe).buildControlDom(this,e);return this.iconColorManager.drawColorStrip(t.elmCanvasPart,this.iconColorInt),t}constructor(e,t,n,a){super(e,t,n,a),this.iconColorManager=new Fe,this.set_currentIconColor(this.statefulColorSplitButtonProperties.InitializationColor)}}(0,a.a)(Le,"StatefulColorSplitButton",ve,[356]);class Ue{}Ue.MenuItemIdKey="MenuItemId",Ue.ImageClassKey="ImageClass",(0,a.a)(Ue,"StatefulImageSplitButtonCommandProperties",null,[]);class Oe extends ve{get statefulImageSplitButtonProperties(){return this.controlProperties}get recentMenuItemId(){return this.stateProperties[Ue.MenuItemIdKey]}set recentMenuItemId(e){this.stateProperties[Ue.MenuItemIdKey]=e}get recentImageClass(){return this.stateProperties[Ue.ImageClassKey]}set recentImageClass(e){this.stateProperties[Ue.ImageClassKey]=e}get controlType(){return S.a.statefulImageSplitButtonControlType}selectDropdownItem(e){this.recentMenuItemId=e.getMenuItemId(),this.setRecentRecentImageClass(Oe.getCssClassName(e))&&this.updateDOM()}constructClonedMenuLauncher(e,t,n){return new Oe(e,this.id,t,n)}constructClonedMenuLauncherForMenu(e,t,n){return new b.a(e,this.id,t,n)}setRecentRecentImageClass(e){const t=this.recentImageClass;return(!T.b(t)||!T.b(e))&&(t!==e&&(T.b(e)&&(e=this.statefulImageSplitButtonProperties.DefaultImageClass),this.recentImageClass=e,!0))}updateDOM(){const e=this.displayedButtonImageElement;e&&(e.className=this.recentImageClass)}static getCssClassName(e){const t=(0,we.a)(S.a,e);if(!t)return"";const n=S.a.getControlSize(t.displayMode);return i.ULS.shipAssertTag(34961356,207,6===n,"Stateful button is implemented for 16X16px icons"),6!==n?"":t.controlProperties.Image16by16Class}constructor(e,t,n,a){super(e,t,n,a),this.recentMenuItemId=this.statefulImageSplitButtonProperties.DefaultMenuItemId,this.recentImageClass=this.statefulImageSplitButtonProperties.DefaultImageClass}}(0,a.a)(Oe,"StatefulImageSplitButton",ve,[]);var Be=n(6808);class Ne extends y.a{constructor(e,t=null,n=null){super(e,t,n),this.elmInput=null,this.isEditable=!0,this.isMultiline=!1}}(0,a.a)(Ne,"TextBoxComponentDom",y.a,[]);class We extends U.a{get focusableElement(){return this._focusableElement}buildControlDom(e,t){const n=e.controlProperties,a=v.a.createElement("span");Sys.UI.DomElement.addCssClass(a,"cui-btn-menu-description"),Sys.UI.DomElement.addCssClass(a,"cui-menusection-diagnostics-textbox"),Sys.UI.DomElement.addCssClass(a,"UIFont");const i=n.ControlCss;T.d(i)||(a.style.cssText=i);const o=v.a.createElement("label");Sys.UI.DomElement.addCssClass(o,"UIFontBold"),Sys.UI.DomElement.addCssClass(o,"cui-menusection-diagnostics-textboxlabel"),o.setAttribute("for",e.id),o.id=e.id+"-label",o.appendChild(document.createTextNode(n.LabelText||""));let r=o.id;const s=n.AdditionalLabelBy;T.d(s)||(r+=" "+s);const l=We.createTextBox(e.id,r);return a.appendChild(o),a.appendChild(l),this._focusableElement=l,Object.assign(new Ne(t,a,this),{elmInput:l,elmLabel:o,isEditable:!1})}static createTextBox(e,t){const n=document.createElement("textarea");return n.id=e,n.rows=1,k.a.isIPad||(n.readOnly=!0),n.setAttribute(_.a.ariaLabelledByAttribute,t),n.setAttribute(_.a.ariaMultilineAttribute,_.a.ariaFalseValue),n.setAttribute(_.a.ariaReadOnlyAttribute,_.a.ariaTrueValue),n.setAttribute(_.a.ariaRoleAttribute,_.a.ariaTextboxAttribute),Sys.UI.DomElement.addCssClass(n,Be.a.allowBrowserContextMenu),Sys.UI.DomElement.addCssClass(n,"UIFont"),n}constructor(){super(),this._focusableElement=null}}(0,a.a)(We,"DiagnosticsItemTextBoxDomStrategy",U.a,[]);class He extends U.a{get focusableElement(){return this._focusableElement}buildControlDom(e,t){const n=e.controlProperties,a=v.a.createElement("span");a.className="cui-tb",a.setAttribute("mscui:controltype",e.controlType),a.setAttribute(_.a.ariaRoleAttribute,_.a.ariaPresentationRole),v.a.isTrue(n.IsStretchedHorizontally)&&v.a.ensureCSSClassOnElement(a,"stretchedHorizontally");const i=He.createLabelElement(e,t);a.appendChild(i);const o=He.createInputElement(e,t);return a.appendChild(o),this._focusableElement=o,Object.assign(new Ne(t,a),{elmInput:o,elmLabel:i,isEditable:!0,isMultiline:v.a.isTrue(n.IsMultiline)})}static createLabelElement(e,t){const n=e.controlProperties,a=v.a.createElement("span"),i=n.LabelText||"";"Small"===t?v.a.ensureCSSClassOnElement(a,"cui-ctl-smalllabel"):"Large"===t?v.a.ensureCSSClassOnElement(a,"cui-ctl-largelabel"):v.a.ensureCSSClassOnElement(a,"cui-ctl-mediumlabel"),a.id="lbl"+e.id+"-"+t,a.innerText=i;const o=n.LabelCss;return T.b(o)||(a.style.cssText=o),a}static createInputElement(e,t){const n=e.controlProperties;let a;v.a.isTrue(n.IsMultiline)?(a=v.a.createSelectableElement("textarea"),a.setAttribute("aria-multiline","true"),a.className="cui-txtbx",v.a.ensureCSSClassOnElement(a,"cui-txtbx-multiline")):(a=v.a.createSelectableElement("input"),a.setAttribute("aria-multiline","false"),a.setAttribute("data-lpignore","true"),a.className="cui-txtbx"),a.id=e.id,a.setAttribute("type","text"),a.setAttribute("role","textbox"),a.setAttribute("autocomplete","off"),v.a.isTrue(n.IsStretchedHorizontally)&&v.a.ensureCSSClassOnElement(a,"stretchedHorizontally");const i=n.Height;T.d(i)||(a.style.height=i);const o=n.Width;T.d(o)||(a.style.width=o);const r="lbl"+e.id+"-"+t,s=n.AdditionalLabelBy;T.d(s)?a.setAttribute("aria-labelledby",r):a.setAttribute("aria-labelledby",s+" "+r);const l=n.MaxLength;T.d(l)||a.setAttribute("maxlength",l);const c=n.PlaceholderText;return T.d(c)||a.setAttribute("placeholder",c),a}constructor(){super(),this._focusableElement=null}}(0,a.a)(He,"StandardTextBoxDomStrategy",U.a,[]);class Ve extends S.a{get textBoxDom(){return this._textBoxDom}createComponentDomForDisplayMode(e){const t=Ve.getDomElementCreationStrategy(e);return this._textBoxDom=t.buildControlDom(this,e),this._focusableElement=t.focusableElement,this.textBoxDom}ensureKeytipForControl(e,t){e.ensureKeytip(t,this.textBoxDom.elmInput,this.parentKeytipsIds,this.parentKeytipsKeys)}get controlType(){return S.a.textBoxControlType}get focusableElement(){return this._focusableElement}commitPendingChange(){this.behavior&&this.behavior.commitPendingChange()}constructClonedControl(e,t){return new Ve(e,this.id,t)}get isEditable(){return!!this.textBoxDom&&this.textBoxDom.isEditable}static getDomElementCreationStrategy(e){return"MenuDiagnostics"===e?new We:new He}constructor(e,t,n){super(e,t,n),this._textBoxDom=null,this._focusableElement=null,this.addDisplayMode("Medium"),this.addDisplayMode("MenuDiagnostics"),this.behavior&&this.behavior.initialize()}}(0,a.a)(Ve,"TextBox",S.a,[172]);var Ge=n(4773),Qe=n(2945),qe=n(5200),Ke=n(6728),ze=n(8304),je=n(4163),Ze=n(9800);class Xe{get _resizableContainer(){return this.__resizableContainer}onRootBuilt(e){}dispose(){this.root=null,this._options=null,this._elmPlaceholder=null,this._buildClientTask=null,this.dataSource=null,$removeHandler(window,"unload",this.onUnload)}get buildClientTask(){return this._buildClientTask}get placeholder(){return this._elmPlaceholder}get options(){return this._options}isIdTrimmed(e){return!!this.options&&this.options.trimmedIds[e]}isNodeTrimmed(e){const t=Qe.a.getNodeAttribute(e,Qe.a.id);return this.options.trimmedIds[t]}buildControl(e,t){let n=null;const a=e[Qe.a.NAME];switch(a){case Qe.a.button:n=this.buildButton(e,t);break;case Qe.a.colorPicker:n=this.buildColorPicker(e,t);break;case Qe.a.comboBox:n=this.buildComboBox(e,t);break;case Qe.a.dropDown:n=this.buildDropDown(e,t);break;case Qe.a.flyoutAnchor:n=this.buildFlyoutAnchor(e,t);break;case Qe.a.galleryButton:n=this.buildGalleryButton(e,t,null);break;case Qe.a.insertTable:Xe._insertTableBuilderImpl&&(n=Xe._insertTableBuilderImpl(e,t,this.root));break;case Qe.a.label:n=this.buildLabel(e,t);break;case Qe.a.placeholder:n=this.buildPlaceholder(e,t);break;case Qe.a.searchBox:n=this.buildSearchBox(e,t);break;case Qe.a.separator:n=this.buildSeparator(e,t);break;case Qe.a.slider:n=Xe.buildSlider(e,t,this.root);break;case Qe.a.spinner:s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&(Xe._spinnerBuilderImpl||Xe.enableSpinner()),Xe._spinnerBuilderImpl&&(n=Xe._spinnerBuilderImpl(e,t,this.root));break;case Qe.a.splitButton:n=this.buildSplitButton(e,t);break;case Qe.a.statefulColorFlyoutAnchor:n=this.buildStatefulColorFlyoutAnchor(e,t);break;case Qe.a.statefulColorSplitButton:n=this.buildStatefulColorSplitButton(e,t);break;case Qe.a.statefulImageSplitButton:n=this.buildStatefulImageSplitButton(e,t);break;case Qe.a.textBox:n=Xe.buildTextBox(e,t,this.root);break;case Qe.a.toggleButton:n=this.buildToggleButton(e,t);break;case Qe.a.clonedControl:n=this.buildClonedControl(e,t);break;default:{const t=e[Qe.a.ATTRIBUTES][Qe.a.CLASSNAME];if(T.d(t))throw Error.create("Unable to create Control with tagname: "+a);break}}return T.d(t.parentId)||(n.stateProperties.ParentMenuId=t.parentId),n}buildMenu(e,t,n=!1){if(this.isNodeTrimmed(e))return null;const a=e[Qe.a.ATTRIBUTES],i=this.root.createMenu(a[Qe.a.id],a[Qe.a.TITLE],a[Qe.a.DESCRIPTION],a[Qe.a.MAXWIDTH],n,"2"===a[Qe.a.HORIZONTALALIGNMENT]?2:1);return this.fillMenu(i,e,t),i}buildMenuForFlyoutAnchor(e,t){const n=Qe.a.getNodeChildren(e);let a=null;const i=e[Qe.a.ATTRIBUTES];return t.parentId=i.Id,Xe.shouldBuildMenu(i,n)&&(a=this.buildMenu(n[0],t)),t.parentId=null,a}fillMenu(e,t,n){const a=Qe.a.getNodeChildren(t),o=a.length;let r=null;for(let t=0;t<o;t++){r=a[t];const o=r[Qe.a.NAME];if(o!==Qe.a.MENUSECTION){i.ULS.sendTraceTag(8402819,201,10,"Tags with the name: {0} cannot be children of Menu tags.",o);continue}if(this.isNodeTrimmed(r))continue;const s=this.buildMenuSection(r,n,e);e.addChild(s)}}buildMenuSection(e,t,n){const a=e[Qe.a.ATTRIBUTES],i={},o=a[Qe.a.id],r=a[Qe.a.TITLE],s=a[Qe.a.DESCRIPTION];i.DisplayMode=a[Qe.a.DISPLAYMODE],i.MaxHeight=a[Qe.a.MAXHEIGHT],i.Image=a[Qe.a.IMAGE],i.ImageClass=a[Qe.a.IMAGECLASS],i.Theme=a[Qe.a.THEME],i.TitleId=a[Qe.a.TITLEID],i.Language=a[Qe.a.LANGUAGE],i.ArialabelledbyId=a[Qe.a.ARIALABELLEDBYID],T.d(i.DisplayMode)&&(i.DisplayMode="Menu"),i.ShowSeperator=(!v.a.isFalse(a[Qe.a.SHOWMENUSECTIONSEPERATOR])).toString(),i.ShowTitleIcon=(!v.a.isFalse(a[Qe.a.SHOWMENUSECTIONTITLEICON])).toString(),i.ShowTitleBackground=(!v.a.isFalse(a[Qe.a.SHOWMENUSECTIONTITLEBACKGROUND])).toString(),i.TitleFocusable=(!v.a.isFalse(a[Qe.a.MENUSECTIONTITLEFOCUSABLE])).toString(),i.Scrollable=v.a.isTrue(a[Qe.a.SCROLLABLE]).toString(),i.Loading=v.a.isTrue(a[Qe.a.LOADING]).toString();const l=this.root.createMenuSection(o,r,s,i,n),c=Qe.a.getNodeName(Qe.a.getNodeChildren(e)[0]);if(c===Qe.a.CONTROLS){const n=Qe.a.getNodeChildren(Qe.a.getNodeChildren(e)[0]),a=n.length;let o=null;for(let e=0;e<a;e++){if(o=n[e],this.isNodeTrimmed(o))continue;const a=this.buildControl(o,t);a&&l.addChild(a.createComponentForDisplayMode(i.DisplayMode))}}else if(c===Qe.a.GALLERY){const n=this.buildGallery(Qe.a.getNodeChildren(e)[0],t,!0);l.addChild(n)}return l}buildGallery(e,t,n){const a=e[Qe.a.ATTRIBUTES],i=e[Qe.a.ATTRIBUTES],o=this.root.createGallery(i.Id,a[Qe.a.TITLE],a[Qe.a.DESCRIPTION],i),r=n?"Menu":"Default",s=Qe.a.getNodeChildren(e),l=s.length;let c=null;for(let e=0;e<l;e++){if(c=s[e],this.isNodeTrimmed(c))continue;let n;if(Qe.a.getNodeName(c)===Qe.a.galleryButton)n=this.buildGalleryButton(c,t,i.ElementDimensions);else n=this.buildControl(c,t);n&&o.addChild(n.createComponentForDisplayMode(r))}return o}buildGalleryButton(e,t,n){let a;if(T.b(n)){n=e[Qe.a.ATTRIBUTES][Qe.a.ELEMENTDIMENSIONS]}a=T.b(n)?3:qe.a.convertStringToGalleryElementDimensions(n);const i=e[Qe.a.ATTRIBUTES],o=new x(this.root,i.Id,i,a);return T.d(t.parentId)||(o.stateProperties.ParentMenuId=t.parentId),o}buildToggleButton(e,t){const n=e[Qe.a.ATTRIBUTES];return new Ge.a(this.root,n.Id,n)}buildColorPicker(e,t){const n=e[Qe.a.ATTRIBUTES],a=Qe.a.getNodeChildren(Qe.a.getFirstChildNodeWithName(e,Qe.a.colors)),i=new Array(a.length),o=a.length;for(let e=0;e<o;e++){const t=new g,n=Qe.a.getNodeAttributes(a[e]),o=n[Qe.a.TITLE];t.Title=T.d(o)?n[Qe.a.ALT]:o,t.Color=n[Qe.a.COLOR],t.DisplayColor=n[Qe.a.DISPLAYCOLOR],i[e]=t}return new h.a(this.root,n.Id,n,i)}buildSearchBox(e,t){const n=e[Qe.a.ATTRIBUTES],a=Qe.a.getNodeChildren(e);let i=null;return Xe.shouldBuildMenu(n,a)&&(i=this.buildMenu(a[0],t)),new he(this.root,n.Id,n,i)}buildComboBox(e,t,n){const a=e[Qe.a.ATTRIBUTES],i=Qe.a.getNodeChildren(e);let o=null;const r=e[Qe.a.ATTRIBUTES];let s=null;if(Xe.shouldBuildMenu(r,i)){o=this.buildMenu(i[0],t,!0),s={};const e=Qe.a.getNodeChildren(i[0]),n=e.length;for(let t=0;t<n;t++){const n=Qe.a.getNodeChildren(e[t]),a=Qe.a.getNodeChildren(n[0]),i=a.length;for(let e=0;e<i;e++){const t=a[e][Qe.a.ATTRIBUTES],n=t[Qe.a.LABELTEXT],i=t[Qe.a.MENUITEMID];s[n]=i}}}const l=n?n(this.root,a.Id,a,o):new M(this.root,a.Id,a,o);return l.menuItems=s,l}buildDropDown(e,t){const n=e[Qe.a.ATTRIBUTES],a=Qe.a.getNodeChildren(e);let i=null;const o=e[Qe.a.ATTRIBUTES];Xe.shouldBuildMenu(o,a)&&(i=this.buildMenu(a[0],t));return new w(this.root,n.Id,n,i)}buildButton(e,t){const n=e[Qe.a.ATTRIBUTES];return new p.a(this.root,n.Id,n)}buildSplitButton(e,t){const n=e[Qe.a.ATTRIBUTES],a=Qe.a.getNodeChildren(e);let i=null;Xe.shouldBuildMenu(n,a)&&(i=this.buildMenu(a[0],t));return new ve(this.root,n.Id,n,i)}buildStatefulColorSplitButton(e,t){const n=e[Qe.a.ATTRIBUTES],a=Qe.a.getNodeChildren(e);let i=null;Xe.shouldBuildMenu(n,a)&&(i=this.buildMenu(a[0],t));return new Le(this.root,n.Id,n,i)}buildStatefulImageSplitButton(e,t){const n=e[Qe.a.ATTRIBUTES],a=Qe.a.getNodeChildren(e);let i=null;Xe.shouldBuildMenu(n,a)&&(i=this.buildMenu(a[0],t));return new Oe(this.root,n.Id,n,i)}buildFlyoutAnchor(e,t){const n=e[Qe.a.ATTRIBUTES],a=this.buildMenuForFlyoutAnchor(e,t);return new b.a(this.root,n.Id,n,a)}buildStatefulColorFlyoutAnchor(e,t){const n=e[Qe.a.ATTRIBUTES],a=this.buildMenuForFlyoutAnchor(e,t);return new Pe(this.root,n.Id,n,a)}buildLabel(e,t){const n=e[Qe.a.ATTRIBUTES];return new K(this.root,n.Id,n)}buildPlaceholder(e,t){const n=e[Qe.a.ATTRIBUTES];return new z(this.root,n.Id,n)}buildSeparator(e,t){const n=e[Qe.a.ATTRIBUTES];return new me(this.root,n.Id,n)}convertNodeValueToInt(e){return"string"==typeof e?parseInt(e):e}buildClonedControl(e,t){const n=e[Qe.a.ATTRIBUTES],a=(0,o.a)(Ke.a,t)&&t.cloneControlsForMenu;let i=ze.a.instance.getFirstValidControl(n.Id);return i&&(i=a?i.cloneForMenu(this.root,n):i.clone(this.root,n)),i}static enableSlider(){Xe._sliderBuilderImpl=Xe.buildSlider}static enableSpinner(){Xe._spinnerBuilderImpl=Xe.buildSpinner}static enableInsertTable(){Xe._insertTableBuilderImpl=Xe.buildInsertTable}static buildInsertTable(e,t,n){const a=e[Qe.a.ATTRIBUTES];return new L.a(n,a.Id,a)}static buildSlider(e,t,n){const a=e[Qe.a.ATTRIBUTES];return new Se(n,a.Id,a)}static buildSpinner(e,t,n){const a=e[Qe.a.ATTRIBUTES],i=Xe.buildSpinnerChildren(e);return new ye(n,a.Id,a,i.units,i.specialTextStrings)}static convertNodeValueToFloat(e){return"string"==typeof e?parseFloat(e):e}static buildSpinnerChildren(e){const t=Qe.a.getNodeChildren(e),n=[],a=[],i=t.length;for(let e=0;e<i;e++){const i=t[e],o=Qe.a.getNodeName(i),r=Qe.a.getNodeAttributes(i);if(o===Qe.a.UNIT){const e=ye.createUnit(d.a.convertStringToUnitType(r[Qe.a.UNITTYPE]),Xe.convertNodeValueToFloat(r[Qe.a.MINIMUMVALUE]),Xe.convertNodeValueToFloat(r[Qe.a.MAXIMUMVALUE]),Xe.convertNodeValueToFloat(r[Qe.a.STEP]));Array.add(n,e)}else o===Qe.a.SPECIALTEXTSTRINGS&&Array.add(a,r[Qe.a.VALUE])}return new u(n,a)}static buildTextBox(e,t,n){const a=e[Qe.a.ATTRIBUTES];return new Ve(n,a.Id,a)}static convertXMLStringToJSON(e){let t=null;return t=Sys.Net.XMLDOM(e),T.d(t)||T.d(t.documentElement)?(i.ULS.sendTraceTag(4523028,201,50,"Failure in ConvertXMLStringToJSON"),null):Xe.convertXMLToJSON(t)}static convertXMLToJSON(e){return Ze.a.logUniqueUsage("3e4c5637;c84fe950"),s.AFrameworkApplication.appSettingsManager&&s.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsViewerSafeBuilderXMLtoJSONEnabled",!1)?Xe.convertNodeToJsonObject(e.documentElement):(0,r.a)("("+Xe.convertNodeToJsonString(e.documentElement)+")")}static convertNodeToJsonString(e){let t;t="{",t+='"name" : ',t+=l.c(e.nodeName),t+=",",t+='"attrs": {';const n=e.attributes;if(!T.d(e.attributes)){const e=n.length;if(e>0){let a=!0;for(let i=0;i<e;i++){const e=n.item(i);a?a=!1:t+=",",t+=l.c(e.name),t+=":",v.a.isEncodedStringArray(e.value)?t+=l.c(v.a.decodeStringArrayXmlAttribute(e.value)):t+=l.c(e.value)}}}t+="}";const a=e.childNodes;if(a){const e=a.length;if(e>0){t+=",",t+="children:[";let n=!0;for(let i=0;i<e;i++){const e=a[i];"#text"!==e.nodeName&&(n?n=!1:t+=",",t+=Xe.convertNodeToJsonString(e))}t+="]"}}return t+="}",t}static convertNodeToJsonObject(e){const t={name:e.nodeName,attrs:{}};if(!T.d(e.attributes))for(let n=0;n<e.attributes.length;++n){const a=e.attributes.item(n);let i=a.value;v.a.isEncodedStringArray(i)&&(i=v.a.decodeStringArrayXmlAttribute(i)),t.attrs[a.name]=i}if(e.childNodes&&e.childNodes.length){t.children=[];for(let n=0;n<e.childNodes.length;++n){const a=e.childNodes[n];"#text"!==a.nodeName&&t.children.push(Xe.convertNodeToJsonObject(a))}}return t}static shouldBuildMenu(e,t){return je.a.shouldBuildMenu(e,t)}constructor(e,t,n,a){this.root=null,this.inQuery=!1,this.dataSource=null,this.onUnload=e=>{this.dispose()},this._options=e,T.d(this.options.trimmedIds)&&(this.options.trimmedIds={}),this._elmPlaceholder=t,this._buildClientTask=n,this.__resizableContainer=a||new c.a,$addHandler(window,"unload",this.onUnload)}}Xe._sliderBuilderImpl=null,Xe._spinnerBuilderImpl=null,Xe._insertTableBuilderImpl=null,(0,a.a)(Xe,"Builder",null,[11])},4163:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(6662);class o{static shouldBuildMenu(e,t){return!!t[0]&&(!i.a.isTrue(e.PopulateDynamically)||i.a.isTrue(e.AllowDefaultContent))}}(0,a.a)(o,"BuilderStatic",null,[])},37:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var a=n(100),i=n(5149),o=n(3245),r=n(7072),s=n(6662);class l{get key(){return this._key}get element(){return this._element}get elementId(){return this._elementId}createKeytipElement(){this._element=s.a.createElement("div"),this.element.className="cui-keytip";const e=s.a.createElement("span");return e.className="cui-keytip-span",e.innerText=this._key,e.id=this._elementId,this.element.appendChild(e),r.a.setAriaAttribute(this.element,r.a.ariaRoleAttribute,r.a.ariaPresentationRole),r.a.setAriaAttribute(this.element,r.a.ariaHiddenAttribute,r.a.ariaTrueValue),r.a.setAriaAttribute(e,r.a.ariaRoleAttribute,r.a.ariaPresentationRole),this.hide(),this.element}show(e){Sys.UI.DomElement.removeCssClass(this.element,"WACAltTextDescribedBy"),this.element.style.zIndex=String(e),this.setDisplay("block")}hide(){Sys.UI.DomElement.addCssClass(this.element,"WACAltTextDescribedBy"),this.setDisplay("none")}setDisplay(e){this.element&&(this.element.style.display=e)}constructor(e,t){this._element=null,this._key=e,this._elementId=t+l.keytipId}}l.ribbonShortcutId="RibbonShortcut",l.keytipId="-Keytip",(0,a.a)(l,"Keytip",null,[]);var c=n(690),d=n(1903);class u{ensureChildren(){d.d(this.children)&&(this._children=new c.a)}get id(){return this._id}get elementInternal(){return this._elmDOM}set elementInternal(e){this._elmDOM=e}get root(){return this._root}get parent(){return this._parent}get children(){return this._children}updateFocusedIndex(e){return this===e}resetFocusedIndex(){}focusNext(e){return!1}getChildInternal(e){for(const t of this.children)if(t.id===e)return t;return null}getChild(e){return this.getChildInternal(e)}getChildByTitle(e){for(const t of this.children)if(t.title===e)return t;return null}addChild(e){this.addChildInternal(e,!0)}addChildInternal(e,t){this.addChildAtIndexInternal(e,-1,t)}addChildAtIndex(e,t){this.addChildAtIndexInternal(e,t,!0)}addChildAtIndexInternal(e,t,n){if(n&&this.ensureCorrectChildType(e),!d.d(e.parent)){const t=String.format(u.addChildAlreadyAddedExcpetionMessage,e.id,this.id,e.parent.id);throw i.ULS.shipAssertTag(4334035,201,!1,t),Error.create(t)}-1===t?this.children.add(e):this.children.insert(t,e),e._parent=this,this.onDirtyingChange()}removeChild(e){const t=this.getChildInternal(e);if(d.d(t))throw Error.create("The child with id: "+e+" is not as child of this Component");this.children.remove(t),t._parent=null,this.onDirtyingChange()}removeChildren(){for(const e of this.children)e&&(e._parent=null);this.children.clear(),this.onDirtyingChange()}ensureCorrectChildType(e){}initRootMember(e){if(!d.d(this.root))throw Error.create("Root member has already been set for this Component.");this._root=e}get visible(){return this._visible}set visible(e){this.visibleInternal=e}get visibleInternal(){return this.visible}set visibleInternal(e){const t=this._visible;this._visible=e,t!==this._visible&&(this.onDirtyingChange(),d.d(this.parent)||this.parent.onChildrenVisibleChanged())}onChildrenVisibleChanged(){if(this.children&&this.children.count>0){let e=!1;for(const t of this.children){if(t.visible){e=!0;break}}this.visible=e}}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e||!this._enabledHasBeenSet){if(!d.d(this.parent)&&!this.parent.enabled&&e)throw Error.create("This Component with id: "+this.id+" cannot be Enabled because its parent is Disabled");this._enabled=e,this._enabledHasBeenSet=!0;for(const t of this.children)t.enabled=e;this.onEnabledChanged(e)}}onEnabledChanged(e){}get title(){return this.titleInternal}set title(e){this.titleInternal=e,this.onDirtyingChange()}get description(){return this._description}set description(e){this._description=e,this.onDirtyingChange()}setDirtyRecursively(e){if(this.dirty=e,!d.d(this.children))for(const t of this.children)t.setDirtyRecursively(e)}onDirtyingChange(){this.dirty||this.ignoreDirtyingEvents||(this.dirty=!0,d.d(this.parent)||this.parent.onDirtyingChange())}refreshInternal(){this.dirty=!1}ensureRefreshed(){this.dirty&&this.refreshInternal()}ensureDOMElement(){this._elmDOM||(this._elmDOM=s.a.createElement(this.domElementTagName),this._elmDOM.className=this.cssClass,this.id&&(this._elmDOM.id=this.id))}get domElementTagName(){return"span"}get cssClass(){return""}get visibleInDOM(){return!d.d(this.parent)&&(this._visibleInDOM&&this.parent.visibleInDOM)}set visibleInDOM(e){this.root.supportsDynamicDisplayMode&&(this._visibleInDOM=e,this._visibleInDOM?this.removeHideElementOverride():this.applyHideElementOverride())}setFocusOnFirstControl(){if(!this.visible)return!1;for(const e of this.children)if(e.setFocusOnFirstControl())return!0;return!1}ensureDOMElementAndEmpty(){d.d(this.elementInternal)?this.ensureDOMElement():this.elementInternal=s.a.removeChildNodes(this.elementInternal)}appendChildrenToElement(e){const t=this.root.supportsInvisibleControls,n=document.createDocumentFragment();for(const e of this.children)e.ensureDOMElement(),t&&!e.visible||n.appendChild(e.elementInternal),e.ensureRefreshed();e.appendChild(n)}getTextValue(){return null}onMenuClosed(){if(!d.d(this.children))for(const e of this.children)e.onMenuClosed()}setDelayedInitData(e,t,n){this._delayedInitHandler=e,this._delayedInitData=t,this._delayedInitOptions=n}doDelayedInit(){if(!this._delayedInitInProgress){if(d.d(this._delayedInitHandler))throw Error.create("No delayedinit handler present in this component: "+this.id);this._delayedInitInProgress=!0,this._delayedInitHandler(this,this._delayedInitData,this._delayedInitOptions)}}onDelayedInitFinished(e){e&&(this._delayedInitHandler=null,this._delayedInitData=null,this._delayedInitOptions=null,this.onDirtyingChange()),this._delayedInitInProgress=!1}get needsDelayIniting(){return!d.d(this._delayedInitHandler)}pollForStateAndUpdateInternal(){if(this.children)for(const e of this.children)e.pollForStateAndUpdateInternal();else this._disposed?i.ULS.sendTraceTag(35129304,220,15,"PollForStateAndUpdateInternal is called after component is disposed"):i.ULS.sendTraceTag(35129305,220,50,"PollForStateAndUpdateInternal is called and children is null")}ensureBehaviorAttached(){for(const e of this.children)e.ensureBehaviorAttached()}get lastPollTime(){return d.d(this._lastPollTime)&&(this._lastPollTime=new Date,this._lastPollTime.setTime(0)),this._lastPollTime}set lastPollTime(e){this._lastPollTime=e}get rootPolledSinceLastPoll(){return this.lastPollTime.getTime()<this.root.lastPollTime.getTime()||!this.lastPollTime.getTime()}pollIfRootPolledSinceLastPoll(){this.rootPolledSinceLastPoll&&this.pollForStateAndUpdateInternal()}applyHideElementOverride(){"none"!==this.elementInternal.style.display&&(this._originalCssDisplay=this.elementInternal.style.display),this.elementInternal.style.display="none"}removeHideElementOverride(){this.elementInternal.style.display=this._originalCssDisplay}dispose(){if(!d.d(this.children)){for(const e of this.children)e.dispose();this._children=null}this._parent=null,this._root=null,this._delayedInitData=null,this._delayedInitHandler=null,this._delayedInitOptions=null,this._elmDOM=null,this._disposed=!0}get keytip(){return this._keytip}get hasKeytip(){return!!this._keytip}get keytipDomContainer(){return this._elmDOM}ensureKeytip(e,t,n,a){if(this.hasKeytip&&d.d(this.keytip.element)&&!d.d(e)&&!d.d(t)){e.appendChild(this.keytip.createKeytipElement());let i="";if(this.root?.classname&&"Jewel"===this.root.classname&&o.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled){const e=this.keytip.key.toLocaleLowerCase(),n=a?String.format("ktp-{0}-{1}",a,e):String.format("ktp-{0}",e);i=String.format("ktp-layer-id {0}",n),t.setAttribute("data-ktp-target",n),t.setAttribute("data-ktp-execute-target",n)}else i=n?String.format("{0} {1}",n,this.keytip.elementId):String.format("{0} {1}",l.ribbonShortcutId,this.keytip.elementId);r.a.setAriaAttribute(t,r.a.ariaDescribedByAttribute,i)}}showKeytip(e){return!(!this.visible||!this.hasKeytip)&&(!this.keytip.element&&this.keytipDomContainer&&this.keytipDomContainer.appendChild(this.keytip.createKeytipElement()),this.keytip.show(e),!0)}hideKeytip(){this.hasKeytip&&this.keytip.hide()}constructor(e,t,n,a,i=null,o=!0,r=!0){this._elmDOM=null,this._enabled=!0,this._disposed=!1,this._enabledHasBeenSet=!1,this._keytip=null,this._originalCssDisplay="",this._visibleInDOM=!0,this._parent=null,this._children=null,this.dirty=!0,this.ignoreDirtyingEvents=!1,this._delayedInitHandler=null,this._delayedInitData=null,this._delayedInitOptions=null,this._delayedInitInProgress=!1,this._lastPollTime=null,this.classname="Component",this._id=t,this._root=e,this.titleInternal=n,this._description=a,this._visible=o,r&&this.ensureChildren(),i&&(this._keytip=new l(i,this.id))}}u.addChildAlreadyAddedExcpetionMessage="Child with id '{0}' cannot be added to component id '{1}', already been added to component id '{2}'.",(0,a.a)(u,"Component",null,[167,11])},7977:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var a=n(100),i=n(3078),o=n(625),r=n(3245),s=n(7072),l=n(346),c=n(3180);class d{addDomObject(e){this._controlComponentDomCollection[e.displayMode]=e}forEach(e){const t=this._controlComponentDomCollection;for(const n in t){e({key:n,value:t[n]}.value)}}get small(){return this._controlComponentDomCollection.Small||this._controlComponentDomCollection.Small14}get medium(){return this._controlComponentDomCollection.Medium||this._controlComponentDomCollection.Medium14}get large(){return this._controlComponentDomCollection.Large||this._controlComponentDomCollection.FloatieLarge}get smallMenu(){return this._controlComponentDomCollection.Menu||this._controlComponentDomCollection.Menu16||this._controlComponentDomCollection.MenuTellMe}get largeMenu(){return this._controlComponentDomCollection.Menu32||this._controlComponentDomCollection.Menu48}get_item(e){return this._controlComponentDomCollection[e]}clear(){this._controlComponentDomCollection={}}constructor(){this._controlComponentDomCollection={}}}(0,a.a)(d,"ControlComponentDomCache",null,[]);var u=n(7183),p=n(2980),g=n(1903),h=n(1694),m=n(6662),_=n(1825);class S{getMenuItemId(){return this.controlProperties.MenuItemId}getCommandValueId(){return g.b(this.controlProperties.CommandValueId)?this.getMenuItemId():this.controlProperties.CommandValueId}getTextValue(){return""}get id(){return this._id}get needsAKeytip(){return!1}get controlComponentDomCache(){return this._controlComponentDomCache}get isVisualRefreshEnabled(){return!!r.AFrameworkApplication.activeFrame&&r.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled}connectControlBehaviorIfAvailable(){if(this.behavior)return void 0;const e=l.a.controlBehaviorFactory;e&&(this.behavior=e.getBehaviorForControl(this))}get controlProperties(){return this._properties}get stateProperties(){return g.d(this._stateProperties)&&(this._stateProperties={}),this._stateProperties}get commandProperties(){return g.d(this._commandProperties)&&(this._commandProperties={}),this._commandProperties}get isDefinitive(){return m.a.isTrue(this.controlProperties.IsDefinitive)}get shouldIgnoreTitle(){return m.a.isFalse(this.controlProperties.ShouldSetTitle)}get templateAlias(){return this.controlProperties.TemplateAlias}get ariaRole(){return this.inMenu?s.a.ariaMenuItemRole:s.a.ariaButtonRole}ensureValidDisplayMode(e){if(-1===this._displayModes.indexOf(","+e+","))throw Error.create("The display mode with name: "+e+" is not valid for this control with id: "+this.id)}refreshDOMElements(){this.onStateChanged(),this.enabled||this.onEnabledChanged(!1)}onStateChanged(){}createDOMElementForDisplayMode(e,t){this.ensureValidDisplayMode(e);const n=this.createComponentDomForDisplayMode(e);return this.controlComponentDomCache.addDomObject(n),this.behavior&&this.behavior.attachEvents(n),t&&t.hasKeytip&&this.ensureKeytipForControl(t,n.elmControl),n.elmControl}ensureKeytipForControl(e,t){e.ensureKeytip(t,t,this.parentKeytipsIds,this.parentKeytipsKeys)}getDOMElementForDisplayMode(e,t){this.ensureValidDisplayMode(e);const n=this.controlComponentDomCache.get_item(e);if(n&&n.elmControl)return n.elmControl;const a=this.createDOMElementForDisplayMode(e,t);return g.b(a.id)&&(a.id=this.id+"-"+e),this.refreshDOMElements(),a}createComponentForDisplayMode(e){const t=this.createComponentForDisplayModeInternal(e);return Array.add(this._components,t),t}get components(){return this._components}createComponentForDisplayModeInternal(e){let t;return t=c.a.isDisplayModeMenu(e)?this.root.createMenuItem(this.getComponentId(e),e,this):this.root.createControlComponent(this.getComponentId(e),e,this),t}getComponentId(e){return this.id+"-"+e+this.root.getUniqueNumber()}dispose(){this.disposed||(this.releaseEventHandlers(),this._root=null,this._components=null,this._displayModes=null,this.controlComponentDomCache.clear(),this._disposed=!0)}releaseEventHandlers(){this.controlComponentDomCache.forEach((e=>{m.a.releaseEventHandlersRecursively(e.elmControl)}))}get root(){return this._root}addDisplayMode(e){-1===this._displayModes.indexOf(","+e+",")&&(this._displayModes+=e+",")}ensureCorrectChildType(e){throw Error.create("Child Components may not be added to this type of ControlComponent.")}get displayedComponent(){if(!this._components)return null;const e=this._components.length;for(let t=0;t<e;t++){const e=this._components[t];if(e.visibleInDOM)return e}return null}get displayMode(){const e=this.displayedComponent;return e?e.displayMode:null}get activeComponentWhenVisible(){return this._activeComponentWhenVisible||(this._components&&this._components.length>0?this._components[0]:null)}set activeComponentWhenVisible(e){this._activeComponentWhenVisible=e}constructClonedControlForMenu(e,t){return this.constructClonedControl(e,t)}clone(e,t=null){const n=S.generateCloneProperties(this._properties,t);return this.constructClonedControl(e,n)}cloneForMenu(e,t=null){const n=S.generateCloneProperties(this._properties,t);return this.constructClonedControlForMenu(e,n)}onEnabledChanged(e){this.controlComponentDomCache.forEach((t=>{m.a.setEnabledOnElement(t.elmControl,e,this.controlType===S.labelControlType,this.isEditable)}))}onVisibleChanged(e){if(12===this.root.rootType&&this.displayedComponent)this.displayedComponent.elementInternal.style.display=e?"inline-block":"none";else{const t=this._components.length;for(let n=0;n<t;++n){const t=this._components[n];t.visible=e,t.onDirtyingChange()}}}get parentMenu(){if(!this._parentMenuComputed){let e=this.displayedComponent;(0,i.a)(p.a,e)&&(e=e.parent,e?.classname&&"Gallery"===e.classname&&(e=e.parent),e?.classname&&"MenuSection"===e.classname&&(e=e.parent,(0,i.a)(u.a,e)&&(this._parentMenu=e))),this._parentMenuComputed=!0}return this._parentMenu}get parentGrid(){if(!this._parentGridComputed){let e=this.displayedComponent;if((0,i.a)(p.a,e)){const t=e;let n=!1;t.control?.classname&&"ColorPicker"===t.control.classname&&(n=!0),!n&&(0,i.a)(166,t.control)&&(n=!0),n||(e=e.parent,e?.classname&&"Gallery"===e.classname&&(n=!0)),n&&(this._parentGrid=e),this._parentGridComputed=!0}}return this._parentGrid}onMenuClosed(){this.behavior&&this.behavior.onMenuClosed()}doDefaultAction(e,t,n){this.behavior&&this.behavior.doDefaultAction(e,t,n)}doDefaultActionPublic(e,t,n){this.doDefaultAction(e,t,n)}onKeyDown(e){return!!this.behavior&&this.behavior.onKeyDown(e)}onKeyUp(e){return!!this.behavior&&this.behavior.onKeyUp(e)}onPointerDown(e){return!!this.behavior&&this.behavior.onPointerDown(e)}onModalBodyPointerDown(e){return!!this.behavior&&this.behavior.onModalBodyPointerDown(e)}onModalBodyPointerUp(e){return!!this.behavior&&this.behavior.onModalBodyPointerUp(e)}onModalBodyPointerMove(e){return!!this.behavior&&this.behavior.onModalBodyPointerMove(e)}onModalBodyPointerOut(e){return!!this.behavior&&this.behavior.onModalBodyPointerOut(e)}onModalBodyClick(e){return!!this.behavior&&this.behavior.onModalBodyClick(e)}onModalBodyMouseWheel(e){return!!this.behavior&&this.behavior.onModalBodyMouseWheel(e)}get activatesOnPress(){return!1}deactivateElement(e){return!!this.behavior&&this.behavior.deactivateElement(e)}get enabled(){return this.enabledInternal}set enabled(e){this._isForceSetEnabledState||this.enabledInternal===e&&this._enabledHasBeenSet||(this.enabledInternal=e,this._enabledHasBeenSet=!0,this.onEnabledChanged(e))}forceSetEnabledState(e){this._isForceSetEnabledState=!0;const t=this.enabled;this.enabledInternal=e,t!==e&&this.onEnabledChanged(e)}get visible(){return this._visible}set visible(e){const t=e;if(!t&&!this.root.supportsInvisibleControls)throw Error.create("This root does not support dynamically showing or hiding controls.");t!==this._visible&&(this._visible=t,this.stateProperties[h.a.visible]=t,this.onVisibleChanged(t))}get disposed(){return this._disposed}setEnabledAndForceUpdate(e){this.enabledInternal=e,this.onEnabledChanged(e)}pollForStateAndUpdate(){this.behavior?(this.enabled=!0,this.behavior.pollForStateAndUpdate()):this.enabled=!1}pollForStateAndUpdateInternal(e,t,n){return this.behavior?this.behavior.pollForStateAndUpdateInternal(e,t,n):0}ensureBehaviorAttachedIfAvailable(){if(this.behavior)return;this.connectControlBehaviorIfAvailable();const e=this.behavior;e&&(this.controlComponentDomCache.forEach((0,o.a)(e,e.attachEvents,"attachEvents")),e.initialize())}focusNext(e){return!!this.behavior&&this.behavior.focusNext(e)}getDisplayedComponentElement(){const e=this.displayedComponent;return g.d(e)?null:e.elementInternal}get focusableElement(){return null}setFocusOnControl(){return!!this.behavior&&this.behavior.setFocusOnControl()}commitPendingChange(){}isStandardMenuItem(){return(0,i.a)(p.a,this.displayedComponent)&&!(this.root?.classname&&"Jewel"===this.root.classname)}isMemberOfContextMenuDropDown(){return!!this.parentMenu&&this.parentMenu.isFloatieContextMenuDropDown}get isEditable(){return!1}static generateCloneProperties(e,t){const n={};for(const t in e){const a={key:t,value:e[t]};n[a.key]=a.value}for(const e in t){const a={key:e,value:t[e]};n[a.key]=a.value}return n}static getControlSize(e){return _.a.getControlSize(e)}static updateStyle(e,t,n,a,i){switch(e){case"Large":t="cui-ctl-large";break;case"LargeNoText":case"Large30":n=!1,t="cui-ctl-large";break;case"Large16":case"Medium20":case"Medium":case"Medium14":t="cui-ctl-medium";break;case"FloatieLarge":default:t="cui-ctl";break;case"MediumCompact":t="cui-ctl-medium cui-ctl-compact";break;case"Small":case"Small14":case"Small20":case"Small24":n=!1,t="cui-ctl";break;case"Menu":case"Menu16":case"MenuTellMe":a="Menu16"===e||"MenuTellMe"===e,t="cui-ctl-menu cui-ctl-menu16";break;case"Menu20":a=!0,t="cui-ctl-menu cui-ctl-menu20";break;case"Menu32":a=!0,t="cui-ctl-menu cui-ctl-menu32";break;case"Initials":a=!0,i=!0,t="cui-ctl-menu cui-ctl-menu32";break;case"Menu48":a=!0,t="cui-ctl-menu cui-ctl-menu48";break;case"Thin":n=!1,t="cui-ctl-thin"}return{outerStyle:t,hasText:n,createPlaceholderForEmptyImage:a,hasPeopleWellIcon:i}}static setImageProperties(e,t,n,a,i,o,r){switch(e){case 0:a=t.Image32by32,i=t.Image32by32Class,o=5,r=n?"cui-ctl-iconContainer":"cui-ctl-largeIconContainer";break;case 1:a=t.Image30by30,i=t.Image30by30Class,o=14,r="cui-ctl-large30IconContainer";break;case 2:a=t.Image16by16,i=t.Image16by16Class,o=4,r="cui-ctl-large16IconContainer";break;case 3:a=t.Image24by24,i=t.Image24by24Class,o=12,r="cui-ctl-largeFloatieIconContainer";break;case 4:a=t.Image48by48,i=t.Image48by48Class,o=7;break;case 8:a=t.Image24by24,i=t.Image24by24Class,o=12,r="cui-ctl-iconContainer24";break;case 5:a=t.Image20by20,i=t.Image20by20Class,o=13,r="cui-ctl-iconContainer20";break;case 7:a=t.Image16by16,i=t.Image16by16Class,o=11,r="cui-ctl-iconContainer14";break;default:a=t.Image16by16,i=t.Image16by16Class,o=4}return{imageUrl:a,imageClass:i,imgSize:o,iconContainerClass:r}}static createLabel(e,t,n,a,i,o,r){const l=S.createElementLabel(e);if(t){0===n&&!a||3===n?(m.a.ensureCSSClassOnElement(l,"cui-ctl-largelabel"),m.a.setLargeControlText(l,i,o)):(o&&0!==n&&4!==n&&(i+=" "),m.a.ensureCSSClassOnElement(l,"cui-ctl-mediumlabel"),2===n&&m.a.ensureCSSClassOnElement(l,"UISmallFont"),m.a.setControlText(l,i,e.LabelTextUserGeneratedPlaceholderReplacements),e.AriaLabel&&(l.setAttribute(s.a.ariaLabelAttribute,e.AriaLabel),l.setAttribute("id",S.elmLabelText+r.id)));const t=e.LabelCss;g.b(t)||(l.style.cssText=t)}else 8===n?m.a.ensureCSSClassOnElement(l,"cui-ctl-small24label"):m.a.ensureCSSClassOnElement(l,"cui-ctl-smalllabel");return{returnValue:l,labelText:i}}static createDescription(e,t,n,a,i){const o=m.a.createElement("span");o.className="cui-ctl-menulabel",o.appendChild(e);const r=t.Description;return i=m.a.createElement("span"),m.a.ensureCSSClassOnElement(i,"cui-btn-menu-description"),o.appendChild(i),i.style.display="block",g.d(r)?a?.classname&&"Jewel"===a.classname||m.a.ensureCSSClassOnElement(e,"cui-ctl-mediumlabel-nodescription"):(i.innerText=r,t.AriaDescribedById&&(i.setAttribute("id",S.elmDescriptionText+n.id),i.setAttribute("aria-hidden","True")),a?.classname&&"Jewel"===a.classname||m.a.ensureCSSClassOnElement(e,"UIFontBold"),g.d(n.id)||g.d(t.AriaDescribedByText)||o.appendChild(S.createHiddenElement("elmDescriptionPreText"+n.id,t.AriaDescribedByText)),g.d(t.AriaLabelledById)||g.d(t.AriaLabelledByText)||o.appendChild(S.createHiddenElement(t.AriaLabelledById,t.AriaLabelledByText))),{returnValue:o,elmDescription:i}}static createArrow(e,t,n){let a=null;const i=m.a.createElement("img");return i.alt="",e?(a=m.a.createClusteredImageContainerNew(3,t.properties.ImageSideArrow,t.properties.ImageSideArrowClass,i,!1,!1),m.a.ensureCSSClassOnElement(a,"cui-fa-menu-arrow")):a=n.isVisualRefreshEnabled?m.a.createClusteredImageContainerNew(2,t.properties.ImageDownArrow8by8,t.properties.ImageDownArrow8by8Class,i,!0,!1):m.a.createClusteredImageContainerNew(1,t.properties.ImageDownArrow,t.properties.ImageDownArrowClass,i,!0,!1),a}static createStandardControlDOMElement(e,t,n,a,i){let o=!1;"MenuTellMeExtended"===n&&(n="MenuTellMe",o=!0),"Menu16DescriptionEnabled"===n&&(n="Menu16",o=!0);let r=a.LabelText||"";""===r&&"MenuTellMe"===n&&(r=a.LabelText=a.Alt||"");const s=c.a.isDisplayModeMenu(n);e.inMenu=s;let l=!0;const d=S.getControlSize(n);let u=!1,p=!1,h=null;({outerStyle:h,hasText:l,createPlaceholderForEmptyImage:u,hasPeopleWellIcon:p}=S.updateStyle(n,h,l,u,p));const _=S.createOuterElement(h,e,!g.d(a.Description));t.supportsEmphasizedControls&&m.a.isTrue(a.IsEmphasized)&&m.a.ensureCSSClassOnElement(_,"cui-emphasized");let f=a.Alt;g.b(f)&&(f=r),l&&f===r||(_.title=f);let C=null,y=null,A=null,b=null,T=null,v=0,w="cui-ctl-iconContainer";({imageUrl:b,imageClass:T,imgSize:v,iconContainerClass:w}=S.setImageProperties(d,a,s,b,T,v,w));const F=!g.b(b);if(p)y=m.a.createElement("div"),m.a.ensureCSSClassOnElement(y,"cui-ctl-initials"),w="cui-ctl-initials",y.innerText="KB";else if(F||u){C=m.a.createElement("img"),C.alt="";const e=m.a.createClusteredImageContainerNew(v,b,T,C,!0,!1);y=m.a.createElement("span"),y.className=w,y.appendChild(e)}let I=null;(l||i)&&({labelText:r,returnValue:I}=S.createLabel(a,l,d,s,r,i,e));let E=null;((0===d||4===d)&&s||o&&!g.b(a.Description))&&(m.a.ensureCSSClassOnElement(I,"cui-btn-title"),({elmDescription:A,returnValue:E}=S.createDescription(I,a,e,t,A)));let M=null;i&&(M=S.createArrow(s,t,e)),g.d(y)||_.appendChild(y),g.d(E)?g.d(I)||_.appendChild(I):_.appendChild(E),g.d(M)||(s?_.appendChild(M):3===d&&!g.d(y)&&i?y.appendChild(M):g.d(E)?I.appendChild(M):E.appendChild(M));return{returnValue:_,elmControlLabel:I,elmControlImage:C,elmControlDescription:A,elmControlIconContainer:y}}static createElementLabel(e){return e.hasOwnProperty("For")?m.a.createElement("label"):m.a.createElement("span")}static createOuterElement(e,t,n=!1){const a=t.controlType===S.labelControlType?m.a.createBlockSpan():m.a.createNoOpLink();return m.a.ensureCSSClassOnElement(a,e),a.setAttribute("mscui:controltype",t.controlType),"1959943459"===t.controlProperties.Command||"2155708348"===t.controlProperties.Command?a.setAttribute(s.a.ariaRoleAttribute,s.a.ariaLinkRole):t.controlType!==S.labelControlType&&a.setAttribute(s.a.ariaRoleAttribute,t.ariaRole),n&&a.setAttribute(s.a.ariaDescribedByAttribute,S.elmDescriptionPreText+t.id+" "+S.elmDescriptionText+t.id),a}static createHiddenElement(e,t){const n=m.a.createElement("span");return m.a.ensureCSSClassOnElement(n,"cui-btn-menu-"+e),n.innerText=t,t&&(n.setAttribute("id",e),n.setAttribute("aria-hidden","True"),n.setAttribute("hidden","True")),n}constructor(e,t,n){this._components=[],this._enabledHasBeenSet=!1,this._isForceSetEnabledState=!1,this.labelText=null,this.tooltip=null,this.parentKeytipsIds=null,this.parentKeytipsKeys=null,this.behavior=null,this.inMenu=!1,this._stateProperties=null,this._commandProperties=null,this._activeComponentWhenVisible=null,this._parentMenu=null,this._parentMenuComputed=!1,this._parentGrid=null,this._parentGridComputed=!1,this._disposed=!1,this.enabledInternal=!1,this.classname="Control",this._root=e,this._id=t,this._properties=n,this._displayModes=",",this._controlComponentDomCache=new d,this._visible=!m.a.isFalse(n.Visible),this.stateProperties[h.a.sourceControlId]=t,e.registerControl(this),this.connectControlBehaviorIfAvailable()}}S.buttonControlType="Button",S.colorPickerControlType="ColorPicker",S.comboBoxControlType="ComboBox",S.contextMenuControlType="ContextMenuControl",S.contextMenuLauncherControlType="ContextMenuLauncher",S.dialogMenuLauncherControlType="DialogMenuLauncher",S.fileMenuButtonControlType="FileMenuButton",S.flyoutAnchorControlType="FlyoutAnchor",S.galleryButtonControlType="GalleryButton",S.insertTableControlType="InsertTable",S.jewelMenuLauncherControlType="JewelMenuLauncher",S.labelControlType="Label",S.placeholderControlType="Placeholder",S.searchBoxControlType="SearchBox",S.separatorControlType="Separator",S.splitButtonControlType="SplitButton",S.statefulColorFlyoutAnchorControlType="StatefulColorFlyoutAnchor",S.statefulColorSplitButtonControlType="StatefulColorSplitButton",S.statefulImageSplitButtonControlType="StatefulImageSplitButton",S.sliderControlType="Slider",S.spinnerControlType="Spinner",S.textBoxControlType="TextBox",S.toggleButtonControlType="ToggleButton",S.dropDownControlType="DropDown",S.elmDescriptionPreText="elmDescriptionPreText",S.elmDescriptionText="elmDescriptionText",S.elmLabelText="LabelText",S.activeClassName="cui-ctl-active",(0,a.a)(S,"Control",null,[11,167,168,169])},346:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static get controlBehaviorFactory(){return i._instance}static set controlBehaviorFactory(e){i._instance=e}}i._instance=null,(0,a.a)(i,"ControlBehaviorFactoryProvider",null,[])},3180:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(37);class o extends i.a{get displayMode(){return this.title}isMenuItem(){return o.isDisplayModeMenu(this.displayMode)}refreshInternal(){this.dirty=!1}get elementInternal(){return this.control.getDOMElementForDisplayMode(this.title,this)}set elementInternal(e){throw Error.create("Cannot set the DOM Element of ControlComponents.  They get their DOM Elements from the Control.")}get componentElement(){return super.elementInternal}get control(){return this._control}get enabled(){return this.control.enabled}set enabled(e){this.control.enabled=e}get visible(){return!(this.root.supportsInvisibleControls&&!this.control.visible)&&super.visible}set visible(e){super.visible=e}get keytipDomContainer(){return this.control.displayedComponent.elementInternal}onEnabledChanged(e){this.control.onEnabledChanged(e)}ensureCorrectChildType(e){this.control.ensureCorrectChildType(e)}get textValue(){return this.control.getTextValue()}pollForStateAndUpdateInternal(){this.control.pollForStateAndUpdate()}ensureBehaviorAttached(){this.control.ensureBehaviorAttachedIfAvailable()}onMenuClosed(){this.control.onMenuClosed()}setFocusOnFirstControl(){return this.control.setFocusOnControl()}dispose(){this.control.dispose(),this._control=null,super.dispose()}static isDisplayModeMenu(e){return e.startsWith("Menu")||"Initials"===e}constructor(e,t,n,a){super(e,t,n,"",a.controlProperties.Keytip,void 0,!1),this.classname="ControlComponent",this._control=a,this.visible=this.control.visible}}(0,a.a)(o,"ControlComponent",i.a,[])},4710:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(1825),o=n(6662);class r{get displayMode(){return this._displayMode}setLabelText(e){let t=!1;this._domStrategy&&(t=this._domStrategy.updateLabel(this.elmLabel,e)),!t&&this.elmLabel&&("Large"===this.displayMode||"Large16"===this.displayMode||"FloatieLarge"===this.displayMode?o.a.setLargeControlText(this.elmLabel,e,!1):this.elmLabel.innerText=e)}setTooltip(e){this.elmControl&&(!i.a.hasTextSpace(this.displayMode)||this.elmLabel&&this.elmLabel.innerText!==e)&&(this.elmControl.title=e)}constructor(e,t=null,n=null){this.elmLabel=null,this.elmDescription=null,this.elmImage=null,this.elmIconContainer=null,this._displayMode=e,this.elmControl=t,this._domStrategy=n}}(0,a.a)(r,"ControlComponentDom",null,[])},1825:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static focusNextIndexInGrid(e,t,n,a){switch(a){case 0:return i.focusForwardIndex(e,n);case 1:return i.focusBackwardIndex(e,n);case 2:return i.focusLeftIndex(e,t,n);case 4:return i.focusRightIndex(e,t,n);case 5:return i.focusUpIndex(e,t,n);case 6:return i.focusDownIndex(e,t,n);default:return-1}}static focusForwardIndex(e,t){const n=-1===e?0:e+1;return n<t?n:e}static focusBackwardIndex(e,t){const n=-1===e?t-1:e-1;return n>=0?n:e}static focusLeftIndex(e,t,n){let a;if(-1===e)a=n-1;else{a=e%t>0?e-1:Math.min(e+(t-1),n-1)}return a}static focusRightIndex(e,t,n){let a;if(-1===e)a=0;else{const i=e%t;a=i<t-1&&e<n-1?e+1:e-i}return a}static focusUpIndex(e,t,n){let a;if(-1===e){const e=n%t;a=e?n-e:n-t}else a=e-t;return a>=0?a:e}static focusDownIndex(e,t,n){const a=-1===e?0:e+t;return a<n?a:e}static hasTextSpace(e){switch(e){case"LargeNoText":case"Large30":case"Small":case"Small14":case"Small20":case"Small24":case"Thin":return!1}return!0}static getControlSize(e){let t=6;switch(e){case"Large":case"LargeNoText":case"Menu32":case"Initials":t=0;break;case"Large30":t=1;break;case"Large16":t=2;break;case"FloatieLarge":t=3;break;case"Medium20":case"Small20":case"Menu20":t=5;break;case"Medium14":case"Small14":t=7;break;case"Small24":t=8;break;case"Menu48":t=4}return t}}(0,a.a)(i,"ControlStatic",null,[])},8002:function(e,t,n){"use strict";n.d(t,{a:function(){return f}});var a=n(100),i=n(7977),o=n(7072),r=n(3909),s=n(7158),l=n(4710),c=n(6662);class d extends s.a{buildControlDom(e,t){const n=e.controlProperties,a=i.a.createOuterElement("cui-footerbutton",e),o=c.a.createElement("span");return o.appendChild(document.createTextNode(n.LabelText)),a.title=n.Description,a.appendChild(o),new l.a(t,a)}constructor(){super()}}(0,a.a)(d,"MenuFooterButtonDomStrategy",s.a,[]);class u extends s.a{buildControlDom(e,t){const n=e.controlProperties,a=c.a.createElement("img"),o=c.a.createClusteredImageContainerNew(5,n.Image32by32,n.Image32by32Class,a,!0,!1);c.a.ensureCSSClassOnElement(o,"cui-img-32by32"),c.a.ensureCSSClassOnElement(o,"cui-headerbutton-img");const r=u.createLabelDomElement(n.LabelText),s=i.a.createOuterElement("cui-ctl-medium cui-headerbutton",e);return s.title=n.Description,o.appendChild(a),s.appendChild(o),s.appendChild(r),new l.a(t,s)}static createLabelDomElement(e){const t=c.a.createElement("span");return t.className="cui-ctl-mediumlabel",t.appendChild(document.createTextNode(e)),t}constructor(){super()}}(0,a.a)(u,"MenuHeaderButtonDomStrategy",s.a,[]);class p extends s.a{buildControlDom(e,t){const n=e.controlProperties,a=c.a.createElement("img"),o=c.a.createClusteredImageContainerNew(5,n.Image32by32,n.Image32by32Class,a,!0,!1);c.a.ensureCSSClassOnElement(o,"cui-img-32by32");let r=null;r=c.a.createElement("span"),r.className="cui-ctl-menulabel cui-mrubutton-textcontainer",r.appendChild(p.createLabelDomElement(n.LabelText)),r.appendChild(p.createDescriptionDomElement(n.Description));const s=i.a.createOuterElement("cui-ctl-medium cui-mrubutton",e);return s.title=n.LabelText,s.appendChild(o),s.appendChild(r),new l.a(t,s)}static createDescriptionDomElement(e){const t=c.a.createElement("span");return t.className="UIFont cui-mrubutton-description",t.appendChild(document.createTextNode(e)),t}static createLabelDomElement(e){const t=c.a.createElement("span");return t.className="cui-mrubutton-title",t.appendChild(document.createTextNode(e)),t}constructor(){super()}}(0,a.a)(p,"MruButtonDomStrategy",s.a,[]);var g=n(3896),h=n(5149);const m="retry";class _ extends s.a{buildControlDom(e,t){const n=e.controlProperties;let a="cui-ctl-medium",o=!1,r=!1;const s=c.a.createElement("img");void 0!==n.Image95by123&&null!==n.Image95by123?(s.src=n.Image95by123,s.className="cui-img-95by123",a+=" cui-templatebutton-portrait",o=!0):void 0!==n.Image123by95&&null!==n.Image123by95?(s.src=n.Image123by95,s.className="cui-img-123by95",a+=" cui-templatebutton-landscape"):void 0!==n.Image123by69&&null!==n.Image123by69?(s.src=n.Image123by69,s.className="cui-img-123by69",a+=" cui-templatebutton-shortlandscape"):void 0!==n.Image100by100&&null!==n.Image100by100&&(s.src=n.Image100by100,s.className="cui-img-100by100",a+=" cui-templatebutton-square",r=!0),$addHandler(s,"load",(()=>{_.logThumbnailPerfAndRetryIfNecessary(s,!0)})),$addHandler(s,"error",(()=>{_.logThumbnailPerfAndRetryIfNecessary(s,!1)}));const d=c.a.createElement("div"),u=_.createLabelDomElement(n.LabelText,o,r),p=i.a.createOuterElement(a,e);return p.title=n.LabelText,d.appendChild(s),p.appendChild(d),p.appendChild(u),new l.a(t,p)}static createLabelDomElement(e,t,n){const a=c.a.createElement("span");return a.className="UIFont cui-templatebutton-label-"+(t?"portrait":n?"square":"landscape"),a.appendChild(document.createTextNode(e)),a}static logThumbnailPerfAndRetryIfNecessary(e,t){const n=e.getAttribute(m);if("l"===n)return;const a="r"===n,i=e.src,o={ThumbnailUrl:i,CompletedSuccessfully:t,IsRetry:a},r=window.performance;if(r&&void 0!==r.getEntriesByName){const e=r.getEntriesByName(i);if(e&&e.length>0){const t=e[0];o.Duration=parseInt(String(t.duration)),o.FetchStart=parseInt(String(t.fetchStart)),o.ResponseEnd=parseInt(String(t.responseEnd))}}if(h.ULS.sendTraceTag(4515987,202,t?50:15,"Template thumbnail download finished {0}",o),!t)if(a)e.setAttribute(m,"l");else{const t=e.src;e.src=null,e.src=t,e.setAttribute(m,"r")}}constructor(){super()}}(0,a.a)(_,"TemplateButtonDomStrategy",s.a,[]);var S=n(1903);class f extends i.a{createComponentDomForDisplayMode(e){let t=null;const n=this.getDomElementCreationStrategy(e);if(n){if(t=n.buildControlDom(this,e),this.hasPopup&&o.a.setAriaAttribute(t.elmControl,o.a.ariaHasPopupAttribute,o.a.ariaTrueValue),12===this.root.rootType){const n=!S.b(this.controlProperties.Image16by16);(!n&&"Medium"===e||n&&"Small"===e)&&(Sys.UI.DomElement.addCssClass(t.elmControl,"showBorder"),"Medium"===e&&Sys.UI.DomElement.addCssClass(t.elmLabel,"showBorder"))}if(19===this.root.rootType&&!S.b(this.controlProperties.ShortcutHint)){c.a.ensureCSSClassOnElement(t.elmControl,"cui-shortcut-container");const e=c.a.createElement("span");e.innerText=this.controlProperties.ShortcutHint,e.className=t.elmLabel.className,c.a.ensureCSSClassOnElement(e,"cui-shortcut-hint"),t.elmControl.appendChild(e)}const a="Initials"===t.displayMode?t.elmIconContainer:t.elmImage;this.setIconBackgroundColor(a)}else 0;return t}getDomElementCreationStrategy(e){switch(e){case"MenuMru":return new p;case"MenuTemplate":return new _;case"MenuHeader":return new u;case"MenuFooter":return new d;default:return new g.a}}get controlType(){return this.root?.classname&&"Jewel"===this.root.classname?i.a.fileMenuButtonControlType:i.a.buttonControlType}get needsAKeytip(){return!0}getTextValue(){return this.labelText}get focusableElement(){return this.getDisplayedComponentElement()}get activatesOnPress(){return!this.isStandardMenuItem()}setIconBackgroundColor(e){e&&""!==this.controlProperties.ImageBackColor&&(e.style.backgroundColor=this.controlProperties.ImageBackColor)}get hasPopup(){return this.stateProperties[r.a.HasPopup]}constructClonedControl(e,t){return new f(e,this.id,t)}constructor(e,t,n){super(e,t,n),this.addDisplayMode("Small"),this.addDisplayMode("Small14"),this.addDisplayMode("Small20"),this.addDisplayMode("Small24"),this.addDisplayMode("Medium"),this.addDisplayMode("Medium14"),this.addDisplayMode("Medium20"),this.addDisplayMode("MediumCompact"),this.addDisplayMode("Large"),this.addDisplayMode("Large16"),this.addDisplayMode("Large30"),this.addDisplayMode("LargeNoText"),this.addDisplayMode("Menu"),this.addDisplayMode("Menu16"),this.addDisplayMode("Menu16DescriptionEnabled"),this.addDisplayMode("MenuTellMe"),this.addDisplayMode("MenuTellMeExtended"),this.addDisplayMode("Menu20"),this.addDisplayMode("Menu32"),this.addDisplayMode("Menu48"),this.addDisplayMode("MenuFooter"),this.addDisplayMode("MenuHeader"),this.addDisplayMode("MenuMru"),this.addDisplayMode("MenuTemplate"),this.addDisplayMode("FloatieLarge"),this.addDisplayMode("Initials"),this.stateProperties[r.a.LabelText]=this.labelText=this.controlProperties.LabelText,this.stateProperties[r.a.Visible]=this.visible,this.stateProperties[r.a.HasPopup]=c.a.isTrue(n.HasPopup),this.stateProperties[r.a.Alt]=S.b(this.controlProperties.Alt)?this.controlProperties.LabelText:this.controlProperties.Alt}}(0,a.a)(f,"Button",i.a,[167,172])},3909:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(1694);class o{}o.LabelText=i.a.labelText,o.Alt=i.a.alt,o.Image16by16Class=i.a.image16by16Class,o.Image32by32Class=i.a.image32by32Class,o.Image48by48Class=i.a.image48by48Class,o.Visible=i.a.visible,o.HasPopup="HasPopup",(0,a.a)(o,"ButtonCommandProperties",null,[])},3360:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(7977),o=n(7072),r=n(4710);class s extends r.a{constructor(e,t){super(e,t),this.aTags=[],this.colorCells=[]}}(0,a.a)(s,"ColorPickerComponentDom",r.a,[]);var l=n(6662),c=n(8103);class d extends i.a{get width(){return this._width}get colorPickerDom(){return this._colorPickerDom}get controlType(){return i.a.colorPickerControlType}createComponentDomForDisplayMode(e){const t=l.a.createElement("table");1===this.root.textDirection?t.dir="rtl":t.dir="ltr",t.className="cui-smenu-inner cui-colorpicker-table",t.setAttribute("cellSpacing","0"),t.setAttribute("cellPadding","0"),t.setAttribute("mscui:controltype",this.controlType),t.setAttribute(o.a.ariaRoleAttribute,o.a.ariaGridRole);const n=new s(e,t),a=l.a.createElement("tbody");return this.addColorCells(n,a,this._colors),t.appendChild(a),this._colorPickerDom=n,n}addColorCells(e,t,n){let a=null;const i=t.ownerDocument,r=n.length/this.width;let s=0,u=0;const p=l.a.isTrue(this.properties.McuLayout);for(let g=0;g<n.length;g++){u++,g%this.width||(s++,u=1,a=i.createElement("tr"),a.setAttribute(o.a.ariaRoleAttribute,o.a.ariaRowRole),a.setAttribute(o.a.ariaLabelAttribute,String.format((0,c.a)("GalleryRowAccessibleLabelFormat"),s)),t.appendChild(a),d.setRowCssClass(a,s,r,p));const h=i.createElement("td");h.className="cui-colorpicker-cell",h.setAttribute("arrayPosition",String.format("{0}",g)),h.setAttribute(o.a.ariaRoleAttribute,o.a.ariaPresentationRole),!p&&this.width<6&&l.a.ensureCSSClassOnElement(h,"cui-colorpicker-cell-large"),1===u&&l.a.ensureCSSClassOnElement(h,"cui-colorpicker-firstcol"),a.appendChild(h);const m=l.a.createNoOpLink(),_=n[g].Title;m.title=_,m.setAttribute(o.a.ariaRoleAttribute,o.a.ariaGridCellRole),m.className="cui-colorpicker-cell-a";const S=i.createElement("canvas");S.className="cui-colorpicker-celldiv";const f=S.getContext("2d");f.fillStyle=n[g].DisplayColor,f.fillRect(0,0,S.width,S.height);const C=i.createElement("div");C.className="cui-colorpicker-cellinternaldiv",h.appendChild(m),m.appendChild(S),S.appendChild(C),h[d.colorInformation]=n[g].Color,Array.add(e.colorCells,h),Array.add(e.aTags,m)}}get properties(){return this.controlProperties}constructClonedControl(e,t){return new d(e,this.id,t,this._colors)}static setRowCssClass(e,t,n,a){1===t&&l.a.ensureCSSClassOnElement(e,"cui-colorpicker-firstrow"),a?1===t?l.a.ensureCSSClassOnElement(e,"cui-colorpicker-mcurow"):(l.a.ensureCSSClassOnElement(e,"cui-colorpicker-compactrow"),2===t?l.a.ensureCSSClassOnElement(e,"cui-colorpicker-firstcompactrow"):t===n&&l.a.ensureCSSClassOnElement(e,"cui-colorpicker-lastcompactrow")):l.a.ensureCSSClassOnElement(e,"cui-colorpicker-spacedrow")}constructor(e,t,n,a){super(e,t,n),this._colorPickerDom=null,this.classname="ColorPicker",this.addDisplayMode("Menu"),this._colors=a,this._width=parseInt(n.Width)}}d.colorInformation="ColorInformation",(0,a.a)(d,"ColorPicker",i.a,[167,172])},2666:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.Color="Color",i.IndexColorSelected="ColorSelected",(0,a.a)(i,"ColorPickerCommandProperties",null,[])},1892:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.IsFreeForm="IsFreeForm",i.Value="Value",i.Key="Key",i.FontStyle="FontStyle",(0,a.a)(i,"ComboBoxCommandProperties",null,[])},7158:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get focusableElement(){return null}updateLabel(e,t){return!1}}(0,a.a)(i,"IControlDomStrategy",null,[])},3896:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(7158),o=n(7977),r=n(4710);class s extends i.a{buildControlDom(e,t){const n=new r.a(t);return n.elmControl=({elmControlLabel:n.elmLabel,elmControlImage:n.elmImage,elmControlDescription:n.elmDescription,elmControlIconContainer:n.elmIconContainer}=o.a.createStandardControlDOMElement(e,e.root,t,e.controlProperties,this._hasArrow)).returnValue,n}constructor(e=!1){super(),this._hasArrow=e}}(0,a.a)(s,"StandardControlDomStrategy",i.a,[])},6990:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.SelectedItemId="SelectedItemId",(0,a.a)(i,"DropDownCommandProperties",null,[])},5699:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var a=n(100),i=n(3455),o=n(7072),r=n(7977),s=n(3180),l=n(3896),c=n(1091),d=n(7693),u=n(6662);class p extends i.a{get useCheckMark(){return this._useCheckMark}get ariaRole(){return this.inMenu?this.useCheckMark?o.a.ariaTreeItemRole:o.a.ariaTabRole:super.ariaRole}onStateChanged(){const e=this.stateProperties[d.a.On];this.useCheckMark&&(this.stateProperties[o.a.ariaCheckedAttribute]=e?o.a.ariaTrueValue:o.a.ariaFalseValue),this.controlComponentDomCache.forEach((t=>{this.updateAriaMenuLauncherAttributes(t.elmControl,e)}))}createComponentDomForDisplayMode(e){const t=!u.a.isTrue(this.properties$2.HideDefaultArrow),n=new l.a(t).buildControlDom(this,e);return this.populateControlDom(n,e),n}populateControlDom(e,t){u.a.isTrue(this.properties$2.FloatieContextMenuDropDown)&&u.a.ensureCSSClassOnElement(e.elmControl,"context-menu-dd"),s.a.isDisplayModeMenu(t)&&u.a.ensureCSSClassOnElement(e.elmControl,"cui-fa-menuitem"),t.startsWith("Small")&&u.a.ensureCSSClassOnElement(e.elmControl,"cui-fa-sm"),this.setInitialAriaMenuLauncherAttributes(e.elmControl)}setInitialAriaMenuLauncherAttributes(e){this.useCheckMark&&o.a.setAriaAttribute(e,o.a.ariaCheckedAttribute,o.a.ariaFalseValue),super.setInitialAriaMenuLauncherAttributes(e)}updateAriaMenuLauncherAttributes(e,t){const n=this.menuLaunched?o.a.ariaTrueValue:o.a.ariaFalseValue;this.useCheckMark?o.a.setAriaAttribute(e,o.a.ariaCheckedAttribute,t?o.a.ariaTrueValue:o.a.ariaFalseValue):this.inMenu&&o.a.setAriaAttribute(e,o.a.ariaSelectedAttribute,n),o.a.setAriaAttribute(e,o.a.ariaExpandedAttribute,n)}get controlType(){return r.a.flyoutAnchorControlType}get imageIsVisible(){return this._imageIsVisible}set imageIsVisible(e){const t=e;t!==this._imageIsVisible&&(this._imageIsVisible=t,this.onImageVisibleChanged(t))}onImageVisibleChanged(e){this.controlComponentDomCache.forEach((t=>{this.setDisplay(t.elmIconContainer,e)}))}setDisplay(e,t){e&&(e.style.display="",e.style.visibility="",t||(this._imageUsesSpaceWhileInvisible?e.style.visibility="hidden":e.style.display="none"))}get menuDirection(){let e=2;return this.displayedComponent.isMenuItem()?e=1:this.root.launchMenusUp&&(e=3),e}get launcherComponent(){return this.displayedComponent}getTextValue(){return this.labelText}get properties$2(){return this.controlProperties}constructClonedMenuLauncher(e,t,n){return new p(e,this.id,t,n)}getControlsInFlyoutAnchorMenu(){const e=new Array(0);for(const t of this.menu.children){0;for(const n of t.children)e[e.length]=n.control}return e}constructor(e,t,n,a){super(e,t,n,a),this.addDisplayMode("Small"),this.addDisplayMode("Small14"),this.addDisplayMode("Medium"),this.addDisplayMode("Medium14"),this.addDisplayMode("Large"),this.addDisplayMode("Large16"),this.addDisplayMode("Thin"),this.addDisplayMode("Menu"),this.addDisplayMode("Menu16"),this.addDisplayMode("Menu32"),this.addDisplayMode("Menu48"),this.addDisplayMode("MenuTellMe"),this.addDisplayMode("FloatieLarge"),this.addDisplayMode("Small20"),this.addDisplayMode("Small24"),this.addDisplayMode("Medium20"),this.isFloatieContextMenuDropDown=u.a.isTrue(this.properties$2.FloatieContextMenuDropDown),this._imageIsVisible=!u.a.isFalse(n.ImageIsVisible),this._imageUsesSpaceWhileInvisible=u.a.isTrue(n.ImageUsesSpaceWhileInvisible),this.stateProperties[c.a.SourceControlId]=t,this.stateProperties[c.a.LabelText]=this.labelText=this.properties$2.LabelText,this.stateProperties[c.a.LabelTextUserGeneratedPlaceholderReplacements]=this.properties$2.LabelTextUserGeneratedPlaceholderReplacements,this.stateProperties[c.a.Visible]=this.visible,this.stateProperties[c.a.ImageIsVisible]=this.imageIsVisible,this.stateProperties[c.a.ImageBackColor]=this.properties$2.ImageBackColor,this._useCheckMark=u.a.isTrue(n.UseCheckMark),this.stateProperties[c.a.On]=u.a.isTrue(n.IsChecked)}}(0,a.a)(p,"FlyoutAnchor",i.a,[172])},1091:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(1694);class o{}o.LabelText=i.a.labelText,o.LabelTextUserGeneratedPlaceholderReplacements=i.a.labelTextUserGeneratedPlaceholderReplacements,o.Visible=i.a.visible,o.ImageIsVisible="ImageIsVisible",o.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible",o.Image16by16Class=i.a.image16by16Class,o.Image32by32Class=i.a.image32by32Class,o.Image48by48Class=i.a.image48by48Class,o.ImageBackColor="ImageBackColor",o.On="On",o.SourceControlId="SourceControlId",(0,a.a)(o,"FlyoutAnchorCommandProperties",null,[])},5503:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.Alt="Alt",i.CommandValueId="CommandValueId",i.InnerHTML="InnerHTML",i.On="On",i.IsRtl="IsRtl",i.GalleryButtonProps="GalleryButtonProps",i.Text="Text",i.HighlightOn="HighlightOn",(0,a.a)(i,"GalleryButtonCommandProperties",null,[])},6522:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(7977),o=n(7072),r=n(4710);class s extends r.a{constructor(e){super(e),this.elmTBody=null,this.cellATags=null,this.cells=null,this.innerDivs=null,this.outerDivs=null}}(0,a.a)(s,"InsertTableComponentDom",r.a,[]);var l=n(6662);class c extends i.a{get insertTableDom(){return this._insertTableDom}createComponentDomForDisplayMode(e){return this._insertTableDom=this.createInsertTableDom(e),this.insertTableDom}createInsertTableDom(e){const t=l.a.createElement("table");t.setAttribute(o.a.ariaRoleAttribute,o.a.ariaGridRole),t.setAttribute("mscui:controltype",this.controlType);const n=l.a.createElement("tbody");let a,i,r,d,u;n.className="cui-it",t.setAttribute("cellspacing","0"),t.setAttribute("cellpadding","0"),n.setAttribute("cellspacing","0"),n.setAttribute("cellpadding","0");const p=new Array(c.numCells),g=new Array(c.numCells),h=new Array(c.numCells),m=new Array(c.numCells);let _=0;for(let e=0;e<c.numRows;e++){a=l.a.createElement("tr"),a.setAttribute(o.a.ariaRoleAttribute,o.a.ariaRowRole),n.appendChild(a),e||l.a.ensureCSSClassOnElement(a,"cui-it-firstrow"),e>=c.numRowsInTouch&&l.a.ensureCSSClassOnElement(a,"cui-hideInTouch");for(let t=0;t<c.numCols;t++)i=l.a.createElement("td"),t||l.a.ensureCSSClassOnElement(i,"cui-it-firstcol"),t>=c.numColsInTouch&&e<=c.numRowsInTouch&&l.a.ensureCSSClassOnElement(i,"cui-hideInTouch"),i.setAttribute(o.a.ariaRoleAttribute,o.a.ariaPresentationRole),a.appendChild(i),r=l.a.createElement("a"),r.setAttribute(o.a.ariaRoleAttribute,o.a.ariaGridCellRole),l.a.addToTabLoop(r),d=l.a.createElement("div"),d.className="cui-it-inactiveCell",u=l.a.createElement("div"),u.id=this.id+"-"+_,u.className="cui-it-inactiveCellOuter",i.appendChild(u),u.appendChild(d),d.appendChild(r),p[_]=i,m[_]=r,g[_]=d,h[_]=u,_++}t.appendChild(n);const S=new s(e);return S.elmControl=t,S.elmTBody=n,S.cells=p,S.cellATags=m,S.innerDivs=g,S.outerDivs=h,this._insertTableDom=S,S}get controlType(){return i.a.insertTableControlType}constructClonedControl(e,t){return new c(e,this.id,t)}constructor(e,t,n){super(e,t,n),this._insertTableDom=null,this.addDisplayMode("Menu")}}c.numCols=10,c.numRows=8,c.numCells=80,c.maxIdx=79,c.numColsInTouch=8,c.numRowsInTouch=6,(0,a.a)(c,"InsertTable",i.a,[166])},6244:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.Rows="Rows",i.Columns="Columns",(0,a.a)(i,"InsertTableCommandProperties",null,[])},3823:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(1694);class o{}o.Value="Value",o.Image16by16Class="Image16by16Class",o.Alt="Alt",o.Visible=i.a.visible,o.SecondaryLabel="SecondaryLabel",o.LinkInfo="LinkInfo",(0,a.a)(o,"LabelCommandProperties",null,[])},10:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.Value="value",i.MinValue="MinValue",i.MaxValue="MaxValue",i.Text="Text",(0,a.a)(i,"SliderCommandProperties",null,[])},8870:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.Alt="Alt",i.Number="Number",i.UnitType="UnitType",i.Text="Text",i.MaxValue="MaxValue",(0,a.a)(i,"SpinnerCommandProperties",null,[])},5837:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.Image16by16Class="Image16by16Class",i.Image32by32Class="Image32by32Class",i.On="On",i.LabelText="LabelText",i.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly",i.EnsureControlRoleIsButton="EnsureControlRoleIsButton",i.Visible="Visible",(0,a.a)(i,"SplitButtonCommandProperties",null,[])},3497:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.Text="Text",(0,a.a)(i,"TextBoxCommandProperties",null,[])},4773:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var a=n(100),i=n(7977),o=n(7072),r=n(3180),s=n(3896),l=n(7693),c=n(1903),d=n(6662);class u extends i.a{get useCheckMark(){return this._useCheckMark}get usePseudoCheckMark(){return this._usePseudoCheckMark}get useUncheckedImage(){return this._useUncheckedImage}get checkMarkImage(){return this._checkMarkImage}get uncheckMarkImage(){return this._uncheckMarkImage}get checkMarkImageClass(){return this._checkMarkImageClass}get uncheckMarkImageClass(){return this._uncheckMarkImageClass}createComponentDomForDisplayMode(e){this._displayMode=e;return(new s.a).buildControlDom(this,e)}get controlType(){return i.a.toggleButtonControlType}get needsAKeytip(){return!0}get ariaRole(){let e;return e=this.inMenu?this.useCheckMark||this.usePseudoCheckMark?o.a.ariaMenuItemCheckBoxRole:o.a.ariaMenuItemRadioRole:this.useCheckMark?o.a.ariaCheckBoxRole:super.ariaRole,e}onStateChanged(){this.setState(this.stateProperties[l.a.On])}getTextValue(){return this.labelText}setState(e){this.useCheckMark&&this.useUncheckedImage&&this.setCheckUncheckImageProperties(e),this.controlComponentDomCache.forEach((t=>{this.setStateOnElement(t.elmControl,e)}))}initializeCheckMarkProperties(e,t){this._useCheckMark=d.a.isTrue(t.UseCheckMark),this._usePseudoCheckMark=d.a.isTrue(t.UsePseudoCheckMark),this._useUncheckedImage=d.a.isTrue(t.UseUncheckedImage),this.useUncheckedImage&&(this._uncheckMarkImage=c.d(t.UncheckedImage)?e.properties.ImageUncheckMark:t.UncheckedImage,this._uncheckMarkImageClass=c.d(t.UncheckedImageClass)?e.properties.ImageUncheckMarkClass:t.UncheckedImageClass),this.useCheckMark&&(this._checkMarkImage=c.d(t.CheckedImage)?e.properties.ImageCheckMark:t.CheckedImage,this._checkMarkImageClass=c.d(t.CheckedImageClass)?e.properties.ImageCheckMarkClass:t.CheckedImageClass,t.Image16by16=this.checkMarkImage,t.Image16by16Class=this.checkMarkImageClass),c.d(t.IsChecked)||this.setCheckUncheckImageProperties(d.a.isTrue(t.IsChecked))}setCheckUncheckImageProperties(e){this.properties.Image16by16=e?this.checkMarkImage:this.uncheckMarkImage,this.properties.Image16by16Class=e?this.checkMarkImageClass:this.uncheckMarkImageClass}setStateOnElement(e,t){if(!c.d(e)){let n;this.useCheckMark?(this.useUncheckedImage||d.a.toggleCSSClassOnElement(e,"cui-ctl-unchkd",!t),n=o.a.ariaCheckedAttribute):(d.a.toggleCSSClassOnElement(e,"cui-ctl-on",t),n=this._displayMode&&r.a.isDisplayModeMenu(this._displayMode)?o.a.ariaCheckedAttribute:o.a.ariaPressedAttribute),o.a.setAriaAttribute(e,n,t?o.a.ariaTrueValue:o.a.ariaFalseValue)}}addDisplayModes(){this.addDisplayMode("Small"),this.addDisplayMode("Small14"),this.addDisplayMode("Small24"),this.addDisplayMode("Medium"),this.addDisplayMode("Medium14"),this.addDisplayMode("Medium20"),this.addDisplayMode("Large"),this.addDisplayMode("Large16"),this.addDisplayMode("Large30"),this.addDisplayMode("LargeNoText"),this.addDisplayMode("Menu"),this.addDisplayMode("Menu16"),this.addDisplayMode("Menu20"),this.addDisplayMode("Menu32"),this.addDisplayMode("Menu48"),this.addDisplayMode("MenuTellMe")}get focusableElement(){return this.getDisplayedComponentElement()}get activatesOnPress(){return!this.isStandardMenuItem()}get properties(){return this.controlProperties}constructClonedControl(e,t){return new u(e,this.id,t)}constructor(e,t,n){super(e,t,n),this._displayMode=null,this._useCheckMark=!1,this._usePseudoCheckMark=!1,this._useUncheckedImage=!1,this._checkMarkImage=null,this._uncheckMarkImage=null,this._checkMarkImageClass=null,this._uncheckMarkImageClass=null,this._id$1=t,this.initializeCheckMarkProperties(e,n),this.addDisplayModes(),this.stateProperties[l.a.On]=d.a.isTrue(n.IsChecked),this.stateProperties[l.a.Visible]=this.visible,this.stateProperties[l.a.SourceControlId]=t,this.stateProperties[l.a.LabelText]=this.labelText=this.properties.LabelText}}(0,a.a)(u,"ToggleButton",i.a,[172])},7693:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(1694);class o{}o.CommandValueId="CommandValueId",o.Description="Description",o.Image16by16Class=i.a.image16by16Class,o.Image30by30Class=i.a.image30by30Class,o.Image32by32Class=i.a.image32by32Class,o.Image48by48Class=i.a.image48by48Class,o.On="On",o.LabelText=i.a.labelText,o.Visible=i.a.visible,o.SourceControlId="SourceControlId",o.DisplayMode="DisplayMode",o.Alt=i.a.alt,(0,a.a)(o,"ToggleButtonCommandProperties",null,[])},2945:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(1903);class o{get name(){return o.getNodeName(this.node)}get children(){return o.getNodeChildren(this.node)}get attributes(){return o.getNodeAttributes(this.node)}get hasChildren(){return o.getNodeChildren(this.node).length>0}static getFirstChildNodeWithName(e,t){const n=o.getNodeChildren(e),a=n.length;let i=null;for(let e=0;e<a;e++){i=n[e];if(i[o.NAME]===t)return i}return null}static getNodeName(e){return e[o.NAME]}static getNodeChildren(e){const t=e[o.CHILDREN];return i.d(t)?o.emptyArray:t}static get emptyArray(){return i.d(o.s_emptyArray)&&(o.s_emptyArray=[]),o.s_emptyArray}static getNodeAttributes(e){return e[o.ATTRIBUTES]}static getNodeAttribute(e,t){return e[o.ATTRIBUTES][t]}constructor(e){this.node=e}}o.ATTRIBUTES="attrs",o.CHILDREN="children",o.NAME="name",o.ALIGNMENT="Alignment",o.ALT="Alt",o.ARIALABELLEDBYID="ariaLabelledById",o.ARRANGEMENT="Arrangement",o.ARRANGEMENTVERTICAL="Vertical",o.CLASSNAME="Classname",o.COLOR="Color",o.COMMAND="Command",o.CONTEXTUALGROUPID="ContextualGroupId",o.CSSCLASS="CssClass",o.DESCRIPTION="Description",o.DISPLAYCOLOR="DisplayColor",o.DISPLAYMODE="DisplayMode",o.DIVIDER="Divider",o.ELEMENTDIMENSIONS="ElementDimensions",o.ENABLED="Enabled",o.GREEN="Green",o.GROUPID="GroupId",o.HEIGHT="Height",o.HORIZONTALALIGNMENT="HorizontalAlignment",o.id="Id",o.IMAGE="Image",o.IMAGECLASS="ImageClass",o.IMAGE16BY16="Image16by16",o.IMAGE32BY32="Image32by32",o.INDEX="Index",o.ISSTRETCHED="IsStretched",o.KEYTIP="Keytip",o.LABELTEXT="LabelText",o.LANGUAGE="Language",o.LAYOUTTITLE="LayoutTitle",o.LOADING="Loading",o.LOWSCALEWARNING="LowScaleWarning",o.MAGENTA="Magenta",o.MAXHEIGHT="MaxHeight",o.MAXIMUMVALUE="MaximumValue",o.MAXWIDTH="MaxWidth",o.MENUITEMID="MenuItemId",o.MESSAGE="Message",o.MINHEIGHT="MinHeight",o.MINIMUMVALUE="MinimumValue",o.ONEROW="OneRow",o.ORANGE="Orange",o.OVERFLOW="Overflow",o.PURPLE="Purple",o.SCROLLABLE="Scrollable",o.SEQUENCE="Sequence",o.SHOWMENUSECTIONSEPERATOR="ShowMenuSectionSeparator",o.SHOWMENUSECTIONTITLEICON="ShowMenuSectionTitleIcon",o.SHOWMENUSECTIONTITLEBACKGROUND="ShowMenuSectionTitleBackground",o.MENUSECTIONTITLEFOCUSABLE="MenuSectionTitleFocusable",o.SHOWECTIONSEPERATOR="ShowSectionSeparator",o.SINGLEDOCK="SingleDock",o.SIZE="Size",o.STEP="Step",o.STYLE="Style",o.TEMPLATEALIAS="TemplateAlias",o.TEXTALIGN="TextAlign",o.THEME="Theme",o.THREEROW="ThreeRow",o.TITLE="Title",o.TITLEID="TitleId",o.TWOROW="TwoRow",o.TYPE="Type",o.UNITTYPE="UnitType",o.VALUE="Value",o.WIDTH="Width",o.YELLOW="Yellow",o.RIBBON="Ribbon",o.JEWEL="Jewel",o.TABS="Tabs",o.CONTEXTUALTABS="ContextualTabs",o.CONTEXTUALGROUP="ContextualGroup",o.TAB="Tab",o.SCALING="Scaling",o.MAXSIZE="MaxSize",o.SCALE="Scale",o.GROUP="Group",o.GROUPS="Groups",o.LAYOUT="Layout",o.COLLAPSIBLESECTION="CollapsibleSection",o.SECTION="Section",o.OVERFLOWSECTION="OverflowSection",o.ROW="Row",o.CONTROL="ControlRef",o.CONTROLS="Controls",o.MENU="Menu",o.MENUSECTION="MenuSection",o.TEMPLATE="Template",o.TEMPLATES="Templates",o.RIBBONTEMPLATES="RibbonTemplates",o.GROUPTEMPLATE="GroupTemplate",o.GALLERY="Gallery",o.SPECIALTEXTSTRINGS="SpecialTextStrings",o.UNIT="Unit",o.FLOATIE="Floatie",o.TOUCHGROUP="TouchGroup",o.TASKPANE="TaskPane",o.colors="Colors",o.color="Color",o.toggleButton="ToggleButton",o.comboBox="ComboBox",o.dropDown="DropDown",o.button="Button",o.splitButton="SplitButton",o.statefulColorSplitButton="StatefulColorSplitButton",o.statefulImageSplitButton="StatefulImageSplitButton",o.flyoutAnchor="FlyoutAnchor",o.statefulColorFlyoutAnchor="StatefulColorFlyoutAnchor",o.galleryButton="GalleryButton",o.insertTable="InsertTable",o.label="Label",o.searchBox="SearchBox",o.slider="Slider",o.spinner="Spinner",o.textBox="TextBox",o.colorPicker="ColorPicker",o.separator="Separator",o.placeholder="Placeholder",o.clonedControl="ClonedControl",o.jewelMenuLauncher="JewelMenuLauncher",o.BUTTONDOCK="ButtonDock",o.CENTERALIGN="Center",o.DOCKS="Docks",o.HERODOCK="HeroDock",o.LEFTALIGN="Left",o.RIGHTALIGN="Right",o.FIRSTTOLAST="Begin",o.LASTTOFIRST="End",o.TOOLBAR="Toolbar",o.STATUSBAR="StatusBar",o.LARGE="Large",o.MEDIUM="Medium",o.SMALL="Small",o.DIVIDERAFTER="DividerAfter",o.DIVIDERBEFORE="DividerBefore",o.s_emptyArray=null,(0,a.a)(o,"DataNodeWrapper",null,[])},5200:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(37),o=n(7072),r=n(6662),s=n(1825),l=n(8103);class c extends i.a{get domElementTagName(){return"table"}get cssClass(){return"cui-gallery"}refreshInternal(){this.ensureDOMElementAndEmpty(),this.elementInternal.setAttribute(o.a.ariaRoleAttribute,o.a.ariaGridRole);const e=r.a.createElement("tbody");this.elementInternal.appendChild(e),this.appendChildrenToElement(e)}appendChildrenToElement(e){const t=Math.ceil(this.children.count/this.width);let n,a,i,s=0;for(let c=0;c<t;c++){n=r.a.createElement("tr"),n.setAttribute(o.a.ariaRoleAttribute,o.a.ariaRowRole),n.setAttribute(o.a.ariaLabelAttribute,String.format((0,l.a)("GalleryRowAccessibleLabelFormat"),c+1));for(let e=0;e<this.width;e++)a=r.a.createElement("td"),a.setAttribute(o.a.ariaRoleAttribute,o.a.ariaPresentationRole),a.className="cui-gallery-td cui-gallery-element-"+r.a.galleryElementDimensionsToSizeString[this.elementDimensions],s<this.children.count&&(i=this.children.get_item(s++),i.ensureDOMElement(),a.appendChild(i.elementInternal),i.ensureRefreshed()),n.appendChild(a);e.appendChild(n)}}updateFocusedIndex(e){let t=0;for(const n of this.children){if(n.updateFocusedIndex(e))return this._focusedIndex=t,!0;t++}return!1}resetFocusedIndex(){if(this.children.count){this._focusedIndex=-1;for(const e of this.children)e.resetFocusedIndex()}}focusNext(e){const t=this.children.count,n=s.a.focusNextIndexInGrid(this._focusedIndex,this.width,t,e);if(this._focusedIndex>=0&&this._focusedIndex<t&&this.children.get_item(this._focusedIndex).resetFocusedIndex(),n!==this._focusedIndex){if(this.children.get_item(n).control.setFocusOnControl())return this._focusedIndex=n,!0}return this._focusedIndex=-1,!1}ensureCorrectChildType(e){if("ControlComponent"!==e?.classname)throw Error.create("Galleries can only have children controls of type GalleryButton");const t=e;if("GalleryButton"!==t.control?.classname)throw Error.create("Galleries can only have children of type GalleryButton")}get tableElementInternal(){return this.elementInternal}set tableElementInternal(e){this.elementInternal=e}get width(){return this._width}set width(e){this._width=e}clone(e){const t=e.createGallery(this.id,this.title,this.description,this.properties);for(const n of this.children){const a=n.control.clone(e);t.addChild(a.createComponentForDisplayMode(n.displayMode))}return t}static convertStringToGalleryElementDimensions(e){switch(e){case"Size16by16":return 1;case"Size40by40":return 2;case"Size48by48":return 3;case"Size61by75":return 4;case"Size64by48":return 5;case"Size85by48":return 6;case"Size110by75":return 7;case"Size85by16":return 8;case"Size32by32":return 9;case"Size120by20":return 10;case"Size20by20":return 11;case"Size24by24":return 12;case"Size84by21":return 13;case"Size90by21":return 14;case"Size200by200":return 15;case"Size70by48":return 16;default:throw Error.argument("s","The parameter s is not a valid GalleryElementDimension")}}constructor(e,t,n,a,i){super(e,t,n,a),this._width=0,this._focusedIndex=-1,this.classname="Gallery",this.properties=i,this.width=parseInt(this.properties.Width),this.elementDimensions=c.convertStringToGalleryElementDimensions(this.properties.ElementDimensions)}}(0,a.a)(c,"Gallery",i.a,[])},3957:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var a=n(100),i=n(3078),o=n(37),r=n(3245),s=n(5699),l=n(7183),c=n(8268),d=n(6662);class u extends o.a{get visibleInDOM(){return!0}get cssClass(){return"cui-herodock"}refreshInternal(){this.refreshHeroDockVisuals(),super.refreshInternal()}ensureBehaviorAttached(){for(const e of this.heroDockControls)e.ensureBehaviorAttachedIfAvailable();super.ensureBehaviorAttached()}splitHeroDockControls(){const e=new Array(0),t=new Array(0),n=new Array(0);for(let a=0;a<this.heroDockControls.length;a++){const o=this.heroDockControls[a];o.visible?e.length<this.heroControlCount?e.push(o):(0,i.a)(s.a,o)?Array.addRange(t,o.getControlsInFlyoutAnchorMenu()):t.push(o):n.push(o)}return{topLevelControls:e,overflowControls:t,invisibleControls:n}}createOverflowMenu(e){if(!e||!e.length)return null;const t={DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},n=new l.a(this.root,this.id+"OverflowMenu",null,null,null),a=new c.a(this.root,this.id+"OverflowMenuSection",null,null,t,n);for(const t of e)a.addChild(t.createComponentForDisplayMode("Menu20"));return n.addChild(a),n}refreshHeroDockVisuals(){this.removeChildren(),this.elementInternal=d.a.removeChildNodes(this.elementInternal),this.ensureDOMElement();const{topLevelControls:e,overflowControls:t,invisibleControls:n}=this.splitHeroDockControls();for(const t of e){const e=t.createComponentForDisplayMode("Medium20");e.enabled=!0,this.addChildAtIndex(e,this.children.count),this.elementInternal.appendChild(e.elementInternal),e.ensureRefreshed()}const a=this.createOverflowMenu(t);if(a){if(this._overflowFlyoutAnchor)this._overflowFlyoutAnchor.menu=a;else{0;const e=this.id+"OverflowMenuLauncher",t={};t.Image20by20=this._heroDockProperties.OverflowMenuImage20by20,t.Image20by20Class=this._heroDockProperties.OverflowMenuImage20by20Class,t.PopulateDynamically="false",t.HideDefaultArrow="true",t.Alt=this._heroDockProperties.OverflowMenuTooltip,t.Command="798637440",t.Id=e,this._overflowFlyoutAnchor=new s.a(this.root,e,t,a)}const e=this._overflowFlyoutAnchor.createComponentForDisplayMode("Small20");e.enabled=!0,this.addChildAtIndex(e,this.children.count),this.elementInternal.appendChild(e.elementInternal),e.ensureRefreshed()}if(r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const e of n){const t=e.createComponentForDisplayMode("Medium20");this.addChild(t),t.ensureRefreshed()}}dispose(){this._overflowFlyoutAnchor&&(this._overflowFlyoutAnchor.dispose(),this._overflowFlyoutAnchor=null);for(const e of this.heroDockControls)e.dispose();this.removeChildren(),super.dispose()}set visibleInDOM(e){super.visibleInDOM=e}constructor(e,t,n){super(e,t,"",""),this._overflowFlyoutAnchor=null,this.heroControlCount=u.defaultHeroControlCount,this.heroDockControls=new Array(0),this._heroDockProperties=n}}u.defaultHeroControlCount=4,(0,a.a)(u,"HeroDock",o.a,[])},5474:function(e,t,n){"use strict";n.d(t,{a:function(){return w}});var a=n(100),i=n(5149),o=n(3078),r=n(625),s=n(3455),l=n(3245),c=n(6012),d=n(2544),u=n(9855),p=n(9611),g=n(7977),h=n(4710),m=n(1903),_=n(6662),S=n(988);class f extends s.a{get parentRoot(){return this._parentRoot}get controlType(){return g.a.jewelMenuLauncherControlType}createComponentDomForDisplayMode(e){let t,n,a,i;return this._elmJewel=({elmControlLabel:t,elmControlImage:n,elmControlDescription:a,elmControlIconContainer:i}=g.a.createStandardControlDOMElement(this,this.root,e,this.properties$2,!1)).returnValue,this._elmJewel.className="cui-jewel-jewelMenuLauncher",l.AFrameworkApplication.activeFrame&&l.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled||(this._elmJewel.className+=" UITextTranformUpperCase"),this._elmJewel.id=this.properties$2.Id+"-Default",t.className="cui-jewel-label",t.innerText=this.properties$2.LabelText,this.setInitialAriaMenuLauncherAttributes(this._elmJewel),this.attachEvents(),new h.a(e,this._elmJewel)}attachEvents(){u.a.instance.registerHandler(c.a.pointerDown,this._elmJewel,(0,r.a)(this,this.onPointerDown,"onPointerDown")),d.a.instance.registerHandler(c.a.keyDown,this._elmJewel,(0,r.a)(this,this.onKeyDown,"onKeyDown")),d.a.instance.registerHandler(c.a.keyUp,this._elmJewel,(0,r.a)(this,this.onKeyUp,"onKeyUp"))}launchFileMenu(e,t,n,a,i){if(1===n)return 32;let o=0;return o=l.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&i.hasOwnProperty("InputMethod")?i.InputMethod:i,this.launchMenu(o),32}launchMenu(e){this.launchMenuWithSubmenu(e)}launchMenuWithSubmenu(e,t=null){this.enabled&&!this.menuLaunched&&(l.AFrameworkApplication.dismissSplashScreenImmediately(),super.launchMenu(e),this.menu.elementInternal&&(this.menu.elementInternal.style.position="fixed"),(1!==e||t)&&this.root.launchSubMenu(e,t))}updateAriaMenuLauncherAttributes(e,t){l.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled?appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(t)):super.updateAriaMenuLauncherAttributes(e,t)}doDefaultAction(e,t,n){super.doDefaultAction(e,t,n)}onKeyDown(e){let t=!1;return m.d(e.innerEvent)||m.d(e.innerEvent.rawEvent)||(e.innerEvent.keyCode===Sys.UI.Key.down&&(this.doDefaultAction(e.sourceElement,1,e.innerEvent),t=!0),t||(t=super.onKeyDown(e))),t}get properties$2(){return this.controlProperties}dispose(){m.d(this._elmJewel)||_.a.unregisterAllHandlers(this._elmJewel),l.AFrameworkApplication.theActionManager.removeAction(S.a.launchFileMenu,p.a.frame,(0,r.a)(this,this.launchFileMenu,"launchFileMenu")),super.dispose(),this._elmJewel=null}constructClonedMenuLauncher(e,t,n){return new f(e,this.id,t,n,e)}constructor(e,t,n,a,i){super(e,t,n,a),this._elmJewel=null,this._parentRoot=i,this.addDisplayMode("Default"),l.AFrameworkApplication.theActionManager.addAction(S.a.launchFileMenu,p.a.frame,(0,r.a)(this,this.launchFileMenu,"launchFileMenu"))}}(0,a.a)(f,"JewelMenuLauncher",s.a,[]);var C=n(432),y=n(7958),A=n(3180),b=n(6161),T=n(1827),v=n(2950);class w extends C.a{get jewelProperties(){return this.properties}refreshInternal(){super.refreshInternal(),m.d(this.elementInternal)&&this.ensureDOMElement(),this.elementInternal=_.a.removeChildNodes(this.elementInternal),this.appendChildrenToElement(this.elementInternal),this.dirty=!1}ensureCorrectChildType(e){if(!(0,o.a)(A.a,e))throw Error.create('The child "'+e.id+'" is not a ControlComponent');if(!(0,o.a)(f,e.control))throw Error.create("Only children of type JewelMenuLauncher can be added to a Jewel")}get cssClass(){return"cui-jewel "+super.cssClass}get rootType(){return 4}get visibleInDOM(){return!0}configurePropertiesForNoIFrameApp(e,t){this._isNoIFrameApp=!0,this._flyoutHeight=e,this._appContainer=t}createMenu(e,t,n,a,i=!1,o=1){return this._mainJewelMenuAlreadyCreated?new T.a(this,e,t,n,a,this.rootManager):(this._mainJewelMenuAlreadyCreated=!0,new b.a(this,e,t,n,a,this.rootManager))}setFlyoutCoordinates(e,t,n,a){if(m.d(e)||m.d(t))return null;let i=0,o=0,r=0;const s=0===this.root.textDirection,l=1===n;if(e.style.maxHeight="none",e.style.overflowY="auto",this._isNoIFrameApp){const t=y.a.getElementBounds(this._appContainer);e.style.bottom="",e.style.overflowY="auto",e.style.top=t.y-1+"px",r=0===this.root.textDirection?t.x-1:window.document.body.offsetWidth-(t.x+t.width)}if(l){const e=this.menuLauncherStack[0].menu.elementInternal.offsetWidth;s?i=e+r:o=e+r}else s?i=0+r:o=0+r;if(this._isNoIFrameApp){let t=window.document.body.offsetHeight-2;t>this._flyoutHeight&&(t=this._flyoutHeight),e.style.height=t+"px"}const c=(s?i:o)+"px";return s?(e.style.left=c,e.style.right="auto"):(e.style.right=c,e.style.left="auto"),this.menuStackDepth&&(e.style.maxWidth="600px",e.style.width="calc(100% - "+c+")"),new v.a}launchSubMenu(e,t){let n=t||this.jewelProperties.DefaultSelection,a=null;if(n&&(a=this.controls[n]),!a){n=null;const e=this.controls;for(const t in e){const a={key:t,value:e[t]};if((0,o.a)(s.a,a.value)&&!(0,o.a)(f,a.value)){const e=a.value,t=e.controlProperties;if(e.enabled&&(_.a.isTrue(t.PopulateDynamically)||e.menu.hasItems())){n=e.id;break}0}}if(!n)return;a=this.controls[n]}a?a.launchMenu(e):i.ULS.sendTraceTag(4329748,202,10,"Tried to launch invalid submenu with non-null ID {0}",{ControlID:n})}get jewelBuilder(){return this.builder}set jewelBuilder(e){this.builder=e}focus(){this.jewelMenuLauncher.setFocusOnControl()}launchFileMenuWithSubMenu(e,t){this.jewelMenuLauncher.launchMenuWithSubmenu(e,t)}refreshMenu(e){return this.refreshOpenMenu(e)}disposeFileMenu(){this.dispose()}pollForStateAndUpdateFileMenu(){this.pollForStateAndUpdate()}set visibleInDOM(e){super.visibleInDOM=e}constructor(e,t){super(e,t),this._mainJewelMenuAlreadyCreated=!1,this._flyoutHeight=0,this._isNoIFrameApp=!1,this._appContainer=null,this.jewelMenuLauncher=null,this.classname="Jewel"}}(0,a.a)(w,"Jewel",C.a,[523])},6161:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(7183),o=n(3245),r=n(4733);class s extends i.a{get cssClass(){let e=super.cssClass+" "+s.jewelMenuClass;return o.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled&&(e+=" "+s.jewelMenuBackArrowRefreshClass),o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(e+=" "+s.jewelMenuColorUpdateClass),e}onPointerOut(e){return!1}onMenuClosed(){r.a.hideJewelMenu(this.elementInternal,o.AFrameworkApplication.activeFrame.activeModalUIZIndex),super.onMenuClosed()}constructor(e,t,n,a,i,o){super(e,t,n,a,i,o)}}s.jewelMenuClass="cui-jewelmenu",s.jewelMenuBackArrowRefreshClass="cui-jewelmenu-backarrowrefresh",s.jewelMenuColorUpdateClass="cui-color-update",(0,a.a)(s,"JewelMenu",i.a,[])},1827:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var a=n(100),i=n(3792);const o=(0,i.b)("Common.IFileMenuSQMInformation");var r=n(7183),s=n(3245),l=n(4733),c=n(5072),d=n(988);class u extends r.a{get cssClass(){let e=super.cssClass+" "+u.jewelSubmenuClass;return s.AFrameworkApplication.appSettingsManager&&s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppColorUpdateIsEnabled")&&(e+=" "+u.jewelSubmenuColorUpdateClass),e}onPointerOut(e){return!1}onMenuClosed(){l.a.hideJewelMenu(this.elementInternal,s.AFrameworkApplication.activeFrame.activeModalUIZIndex+1),super.onMenuClosed()}setFocus(e){if((0,i.j)(o)){const e={};e.PageId=this.id,s.AFrameworkApplication.theActionManager.processActionWithData(d.a.reportFileMenuPageSwitch,2,e)}super.setFocus(1)}onKeyPress(e){const t=e.innerEvent.rawEvent;return!(t&&t.keyCode===c.a.vK_Enter&&t.target&&"a"===t.target.tagName.toLowerCase()&&t.target.href&&"#"!==t.target.href)&&super.onKeyPress(e)}constructor(e,t,n,a,i,o){super(e,t,n,a,i,o)}}u.jewelSubmenuClass="cui-jewelsubmenu",u.jewelSubmenuColorUpdateClass="cui-color-update",(0,a.a)(u,"JewelSubMenu",r.a,[])},4094:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5149);class o{constructor(){this.success=!1,this.id=null,this.queryData=null,this.contextData=null}}(0,a.a)(o,"DataQueryResult",null,[]);class r{getData(e){const t=this.lookupData(e);return void 0!==this._cuiHelper&&null!==this._cuiHelper&&this._cuiHelper.updateData(t),t}lookupData(e){return window[e]}runQuery(e){if(null!=e){let t=null,n=!1;switch(e.queryType){case 1:case 4:case 2:t=this.getRootData(),n=!0;break;case 3:t=this._tabData[e.id],n=!!t,n||i.ULS.sendTraceTag(5247233,207,50,"{0}",{Msg:"Tab not available",Id:e.id})}const a=new o;a.success=n,a.id=e.id,a.contextData=e.data,a.queryData=t,e.handler(a)}}getRootData(){return this._ribbonData||(this._ribbonData=this.getData(this._rootDataVarName))}addTabData(e,t){this._tabData[e]=this.getData(t)}constructor(e,t){this._ribbonData=null,this._tabData={},this._rootDataVarName=e,this._cuiHelper=t}}(0,a.a)(r,"JsonDataSource",null,[170])},690:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(6082);class o{get_current(){if(!this._node)throw Error.argumentOutOfRange();return this._node.data}moveNext(){return this._node?!!this._node.next&&(this._node=this._node.next,!0):(this._node=this._first,!!this._first)}movePrevious(){return this._node?!!this._node.previous&&(this._node=this._node.previous,!0):(this._node=this._first,!!this._first)}reset(){this._node=this._first}constructor(e){this._node=null,this._first=e}}(0,a.a)(o,"ListEnumerator",null,[4]);class r{constructor(e,t,n){this.next=n,this.previous=t,this.data=e}}(0,a.a)(r,"ListNode",null,[]);class s{add(e){this._head?this._tail=this._tail.next=new r(e,this._tail,null):this._head=this._tail=new r(e,null,null),this._count=this.count+1}insert(e,t){if(e>this.count||0>e)throw Error.argumentOutOfRange("pos");if(e===this.count)return void this.add(t);let n=this._head;for(;0!=e--;)n=n.next;const a=new r(t,n.previous,n);a.previous?a.previous.next=a:this._head=a,a.next?a.next.previous=a:this._tail=a,this._count=this.count+1}remove(e){let t=this._head;for(;t&&t.data!==e;)t=t.next;return!!t&&(t.previous?t.previous.next=t.next:this._head=t.next,t.next?t.next.previous=t.previous:this._tail=t.previous,this._count=this.count-1,!0)}clear(){let e,t=this._head;for(this._head=null,this._tail=null;t;)e=t.next,t.previous=null,t.next=null,t=e;this._count=0}indexOf(e){let t=this._head,n=0;for(;t&&t.data!==e;)t=t.next,n++;return t?n:-1}get_item(e){return this.at(e).data}get count(){return this._count}getEnumerator(){return new o(this._head)}[Symbol.iterator](){return(0,i.a)(this.getEnumerator())}getEnumeratorAtPos(e){const t=this.at(e);return new o(t)}toArray(){const e=new Array(this.count);let t=0;for(const n of this)e[t]=n,t++;return e}at(e){let t=this._head,n=0;for(;n!==e;){if(!t)throw Error.argumentOutOfRange("pos");t=t.next,n++}return t}constructor(){this._head=null,this._tail=null,this._count=0}}(0,a.a)(s,"List",null,[5])},7183:function(e,t,n){"use strict";n.d(t,{a:function(){return A}});var a=n(100),i=n(625),o=n(8555),r=n(37),s=n(3245),l=n(6808),c=n(6012),d=n(5072),u=n(2544),p=n(9855),g=n(6101),h=n(7072),m=n(7958),_=n(1163),S=n(690),f=n(8304),C=n(1903),y=n(6662);class A extends r.a{get horizontalAlignment(){return this._horizontalAlignment}refreshInternal(){this.needsDelayIniting&&this.doDelayedInit(),this.ensureDOMElementAndEmpty();const e=this.root.textDirection,t=this.elementInternal;0===e?t.style.direction="ltr":1===e&&(y.a.ensureCSSClassOnElement(t,"cui-rtl"),t.style.direction="rtl"),C.c(this.innerDiv)&&(this._innerDiv=y.a.createElement("div"),this.innerDiv.className="cui-smenu-inner"),t.setAttribute(h.a.ariaRoleAttribute,this._isComboboxListbox?h.a.ariaListboxRole:h.a.ariaMenuRole),t.appendChild(this.innerDiv),C.b(this._maxWidth)||(t.style.maxWidth=this._maxWidth),this.appendChildrenToElement(this.innerDiv),super.refreshInternal()}setParentKeytipsIdsForMenuItems(e,t){for(const n of this.children)for(const a of n.children)a?.classname&&"ControlComponent"===a.classname&&a.hasKeytip&&(a.control.parentKeytipsIds=e,a.control.parentKeytipsKeys=t)}attachEvents(){u.a.instance.registerHandler(c.a.keyDown,this.elementInternal,this.onKeyDown),u.a.instance.registerHandler(c.a.keyPress,this.elementInternal,(0,i.a)(this,this.onKeyPress,"onKeyPress")),u.a.instance.registerHandler(c.a.keyUp,this.elementInternal,this.onKeyUp),l.a.instance.registerHandler(this.elementInternal,this.onContextMenu),p.a.instance.registerHandler(c.a.pointerOver,this.elementInternal,(0,i.a)(this,this.onPointerOver,"onPointerOver")),p.a.instance.registerHandler(c.a.pointerOut,this.elementInternal,(0,i.a)(this,this.onPointerOut,"onPointerOut"))}get cssClass(){return s.AFrameworkApplication.activeFrame&&s.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled?"cui-menu MLRVisualRefresh":"cui-menu"}get domElementTagName(){return"div"}ensureCorrectChildType(e){if(!e?.classname||"MenuSection"!==e.classname)throw Error.create("Only MenuSection Components can be added to Menu Components.")}get inKeytipMode(){const e=(0,o.a)(f.a,this._rootManager);return!!e&&e.inKeytipMode}get inMasterKeytipMode(){let e=this.inKeytipMode;return s.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&g.a("inKeytipMode")&&(e=appChrome.api.inKeytipMode()),e}get innerDiv(){return this._innerDiv}get selectableItemsCount(){let e=0;for(const t of this.children)e+=t.selectableItemsCount;return e}get isComboboxListbox(){return this._isComboboxListbox}getSectionSelectableStartIndex(e){let t=0;for(const n of this.children){if(n===e)break;t+=n.selectableItemsCount}return t}pollMenuState(){this.pollForStateAndUpdateInternal()}pollForStateAndUpdateInternal(){this.lastPollTime=new Date,super.pollForStateAndUpdateInternal()}onKeyPress(e){return!this.inKeytipMode}onPointerOver(e){let t=this.stackIndex;for(;t>0;){const e=this.root.menuLauncherStack[t];e.isStandardMenuItem()&&(y.a.ensureCSSClassOnElement(e.launcher,"cui-fa-dropped"),e.elmHadFocus=e.focusableElement),t--}return!1}onPointerOut(e){if(!m.a.isPointInElement(this.elementInternal,e.clientPoint))if(this.stackIndex===this.root.menuStackDepth-1)this.setFocus(e.inputSource);else{const e=this.root.menuLauncherStack[this.stackIndex+1];e.elmHadFocus!==e.launcher&&(e.elmHadFocus=this.elementInternal,this.resetFocusedIndex())}return!1}updateFocusedIndex(e){let t=0;for(const n of this.children){if(n.updateFocusedIndex(e))return this._focusedIndex=t,!0;t++}return!1}setFocus(e){if(1===e)this.focusNext(0);else{if(this.elementInternal.tabIndex=0,_.a.browserSupportsSetActive(this.elementInternal))try{this.elementInternal.setActive()}catch(e){this.elementInternal.focus()}else this.elementInternal.focus();this.resetFocusedIndex()}}resetFocusedIndex(){if(this.children.count){this._focusedIndex=-1;for(const e of this.children)e.resetFocusedIndex()}}moveFocusToParentOnNavigationEnd(){if(this.parent?.classname&&"ControlComponent"===this.parent.classname){const e=this.parent.control;if(e){if(e.stateProperties.TakeFocusOnMenuNavigationEnd)return e.setFocusOnControl(),!0}}return!1}focusNext(e){const t=this.children.count;if(t<=0)return!1;const n=0===e||4===e||6===e;return this.moveFocusFromIndex(this._focusedIndex,e)||this.moveFocusToParentOnNavigationEnd()||this.moveFocusFromIndex(n?0:t-1,e)}moveFocusFromIndex(e,t){const n=0===t||4===t||6===t;-1===e&&(e=n?0:this.children.count-1);let a=e;const i=this.children.getEnumeratorAtPos(a);for(;n?i.moveNext():i.movePrevious();){if(i.get_current().focusNext(t))return this._focusedIndex=a,!0;a+=n?1:-1}return!1}hasItems(){for(const e of this.children)for(const t of e.children)if(t.visible)return!0;return!1}get menuLauncherChildren(){const e=new S.a;for(const t of this.children)for(const n of t.children){if(!n?.classname||"ControlComponent"!==n.classname)continue;const t=n;t.visible&&t.control?.classname&&"MenuLauncher"===t.control.classname&&e.add(t.control)}return e}get visibleInDOM(){return this.launched}dispose(){const e=this.elementInternal;C.d(e)||y.a.unregisterAllHandlers(e),super.dispose(),this._innerDiv=null}clone(e){const t=e.createMenu(this.id,this.title,this.description,this._maxWidth,this._isComboboxListbox);for(const n of this.children)t.addChild(n.clone(e));return t}set visibleInDOM(e){super.visibleInDOM=e}constructor(e,t,n,a,i,o=null,r=!1,l=1){super(e,t,n,a),this._focusedIndex=-1,this.isFloatieContextMenuDropDown=!1,this._innerDiv=null,this.stackIndex=-1,this.launched=!1,this.onContextMenu=e=>!0,this.onKeyDown=e=>{let t=!1;if(!C.d(e.innerEvent)&&!C.d(e.innerEvent.rawEvent)){const n=e.innerEvent.rawEvent,a=e.innerEvent.keyCode,i=n.shiftKey,o=n.altKey,r=0===this.root.textDirection;let s=!1;const l=a===Sys.UI.Key.right&&r||a===Sys.UI.Key.left&&!r,c=a===Sys.UI.Key.left&&r||a===Sys.UI.Key.right&&!r;if(a===Sys.UI.Key.tab&&!i||l)this.focusNext(0),s=!0,t=!0;else if(a===Sys.UI.Key.tab&&i)this.focusNext(1),s=!0,t=!0;else if(a===Sys.UI.Key.down)this.focusNext(6),s=!0,t=!0;else if(a===Sys.UI.Key.up)this.focusNext(5),s=!0,t=!0;else if(c)this.stackIndex>0&&this.root.closeMenuStackAtIndex(this.stackIndex,!0,!1),t=!0;else if(a===Sys.UI.Key.esc||o&&!this.inMasterKeytipMode){const e=this.root?.classname&&"Jewel"===this.root.classname&&!this.inMasterKeytipMode?0:this.stackIndex;this.root.closeMenuStackAtIndex(e,!0,!this.inKeytipMode),t=!0}else(e.innerEvent.ctrlKey||a>=112&&a<=123||a===Sys.UI.Key.space)&&(t=!0);s&&(this.elementInternal.tabIndex=-1)}return t},this.onKeyUp=e=>{let t=!1;if(!C.d(e.innerEvent)&&!C.d(e.innerEvent.rawEvent)){const n=e.innerEvent.rawEvent;this.inMasterKeytipMode&&e.innerEvent.keyCode===d.a.vK_Alt&&!n.altKey&&(this.root.closeMenuStackAtIndex(0,!0,!0),s.AFrameworkApplication.activeFrame.applicationInstance.isReactRibbonEnvironmentEnabled&&g.a("exitKeytipMode")&&appChrome.api.exitKeytipMode(),t=!0)}return t},this._maxWidth=i,this._rootManager=o,this._isComboboxListbox=r,this._horizontalAlignment=l}}A.menuBorderPx=1,(0,a.a)(A,"Menu",r.a,[358])},6728:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(3987);class o extends i.a{constructor(){super(),this.cloneControlsForMenu=!1}}(0,a.a)(o,"MenuBuildContext",i.a,[])},2980:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(3180);class o extends i.a{focusNext(e){return this.control.focusNext(e)}constructor(e,t,n,a){super(e,t,n,a)}}(0,a.a)(o,"MenuItem",i.a,[])},3455:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(3078),o=n(7977),r=n(7072),s=n(7183),l=n(1903),c=n(4163);class d extends o.a{static get menuDroppedClassName(){return"cui-fa-dropped"}get sendFocusToMenuDrop(){return this._sendFocusToMenuDrop}get needsAKeytip(){return!0}get menuLauncherBehavior(){return this.behavior}get isFloatieContextMenuDropDown(){return this._isContextMenuDropDown}set isFloatieContextMenuDropDown(e){this._isContextMenuDropDown=e,l.d(this.menu)||(this.menu.isFloatieContextMenuDropDown=e)}get menu(){return this._menu}set menu(e){this._menu=e,l.d(this._menu)||(this._menu.isFloatieContextMenuDropDown=this.isFloatieContextMenuDropDown)}get launcherComponent(){return this.displayedComponent}get launcher(){return this.getDisplayedComponentElement()}get menuDirection(){return 2}get additionalMenuCssClass(){return""}launchMenu(e){this.menuLauncherBehavior&&this.menuLauncherBehavior.launchMenu(e)}setInitialAriaMenuLauncherAttributes(e){r.a.setAriaAttribute(e,r.a.ariaHasPopupAttribute,r.a.ariaTrueValue),this.updateAriaMenuLauncherAttributes(e,!1)}updateAriaMenuLauncherAttributes(e,t){r.a.setAriaAttribute(e,r.a.ariaExpandedAttribute,t?r.a.ariaTrueValue:r.a.ariaFalseValue)}selectDropdownItem(e){}sendNotifyAsyncMenuTrigger(){this.menuLauncherBehavior&&this.menuLauncherBehavior.sendNotifyAsyncMenuTrigger()}onKeyDown(e){return!!this.menuLauncherBehavior&&this.menuLauncherBehavior.onKeyDown(e)}onPointerDown(e){return!!this.menuLauncherBehavior&&this.menuLauncherBehavior.onPointerDown(e)}getLauncherBounds(){return this.menuLauncherBehavior?this.menuLauncherBehavior.getLauncherBounds():new Sys.UI.Bounds(0,0,0,0)}closeMenu(e=!0){this.menuLauncherBehavior&&this.menuLauncherBehavior.closeMenu()}ensureBehaviorAttachedIfAvailable(){super.ensureBehaviorAttachedIfAvailable(),this.menu&&this.menu.ensureBehaviorAttached()}notifyCommandExecuted(e,t){}refreshMenuCallback(){this.refreshMenu()}refreshMenu(){this.menuLauncherBehavior&&this.menuLauncherBehavior.refreshMenu()}ensureCorrectChildType(e){if(!(0,i.a)(s.a,e))throw Error.create("This Component can only have Menu Components as children.")}getCommandPopulateProperties(){const e={};return e.MenuId=this.id,e}pollForDynamicMenu(e){return this.menuLauncherBehavior?this.menuLauncherBehavior.pollForDynamicMenu(e):null}populateMenuFromXml(e,t=!1){return!!this.menuLauncherBehavior&&this.menuLauncherBehavior.populateMenuFromXml(e,t)}get properties(){return this.controlProperties}get cachedMenuVersions(){return l.d(this._cachedMenuVersions)&&(this._cachedMenuVersions={}),this._cachedMenuVersions}get focusableElement(){return this.getDisplayedComponentElement()}cloneMenu(e){let t=null;return this.menu&&c.a.shouldBuildMenu(this.properties,this.menu.children.toArray())&&(t=this.menu.clone(e)),t}constructClonedMenuLauncherForMenu(e,t,n){return this.constructClonedMenuLauncher(e,t,n)}constructClonedControl(e,t){const n=this.cloneMenu(e);return this.constructClonedMenuLauncher(e,t,n)}constructClonedControlForMenu(e,t){const n=this.cloneMenu(e);return this.constructClonedMenuLauncherForMenu(e,t,n)}dispose(){if(super.dispose(),l.d(this.menu)||this.menu.dispose(),!l.d(this._cachedMenuVersions)){const e=this._cachedMenuVersions;for(const t in e){({key:t,value:e[t]}).value.dispose()}}this.menu=null}constructor(e,t,n,a){super(e,t,n),this._isContextMenuDropDown=!1,this.onMenuLaunchCallback=null,this.onMenuCloseCallback=null,this._menu=null,this.elmHadFocus=null,this._cachedMenuVersions=null,this.menu=a,this.menuLaunched=!1,this._sendFocusToMenuDrop=!0}}(0,a.a)(d,"MenuLauncher",o.a,[])},2950:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(){this.launchedLeft=!1,this.launchedUp=!1,this.viewPortHeight=0,this.viewPortWidth=0,this.flyoutTop=0,this.flyoutLeft=0,this.flyoutWidth=0,this.flyoutHeight=0}}(0,a.a)(i,"MenuPositioningInfo",null,[])},8268:function(e,t,n){"use strict";n.d(t,{a:function(){return h}});var a=n(100),i=n(5699),o=n(8555),r=n(3078),s=n(37),l=n(3245),c=n(7072),d=n(5200),u=n(2980),p=n(1903),g=n(6662);class h extends s.a{refreshInternal(){this.ensureDOMElementAndEmpty();const e=g.a.isTrue(this._properties.Loading),t=!p.d(this.title),a=!g.a.isFalse(this._properties.ShowSeperator);if(!t&&a&&(this._separator=g.a.createElement("span"),this.separator.className="cui-menusection-separator",this.separator.setAttribute("role","separator"),this.elementInternal.appendChild(this.separator)),this._elmWrapper=g.a.createElement("div"),this._elmWrapper.className="cui-menusection",this._properties.Language&&this._elmWrapper.setAttribute("lang",this._properties.Language),this.elementInternal.appendChild(this._elmWrapper),t&&(this._elmTitle=this.buildTitleForSection(this._elmWrapper,this.title)),l.AFrameworkApplication.isMobileMode&&(this._elmWrapper.style.fontSize="10pt"),e){const e=g.a.createElement("img");e.alt="",e.src=this.root.properties.ImageSpinner,e.className="cui-ctl-spinner ",this._elmWrapper.appendChild(e)}else{this._elmItems=g.a.createElement("ul"),this._elmItems.className="cui-menusection-items","Menu16DescriptionEnabled"===this._properties.DisplayMode?(this._elmItems.setAttribute(c.a.ariaLabelledByAttribute,this._properties.ArialabelledbyId),this._elmItems.setAttribute(c.a.ariaRoleAttribute,c.a.ariaGroupRole)):this._elmItems.setAttribute(c.a.ariaRoleAttribute,c.a.ariaMenuRole);const e=this.parent,t=(0,o.a)(n(7183).a,e);"Menu32"!==this._properties.DisplayMode&&"Menu48"!==this._properties.DisplayMode||t&&g.a.ensureCSSClassOnElement(e.elementInternal,"cui-menu-large"),t&&(this._isInComboboxListbox=t.isComboboxListbox),g.a.isTrue(this._properties.Scrollable)&&(this._elmItems.style.overflowY="auto",this._elmItems.style.position="relative"),p.b(this._properties.MaxHeight)||(this._elmItems.style.maxHeight=this._properties.MaxHeight),this._elmWrapper.appendChild(this._elmItems),this.appendChildrenToElement(this._elmItems)}}buildTitleForSection(e,t){let n,a;return this.inContextMenu?({titleElement:n,returnValue:a}=this.createTitleForContextMenuSection(t)):a=n=this.createTextualTitleForSection("div",t),e.appendChild(a),n}get inContextMenu(){return this.root?.classname&&"ContextMenuRoot"===this.root.classname&&("Menu16"===this._properties.DisplayMode||"Menu16DescriptionEnabled"===this._properties.DisplayMode)}createTitleForContextMenuSection(e){let t;const n=g.a.createElement("li");n.className="cui-menusection-items cui-menusection-contextmenu-title";!g.a.isFalse(this._properties.ShowTitleBackground)||(n.style.background="transparent");const a=!g.a.isFalse(this._properties.TitleFocusable),i=h.createOuterElement("cui-ctl-menu cui-ctl-menu16",a);if(!g.a.isFalse(this._properties.ShowTitleIcon)){const e=this.createIconBlock(this._properties.Image,this._properties.ImageClass);i.appendChild(e)}const o=t=this.createTextualTitleForSection("span",e);i.appendChild(o),n.appendChild(i);const r=g.a.createElement("ul");return r.className="cui-menusection-items",r.appendChild(n),{returnValue:r,titleElement:t}}createIconBlock(e,t){const n=g.a.createElement("span");if(n.className="cui-ctl-iconContainer",e&&t){const a=4,i=g.a.createElement("img");i.alt="";const o=g.a.createClusteredImageContainerNew(a,e,t,i,!0,!1);n.appendChild(o)}return n}createTextualTitleForSection(e,t){const n=g.a.createElement(e);n.innerText=t;let a="cui-menusection-title-empty",i=c.a.ariaPresentationRole;return this._properties.TitleId&&n.setAttribute("id",this._properties.TitleId),p.b(t)||(a=(this.inContextMenu?"cui-ctl-mediumlabel":"cui-menusection-title")+("Light"===this._properties.Theme?" cui-menusection-title-lightBackground":this.root?.classname&&"Jewel"===this.root.classname?"":" UIFontBold"),i=c.a.ariaHeadingRole),n.className=a,n.setAttribute(c.a.ariaRoleAttribute,i),n}get domElementTagName(){return"div"}get selectableItemsCount(){let e=0;for(const t of this.children)if((0,r.a)(u.a,t)){const n=(0,o.a)(u.a,t);n.control&&(0,r.a)(172,n.control)&&e++}else e++;return e}appendChildrenToElement(e){let t,n=!0,a=this.selectableItemsCount,s=0,l=0,d="",p=!1;this._menuContext&&(a=this._menuContext.selectableItemsCount,s=this._menuContext.getSectionSelectableStartIndex(this));for(const h of this.children){t=g.a.createElement("li"),t.className="cui-menusection-items",t.setAttribute(c.a.ariaRoleAttribute,c.a.ariaPresentationRole),n&&(g.a.ensureCSSClassOnElement(t,"cui-menusection-firstitem"),n=!1),h.ensureDOMElement();const m=(0,o.a)(u.a,h);(!m||m.control&&(0,r.a)(172,m.control))&&(h.elementInternal.setAttribute(c.a.ariaPosInSetAttribute,s+ ++l),h.elementInternal.setAttribute(c.a.ariaSetSizeAttribute,a),this._properties.TitleId&&h.elementInternal.setAttribute(c.a.ariaDescribedByAttribute,this._properties.TitleId)),this._isInComboboxListbox?h.elementInternal.setAttribute(c.a.ariaRoleAttribute,c.a.ariaOptionRole):(!m||m.control&&(0,r.a)(i.a,m.control)&&m.control.useCheckMark)&&t.setAttribute(c.a.ariaRoleAttribute,c.a.ariaGroupRole),t.appendChild(h.elementInternal),p||(d=h.elementInternal.getAttribute(c.a.ariaRoleAttribute),p=!!d&&d===c.a.ariaTabRole),e.appendChild(t),h.ensureRefreshed()}p&&e.setAttribute(c.a.ariaRoleAttribute,c.a.ariaTabListRole)}updateFocusedIndex(e){let t=0;for(const n of this.children){if(n.updateFocusedIndex(e))return this._focusedIndex=t,!0;t++}return!1}resetFocusedIndex(){if(this.children.count){this._focusedIndex=-1;for(const e of this.children)e.resetFocusedIndex()}}focusNext(e){const t=this.children.count;return!(t<=0)&&(!!this.moveFocusFromIndex(this._focusedIndex,e)||(this._focusedIndex>=0&&this._focusedIndex<t&&this.children.get_item(this._focusedIndex).resetFocusedIndex(),this._focusedIndex=-1,!1))}moveFocusFromIndex(e,t){const n=this.children.count,a=0===t||4===t||6===t;-1===e&&(e=a?0:n-1);let i=e;const o=this.children.getEnumeratorAtPos(i);for(;a?o.moveNext():o.movePrevious();){if(o.get_current().focusNext(t))return this._focusedIndex>=0&&this._focusedIndex<n&&this._focusedIndex!==i&&this.children.get_item(this._focusedIndex).resetFocusedIndex(),this._focusedIndex=i,!0;i+=a?1:-1}return!1}ensureCorrectChildType(e){if(!(0,r.a)(u.a,e)&&!(0,r.a)(d.a,e))throw Error.create("MenuSections can only have children of type MenuItem or Gallery.")}get separator(){return this._separator}get titleElement(){return this._elmTitle}setTitleImmediate(e){this.titleInternal=e,this._elmTitle.innerText=e}dispose(){super.dispose(),this._separator=null,this._elmItems=null,this._elmTitle=null,this._elmWrapper=null}clone(e){const t=e.createMenuSection(this.id,this.title,this.description,this._properties,this._menuContext);for(const n of this.children)if((0,r.a)(u.a,n)){const a=n.control.clone(e);t.addChild(a.createComponentForDisplayMode(this._properties.DisplayMode))}else(0,r.a)(d.a,n)&&t.addChild(n.clone(e));return t}static createOuterElement(e,t=!0){const n=g.a.createNoOpLink(t);return n.className=e,n}constructor(e,t,n,a,i,o){super(e,t,n,a),this._focusedIndex=-1,this._elmWrapper=null,this._elmTitle=null,this._elmItems=null,this._isInComboboxListbox=!1,this._separator=null,this.classname="MenuSection",this._properties=i||{},this._menuContext=o}}(0,a.a)(h,"MenuSection",s.a,[])},432:function(e,t,n){"use strict";n.d(t,{a:function(){return I}});var a=n(100),i=n(5149),o=n(625),r=n(3078),s=n(37),l=n(3245),c=n(5401),d=n(8585),u=n(6012),p=n(2217),g=n(9855),h=n(7072),m=n(2409),_=n(6094),S=n(1163),f=n(3180),C=n(5200),y=n(7183),A=n(2980),b=n(8268),T=n(8304),v=n(4174),w=n(1903),F=n(6662);class I extends s.a{get rootManager(){return this._rootManager}get clientID(){return this._clientID}set clientID(e){this._clientID=e}get initializing(){return this._initializing}get supportsInvisibleControls(){return!1}get supportsDynamicDisplayMode(){return!1}get isStaticUiTouchMode(){return this._isStaticUiTouchMode||this.touchModeForcedOn}set isStaticUiTouchMode(e){this._isStaticUiTouchMode=e}get isSingleRowLayoutRibbon(){return this._isSingleRowLayoutRibbon}set isSingleRowLayoutRibbon(e){this._isSingleRowLayoutRibbon=e}get touchModeForcedOn(){return S.a.isIPad||l.AFrameworkApplication.forceTouchRibbon}get launchMenusUp(){return this._launchMenusUp}get controls(){return this._controls}ensureBehaviorAttached(){super.ensureBehaviorAttached(),this.pollForStateAndUpdate()}registerControl(e){this._controls[e.id]=e}getControlById(e){return this._controls[e]}getValidControl(e){const t=this.getControlById(e);return this._disposed$1||!t||t.disposed||this.builder.isIdTrimmed(e)?null:t}refreshInternal(){super.refreshInternal(),this._initializing=!1}ensureDOMElement(){super.ensureDOMElement(),1===this.textDirection&&F.a.ensureCSSClassOnElement(this.elementInternal,"cui-rtl"),this.ensureHiddenLabel(),this.shouldHandleElementResize=!0}ensureHiddenLabel(){this.properties.LabelText&&!this.hiddenLabel&&(this.hiddenLabel=h.a.appendHiddenLabel(this.element,this.id+"-label",this.properties.LabelText))}refresh(){this.refreshInternal()}refreshOpenMenu(e){for(let t=0;t<this.menuStackDepth;t++){const n=this.menuLauncherStack[t];if(n.id===e)return n.refreshMenu(),!0}return!1}updateControl(e){e in this._controls&&this._controls[e].pollForStateAndUpdate()}commitAnyPendingChange(){this.controlWithFocus&&this.controlWithFocus.commitPendingChange()}get rootUser(){return this._rootUser}set rootUser(e){this._rootUser=e}get builder(){return this._builder}set builder(e){this._builder=e}get pollForState(){return!w.d(this._rootUser)}pollForCommandState(e,t,n,a){return this._rootPoller.pollForCommandState(this._rootUser,this.rootType,e,t,n,a)}pollForStateAndUpdate(){this.pollForStateAndUpdateInternal()}pollForStateAndUpdateInternal(){this.lastPollTime=new Date,super.pollForStateAndUpdateInternal(),this.ensureGlobalDisablingRemoved()}ensureGlobalDisablingRemoved(){F.a.setEnabledOnElement(this.elementInternal,!0)}get element(){return this.elementInternal}get cssClass(){return"cui-disabled"}get textDirection(){return this._textDirection}getUniqueNumber(){return this._unique++}createMenuSection(e,t,n,a,i){return new b.a(this,e,t,n,a,i)}createMenu(e,t,n,a,i=!1,o=1){return new y.a(this,e,t,n,a,this._rootManager,i,o)}createGallery(e,t,n,a){return new C.a(this,e,t,n,a)}createControlComponent(e,t,n){return new f.a(this,e,t,n)}createMenuItem(e,t,n){return new A.a(this,e,t,n)}get events(){return this._events||(this._events=new Sys.EventHandlerList),this._events}executeCommand(e,t,n,a,i,o=null,s=null){if(this.notifyMenuLaunchersCommandExecuted(n,i),i&&this.closeAllMenus(),!w.d(this._rootUser)){const i=new c.a;if(i.CommandLocation=this.rootType,i.InvocationMethod=a,t&&(0,r.a)(f.a,n)){const e=n.control;e&&(!t.ParentMenuId&&e.stateProperties&&e.stateProperties.ParentMenuId&&(t.ParentMenuId=e.stateProperties.ParentMenuId),!t.SqmControlId&&!t.SourceControlId&&e.controlProperties&&e.controlProperties.Id&&(t.SqmControlId=e.controlProperties.Id))}0,this._rootUser.executeRootCommand(e,t,i,o,s)}}notifyMenuLaunchersCommandExecuted(e,t){if(!this.menuLauncherStack||!this.menuLauncherStack.length||!(0,r.a)(f.a,e))return;if(e.isMenuItem())for(let n=0;n<this.menuLauncherStack.length;n++)this.menuLauncherStack[n].notifyCommandExecuted(e,t)}get menuLauncherStack(){return this._menuLauncherStack}set menuLauncherStack(e){this._menuLauncherStack=e}get menuStackDepth(){const e=this.menuLauncherStack;return w.d(e)?0:e.length}addMenuLauncherToStack(e){w.d(this.menuLauncherStack)&&(this.menuLauncherStack=[]),Array.add(this.menuLauncherStack,e)}closeAllMenus(){return this.closeMenuStackAtIndex(0,!0)}closeMenuStack(e){this.closeMenuStackAtIndex(Array.indexOf(this.menuLauncherStack,e),!0)}closeMenuStackAtIndex(e,t,n=!0){let a=!1;if(this.cancelPendingCloseMenuStack(),!w.d(this.menuLauncherStack))if(t){if(!this._closeInProgress){this._closeInProgress=!0;for(let t=this.menuLauncherStack.length-1;t>=e;t--)this.menuLauncherStack[t].closeMenu(n),Array.removeAt(this.menuLauncherStack,t),a=!0,t||this.onMenuStackCleared();this._closeInProgress=!1}}else this._pendingCloseMenuStackLauncherIndex=e,this._pendingCloseMenuStackTimeoutId=window.setTimeout(this.closePendingMenuStack,300);return a}clearMenuStack(e){if(!w.d(this.menuLauncherStack)){for(;this.menuLauncherStack.length>0;){const t=this.menuLauncherStack.length-1,n=this.menuLauncherStack[t];if(Array.removeAt(this.menuLauncherStack,t),this.menuLauncherStack.length||this.endModal(e,!1),n===e)return;n.closeMenu()}0}}cancelPendingCloseMenuStack(){this&&(this._pendingCloseMenuStackTimeoutId=F.a.cancelPendingTimeout(this._pendingCloseMenuStackTimeoutId))}onMenuStackCleared(){}beginModal(e,t,n=!1){const a=this.inModalMode,i=this.modalDiv;a&&this._inBlockingMode||(w.d(this._modalControllerStack)&&(this._modalControllerStack=[]),Array.add(this._modalControllerStack,e),this._currentModalController=e,n&&!this._inBlockingMode&&(this._inBlockingMode=!0),a||(i.style.visibility="hidden",i.style.display="block",i.style.visibility="visible"),l.AFrameworkApplication.activeFrame.beginModal(t),i.style.zIndex=String(l.AFrameworkApplication.activeFrame.activeModalDivZIndex))}beginModalWithCapture(e,t){i.ULS.sendTraceTag(20308505,207,50,"Begin Light Dismiss Modal using Capture");const n=this.inModalWithCaptureMode;w.d(this._modalWithCaptureControllerStack)&&(this._modalWithCaptureControllerStack=[]),Array.add(this._modalWithCaptureControllerStack,e),this._currentModalWithCaptureController=e,n||(g.a.instance.registerHandlerWithCaptureOption(u.a.pointerDown,window.document.body,this.onModalWithCapturePointerDown,!0),g.a.instance.registerHandlerWithCaptureOption(u.a.pointerUp,window.document.body,this.onModalWithCapturePointerUp,!0),g.a.instance.registerHandlerWithCaptureOption(u.a.pointerMove,window.document.body,this.onModalWithCapturePointerMove,!0),g.a.instance.registerHandlerWithCaptureOption(u.a.pointerOut,window.document.body,this.onModalWithCapturePointerOut,!0),d.a.instance.registerHandlerWithCaptureOption(u.a.click,window.document.body,this.onModalWithCaptureClick,null,!1,!0),p.a.instance.registerHandlerWithCaptureOption(u.a.mouseWheel,window.document.body,this.onModalWithCaptureMouseWheel,null,!0)),l.AFrameworkApplication.activeFrame.beginModal(t)}get inModalMode(){return!w.d(this._modalControllerStack)&&this._modalControllerStack.length>0}get inModalWithCaptureMode(){return!w.d(this._modalWithCaptureControllerStack)&&this._modalWithCaptureControllerStack.length>0}isCurrentModalController(e){return e===this._currentModalController}endModal(e,t,n=!1){if(this.isCurrentModalController(e)){if(!this.inModalMode)throw Error.create("Cannot end modal mode because the Ribbon is not in Modal Mode");this._inBlockingMode&&!n||(n&&(this._inBlockingMode=!1),Array.removeAt(this._modalControllerStack,this._modalControllerStack.length-1),this._currentModalController=null,this._modalControllerStack.length>0&&(this._currentModalController=this._modalControllerStack[this._modalControllerStack.length-1]),l.AFrameworkApplication.activeFrame.endModal(t),this.modalDiv.style.zIndex=String(l.AFrameworkApplication.activeFrame.activeModalDivZIndex),w.d(this._currentModalController)&&(this.modalDiv.style.display="none"))}}endModalWithCapture(e,t){if(i.ULS.sendTraceTag(20308506,207,50,"End Light Dismiss Modal using Capture"),e===this._currentModalWithCaptureController){if(!this.inModalWithCaptureMode)throw Error.create("Cannot end modal mode because the Control is not in Modal Mode");Array.removeAt(this._modalWithCaptureControllerStack,this._modalWithCaptureControllerStack.length-1),this._currentModalWithCaptureController=null,this._modalWithCaptureControllerStack.length>0&&(this._currentModalWithCaptureController=this._modalWithCaptureControllerStack[this._modalWithCaptureControllerStack.length-1]),w.d(this._currentModalWithCaptureController)&&(g.a.instance.unregisterHandlerWithCaptureOption(u.a.pointerDown,window.document.body,this.onModalWithCapturePointerDown,!0),g.a.instance.unregisterHandlerWithCaptureOption(u.a.pointerUp,window.document.body,this.onModalWithCapturePointerUp,!0),g.a.instance.unregisterHandlerWithCaptureOption(u.a.pointerMove,window.document.body,this.onModalWithCapturePointerMove,!0),g.a.instance.unregisterHandlerWithCaptureOption(u.a.pointerOut,window.document.body,this.onModalWithCapturePointerOut,!0),d.a.instance.unregisterHandlerWithCaptureOption(u.a.click,window.document.body,this.onModalWithCaptureClick,!1,!0),p.a.instance.unregisterHandlerWithCaptureOption(u.a.mouseWheel,window.document.body,this.onModalWithCaptureMouseWheel,!0)),l.AFrameworkApplication.activeFrame.endModal(t)}}endBlockingModeKeepModal(){this._inBlockingMode=!1}get modalDiv(){return w.d(this._elmModalDiv)&&(this._elmModalDiv=F.a.createElement("div"),this._elmModalDiv.setAttribute("id","ModalDiv"),F.a.ensureCSSClassOnElement(this._elmModalDiv,"cui-modalDiv"),F.a.setUnselectable(this._elmModalDiv,!0,!1),document.body.appendChild(this._elmModalDiv),g.a.instance.registerHandler(u.a.pointerDown,this._elmModalDiv,this.onModalPointerDown),g.a.instance.registerHandler(u.a.pointerUp,this._elmModalDiv,this.onModalPointerUp),g.a.instance.registerHandler(u.a.pointerMove,this._elmModalDiv,this.onModalPointerMove),g.a.instance.registerHandler(u.a.pointerOut,this._elmModalDiv,this.onModalPointerOut),d.a.instance.registerHandler(u.a.click,this._elmModalDiv,this.onModalClick),p.a.instance.registerHandler(u.a.mouseWheel,this._elmModalDiv,this.onModalMouseWheel)),this._elmModalDiv}shouldHandleOnCapturePhase(e,t){return!(_.a.isDescendantOf(e,t)||w.d(this._currentModalWithCaptureController)||!w.d(this._currentModalController))}dismissAllTransientUI(){return this.closeAllMenus()}onResize(){this.shouldHandleElementResize&&(S.a.isAndroid||this.dismissAllTransientUI())}dispose(){if(this._disposed$1)return;this._disposed$1=!0;const e=this.elementInternal;w.d(e)||F.a.unregisterAllHandlers(e),this.shouldHandleElementResize=!1,this._resizableContainer&&(this._resizableContainer.remove_onResize((0,o.a)(this,this.onResize,"onResize")),this._resizableContainer=null),this.hiddenLabel=null,w.d(this._elmModalDiv)||F.a.unregisterAllHandlers(this._elmModalDiv),this._rootManager.removeRoot(this),this._elmModalDiv=null,this._rootUser=null,this._builder=null,super.dispose()}get disposed(){return this._disposed$1}set disposed(e){this._disposed$1=e}get cookieDataVersion(){return this._cookieDataVersion}set cookieDataVersion(e){this._cookieDataVersion=e}get useDataCookie(){return this._useDataCookie}set useDataCookie(e){this._useDataCookie=e}storeDataCookie(e,t){e=this.cookieDataVersion+e,m.a.setWithExpiration(e,t,7)}getDataCookieValue(e){return e=this.cookieDataVersion+e,m.a.get(e)}get properties(){return this._properties}setFlyoutCoordinates(e,t,n,a){return null}constructor(e,t,n,a){super(null,e,null,null),this._pendingCloseMenuStackTimeoutId=-1,this._pendingCloseMenuStackLauncherIndex=-1,this._textDirection=0,this._isStaticUiTouchMode=!1,this._isSingleRowLayoutRibbon=!1,this._launchMenusUp=!1,this.hiddenLabel=null,this._clientID=null,this._initializing=!0,this.supportsEmphasizedControls=!1,this.controlWithFocus=null,this.controlIdPrefix="",this.activeControl=null,this.shouldHandleElementResize=!1,this.menuPositioningInfo=null,this.needScaling=!1,this.needRefresh=!1,this._rootUser=null,this._builder=null,this._events=null,this._menuLauncherStack=null,this._closeInProgress=!1,this._elmModalDiv=null,this._modalControllerStack=null,this._modalWithCaptureControllerStack=null,this._currentModalController=null,this._currentModalWithCaptureController=null,this._inBlockingMode=!1,this._disposed$1=!1,this._cookieDataVersion="",this._useDataCookie=!1,this.classname="Root",this.closePendingMenuStack=()=>{this.closeMenuStackAtIndex(this._pendingCloseMenuStackLauncherIndex,!0)},this.onModalPointerDown=e=>!w.d(this._currentModalController)&&this._currentModalController.onModalBodyPointerDown(e),this.onModalPointerUp=e=>!w.d(this._currentModalController)&&this._currentModalController.onModalBodyPointerUp(e),this.onModalPointerMove=e=>!w.d(this._currentModalController)&&this._currentModalController.onModalBodyPointerMove(e),this.onModalPointerOut=e=>!w.d(this._currentModalController)&&this._currentModalController.onModalBodyPointerOut(e),this.onModalClick=e=>!w.d(this._currentModalController)&&this._currentModalController.onModalBodyClick(e),this.onModalMouseWheel=e=>!w.d(this._currentModalController)&&this._currentModalController.onModalBodyMouseWheel(e),this.onModalWithCapturePointerDown=e=>!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyPointerDown(e),this.onModalWithCapturePointerUp=e=>!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyPointerUp(e),this.onModalWithCapturePointerMove=e=>!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyPointerMove(e),this.onModalWithCapturePointerOut=e=>!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyPointerOut(e),this.onModalWithCaptureClick=e=>!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyClick(e),this.onModalWithCaptureMouseWheel=e=>!!this.shouldHandleOnCapturePhase(this.element,e.sourceElement)&&this._currentModalWithCaptureController.onModalBodyMouseWheel(e),this.initRootMember(this),this._properties=t,this._controls={},this._unique=0,this._rootManager=n||T.a.instance,this._resizableContainer=a,this._resizableContainer&&this._resizableContainer.add_onResize((0,o.a)(this,this.onResize,"onResize")),w.d(t.TextDirection)||(this._textDirection="rtl"===t.TextDirection.toLowerCase()?1:0),this._rootManager.addRoot(this),this._rootPoller=new v.a}}I.unifiedHeaderHeightPx=48,I.tabRowHeightPx=30,I.singleRowLayoutTabRowHeightPx=24,I.completeConstructionInterval=200,(0,a.a)(I,"Root",s.a,[11,30,153])},8304:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(8555);class o{get roots(){return this._roots}addRoot(e){e&&!Array.contains(this._roots,e)&&Array.add(this._roots,e)}removeRoot(e){return Array.remove(this._roots,e)}commitAnyPendingChange(){for(const e of this._roots)e.commitAnyPendingChange()}dispose(){this._roots=null}constructor(){this._roots=[]}}(0,a.a)(o,"RootManagerBase",null,[336,11]);class r extends o{get inKeytipMode(){return!1}addRoot(e){super.addRoot(e)}removeRoot(e){return super.removeRoot(e)}getFirstValidControl(e){for(const t of this.roots){const n=(0,i.a)(30,t);if(!n)continue;const a=e.startsWith(n.controlIdPrefix)?e:n.controlIdPrefix+e,o=n.getValidControl(a);if(o)return o}return null}static get instance(){return r._instance||r.initializeRootManager()}static initializeRootManager(){return r.initializeComponents(),r._instance=new r,r._instance}static initializeComponents(){}constructor(){super(),this._ribbon=null}}r._instance=null,(0,a.a)(r,"RootManager",o,[])},4174:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(5401),o=n(1903);class r{pollForCommandState(e,t,n,a,r,s){let l=0;if(e){this.pollForEnabledDisabledControlState(e,n,r)&&(l|=1);const c=new i.a;c.CommandLocation=t,null!=s&&(c.InvocationMethod=s),!o.d(a)&&e.executeRootCommand(a,r,c)&&(l|=2)}return l}pollForEnabledDisabledControlState(e,t,n=null){return!!e&&e.isRootCommandEnabled(t,n)}}(0,a.a)(r,"RootPoller",null,[])},143:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(6094),o=n(432);class r extends o.a{get lastResizeWidthHeight(){return this._lastResizeWidthHeight}scale(){return this.resetCachedClientDimensions(),!0}refresh(){super.refresh(),this.scale()}getClientWidthHeightString(){return this.elementInternal?this.elementInternal.clientWidth.toString()+this.elementInternal.clientHeight.toString():""}clientDimensionsChanged(){return this._clientWidth!==this.elementInternal.clientWidth||this._clientHeight!==this.elementInternal.clientHeight}resetCachedClientDimensions(){this._clientWidth=this.elementInternal.clientWidth,this._clientHeight=this.elementInternal.clientHeight}onResize(){if(!this.shouldHandleElementResize)return;const e=this.getClientWidthHeightString();if(this._lastResizeWidthHeight!==e&&(this._lastResizeWidthHeight=e,!this._handlingResize&&this.autoScale&&this.clientDimensionsChanged())){this.resetCachedClientDimensions(),this._handlingResize=!0,super.onResize();this.scale()&&this.pollForStateAndUpdate(),this._handlingResize=!1}}constructor(e,t,n){super(e,t,null,n),this._handlingResize=!1,this._clientWidth=i.a.getViewPortWidth(),this._clientHeight=i.a.getViewPortHeight(),this.autoScale=!0,this._lastResizeWidthHeight=this.getClientWidthHeightString()}}(0,a.a)(r,"ScalableRoot",o.a,[])},1903:function(e,t,n){"use strict";n.d(t,{a:function(){return a},b:function(){return i},c:function(){return r},d:function(){return o}});const a="",i=e=>null==e||!e.length,o=e=>null==e,r=o},1694:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{}i.alt="Alt",i.iconColor="IconColor",i.image16by16Class="Image16by16Class",i.image30by30Class="Image30by30Class",i.image32by32Class="Image32by32Class",i.image48by48Class="Image48by48Class",i.labelText="LabelText",i.labelTextUserGeneratedPlaceholderReplacements="LabelTextUserGeneratedPlaceholderReplacements",i.visible="Visible",i.sourceControlId="SourceControlId",i.customTooltip="CustomTooltip",i.Icon="Icon",i.IconSet="IconSet",i.reduxActions="ReduxActions",(0,a.a)(i,"SharedControlCommandProperties",null,[])},8202:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(3078),o=n(37),r=n(3180);class s extends o.a{refreshInternal(){this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.elementInternal),super.refreshInternal()}ensureCorrectChildType(e){if(!(0,i.a)(r.a,e))throw Error.create("Only children of type Control can be added to StandaloneDocks.")}get visibleInDOM(){return!0}set visibleInDOM(e){super.visibleInDOM=e}constructor(e,t){super(e,t,"","")}}(0,a.a)(s,"StandaloneDock",o.a,[])},9717:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(432),o=n(3987),r=n(2142),s=n(5755),l=n(1903),c=n(8202);class d extends i.a{get createdControls(){return this._createdControls}get rootType(){return 11}get supportsInvisibleControls(){return!0}get supportsDynamicDisplayMode(){return!0}dispose(){const e=this._createdControls;for(const t in e){({key:t,value:e[t]}).value.dispose()}this.shouldHandleElementResize=!1,super.dispose()}get builder(){if(!super.builder){const e=new r.a;super.builder=new s.a(e,null,null,null),super.builder.root=this}return super.builder}set builder(e){super.builder=e}setBuilder(e){this.builder=e,e.root=this}get standaloneRootProperties(){return this.properties}addControl(e,t){if(l.d(t))return!1;const n=s.a.convertXMLStringToJSON(t);return this.addControlFromDeserializedData(e,n)}addControlFromDeserializedData(e,t){if(l.d(t))return!1;if(!l.d(this._createdControls[e]))throw Error.create(String.format("Control id {0} already exists in this root.",e));const n=this.builder.buildControl(t,new o.a);return n&&(n.setEnabledAndForceUpdate(!0),this._createdControls[e]=n),!0}removeControl(e){const t=this._createdControls[e];if(l.d(t))throw Error.create(String.format("Control with id '{0}' not found in root.",e));const n=this.getDockIdsForControlId(e);for(let e=0;e<n.length;e++)this.removeChild(n[e]);delete this._createdControls[e],t.dispose()}getDOMElementForControlDisplayMode(e,t){const n=this._createdControls[e];if(l.d(n))throw Error.create(String.format("Control with id '{0}' not found in root.",e));const a=this.getDockId(e,t);let i=this.getChild(a);l.d(i)&&(i=new c.a(this,a),this.addChild(i)),l.d(i.getChild(e))&&i.addChild(n.createComponentForDisplayMode(t));const o=n.getDOMElementForDisplayMode(t,n.displayedComponent);return d.updateControlVisibility(n),o}hostControl(e,t,n){return this.addControl(e,t)?this.getDOMElementForControlDisplayMode(e,n):null}pollForControlState(e){const t=this._createdControls[e];l.d(t)||(t.pollForStateAndUpdate(),d.updateControlVisibility(t))}getDockId(e,t){return String.format("dock_{0}-{1}",e,t)}getDockIdsForControlId(e){const t=[];for(const n of this.children)n.id.startsWith("dock_"+e)&&Array.add(t,n.id);return t}get trimmedIds(){return this.builder.options.trimmedIds}get cuiControlManager(){return this}static createStandaloneRoot(e,t){return new d(e,t)}static updateControlVisibility(e){for(const t of e.components){const n=e.visible&&t===e.activeComponentWhenVisible;t.elementInternal.style.display=n?"":"none",t.visibleInDOM=n}}constructor(e,t){super(e,t),this._createdControls={},this.shouldHandleElementResize=!0}}(0,a.a)(d,"StandaloneRoot",i.a,[174,175,30,153])},753:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100);class i{constructor(){this.DivSyndicated=null,this.ImageDownArrow=null,this.ImageDownArrowClass=null,this.ImageDownArrow8by8=null,this.ImageDownArrow8by8Class=null,this.ImageSideArrow=null,this.ImageSideArrowClass=null,this.ImageUpArrow=null,this.ImageUpArrowClass=null,this.ImageUpArrow8by8=null,this.ImageUpArrow8by8Class=null,this.ImageCheckMark=null,this.ImageCheckMarkClass=null,this.ImageUncheckMark=null,this.ImageUncheckMarkClass=null,this.ImageCollapsedArrow=null,this.ImageCollapsedArrowClass=null,this.ImageExpandedArrow=null,this.ImageExpandedArrowClass=null,this.ImageSpinner=null,this.TextDirection=null,this.LabelText=null}}(0,a.a)(i,"RootProperties",null,[]);class o extends i{constructor(){super()}}(0,a.a)(o,"StandaloneRootProperties",i,[])},2091:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(3245),o=n(3957),r=n(2142);class s extends r.a{constructor(){super(),this.staticUiTouchMode=!1,this.isOneRowToolbar=!1,this.supportsEmphasizedControls=!1,this.maxElementsBeforeOverflow=i.AFrameworkApplication.isMobileMode?1:o.a.defaultHeroControlCount}}(0,a.a)(s,"ToolbarBuildOptions",r.a,[])},5122:function(e,t,n){"use strict";n.d(t,{a:function(){return v}});var a=n(100),i=n(5755),o=n(3245),r=n(2945);class s{constructor(){this.id=null,this.queryType=0,this.handler=null,this.data=null}}(0,a.a)(s,"DataQuery",null,[]);var l=n(3957),c=n(1903),d=n(3078),u=n(625),p=n(143),g=n(432),h=n(37),m=n(3180),_=n(690),S=n(6662);class f extends h.a{refreshInternal(){this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.elementInternal),super.refreshInternal()}appendChildrenToElement(e){for(const t of this.children){switch(t.ensureDOMElement(),this._alignment){case r.a.LEFTALIGN:S.a.ensureCSSClassOnElement(t.elementInternal,"cui-toolbar-button-left");break;case r.a.CENTERALIGN:S.a.ensureCSSClassOnElement(t.elementInternal,"cui-toolbar-button-center");break;case r.a.RIGHTALIGN:S.a.ensureCSSClassOnElement(t.elementInternal,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this._alignment)}t.visible&&e.appendChild(t.elementInternal),t.ensureRefreshed()}}ensureCorrectChildType(e){if(!(0,d.a)(m.a,e))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.")}get cssClass(){switch(this._alignment){case r.a.LEFTALIGN:return"cui-toolbar-buttondock alignleft";case r.a.CENTERALIGN:return"cui-toolbar-buttondock aligncenter";case r.a.RIGHTALIGN:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this._alignment)}}get visibleInDOM(){return!0}get alignment(){return this._alignment}getWidthPx(){let e=0;if(this.alignment===r.a.CENTERALIGN)for(const t of this.children){const n=t;n.visible&&(e+=n.elementInternal.offsetWidth)}else e=this.elementInternal.offsetWidth;return e}getStartPoint(){let e=null;if(this.alignment===r.a.CENTERALIGN){for(const t of this.children)if(t.visible){e=Sys.UI.DomElement.getBounds(t.elementInternal);break}}else e=Sys.UI.DomElement.getBounds(this.elementInternal);return e?0===this.root.textDirection?e.x:e.x+e.width:0}getEndPoint(){let e=null;if(this.alignment===r.a.CENTERALIGN){if(this.children.count>0){const t=this.children.getEnumeratorAtPos(this.children.count-1);for(;t.movePrevious();){const n=t.get_current();if(n.visible){e=Sys.UI.DomElement.getBounds(n.elementInternal);break}}}}else e=Sys.UI.DomElement.getBounds(this.elementInternal);return e?0===this.root.textDirection?e.x+e.width:e.x:0}ensureNoChildrenScaledAway(){for(const e of this.children){const t=e;(0,d.a)(m.a,t)&&!t.control.visible||(t.visible=!0)}}scaleDownToFitSize(e){const t=this.children.toArray(),n=new _.a;let a=this._dropFromStart?0:t.length-1;const i=this.children.count,o=this.root.supportsInvisibleControls;for(;this.getWidthPx()>=e&&!(a>=i||a<0);){const e=t[a];o&&(0,d.a)(m.a,e)&&e.control.visible&&(n.add(e),e.applyHideElementOverride()),a+=this._dropFromStart?1:-1}for(const e of n)e.removeHideElementOverride(),e.visible=!1}set visibleInDOM(e){super.visibleInDOM=e}constructor(e,t,n){super(e,t,"",""),this._alignment=n.Alignment,this._dropFromStart=n.ScalingDirection===r.a.FIRSTTOLAST}}(0,a.a)(f,"ButtonDock",h.a,[]);class C extends p.a{get supportsInvisibleControls(){return!0}addChild(e){if(super.addChild(e),(0,d.a)(f,e)&&!this._multipleDocksOfSameType){const t=e;t.alignment===r.a.LEFTALIGN?(this._startDock&&this.setMultipleDocksOfSameType(),this._startDock=t):t.alignment===r.a.CENTERALIGN?(this._centerDock&&this.setMultipleDocksOfSameType(),this._centerDock=t):t.alignment===r.a.RIGHTALIGN&&(this._endDock&&this.setMultipleDocksOfSameType(),this._endDock=t)}}setMultipleDocksOfSameType(){this._multipleDocksOfSameType=!0,this._startDock=null,this._centerDock=null,this._endDock=null}setControlVisibility(e,t,n=!0){const a=this.getControlById(e);c.d(a)||a.visible===t||(a.visible=t,n&&this.refresh())}refreshInternal(){super.refreshInternal(),this.refreshInternalCore(!0)}refreshInternalCore(e){const t=this.root.controlWithFocus;c.d(this.elementInternal)&&this.createToolbarStructure(),this.elementInternal=S.a.removeChildNodes(this.elementInternal),this.hiddenLabel&&this.elementInternal.appendChild(this.hiddenLabel);for(const e of this.children)e.visible&&(e.ensureDOMElement(),this.elementInternal.appendChild(e.elementInternal),e.ensureRefreshed());this._centerDock&&e&&this.ensureCenterDockLayout(),t&&t.setFocusOnControl(),this.dirty=!1}ensureCenterDockLayout(){if(this._centerDock.visible&&this._centerDock.children.count&&(this.applyMarginsToCenterDock(0,0),this.doesCenterDockCollide(this._startDock,this._centerDock,this._endDock))){let e=0,t=0;const n=this._startDock?this._startDock.getWidthPx():0,a=this._endDock?this._endDock.getWidthPx():0;(a>0||n>0)&&(a>n?(e=0,t=a-n):(e=n-a,t=0)),this.applyMarginsToCenterDock(e,t)}}doesCenterDockCollide(e,t,n){let a=!1;return 0===this.root.textDirection?(e&&(a=e.getEndPoint()>t.getStartPoint()),!a&&n&&(a=t.getEndPoint()>n.getStartPoint())):(e&&(a=e.getEndPoint()<t.getStartPoint()),!a&&n&&(a=t.getEndPoint()<n.getStartPoint())),a}applyMarginsToCenterDock(e,t){0===this.textDirection?(this._centerDock.elementInternal.style.marginLeft=e+"px",this._centerDock.elementInternal.style.marginRight=t+"px"):(this._centerDock.elementInternal.style.marginRight=e+"px",this._centerDock.elementInternal.style.marginLeft=t+"px")}createToolbarStructure(){this.ensureDOMElement()}pollForStateAndUpdateInternal(){this.doPoll((()=>{g.a.prototype.pollForStateAndUpdateInternal.call(this)}))}pollForControlState(e){const t=this.getControlById(e);c.d(t)||this.doPoll((0,u.a)(t,t.pollForStateAndUpdate,"pollForStateAndUpdate"))}doPoll(e){this.needScaling=!1,this.needRefresh=!1,e(),(this.needScaling||this.needRefresh)&&(this._toolbarScalingOptimizationsEnabled||this.refresh(),this.scale())}ensureCorrectChildType(e){if(!(0,d.a)(l.a,e)&&!(0,d.a)(f,e))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if((0,d.a)(f,e)){if(e.alignment===r.a.CENTERALIGN)for(const e of this.children)if(e.alignment===r.a.CENTERALIGN)throw Error.create("Can't add a centered buttondock because one is already present.")}}get cssClass(){let e="cui-toolbar-toolbar ";return 0===this._toolbarSize?(e+="cui-toolbar-onerow ",o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled||(e+="UITextTranformUpperCase ")):1===this._toolbarSize&&(e+="cui-toolbar-singledock "),e+super.cssClass}get domElementTagName(){return"div"}get rootType(){return 26}get toolbarBuilder(){return this.builder}set toolbarBuilder(e){this.builder=e}createButtonDock(e,t){const n=e[r.a.ATTRIBUTES];return new f(this.root,n.Id,n)}ensureDOMElement(){super.ensureDOMElement(),this.elementInternal.setAttribute("role","toolbar"),this.properties.Title&&this.elementInternal.setAttribute("title",this.properties.Title)}updateOpenMenu(e){return!(!this.root||!this.root.refreshOpenMenu(e))}setFocusOnToolbar(){return this.setFocusOnFirstControl()}scale(){super.scale();if(!S.a.isTrue(this.properties.Scale))return!1;if(this._multipleDocksOfSameType)return!1;c.d(this._startDock)||(this._startDock.visible=!0,this._startDock.ensureNoChildrenScaledAway()),c.d(this._centerDock)||(this._centerDock.visible=!0,this._centerDock.ensureNoChildrenScaledAway()),c.d(this._endDock)||(this._endDock.visible=!0,this._endDock.ensureNoChildrenScaledAway()),this.refreshInternalCore(!1);const e=this.elementInternal.offsetWidth,t=c.d(this._startDock)?0:this._startDock.getWidthPx(),n=c.d(this._centerDock)?0:this._centerDock.getWidthPx(),a=c.d(this._endDock)?0:this._endDock.getWidthPx();return a+n+t>=e&&(a+t>=e?(this.hideDockIfPresent(this._centerDock),a>=e?(this.hideDockIfPresent(this._startDock),this.scaleDockIfPresent(this._endDock,e)):this.scaleDockIfPresent(this._startDock,e-a)):this.scaleDockIfPresent(this._centerDock,e-a-t)),this.needScaling=!1,this.refreshInternal(),!1}hideDockIfPresent(e){e&&(e.visible=!1)}scaleDockIfPresent(e,t){e&&e.scaleDownToFitSize(t)}constructor(e,t,n,a,i,o,s=!1){super(e,t,o),this._startDock=null,this._centerDock=null,this._endDock=null,this._multipleDocksOfSameType=!1,this._builder$3=n,this.isStaticUiTouchMode=a,this.supportsEmphasizedControls=i,this._toolbarSize=0,c.d(t.Size)||(t.Size===r.a.ONEROW||n.options.isOneRowToolbar?this._toolbarSize=0:t.Size===r.a.SINGLEDOCK&&(this._toolbarSize=1)),this._toolbarScalingOptimizationsEnabled=s}}C.oneRowToolbarHeightPx=26,(0,a.a)(C,"Toolbar",p.a,[178]);class y extends C{get rootType(){return 7}get cssClass(){return y.statusBarClassName+" "+super.cssClass}static get statusBarClassName(){let e="cui-statusbar";return o.AFrameworkApplication.activeFrame&&o.AFrameworkApplication.activeFrame.applicationInstance.isRibbonVisualRefreshEnabled||(e+=" UISmallFont UITextTranformUpperCase"),e}constructor(e,t,n,a,i=!1){super(e,t,n,!1,!1,a,i),this._launchMenusUp=!0}}(0,a.a)(y,"StatusBar",C,[]);var A=n(3987);class b extends A.a{constructor(){super(),this.toolbar=null,this.isStatusBar=!1}}(0,a.a)(b,"ToolbarBuildContext",A.a,[]);var T=n(8559);class v extends i.a{get toolbar(){return this.root}set_toolbar(e){return this.root=e,e}get toolbarBuildOptions(){return this.options}buildToolbar(){const e=new b,t=new s;t.id="toolbar",t.queryType=1,t.handler=this.onReturnToolbarData,t.data=e,this.dataSource.runQuery(t)}buildToolbarFromData(e,t){let n=r.a.getFirstChildNodeWithName(e,r.a.TOOLBAR);if(c.d(n)&&(n=r.a.getFirstChildNodeWithName(e,r.a.STATUSBAR),t.isStatusBar=!0),c.d(n))throw Error.create("No toolbar element was present in the data");const a=new r.a(n),i=o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ToolbarScalingRedundancyEliminationIsEnabled");t.isStatusBar?this.set_toolbar(new y(a.attributes[r.a.id],a.attributes,this,this._resizableContainer,i)):this.set_toolbar(new C(a.attributes[r.a.id],a.attributes,this,this.toolbarBuildOptions.staticUiTouchMode,this.toolbarBuildOptions.supportsEmphasizedControls,this._resizableContainer,i)),this.toolbar.clientID=this.options.clientID,this.toolbar.useDataCookie=!0,this.toolbar.refreshInternal();const s=r.a.getNodeChildren(r.a.getFirstChildNodeWithName(a.node,r.a.DOCKS)),l=this.buildAllDocksFromData(s,t);for(const e of l)this.toolbar.addChild(e);return this.toolbar}buildAllDocksFromData(e,t){const n=new Array(0);for(let a=0;a<e.length;a++)this.isNodeTrimmed(e[a])||Array.add(n,this.buildDockFromData(e[a],t));return n}buildDockFromData(e,t){const n=r.a.getNodeName(e);let a=null;return n===r.a.BUTTONDOCK?a=this.buildButtonDockFromData(e,t):n===r.a.HERODOCK&&(a=this.buildHeroDockFromData(e,t)),a}buildHeroDockFromData(e,t){const n=new r.a(e),a=e[r.a.ATTRIBUTES],i=new l.a(this.root,n.attributes[r.a.id],a);i.heroControlCount=this.toolbarBuildOptions.maxElementsBeforeOverflow;const o=r.a.getFirstChildNodeWithName(e,r.a.CONTROLS),s=r.a.getNodeChildren(o),c=new Array(0);for(let e=0;e<s.length;e++){const n=s[e];if(this.isNodeTrimmed(n))continue;const a=this.buildControl(n,t);Array.add(c,a)}return i.heroDockControls=c,i}buildButtonDockFromData(e,t){new r.a(e);const n=this.toolbar.createButtonDock(e,t),a=r.a.getFirstChildNodeWithName(e,r.a.CONTROLS),i=r.a.getNodeChildren(a);for(let e=0;e<i.length;e++){if(this.isNodeTrimmed(i[e]))continue;const a=this.buildToolbarControlComponent(i[e],t);n.addChild(a)}return n}buildToolbarControlComponent(e,t){let n=null;const a=new r.a(e),i=a.name,o=a.attributes[r.a.DISPLAYMODE];let s;switch(s=t.isStatusBar?"Small14":"Small",i){case r.a.button:return n=this.buildControl(e,t),n.createComponentForDisplayMode(c.b(o)?s:o);case r.a.flyoutAnchor:return s=t.isStatusBar?"Medium14":"Medium",n=this.buildControl(e,t),n.createComponentForDisplayMode(c.b(o)?s:o);case r.a.label:return n=this.buildControl(e,t),n.createComponentForDisplayMode(c.b(o)?s:o);case r.a.separator:return n=this.buildControl(e,t),n.createComponentForDisplayMode("Small");case r.a.toggleButton:return n=this.buildControl(e,t),n.createComponentForDisplayMode(c.b(o)?s:o);default:throw Error.create("Invalid control type.")}}constructor(e,t,n,a){if(super(e,t,T.Task.fromResult(n),a),this.onReturnToolbarData=e=>{const t=e.contextData;this.set_toolbar(this.buildToolbarFromData(e.queryData,t)),this.toolbar.toolbarBuilder=this,this.toolbar.refreshInternal(),this.placeholder.appendChild(this.toolbar.elementInternal),S.a.ensureCSSClassOnElement(this.placeholder,"loaded"),this.buildClientTask.continueWith((e=>{this.buildClientTask.result.onComponentBuilt(this.toolbar,this.toolbar.id)}),11)},c.d(t))throw Error.create("Toolbar placeholder DOM element is null or undefined.")}}(0,a.a)(v,"ToolbarBuilder",i.a,[])},6662:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var a=n(100),i=n(9865),o=n(7072),r=n(6094),s=n(9858),l=n(1903);class c{static removeChildNodes(e){if(l.d(e))return null;const t=e.parentNode;if(t){const n=e.cloneNode(!1);return t.replaceChild(n,e),n}{let t,n=e.firstChild;for(;n;)t=n.nextSibling,e.removeChild(n),n=t;return e}}static removeChildNodesSlow(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}static toggleCSSClassOnElement(e,t,n){n?c.ensureCSSClassOnElement(e,t):c.removeCSSClassFromElement(e,t)}static ensureCSSClassOnElement(e,t){if(l.d(e))return;const n=e.className;if(!l.d(n)&&-1!==n.indexOf(t))return;let a=n.trim()+" "+t;a=a.trim(),e.className=a}static removeCSSClassFromElement(e,t){if(l.d(e)||l.d(t)||l.d(e.className))return;const n=e.className;n!==n.replace(t,"")&&(e.className=n.replace(t,""))}static setEnabledOnElement(e,t,n=!1,a=!1){if(null!=e&&!n){c.toggleCSSClassOnElement(e,"cui-disabled",!t);const n=t?o.a.ariaFalseValue:o.a.ariaTrueValue;o.a.setAriaAttribute(e,o.a.ariaDisabledAttribute,n),a&&o.a.setAriaAttribute(e,o.a.ariaReadOnlyAttribute,n)}}static addToTabLoop(e){e.tabIndex=0}static createNoOpLink(e=!0){const t=c.createElement("a");return e&&c.addToTabLoop(t),t}static validateStringProperty(e,t){return null==e&&null==(e=t)&&(e=""),e}static setUnselectable(e,t,n){if(!l.d(e)&&"#text"!==e.nodeName&&(t?e.setAttribute("unselectable","on"):e.setAttribute("unselectable","off"),n)){let n=e.firstChild;for(;n;)c.setUnselectable(n,t,!0),n=n.nextSibling}}static createClusteredImageContainerNew(e,t,n,a,i,o){const r=o?c.createBlockSpan():c.createElement("span");return r.className+=i?" cui-img-cont-float ":" cui-img-container ",r.className+=c.imageSizeToClass[e],l.b(t)||(r.appendChild(a),a.src=t,a.setAttribute("role","presentation"),l.d(n)||(a.className=n)),r}static setLargeControlText(e,t,n){let a=t,i=!1,o=null;const r=t.lastIndexOf("");if(-1!==r)a=t.substr(0,r),i=!0,o=t.substr(r+2);else{const e=t.lastIndexOf(" ");-1!==e?(a=t.substr(0,e),i=!0,o=t.substr(e+1)+(n?" ":"")):n&&(i=!0)}e.innerHTML="",e.appendChild(document.createTextNode(a)),i&&e.appendChild(document.createElement("br"));const s=!l.b(o);s&&e.appendChild(document.createTextNode(o)),c.ensureCSSClassOnElement(e,s?"cui-ctl-largelabel-twoline":"cui-ctl-largelabel-singleline")}static setControlText(e,t,n){r.a.setFormattedTextToPlaceholders(e,t,n,(e=>{const t=c.createElement("span");return t.setAttribute("dir","auto"),t.innerText=e,t}))}static releaseEventHandlersRecursively(e){if(!l.d(e)&&(c.unregisterAllHandlers(e),!l.d(e.childNodes)))for(let t=0;t<e.childNodes.length;t++)c.releaseEventHandlersRecursively(e.childNodes[t])}static createBlockSpan(){const e=c.createElement("span");return e.className="cui-block",e}static isTrue(e){return!l.d(e)&&"true"===s.a.toLower(e)}static isFalse(e){return!l.d(e)&&"false"===s.a.toLower(e)}static createElement(e){const t=document.createElement(e);return t.setAttribute("unselectable","on"),t}static createSelectableElement(e){return document.createElement(e)}static cancelPendingTimeout(e){return-1!==e&&(window.clearTimeout(e),e=-1),e}static cancelInterval(e){return-1!==e&&(window.clearInterval(e),e=-1),e}static unregisterAllHandlers(e){i.EventHandlerManager.instance.unregisterAllHandlers(e)}static preventDefaultKeyAction(e,t){return e.innerEvent.keyCode===t&&(e.innerEvent.preventDefault(),!0)}static isEncodedStringArray(e){return e.startsWith(c._encodedStringArrayToken)}static decodeStringArrayXmlAttribute(e){if(l.b(e)||!e.startsWith(c._encodedStringArrayToken))return null;if(!(e=e.slice(c._encodedStringArrayToken.length)).length)return null;const t=[];for(;e.length>0;){const n=parseInt(e);if(isNaN(n)||n<0)return null;const a=e.indexOf(",");if(-1===a)return null;t.push(e.substr(a+1,n)),e=e.slice(a+1+n+1)}return t}}c._encodedStringArrayToken="STRARRY@",c.imageSizeToClass=["","cui-img-5by3","cui-img-8by8","cui-img-13by13","cui-img-16by16","cui-img-32by32","cui-img-40by40","cui-img-48by48","cui-img-64by48","cui-img-85by48","cui-img-1by16","cui-img-14by14","cui-img-24by24","cui-img-20by20","cui-img-30by30","cui-img-120by20","cui-img-84by21","cui-img-90by21","cui-img-200by200","cui-img-70by48"],c.galleryElementDimensionsToSizeString=["","Size16by16","Size40by40","Size48by48","Size61by75","Size64by48","Size85by48","Size110by75","Size85by16","Size32by32","Size120by20","Size20by20","Size24by24","Size84by21","Size90by21","Size200by200","Size70by48"],(0,a.a)(c,"Utility",null,[])},988:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{static getNameFromId(e){switch(e){case 617890675:return"AccCheckerFocusBackward";case 2971500747:return"AccCheckerFocusBottom";case 3772228079:return"AccCheckerFocusForward";case 1785655699:return"AccCheckerFocusTop";case 83795095:return"AccessibilityHelp";case 389865630:return"AccessibilityHelpDialogFocusBackward";case 3803697328:return"AccessibilityHelpDialogFocusForward";case 2129647753:return"ActionAIFromTellMe";case 1750752436:return"ActivityNotificationButtonHandler";case 3602816928:return"ActivityNotificationClosed";case 3343352239:return"AddInBlogClicked";case 1402209562:return"AddInCommandsActionHandler";case 2373245323:return"AddInCommandsActionHandlerForContextMenu";case 2924253939:return"AddInListClicked";case 1385019911:return"AddinSuggestion1";case 981735384:return"AddinSuggestion2";case 2547819325:return"AddinSuggestion3";case 798637440:return"AlwaysEnabled";case 1456457774:return"AlwaysShowRibbon";case 3030242601:return"AnswerForSearch";case 587759533:return"AnswerForSearchSingleLine";case 2434078920:return"amutTest1";case 2434078917:return"amutTest2";case 2434078918:return"amutTest3";case 3896010204:return"Animation";case 613275288:return"AnonymousCreationNavigateAfterSave";case 2316947260:return"AnonymousCreationSaveToHost";case 2799657174:return"AppSettingsRefreshSkipCache";case 2175352112:return"AuthenticationLost";case 2556904104:return"AuthenticationRestored";case 4289528682:return"BlockIfFocusedTextField";case 3551492845:return"BlockIfNotFocusedTextField";case 2279655429:return"BreadcrumbLinkClick";case 2989986573:return"BrowseTemplates";case 954512041:return"BusinessBarButtonOne";case 1404592381:return"BusinessBarButtonTwo";case 3484823337:return"BusinessBarClose";case 3786550719:return"BusinessBarInvoke";case 2119511063:return"BusinessBarLink";case 1217108723:return"CalloutNotificationClosed";case 1281138585:return"CancelPresenceTooltips";case 1915117369:return"CancelSigninBusinessBar";case 3270784282:return"CancelSigninDialog";case 1206905761:return"CatchUpActiveAwarenessSession";case 4152101977:return"CatchUpFlyoutInitialized";case 1783852782:return"CatchUpPassiveAwarenessSession";case 1168274369:return"CheckTab";case 3134914741:return"CheckTabShift";case 3695056554:return"CheckUserAccessAndGrantPermissionsTest";case 2598811989:return"CheckUserAccessTest";case 2635327499:return"ClearSearch";case 241072808:return"ClearSearchFromSearchMenu";case 3033402446:return"Close";case 1895329487:return"CloseAccessibilityCheckerPane";case 1520278933:return"CloseEnrichmentPane";case 1530887760:return"CloseExtensionTaskPane";case 953328883:return"CloseSwitcher";case 691867605:return"CoauthorsRendered";case 327119921:return"CoEditInTeams";case 3411172825:return"CommentActivityPreviewed";case 36098707:return"CommentActivitySelected";case 3259256685:return"CommentBeginRefresh";case 1637502579:return"CommentBeginRefreshRefused";case 863375655:return"CommentBeginSucceeded";case 1510212254:return"CommentCancelled";case 1137396240:return"CommentDeeplinkOpened";case 467845448:return"CommentDelete";case 375707647:return"CommentDone";case 3609945866:return"CommentDownloadFailed";case 159412208:return"CommentDownloadSucceeded";case 1951217806:return"CommentHintClick";case 2477668749:return"CommentHintMouseExit";case 4198211167:return"CommentHintMouseOver";case 1046295975:return"CommentNewCreated";case 2462410242:return"CommentNewSaved";case 4041287661:return"CommentReply";case 516537638:return"CommentSaveNetworkError";case 4156131848:return"CommentSaveRetry";case 1991982245:return"CommentSaveSucceeded";case 485487087:return"CommentTabBackward";case 2489743155:return"CommentTabForward";case 3103450156:return"CommentUndone";case 1808554760:return"CommitNewDocumentTitle";case 2609364291:return"ContactSupport";case 598474581:return"ContextIQCardKept";case 3811196014:return"ContextIQCardSeen";case 3591976157:return"ContextIQCardTried";case 710925581:return"Conversation";case 3960197378:return"CopilotAddSlideFromRibbon";case 2008081326:return"CopilotFromTellMeForQuery";case 1367111134:return"CopilotLabPrompt1";case 1367111135:return"CopilotLabPrompt2";case 1367111136:return"CopilotLabPrompt3";case 1367111137:return"CopilotLabPrompt4";case 1367111138:return"CopilotLabPrompt5";case 1367111139:return"CopilotLabPrompt6";case 1750478296:return"CopyAndEdit";case 3505086889:return"CopyLink";case 1278286187:return"CreateDocument";case 195579685:return"DecreaseZoom";case 1756450500:return"Definitions";case 2114287254:return"DefinitionsForTellMe";case 211953924:return"DialogAction";case 3756639316:return"DialogCancel";case 844297214:return"DialogClose";case 1245654357:return"DialogMove";case 646039090:return"DialogSecondaryAction";case 1825605114:return"DialogTertiaryAction";case 779285039:return"DigitalPrintToSwaySlabClicked";case 4275690876:return"DimeLaunch";case 3619977465:return"DismissNewCommentActivityIndicator";case 3113540593:return"DisposeCrossDocumentMessenger";case 537152338:return"DoBrowserDefault";case 1169404878:return"DocumentLoaded";case 567929329:return"DoesCommentExist";case 336231556:return"DoNothing";case 1203133001:return"DoNothingInEdit";case 3555692408:return"DownloadACopy";case 1695673896:return"DownloadACopyDownloadButtonClick";case 4214516015:return"DroppedKey";case 2619015155:return"EditComment";case 2413704991:return"EndPinchToZoom";case 508686645:return"EnterAddInBackstageEntryPoint";case 291542435:return"EditDocument";case 1257657435:return"ExecuteAddinAction";case 3280707168:return"ExecuteDynamicAddInCommandsAPI";case 1176360680:return"ExecuteUnitTests";case 2281252844:return"ExecuteUnitTestsBvt";case 1261644258:return"F6";case 715899390:return"F6shift";case 1754333801:return"FeedbackSubmit";case 3019354063:return"FeedbackCancel";case 22240842:return"FeedbackButtonInSearchResultView";case 3537588550:return"FileNameUpdate";case 512688659:return"FileProperties";case 981334692:return"FileSharing";case 2260671807:return"FileSuggestion1";case 2260671810:return"FileSuggestion2";case 2260671809:return"FileSuggestion3";case 2260671804:return"FileSuggestion4";case 2260671803:return"FileSuggestion5";case 3541645273:return"FindReplaceInDocument";case 1540292897:return"FindInDocument";case 2301299442:return"FindInDocumentSuggestion1";case 2301299439:return"FindInDocumentSuggestion2";case 2301299440:return"FindInDocumentSuggestion3";case 2398455418:return"FindMatchCase";case 1783557e3:return"FindWholeWord";case 15750502:return"FireGetRelevantActivities";case 1486778386:return"FirstRunExperienceCompleted";case 3016992658:return"FirstRunExperienceFocusBackward";case 1501863744:return"FirstRunExperienceFocusForward";case 672565674:return"FirstRunExperienceShowUI";case 710478303:return"FocusToBrowser";case 348609604:return"FreemiumUpsellBadge";case 4180531998:return"FreemiumUpsellDialogShowUI";case 1274543852:return"FreemiumUpsellEligible";case 993040927:return"FrenchAccessibilityStatement";case 146595126:return"FontPickerMenuClose";case 482125874:return"FontPickerMenuOpen";case 2862675062:return"GenerateSlidesFromTellMe";case 4288982261:return"GetAnimationStats";case 1005492778:return"GetClientUrl";case 3890502328:return"GetUserContactsTest";case 3094869204:return"GetUserProfilePictureTest";case 2382078381:return"GetWebUrl";case 802602464:return"GiveFeedback";case 577991405:return"GrantUserAccessTest";case 2280081216:return"HandleDiscoverPremiumButtonClick";case 1454393937:return"Help";case 2493123577:return"HideCommentPane";case 1592314317:return"HideUILessDialog";case 1751736801:return"HostCopyLink";case 3107136749:return"HostUnload";case 3018530951:return"IncreaseZoom";case 3740310824:return"InitializeRenameUIHandler";case 1052791248:return"InsertLinkFlyout";case 3482007971:return"InsertAddInsFromBackstage";case 1083030595:return"InsertAddInsFromUnifiedStore";case 3560152131:return"InsertMoreAddInsFromBackstageFooter";case 211882228:return"InsertMoreAddInsFromFooter";case 56493533:return"InsertOfficeAddin";case 1660668180:return"InsertOfficeAddinFromInstallDialog";case 3057666303:return"InsertRecentLinks";case 1435347209:return"Insights";case 3317204163:return"InsightsForTellMe";case 2882601901:return"InstallPopularAddInAndLaunchIt";case 1091430333:return"InvokeAutoLaunchSearchRequest";case 3534466409:return"InvokeDefinitionSearchFromFloatie";case 2823076269:return"InvokeDictionarySerpletContextMenu";case 2670256092:return"InvokeFilesSerplet";case 234181094:return"InvokeFilesSerpletHomeTab";case 1427850399:return"InvokeInsertFilesLinkSerplet";case 4149966010:return"InvokeImageSerpletContextMenu";case 720345883:return"InvokeSynonymsSerpletContextMenu";case 3565729580:return"InvokeInDocSerplet";case 932533025:return"InvokeInDocSerpletWithLaunchData";case 1914896509:return"InvokeSerplet";case 1828157298:return"InvokeSerpletBrowseFiles";case 4195071443:return"InvokeSerpletRibbon";case 2861781337:return"InvokeSerpletContextMenu";case 1237809391:return"InvokeSerpletConversations";case 664031587:return"InvokeSerpletPasteAsNewSlide";case 1291817299:return"InvokeSerpletSlidesCompression";case 3753647215:return"InvokeSerpletTellMeNotes";case 3359903192:return"InvokeSerpletTellMeZeroTerm";case 3087426977:return"InvokeZeroTermSerpletContextMenu";case 3799468329:return"IsJoined";case 1349521433:return"ItalianAccessibilityStatement";case 2246375352:return"JoinChatThread";case 57698967:return"KeyManagerCommandUnitTest";case 407117407:return"LaunchAddInCommands";case 1421877154:return"LaunchAddinDialogFromTellMe";case 1945259303:return"LaunchAppForOfficeDialog";case 3813047554:return"LaunchFastCards";case 1784018444:return"LaunchFileMenu";case 951969558:return"LaunchMenu";case 1371160511:return"LaunchUserInstalledAddInFromBackstage";case 2544406033:return"LaunchUserInstalledAddInFromFlyout";case 3614377462:return"LaunchUnifiedStore";case 1478840041:return"LaunchSigninWindow";case 3669674706:return"LaunchSDXAddSlideDialog";case 691764786:return"LaunchSDXDialog";case 3935259562:return"LaunchAddinInstallDialog";case 3164366947:return"LaunchAddinInstallDialogFromBackstage";case 1497204054:return"LaunchAddinInstallDialogFromList";case 2531463828:return"LaunchWildFireBusinessBar";case 2153376084:return"LivePersonaCardAction";case 735428811:return"LogCanvasContext";case 1182470434:return"MoveToFolder";case 2482841374:return"MoveToFolderCompleteByHost";case 1251719100:return"TriggerModeSwitcherTUI";case 3475093410:return"MultiTouch";case 3734060499:return"NewBrowserSuggestionClicked";case 2423504651:return"NewComment";case 1002198721:return"NewCommentActivityReady";case 1056925771:return"NewDocument";case 3266255548:return"NewReply";case 1938400843:return"NotifyCommentDoesNotExist";case 3506486948:return"NoTouchStart";case 1448619089:return"O365SwitcherReady";case 3389570779:return"OnDemandLoadingDialogCancelled";case 3963562945:return"OnDemandLoadingDialogCompleted";case 4083547050:return"OnenoteNotesSuggestion1";case 4083547053:return"OnenoteNotesSuggestion2";case 4083547052:return"OnenoteNotesSuggestion3";case 3476734992:return"OpenBasicChatPane";case 1983347010:return"OpenChatPane";case 4178239494:return"OpenConsumerHealthPolicyLink";case 2068502235:return"OpenDocument";case 3596468139:return"OpenDocumentFromMru";case 3427834559:return"OpenDocumentLabelPane";case 390001269:return"OpenDocumentShortLabelPane";case 2155708348:return"OpenDocumentUrl";case 2596942163:return"OpenInBrowser";case 2683007645:return"OpenSwitcher";case 2349775795:return"OpenTermsOfUseLink";case 1959943459:return"OpenUrlInNewTab";case 628793421:return"OreoOnToggleRibbonState";case 3723784884:return"OtelSendSampleOfEvents";case 2888780028:return"OtelSendTelemetryEvents";case 1298584397:return"OtelSendTelemetryEventsPeriodically";case 929022654:return"CoauthoringCommand";case 3236517055:return"CoauthoringCommandMenuClose";case 250882013:return"CoauthoringCommandMenuOpen";case 1285265560:return"CoauthoringPopulateFlyout";case 3798167515:return"CoauthoringQueryStatus";case 2052777571:return"CoauthoringRefreshControl";case 4033456482:return"CoauthoringUserButtonClick";case 2133437452:return"PeopleSuggestion1";case 2133437453:return"PeopleSuggestion2";case 2133437454:return"PeopleSuggestion3";case 1397611854:return"PerformUserAuth";case 1500655301:return"PinOrUnpinFont";case 1230970894:return"PopulateAddInGallery";case 3418030507:return"PopulateCitationAddInGallery";case 3675896289:return"PopulateDialogMenu";case 492631662:return"PopulateFileMenuFlyout";case 276140882:return"PopulateInsertLinkFlyout";case 3836269153:return"populateMruFlyout";case 2799130311:return"PopulateMruMenu";case 2074131365:return"PopulateNewMenu";case 3303609078:return"PopulateNewMenuFlyout";case 860679239:return"PopulateRecentLinksFlyout";case 1145315516:return"PopulateSensitivityFlyout";case 65739653:return"PremiumTemplateExperience";case 3934434802:return"PreviewPanelTabBackward";case 1596970964:return"PreviewPanelTabForward";case 1208554566:return"PrivacyLink";case 1646994466:return"PublishToWeb";case 1309495434:return"QueryAddInCommandsLoadStatus";case 3893417908:return"QueryAddinDetails";case 2749373765:return"QueryAddInFlyout";case 696500923:return"QueryAppBuildVersion";case 3847984948:return"QueryBreadcrumbDocName";case 3874562422:return"QueryBuildVersion";case 969756804:return"QueryCitationFlyout";case 3720034241:return"QueryClearSearch";case 4240910315:return"QueryCopilotChatTaskpaneVisible";case 825574620:return"QueryCopyAndEditButton";case 1478537812:return"QueryDocChatButtonStatus";case 2480422205:return"QueryDocLocationInfo";case 3943987592:return"QueryDownloadACopy";case 860152194:return"QueryEntitledAppsForOffice";case 3887408216:return"QueryEnvironmentName";case 1399875355:return"QueryFilePathInfo";case 1369572530:return"QueryFindMatchCase";case 3914542e3:return"QueryFindWholeWord";case 3165667641:return"QueryNewDocument";case 49122376:return"QueryPackageInitialized";case 497870830:return"QueryPolicyLabel";case 888027492:return"QueryPolicyShortLabel";case 1732570541:return"QuerySaveToSharePoint";case 3134802707:return"QuerySensitivity";case 2875864574:return"QuerySensitivitySubFlyout";case 991261903:return"QuerySensitivityToggleButton";case 2793115165:return"QuerySessionId";case 1536028887:return"QuerySimplifiedRibbonIsEnabled";case 1557026322:return"QueryStaticUiTouchMode";case 1949220702:return"QueryToggleAccCheckerButton";case 1059068017:return"QueryToggleCatchUpFlyout";case 847427893:return"QueryToggleCommentPane";case 3677246697:return"QueryToggleSerplet";case 4080155406:return"QueryUserSessionId";case 1779942695:return"QueryUploadDocumentFromPc";case 433063458:return"QueryZoomText";case 2901130581:return"QueryZoomPercentage";case 548581900:return"QuickActionOnFile";case 2576944597:return"RaiseActionToHost";case 269161319:return"RebootUrlOnUiHost";case 2535492938:return"RecentLinks";case 2999339013:return"RedoCommentAction";case 543799107:return"RefreshAddinCommands";case 2854028228:return"RefreshChatControl";case 2924716042:return"RegionMoveBackward";case 1656936120:return"RegionMoveForward";case 3186588517:return"RegisterAddinDetailsObserver";case 741381681:return"RegisterAppActivatedEvent";case 2502873265:return"ReloadAddInPicker";case 3207566856:return"ReloadCitationAddInPicker";case 4019674508:return"RemoveAppForOffice";case 1897077126:return"RenameFile";case 3502386740:return"RenameMostRecentlyUsedFileEntry";case 1197060601:return"ReplyWithChanges";case 3237171630:return"ReportAbuseLink";case 4248596885:return"ReportFileMenuPageAbout";case 1074909883:return"ReportFileMenuPageHome";case 127178350:return"ReportFileMenuPageInfo";case 1852071536:return"ReportFileMenuPageNew";case 2392426770:return"ReportFileMenuPageOpen";case 2971760737:return"ReportFileMenuPagePrint";case 4100738419:return"ReportFileMenuPageSaveAs";case 720070809:return"ReportFileMenuPageShare";case 4133531354:return"ReportFileMenuPageSwitch";case 3048126886:return"ReportFileMenuPageTransform";case 1649065493:return"ReportFileMenuPageDelete";case 3188037073:return"ReportFileMenuPageAddins";case 3865908344:return"ReportFileMenuPageUnknown";case 1509043591:return"ReportFreemiumUpsellBadgeClicked";case 975509583:return"ReportFreemiumUpsellBadgeDisplayed";case 3865601672:return"ReportFreemiumUpsellDialogClicked";case 2275483468:return"ReportFreemiumUpsellDialogDismissed";case 4142738798:return"ReportFreemiumUpsellDialogDisplayed";case 4177432571:return"ReportFreemiumUpsellEligibleClicked";case 2539564555:return"ReportFreemiumUpsellEligibleDisplayed";case 1355500294:return"ReportLegacyRibbonLoaded";case 1128336726:return"ReportMRUFromHomePage";case 105169305:return"ReportMRUFromOpenPage";case 4188650553:return"ReportOneLineRibbonLoaded";case 2050007412:return"ReportRibbonModeMLR";case 2050007578:return"ReportRibbonModeSLR";case 2363934117:return"ReportSwitchFromLegacyRibbon";case 422501225:return"ReportSwitchFromSimplifedRibbon";case 903886994:return"ReportTabAddins";case 1120156565:return"ReportTabChart";case 877400639:return"ReportTabCopilot";case 1449630229:return"ReportTabData";case 3221800135:return"ReportTabDeveloper";case 3099434941:return"ReportTabDrawing";case 3696531680:return"ReportTabFormulas";case 2625726220:return"ReportTabHelp";case 4191810468:return"ReportTabHome";case 469886678:return"ReportTabInsert";case 491924414:return"ReportTabPageLayout";case 3328108543:return"ReportTabReview";case 454423290:return"ReportTabShare";case 2527431031:return"ReportTabSwitch";case 1042496661:return"ReportTabSwitchManual";case 3841439565:return"ReportTabUnknown";case 2652577546:return"ReportTabView";case 1240571126:return"ReportTemplateFromHomePage";case 3302080867:return"ReportTemplateFromNewPage";case 1380507044:return"ReportVersionHistorySaveACopySuccess";case 951489623:return"ReportVersionHistorySaveACopyFailure";case 3169500754:return"RequestFontInfo";case 1557191504:return"RequestMoreAccess";case 1481673185:return"ResetShortcutPreferences";case 3286563559:return"ResponsiveUxAutomaticOff";case 1323818969:return"RestartExtensionTaskPane";case 637959088:return"ResumeFocusWithDirection";case 1782110672:return"RetrieveAddInCommandsEntitlementsList";case 1596290176:return"RetryOpenInClient";case 4169072475:return"RibbonEsc";case 1047758638:return"RibbonFocus";case 536345575:return"RibbonModeToggledToMLR";case 4031133701:return"RibbonModeToggledToSLR";case 1254348094:return"RibbonMoveBackward";case 2187030096:return"RibbonMoveForward";case 1308255763:return"RibbonStateChanged";case 3190032724:return"RibbonTabSwitched";case 4246497969:return"SaveACopy";case 2773392339:return"SaveAnonymousCreation";case 2316717900:return"SaveAsToHost";case 3070187925:return"SaveFileChange";case 617689800:return"SaveToCloudStorage";case 3050207199:return"SaveToSharePoint";case 1371513149:return"ScreenBucket_W_Large_H_Large";case 4069406845:return"ScreenBucket_W_Large_H_Medium";case 268548051:return"ScreenBucket_W_Large_H_Small";case 3633471113:return"ScreenBucket_W_Medium_H_Large";case 3974459409:return"ScreenBucket_W_Medium_H_Medium";case 3955978899:return"ScreenBucket_W_Medium_H_Small";case 4063922707:return"ScreenBucket_W_Small_H_Large";case 1743731911:return"ScreenBucket_W_Small_H_Medium";case 3084758525:return"ScreenBucket_W_Small_H_Small";case 2918242107:return"SearchHelp";case 1873541548:return"SelectNextComment";case 4242021840:return"SelectPrevComment";case 3244486608:return"SetInDocSearchParameter";case 2935633379:return"SetSensitivity";case 501097794:return"SetTitleExtensionTaskPane";case 2596151084:return"ShareCopyLink";case 1365012288:return"ShareDocument";case 736246900:return"ShareManageAccess";case 1384511460:return"SharedCommentsCancelCommentCreateThread";case 3401575755:return"SharedCommentsCommitComment";case 1426025625:return"SharedCommentsCommitDraft";case 2297956587:return"SharedCommentsCreateReply";case 3866509012:return"SharedCommentsCreateReplyWithMentions";case 2104859114:return"SharedCommentsCreateReplyWithTaskAssigned";case 2716070047:return"SharedCommentsCreateThread";case 355666834:return"SharedCommentsCreateThreadWithMentions";case 2470061772:return"SharedCommentsCreateThreadWithTaskAssigned";case 3191809076:return"SharedCommentsDeletePost";case 1912911518:return"SharedCommentsDeleteThread";case 1414137793:return"SharedCommentsDeleteThreadWithTask";case 1127700748:return"SharedCommentsDiscardDraft";case 1978095600:return"SharedCommentsPresentLinkToCommentAction";case 243899744:return"SharedCommentsReopenThread";case 1615492167:return"SharedCommentsReopenThreadWithTask";case 738982675:return"SharedCommentsRequestInitCommentSession";case 537095687:return"SharedCommentsResolveThread";case 88639566:return"SharedCommentsResolveThreadWithTask";case 334636250:return"SharedCommentsSelectComment";case 2079612261:return"SharedCommentsUpdateCommentBodyAction";case 2529583086:return"ShowAccessibilityCheckerPane";case 3276527670:return"ShowAccessibilityHelpDialog";case 2236763780:return"ShowAccessibilitySettingsDialog";case 516359383:return"ShowAddInCommandsLoadStatusCallout";case 2269104277:return"ShowAddInErrorDialog";case 3510751882:return"ShowCommentPane";case 4284341431:return"ShowContextMenu";case 2269433685:return"ShowContextMenuWithFloatie";case 4193807224:return"ShowDialogMenu";case 2451283737:return"ShowExtensionTaskpane";case 3681556347:return"ShowFileVersion";case 459047735:return"ShowFloatie";case 2391539661:return"ShowFloatPane";case 1203507006:return"ShowGrantUserAccessDialog";case 2226126638:return"PopulateAddInMRUContextMenu";case 1381116675:return"ShareAddIn";case 2603175857:return"ShowInsightsForSuggestion";case 1088082265:return"ShowMultilineRibbonFromToolbar";case 2382951455:return"ShowRenameDialog";case 2679862750:return"ShowRenameFlyout";case 2638199087:return"ShowRenameDisabledDialog";case 4211880506:return"ShowRibbonSettingsDialog";case 83993843:return"ShowSmartLookupForSuggestion";case 545765261:return"ShowSmartLookupFromCommand";case 1055590629:return"ShowTellMeCoachmark";case 2220417879:return"ShowThirdPartyNotices";case 2583751502:return"ShowTrustCenter";case 2517401660:return"ShowUILessDialog";case 466976539:return"ShowVersionHistoryDialog";case 1738002952:return"ShowZoomDialog";case 4196619892:return"SignIn";case 1534118067:return"SignInNavigate";case 3231625709:return"SimulateO365ShellServiceReceived";case 606289265:return"SmartLookupForTellMe";case 1621589088:return"StartPinchToZoom";case 526150751:return"StatusBarMoveBackward";case 937490595:return"StatusBarMoveForward";case 1550573691:return"SwitcherTileClick";case 2118858169:return"SwitchModeToDocumentEdit";case 380914761:return"TabSwitch";case 2652476189:return"TellMe";case 4054875485:return"TellMeAccessibilityMenuText";case 2751631965:return"TellMeCacheAsyncMenuRefresh";case 2230755196:return"TellMeFeedback";case 815990803:return"TellMeFocusInput";case 586156566:return"TellMeInteractionBegin";case 878547493:return"TellMeLogCommandExecuted";case 1024534176:return"TellMeLogInputBlur";case 2303219627:return"TellMeLogInputFocus";case 4266170064:return"TellMeLogMenuClose";case 2480888384:return"TellMeLogMenuOpen";case 1708531416:return"TellMeLogOfficeAppStatusQuery";case 3243793933:return"TellMeRestoreFocus";case 1404166600:return"TellMeTryQuery";case 57037313:return"TemplateForSearch";case 2145510275:return"ToggleAnimations";case 3418267371:return"ToggleCatchUpFlyout";case 2288458806:return"ToggleChatPane";case 2281051331:return"ToggleCommentPane";case 2758000563:return"ToggleRibbonState";case 2684863833:return"ToggleRibbonUX";case 1342108365:return"ToggleRibbonUXDialog";case 941487903:return"ToggleSensitivity";case 2478534165:return"TouchStart";case 1468994080:return"Training";case 3485513367:return"TriggerFloodgateSurvey";case 3901198658:return"TryMacOffice";case 1391456747:return"TryMacOfficeFromPowerPointViewer";case 201621520:return"TryMacOfficeFromWordViewer";case 1773624819:return"TryOffice";case 4268365028:return"TryOfficeFromPowerPointViewer";case 2578423837:return"TryOfficeFromWordViewer";case 215809929:return"TryOfficeThroughTellMe";case 3466807785:return"UndoCommentAction";case 2112877354:return"UpdateCommandUI";case 2646433959:return"UpdateExtensionComponent";case 736837252:return"UpdateFavorites";case 1852918846:return"UpdateSaveStatusForHeader";case 3649559640:return"UpdateVersionsPane";case 176872269:return"UploadDocumentFromPc";case 2424604265:return"UserSurveyCancel";case 3800318691:return"UserSurveySubmit";case 3329796304:return"SupportsExchangeRestApisTest";case 3182458430:return"VersionHistory";case 2585716125:return"ViewAllFiles";case 1255721029:return"WhatsNew";case 3574662461:return"WolframForSearch";case 2988588587:return"Workflow";case 2910828042:return"ZoomDialogFocusBackward";case 2095185708:return"ZoomDialogFocusForward";case 3745693956:return"ZoomToPercentage";case 3139946409:return"ZoomToPercentageCompleted";case 1713113610:return"ImageForSearch";case 1006342541:return"LearningForSearch";case 667209510:return"SmartLookupFromTellMeQueryTermAtTop";case 1617957002:return"SearchAddinInFlyout";case 2710666765:return"OneNoteAppUpsellDismissed";case 2835215311:return"OneNoteAppUpsellButtonClicked"}return null}}i.accCheckerFocusBackward=617890675,i.accCheckerFocusBottom=2971500747,i.accCheckerFocusForward=3772228079,i.accCheckerFocusTop=1785655699,i.accessibilityHelp=83795095,i.accessibilityHelpDialogFocusBackward=389865630,i.accessibilityHelpDialogFocusForward=3803697328,i.actionAIFromTellMe=2129647753,i.activityNotificationButtonHandler=1750752436,i.activityNotificationClosed=3602816928,i.addInBlogClicked=3343352239,i.addInCommandsActionHandler=1402209562,i.addInCommandsActionHandlerForContextMenu=2373245323,i.addInListClicked=2924253939,i.addinSuggestion1=1385019911,i.addinSuggestion2=981735384,i.addinSuggestion3=2547819325,i.alwaysEnabled=798637440,i.alwaysShowRibbon=1456457774,i.answerForSearch=3030242601,i.answerForSearchSingleLine=587759533,i.amutTest1=2434078920,i.amutTest2=2434078917,i.amutTest3=2434078918,i.animation=3896010204,i.anonymousCreationNavigateAfterSave=613275288,i.anonymousCreationSaveToHost=2316947260,i.appSettingsRefreshSkipCache=2799657174,i.authenticationLost=2175352112,i.authenticationRestored=2556904104,i.blockIfFocusedTextField=4289528682,i.blockIfNotFocusedTextField=3551492845,i.breadcrumbLinkClick=2279655429,i.browseTemplates=2989986573,i.businessBarButtonOne=954512041,i.businessBarButtonTwo=1404592381,i.businessBarClose=3484823337,i.businessBarInvoke=3786550719,i.businessBarLink=2119511063,i.calloutNotificationClosed=1217108723,i.cancelPresenceTooltips=1281138585,i.cancelSigninBusinessBar=1915117369,i.cancelSigninDialog=3270784282,i.catchUpActiveAwarenessSession=1206905761,i.catchUpFlyoutInitialized=4152101977,i.catchUpPassiveAwarenessSession=1783852782,i.checkTab=1168274369,i.checkTabShift=3134914741,i.checkUserAccessAndGrantPermissionsTest=3695056554,i.checkUserAccessTest=2598811989,i.clearSearch=2635327499,i.clearSearchFromSearchMenu=241072808,i.close=3033402446,i.closeAccessibilityCheckerPane=1895329487,i.closeEnrichmentPane=1520278933,i.closeExtensionTaskPane=1530887760,i.closeSwitcher=953328883,i.coauthorsRendered=691867605,i.coEditInTeams=327119921,i.commentActivityPreviewed=3411172825,i.commentActivitySelected=36098707,i.commentBeginRefresh=3259256685,i.commentBeginRefreshRefused=1637502579,i.commentBeginSucceeded=863375655,i.commentCancelled=1510212254,i.commentDeeplinkOpened=1137396240,i.commentDelete=467845448,i.commentDone=375707647,i.commentDownloadFailed=3609945866,i.commentDownloadSucceeded=159412208,i.commentHintClick=1951217806,i.commentHintMouseExit=2477668749,i.commentHintMouseOver=4198211167,i.commentNewCreated=1046295975,i.commentNewSaved=2462410242,i.commentReply=4041287661,i.commentSaveNetworkError=516537638,i.commentSaveRetry=4156131848,i.commentSaveSucceeded=1991982245,i.commentTabBackward=485487087,i.commentTabForward=2489743155,i.commentUndone=3103450156,i.commitNewDocumentTitle=1808554760,i.contactSupport=2609364291,i.contextIQCardKept=598474581,i.contextIQCardSeen=3811196014,i.contextIQCardTried=3591976157,i.conversation=710925581,i.copilotAddSlideFromRibbon=3960197378,i.copilotFromTellMeForQuery=2008081326,i.copilotLabPrompt1=1367111134,i.copilotLabPrompt2=1367111135,i.copilotLabPrompt3=1367111136,i.copilotLabPrompt4=1367111137,i.copilotLabPrompt5=1367111138,i.copilotLabPrompt6=1367111139,i.copyAndEdit=1750478296,i.copyLink=3505086889,i.createDocument=1278286187,i.decreaseZoom=195579685,i.definitions=1756450500,i.definitionsForTellMe=2114287254,i.dialogAction=211953924,i.dialogCancel=3756639316,i.dialogClose=844297214,i.dialogMove=1245654357,i.dialogSecondaryAction=646039090,i.dialogTertiaryAction=1825605114,i.digitalPrintToSwaySlabClicked=779285039,i.dimeLaunch=4275690876,i.dismissNewCommentActivityIndicator=3619977465,i.disposeCrossDocumentMessenger=3113540593,i.doBrowserDefault=537152338,i.documentLoaded=1169404878,i.doesCommentExist=567929329,i.doNothing=336231556,i.doNothingInEdit=1203133001,i.downloadACopy=3555692408,i.downloadACopyDownloadButtonClick=1695673896,i.droppedKey=4214516015,i.editComment=2619015155,i.endPinchToZoom=2413704991,i.enterAddInBackstageEntryPoint=508686645,i.editDocument=291542435,i.executeAddinAction=1257657435,i.executeDynamicAddInCommandsAPI=3280707168,i.executeUnitTests=1176360680,i.executeUnitTestsBvt=2281252844,i.f6=1261644258,i.f6shift=715899390,i.feedbackSubmit=1754333801,i.feedbackCancel=3019354063,i.feedbackButtonInSearchResultView=22240842,i.fileNameUpdate=3537588550,i.fileProperties=512688659,i.fileSharing=981334692,i.fileSuggestion1=2260671807,i.fileSuggestion2=2260671810,i.fileSuggestion3=2260671809,i.fileSuggestion4=2260671804,i.fileSuggestion5=2260671803,i.findReplaceInDocument=3541645273,i.findInDocument=1540292897,i.findInDocumentSuggestion1=2301299442,i.findInDocumentSuggestion2=2301299439,i.findInDocumentSuggestion3=2301299440,i.findMatchCase=2398455418,i.findWholeWord=1783557e3,i.fireGetRelevantActivities=15750502,i.firstRunExperienceCompleted=1486778386,i.firstRunExperienceFocusBackward=3016992658,i.firstRunExperienceFocusForward=1501863744,i.firstRunExperienceShowUI=672565674,i.focusToBrowser=710478303,i.freemiumUpsellBadge=348609604,i.freemiumUpsellDialogShowUI=4180531998,i.freemiumUpsellEligible=1274543852,i.frenchAccessibilityStatement=993040927,i.fontPickerMenuClose=146595126,i.fontPickerMenuOpen=482125874,i.generateSlidesFromTellMe=2862675062,i.getAnimationStats=4288982261,i.getClientUrl=1005492778,i.getUserContactsTest=3890502328,i.getUserProfilePictureTest=3094869204,i.getWebUrl=2382078381,i.giveFeedback=802602464,i.grantUserAccessTest=577991405,i.handleDiscoverPremiumButtonClick=2280081216,i.help=1454393937,i.hideCommentPane=2493123577,i.hideUILessDialog=1592314317,i.hostCopyLink=1751736801,i.hostUnload=3107136749,i.increaseZoom=3018530951,i.initializeRenameUIHandler=3740310824,i.insertLinkFlyout=1052791248,i.insertAddInsFromBackstage=3482007971,i.insertAddInsFromUnifiedStore=1083030595,i.insertMoreAddInsFromBackstageFooter=3560152131,i.insertMoreAddInsFromFooter=211882228,i.insertOfficeAddin=56493533,i.insertOfficeAddinFromInstallDialog=1660668180,i.insertRecentLinks=3057666303,i.insights=1435347209,i.insightsForTellMe=3317204163,i.installPopularAddInAndLaunchIt=2882601901,i.invokeAutoLaunchSearchRequest=1091430333,i.invokeDefinitionSearchFromFloatie=3534466409,i.invokeDictionarySerpletContextMenu=2823076269,i.invokeFilesSerplet=2670256092,i.invokeFilesSerpletHomeTab=234181094,i.invokeInsertFilesLinkSerplet=1427850399,i.invokeImageSerpletContextMenu=4149966010,i.invokeSynonymsSerpletContextMenu=720345883,i.invokeInDocSerplet=3565729580,i.invokeInDocSerpletWithLaunchData=932533025,i.invokeSerplet=1914896509,i.invokeSerpletBrowseFiles=1828157298,i.invokeSerpletRibbon=4195071443,i.invokeSerpletContextMenu=2861781337,i.invokeSerpletConversations=1237809391,i.invokeSerpletPasteAsNewSlide=664031587,i.invokeSerpletSlidesCompression=1291817299,i.invokeSerpletTellMeNotes=3753647215,i.invokeSerpletTellMeZeroTerm=3359903192,i.invokeZeroTermSerpletContextMenu=3087426977,i.isJoined=3799468329,i.italianAccessibilityStatement=1349521433,i.joinChatThread=2246375352,i.keyManagerCommandUnitTest=57698967,i.launchAddInCommands=407117407,i.launchAddinDialogFromTellMe=1421877154,i.launchAppForOfficeDialog=1945259303,i.launchFastCards=3813047554,i.launchFileMenu=1784018444,i.launchMenu=951969558,i.launchUserInstalledAddInFromBackstage=1371160511,i.launchUserInstalledAddInFromFlyout=2544406033,i.launchUnifiedStore=3614377462,i.launchSigninWindow=1478840041,i.launchSDXAddSlideDialog=3669674706,i.launchSDXDialog=691764786,i.launchAddinInstallDialog=3935259562,i.launchAddinInstallDialogFromBackstage=3164366947,i.launchAddinInstallDialogFromList=1497204054,i.launchWildFireBusinessBar=2531463828,i.livePersonaCardAction=2153376084,i.logCanvasContext=735428811,i.moveToFolder=1182470434,i.moveToFolderCompleteByHost=2482841374,i.triggerModeSwitcherTUI=1251719100,i.multiTouch=3475093410,i.newBrowserSuggestionClicked=3734060499,i.newComment=2423504651,i.newCommentActivityReady=1002198721,i.newDocument=1056925771,i.newReply=3266255548,i.notifyCommentDoesNotExist=1938400843,i.noTouchStart=3506486948,i.o365SwitcherReady=1448619089,i.onDemandLoadingDialogCancelled=3389570779,i.onDemandLoadingDialogCompleted=3963562945,i.onenoteNotesSuggestion1=4083547050,i.onenoteNotesSuggestion2=4083547053,i.onenoteNotesSuggestion3=4083547052,i.openBasicChatPane=3476734992,i.openChatPane=1983347010,i.openConsumerHealthPolicyLink=4178239494,i.openDocument=2068502235,i.openDocumentFromMru=3596468139,i.openDocumentLabelPane=3427834559,i.openDocumentShortLabelPane=390001269,i.openDocumentUrl=2155708348,i.openInBrowser=2596942163,i.openSwitcher=2683007645,i.openTermsOfUseLink=2349775795,i.openUrlInNewTab=1959943459,i.oreoOnToggleRibbonState=628793421,i.otelSendSampleOfEvents=3723784884,i.otelSendTelemetryEvents=2888780028,i.otelSendTelemetryEventsPeriodically=1298584397,i.coauthoringCommand=929022654,i.coauthoringCommandMenuClose=3236517055,i.coauthoringCommandMenuOpen=250882013,i.coauthoringPopulateFlyout=1285265560,i.coauthoringQueryStatus=3798167515,i.coauthoringRefreshControl=2052777571,i.coauthoringUserButtonClick=4033456482,i.peopleSuggestion1=2133437452,i.peopleSuggestion2=2133437453,i.peopleSuggestion3=2133437454,i.performUserAuth=1397611854,i.pinOrUnpinFont=1500655301,i.populateAddInGallery=1230970894,i.populateCitationAddInGallery=3418030507,i.populateDialogMenu=3675896289,i.populateFileMenuFlyout=492631662,i.populateInsertLinkFlyout=276140882,i.populateMruFlyout=3836269153,i.populateMruMenu=2799130311,i.populateNewMenu=2074131365,i.populateNewMenuFlyout=3303609078,i.populateRecentLinksFlyout=860679239,i.populateSensitivityFlyout=1145315516,i.premiumTemplateExperience=65739653,i.previewPanelTabBackward=3934434802,i.previewPanelTabForward=1596970964,i.privacyLink=1208554566,i.publishToWeb=1646994466,i.queryAddInCommandsLoadStatus=1309495434,i.queryAddinDetails=3893417908,i.queryAddInFlyout=2749373765,i.queryAppBuildVersion=696500923,i.queryBreadcrumbDocName=3847984948,i.queryBuildVersion=3874562422,i.queryCitationFlyout=969756804,i.queryClearSearch=3720034241,i.queryCopilotChatTaskpaneVisible=4240910315,i.queryCopyAndEditButton=825574620,i.queryDocChatButtonStatus=1478537812,i.queryDocLocationInfo=2480422205,i.queryDownloadACopy=3943987592,i.queryEntitledAppsForOffice=860152194,i.queryEnvironmentName=3887408216,i.queryFilePathInfo=1399875355,i.queryFindMatchCase=1369572530,i.queryFindWholeWord=3914542e3,i.queryNewDocument=3165667641,i.queryPackageInitialized=49122376,i.queryPolicyLabel=497870830,i.queryPolicyShortLabel=888027492,i.querySaveToSharePoint=1732570541,i.querySensitivity=3134802707,i.querySensitivitySubFlyout=2875864574,i.querySensitivityToggleButton=991261903,i.querySessionId=2793115165,i.querySimplifiedRibbonIsEnabled=1536028887,i.queryStaticUiTouchMode=1557026322,i.queryToggleAccCheckerButton=1949220702,i.queryToggleCatchUpFlyout=1059068017,i.queryToggleCommentPane=847427893,i.queryToggleSerplet=3677246697,i.queryUserSessionId=4080155406,i.queryUploadDocumentFromPc=1779942695,i.queryZoomText=433063458,i.queryZoomPercentage=2901130581,i.quickActionOnFile=548581900,i.raiseActionToHost=2576944597,i.rebootUrlOnUiHost=269161319,i.recentLinks=2535492938,i.redoCommentAction=2999339013,i.refreshAddinCommands=543799107,i.refreshChatControl=2854028228,i.regionMoveBackward=2924716042,i.regionMoveForward=1656936120,i.registerAddinDetailsObserver=3186588517,i.registerAppActivatedEvent=741381681,i.reloadAddInPicker=2502873265,i.reloadCitationAddInPicker=3207566856,i.removeAppForOffice=4019674508,i.renameFile=1897077126,i.renameMostRecentlyUsedFileEntry=3502386740,i.replyWithChanges=1197060601,i.reportAbuseLink=3237171630,i.reportFileMenuPageAbout=4248596885,i.reportFileMenuPageHome=1074909883,i.reportFileMenuPageInfo=127178350,i.reportFileMenuPageNew=1852071536,i.reportFileMenuPageOpen=2392426770,i.reportFileMenuPagePrint=2971760737,i.reportFileMenuPageSaveAs=4100738419,i.reportFileMenuPageShare=720070809,i.reportFileMenuPageSwitch=4133531354,i.reportFileMenuPageTransform=3048126886,i.reportFileMenuPageDelete=1649065493,i.reportFileMenuPageAddins=3188037073,i.reportFileMenuPageUnknown=3865908344,i.reportFreemiumUpsellBadgeClicked=1509043591,i.reportFreemiumUpsellBadgeDisplayed=975509583,i.reportFreemiumUpsellDialogClicked=3865601672,i.reportFreemiumUpsellDialogDismissed=2275483468,i.reportFreemiumUpsellDialogDisplayed=4142738798,i.reportFreemiumUpsellEligibleClicked=4177432571,i.reportFreemiumUpsellEligibleDisplayed=2539564555,i.reportLegacyRibbonLoaded=1355500294,i.reportMRUFromHomePage=1128336726,i.reportMRUFromOpenPage=105169305,i.reportOneLineRibbonLoaded=4188650553,i.reportRibbonModeMLR=2050007412,i.reportRibbonModeSLR=2050007578,i.reportSwitchFromLegacyRibbon=2363934117,i.reportSwitchFromSimplifedRibbon=422501225,i.reportTabAddins=903886994,i.reportTabChart=1120156565,i.reportTabCopilot=877400639,i.reportTabData=1449630229,i.reportTabDeveloper=3221800135,i.reportTabDrawing=3099434941,i.reportTabFormulas=3696531680,i.reportTabHelp=2625726220,i.reportTabHome=4191810468,i.reportTabInsert=469886678,i.reportTabPageLayout=491924414,i.reportTabReview=3328108543,i.reportTabShare=454423290,i.reportTabSwitch=2527431031,i.reportTabSwitchManual=1042496661,i.reportTabUnknown=3841439565,i.reportTabView=2652577546,i.reportTemplateFromHomePage=1240571126,i.reportTemplateFromNewPage=3302080867,i.reportVersionHistorySaveACopySuccess=1380507044,i.reportVersionHistorySaveACopyFailure=951489623,i.requestFontInfo=3169500754,i.requestMoreAccess=1557191504,i.resetShortcutPreferences=1481673185,i.responsiveUxAutomaticOff=3286563559,i.restartExtensionTaskPane=1323818969,i.resumeFocusWithDirection=637959088,i.retrieveAddInCommandsEntitlementsList=1782110672,i.retryOpenInClient=1596290176,i.ribbonEsc=4169072475,i.ribbonFocus=1047758638,i.ribbonModeToggledToMLR=536345575,i.ribbonModeToggledToSLR=4031133701,i.ribbonMoveBackward=1254348094,i.ribbonMoveForward=2187030096,i.ribbonStateChanged=1308255763,i.ribbonTabSwitched=3190032724,i.saveACopy=4246497969,i.saveAnonymousCreation=2773392339,i.saveAsToHost=2316717900,i.saveFileChange=3070187925,i.saveToCloudStorage=617689800,i.saveToSharePoint=3050207199,i.screenBucket_W_Large_H_Large=1371513149,i.screenBucket_W_Large_H_Medium=4069406845,i.screenBucket_W_Large_H_Small=268548051,i.screenBucket_W_Medium_H_Large=3633471113,i.screenBucket_W_Medium_H_Medium=3974459409,i.screenBucket_W_Medium_H_Small=3955978899,i.screenBucket_W_Small_H_Large=4063922707,i.screenBucket_W_Small_H_Medium=1743731911,i.screenBucket_W_Small_H_Small=3084758525,i.searchHelp=2918242107,i.selectNextComment=1873541548,i.selectPrevComment=4242021840,i.setInDocSearchParameter=3244486608,i.setSensitivity=2935633379,i.setTitleExtensionTaskPane=501097794,i.shareCopyLink=2596151084,i.shareDocument=1365012288,i.shareManageAccess=736246900,i.sharedCommentsCancelCommentCreateThread=1384511460,i.sharedCommentsCommitComment=3401575755,i.sharedCommentsCommitDraft=1426025625,i.sharedCommentsCreateReply=2297956587,i.sharedCommentsCreateReplyWithMentions=3866509012,i.sharedCommentsCreateReplyWithTaskAssigned=2104859114,i.sharedCommentsCreateThread=2716070047,i.sharedCommentsCreateThreadWithMentions=355666834,i.sharedCommentsCreateThreadWithTaskAssigned=2470061772,i.sharedCommentsDeletePost=3191809076,i.sharedCommentsDeleteThread=1912911518,i.sharedCommentsDeleteThreadWithTask=1414137793,i.sharedCommentsDiscardDraft=1127700748,i.sharedCommentsPresentLinkToCommentAction=1978095600,i.sharedCommentsReopenThread=243899744,i.sharedCommentsReopenThreadWithTask=1615492167,i.sharedCommentsRequestInitCommentSession=738982675,i.sharedCommentsResolveThread=537095687,i.sharedCommentsResolveThreadWithTask=88639566,i.sharedCommentsSelectComment=334636250,i.sharedCommentsUpdateCommentBodyAction=2079612261,i.showAccessibilityCheckerPane=2529583086,i.showAccessibilityHelpDialog=3276527670,i.showAccessibilitySettingsDialog=2236763780,i.showAddInCommandsLoadStatusCallout=516359383,i.showAddInErrorDialog=2269104277,i.showCommentPane=3510751882,i.showContextMenu=4284341431,i.showContextMenuWithFloatie=2269433685,i.showDialogMenu=4193807224,i.showExtensionTaskpane=2451283737,i.showFileVersion=3681556347,i.showFloatie=459047735,i.showFloatPane=2391539661,i.showGrantUserAccessDialog=1203507006,i.populateAddInMRUContextMenu=2226126638,i.shareAddIn=1381116675,i.showInsightsForSuggestion=2603175857,i.showMultilineRibbonFromToolbar=1088082265,i.showRenameDialog=2382951455,i.showRenameFlyout=2679862750,i.showRenameDisabledDialog=2638199087,i.showRibbonSettingsDialog=4211880506,i.showSmartLookupForSuggestion=83993843,i.showSmartLookupFromCommand=545765261,i.showTellMeCoachmark=1055590629,i.showThirdPartyNotices=2220417879,i.showTrustCenter=2583751502,i.showUILessDialog=2517401660,i.showVersionHistoryDialog=466976539,i.showZoomDialog=1738002952,i.signIn=4196619892,i.signInNavigate=1534118067,i.simulateO365ShellServiceReceived=3231625709,i.smartLookupForTellMe=606289265,i.startPinchToZoom=1621589088,i.statusBarMoveBackward=526150751,i.statusBarMoveForward=937490595,i.switcherTileClick=1550573691,i.switchModeToDocumentEdit=2118858169,i.tabSwitch=380914761,i.tellMe=2652476189,i.tellMeAccessibilityMenuText=4054875485,i.tellMeCacheAsyncMenuRefresh=2751631965,i.tellMeFeedback=2230755196,i.tellMeFocusInput=815990803,i.tellMeInteractionBegin=586156566,i.tellMeLogCommandExecuted=878547493,i.tellMeLogInputBlur=1024534176,i.tellMeLogInputFocus=2303219627,i.tellMeLogMenuClose=4266170064,i.tellMeLogMenuOpen=2480888384,i.tellMeLogOfficeAppStatusQuery=1708531416,i.tellMeRestoreFocus=3243793933,i.tellMeTryQuery=1404166600,i.templateForSearch=57037313,i.toggleAnimations=2145510275,i.toggleCatchUpFlyout=3418267371,i.toggleChatPane=2288458806,i.toggleCommentPane=2281051331,i.toggleRibbonState=2758000563,i.toggleRibbonUX=2684863833,i.toggleRibbonUXDialog=1342108365,i.toggleSensitivity=941487903,i.touchStart=2478534165,i.training=1468994080,i.triggerFloodgateSurvey=3485513367,i.tryMacOffice=3901198658,i.tryMacOfficeFromPowerPointViewer=1391456747,i.tryMacOfficeFromWordViewer=201621520,i.tryOffice=1773624819,i.tryOfficeFromPowerPointViewer=4268365028,i.tryOfficeFromWordViewer=2578423837,i.tryOfficeThroughTellMe=215809929,i.undoCommentAction=3466807785,i.updateCommandUI=2112877354,i.updateExtensionComponent=2646433959,i.updateFavorites=736837252,i.updateSaveStatusForHeader=1852918846,i.updateVersionsPane=3649559640,i.uploadDocumentFromPc=176872269,i.userSurveyCancel=2424604265,i.userSurveySubmit=3800318691,i.supportsExchangeRestApisTest=3329796304,i.versionHistory=3182458430,i.viewAllFiles=2585716125,i.whatsNew=1255721029,i.wolframForSearch=3574662461,i.workflow=2988588587,i.zoomDialogFocusBackward=2910828042,i.zoomDialogFocusForward=2095185708,i.zoomToPercentage=3745693956,i.zoomToPercentageCompleted=3139946409,i.imageForSearch=1713113610,i.learningForSearch=1006342541,i.smartLookupFromTellMeQueryTermAtTop=667209510,i.searchAddinInFlyout=1617957002,i.oneNoteAppUpsellDismissed=2710666765,i.oneNoteAppUpsellButtonClicked=2835215311,(0,a.a)(i,"CommonCommands",null,[])},8103:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(2274);function i(e){let t=!1;const n=[e,`l_${e}`,`L_${e}`],i=[];(a.AFrameworkApplication_AppSettingsManager?.appSettingsManager?.getBooleanAppSetting("IsNewStringEnabled")||a.AFrameworkApplication_AppSettingsManager?.appSettingsManager?.getBooleanAppSetting("IsNewCommonStringLoadEnabled"))&&(t=!0,i.push(CommonUiStrings)),0===i.length&&"undefined"!=typeof CommonUiStrings&&i.push(CommonUiStrings),"undefined"!=typeof CommonUIStrings&&i.push(CommonUIStrings);for(const e of i)for(const t of n)if(e?.hasOwnProperty(t))return e[t];if(t)throw new Error(`Common string with key ${e} not found`)}},8498:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{sanitize(e){return void 0===e?null:e}toString(){const e={Name:this.name,Message:this.message,File:this.file,Line:this.line,Column:this.column,Stack:this.stack};return window.JSON?JSON.stringify(e):Sys.Serialization.JavaScriptSerializer.serialize(e)}constructor(e){this.name=null,this.stack=null,this.message=null,this.file=null,this.line=null,this.column=null,e&&(this.name=this.sanitize(e.name),this.stack=this.sanitize(e.stack),this.message=this.sanitize(e.message),this.file=this.sanitize(e.fileName),this.line=this.sanitize(e.lineNumber),this.column=this.sanitize(e.columnNumber))}}(0,a.a)(i,"LoggingExceptionArgs",null,[])},3529:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{handleTrace(e){}showAssertDialog(e){}handoffToNewHost(e){}flushAsynchronous(){}add_onUlsTrace(e){}remove_onUlsTrace(e){}dispose(){}}(0,a.a)(i,"UlsHostStub",null,[190,11])},5557:function(e,t,n){"use strict";n.d(t,{a:function(){return r},b:function(){return o}});var a=n(5149);const i=(e,t,n)=>{try{o(e,200,10,"Exception was thrown while {0}: {1}",t,n.toString())}catch(e){}},o=(e,t,n,o,...r)=>{try{a.ULS.sendTraceTag.apply(null,[e,s(t),l(n),o].concat(r))}catch(t){i(e,"logging",t)}},r=(e,t,n,o,...r)=>{try{a.ULS.shipAssertTag.apply(null,[e,s(t),n,o].concat(r))}catch(t){i(e,"asserting",t)}},s=e=>e,l=e=>e},5149:function(e,t,n){"use strict";n.r(t),n.d(t,{ULS:function(){return d}});var a=n(100),i=n(3529);class o{constructor(e,t,n,a,i,o,r=!1,s=null,l=null){this.timestamp=e,this.category=t,this.tag=n,this.level=a,this.message=i||"",this.logType=o,this.isMinified=r,this.args=s,this.exceptionArgs=l}}(0,a.a)(o,"LoggingArgs",null,[]);var r=n(8498),s=n(2691);class l{get ulsCallDepth(){return this._ulsCallDepth}get elapsedLoggingDuration(){return this._loggingDuration}get host(){return this._host}set host(e){e!==this._host&&(this._inHostTransition||(this._inHostTransition=!0,e?(this._host.handoffToNewHost(e),this._host.dispose(),this._host=e):(this._host.dispose(),this._host=new i.a),this._inHostTransition=!1))}logImpl(e,t,n,a,i,c,d,u){if(0===a&&(!this.shouldTrace(t,n)||!this.shouldTraceTag(e))||this._ulsCallDepth>1)return;const p=l.getTimestamp();i||this._ulsCallDepth++;try{const i=new Date;l.preprocessArgs(d);let p=!1,g=null,h="";if(void 0===c?p=!0:h=l.buildMessageString(c,d),p&&d&&d.length>0){g=[];for(let e=0,t=d.length;e<t;++e)g.push(null===d[e]||void 0===d[e]?"":d[e].toString())}let m=null;if(u)if(this.isExceptionLoggingEnabled)m=new r.a(u);else{let e="";try{m=new r.a(u),e=m.toString()}catch(t){e="[Failed to parse exception]"}finally{c+=e,m=null}}20!==n||this.isImportantLoggingEnabled||(n=50);const _=new o(i.getTime(),t,e,n,h,a,p,g,m);if(this._host.handleTrace(_),n<=10&&window.g_logErrorsToConsole&&console&&console.error){const t=String.format("ULS tag_{0}: {1}",s.a(e),h);console.error(t)}0}finally{i||this._ulsCallDepth--}l.supportsPerformanceNow&&(this._loggingDuration+=l.getTimestamp()-p)}assertImpl(e,t,n,a,i){if(!n&&this._ulsCallDepth<=1){this._ulsCallDepth++;try{this.logImpl(e,t,10,1,!0,a,i,null)}finally{this._ulsCallDepth--}}}shouldTrace(e,t){return t<=this.currentLevel}setTraceLevel(e){this.currentLevel=e}shouldTraceTag(e){return!this._blockedTags[e]}clearSuppressedTags(){this._blockedTags=new Array(0)}addSuppressedTag(e){this._blockedTags[e]=!0}static preprocessArgs(e){const{ULS:t}=n(5149);if(e)for(let n=0,a=e.length;n<a;++n){const a=e[n];if(a&&"object"==typeof a){const i=Object.getType(a).prototype.toString;if(i===l.objectToStringPrototype||!i)if(1===a.nodeType)e[n]=t.concatArray([a.tagName,"#",a.id,".",a.className]);else try{e[n]=t.jsonSerialize(a)}catch(t){0,e[n]=t}}}}static buildMessageString(e,t){return t&&t.length?e?String.format.apply(null,[e].concat(t)):t.join(", "):e||""}static getTimestamp(){try{if(l.supportsPerformanceNow)return window.performance.now()}catch(e){l.supportsPerformanceNow=!1}return-1}constructor(){this.currentLevel=0,this._ulsCallDepth=0,this._loggingDuration=-1,this._blockedTags=new Array(0),this._host=new i.a,this._inHostTransition=!1,this.isExceptionLoggingEnabled=!1,this.isImportantLoggingEnabled=!1,this.currentLevel=50}}l.objectToStringPrototype=Object.prototype.toString,l.supportsPerformanceNow=!!window.performance&&!!window.performance.now,(0,a.a)(l,"UlsImpl",null,[459]);class c{get host(){return this._host}set host(e){}logImpl(e,t,n,a,i,o,r,s){}assertImpl(e,t,n,a,i){}shouldTrace(e,t){return!1}shouldTraceTag(e){return!1}setTraceLevel(e){}get ulsCallDepth(){return 0}get elapsedLoggingDuration(){return-1}clearSuppressedTags(){}addSuppressedTag(e){}constructor(){this._host=new i.a,this.isExceptionLoggingEnabled=!1,this.isImportantLoggingEnabled=!1}}(0,a.a)(c,"UlsImplStub",null,[459]);class d{static setUlsHost(e){d._isDisabled&&(d._impl=new l),d._impl.host=e,d._isDisabled=!1}static get host(){return d._impl.host}static disable(){d._impl=new c,d._isDisabled=!0}static sendTraceTag(e,t,n,a,...i){d._impl.logImpl(e,t,n,0,!1,a,i,null)}static sendExceptionTraceTag(e,t,n,a,i,...o){d._impl.logImpl(e,t,n,0,!1,i,o,a)}static shipAssertTag(e,t,n,a=null,...i){d._impl.assertImpl(e,t,n,a,i)}static assertAndLogTag(e,t,n=null,...a){d._impl.assertImpl(e,103,t,n,a)}static assertAndThrowTag(e,t,n=null,...a){if(d._impl.assertImpl(e,103,t,n,a),!t)throw Error.create(l.buildMessageString(n,a)+". tag_"+s.a(e))}static logAndThrowTag(e,t,n=null,...a){throw d._impl.logImpl(e,t,10,0,!0,n,a,null),Error.create(l.buildMessageString(n,a)+". tag_"+s.a(e))}static shouldTrace(e,t){return d._impl.shouldTrace(e,t)}static shouldTraceTag(e){return d._impl.shouldTraceTag(e)}static clearSuppressedTags(){d._impl.clearSuppressedTags()}static addSuppressedTag(e){d._impl.addSuppressedTag(e)}static setExceptionLogging(e){d._impl.isExceptionLoggingEnabled=e}static setImportantLogging(e){d._impl.isImportantLoggingEnabled=e}static setTraceLevel(e){d._impl.setTraceLevel(e)}static get ulsCallDepth(){return d._impl.ulsCallDepth}static concatArray(e){let t;return(t=[]).concat.apply(t,e).join("")}static jsonSerialize(e){return window.JSON?JSON.stringify(e):Sys.Serialization.JavaScriptSerializer.serialize(e)}static getElapsedLoggingDuration(){return d._impl.elapsedLoggingDuration}static get impl(){return d._impl}static get isDisabled(){return d._isDisabled}}d._impl=new l,d._isDisabled=!1,(0,a.a)(d,"ULS",null,[])},8174:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var a=n(100),i=n(5149);class o{constructor(e,t,n,a,i,o){e&&(this.N=e),t&&(this.S=t),n&&(this.M=n),a&&(this.F=a),null!=i&&(this.L=i),null!=o&&(this.C=o)}}(0,a.a)(o,"SerializableExceptionEntry",null,[]);class r{constructor(e,t,n,a,i){this.T=e,this.L=t,this.S=n,this.I=a,this.V=i}}(0,a.a)(r,"SerializableLogCache",null,[]);class s{charsInException(){if(!this.E)return 0;let e=7,t=0;return this.E.N&&(e+=6+s.charsInObj(this.E.N),t++),this.E.S&&(e+=6+s.charsInObj(this.E.S),t++),this.E.M&&(e+=6+s.charsInObj(this.E.M),t++),this.E.F&&(e+=6+s.charsInObj(this.E.F),t++),this.E.L&&(e+=6+s.charsInObj(this.E.L),t++),this.E.C&&(e+=6+s.charsInObj(this.E.C),t++),t>1&&(e+=t-1),e}computeSerializedLength(){let e=n(8174).a.logEnvelopeSize+s.charsInObj(this.G)+s.charsInObj(this.T)+this.M.length+s.charsInObj(this.C)+s.charsInObj(this.D)+this.charsInException();if(1===this.O&&(e+=6),this.A){e+=7;for(let t=0,n=this.A.length;t<n;++t)e+=this.A[t].length+3}return e}static charsInObj(e){return(""+e).length}constructor(e,t,n,a,i,o,r=!1,s=null,l=null){this.G=0,this.T=0,this.M=null,this.C=null,this.D=0,this.G=o,this.T=a,this.M=e,this.C=t,this.D=1e3*i+n,r&&(this.O=1),s&&(this.A=s),l&&(this.E=l)}}(0,a.a)(s,"SerializableLogEntry",null,[]);var l=n(2691);const c=262144;class d{reset(){this._logs=[],this._dataSizeBytes=25,this._timestampBase=(new Date).getTime()}get count(){return this._logs.length}get uploadMaximumSizeBytes(){return this._uploadMaximumSizeBytes}set uploadMaximumSizeBytes(e){this._uploadMaximumSizeBytes=e}get dataSizeBytes(){return this._dataSizeBytes}addLog(e){if(!e)return;e.message=this.trimStringIfNeeded(e.message,"message",e.tag);const t=e.exceptionArgs;if(t&&(t.name=this.trimStringIfNeeded(t.name,"Exception.Name",e.tag),t.stack=this.trimStringIfNeeded(t.stack,"Exception.Stack",e.tag),t.message=this.trimStringIfNeeded(t.message,"Exception.Message",e.tag),t.file=this.trimStringIfNeeded(t.file,"Exception.File",e.tag)),e.args)for(let t=0;t<e.args.length;t++)e.args[t].length>this._logMessageMaxChars&&(e.args[t]=e.args[t].substr(0,this._logMessageMaxChars-13)+"... [trimmed]",i.ULS.sendTraceTag(3465240,100,50,"Trimmed arg {0} for log {1}",t,l.a(e.tag)));const n=t?new o(t.name,t.stack,t.message,t.file,t.line,t.column):null,a=new s(e.message,e.category,e.level,e.timestamp-this._timestampBase,e.logType,e.tag,e.isMinified,e.args,n),r=a.computeSerializedLength();if(this._uploadMaximumSizeBytes>0&&r+this._dataSizeBytes>this._uploadMaximumSizeBytes){const e=this.count;this.reset(),i.ULS.sendTraceTag(0,100,15,"The log size is too large to be accepted by the server, throwing away {0} logs.",e)}Array.add(this._logs,a),this._dataSizeBytes+=r}trimStringIfNeeded(e,t,n){let a=e;return e&&e.length>this._logMessageMaxChars&&(a=e.substr(0,this._logMessageMaxChars-13)+"... [trimmed]",i.ULS.sendTraceTag(3465240,100,50,"Trimmed {0} for log {1}",t,l.a(n))),a}get isDataSizeThresholdExceeded(){return this._dataSizeBytes>this._maxDataSizeBytes}serialize(){return i.ULS.jsonSerialize(new r(this._timestampBase,this._logs,this._userSessionId,this.uploadId,1))}get sizeThresholdBytes(){return this._sizeThresholdBytes}get logMessageMaxChars(){return this._logMessageMaxChars}get logs(){return this._logs}get timestampBase(){return this._timestampBase}static testJsonSerialize(e){return i.ULS.jsonSerialize(e)}constructor(e,t,n){this._timestampBase=0,this._logs=null,this._dataSizeBytes=0,this._uploadMaximumSizeBytes=0,this.uploadId=0,this._sizeThresholdBytes=e,this._logMessageMaxChars=t,this._userSessionId=n,this._sizeThresholdBytes=e<c?e:c,this._maxDataSizeBytes=this._sizeThresholdBytes-4*(this._logMessageMaxChars+25),this.reset()}}d.logEnvelopeSize=31,(0,a.a)(d,"LogCache",null,[460,461])},2691:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});const a="abcdefghijklmnopqrstuvwxyz0123456789",i=e=>{if(e<=65535)return e.toString();if(e>>>24>=36)return String.fromCharCode.call(null,e>>>24&255,e>>>16&255,e>>>8&255,255&e);const t=a;return""+t.charAt(e>>>24&63)+t.charAt(e>>>18&63)+t.charAt(e>>>12&63)+t.charAt(e>>>6&63)+t.charAt(63&e)}},5499:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var a,i=n(100);!function(e){e[e.none=0]="none",e[e.getCells=1]="getCells",e[e.getChanges=2]="getChanges",e[e.putChanges=3]="putChanges",e[e.spelling=4]="spelling",e[e.spellingFailure=5]="spellingFailure",e[e.cellData=6]="cellData",e[e.nullRequest=8]="nullRequest",e[e.editorsTable=9]="editorsTable",e[e.secondaryMetadata=10]="secondaryMetadata",e[e.amIAlone=11]="amIAlone",e[e.coauthStatus=14]="coauthStatus",e[e.beginCommenting=15]="beginCommenting",e[e.deleteComment=16]="deleteComment",e[e.addComment=17]="addComment",e[e.addCommentReply=18]="addCommentReply",e[e.changeCommentDoneStatus=19]="changeCommentDoneStatus",e[e.endCommenting=20]="endCommenting",e[e.search=21]="search",e[e.hotStoreStatus=22]="hotStoreStatus",e[e.updateLock=23]="updateLock",e[e.refreshCommentingLock=24]="refreshCommentingLock",e[e.saveToDocxPut_Deprecated=25]="saveToDocxPut_Deprecated",e[e.saveToDocxSet_Deprecated=26]="saveToDocxSet_Deprecated",e[e.saveToDocxResponse=27]="saveToDocxResponse",e[e.createSaveReplay=28]="createSaveReplay",e[e.playSaveReplay=29]="playSaveReplay",e[e.unlockSection=30]="unlockSection",e[e.picturePaste=31]="picturePaste",e[e.forceSaveToDocx=32]="forceSaveToDocx",e[e.createGraphMergeReplay=33]="createGraphMergeReplay",e[e.playGraphMergeReplay=34]="playGraphMergeReplay",e[e.whoAmI=35]="whoAmI",e[e.pagination=36]="pagination",e[e.getLastSavedRevision=37]="getLastSavedRevision",e[e.sendUsYourFile=38]="sendUsYourFile",e[e.ooXmlGet=39]="ooXmlGet",e[e.getFileAgaveApi=40]="getFileAgaveApi",e[e.spellingUserEvent=41]="spellingUserEvent",e[e.spellingContextualProofingResult=42]="spellingContextualProofingResult",e[e.spellingMetrics=43]="spellingMetrics",e[e.ooXmlSet=44]="ooXmlSet",e[e.imageCrop=45]="imageCrop",e[e.renderPage=46]="renderPage",e[e.mathConversion=47]="mathConversion",e[e.notebookSearch=48]="notebookSearch",e[e.notebookSearchResult=49]="notebookSearchResult",e[e.externalContentEmbed=50]="externalContentEmbed",e[e.externalContentFetchThumbnail=51]="externalContentFetchThumbnail",e[e.getEditPresResources=52]="getEditPresResources",e[e.getSlides=53]="getSlides",e[e.findText=54]="findText",e[e.diffRenderPage=55]="diffRenderPage",e[e.accCheck=56]="accCheck",e[e.pictureCropInfo=57]="pictureCropInfo",e[e.pageEventNotification=58]="pageEventNotification",e[e.updateContentAddinSnapshotInfo=59]="updateContentAddinSnapshotInfo",e[e.educationUser=60]="educationUser",e[e.checkUnblockUI=61]="checkUnblockUI",e[e.proofingConfig=62]="proofingConfig",e[e.proofingCheck=63]="proofingCheck",e[e.getFileSlice=64]="getFileSlice",e[e.copy=65]="copy",e[e.generateDesignerSuggestion=66]="generateDesignerSuggestion",e[e.reportDesignerSuggestionSessionInfo=67]="reportDesignerSuggestionSessionInfo",e[e.mathRecognize=68]="mathRecognize",e[e.mathRecoAlternates=69]="mathRecoAlternates",e[e.mathSolverActions=70]="mathSolverActions",e[e.mathSolverExecute=71]="mathSolverExecute",e[e.mathSolverGetTemplates=72]="mathSolverGetTemplates",e[e.mathSolverGetSteps=73]="mathSolverGetSteps",e[e.mathSolverGraph=74]="mathSolverGraph",e[e.getNotebooks=75]="getNotebooks",e[e.notebookData=76]="notebookData",e[e.closeFileAgave=77]="closeFileAgave",e[e.notifyImageUploadFailure=78]="notifyImageUploadFailure",e[e.reportDesignerSuggestionSessionInformation=79]="reportDesignerSuggestionSessionInformation",e[e.getChangeIdsForCatchUp=80]="getChangeIdsForCatchUp",e[e.flush=81]="flush",e[e.setUserInfo=82]="setUserInfo",e[e.generateObjectReplacementSuggestion=83]="generateObjectReplacementSuggestion",e[e.reportObjectReplacementSessionInfo=84]="reportObjectReplacementSessionInfo",e[e.swayPreview=85]="swayPreview",e[e.swayPublish=86]="swayPublish",e[e.uploadRsidsOnDocOpen=87]="uploadRsidsOnDocOpen",e[e.findComment=88]="findComment",e[e.getImages=89]="getImages",e[e.notebookType=90]="notebookType",e[e.generateImageDescription=91]="generateImageDescription",e[e.userSessionDataUpdate=92]="userSessionDataUpdate",e[e.getFileRevisionHistory=93]="getFileRevisionHistory",e[e.checkSwayLicense=94]="checkSwayLicense",e[e.richApiRequest=95]="richApiRequest",e[e.getWywaActivities=96]="getWywaActivities",e[e.getActivities=97]="getActivities",e[e.notifyDocUpdate=98]="notifyDocUpdate",e[e.generateIconSuggestion=99]="generateIconSuggestion",e[e.graphMergeConsentChange=100]="graphMergeConsentChange",e[e.getChangeIdObjectIdMapping=101]="getChangeIdObjectIdMapping",e[e.seedFullFileAugLoop=102]="seedFullFileAugLoop",e[e.getAppliedPolicyId=103]="getAppliedPolicyId",e[e.updateChangeIdCommitMapping=104]="updateChangeIdCommitMapping",e[e.sessionInfoRefresh=105]="sessionInfoRefresh",e[e.restoreVersion=106]="restoreVersion",e[e.getRelevantActivities_Deprecated=107]="getRelevantActivities_Deprecated",e[e.augmentImage=108]="augmentImage",e[e.updateWaterline=109]="updateWaterline",e[e.rttStatusReplicator_Deprecated=110]="rttStatusReplicator_Deprecated",e[e.templates=112]="templates",e[e.applyTemplate=113]="applyTemplate",e[e.latentStyles=114]="latentStyles",e[e.ooXmlRetrieveStyles=115]="ooXmlRetrieveStyles",e[e.deleteFile=116]="deleteFile",e[e.getDocumentComponentMetrics=117]="getDocumentComponentMetrics"}(a||(a={})),(0,i.b)("OperationClassId",a)},15:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(3245);class o{static get isConsumptionEnabled(){return i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordConsumptionViewToEditRedirectIsEnabled")||this.IsWordWebInteractiveReadOnlyModeEnabled}static get IsWordWebInteractiveReadOnlyModeEnabled(){return"1"===i.AFrameworkApplication.featureStatusSettings.WordWebInteractiveReadOnlyMode}static get isInvalidateAllVEsEnabled(){return i.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_9515662_InvalidateAllViewElementsOnModeSwitch")}}(0,a.a)(o,"InteractiveReadOnlySettings",null,[])},8258:function(e,t,n){"use strict";n.d(t,{a:function(){return c},b:function(){return d},c:function(){return s},d:function(){return p},e:function(){return u},f:function(){return l}});var a=n(9858),i=n(8510),o=n(3245),r=n(5149);const s="modeSwitch",l="translate",c=e=>!!e&&(e.getBooleanAppSetting("IsUIEmbedMode")&&e.getBooleanAppSetting("ModeSwitchWithinUIEmbedModeIsEnabled")&&e.getBooleanAppSetting("HostSupportsDocRebootFeaturesInOtherMode")),d=e=>!!e&&(e.getBooleanAppSetting("ModeSwitchWithinUIEmbedModeIsEnabled")&&e.getBooleanAppSetting("UiHostSupportsDocRebootFeatures")),u=(e,t,n)=>{if(a.a.checkStringIsNullOrEmpty(e))return void r.ULS.sendTraceTag(593069254,324,10,"UploadToHostManager mode value is coming empty. failed to switch mode. Mode = {0}",e);r.ULS.sendTraceTag(592255191,324,50,"UploadToHostManager switching to {0}",e);const s={rebootMode:"0"};if(s.mode=e,s.reason=n,t&&t.count>0){const e=a.a.serializeStringDictionaryToJson(t);s.queryOverrides=e,r.ULS.sendTraceTag(593069253,324,50,"UploadToHostManager query override {0}",e)}const l=i.a.createRetriableMessage("App_DocReboot",s,o.AFrameworkApplication.userSessionId,3);o.AFrameworkApplication.get_hostPostmessengerFuture().execute((e=>{e.postMessage(l)}))},p=e=>{if(a.a.checkStringIsNullOrEmpty(e))return void r.ULS.sendTraceTag(591697177,324,10,"EditUrl is coming null. not able to send post message for docreboot.");r.ULS.sendTraceTag(591697178,216,50,"Redirecting to edit url.");const t={rebootMode:"1"};t.documentUrl=e;const n=i.a.createRetriableMessage("App_DocReboot",t,o.AFrameworkApplication.userSessionId,3);o.AFrameworkApplication.get_hostPostmessengerFuture().execute((e=>{e.postMessage(n)}))}},2863:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(965);class o{static fixupArrayResponses(e){if(!e)return;const t=e.length;for(let n=0;n<t;n++){const t=e[n];e[n]=t[1],e[n].classId=t[0]}}static fromServerResponseObject(e){try{const t=e;if(o.fixupArrayResponses(t.Responses),t.Responses&&t.Responses.length>0)return t}catch(e){}return null}static tryDeserializeServerResponse(e){let t;try{const n=i.a(e);t=o.fromServerResponseObject(n)}catch(e){t=null}return{returnValue:!!t,group:t}}constructor(){this.Responses=null}}(0,a.a)(o,"ServerResponseGroup",null,[])},4277:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get_current(){if(-1===this._index||this._index>=this._array.length)throw Error.invalidOperation();return this._array[this._index]}moveNext(){return this._index++,this._index<this._array.length}reset(){this._index=-1}next(){return this._index++,this._index<this._array.length?{done:!1,value:this._array[this._index]}:{done:!0,value:void 0}}constructor(e){this._index=-1,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._array=e}}(0,a.a)(i,"ArrayEnumerator$1",null,[208])},8599:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(625),o=n(2125),r=n(205);class s{getEnumerator(){return r.b((0,i.a)(this._map,this._map.values,"values")).$$ge()}[Symbol.iterator](){return this._map.values()}get count(){return this._map.size}get keys(){return r.c(r.b((0,i.a)(this._map,this._map.values,"values")),(e=>e.key))}get values(){return r.c(r.b((0,i.a)(this._map,this._map.values,"values")),(e=>e.value))}Akvp(e){this.insert(e,!0)}get_item(e){const{value:t,returnValue:n}=this.tryGetValue(e,null);if(!n)throw Error.create("KeyNotFoundException");return t}set_item(e,t){return this.insert(new o.a(e,t),!1),t}insert(e,t){const n=this._keyGen.getEqualityKey(e.key);if(t&&this._map.has(n))throw Error.invalidOperation("DuplicateKeyException");this._map.set(n,e)}add(e,t){this.insert(new o.a(e,t),!0)}containsKey(e){return this._map.has(this._keyGen.getEqualityKey(e))}remove(e){return this._map.delete(this._keyGen.getEqualityKey(e))}tryGetValue(e,t=null){const n=this._keyGen.getEqualityKey(e);if(this._map.has(n)){return{returnValue:!0,value:this._map.get(n).value}}return{returnValue:!1,value:t}}constructor(e){this._map=new Map,this.$$ge=this.getEnumerator,this._keyGen=e}}(0,a.a)(s,"ComparableMap",null,[32,13])},7481:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(625),o=n(205);class r{getEnumerator(){return o.b((0,i.a)(this._map,this._map.values,"values")).$$ge()}[Symbol.iterator](){return this._map.values()}get count(){return this._map.size}add(e){const t=this._keyGen.getEqualityKey(e);return!this._map.has(t)&&(this._map.set(t,e),!0)}clear(){this._map.clear()}contains(e){return this._map.has(this._keyGen.getEqualityKey(e))}remove(e){return this._map.delete(this._keyGen.getEqualityKey(e))}constructor(e){this._map=new Map,this.$$ge=this.getEnumerator,this._keyGen=e}}(0,a.a)(r,"ComparableSet",null,[12,13])},2125:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{constructor(e,t){this.value=t,this.key=e}}(0,a.a)(i,"KeyValuePair",null,[])},1520:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(4277);class o{get_current(){if(-1===this._index||this._index>=this._array.length)throw Error.invalidOperation();return this._array[this._index]}moveNext(){return this._index++,this._index<this._array.length}reset(){this._index=-1}next(){return this._index++,this._index<this._array.length?{done:!1,value:this._array[this._index]}:{done:!0,value:void 0}}constructor(e){this._index=-1,this._array=e}}(0,a.a)(o,"ArrayEnumerator",null,[4]);class r{$$lge(){return new i.a(this._items)}getEnumerator$p(){return new o(this._items)}[Symbol.iterator](){return this._items[Symbol.iterator]()}get count(){return this._items.length}add(e){this._items.push(e)}push(...e){if(window.g_ListBehavesAsArray)this._items.push(...e);else for(const t of e)this._items.push(t)}clear(){this._items=new Array(0)}contains(e){return window.g_ListBehavesAsArray?this._items.includes(e):Array.contains(this._items,e)}remove(e){if(window.g_ListBehavesAsArray){var t=this._items.indexOf(e);return!(t<0)&&(this._items.splice(t,1),!0)}return!!this.contains(e)&&(Array.remove(this._items,e),!0)}indexOf(e){return window.g_ListBehavesAsArray?this._items.indexOf(e):Array.indexOf(this._items,e)}removeAt(e){if(window.g_ListBehavesAsArray)this._items.splice(e,1);else{if(e>=this.count)throw Error.argumentOutOfRange("index");Array.removeAt(this._items,e)}}get_item(e){if(window.g_ListBehavesAsArray)return this._items[e];if(e>=this.count)throw Error.argumentOutOfRange("index");return this._items[e]}set_item(e,t){if(window.g_ListBehavesAsArray)return this._items[e]=t,t;if(e>=this.count)throw Error.argumentOutOfRange("index");return this._items[e]=t,t}addRange(e){if(window.g_ListBehavesAsArray)this._items.push(...e);else for(const t of e)this.add(t)}insert(e,t){if(window.g_ListBehavesAsArray)this._items.splice(e,0,t);else{if(e>this.count)throw Error.argumentOutOfRange("index");Array.insert(this._items,e,t)}}insertRange(e,t){if(window.g_ListBehavesAsArray)this._items.splice(e,0,...t);else{if(e>this.count)throw Error.argumentOutOfRange("index");for(const n of t)Array.insert(this._items,e++,n)}}toArray(){return window.g_ListBehavesAsArray?this._items:Array.clone(this._items)}sort(){this._items.sort()}Sc(e){this._items.sort(((t,n)=>e(t,n)))}constructor(e=null){this.$$ge=this.$$lge,this.getEnumerator=this.getEnumerator$p,this._items=e||new Array(0)}}(0,a.a)(r,"List",null,[35,13,5])},5737:function(e,t,n){"use strict";n.d(t,{a:function(){return l}});var a=n(100),i=n(6082),o=n(625),r=n(2125),s=n(205);class l{$$ge(){return s.c(s.b((0,o.a)(this._map,this._map.entries,"entries")),(e=>new r.a(e[0],e[1]))).$$ge()}getEnumerator$p(){return this.$$ge()}get count(){return this._map.size}get keys(){return s.b((0,o.a)(this._map,this._map.keys,"keys"))}get values(){return s.b((0,o.a)(this._map,this._map.values,"values"))}Akvp(e){if(this._map.has(e.key))throw Error.create("DuplicateKeyException");this._map.set(e.key,e.value)}get_item(e){const{value:t,returnValue:n}=this.tryGetValue(e,null);if(!n)throw Error.create("KeyNotFoundException");return t}set_item(e,t){return this._map.set(e,t),t}add(e,t){if(this._map.has(e))throw Error.create("DuplicateKeyException");this._map.set(e,t)}containsKey(e){return this._map.has(e)}remove(e){return this._map.delete(e)}tryGetValue(e,t=null){if(this._map.has(e)){return{returnValue:!0,value:this._map.get(e)}}return{returnValue:!1,value:t}}[Symbol.iterator](){return(0,i.a)(this.getEnumerator())}constructor(){this._map=new Map,this.getEnumerator=this.getEnumerator$p}}(0,a.a)(l,"ScriptSharpLegacyMap",null,[32,13,5])},8511:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(625),o=n(205);class r{getEnumerator(){return o.b((0,i.a)(this._set,this._set.values,"values")).$$ge()}[Symbol.iterator](){return this._set.values()}get count(){return this._set.size}add(e){return!this._set.has(e)&&(this._set.add(e),!0)}clear(){this._set.clear()}contains(e){return this._set.has(e)}remove(e){return this._set.delete(e)}constructor(){this._set=new Set,this.$$ge=this.getEnumerator}}(0,a.a)(r,"ScriptSharpLegacySet",null,[12,13])},6996:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(5737);class o extends i.a{constructor(){super()}}(0,a.a)(o,"StringDictionary",i.a,[])},3758:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8511);class o extends i.a{constructor(){super(),o.resolveInheritance(),this.$$ge=this.getEnumerator}}(0,a.a)(o,"StringSet",i.a,[12,13])},9924:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(e,t)=>e?(e.push(t),e):[t]},3299:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{get hasValue(){return!this._valueCreator}get value(){return this._valueCreator&&(this._value=this._valueCreator(),this._valueCreator=null),this._value}constructor(e){this._valueCreator=e}}(0,a.a)(i,"Lazy",null,[])},205:function(e,t,n){"use strict";n.d(t,{a:function(){return u},b:function(){return p},c:function(){return g},d:function(){return h}});var a=n(100),i=n(4277);class o{getEnumerator(){return new i.a(this._array)}[Symbol.iterator](){return this._array[Symbol.iterator]()}constructor(e){this.$$ge=this.getEnumerator,this._array=e}}(0,a.a)(o,"ArrayEnumerable$1",null,[13]);var r=n(1520);class s{get_current(){return this._current}moveNext(){this._iterator||(this._iterator=this._getIterator());const e=this._iterator.next();return this._current=e.value,!e.done}reset(){this._iterator=null}constructor(e){this._iterator=null,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._getIterator=e}}(0,a.a)(s,"IteratorEnumerator",null,[208]);class l{getEnumerator(){return new s(this._getIterator)}[Symbol.iterator](){return this._getIterator()}constructor(e){this.$$ge=this.getEnumerator,this._getIterator=e}}(0,a.a)(l,"IteratorEnumerable",null,[13]);var c=n(6082);class d{getEnumerator(){return this._shouldCloneForGetEnumerator?new d(this._source,this._simpleSelector,this._indexedSelector):(this._shouldCloneForGetEnumerator=!0,this)}[Symbol.iterator](){return(0,c.a)(this.getEnumerator())}get_current(){return this._current}moveNext(){return this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),!!this._sourceEnumerator.$$mn()&&(this._current=this.runSelector(this._sourceEnumerator.$$cu()),this._index++,!0)}next(){return this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),this._sourceEnumerator.$$mn()?(this._current=this.runSelector(this._sourceEnumerator.$$cu()),this._index++,{done:!1,value:this._current}):{done:!0,value:void 0}}reset(){this._sourceEnumerator=null,this._index=-1}runSelector(e){return this._indexedSelector?this._indexedSelector(e,this._index):this._simpleSelector(e)}constructor(e,t,n){this._shouldCloneForGetEnumerator=!1,this._index=0,this._sourceEnumerator=null,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this._source=e,this._indexedSelector=n,this._simpleSelector=t}}(0,a.a)(d,"SelectEnumerator",null,[13,208]);const u=e=>new o(e),p=e=>new l(e),g=(e,t)=>new d(e,t,null),h=e=>(e=>{const t=new r.a;for(const n of e)t.add(n);return t})(e).toArray()},1779:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var a=n(100);class i{equals(e,t){return e&&t?(this._ignoreCase&&(e=e.toUpperCase(),t=t.toUpperCase()),e===t):e===t}getHashCode(e){if(!e)return 0;this._ignoreCase&&(e=e.toUpperCase());let t=352654597;for(let n=0;n<e.length;n+=2)t=(t<<5)+t+(t>>27)^(e.charCodeAt(n)|e.charCodeAt(n+1)<<16|0);return t}getEqualityKey(e){return e&&this._ignoreCase?e.toUpperCase():e}static get_ordinal(){return i._ordinal||(i._ordinal=new i(!1))}static get_ordinalIgnoreCase(){return i._ordinalIgnoreCase||(i._ordinalIgnoreCase=new i(!0))}constructor(e){this._ignoreCase=e}}i._ordinal=null,i._ordinalIgnoreCase=null,(0,a.a)(i,"StringComparer",null,[36,37])},6144:function(e,t,n){"use strict";n.d(t,{C:function(){return a},a:function(){return i}});const a=e=>{const t=new Array(0);for(const n of e)t.push(n);return Error.create("AggregateException: Aggregate exceptions",{Exceptions:t})},i=e=>{const t=new Array(0);for(const n of e)t.push(n);return Error.create("AggregateException: Aggregate exceptions",{Exceptions:t})}},5367:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(9924);class o{get disposed(){return this._disposed}tryExecute(){this.disposed||(this._action?this._action():this._actionWithData(this._data))}dispose(){this._disposed=!0}constructor(e,t,n){this._disposed=!1,this._action=e,this._actionWithData=t,this._data=n}}(0,a.a)(o,"CancellationTokenRegistration",null,[11]);class r{get isCancellationRequested(){return this._isCancellationRequested}get canBeCanceled(){return this._canBeCanceled}throwIfCancellationRequested(){this.isCancellationRequested&&r.throwCancellation()}R(e){return this.register(e)}register(e){const t=new o(e,null,null);return this.registerCore(t),t}RO(e,t){const n=new o(null,e,t);return this.registerCore(n),n}registerCore(e){this.isCancellationRequested?e.tryExecute():this._registrations=i.a(this._registrations,e)}cancel(e){if(!this.canBeCanceled)throw Error.invalidOperation("CanBeCanceled is false");if(!this.isCancellationRequested&&(this._isCancellationRequested=!0,e&&this._registrations))for(const e of this._registrations)e.tryExecute()}static throwCancellation(){throw r.createCancellationException()}static createCancellationException(){return Error.create("OperationCanceledException: Task canceled",{$$canceled:!0})}static get none(){return r._noneToken}static isCancellationException(e){return e[r.exceptionData]}constructor(e){this._registrations=null,this._isCancellationRequested=!1,this._canBeCanceled=e}}r.exceptionData="$$canceled",r._noneToken=new r(!1),(0,a.a)(r,"CancellationToken",null,[])},5819:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(3068),o=n(6144);class r extends i.a{SEsE(e){this.set_exception(o.C(e))}SEsA(e){this.set_exception(o.a(e))}SE(e){this.set_exception(e)}setResult(e){this.set_result(e),this.setCompleted(!0)}constructor(){super()}}(0,a.a)(r,"CompletableTask$1",i.a,[])},9688:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100),i=n(8559),o=n(6144);class r extends i.Task{SEsE(e){this.set_exception(o.C(e))}SEsA(e){this.set_exception(o.a(e))}SE(e){this.set_exception(e)}setResult(){this.setCompleted(!0)}constructor(){super()}}(0,a.a)(r,"CompletableTask",i.Task,[])},3068:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(8559),o=n(5367);class r{onCompleted(e){this._task.OC(e,null,0,null)}get isCompleted(){return this._task.isCompleted}getResult(){if(this._task.isFaulted)throw this._task.exception;if(this._task.isCanceled)throw o.a.createCancellationException();return this._task.result}constructor(e){this._task=e}}(0,a.a)(r,"TaskAwaiter$1",null,[203]);class s extends i.Task{execute(){if(this._func)this.set_result(this._func());else{if(!this._funcWithData)return!1;this.set_result(this._funcWithData(this._data))}return!0}get result(){if(6!==this.status)throw Error.invalidOperation();return this._result}set_result(e){return this._result=e,e}G(){return new r(this)}static C(e){const t=new s;return t._func=e,t}static CO(e,t){const n=new s;return n._funcWithData=e,n._data=t,n}constructor(){super(),this._func=null,this._funcWithData=null}}(0,a.a)(s,"Task$1",i.Task,[])},8559:function(e,t,n){"use strict";n.r(t),n.d(t,{Task:function(){return p}});var a=n(100),i=n(625),o=n(9924),r=n(205),s=n(5367);class l{onCompleted(e){this._task.OC(e,null,0,null)}get isCompleted(){return this._task.isCompleted}getResult(){if(this._task.isFaulted)throw this._task.exception;if(this._task.isCanceled)throw s.a.createCancellationException()}constructor(e){this._task=e}}(0,a.a)(l,"TaskAwaiter",null,[203]);class c{constructor(e,t,n){this.handler=null,this.taskHandler=null,this.task=null,this.token=e,this.options=t,this.taskScheduler=n}}(0,a.a)(c,"Continuation",null,[]);var d=n(4783);class u{complete(){this._isCompleted=!0;for(const e of this._actions)e()}get isCompleted(){return this._isCompleted}getResult(){}onCompleted(e){this.isCompleted?e():this._actions.push(e)}getAwaiter(){return this}constructor(){this._actions=new Array(0),this._isCompleted=!1,d.a.runOnSpecific((0,i.a)(this,this.complete,"complete"),null)}}(0,a.a)(u,"YieldAwaitable",null,[203]);class p{get asyncState(){return this._data}get id(){return this._id||(this._id=++p._nextTaskId),this._id}get status(){return this._status}get exception(){return this._exception}set_exception(e){return s.a.isCancellationException(e)?this.setCanceled():(this._exception=e,this.setCompleted(!1)),e}get isCanceled(){return 4===this.status}get isCompleted(){return this.status>3}get isFaulted(){return 5===this.status}g(){return new l(this)}onCompleted_Synchronous_Deprecated(e){this.isCompleted?e():this.g().onCompleted(e)}setCanceled(){this.trySetCanceled(!1)||p.throwNotActive()}trySetCanceled(e){return!this.isCompleted&&(!(!e&&3===this.status)&&(this._status=4,this.runAllContinuations(),!0))}setCompleted(e){this.trySetCompleted(e)||p.throwNotActive()}trySetCompleted(e){return!this.isCompleted&&(this._status=e?6:5,this.runAllContinuations(),!0)}runAllContinuations(){const e=this._continuations;this._continuations=null;let t=!1;if(e)for(const n of e)t=this.triggerContinuation(n)||t;this.exception&&!t&&d.a.publishUnobservedTaskException(this,this.exception)}triggerContinuation(e){if(e.token&&e.token.isCancellationRequested)return e.task&&e.task.trySetCanceled(!1),!1;const t=this.checkShouldExecute(e);if(e.task)p.continueTask(e,t,e.taskScheduler);else{const n=e.handler||(()=>{e.taskHandler(this)});p.continueAction(e,t,e.taskScheduler,n)}return t}checkShouldExecute(e){return!(this.isFaulted&&2&e.options)&&(!(this.isCanceled&&1&e.options)&&!(6===this.status&&4&e.options))}addContinuation(e,t,n,a){const i=Object.assign(new c(t,n,a),{task:e});this.addContinuationInternal(i)}OC(e,t,n,a){const i=Object.assign(new c(t,n,a),{handler:e,token:t,taskScheduler:a});this.addContinuationInternal(i)}OCT(e,t,n,a){const i=Object.assign(new c(t,n,a),{taskHandler:e,token:t,taskScheduler:a});this.addContinuationInternal(i)}addContinuationInternal(e){if(e.taskScheduler=e.taskScheduler||d.a.current,e.token&&e.task){if(e.token.isCancellationRequested&&this.handleCancelation(e))return;e.token.R((()=>{this.handleCancelation(e)}))}this.isCompleted?this.triggerContinuation(e):this._continuations=o.a(this._continuations,e)}handleCancelation(e){return!!e.task&&e.task.trySetCanceled(!1)}CW(e){return this.continueWith(e)}CWC(e,t){const a=n(7043).a.C(e,this);return this.addContinuation(a,t,0,null),a}CWo(e,t){return this.continueWith(e,t)}continueWith(e,t=0,a=null,i=null){const o=n(7043).a.C(e,this);return this.addContinuation(o,a,t,i),o}CWT(e,t){const a=n(7043).a.C(e,this);return this.addContinuation(a,null,0,t),a}CWO(e,t){const a=n(7043).a.CO(e,t,this);return this.addContinuation(a,null,0,null),a}CWOC(e,t,a){const i=n(7043).a.CO(e,t,this);return this.addContinuation(i,a,0,null),i}CWOo(e,t,a){const i=n(7043).a.CO(e,t,this);return this.addContinuation(i,null,a,null),i}CWOT(e,t,a){const i=n(7043).a.CO(e,t,this);return this.addContinuation(i,null,0,a),i}CWCT(e,t,a,i){const o=n(7043).a.C(e,this);return this.addContinuation(o,t,a,i),o}CWOCT(e,t,a,i,o){const r=n(7043).a.CO(e,t,this);return this.addContinuation(r,a,i,o),r}CWR(e){return this.continueWithResult(e)}continueWithResult(e,t=0,a=null,i=null){const o=n(2696).a.C(e,this);return this.addContinuation(o,a,t,i),o}CWRCC(e,t){const a=n(2696).a.C(e,this);return this.addContinuation(a,t,0,null),a}CWRCo(e,t){const a=n(2696).a.C(e,this);return this.addContinuation(a,null,t,null),a}CWRT(e,t){const a=n(2696).a.C(e,this);return this.addContinuation(a,null,0,t),a}CWRO(e,t){const a=n(2696).a.CO(e,t,this);return this.addContinuation(a,null,0,null),a}CWRCT(e,t,a,i){const o=n(2696).a.C(e,this);return this.addContinuation(o,t,a,i),o}CWROCT(e,t,a,i,o){const r=n(2696).a.CO(e,t,this);return this.addContinuation(r,a,i,o),r}start(){this.Start$Scheduler(d.a.current)}Start$Scheduler(e){if(1!==this.status)throw Error.invalidOperation();this._taskScheduler=e,this._status=2,e.queueTask(this)}tryExecute(){if(this._cancelationToken&&this._cancelationToken.isCancellationRequested)return this.isCompleted||this.setCanceled(),!1;if(this.isCompleted)return!1;const e=d.a.current;return this._taskScheduler=this._taskScheduler||d.a.current,d.a.current=this._taskScheduler||d.a.current,this.runSynchronously(),d.a.current=e,!0}runSynchronously(){this._status=3;try{if(!this.execute())throw Error.invalidOperation();this.setCompleted(!0)}catch(e){s.a.isCancellationException(e)?this.trySetCanceled(!0):this.set_exception(e)}}execute(){if(this._action)this._action();else{if(!this._actionWithData)return!1;this._actionWithData(this._data)}return!0}static get factory(){return p._factory}static Create(e){return Object.assign(new p,{_action:e})}static Create$object(e,t){return Object.assign(new p,{_actionWithData:e,_data:t})}static throwNotActive(){throw Error.invalidOperation()}static continueAction(e,t,n,a){t&&(8&e.options?a():d.a.runOnSpecific(a,n))}static continueTask(e,t,n){const a=e.task;t?8&e.options?a.tryExecute():1===a.status&&(a._cancelationToken=e.token,a.Start$Scheduler(n||d.a.current)):a.setCanceled()}static delay(e){const t=new(n(9688).a);return window.setTimeout((0,i.a)(t,t.setResult,"setResult"),e),t}static y(){return new u}static fromResult(e){const t=new(n(5819).a);return t.setResult(e),t}static WAA(...e){return p.whenAll.apply(null,e)}static whenAll(...e){return p.WhenAllEnumerable(r.a(e))}static WAE(e){return p.WhenAllEnumerable(e)}static WhenAllEnumerable(e){let t=null,a=!1,i=0;const r=new(n(9688).a),s=()=>{t?r.SEsA(t):a?r.setCanceled():r.setResult()},l=e=>{e.isFaulted&&(t=o.a(t,e.exception)),e.isCanceled&&(a=!0),i--,i||s()};i++;for(const t of e)i++,t.isCompleted?l(t):t.OCT(l,null,0,null);return i--,i||s(),r}static When(e){let t=new(n(5819).a);const a=e=>{t&&(t.setResult(e),t=null)};for(const t of e){if(t.isCompleted)return p.fromResult(t);t.OCT(a,null,0,null)}return t}static When$Result(e){let t=new(n(5819).a);const a=e=>{t&&(t.setResult(e),t=null)};for(const t of e){if(t.isCompleted)return p.fromResult(t);t.OCT((e=>{a(e)}),null,0,null)}return t}constructor(){this._continuations=null,this._action=null,this._actionWithData=null,this._taskScheduler=null,this._cancelationToken=null,this._exception=null,this._data=null,this._status=1}}p._nextTaskId=0,(0,a.a)(p,"Task",null,[])},353:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(100),i=n(625),o=n(6144),r=n(3068);class s{execute(e){if(this._exception)throw this._exception;return this._result}get task(){return this._task}SXs(e){this._exception=o.C(e),this._task.runSynchronously()}SX(e){this.setException(e)}setException(e){this._exception=e,this._task.runSynchronously()}trySetException(e){return!this._task.isCompleted&&(this.setException(e),!0)}setResult(e){this._result=e,this._task.runSynchronously()}trySetResult(e){return!this._task.isCompleted&&(this.setResult(e),!0)}setCanceled(){this._task.setCanceled()}trySetCanceled(){return this._task.trySetCanceled(!1)}constructor(e){this._exception=null,this._task=r.a.CO((0,i.a)(this,this.execute,"execute"),e)}}(0,a.a)(s,"TaskCompletionSource",null,[])},2696:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(3068);class o extends i.a{execute(){return this._action$2?this.set_result(this._action$2(this._parent)):this.set_result(this._actionWithData$2(this._parent,this._data)),!0}static C(e,t){const n=new o;return n._action$2=e,n._parent=t,n}static CO(e,t,n){const a=new o;return a._actionWithData$2=e,a._data=t,a._parent=n,a}constructor(){super(),this._action$2=null,this._actionWithData$2=null,this._parent=null}}(0,a.a)(o,"ContinuableTask$1",i.a,[])},7043:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var a=n(100),i=n(8559);class o extends i.Task{execute(){return this._action$1?this._action$1(this._parent):this._actionWithData$1(this._parent,this._data),!0}static C(e,t){const n=new o;return n._action$1=e,n._parent=t,n}static CO(e,t,n){const a=new o;return a._actionWithData$1=e,a._data=t,a._parent=n,a}constructor(){super(),this._action$1=null,this._actionWithData$1=null,this._parent=null}}(0,a.a)(o,"ContinuableTask",i.Task,[])},4783:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var a=n(100);class i extends Sys.EventArgs{constructor(e){super(),this.exception=e}}(0,a.a)(i,"UnobservedTaskExceptionEventArgs",Sys.EventArgs,[]);const o="UnobservedException";class r{tryExecuteTask(e){return e.tryExecute()}static get events(){return r._events||(r._events=new Sys.EventHandlerList)}static get default(){return r._default}static get current(){return r._current}static set current(e){r._current=e}static add_unobservedTaskException(e){r.events.addHandler(o,e)}static remove_unobservedTaskException(e){r.events.removeHandler(o,e)}static runOnSpecific(e,t){const{Task:a}=n(8559);(t=t||r.current)===r._default?window.setTimeout(r.runCurrent(e,t),0):a.Create(e).Start$Scheduler(t)}static publishUnobservedTaskException(e,t){const n=r.events.getHandler(o);n&&n(e,new i(t))}static runCurrent(e,t){return()=>{const n=r.current;r.current=t,e(),r.current=n}}}r._events=null,(0,a.a)(r,"TaskScheduler",null,[])},100:function(e,t,n){"use strict";n.d(t,{a:function(){return a},b:function(){return i}});const a=(e,t,n,a)=>{e.prototype.constructor=e,e.__typeName=t,e.__class=!0,n&&(e.__baseType=n,e.__basePrototypePending=!1),a.length>0&&(e.__interfaces=a)},i=(e,t,n=!1)=>{t.__typeName=e,t.__string=e,t.__flags=n,t.__enum=!0,t.parse=e=>t[e],t.toString=e=>t[e],t.getName=()=>e}},1432:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{a:function(){return deprecated__dangerouslyEval}});const deprecated__dangerouslyEval=script=>eval(script)},6082:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=e=>(e.next||(e.next=function(){return this.moveNext()?{done:!1,value:this.get_current()}:{done:!0,value:void 0}},e[Symbol.iterator]=function(){return this}),e)},3078:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=function(e,t){return null!=e&&null!=t&&("number"==typeof e||"string"==typeof e?Object.getType(t).implementsInterface(e):e.isInstanceOfType(t))}},8555:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(e,t)=>{if("number"==typeof e||"string"==typeof e){if(null==t||!Object.getType(t).implementsInterface(e))return null}else if(!e.isInstanceOfType(t))return null;return t}},625:function(e,t,n){"use strict";n.d(t,{a:function(){return a}});const a=(e,t,n)=>{const a=`$$d_${n}`;return null==e[a]&&(e[a]=t.bind(e)),e[a]}},1591:function(e,t,n){"use strict";n.d(t,{a:function(){return m}});var a=n(100),i=n(9223),o=n(3245),r=n(4934),s=n(2280),l=n(3946),c=n(6101),d=n(5149),u=n(1520),p=n(7449);const g="appChrome",h="appResourceLoader";class m{static getAppChrome(e=!0,t=!1){const n={featureName:"ResourceDownload",areaName:o.AFrameworkApplication.appSettingsManager.getStringAppSetting("WordEditorRibbonKPIAreaName"),crewAlias:"wwbootperf"};this._extendedHealth=r.a.getInstance(n);const a=o.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.SharedOnline.isStaticRibbonUiEnabled",!1)&&1!==o.AFrameworkApplication.activeFrame?.mode;if(a){if(m.appChromeLoadPromise)return m.appChromeLoadPromise;if(!t)return m.appChromeInitPromise||(m.appChromeInitPromise=new Promise(((e,t)=>{m.appChromeInitCallback={resolve:e,reject:t}}))),m.appChromeInitPromise}const l=o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ShouldLogWordRibbonKpis");l&&this._extendedHealth.logKpiUsage({kpiName:"RibbonCriticalResources",kpiType:p.b.FailureBased});const d=s.a.instance.resolve(i.a).getScriptLoader();return o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled")?m.appChromeLoadPromise=m.getRibbonLoaderPromise(d,l).then((e=>null)):m.appChromeLoadPromise=m.getLoadAppResourceLoaderPromise(d,l).then((e=>m.getRibbonLoaderPromise(d,l))),!m.isAppChromeInitialized&&e&&(m.appChromeLoadPromise=m.appChromeLoadPromise.then((e=>{c.g(d),m.isAppChromeInitialized=!0,a&&(this.appChromeInitCallback?.resolve(e),this.appChromeInitCallback=void 0)}))),this.appChromeLoadPromise}static getLoadAppResourceLoaderPromise(e,t){return e.loadScript(h).catch((e=>{d.ULS.sendTraceTag(50456130,340,10,"Failed to load the resources for AppResourceLoader"),t&&this.recordRibbonResourceFailureKpi(e.message??"/AppResourceLoaderResources")}))}static getRibbonLoaderPromise(e,t){const n=new u.a;if(o.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.WordOnline.HashedBootIntlResources")){const e=o.AFrameworkApplication.activeFrame.applicationInstance.shouldRenderReactMultilineRibbon||o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1),a=o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentIconsEnabled",!1);let i=e?"word-app-intl-mlr":"word-app-intl";a&&(i+="-fluent"),n.add(appResourceLoader.loadChunk(i).catch((e=>{d.ULS.sendTraceTag(507551831,340,10,"Failed to load the resources for {0}: {1}",i,e.stack),t&&this.recordRibbonResourceFailureKpi(e.message??"/IntlBootResources")})))}else n.add(appResourceLoader.loadIntlBootResources(m.getIntlBootResourcesOptions()).catch((e=>{d.ULS.sendTraceTag(50456131,340,10,"Failed to load the resources for IntlBoot: {0}",e.stack),t&&this.recordRibbonResourceFailureKpi(e.message??"/IntlBootResources")})));return o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DynamicBundlesIsEnabled")?n.add(appResourceLoader.loadChunk(g).catch((e=>{d.ULS.sendTraceTag(570697749,340,10,"Failed to load the resources for AppChrome: {0}",e.stack),t&&this.recordRibbonResourceFailureKpi(e.request??"/AppChromeResources")}))):n.add(e.loadScript(g).catch((e=>{d.ULS.sendTraceTag(50456132,340,10,"Failed to load the resources for AppChrome: {0}",e.stack),t&&this.recordRibbonResourceFailureKpi(e.request??"/AppChromeResources")}))),Promise.all(n.toArray())}static preloadUIResourceScripts(){s.a.instance.resolve(i.a).getScriptLoader().preloadScript(h)}static recordRibbonResourceFailureKpi(e){const t=e.split("/"),n=t[t.length-1].split("?")[0];this._extendedHealth.logKpiFailure({kpiName:"RibbonCriticalResources",errorName:"FileDownloadFailure_"+n})}static getIntlBootResourcesOptions(){let e=o.AFrameworkApplication.staticContentScriptNameBase+o.AFrameworkApplication.lcid+"/";return l.a.isEnabled&&(e=l.a.getLocalizationPath(o.AFrameworkApplication.lcid)),{scriptBaseUrl:e,isMLRRibbonMode:o.AFrameworkApplication.activeFrame.applicationInstance.shouldRenderReactMultilineRibbon||o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1),isCombinedBundleEnabled:o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsCombinedBundleEnabled"),isFluentIconsEnabled:o.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentIconsEnabled",!1)}}}m.isAppChromeInitialized=!1,(0,a.a)(m,"AppChromeProvider",null,[])}},__webpack_module_cache__={},inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=function(e){return Promise.all(Object.keys(__webpack_require__.f).reduce((function(t,n){return __webpack_require__.f[n](e,t),t}),[]))},__webpack_require__.u=function(e){return"WordViewerDS."+{1:"dialog",2:"dll1",3:"immersive-reader-sdk",4:"inProductMessagingActor",5:"objectmodel",6:"prefetch"}[e]+".js"},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},inProgress={},dataWebpackPrefix="@1js/wac-wordviewer:",__webpack_require__.l=function(e,t,n,a){if(inProgress[e])inProgress[e].push(t);else{var i,o;if(void 0!==n)for(var r=document.getElementsByTagName("script"),s=0;s<r.length;s++){var l=r[s];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==dataWebpackPrefix+n){i=l;break}}if(!i){var c;o=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,__webpack_require__.nc&&i.setAttribute("nonce",__webpack_require__.nc),i.setAttribute("data-webpack",dataWebpackPrefix+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous"),i.integrity=__webpack_require__.sriHashes[a],i.crossOrigin="anonymous",window.g_versionedUrlHashFunction&&(c=(u=(e=i.src).indexOf("?"))>-1?window.g_versionedUrlHashFunction(e.substring(0,u)):window.g_versionedUrlHashFunction(e))&&(u>-1&&(c+=e.substring(u)),i.src=window.g_hashedUrlTrustedTypesValidationFunction?window.g_hashedUrlTrustedTypesValidationFunction(c):c);var d=window.g_wscdt;if(void 0!==d&&!i.src.match("[?&]wscdt=")){var u=(e=i.src).indexOf("?");e+=(u>-1?"&":"?")+"wscdt="+d,i.src=e}}inProgress[e]=[t];var p=function(t,n){i.onerror=i.onload=null,clearTimeout(g);var a=inProgress[e];if(delete inProgress[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((function(e){return e(n)})),t)return t(n)},g=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),o&&document.head.appendChild(i)}},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e}(),__webpack_require__.sriHashes={1:"sha256-BkaWaNbO2zgTug26xJIDtnphU+tMFEhrG22k7ikos28=",2:"sha256-EYBgOi+dUCfRRSkVVLk86APPuSn3/WElJiHe5Lfdbjc=",3:"sha256-PYihu1aFLYyKpB5Uis519oOnFNUCGwFIJmPuNjQ0eps=",4:"sha256-yia7PIdl1DF8NgsA+Sdmfl2V1kAkO4m9CfHuk04pIic=",5:"sha256-jBMbDUTIw35ULRftI6sO63XAWP5Y/E4NHeVMgbFFRP4=",6:"sha256-b7L9GN6JH6GJgeoE//KcKwtS3VJ0VV7W4j4n/161a7o="},function(){var e={0:0};__webpack_require__.f.j=function(t,n){var a=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((function(n,i){a=e[t]=[n,i]}));n.push(a[2]=i);var o=__webpack_require__.p+__webpack_require__.u(t),r=new Error;__webpack_require__.l(o,(function(n){if(__webpack_require__.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",r.name="ChunkLoadError",r.type=i,r.request=o,a[1](r)}}),"chunk-"+t,t)}};var t=function(t,n){var a,i,[o,r,s]=n,l=0;if(o.some((function(t){return 0!==e[t]}))){for(a in r)__webpack_require__.o(r,a)&&(__webpack_require__.m[a]=r[a]);if(s)s(__webpack_require__)}for(t&&t(n);l<o.length;l++)i=o[l],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=globalThis.dullscriptWebpackJsonp=globalThis.dullscriptWebpackJsonp||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var __webpack_exports__={};!function(){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{App:function(){return wt.App}});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{ActivityAggregationMode:function(){return m.a},AllowedPartA:function(){return m.b},AriaTenantDefinitions:function(){return y.a},CustomerContentType:function(){return m.c},DnmAriaTenantDefinitions:function(){return y.b},DnmInterval:function(){return m.d},SamplingPolicy:function(){return m.e},ScorecardAggregateMethod:function(){return _.a},TelemetryFactory:function(){return f.a},TelemetryFactoryGlobal:function(){return m.f},ValueType:function(){return m.g},addNamespaceMapping:function(){return _.b},addSink:function(){return S.a},convertTelemetryEventToOtelTelemetryEvent:function(){return C.d},disableSessionLevelTelemetry:function(){return S.b},flushAsync:function(){return _.c},hasValidLogger:function(){return S.c},isMeasuresEnabled:function(){return S.d},logActivity:function(){return _.e},logActivityForExperiment:function(){return _.d},logUserAction:function(){return _.f},registerEventHandler:function(){return _.g},registerShutdownHook:function(){return _.h},sendActivityEvent:function(){return _.i},sendCustomerContentEvent:function(){return _.j},sendDirectNumericEvent:function(){return _.k},sendEventDirectlyToHandler:function(){return _.l},sendOtelCustomerContent:function(){return _.m},sendOtelDirectNumeric:function(){return _.n},sendOtelEvent:function(){return _.o},sendTelemetryEvent:function(){return _.p},sendUserActionEvent:function(){return _.q},setDNMToken:function(){return _.r},setEnabledState:function(){return _.s},setWorkerEnabledState:function(){return S.e},shutdown:function(){return _.t},startOtelWorker:function(){return S.f}});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{QosPillarName:function(){return L.a}});var n={};(()=>{var e=n;function t(e){const t=new Map;for(const n of e){const e=n.getFileName(),a=n.getScriptHash();e&&a&&t.set(e,a)}if(t.size){const e=["","Source modules:"];for(const[n,a]of t.entries())e.push(`    ${n} ${a}`);return e.join("\n")}}let a;function i(e,n){let i;return i=a?a.apply(Error,[e,n]):e.stack,t(n)?i+"\n"+t(n):i}Object.defineProperty(e,"X",{value:!0}),e.s=void 0,e.s=function(e){var t;"firstPrepareStackTrace"!==(null===(t=e.prepareStackTrace)||void 0===t?void 0:t.name)&&(a=e.prepareStackTrace,e.prepareStackTrace=function t(n,o){if(o.length>0){if("getScriptHash"in o[0].constructor.prototype)return e.prepareStackTrace===t&&(e.prepareStackTrace=i),i.apply(e,[n,o]);e.prepareStackTrace=a}return"function"==typeof a?a.apply(e,[n,o]):n.stack})}})();var a=n.s;var i=__webpack_require__(3078);const o=(e,t)=>{if(null!=t&&!(0,i.a)(e,t))throw Error.create(Sys.Res.argumentType);return t};var r=__webpack_require__(8559),s=__webpack_require__(100),l=__webpack_require__(3068),c=__webpack_require__(4783);class d{S(e){const t=r.Task.Create(e);return t.Start$Scheduler(this._scheduler),t}SC(e,t){const n=r.Task.Create(e);return t.isCancellationRequested?n.setCanceled():n.Start$Scheduler(this._scheduler),n}SO(e,t){const n=r.Task.Create$object(e,t);return n.Start$Scheduler(this._scheduler),n}SOC(e,t,n){const a=r.Task.Create$object(e,t);return n.isCancellationRequested?a.setCanceled():a.Start$Scheduler(this._scheduler),a}SR(e){const t=l.a.C(e);return t.Start$Scheduler(this._scheduler),t}SRC(e,t){const n=l.a.C(e);return t.isCancellationRequested?n.setCanceled():n.Start$Scheduler(this._scheduler),n}SRO(e,t){const n=l.a.CO(e,t);return n.Start$Scheduler(this._scheduler),n}SROC(e,t,n){const a=l.a.CO(e,t);return n.isCancellationRequested?a.setCanceled():a.Start$Scheduler(this._scheduler),a}constructor(){this._scheduler=c.a.default}}(0,s.a)(d,"TaskFactory",null,[]);class u extends c.a{queueTask(e){window.setTimeout((()=>{this.tryExecuteTask(e)}),0)}constructor(){super()}}(0,s.a)(u,"DefaultTaskScheduler",c.a,[]);var p=__webpack_require__(6489),g=__webpack_require__(5330),h=__webpack_require__(9878);var m=__webpack_require__(5901),_=__webpack_require__(2657),S=__webpack_require__(5208),f=__webpack_require__(7938),C=__webpack_require__(6009),y=__webpack_require__(4564);var A=__webpack_require__(3245),b=__webpack_require__(1313);const T=()=>{b.a.instance.authenticationCheck()};var v=__webpack_require__(2518);class w{get actionData(){return this._actionData}get shouldCanvasTakeFocus(){return this._shouldCanvasTakeFocus}constructor(e,t=!0){this._actionData=e,this._shouldCanvasTakeFocus=t}}(0,s.a)(w,"ActionDataContainer",null,[28]);var F=__webpack_require__(3311),I=__webpack_require__(1307),E=__webpack_require__(6654),M=__webpack_require__(385);class k{hasFlag(e){return!!(this.capabilities&e)}setFlag(e){this.capabilities=this.capabilities|e}unsetFlag(e){this.capabilities=this.capabilities&~e}equals(e){return!(this.capabilities-e.capabilities)}clone(){return new k(this.capabilities)}toString(){return Object.prototype.toString.call(this)}constructor(e=0){this.capabilities=e}}(0,s.a)(k,"UserCapabilities",null,[]);var P=__webpack_require__(8103);class D{equals(e){return!!e&&e.color===this.color&&e.userName===this.userName&&e.clientId===this.clientId&&e.isAnonymous===this.isAnonymous&&e.email===this.email&&e.inChat===this.inChat&&this.capabilities.equals(e.capabilities)&&e.presenceStatus===this.presenceStatus&&e.coauthUserPresenceStatus===this.coauthUserPresenceStatus&&e.isReadOnly===this.isReadOnly}clone(){return new D(this.clientId,this.userName,this.color,this.capabilities.clone(),this.chatThreadId,this.email,this.client,this.chatThreadDiscoveryUri,this.isAnonymous,this.inChat,this.isReadOnly,this.joinTime,this.presenceStatus,this.coauthUserPresenceStatus,this.profilePictureUrl)}isComplete(){return this.isValid()&&!!this.userName&&!(this.userName===(0,P.a)("AnonymousUserName")&&!this.isAnonymous)}isValid(){return!!this.clientId}toString(){return Object.prototype.toString.call(this)}static createFromClientId(e){return new D(e,null,null,new k,null,null,null,null,!1,!1,!1,0,null,null)}constructor(e,t,n,a,i=null,o=null,r=null,s=null,l=!1,c=!1,d=!1,u=0,p=null,g=0,h=null){this.clientId=e,this.userName=t,this.color=n,this.capabilities=a||new k,this.chatThreadId=i,this.chatThreadDiscoveryUri=s,this.inChat=c,this.email=o,this.client=r,this.isAnonymous=l,this.isReadOnly=d,this.joinTime=u,this.presenceStatus=p,this.coauthUserPresenceStatus=g,this.profilePictureUrl=h}}(0,s.a)(D,"PresenceUser",null,[29]);class R extends D{get isPresenter(){return 1===this.role}constructor(e=0,t=null,n=null,a=null){super(),this.role=e,this.clientId=t,this.userName=n,this.color=a}}(0,s.a)(R,"ParticipantInfo",D,[]);var x=__webpack_require__(9461),L=__webpack_require__(734);var U=__webpack_require__(5149),O=__webpack_require__(5467),B=__webpack_require__(5721),N=__webpack_require__(965);class W{static getAppDetails(){return String.format("{0}, {1}, {2}",W.sessionStartInfoSettings.Application,W.sessionStartInfoSettings.ApplicationMode,W.sessionStartInfoSettings.ApplicationModeExtended)}}W.appSettingsManager=null,W.appLifecycleManager=null,W.sessionStartInfoSettings=null,(0,s.a)(W,"OtelLibraryLoaderHelperConstants",null,[]);const H="BootPerf",V="MissingUserClicks",G="BadUserClicks";class Q{static initBootPerfMetricsProcess(){W.appSettingsManager.getBooleanAppSetting("FlushBootMetricsToOtelIsEnabled")&&(Q.bootPerfMetricsFlushInitiated?U.ULS.sendTraceTag(562829313,383,100,"OtelLibraryLoader:BootPerf: BootPerfMetricsFlushInitiated is true so bailing out -[{0}]",W.getAppDetails()):(U.ULS.sendTraceTag(562829314,383,50,"OtelLibraryLoader:BootPerf: Waiting on App init status to flush metrics"),window.setTimeout((()=>{Q.bootPerfMetricsFlushInitiated||(U.ULS.sendTraceTag(562829315,383,15,"OtelLibraryLoader:BootPerf: Boot Perf metrics flush triggered from safety timer-[{0}]",W.getAppDetails()),Q.flushBootMetricsToOtel())}),W.appSettingsManager.getIntAppSetting("FlushBootMetricsSafetyTimerDelayMs",6e4)),W.appLifecycleManager.executeWhen(7,(()=>{U.ULS.sendTraceTag(562829316,383,100,"OtelLibraryLoader:BootPerf: ChromeReady event called -[{0}]",W.getAppDetails()),Q.chromeReadyCalled=!0,Q.appLoadedSuccessfullyCalled&&!Q.bootPerfMetricsFlushInitiated&&(U.ULS.sendTraceTag(562829317,383,50,"OtelLibraryLoader:BootPerf: Boot Perf metrics flush triggered from ChromeReady-[{0}]",W.getAppDetails()),Q.flushBootMetricsToOtel())})),W.appLifecycleManager.executeWhen(8,(()=>{U.ULS.sendTraceTag(562829318,383,100,"OtelLibraryLoader:BootPerf: AppLoadedSuccessfully event called -[{0}]",W.getAppDetails()),Q.appLoadedSuccessfullyCalled=!0,Q.chromeReadyCalled&&!Q.bootPerfMetricsFlushInitiated&&(U.ULS.sendTraceTag(562829319,383,50,"OtelLibraryLoader:BootPerf: Boot Perf metrics flush triggered from AppLoadedSuccessfully-[{0}]",W.getAppDetails()),Q.flushBootMetricsToOtel())}))))}static flushBootMetricsToOtel(){try{if(Q.metricsLogged=!1,!W.appSettingsManager.getBooleanAppSetting("FlushBootMetricsToOtelIsEnabled"))return;if(W.appSettingsManager.getBooleanAppSetting("FlushBootMetricsModifyAppInitStatusIsEnabled")&&Q.bootPerfMetricsFlushInitiated)return;Q.bootPerfMetricsFlushInitiated=!0,U.ULS.sendTraceTag(562829320,383,100,"OtelLibraryLoader:BootPerf: Starting process to send Boot metrics."),Q.pageLoadPerfRecorder.logTelemetry(),Q.pageLoadPerfRecorder.computeAndAddDurationMetrics();new Array(0);const e=N.b(W.appSettingsManager.appSettings.SessionStartInfoJson.toString()),t=Object.assign({},{extendedProperties:new Map});t.extendedProperties.set("SessionOrigin",e.SessionOrigin);try{const e=W.sessionStartInfoSettings.Flights||(A.AFrameworkApplication.flightId?A.AFrameworkApplication.flightId.split(";"):new Array(0));t.extendedProperties.set("Flights",N.c(e))}catch(e){U.ULS.sendTraceTag(562829321,383,50,"Failed to parse flight info, continuing with logging other metrics. Exception: {0}",e)}t.extendedProperties.set("ProtectedFile",A.AFrameworkApplication.protectedFile.toString());const n=A.AFrameworkApplication.appSettingsManager.getStringAppSetting("StaticLoadPrefetchEnabled");if(void 0!==n&&t.extendedProperties.set("StaticLoadPrefetch",n),A.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("IsBootedFromSWCacheFlagLoggingCG")&&!0===e.isBootedFromSWCache&&t.extendedProperties.set("IsBootedFromSWCache","true"),Q.pageLoadPerfRecorder.pageLoadPerfMetrics){O.Health.instance.recordKpiUsageForAlertableKpi(V,"wacbootmonitoring",null),O.Health.instance.recordKpiUsageForAlertableKpi(G,"wacbootmonitoring",null);const e=Q.pageLoadPerfRecorder.pageLoadPerfMetrics;for(const n in e){const a={key:n,value:e[n]};try{if(Object.getType(a.value)===Boolean)t.extendedProperties.set(a.key,a.value.toString());else{if(t.extendedProperties.set(a.key,Object.getType(a.value)===Object?N.c(a.value):a.value.toString()),a.key===B.a.eupl){const e=Number.parseInvariant(a.value.toString());!isNaN(e)&&e>0&&(t.durationMs=e)}if(a.key===B.a.userClickedHostUI){const e=a.value.toString();null==e&&O.Health.instance.recordKpiFailure(V,"UserClickTime is missing",!1,!0,null)}if(a.key===B.a.hostDuration){const e=Number.parseInvariant(a.value.toString());!isNaN(e)&&e>A.AFrameworkApplication.appSettingsManager.getIntAppSetting("BadUserClicksDuration",6e4)&&O.Health.instance.recordKpiFailure(G,"Bad click detected",!1,!0,null)}}}catch(e){t.extendedProperties.set(a.key,"")}}}O.Health.instance.recordKpiUsageForAlertableKpi(H,"wacbootmonitoring",null),O.Health.instance.recordKpiSuccess(H,t),U.ULS.sendTraceTag(562829322,383,100,"OtelLibraryLoader:BootPerf: Boot Perf KPI logged."),Q.metricsLogged=!0}catch(e){U.ULS.sendTraceTag(562829323,383,15,"Failed to send boot metrics to Otel"+e.toString())}}}Q.pageLoadPerfRecorder=null,Q.chromeReadyCalled=!1,Q.bootPerfMetricsFlushInitiated=!1,Q.appLoadedSuccessfullyCalled=!1,Q.metricsLogged=!0,(0,s.a)(Q,"BootPerfMetrics",null,[]);var q=__webpack_require__(8208),K=__webpack_require__(7296),z=__webpack_require__(5665);class j{static get appSettingsManager(){return W.appSettingsManager}static set appSettingsManager(e){W.appSettingsManager=e}static get appLifecycleManager(){return W.appLifecycleManager}static set appLifecycleManager(e){W.appLifecycleManager=e}static get sessionStartInfoSettings(){return W.sessionStartInfoSettings}static set sessionStartInfoSettings(e){W.sessionStartInfoSettings=e}static getAppDetails(){return W.getAppDetails()}static initSettings(e,t,n,a){j.appSettingsManager=e,j.sessionStartInfoSettings=t,j.appLifecycleManager=n,j._TaskManager=a}static isEnabledCheckAppInitStatusBeforeKickOffOtel(e){let t=!1;switch(e){case"word":case"onenote":case"powerpoint":case"visio":t=j.appSettingsManager.getBooleanAppSetting("OtelFullJsDelayLoadAfterAppLoadedSuccessfullyEnabled");break;case"excel":t=!0}return t}static getAppInitializationStatusToWaitForInViewMode(e){let t=7;switch(e){case"onenote":case"excel":t=7;break;case"word":case"powerpoint":case"visio":t=8}const n=j.sessionStartInfoSettings.ApplicationModeExtended;return n&&"embed_view"===n.toLowerCase()&&(t=8),t}static getAppInitializationStatusToWaitForInEditMode(e){let t=7;switch(e){case"word":case"onenote":case"powerpoint":t=7;break;case"excel":t=j.appSettingsManager.getBooleanAppSetting("FlushBootMetricsToOtelIsEnabled")?8:4;break;case"visio":t=8}return t}static getAppInitializationStatusToWaitFor(e){const t=j.sessionStartInfoSettings.ApplicationMode,n=t?t.toLowerCase():"";return"view"===n?j.getAppInitializationStatusToWaitForInViewMode(e):"slideshow"===n||"broadcast_view"===n?8:j.getAppInitializationStatusToWaitForInEditMode(e)}static getOtelDownloadSafetyTimerDelayMs(){j._otelDownloadSafetyTimerDelayMsMainAppModes=j.appSettingsManager.getIntAppSetting("OtelDownloadSafetyTimerDelayMsMainAppModes",0),j._otelDownloadSafetyTimerDelayMsNonMainAppModes=j.appSettingsManager.getIntAppSetting("OtelDownloadSafetyTimerDelayMsNonMainAppModes",3e3);let e=j._otelDownloadSafetyTimerDelayMsNonMainAppModes,t=j.sessionStartInfoSettings.ApplicationMode;if(t)switch(t=t.toLowerCase(),t){case"view":case"edit":case"unified":e=j._otelDownloadSafetyTimerDelayMsMainAppModes;break;default:e=j._otelDownloadSafetyTimerDelayMsNonMainAppModes}return e}static loadOtel(){j.appSettingsManager.getBooleanAppSetting("OtelPipelineIsEnabled")&&j.loadOtelOnIdle(),window.setTimeout((()=>{j.kickOffOtelLegacyCallback()}),j.getOtelDownloadSafetyTimerDelayMs());let e=j.sessionStartInfoSettings.Application||"unknownapp";e=e.toLowerCase();j.isEnabledCheckAppInitStatusBeforeKickOffOtel(e)?(U.ULS.sendTraceTag(50622754,226,50,"OtelLibraryLoader:Waiting for {0}",q.a[j.getAppInitializationStatusToWaitFor(e)]),j.appLifecycleManager.executeWhen(j.getAppInitializationStatusToWaitFor(e),j.kickOffOtelLegacyOnDemand)):(U.ULS.sendTraceTag(50622755,226,50,"OtelLibraryLoader:NOT waiting for any app initialization status"),j.kickOffOtelLegacy());j.appSettingsManager.getBooleanAppSetting("OtelTriggerDemandLoadIsEnabled")&&j.appLifecycleManager.executeWhen(13,j.kickOffOtelLegacy)}static startOtelWorker(e){U.ULS.sendTraceTag(524077263,226,50,"OtelLibraryLoader:StartOtelWorkerOnIdle"),z.a.startOtelWorker()}static loadOtelOnIdle(){const e=K.a.createOnIdle(1,1e3,j.startOtelWorker,0,214);j._TaskManager.addTask(e)}static kickOffOtelLegacyCallback(){j.kickOffOtelCallMade||(U.ULS.sendTraceTag(50622784,226,15,"KickOffOtelLegacy was called from safety callback[{0}]",j.getAppDetails()),j.kickOffOtelLegacy())}static kickOffOtelLegacyOnDemand(){j.kickOffOtelCallMade||(U.ULS.sendTraceTag(50622785,226,50,"KickOffOtelLegacy was demand initiated [{0}]",j.getAppDetails()),j.kickOffOtelLegacy())}static kickOffOtelLegacy(){j.kickOffOtelCallMade||(j.kickOffOtelCallMade=!0,j.appSettingsManager.getBooleanAppSetting("FlushBootMetricsModifyAppInitStatusIsEnabled")?Q.initBootPerfMetricsProcess():Q.flushBootMetricsToOtel())}}j._TaskManager=null,j.kickOffOtelCallMade=!1,j._otelDownloadSafetyTimerDelayMsMainAppModes=3e4,j._otelDownloadSafetyTimerDelayMsNonMainAppModes=3e3,(0,s.a)(j,"OtelLibraryLoaderHelper",null,[]);var Z=__webpack_require__(4361),X=__webpack_require__(9454);class J{get name(){return"Common.App.OtelLibraryLoader"}configure(e){}async initializeAsync(){U.ULS.sendTraceTag(38836106,226,50,"OtelLibraryLoader:Init");const e=()=>{j.initSettings(A.AFrameworkApplication.appSettingsManager,A.AFrameworkApplication.sessionStartInfoSettings,M.a.get_instance(),A.AFrameworkApplication.theTaskManager),Q.pageLoadPerfRecorder=X.a.instance,j.loadOtel()};try{M.a.get_instance().isCompleted(13)&&e()}catch(e){U.ULS.sendTraceTag(594564771,226,10,"Failed to initialize OTelJS after a session ending error: "+e)}A.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((()=>{U.ULS.sendTraceTag(38836107,226,50,"OtelLibraryLoader:FullAppSettingsReady"),e()})),A.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsFailed((()=>{U.ULS.sendTraceTag(38836108,226,10,"OtelLibraryLoader:Failed to get FullAppSettings"),e()}))}dispose(){}static main(){Z.a.instance.registerAsyncPackage(new J)}}(0,s.a)(J,"OtelLibraryLoaderPackage",null,[24,1]);var Y=__webpack_require__(8054);class ${get name(){return"Common.App.BrowserInfoLogger"}configure(e){}async initializeAsync(){Y.a.logInfo()}dispose(){}static main(){Z.a.instance.registerAsyncPackage(new $)}}(0,s.a)($,"BrowserInfoLoggerPackage",null,[24,1]);class ee{configure(e){}get name(){return"Common.App.Diagnostics"}async initializeAsync(){}dispose(){}static main(){Z.a.instance.registerAsyncPackage(new ee)}}(0,s.a)(ee,"DiagnosticsPackage",null,[24,1]);var te=__webpack_require__(3792),ne=__webpack_require__(9969);const ae="securitypolicyviolation";class ie{dispose(){$removeHandler(document,ae,this.onSecurityPolicyViolationEventHandler)}constructor(){this.onSecurityPolicyViolationEventHandler=e=>{const t=e.rawEvent;let n=t.blockedURI;n=ne.a.removeAllUrlParameters(n);const a={};a.effectiveDirective=t.effectiveDirective,a.violatedDirective=t.violatedDirective,a.originalPolicy=t.originalPolicy,a.blockedURI=n,a.disposition=t.disposition,U.ULS.sendTraceTag(588084128,306,15,"{0}",a)},$addHandler(document,ae,this.onSecurityPolicyViolationEventHandler)}}(0,s.a)(ie,"ContentSecurityPolicyListener",null,[11]);const oe=(0,te.b)("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener"),re=(0,te.e)(oe,{onDemandSingleton:e=>new ie});class se{get name(){return"Common.App.ContentSecurityPolicy"}async initializeAsync(){(0,te.a)(re)}dispose(){const e=(0,te.j)(oe);e&&e.dispose()}configure(e){this._container=e}static main(){Z.a.instance.registerAsyncPackage(new se)}constructor(){this._container=null}}(0,s.a)(se,"ContentSecurityPolicyPackage",null,[24,1]);var le=__webpack_require__(9531),ce=__webpack_require__(6012);class de{get chat(){return window.swc}get isInitialized(){return!!this.chat}get sharedHeaderFocusManager(){return this._reactSharedHeaderFocusManager.value}registerActions(){this.isInitialized?this.registerActionsInternal():this.registerOnChatReady(this.registerActionsInternal)}registerOnChatReady(e){le.a.instance.registerHandler(ce.a.swcReady,window.self,(t=>(e(),!0)))}transferFocusFromChat(e){U.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat"),this.sharedHeaderFocusManager.onChatCtrlF6(e)}constructor(e){this._previousNumberOfChats=0,this._chatContainerId=null,this.registerActionsInternal=()=>{U.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then((e=>{e.getChatsContainer(this.onChatContainerReady)})).catch((e=>{U.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",e)})),this.chat.getChatsCounter().then((e=>{e.onChatsCountChange(this.chatCountChanged)})).catch((e=>{U.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",e)})),this.chat.getKeyboard().then((e=>{e.onKeyDown(this.onChatKeyPress)})).catch((e=>{U.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",e)})))}catch(e){U.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",e)}},this.chatCountChanged=e=>{if(U.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",e),e){if(1===e&&!this._previousNumberOfChats){const e=document.getElementById(this._chatContainerId?this._chatContainerId:"chat_wrapper_pane");e?this.sharedHeaderFocusManager.onChatOpen(e,this.transferFocusToChat):U.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}}else this.sharedHeaderFocusManager.onChatClose();this._previousNumberOfChats=e},this.onChatContainerReady=e=>{this._chatContainerId=e},this.onChatKeyPress=e=>{e.ctrlKey&&"f6"===e.key.toLowerCase()&&this.transferFocusFromChat(e.shiftKey)},this.transferFocusToChat=()=>{U.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then((e=>{e.focusConversationInput()})).catch((e=>{U.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",e)}))}catch(e){U.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",e)}},this._reactSharedHeaderFocusManager=e}}(0,s.a)(de,"ChatManager",null,[379]);const ue=(0,te.b)("Common.App.Header.IChatManager");var pe=__webpack_require__(8028);const ge=(0,te.e)(ue,{onDemandRegister:(e,t)=>e.register(de,"Common.App.Header.ChatManager").as(t).singleInstance().usingFactory((()=>new de((0,te.i)(pe.a))))}),he=(0,te.b)("Common.App.Header.IUpsellActor");var me=__webpack_require__(4182),_e=__webpack_require__(8555),Se=__webpack_require__(1057),fe=__webpack_require__(3516),Ce=__webpack_require__(7958),ye=__webpack_require__(9611),Ae=__webpack_require__(988),be=__webpack_require__(6534),Te=__webpack_require__(6915);class ve{registerActions(){this._actionManager.addAction(Ae.a.freemiumUpsellEligible,ye.a.frame,this.navigateToUpsellPage),this._actionManager.addAction(Ae.a.freemiumUpsellDialogShowUI,ye.a.frame,this.launchUpsellExperience),this._actionManager.addAction(Ae.a.reportFreemiumUpsellEligibleDisplayed,ye.a.frame,Se.ActionManager.doNothingButReportHandler),this._actionManager.addAction(Ae.a.reportFreemiumUpsellEligibleClicked,ye.a.frame,Se.ActionManager.doNothingButReportHandler),this._actionManager.addAction(Ae.a.signInNavigate,ye.a.frame,this.navigateToSignin)}getCommandArgument(e,t,n){let a=n;const i=e;return i&&i[t]&&(a=(0,_e.a)(String,i[t])),a}constructor(e){this.navigateToUpsellPage=(e,t,n,a,i)=>{if(1===n)return 32;let o=8;if(2===n){const e=this.getCommandArgument(i,"experience","gopremiumribbon");let t=ne.a.getFwLinkUrl("2116536");t=ne.a.addParameterValue(t,"ocid",fe.b(A.AFrameworkApplication.activeFrame.applicationInstance.officeAppType,A.AFrameworkApplication.activeFrame.applicationInstance.officeAppMode,e)),Ce.a.safelyOpenWindow(t,"_blank",void 0,"NavigateToUpsellPage"),o=32,this._actionManager.processAction(Ae.a.reportFreemiumUpsellEligibleClicked,2),U.ULS.sendTraceTag(38929747,340,50,"User directed to POC")}return o},this.launchUpsellExperience=(e,t,n,a,i)=>{if(1===n)return 32;let o=8;if(2===n){U.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon");const r=(0,te.h)(me.a).instance;if(r){const e=this.getCommandArgument(i,"experience","gopremium"),t=this.getCommandArgument(i,"dimeCampaignId",null);r.launchUpsellExperience(e,t),o=32}else U.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),o=this.navigateToUpsellPage(e,t,n,a,i)}return o},this.navigateToSignin=(e,t,n,a,i)=>{if(1===n)return 32;let o=8;if(2===n){const e=A.AFrameworkApplication.signInUrl,t=new Te.a(e);Ce.a.safelyOpenWindow(t.toString(),"_top",void 0,"TryMicrosoft365Button"),be.a("TryMicrosoft365Click"),o=32}return o},this._actionManager=e}}(0,s.a)(ve,"UpsellActor",null,[382]);const we=(0,te.e)(he,{onDemandRegister:(e,t)=>e.register(ve,"Common.App.Header.UpsellActor").as(t).singleInstance().usingFactory((()=>new ve(A.AFrameworkApplication.theActionManager)))});class Fe{get name(){return"Common.App.Header"}async initializeAsync(){(0,te.a)(we).registerActions();(0,te.a)(ge).registerActions()}dispose(){}configure(e){this._container=e}static main(){Z.a.instance.registerAsyncPackage(new Fe)}constructor(){this._container=null}}(0,s.a)(Fe,"CommonAppHeaderPackage",null,[24,1]);const Ie=(0,te.b)("Common.App.HostActionExecutionManager");var Ee=__webpack_require__(625),Me=__webpack_require__(6566),ke=__webpack_require__(8510);class Pe{loadSupportedHostActions(){(this._appSettingsManager.getBooleanAppSetting("DocRebootIsSupported")||this._appSettingsManager.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"))&&(this._supportedHostActions[Me.a.refresh]=e=>this.sendPostMessageForAction("App_DocReboot",e))}registerActionListener(e){e.addAction(Ae.a.raiseActionToHost,ye.a.frame,(0,Ee.a)(this,this.sendActionToHostIfSupported,"sendActionToHostIfSupported"))}sendActionToHostIfSupported(e,t,n,a,i){if(2!==n)return 32;if(!i)return U.ULS.sendTraceTag(41972610,204,15,"HostActionExecutionManager - No actionData provided"),16;let o="",r={};return i.hasOwnProperty("extraData")?(o=i.actionName.toLowerCase(),r=i.extraData??{}):o=i.toLowerCase(),this._supportedHostActions[o]?(U.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",o),this._supportedHostActions[o](r)):2}sendPostMessageForAction(e,t){const n=ke.a.createRetriableMessage(e,t,A.AFrameworkApplication.userSessionId,3);return this._hostPostMessengerFuture.execute((e=>{e.postMessage(n)})),32}constructor(e,t,n){this._supportedHostActions={},this._appSettingsManager=e,this._hostPostMessengerFuture=n,this.loadSupportedHostActions(),this.registerActionListener(t)}}(0,s.a)(Pe,"HostActionExecutionManager",null,[]);var De=__webpack_require__(4051),Re=__webpack_require__(2650);const xe=(0,te.e)(Ie,{onDemandRegister:(e,t)=>e.register(Pe,t).singleInstance().usingFactory((()=>(A.AFrameworkApplication.appSettingsManager.isFullAppSettingsReady||U.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready"),new Pe(A.AFrameworkApplication.appSettingsManager,A.AFrameworkApplication.theActionManager,(0,te.h)(Re.a))))),_ignoreOnDemandRegister:(0,De.a)(9374681)});var Le=__webpack_require__(4555);class Ue{get name(){return"Common.App.Postmessengers"}async initializeAsync(){U.ULS.sendTraceTag(508381087,204,50,"Calling init for PostMessenger {0}",Date.now());const e=A.AFrameworkApplication.appSettingsManager.getStringAppSetting("PostMessageOrigin");A.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnablePostMessengerPkgIndependentofFullAppSettingsReady",!1)&&e?(U.ULS.sendTraceTag(508372251,204,50,"Initializing PostMessenger Package at {0}",Date.now()),this.initHostPostmessenger(this._container)):A.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((()=>{U.ULS.sendTraceTag(508389594,204,50,"Initializing PostMessenger Package on Full App setting Ready at {0}",Date.now()),this.initHostPostmessenger(this._container)}))}initHostPostmessenger(e){A.AFrameworkApplication.hostPostmessenger=(0,te.a)(Le.a),A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HostActionExecutionIsEnabled")&&(0,te.a)(xe)}dispose(){}configure(e){this._container=e,e.registerOnDemandResolveToken(Le.a),e.registerOnDemandResolveToken(xe)}constructor(){this._container=null}}(0,s.a)(Ue,"PostmessengersPackage",null,[24,1]);var Oe=__webpack_require__(3323);class Be{get name(){return"Common.App.DialogWithLinkToResource"}configure(e){}async initializeAsync(){}dispose(){}static main(){Z.a.instance.registerAsyncPackage(new Be)}}(0,s.a)(Be,"CommonAppDialogWithLinkToResourcePackage",null,[24,1]);class Ne{get name(){return"Common.App.Zoom"}async initializeAsync(){}dispose(){}configure(e){this._container=e}static main(){Z.a.instance.registerAsyncPackage(new Ne)}constructor(){this._container=null}}(0,s.a)(Ne,"ZoomPackage",null,[24,1]);var We=__webpack_require__(3696),He=__webpack_require__(629),Ve=__webpack_require__(7531),Ge=__webpack_require__(1450),Qe=__webpack_require__(8706),qe=__webpack_require__(7072),Ke=__webpack_require__(6094),ze=__webpack_require__(4345);const je="DirectPrintHeaderContent";class Ze extends We.StandardDialog{displayDialog(){this.buttonsOption=5,this.width=40;const e=document.createElement("span");e.id=this.myId(je);const t=document.createElement("span");if(t.innerText=(0,P.a)("DirectPrintDialogHeader"),Sys.UI.DomElement.addCssClass(t,"DirectPrintHeader"),this._pdfObject=document.createElement("iframe"),this._pdfObject.name="pdfObjectFrame",this._pdfObject.title=(0,P.a)("DirectPrintDialogIFrame"),this._pdfObject.onload=this.printablePdfLoaded,this._sensitiveParameters&&this._sensitiveParameters.count>0){const e=ne.a.getParametersFromUrl(this._pdfUrl,this._sensitiveParameters),t=ne.a.removeParameters(this._pdfUrl,this._sensitiveParameters);this._printPreviewPostForm=document.createElement("form"),this._printPreviewPostForm.id="printPreviewPostForm",this._printPreviewPostForm.method="POST",this._printPreviewPostForm.target=this._pdfObject.name,this._printPreviewPostForm.action=t;for(const t of e){const e=document.createElement("input");e.type="hidden",e.name=t.key,e.value=t.value,this._printPreviewPostForm.appendChild(e)}}else this._pdfObject.setAttribute("src",this._pdfUrl);Sys.UI.DomElement.addCssClass(this._pdfObject,Ge.a._objectInDialogCssClass),this._hideEmbeddedPdf?(Sys.UI.DomElement.addCssClass(this._pdfObject,"DirectPrintPdfObjectHidden"),t.innerText=(0,P.a)("DirectPrintDialogSuccessText"),qe.a.setAriaAttribute(this._pdfObject,qe.a.ariaHiddenAttribute,qe.a.ariaTrueValue)):(Sys.UI.DomElement.addCssClass(this._pdfObject,"DirectPrintPdfObject"),this._validElements.push(this._pdfObject)),e.appendChild(t),e.appendChild(document.createElement("br")),e.appendChild(this._pdfObject),this._printPreviewPostForm&&e.appendChild(this._printPreviewPostForm),e.appendChild(document.createElement("br")),e.appendChild(this.constructDownloadSpan(this._printPreviewPostForm?"#":this._pdfUrl)),this._stopwatch.start(),this.messageBoxImpl((0,P.a)("AppTitle"),null,null,null,null,e),this.setDescribedByForDialog(this.myId(je)),this._printPreviewPostForm&&this._printPreviewPostForm.submit(),this.createFocusLoop(),U.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}constructDownloadSpan(e){const t=document.createElement("span"),n=document.createElement("span");if(n.innerText=(0,P.a)("DirectPrintDialogDownloadPDFHeader"),t.appendChild(n),A.AFrameworkApplication.appSettingsManager&&(2===A.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PPTDisableDirectPrintDialogDownloadPDFLink")||1===A.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("XLODisableDirectPrintDialogOpenPDFLink"))){const e=document.createElement("span");2===A.AFrameworkApplication.activeFrame.applicationInstance.officeAppType?e.innerText=(0,P.a)("DirectPrintDialogDownloadPDFLabel"):1===A.AFrameworkApplication.activeFrame.applicationInstance.officeAppType&&(e.innerText=(0,P.a)("InternalError_Directive"),U.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this._failureLink=e,t.appendChild(document.createElement("br")),t.appendChild(e)}else{const n=document.createElement("a");n.innerText=(0,P.a)("DirectPrintDialogDownloadPDFLink"),n.href=e,n.target="_blank",n.id="PrintPDFLink",n.className="AllowBrowserClick",this._failureLink=n,t.appendChild(document.createElement("br")),t.appendChild(n),this._printPreviewPostForm&&Ve.a.addHandler(n,"click",this.onSubmit),this._mouseInputManager.registerHandler(ce.a.click,this._failureLink,this.downloadPDFLinkClicked,null)}return this._validElements.push(this._failureLink),t}createFocusLoop(){if(this._validElements.length>0){const e=new Qe.a(this._validElements),t=He.FocusManager.instance().getCurrentRegion();t&&(this._failureLink.focus(),t.listing=e,t.looped=!0)}}logDownloadButtonClicked(){U.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}dispose(){this._failureLink&&(this._mouseInputManager.unregisterHandler(ce.a.click,this._failureLink,this.downloadPDFLinkClicked),this._failureLink=null),Ke.a.removeElement(this._pdfObject),this._pdfObject=null,super.dispose()}constructor(e,t,n,a=null){super(),this._failureLink=null,this._printPreviewPostForm=null,this._pdfObject=null,this._validElements=[],this.onSubmit=e=>{this._printPreviewPostForm&&(this._printPreviewPostForm.target="_blank",this._printPreviewPostForm.submit()),e.preventDefault()},this.downloadPDFLinkClicked=e=>(U.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked."),!1),this.printablePdfLoaded=()=>{U.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully"),this._stopwatch&&this._stopwatch.stop()},this._pdfUrl=t,this._mouseInputManager=e,this._hideEmbeddedPdf=n,this._sensitiveParameters=a,this._stopwatch=new ze.a("LoadResource","LoadPrintablePdf")}}(0,s.a)(Ze,"DirectPrintDialog",We.StandardDialog,[526]);class Xe{getDirectPrintDialog(e,t,n=null){return new Ze(this._mouseInputManager,e,t,n)}constructor(e){this._mouseInputManager=e}}(0,s.a)(Xe,"DirectPrintDialogFactory",null,[373]);const Je=(0,te.b)("Common.App.DirectPrint.DirectPrintDialogFactory"),Ye=(0,te.e)(Je,{onDemandSingleton:e=>new Xe(A.AFrameworkApplication.activeFrame.theMouseInputManager)});var $e=__webpack_require__(3299),et=__webpack_require__(9928);class tt{constructor(e){this.isEnabled=Boolean.parse(e.DirectPrintIsEnabled||"false"),this.isProbeEnabled=Boolean.parse(e.DirectPrintProbeIsEnabled||"false"),this.supportedMimeTypes=(e.DirectPrintSupportedMimeTypes||"").split(tt.directPrintBRSDelimeter),this.supportedPlugins=(e.DirectPrintSupportedPlugins||"").split(tt.directPrintBRSDelimeter),this.immersivePreviewPlugins=(e.DirectPrintImmersivePreviewPlugins||"").split(tt.directPrintBRSDelimeter),this.isEdgeEnabled=Boolean.parse(e.DirectPrintEnabledForEdge||"false"),this.isChromePrintLayoutFixEnabled=Boolean.parse(e.ChromePrintLayoutFixIsEnabled||"false"),this.chromeVersionFromWhichPrintLayoutIsEnabled=parseInt(e.ChromeVersionFromWhichPrintLayoutIsEnabled||"76"),this.minEdgeMajorVersion=14,this.minEdgeMinorVersion=14394;const t=e.DirectPrintMinimalSupportedEdgeVersion;if(t){const e=t.split(".");2===e.length?(this.minEdgeMajorVersion=parseInt(e[0]),this.minEdgeMinorVersion=parseInt(e[1])):U.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",t)}else U.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}tt.directPrintBRSDelimeter=",",(0,s.a)(tt,"DirectPrintBrsSettings",null,[]);class nt{constructor(e,t){this.supportedMimetypes=e,this.supportedPlugins=t}}(0,s.a)(nt,"DirectPrintProbeResults",null,[]);var at=__webpack_require__(7689),it=__webpack_require__(1163),ot=__webpack_require__(6362);class rt{get directPrintSettings(){return this._directPrintSettings}start(){}probeDirectPrintExperience(){this.directPrintSettings.isProbeEnabled&&this.logProbeResults()}querySupportedMimeTypes(){const e=new Array(this.directPrintSettings.supportedMimeTypes.length);if(!(void 0===this._navigatorMimeTypes||null===this._navigatorMimeTypes))for(let t=0;t<this.directPrintSettings.supportedMimeTypes.length;t++)e[t]=this.directPrintSettings.supportedMimeTypes[t]in this._navigatorMimeTypes&&this._isEnabledMimeType(this._navigatorMimeTypes[this.directPrintSettings.supportedMimeTypes[t]]);return e}querySupportedPlugins(){const e=new Array(this.directPrintSettings.supportedPlugins.length),t=!(void 0===this._navigatorPlugins||null===this._navigatorPlugins);for(let n=0;n<this.directPrintSettings.supportedPlugins.length;n++){const a=this.directPrintSettings.supportedPlugins[n];t&&a in this._navigatorPlugins?e[n]=!0:e[n]=this._isSupportedActiveXControl(a)}return e}getSupportedMimeTypePluginNames(){const e=this.querySupportedMimeTypes(),t=new Array(e.length);for(let n=0;n<e.length;n++)e[n]?t[n]=this.extractPluginNameFromMimeType(this._navigatorMimeTypes[this.directPrintSettings.supportedMimeTypes[n]]):t[n]=null;return t}extractPluginNameFromMimeType(e){if(null==e)return null;const t=e.enabledPlugin;return null==t?null:t.name}logProbeResults(){U.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this._probeResults.value.supportedMimetypes,this._probeResults.value.supportedPlugins)}shouldUseDirectPrint(){return!this._isWordEmbeddedPreview&&(!!this.directPrintSettings.isEnabled&&(!A.AFrameworkApplication.isUnifiedHostMode&&this.supportPluginPrint()))}shouldUseNamedAction(){return null!=this._useNamedActionForAutoPrint||(this._useNamedActionForAutoPrint=this.isChromeAndContainsPrintLayoutFix()),this._useNamedActionForAutoPrint}isChromeAndContainsPrintLayoutFix(){return!!(it.a.isChrome&&this.directPrintSettings.isChromePrintLayoutFixEnabled&&it.a.chromeRevision>=this.directPrintSettings.chromeVersionFromWhichPrintLayoutIsEnabled)}supportPluginPrint(){if(!this._isSupportedBrowser(this.directPrintSettings))return!1;const e=ot.a.getValues(this._probeResults.value.supportedMimetypes);for(const t of e)if(null!=t)return!0;const t=ot.a.getValues(this._probeResults.value.supportedPlugins);for(const e of t)if(e)return!0;return!1}hasImmersiveViewer(){const e=ot.a.getValues(this._probeResults.value.supportedMimetypes);for(const t of e)if(at.a.contains(this.directPrintSettings.immersivePreviewPlugins,t))return!0;return!1}showPrintDialog(e,t=!1,n=null,a=!1){A.AFrameworkApplication.activeFrame&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")?this._legacyDialogFactory(e,n,a):this.shouldUseDirectPrint()?this.displayDirectPrintDialog(e,this.hasImmersiveViewer()&&!t,n):this._legacyDialogFactory(e,n,a)}displayDirectPrintDialog(e,t,n=null){const a=this._stopWatchBuilder.makeAndStartStopwatch("UserAction","OpenDirectPrintDialog");this._dialogFactory.getDirectPrintDialog(e,t,n).displayDialog(),a.stop()}static isSupportedActiveXControl(e){try{return new ActiveXObject(e),!0}catch(t){U.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",e)}return!1}static isEnabledMimeType(e){return null!=e&&!(void 0===e.enabledPlugin||null===e.enabledPlugin)}static create(e){const t=new tt(A.AFrameworkApplication.appSettingsManager.appSettings);let n=null;try{n=A.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.LazyInitializePluginsAndMimeTypesForDirectPrintTelemetry",!1)?{}:window.navigator.mimeTypes}catch(e){}let a=null;try{a=A.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.LazyInitializePluginsAndMimeTypesForDirectPrintTelemetry",!1)?{}:window.navigator.plugins}catch(e){U.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const i=rt.isEnabledMimeType,o=rt.isSupportedActiveXControl,r=(0,te.a)(Ye),s=A.AFrameworkApplication.activeFrame.theStopwatchBuilder,l=rt.isSupportedBrowserCheck,c=!!A.AFrameworkApplication.activeFrame&&A.AFrameworkApplication.activeFrame.applicationInstance.isReactDialogEnabled&&!A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PrintDialogFallbackLinkEnabled"),d=A.AFrameworkApplication.isEmbedded;return new rt(t,n,a,i,o,r,s,l,((e,t,n)=>new et.a(e,!1,t,!0,c,null,n)),d)}static isSupportedBrowserCheck(e){return!!it.a.isChrome}constructor(e,t,n,a,i,o,r,s,l,c){this._useNamedActionForAutoPrint=null,this.getProbeResults=()=>{if(A.AFrameworkApplication.appSettingsManager?.getBooleanFeatureGate("Microsoft.Office.WordOnline.LazyInitializePluginsAndMimeTypesForDirectPrintTelemetry",!1)){try{this._navigatorMimeTypes=window.navigator.mimeTypes}catch(e){U.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}try{this._navigatorPlugins=window.navigator.plugins}catch(e){U.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}}const e=this.getSupportedMimeTypePluginNames(),t=this.querySupportedPlugins(),n={},a={};for(let t=0;t<this.directPrintSettings.supportedMimeTypes.length;t++)n[this.directPrintSettings.supportedMimeTypes[t]]=e[t];for(let e=0;e<this.directPrintSettings.supportedPlugins.length;e++)a[this.directPrintSettings.supportedPlugins[e]]=t[e];return new nt(n,a)},this._directPrintSettings=e,this._navigatorMimeTypes=t,this._navigatorPlugins=n,this._isEnabledMimeType=a,this._isSupportedActiveXControl=i,this._probeResults=new $e.a(this.getProbeResults),this._dialogFactory=o,this._legacyDialogFactory=l,this._stopWatchBuilder=r,this._isSupportedBrowser=s,this._isWordEmbeddedPreview=c}}(0,s.a)(rt,"DirectPrintManager",null,[374]);const st=(0,te.b)("Common.App.DirectPrint.IDirectPrintManager"),lt=(0,te.e)(st,{onDemandSingleton:e=>rt.create(e)});class ct{get name(){return"Common.App.DirectPrint"}configure(e){this._container=e}async initializeAsync(){this._directPrintManager=(0,te.a)(lt),this._directPrintManager.start()}dispose(){}constructor(){this._container=null,this._directPrintManager=null}}(0,s.a)(ct,"PackageManager",null,[24,1]);const dt=window.dynamicScriptLoaderDependencies=[{identifier:"appChrome",dependencies:["appResourceLoader","common"]},{identifier:"appResourceLoader",dependencies:[]},{identifier:"sharedComments",dependencies:["appResourceLoader","common","common50","comment-pane-strings"]},{identifier:"editorSettingsManager",dependencies:["appResourceLoader","common","common50"]},{identifier:"catchUpActivity",dependencies:["appResourceLoader","common","common50","word-catchup-activity-intl"]},{identifier:"alVoiceClient",dependencies:["appResourceLoader","common"]},{identifier:"previewPanel",dependencies:["appResourceLoader","common","common50","word-preview-panel-intl"]},{identifier:"versionHistory",dependencies:["appResourceLoader","common","common50","office-version-history-strings","friendly-dates-strings","version-history-sprite"]},{identifier:"wordVersionHistory",dependencies:["appResourceLoader","common","common50","versionHistory"]},{identifier:"floatingContainerManager",dependencies:["appResourceLoader","common","common50"]},{identifier:"canvasAtMentions",dependencies:["appResourceLoader","common","common50","comment-pane-strings","uiFabricLazy"]},{identifier:"canvasContextual",dependencies:["appResourceLoader","common","common50","uiFabricLazy"]},{identifier:"performanceMeasureAggregator",dependencies:["appResourceLoader"]},{identifier:"comment-pane-strings",isLocalized:!0},{identifier:"word-catchup-activity-intl",isLocalized:!0},{identifier:"word-preview-panel-intl",isLocalized:!0},{identifier:"office-version-history-strings",isLocalized:!0},{identifier:"accessibility-checker-pane-strings",isLocalized:!0},{identifier:"friendly-dates-strings",isLocalized:!0},{identifier:"version-history-sprite",isLocalized:!0},{identifier:"dictation-intl",isLocalized:!0},{identifier:"tellme-strings",isLocalized:!0},{identifier:"graphics-editor-intl",isLocalized:!0},{identifier:"graphics-editor-intl-lazy",isLocalized:!0},{identifier:"word-app-intl-lazy",isLocalized:!0},{identifier:"word-app-intl-mlr-lazy",isLocalized:!0},{identifier:"word-app-sprite",isLocalized:!0},{identifier:"word-app-mlr-sprite",isLocalized:!0},{identifier:"word-app-sprite-lazy",isLocalized:!0},{identifier:"word-app-mlr-sprite-lazy",isLocalized:!0},{identifier:"word-ideas-strings",isLocalized:!0},{identifier:"equation-tools-strings",isLocalized:!0}];class ut{getScriptLoader(){return this._dynamicScriptLoader}constructor(e){this._dynamicScriptLoader=e}}(0,s.a)(ut,"DynamicScriptLoaderProvider",null,[77]);var pt=__webpack_require__(884),gt=__webpack_require__(3946),ht=__webpack_require__(7146),mt=__webpack_require__(507),_t=__webpack_require__(2764);const St=(e,t)=>{const n=Ct(t);if(e.isLocalized)return A.AFrameworkApplication.scriptUrlFromName(e.identifier+n,3);const a=yt(t)+e.identifier;return A.AFrameworkApplication.scriptUrlFromName(a+n+".js",5)},ft=(e,t)=>{const n=Ct(t),a=e.identifier+n+".js";let i="";return ht.a.instance.isShippingFrom1JSEnabled?a:(e.isLocalized?i+=A.AFrameworkApplication.lcid+"/":i+=yt(t),i+a)},Ct=e=>{if(A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsCombinedBundleEnabled"))return"";let t="";return t=A.AFrameworkApplication.appSettingsManager.containsAppSetting("IsServerFlavorDebug")&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsServerFlavorDebug")?"":".min",t},yt=e=>A.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.SharedBundleBranchingLogic")?e?mt.a.getBaseURLSuffix():"":e&&!A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppChromeOverrideIsCombinedBundle")&&!A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsCombinedBundleEnabled")&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsWebpack5RibbonEnabled")?"wp5/":"",At=(e="anonymous",t="dynamicScriptLoaderDependencies")=>{const n={};return n.resolveScript=e=>{const t=gt.a.isKnownScript(n.knownScripts,e.identifier);let a;return A.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8828447_ExtractChunkNameModification")||("excel-app-intl"===e.identifier&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FluentIconsEnabled")&&(e.identifier+="-fluent"),A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FluentIconsEnabled")&&"excel-uiSlice20-sprite"===e.identifier&&(e.identifier+="-fluent")),a=gt.a.isEnabled&&t?(e=>{let t=e.isLocalized?gt.a.getLocalizationPath(A.AFrameworkApplication.lcid):gt.a.scriptPath;return e.isLocalized||(t+=yt(!0)),t+e.identifier+gt.a.fileSuffix+".js"})(e):pt.a.instance.isEnabled?((e,t)=>{if(A.AFrameworkApplication.wd1jsIsEnabled)return St(e,t);let n=A.AFrameworkApplication.staticContentScriptNameBase;const a=ft(e,t);if(pt.a.instance.isEnabled){if(ht.a.instance.isShippingFrom1JSEnabled){const e=pt.a.instance.getResourceUrlShippingFrom1JS(a);if(e)return e}const e=pt.a.instance.getHashedAppResourceHost(A.AFrameworkApplication.scriptFolderPath+a);e&&(n=e+A.AFrameworkApplication.scriptFolderPath)}return U.ULS.sendTraceTag(592228695,306,50,"Dynamic loading hashed resource for "+a),n+a})(e,t):St(e,t),a},n.resolveSriHash=e=>((e,t)=>{if(pt.a.instance.isEnabled){const n=ft(e,t);return ht.a.instance.isShippingFrom1JSEnabled?pt.a.instance.getSriHash(n):pt.a.instance.getSriHash(A.AFrameworkApplication.scriptFolderPath+n)}return null})(e,gt.a.isKnownScript(n.knownScripts,e.identifier)),n.crossOriginAttributeValue=e,n.knownScripts=window[t],n.isPreloadOptimizedEnabled=()=>A.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.DynamicScriptLoaderNewPreloadEnabled",!1),n.trustedTypesPolicy=A.AFrameworkApplication.appSettingsManager.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsLoadScriptTrustedTypesPolicyEnabled",!1)?_t.b:void 0,n};var bt=__webpack_require__(8113);class Tt{get name(){return"WordViewer.DynamicScriptLoader"}configure(e){const t=At();e.registerFactory("Common.DynamicScriptLoaderProvider",(()=>new ut(new bt.DynamicScriptLoader(t)))).as("Common.IDynamicScriptLoaderProvider").singleInstance()}init(){}dispose(){}}(0,s.a)(Tt,"DynamicScriptLoaderPackage",null,[7,1]);window.WordViewerToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordViewer",ImageDownArrow:"IMGMAP@wv@SplitButtonArrow_5x3x32",Size:"SingleDock",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Docks",attrs:{Id:"buttondocks"},children:[{name:"HeroDock",attrs:{Id:"WordViewerHeroDock",OverflowMenuImage20by20:"IMGMAP@wv@EllipsisDark_20x20x32",OverflowMenuTooltip:"STR@L_MoreOptionsMenu"},children:[{name:"Controls",attrs:{id:"ctrlStripLeft"},children:[{name:"ToggleButton",attrs:{Alt:"STR@L_AccessibilityMode",Id:"jbtnToggleViewMode",LabelText:"STR@L_AccessibilityMode",Image20by20:"IMGMAP@wv@AccessibilityGlyph_20x20x32",QueryCommand:"0x127D7696",Command:"0x9FC8F94C"}},{name:"Button",attrs:{Alt:"STR@L_ImmersiveView",Id:"btnLaunchImmersiveViewEdu",LabelText:"STR@L_ImmersiveView",Image20by20:"IMGMAP@wv@AudioReaderGlyph_20x20x32",Command:"0x72BE69D3"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_EditDocument",Command:"0x2F9A3D80",Id:"flyoutWordViewerEdit",LabelText:"STR@L_EditDocument",TextDirection:"STR@L_RibbonOptionTextDirection",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32"},children:[{name:"Menu",attrs:{Id:"menuEdit"},children:[{name:"MenuSection",attrs:{Id:"menuSectionEdit",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlsEdit"},children:[{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnFlyoutEditOnWeb",LabelText:"STR@L_EditInBrowser",Description:"STR@L_EditInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0x13A057F4"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnFlyoutConvertToEditOnWeb",LabelText:"STR@L_EditInBrowser",Description:"STR@L_EditInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0x3809D3C2"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnFlyoutCopyAndEdit",LabelText:"STR@L_EditInBrowser",Description:"STR@L_EditInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",QueryCommand:"0x313544DC",Command:"0x68562DD8"}},{name:"Button",attrs:{Alt:"STR@L_OpenInWord",Id:"btnEditInClient",LabelText:"STR@L_OpenInWord",Description:"STR@L_EditInWordDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_OpenDocument",Command:"0x2F9A3D80",Id:"flyoutWordViewerOpen",LabelText:"STR@L_OpenDocument",TextDirection:"STR@L_RibbonOptionTextDirection",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32"},children:[{name:"Menu",attrs:{Id:"menuOpen"},children:[{name:"MenuSection",attrs:{Id:"menuSectionOpen",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlsOpen"},children:[{name:"Button",attrs:{Alt:"STR@L_OpenInWord",Id:"btnOpenInClientBig",LabelText:"STR@L_OpenInWord",Description:"STR@L_EditInWordDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0xD5DF198A"}},{name:"Button",attrs:{Alt:"STR@L_InteractiveViewInBrowser",Id:"btnFlyoutInteractiveViewOnWeb",LabelText:"STR@L_InteractiveViewInBrowser",Description:"STR@L_ViewInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0x13A057F4"}}]}]}]}]},{name:"Button",attrs:{Alt:"STR@L_EditInWord",Id:"btnPdfConvertAndEdit",LabelText:"STR@L_EditInWord",Command:"0xCAD15C25",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInWord",Id:"btnPdfCopyAndEdit",LabelText:"STR@L_EditInWord",Command:"0xFAA71D53",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_OpenInWord",Id:"btnOpenInClient",LabelText:"STR@L_OpenInWord",Command:"0xD5DF198A",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_InteractiveViewInBrowser",Id:"btnInteractiveViewOnWeb",LabelText:"STR@L_InteractiveViewInBrowser",Command:"0x13A057F4",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnEditOnWeb",LabelText:"STR@L_EditInBrowser",Command:"0x13A057F4",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnConvertToEditOnWeb",LabelText:"STR@L_EditInBrowser",Command:"0x3809D3C2",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnCopyAndEdit",LabelText:"STR@L_EditInBrowser",Command:"0x68562DD8",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",QueryCommand:"0x313544DC",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_SaveAndEditTranslatedDocumentButtonAltText",Id:"btnSaveAndEdit",LabelText:"STR@L_EditInBrowser",Command:"0xAADCE5C8",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32"}},{name:"Button",attrs:{Id:"jbtnTranslateDocumentBack",LabelText:"STR@L_TranslateBackToOriginal",Image20by20:"IMGMAP@wv@Translator_20x20x32",Command:"0x22335D57"}},{name:"Button",attrs:{Alt:"STR@L_Download",Id:"btnDownloadWithWord",LabelText:"STR@L_Download",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Alt:"STR@L_SaveToCloudStorage",Id:"btnSaveToCloudStorage",LabelText:"STR@L_SaveToCloudStorage",Image20by20:"IMGMAP@wv@SkyDriveCloud_20x20x32",Command:"0x24D132C8"}},{name:"Button",attrs:{Id:"btnPrintToPdf",LabelText:"STR@L_Print",Alt:"STR@L_PrintToPdf",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnDirectPrint",LabelText:"STR@L_DirectPrintJewelButton",Alt:"STR@L_DirectPrintJewelDescription",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnPrintPdfFile",LabelText:"STR@L_Print",Alt:"STR@L_PrintToPdf",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnDirectPrintPdfMode",LabelText:"STR@L_DirectPrintJewelButton",Alt:"STR@L_DirectPrintJewelDescription",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnjClose",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Image20by20:"IMGMAP@wv@CloseGlyphServer_20x20x32"}},{name:"Button",attrs:{Id:"HostConversation",Command:"0x2A5FDD0D",LabelText:"STR@L_Conversation",Image20by20:"IMGMAP@wv@ConversationWord_20x20x32"}},{name:"Button",attrs:{Id:"HostOpenInBrowser",Command:"0x9ACA3153",LabelText:"STR@L_OpenInBrowser",Image20by20:"IMGMAP@wv@Word_20x20x32"}},{name:"Button",attrs:{Alt:"STR@L_Share",Id:"btnFileSharing",LabelText:"STR@L_Share",Image20by20:"IMGMAP@wv@ShareServer_20x20x32",Command:"0x3A7DFAA4"}},{name:"ToggleButton",attrs:{Alt:"STR@L_OpenCommentPane",Id:"btnOpenCommentPane",LabelText:"STR@L_OpenCommentPane",Image20by20:"IMGMAP@wv@CommentsGlyphGrey_20x20x32",Command:"0x87F614C3",QueryCommand:"0x3282B935",UsePseudoCheckMark:"true"}},{name:"ToggleButton",attrs:{Alt:"STR@L_OpenSearchPane",Id:"btnOpenSearchPane",LabelText:"STR@L_OpenSearchPane",Image20by20:"IMGMAP@wv@FindGlyphServer_20x20x32",Command:"0x3A32DAF4",QueryCommand:"0x4CD7FCB8",UsePseudoCheckMark:"true"}},{name:"Button",attrs:{Alt:"STR@L_ImmersiveView",Id:"btnLaunchImmersiveViewNonEdu",LabelText:"STR@L_ImmersiveView",Image20by20:"IMGMAP@wv@AudioReaderGlyph_20x20x32",Command:"0x72BE69D3"}},{name:"Button",attrs:{Id:"jbtnTranslateDocument",LabelText:"STR@L_TranslateDocument",Image20by20:"IMGMAP@wv@Translator_20x20x32",Command:"0x9BB3ABA5"}},{name:"Button",attrs:{Id:"jbtnFileVersion",LabelText:"STR@L_PreviousVersions",Image20by20:"IMGMAP@wv@VersionsServer_20x20x32",Command:"0xDB70177B"}},{name:"Button",attrs:{Alt:"STR@L_Download",Id:"overflowbtnDownloadWithWord",LabelText:"STR@L_Download",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Id:"jbtnDownloadATranslatedCopy",LabelText:"STR@L_Download",Description:"STR@L_DownloadDescription",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0x3E4AEF42"}},{name:"Button",attrs:{Alt:"STR@L_Download",Id:"btnDownloadPdf",LabelText:"STR@L_Download",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Id:"jbtnDownloadAsPdf",LabelText:"STR@L_DownloadAsPDF",Description:"STR@L_DownloadAsPDFDescription",Image20by20:"IMGMAP@wv@PDFGlyph_20x20x32",Command:"0x5887FF04"}},{name:"Button",attrs:{Id:"jbtnFileEmbed",LabelText:"STR@L_Embed",Image20by20:"IMGMAP@wv@EmbedServer_20x20x32",Command:"0x66DDFD86"}},{name:"Button",attrs:{Id:"jbtnHelp",LabelText:"STR@L_HelpButtonTitle",Image20by20:"IMGMAP@wv@OfficeAssistantServerDark_20x20x32",Command:"0x56B04A51"}},{name:"Button",attrs:{Id:"jbtnAccessibilityHelp",LabelText:"STR@L_AccessibilityHelp",Image20by20:"IMGMAP@wv@GeneralAccessibilityGlyph_20x20x32",Command:"0xC34BD836"}},{name:"Button",attrs:{Id:"jbtnGiveFeedback",LabelText:"STR@L_GiveFeedback",Image20by20:"IMGMAP@wv@FeedbackGlyph_20x20x32",Command:"0x2FD6BDE0"}},{name:"Button",attrs:{Id:"jbtnTermsOfUse",LabelText:"STR@L_TermsOfUse",Image20by20:"IMGMAP@wv@InfoGlyphServer_20x20x32",Command:"0x8C0EBBB3"}},{name:"Button",attrs:{Id:"jbtnPrivacy",LabelText:"STR@L_Privacy",Image20by20:"IMGMAP@wv@PrivacyGlyphServer_20x20x32",Command:"0x48091446"}},{name:"Button",attrs:{Id:"jbtnReportAbuse",LabelText:"STR@L_ReportAbuse",Image20by20:"IMGMAP@wv@AbuseGlyph_20x20x32",Command:"0xC0F351AE"}},{name:"Button",attrs:{Id:"jbtnAccessibility",LabelText:"STR@L_AccessibilityMode",Image20by20:"IMGMAP@wv@AccessibilityGlyph_20x20x32",Command:"0x583F2602"}},{name:"Button",attrs:{Id:"jbtnAccessibilityPdf",LabelText:"STR@L_AccessibilityMode",Image20by20:"IMGMAP@wv@AccessibilityGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Alt:"STR@L_SyncToPresenter",Id:"btnSyncToPresenter",LabelText:"STR@L_SyncToPresenter",Image20by20:"IMGMAP@wv@SyncToPresenterServer_20x20x32",Command:"0xC79FFB5C"}},{name:"Button",attrs:{Alt:"STR@L_OpenSharedNotes",Id:"btnOpenSharedNotes",LabelText:"STR@L_OpenSharedNotes",Image20by20:"IMGMAP@wv@SharedNotesGlyph_Grey_20x20x32",Command:"0xE6ACD19C"}},{name:"Button",attrs:{Id:"jbtnTrustCenter",LabelText:"STR@l_TrustCenter",Image20by20:"IMGMAP@wv@PrivacyGlyphServer_20x20x32",Command:"0x9A00EB4E"}}]}]}]}]}]},window.WordViewerStatusBarDataV2={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"StatusBar",attrs:{Id:"WordViewerStatusBar",ImageDownArrow:"IMGMAP@wv@StatusBarDownArrowGrey_5x3x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",LabelText:"STR@L_StatusBarLabel"},children:[{name:"Docks",attrs:{Id:"buttondocks"},children:[{name:"ButtonDock",attrs:{Id:"buttonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"buttonDockLeftControls"},children:[{name:"Label",attrs:{Id:"WordIcon",Image16by16:"IMGMAP@wv@Word_14x14x32",DisplayMode:"Small14"}},{name:"Label",attrs:{Id:"PageInfoLabel",LabelText:"",QueryCommand:"0x42EB999E",DisplayMode:"Medium14"}},{name:"Label",attrs:{Id:"ClassificationLabel",Alt:"",LabelText:"",Image16by16:"IMGMAP@wv@MarkAsProtected14",Command:"0xCC509ABF",QueryCommand:"0x1DACE7EE",DisplayMode:"Medium14",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"buttonDockCenter",Alignment:"Center"},children:[{name:"Controls",attrs:{id:"buttonDockCenterControls"},children:[{name:"Label",attrs:{Id:"EnvironmentLabel",QueryCommand:"0xE7B52458",LabelText:"",DisplayMode:"Medium14",Visible:"false"}},{name:"Label",attrs:{Id:"PresenterPageLabel",LabelText:"",QueryCommand:"0x37D5C13B",DisplayMode:"Medium14"}}]}]},{name:"ButtonDock",attrs:{Id:"buttonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"buttonDockRightControls"},children:[{name:"Button",attrs:{Id:"GiveFeedback",Alt:"STR@L_HelpImproveOffice",Command:"0x2FD6BDE0",LabelText:"STR@L_GiveFeedback",DisplayMode:"Medium14"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_CurrentZoom",Command:"0x2F9A3D80",Id:"ZoomFlyout",PopulateDynamically:"true",PopulateQueryCommand:"0x5D7E84A8",PopulateOnlyOnce:"true",QueryCommand:"0x19D00622",LabelText:""}},{name:"Button",attrs:{Id:"buttonShowZoomDialog",Alt:"STR@L_ZoomTooltip",Command:"0x6797D208",LabelText:"100%",QueryCommand:"0x19D00622",DisplayMode:"Medium14"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_ControlMenu",Command:"0x2F9A3D80",Id:"ControlMenu",PopulateDynamically:"false",PopulateOnlyOnce:"false",Image16by16:"IMGMAP@wv@sbMenuGrey_14x14x32",DisplayMode:"Small14"},children:[{name:"Menu",attrs:{Id:"menuEmbeddedControls"},children:[{name:"MenuSection",attrs:{Id:"msControlMenu1"},children:[{name:"Controls",attrs:{Id:"msControlMenu.Controls"},children:[{name:"Button",attrs:{MenuItemId:"DownloadACopy",Id:"DownloadACopy",Command:"0xD3EF8F78",LabelText:"STR@L_DownloadACopy",Alt:"STR@L_DownloadACopy"}},{name:"Button",attrs:{MenuItemId:"PrintPDF",Id:"PrintPDF",Command:"0xC6003374",LabelText:"STR@L_PrintPDF",Alt:"STR@L_PrintPDF"}},{name:"ToggleButton",attrs:{MenuItemId:"AccessibleMode",Id:"AccessibleMode",Command:"0x9FC8F94C",LabelText:"STR@L_AccessibilityMode",Alt:"STR@L_AccessibilityMode",QueryCommand:"0x127D7696"}},{name:"Button",attrs:{MenuItemId:"ImmersiveView",Alt:"STR@L_ImmersiveView",Id:"btnLaunchImmersiveViewEdu",LabelText:"STR@L_ImmersiveView",Command:"0x72BE69D3"}}]}]},{name:"MenuSection",attrs:{Id:"msControlMenu2"},children:[{name:"Controls",attrs:{Id:"msControlMenu.Controls"},children:[{name:"Button",attrs:{MenuItemId:"DocumentInformation",Id:"DocumentInformation",Command:"0xAC76EB12",LabelText:"STR@L_DocumentInformation",Alt:"STR@L_DocumentInformation"}}]}]},{name:"MenuSection",attrs:{Id:"msControlMenu3"},children:[{name:"Controls",attrs:{Id:"msControlMenu.Controls"},children:[{name:"Button",attrs:{Id:"msControlMenu.Controls.GiveFeedback",LabelText:"STR@L_GiveFeedback",Command:"0x2FD6BDE0",DisplayMode:"Medium14"}},{name:"Button",attrs:{MenuItemId:"TermsOfUse",Id:"TermsOfUse",Command:"0x8C0EBBB3",LabelText:"STR@L_TermsOfUse",Alt:"STR@L_TermsOfUse"}},{name:"Button",attrs:{MenuItemId:"Privacy",Id:"Privacy",Command:"0x48091446",LabelText:"STR@L_Privacy",Alt:"STR@L_Privacy"}}]}]}]}]},{name:"Button",attrs:{Alt:"STR@L_FullScreen",Id:"fseaFullScreen",LabelText:"STR@L_FullScreen",Command:"0xAFAE8F6F",DisplayMode:"Small14",Image16by16:"IMGMAP@wv@FullScreenAttendee_14x14x32"}}]}]}]}]}]};var vt={};vt.ClientUtils=function(){var e,t,n,a,i,o,r,s,l,c="SharePoint.OpenDocuments.5",d="SharePoint.OpenDocuments.4",u="SharePoint.OpenDocuments.3",p="SharePoint.OpenDocuments.2",g="application/x-sharepoint",h="application/x-sharepoint-webkit",m="application/x-sharepoint-protocolhandler",_="application/x-sharepoint-webkit-protocolhandler",S="application/officelive",f="npSharePointPlugin",C="IDBHO.IDBHOCtrl",y="OneNote.Notebook",A="ofs|t|",b="nft|",T="ofv|",v="ofc|",w="ofe|",F="u|",I="|f|",E="wdlor",M="or|",k="cid|",P="ct|",D="RoamingOfficeActiveX.RoamingOffice",R="",x="",L="";var U={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},O={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},B={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},N={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},W={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};function H(){return Boolean(o)||(o=!0,r=Q("Windows NT")),r>=6.1&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(Z()||ee()||Y())}function V(){return window.navigator.userAgent.indexOf("Windows")>=0}function G(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function Q(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;return null!=t&&t.length>=2&&(n=parseFloat(t[1]),isNaN(n)&&(n=-1)),n}function q(){return Boolean(s)||(s=!0,l=Q("Windows Phone")),l>=8}function K(){return"function"==typeof navigator.msLaunchUri&&!G()&&!$()&&!j()}function z(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function j(){return window.navigator.userAgent.indexOf("Edge/")>=0}function Z(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function X(){return!!Z()&&8==window.document.documentMode}function J(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function Y(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function $(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("android")>=0&&e.indexOf("chrome")>=0}function ee(){return function(){if(J())return ne("firefox/");return 0}()>=3}function te(){return function(){if(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0)return ne("version/");return 0}()>=3}function ne(e){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf(e);if(n>=0){var a=n+e.length,i=t.length;return parseInt(t.substring(a,i))}return 0}function ae(e,t,n,a,i){a&&null!=t?t():K()?navigator.msLaunchUri(e,t,n):!Y()&&!(window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0||navigator.maxTouchPoints>0&&z())||j()?oe(e,t,n):function(e){return Y()&&e}(i)?function(e,t,n){try{window.open(e,"_self")}catch(e){return void(null!=n&&n())}null!=t&&t()}(e,t,n):ie(e,t,n)}function ie(e,t,n){var a="OICLinkTag",o=document.getElementById(a);null==o&&((o=document.createElement("a")).id=a,o.style.visibility="hidden",o.href="",0==(i.Options&O.SupportsTopTargetNavigation)||i.NoBrowserModalDialogs?o.target="_blank":o.target="_top",document.body.appendChild(o),null!=o.addEventListener&&o.addEventListener("click",(function(e){null!=e.stopPropagation&&e.stopPropagation()}),!1));try{o.href=e,o.dispatchEvent(new MouseEvent("click"))}catch(e){return void(null!=n&&n())}null!=t&&t()}function oe(e,t,n){var a="OICFrame",i=document.getElementById(a);null==i&&((i=document.createElement("iframe")).className="ObjectInDialog",i.style.visibility="hidden",i.src="about:blank",document.body.appendChild(i),i.id=a);try{i.contentWindow.location.href=e}catch(e){return void(null!=n&&n())}null!=t&&t()}function re(e){return 0!=(e.Options&O.SkipProtocolHandler)||X()}function se(e){return!re(e)&&(!!function(e){return z()&&(e.Application==W.OneNote||fe(m,!1)||fe(_,!1))}(e)||(!!K()||(!!$()||(!(le()||"ActiveXObject"in window&&!G()||Y())||Fe()>=15))))}function le(){return z()&&(ee()||te())||ee()}function ce(e){return e===U.ReadOnly||e===U.ReadWrite}function de(e,t,n,a,o){e==W.Visio&&n==U.ReadWrite&&(n=U.WriteOnly);var r,s,l,c,d=o;if(!(a=a||G()&&!q())){var u="";e==W.PowerPoint?u+=(r=i.DocumentExtension,s=ce(n),l=new Set([".pot",".potm",".potx"]),c=new Set([".pps",".ppsm",".ppsx"]),s&&l.has(r)?b+v:s&&c.has(r)?T+A:!s&&c.has(r)?w+A:s?T+v:w):ce(n)?u+=T+v:u+=w;var p=i.SessionOrigin?M+i.SessionOrigin+"|":"";p+=i.ClickTime?P+i.ClickTime+"|":"",u+=pe(p+=i.CorrelationId?k+i.CorrelationId+"|":""),d+=pe(u+=F)}d+=pe(t);var g=function(e,t){var n=e.toLowerCase().indexOf("&"+t+"=");if(-1==n)return;var a=n+(t.length+2),i=e.indexOf("&",a);if(-1==i)return e.substr(a);return e.substring(a,i)}(window.location.href,E);if(null!=g&&void 0!==g){var h="";try{h=decodeURIComponent(g)}catch(e){}h.length>0&&function(e){return RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(e)}(h)&&(d+=I,d+=h)}return d}function ue(e,t,n,a,o,r){var s=be(e);return null==s?(we(i.DescriptiveUnattemptedEnums?B.ProtocolHandlerIsNull:B.Unattempted,i.Application),!1):(ae(de(e,t,n,a,s),ge,he,o,r),!0)}function pe(e){if(z()&&Y()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function ge(){ve(N.ProtocolHandler)}function he(){i.Options|=O.SkipProtocolHandler,Te(i,e,t)}function me(){null!=n&&n(N.RoamingProtocolHandler)}function _e(){null!=a&&a(B.ControlNeeded)}function Se(){var e=document.getElementById(f);if(null==e){var t=g;if(z()&&te()&&Ce(h)&&(t=h),!Ce(t)){if(!z()||!Ce(S))return null;t=S}var n=document.createElement("object");n.id=f,n.type=t,n.style.width="0px",n.style.height="0px",n.style.setProperty("visibility","hidden",""),document.body.appendChild(n),e=document.getElementById(f)}return e}function fe(e,t){var n=window.navigator.mimeTypes;if(null==n)return!1;var a=n[e];return!!a&&!(t&&!a.enabledPlugin)}function Ce(e){return fe(e,!0)}function ye(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function Ae(e){return e===W.OneNote?y:""}function be(e){if(e!=W.OneNote&&G()&&!q())return"office:";switch(e){case W.Excel:return"ms-excel:";case W.OneNote:return"onenote:";case W.PowerPoint:return"ms-powerpoint:";case W.Visio:return"ms-visio:";case W.Word:return"ms-word:";case W.Project:return"ms-project:";case W.Publisher:return"ms-publisher:";case W.Infopath:return"ms-infopath:";case W.Access:return"ms-access:";default:return""}}function Te(n,a,o){if(i=n,e=a,t=o,n.DocumentUrl){var r,s=n.DocumentUrl,l=n.DocumentUrl,g=n.DocumentUrl;try{g=decodeURIComponent(n.DocumentUrl)}catch(e){}try{l=encodeURI(n.DocumentUrl)}catch(e){}if(s=s+""+n.CorrelationIdForWinClient,g+=n.CorrelationIdForWinClient,l+=n.CorrelationIdForWinClient,n.Mode===U.ReadWrite&&O.CheckoutRequired===(n.Options&O.CheckoutRequired)&&(n.Mode=U.ForceCheckout),O.HostIsEditOnly===(n.Options&O.HostIsEditOnly)&&(n.Mode=U.WriteOnly),se(n))ue(n.Application,n.EncodeUrl?l:s,n.Mode,n.Application==W.OneNote,n.SilentExternalHandler,n.NavigateUsingWindowOpen);else if(X()&&function(e,t,n,a){try{var i=new ActiveXObject(c);if(i)return i.ViewDocument3(window.self,e,t,a)}catch(e){}return!1}(n.EncodeUrl?s:g,n.Mode,n.Options,Ae(n.Application)))ve(N.O15ActiveX);else if(le()?r=function(e,t,n){var a=Se();if(null==a)return i.DescriptiveUnattemptedEnums?B.PluginIsNull:B.Unattempted;var o=!1;try{o=a.ViewDocument3(window.self,e,t,n)}catch(e){}if(!o)try{o=ce(t)?a.ViewDocument2(window.self,e,n):a.EditDocument2(window.self,e,n)}catch(e){}return o?(ve(N.NpapiPlugin),B.None):B.Failed}(n.EncodeUrl?s:g,n.Mode,Ae(n.Application)):(!function(){try{var e=new ActiveXObject(C);null!=e&&e.SaveSSOCreds()}catch(e){}}(),r=function(e,t,n,a){var o;try{if(o=new ActiveXObject(d))return o.ViewDocument3(window.self,e,t,a)?(ve(N.O14ActiveX),B.None):B.Failed}catch(e){}if(O.O14Only===(n&O.O14Only))return i.DescriptiveUnattemptedEnums?B.O14AttemptFailure:B.Unattempted;try{if(o=new ActiveXObject(u))return o.ViewDocument3(window.self,e,t,a)?(ve(N.O12ActiveX),B.None):B.Failed}catch(e){}if(O.O12UpOnly===(n&O.O12UpOnly))return i.DescriptiveUnattemptedEnums?B.O12UpOnlyFail:B.Unattempted;try{if(o=new ActiveXObject(p))return(ce(t)?o.ViewDocument2(window.self,e,a):o.EditDocument2(window.self,e,a))?(ve(N.O11ActiveX),B.None):B.Failed}catch(e){}return i.DescriptiveUnattemptedEnums?B.ActiveXUnattempted:B.Unattempted}(n.EncodeUrl?s:g,n.Mode,n.Options,Ae(n.Application))),r!=B.None){if(n.CouldUseRoamingApps&&H()&&n.Application!=W.OneNote){if(!vt.ClientUtils.CanUseRoamingControl())return void we(B.ControlNeeded,i.Application);if(n.RoamingAppsLauncher)return void function(n){void 0!==n.RoamingAppsLauncher&&null!=n.RoamingAppsLauncher?void 0===n.RoamingBitsUrl||null==n.RoamingBitsUrl?vt.ClientUtils.LaunchRoamingApps(n.DocumentUrl,n.RoamingAppsLauncher,n.Application,n.ApplicationParameters,e,t):vt.ClientUtils.LaunchRoamingApps2(n.DocumentUrl,n.RoamingAppsLauncher,n.RoamingApplicationExe,n.ApplicationParameters,n.RoamingPlatform,n.RoamingBitsUrl,e,t):we(i.DescriptiveUnattemptedEnums?B.RoamingLauncherIsNull:B.Unattempted,i.Application)}(n);if(!n.ContinueIfLauncherIsNull)return void we(B.LauncherNeeded,i.Application)}if(O.NoProtocolHandlerFallback!=(n.Options&O.NoProtocolHandlerFallback)&&!re(n)&&!Z()&&(!z()||function(e){if(i.DescriptiveUnattemptedEnums)return e>=B.O14Unattempted&&e<=B.DocumentUrlIsNull;return e==B.Unattempted}(r)))return void ue(n.Application,n.EncodeUrl?l:s,n.Mode,n.Application==W.OneNote,n.SilentExternalHandler,n.NavigateUsingWindowOpen);we(r,i.Application)}}else we(i.DescriptiveUnattemptedEnums?B.DocumentUrlIsNull:B.Unattempted,i.Application)}function ve(t){null!=e&&e(t)}function we(e,n){void 0===n&&(n=null),null!=t&&t(e,n)}function Fe(){var e=0;if(le()||Y()){var t=Se();try{null!=t&&(e=t.GetOfficeVersion())}catch(e){}}else ye(c)?e=15:ye(d)?e=14:ye(u)?e=12:ye(p)&&(e=11);return e}function Ie(){return z()&&(Ce(g)||Ce(h))}return{OpenDocumentMode:U,OpenDocumentOptions:O,OpenDocumentFailureType:B,OpenDocumentControl:N,OfficeApplication:W,EditDocumentInClient:Te,EditDocumentInClientParams:function(){this.DocumentUrl="",this.Mode=0,this.Options=0,this.Application=W.Unknown,this.CouldUseRoamingApps=!1,this.RoamingAppsLauncher="",this.ContinueIfLauncherIsNull=!1,this.ApplicationParameters="",this.RoamingPlatform="",this.RoamingApplicationExe="",this.RoamingBitsUrl="",this.SilentExternalHandler=!1,this.EncodeUrl=!1,this.CorrelationIdForWinClient="",this.NavigateUsingWindowOpen=!1,this.DescriptiveUnattemptedEnums=!1,this.NoBrowserModalDialogs=!1,this.CorrelationId="",this.ClickTime="",this.SessionOrigin="",this.DocumentExtension=""},OfficeVersionInstalled:Fe,IsO14MacPluginInstalled:Ie,OfferOfficeInDialog:function(){return V()&&Fe()<=11},OfferOfficeNoIntrusive:function(){return V()&&Fe()<15},OfferMacOffice:function(){return z()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!Ie()},InstallRoamingControl:function(){J()?window.InstallTrigger.install({Office:{URL:x}}):oe(L,null,null)},CanUseRoamingControl:function(){if(K())return!0;if(Y())return void 0!==navigator.plugins.refresh&&navigator.plugins.refresh(!1),Boolean(navigator.mimeTypes["application/x-vnd.officeondemand"]);if(J()){var e=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(e);var t=document.createEvent("Events");return t.initEvent("RoamingOfficeInstalled",!0,!1),e.dispatchEvent(t),Boolean(e.getAttribute("installed"))}if(Z())try{return new ActiveXObject(D).HrExists()}catch(e){}return!1},InitUrls:function(e,t,n){R=e,x=n,L=t},LaunchRoamingApps:function(e,t,n,a,i,o){vt.ClientUtils.LaunchRoamingApps2(e,t,function(e){switch(e){case W.Excel:return"root\\office15\\excel.exe";case W.PowerPoint:return"root\\office15\\powerpnt.exe";case W.Visio:return"root\\office15\\visio.exe";case W.Word:return"root\\office15\\winword.exe";case W.Project:return"root\\office15\\winproj.exe";case W.Publisher:return"root\\office15\\mspub.exe";case W.Infopath:return"root\\office15\\infopath.exe";case W.Access:return"root\\office15\\msaccess.exe";default:return null}}(n),a,"x86",R,i,o)},LaunchRoamingApps2:function(e,t,i,o,r,s,l,c){var d="";if(null!=o&&(d+=" "+o),null!=e&&(d+=' "'+e+'"'),K()||Y()){n=l,a=c;var u="office:";u+=' "'+s+'"',u+=' "'+i+'"',u+=' "ROAMING"',u+=' "'+t+'"',u+=' "'+r+'"',ae(u+=" "+d,me,_e,!1,!1)}else if(J()){var p=document.createElement("RoamingExtensionElement");p.setAttribute("cabUrl",s),p.setAttribute("app",i),p.setAttribute("licensingEntitlements",t),p.setAttribute("platform",r),p.setAttribute("args",d),document.documentElement.appendChild(p);var g=document.createEvent("Events");g.initEvent("RoamingOfficeLaunch",!0,!1),p.dispatchEvent(g),null!=l&&l(N.RoamingFFExtension)}else if(Z()){var h=new ActiveXObject(D);if(null!=h)try{h.HrConfigureSingle(s,i,t,r,d),null!=l&&l(N.RoamingActiveX)}catch(e){}}else null!=c&&c(B.Failed)},ShouldShowDialog:function(){return!G()},NavigateToUrlUsingClickingOnATag:ie,OpenDocumentWithProtocolHandler:ue,OpenDocumentWithProtocolHandlerNoCallBack:function(e,t,n,a){var o=be(e);return null==o?(we(i.DescriptiveUnattemptedEnums?B.ProtocolHandlerNoCallbackIsNull:B.Unattempted,i.Application),!1):(ae(de(e,t,n,a,o),null,null,!1,!1),!0)}}}(),vt.ClientUtils=vt.ClientUtils;var wt=__webpack_require__(6921);class Ft{}Ft.trace=U.ULS.sendTraceTag,(0,s.a)(Ft,"UULS",null,[]);const It=(0,te.b)("Common.IRootManager");var Et=__webpack_require__(8304);const Mt=(0,te.e)(It,{onDemandRegister:(e,t)=>e.register(Et.a,"CommandUI.RootManager").as(t).singleInstance().usingFactory((()=>Et.a.instance)),_ignoreOnDemandRegister:(0,De.a)(9374753)});var kt=__webpack_require__(8765),Pt=__webpack_require__(5374),Dt=__webpack_require__(5072),Rt=__webpack_require__(9123);class xt{get inMoveMode(){return this._inMoveMode}enterMoveMode(e){e?(this._target=e,this._inMoveMode=!0,this._shouldExit=!1,this._keyInputManager.capture((0,Ee.a)(this,this.keyEventHandler,"keyEventHandler"),null),this._pointerInputManager.registerHandler(ce.a.pointerDown,this._frameElement,this.pointerDownHandler),this._moveIcon||this.createMoveIcon(),this._target.appendChild(this._moveIcon),this.initializeCurrentPosition()):U.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}exitMoveMode(){this._inMoveMode=!1,this._currentPosition=null,this._startingPosition=null,this.removeMoveIcon(),this.releaseHandlers(),this._target=null}releaseHandlers(){this._keyInputManager.releaseCapture(),this._pointerInputManager.unregisterHandler(ce.a.pointerDown,this._frameElement,this.pointerDownHandler)}initializeCurrentPosition(){if(this._target.style.left.endsWith("px")&&this._target.style.right.endsWith("px"))this._currentPosition=new Sys.UI.Point(Rt.a.parseIntDefaultZero(this._isRTL?this._target.style.right:this._target.style.left),Rt.a.parseIntDefaultZero(this._target.style.top));else{const e=this._isRTL?this._frameElement.offsetWidth-(this._target.offsetLeft+this._target.offsetWidth+Rt.a.parseIntDefaultZero(this._target.style.marginRight)):this._target.offsetLeft-Rt.a.parseIntDefaultZero(this._target.style.marginLeft),t=this._target.offsetTop-Rt.a.parseIntDefaultZero(this._target.style.marginTop);this.setStylePosition(e,t),this._currentPosition=new Sys.UI.Point(e,t)}this._startingPosition=this._currentPosition}createMoveIcon(){this._moveIcon=Pt.a(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}removeMoveIcon(){this._moveIcon.parentNode===this._target&&this._target.removeChild(this._moveIcon)}keyEventHandler(e){if(!this.inMoveMode)return!1;if(e.innerEvent.preventDefault(),e.eventName===ce.a.keyDown){const t=e.innerEvent.ctrlKey?1:10;let n;switch(e.innerEvent.keyCode){case Dt.a.vK_UpArrow:this.moveElement(0,-1*t);break;case Dt.a.vK_DownArrow:this.moveElement(0,1*t);break;case Dt.a.vK_LeftArrow:n=this._isRTL?1:-1,this.moveElement(n*t,0);break;case Dt.a.vK_RightArrow:n=this._isRTL?-1:1,this.moveElement(n*t,0);break;case Dt.a.vK_Esc:this.moveElementTo(this._startingPosition.x,this._startingPosition.y),this._shouldExit=!0;break;case Dt.a.vK_Enter:this._shouldExit=!0}}return e.eventName===ce.a.keyUp&&this._shouldExit&&this.exitMoveMode(),!0}moveElement(e,t){const n=this._currentPosition.x+e,a=this._currentPosition.y+t;this.moveElementTo(n,a)}moveElementTo(e,t){const n=this.adjustPositionForAppFrameBounds(e,t);this.setStylePosition(n.x,n.y),this._currentPosition=n}setStylePosition(e,t){this._isRTL?this._target.style.right=e+"px":this._target.style.left=e+"px",this._target.style.top=t+"px"}adjustPositionForAppFrameBounds(e,t){const n=this._isRTL?Rt.a.parseIntDefaultZero(this._target.style.marginRight):Rt.a.parseIntDefaultZero(this._target.style.marginLeft),a=this._frameElement.offsetWidth-this._target.offsetWidth-n,i=Math.min(Math.max(-n,e),a),o=Rt.a.parseIntDefaultZero(this._target.style.marginTop),r=this._frameElement.offsetHeight-this._target.offsetHeight-o,s=Math.min(Math.max(-o,t),r);return new Sys.UI.Point(i,s)}constructor(e,t,n){this._target=null,this._moveIcon=null,this._startingPosition=null,this._currentPosition=null,this._shouldExit=!1,this._inMoveMode=!1,this.pointerDownHandler=e=>!!this.inMoveMode&&(e.innerEvent.preventDefault(),this.exitMoveMode(),!0),this._frameElement=e,this._keyInputManager=t,this._pointerInputManager=n,this._isRTL=A.AFrameworkApplication.isRtl}}(0,s.a)(xt,"KeyMoveAdapter",null,[187]);var Lt=__webpack_require__(2544),Ut=__webpack_require__(9855);const Ot=(0,te.e)(kt.a,{onDemandRegister:(e,t)=>e.register(187,t).singleInstance().usingFactory((()=>new xt(A.AFrameworkApplication.activeFrame.getDOMElement(),Lt.a.instance,Ut.a.instance))),_ignoreOnDemandRegister:(0,De.a)(9374753)});var Bt=__webpack_require__(346),Nt=__webpack_require__(7977),Wt=__webpack_require__(3909),Ht=__webpack_require__(7693),Vt=__webpack_require__(2980),Gt=__webpack_require__(3455),Qt=__webpack_require__(1903),qt=__webpack_require__(1694),Kt=__webpack_require__(6662);class zt{get control(){return this._control}get stateProperties(){return this.control.stateProperties}get root(){return this.control.root}get parentMenu(){return this.control.parentMenu}get activatesOnPress(){return this.control.activatesOnPress}get displayedComponent(){return this.control.displayedComponent}get controlComponentDomCache(){return this.control.controlComponentDomCache}attachEvents(e){}initialize(){}doDefaultAction(e,t,n){this.control.doDefaultActionPublic(e,t,n)}pollForStateAndUpdate(){Qt.d(this.control.controlProperties.Command)||this.pollForStateAndUpdateInternal(this.control.controlProperties.Command,null,null)}pollForStateAndUpdateInternal(e,t,n){let a=0;return this.root&&(a=this.root.pollForCommandState(e,t,n)),this.control.enabled=(1&a)>0,a}updateVisibility(){let e=this.control.visible;return this.root.supportsInvisibleControls&&(e=this.stateProperties[qt.a.visible],e!==this.control.visible&&(this.control.visible=e,this.root.needRefresh=!0)),e}updateLabelText(){const e=Kt.a.validateStringProperty(this.stateProperties[qt.a.labelText],this.control.controlProperties.LabelText);this.setLabelText(e)}setLabelText(e){this.control.labelText!==e&&(this.controlComponentDomCache.forEach((t=>{t.setLabelText(e)})),this.control.labelText=e,this.root.needScaling=!0)}updateTooltip(){const e=Kt.a.validateStringProperty(this.stateProperties[qt.a.alt],this.control.controlProperties.Alt);this.setTooltip(e)}setTooltip(e){this.control.tooltip!==e&&(this.controlComponentDomCache.forEach((t=>{t.setTooltip(e)})),this.control.tooltip=e)}updateImage(){const e=Kt.a.validateStringProperty(this.stateProperties[Wt.a.Image16by16Class],this.control.controlProperties.Image16by16Class),t=Kt.a.validateStringProperty(this.stateProperties[Wt.a.Image32by32Class],this.control.controlProperties.Image32by32Class),n=Kt.a.validateStringProperty(this.stateProperties[Wt.a.Image48by48Class],this.control.controlProperties.Image48by48Class),a=Qt.b(n)?t:n;this.applyImageCssClass(this.controlComponentDomCache.small,e),this.applyImageCssClass(this.controlComponentDomCache.medium,e),this.applyImageCssClass(this.controlComponentDomCache.large,t),this.applyImageCssClass(this.controlComponentDomCache.smallMenu,e),this.applyImageCssClass(this.controlComponentDomCache.largeMenu,a)}applyImageCssClass(e,t){e&&(Qt.d(e.elmImage)||Qt.d(t)||e.elmImage.className===t||(e.elmImage.className=t))}updateDisplayMode(e){if(!Qt.b(e))if(this.root.supportsDynamicDisplayMode){let t=!1;for(const n of this.control.components){const a=n.displayMode===e;a&&(t=!0,this.control.activeComponentWhenVisible=n),this.control.visible&&(n.visibleInDOM=a)}this.control.visible&&(this.root.needScaling=!0)}else 0}adjustLayoutForLargeMenu(){if(this.controlComponentDomCache.largeMenu&&this.controlComponentDomCache.largeMenu.elmLabel&&this.controlComponentDomCache.largeMenu.elmDescription){const e=this.controlComponentDomCache.largeMenu.elmLabel,t=Kt.a.validateStringProperty(this.stateProperties[Ht.a.Description],this.control.controlProperties.Description);Qt.b(t)&&(e.style.position="relative",e.style.top=(e.parentNode.offsetHeight-e.offsetHeight)/2+"px",e.style.padding="0px")}}onFocus(e){const t=this.displayedComponent;return(0,i.a)(Vt.a,t)?this.parentMenu.updateFocusedIndex(t):this.root.controlWithFocus=this.control,!1}onBlur(e){const t=this.displayedComponent;return this.control.isStandardMenuItem()&&Kt.a.removeCSSClassFromElement(t.elementInternal,"cui-ctl-menu-hovered-without-focus"),this.root.controlWithFocus=null,!1}onPointerOver(e){if(this.control.isStandardMenuItem()){const t=this.parentMenu.stackIndex,n=t===this.root.menuStackDepth-1,a=n?null:this.root.menuLauncherStack[t+1];this.closeChildMenus(!1),n||this.control===a||Kt.a.removeCSSClassFromElement(a.launcher,Gt.a.menuDroppedClassName),this.control.enabled&&this.control.focusableElement?n?this.control.setFocusOnControl():(Kt.a.ensureCSSClassOnElement(this.displayedComponent.elementInternal,"cui-ctl-menu-hovered-without-focus"),a.elmHadFocus=this.control.focusableElement):n?this.parentMenu.setFocus(e.inputSource):(a.elmHadFocus=this.parentMenu.elementInternal,this.parentMenu.resetFocusedIndex())}return!1}onPointerOut(e){return this.control.isStandardMenuItem()&&Kt.a.removeCSSClassFromElement(this.displayedComponent.elementInternal,"cui-ctl-menu-hovered-without-focus"),!1}onKeyDown(e){let t=!1;if(!Qt.d(e.innerEvent)&&!Qt.d(e.innerEvent.rawEvent)){const n=e.innerEvent.rawEvent,a=e.innerEvent.keyCode,o=n.shiftKey;if(a===Sys.UI.Key.enter&&(t=!0),(0,i.a)(Vt.a,this.displayedComponent)){const e=this.parentMenu;if(!Qt.d(e)){const n=e.stackIndex,i=0===this.root.textDirection,r=!Qt.d(this.control.parentGrid);if(a!==Sys.UI.Key.tab&&a!==Sys.UI.Key.left&&a!==Sys.UI.Key.right&&a!==Sys.UI.Key.up&&a!==Sys.UI.Key.down&&a!==Sys.UI.Key.esc)return t;Ce.a.clearSelectionIfNecessary(),a!==Sys.UI.Key.tab||o?a===Sys.UI.Key.tab&&o?(e.focusNext(1),t=!0):a===Sys.UI.Key.left&&i||a===Sys.UI.Key.right&&!i?(r?e.focusNext(2):n>0&&this.root.closeMenuStackAtIndex(n,!0,!1),t=!0):a===Sys.UI.Key.right&&i||a===Sys.UI.Key.left&&!i?(r&&e.focusNext(4),t=!0):a===Sys.UI.Key.up?(e.focusNext(5),t=!0):a===Sys.UI.Key.down?(e.focusNext(6),t=!0):a===Sys.UI.Key.esc&&(this.root.closeMenuStackAtIndex(n,!0,!1),t=!0):(e.focusNext(0),t=!0)}}}return t}onKeyUp(e){let t=!1;if(!Qt.d(e.innerEvent)&&!Qt.d(e.innerEvent.rawEvent)){const n=e.innerEvent.rawEvent,a=e.innerEvent.keyCode;n.shiftKey;Lt.a.hasKeyModifiers(e)||a!==Sys.UI.Key.enter&&a!==Sys.UI.Key.space||(t=this.handleDefaultActionWithKeytips(e),t||(this.doDefaultAction(e.sourceElement,1,e.innerEvent),t=!0))}return t}onPointerDown(e){if(this.commitRootPendingChanges(),this.activatesOnPress){let t=!0;2===e.inputSource&&(t=e.mouseButton===Sys.UI.MouseButton.leftButton),t&&this.displayedComponent&&this.activateElement(this.displayedComponent.elementInternal)}return(e.innerEvent.type.toLowerCase()!==ce.a.touchStart||this.activatesOnPress)&&e.innerEvent.preventDefault(),!1}get isCommitChangeFixEnabled(){return this._isCommitChangeFixEnabled}enableCommitChangeFix(){this._isCommitChangeFixEnabled=!0}commitRootPendingChanges(){this.isCommitChangeFixEnabled&&this.control.root.commitAnyPendingChange()}onPointerUp(e){let t=!1;return(0,i.a)(Vt.a,this.displayedComponent)&&!this.activatesOnPress&&2===e.inputSource&&e.mouseButton===Sys.UI.MouseButton.leftButton?(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),t=!0):t=this.control.deactivateElement(e),t}onClick(e){let t=!1;return(0,i.a)(Vt.a,this.displayedComponent)&&!this.activatesOnPress&&3===e.inputSource&&(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),t=!0),!it.a.isIPad&&t}onTouchMove(e){return this.onActivePointerMove(e)}onTouchEnd(e){return this.deactivateElement(e),!1}onActivePointerMove(e){if(!Qt.d(this._activeElement)){const t=Ce.a.isPointInBounds(this.activeElementBounds,e.clientPoint);return this.setActiveElementHovered(t),!0}return!1}onModalBodyPointerDown(e){let t=!1;if(this.deactivateElement(e)&&(t=!0),3!==e.inputSource){let e=!0;!this.root&&zt.nullCheckRootInOnModalBodyPointerDownIsEnabled&&(U.ULS.sendTraceTag(588084884,207,50,"Root is null"),e=!1),e&&this.root.closeAllMenus(),t=!0}return t}onModalBodyPointerUp(e){return this.deactivateElement(e)}onModalBodyPointerMove(e){return this.onActivePointerMove(e)}onModalBodyPointerOut(e){return this.deactivateElement(e)}onModalBodyClick(e){return 3===e.inputSource&&(this.root.closeAllMenus(),!0)}onModalBodyMouseWheel(e){return!1}get activeElementBounds(){return!Qt.d(this._activeElement)&&Qt.d(this._activeElementBounds)&&(this._activeElementBounds=Ce.a.getElementBounds(this._activeElement)),this._activeElementBounds}setActiveElementHovered(e){this._activeElementHovered!==e&&(this._activeElementHovered=e,this.activeElementStateChanged(this._activeElementHovered))}activeElementStateChanged(e){Qt.d(this._activeElement)||Kt.a.toggleCSSClassOnElement(this._activeElement,Nt.a.activeClassName,e)}activateElement(e){this.control.enabled&&(this._activeElement=e,this.root.activeControl=this.control,this.setActiveElementHovered(!0),this.root.beginModal(this.control,!1))}deactivateElement(e){if(!Qt.d(this._activeElement)){this.setActiveElementHovered(!1);let t=!!this.root;if(zt.nullCheckRootInOnModalBodyPointerDownIsEnabled){const e=parseInt(this.control.controlProperties.Command),n=Se.ActionManager.actionIdResolver(e)||"";U.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",t,n)}if(t&&this.root.endModal(this.control,!1),!Qt.d(e)){const t=e.clientPoint;Ce.a.isPointInBounds(this.activeElementBounds,t)&&this.doDefaultAction(this._activeElement,e.inputSource,e.innerEvent)}return t=!!this.root,zt.nullCheckRootInOnModalBodyPointerDownIsEnabled&&U.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",t),t&&(this.root.activeControl=null),this._activeElement=null,this._activeElementBounds=null,!0}return!1}focusNext(e){const t=this.displayedComponent;return!(!(0,i.a)(Vt.a,t)||2===e||4===e||Ce.a.isActiveElement(this.control.focusableElement))&&this.setFocusOnControl()}setFocusOnControl(){try{if(this.control.visible){const e=this.control.focusableElement;if(!Qt.d(e))return e.focus(),!0}}catch(e){0}return!1}closeChildMenus(e){const t=this.parentMenu;Qt.d(t)||this.root.closeMenuStackAtIndex(t.stackIndex+1,e)}onMenuClosed(){}handleDefaultActionWithKeytips(e){return!1}getTelemetryData(e){let t=null;return e&&e.rawEvent&&(t={},t[zt.triggerTime]=e.rawEvent.timeStamp),t}static get nullCheckRootInOnModalBodyPointerDownIsEnabled(){return null==zt._nullCheckRootInOnModalBodyPointerDownIsEnabled&&(zt._nullCheckRootInOnModalBodyPointerDownIsEnabled=!!A.AFrameworkApplication.appSettingsManager&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NullCheckRootInOnModalBodyPointerDownIsEnabled")),zt._nullCheckRootInOnModalBodyPointerDownIsEnabled}constructor(e){this._isCommitChangeFixEnabled=!1,this._activeElement=null,this._activeElementBounds=null,this._activeElementHovered=!1,this._control=e}}zt.triggerTime="TriggerTime",zt._nullCheckRootInOnModalBodyPointerDownIsEnabled=null,(0,s.a)(zt,"ControlBehavior",null,[472]);var jt=__webpack_require__(8585),Zt=__webpack_require__(4706);class Xt extends zt{get button(){return this.control}get properties(){return this.control.controlProperties}attachEvents(e){const t=e.elmControl,n=e.displayMode;Qt.d(t)||(le.a.instance.registerHandler(ce.a.focus,t,(0,Ee.a)(this,this.onFocus,"onFocus")),le.a.instance.registerHandler(ce.a.blur,t,(0,Ee.a)(this,this.onBlur,"onBlur")),Ut.a.instance.registerHandler(ce.a.pointerOver,t,(0,Ee.a)(this,this.onPointerOver,"onPointerOver")),Ut.a.instance.registerHandler(ce.a.pointerOut,t,(0,Ee.a)(this,this.onPointerOut,"onPointerOut")),Lt.a.instance.registerHandlerWithData(ce.a.keyDown,t,(0,Ee.a)(this,this.onKeyDown,"onKeyDown"),n),Lt.a.instance.registerHandlerWithData(ce.a.keyPress,t,(0,Ee.a)(this,this.onKeyPress,"onKeyPress"),n),Lt.a.instance.registerHandlerWithData(ce.a.keyUp,t,(0,Ee.a)(this,this.onKeyUp,"onKeyUp"),n),Ut.a.instance.registerHandler(ce.a.pointerDown,t,(0,Ee.a)(this,this.onPointerDown,"onPointerDown")),Ut.a.instance.registerHandler(ce.a.pointerUp,t,(0,Ee.a)(this,this.onPointerUp,"onPointerUp")),jt.a.instance.registerHandler(ce.a.click,t,(0,Ee.a)(this,this.onClick,"onClick")),Zt.a.instance.registerHandler(ce.a.touchMove,t,(0,Ee.a)(this,this.onTouchMove,"onTouchMove")),Zt.a.instance.registerHandler(ce.a.touchEnd,t,(0,Ee.a)(this,this.onTouchEnd,"onTouchEnd")))}doDefaultAction(e,t,n){if(this.control.enabled){let e=null;if(this.displayedComponent&&this.displayedComponent.isMenuItem()&&this.parentMenu){const t=this.parentMenu.stackIndex;e=this.root.menuLauncherStack[t],e&&!this.isCommitChangeFixEnabled&&(e.selectDropdownItem(this.button),e=null)}this.executeCommand(this.control.controlProperties.Command,t,!0,n),e&&e.selectDropdownItem(this.button)}}executeCommand(e,t,n,a){if(!Qt.d(e)){const i=this.stateProperties;i.CommandValueId=this.button.getCommandValueId(),i.MenuItemId=this.button.getMenuItemId(),i.SourceControlId=this.control.id,this.root.executeCommand(e,i,this.displayedComponent,t,n,null,this.getTelemetryData(a))}}pollForStateAndUpdate(){if(!Qt.d(this.control.controlProperties.Command)){if((2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0){this.updateVisibility()&&this.updateHtml()}}}updateHtml(){this.updateLabelText(),this.updateTooltip(),this.updateImage()}onFocus(e){return super.onFocus(e),this.startLivePreview(),!1}onBlur(e){return super.onBlur(e),this.endLivePreview(),!1}onKeyDown(e){let t=super.onKeyDown(e);if(!Qt.d(e.innerEvent)){const n=e.userData,a=e.innerEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(n,a)&&(t=!1)}return t}onKeyPress(e){let t=!1;if(!Qt.d(e.innerEvent)&&!Qt.d(e.innerEvent.rawEvent)){const n=e.userData,a=e.innerEvent.rawEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(n,a)?(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),t=!0):e.innerEvent.preventDefault()}return t}shouldDoDefaultActionOnKeyPress(e,t){return!1}onKeyUp(e){let t=!1;if(!Qt.d(e.innerEvent)){const n=e.userData,a=e.innerEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(n,a)||(t=super.onKeyUp(e))}return t}startLivePreview(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}endLivePreview(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}constructor(e){super(e)}}(0,s.a)(Xt,"ButtonBehavior",zt,[]);var Jt=__webpack_require__(3360),Yt=__webpack_require__(2666),$t=__webpack_require__(1825);const en="cui-colorpicker-hoveredOver",tn="cui-colorpicker-selected";class nn extends zt{get colorPicker(){return this.control}get colorCells(){return this.colorPicker.colorPickerDom.colorCells}get properties(){return this.colorPicker.controlProperties}doDefaultAction(e,t,n){if(this.control.enabled){const a=nn.getNearestContainingParentElementOfType(e,"td"),i=this.stateProperties;i.Color=a[Jt.a.colorInformation];let o=null;if(Kt.a.isTrue(this.properties.Stateful)&&this.displayedComponent&&this.displayedComponent.isMenuItem()&&this.parentMenu){const e=this.parentMenu.stackIndex;o=this.root.menuLauncherStack[e]}0,this.root.executeCommand(this.properties.Command,i,this.displayedComponent,t,!0,null,this.getTelemetryData(n)),o&&o.selectDropdownItem(this.colorPicker)}}pollForStateAndUpdate(){const e=this.stateProperties;e.SourceControlId=this.properties.Id;if((2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,e))>0){let e=-1;if(Yt.a.IndexColorSelected in this.stateProperties&&(e=this.stateProperties[Yt.a.IndexColorSelected]),e!==this._selectedIndex){const t=this.colorCells;0<=e&&e<t.length&&this.updateCellSelection(t[e],!0),0<=this._selectedIndex&&this._selectedIndex<t.length&&this.updateCellSelection(t[this._selectedIndex],!1),this._selectedIndex=e}}}updateCellSelection(e,t){t?Kt.a.ensureCSSClassOnElement(e,tn):Kt.a.removeCSSClassFromElement(e,tn)}attachEvents(e){const t=e;for(let e=0;e<t.aTags.length;++e){const n=t.aTags[e];le.a.instance.registerHandler(ce.a.focus,n,(0,Ee.a)(this,this.onCellFocus,"onCellFocus")),le.a.instance.registerHandler(ce.a.blur,n,(0,Ee.a)(this,this.onCellBlur,"onCellBlur")),Lt.a.instance.registerHandler(ce.a.keyDown,n,(0,Ee.a)(this,this.onKeyDown,"onKeyDown")),Lt.a.instance.registerHandler(ce.a.keyUp,n,(0,Ee.a)(this,this.onKeyUp,"onKeyUp")),jt.a.instance.registerHandler(ce.a.click,n,(0,Ee.a)(this,this.onCellClick,"onCellClick")),Ut.a.instance.registerHandler(ce.a.pointerUp,n,(0,Ee.a)(this,this.onCellPointerUp,"onCellPointerUp")),Ut.a.instance.registerHandler(ce.a.pointerOver,n,(0,Ee.a)(this,this.onCellPointerOver,"onCellPointerOver")),Ut.a.instance.registerHandler(ce.a.pointerDown,n,(0,Ee.a)(this,this.onCellPointerDown,"onCellPointerDown"))}}onCellFocus(e){const t=nn.getNearestContainingParentElementOfType(e.sourceElement,"td");return this.parentMenu.updateFocusedIndex(this.displayedComponent),this.updateCellFocus(t,!0),!0}onCellBlur(e){const t=nn.getNearestContainingParentElementOfType(e.sourceElement,"td");return this.updateCellFocus(t,!1),!0}updateCellFocus(e,t){t?(this._focusedIndex=parseInt(e.getAttribute("arrayPosition")),Kt.a.ensureCSSClassOnElement(e,en),this.startLivePreview(e)):(this._focusedIndex=-1,this.endLivePreview(e),Kt.a.removeCSSClassFromElement(e,en))}onCellClick(e){return 3===e.inputSource&&this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),!0}onCellPointerUp(e){return 3!==e.inputSource&&this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),!0}onCellPointerOver(e){this.closeChildMenus(!1);const t=nn.getNearestContainingParentElementOfType(e.sourceElement,"td"),n=parseInt(t.getAttribute("arrayPosition"));return this.setFocusOnCell(n),!0}onCellPointerDown(e){return!1}startLivePreview(e){if(this.control.enabled){0;const t=this.properties.CommandPreview;if(!Qt.b(t)){const n=this.stateProperties;n.Color=e[Jt.a.colorInformation],this.root.executeCommand(t,n,this.displayedComponent,0,!1)}}}endLivePreview(e){if(this.control.enabled){const t=this.properties.CommandRevert;if(!Qt.b(t)){const n=this.stateProperties;n.Color=e[Jt.a.colorInformation],this.root.executeCommand(t,n,this.displayedComponent,0,!1)}}}focusNext(e){const t=$t.a.focusNextIndexInGrid(this._focusedIndex,this.colorPicker.width,this.colorCells.length,e);return!(t===this._focusedIndex||!this.setFocusOnCell(t))||(this.updateCellFocus(this.colorCells[this._focusedIndex],!1),!1)}setFocusOnControl(){return this.setFocusOnCell(0)}setFocusOnCell(e){if(this.colorCells&&this.colorCells.length>e){const t=this.colorCells[e];if(t.firstChild)return t.firstChild.focus(),!0}return!1}onMenuClosed(){-1!==this._focusedIndex&&this.updateCellFocus(this.colorCells[this._focusedIndex],!1)}static getNearestContainingParentElementOfType(e,t){return nn.getNearestContainingParentElementOfTypes(e,[t])}static getNearestContainingParentElementOfTypes(e,t){const n=t.length;if(!e)return null;for(let a=0;a<n;a++)if(e.tagName.toLowerCase()===t[a].toLowerCase())return e;let a=e.parentNode;for(;a;){for(let e=0;e<n;e++)if(a.tagName.toLowerCase()===t[e].toLowerCase())return a;a=a.parentNode}return null}constructor(e){super(e),this._focusedIndex=-1,this._selectedIndex=-1}}(0,s.a)(nn,"ColorPickerBehavior",zt,[]);var an=__webpack_require__(6295),on=__webpack_require__(8979),rn=__webpack_require__(4733);class sn{}sn.Callback="action",(0,s.a)(sn,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var ln=__webpack_require__(6336);const cn="msCSSOMElementFloatMetrics";class dn{ensureUsingFloatMetrics(){this._usingFloatMetrics||(this._savedFloatMetricsState=this._floatMetricsGetter(),this._floatMetricsSetter(!0)),this._usingFloatMetrics=!0}doneUsingFloatMetrics(){this._usingFloatMetrics&&this._floatMetricsSetter(this._savedFloatMetricsState),this._usingFloatMetrics=!1}dispose(){this.doneUsingFloatMetrics()}static create(){return new dn(dn.getUsingCssFloatMetrics,dn.setUsingCssFloatMetrics)}static getUsingCssFloatMetrics(){return window.document[cn]}static setUsingCssFloatMetrics(e){window.document[cn]=e}constructor(e,t){this._savedFloatMetricsState=!1,this._usingFloatMetrics=!1,this._floatMetricsGetter=e,this._floatMetricsSetter=t,this.ensureUsingFloatMetrics()}}(0,s.a)(dn,"CssFloatMetricsActivator",null,[11]);var un=__webpack_require__(7183),pn=__webpack_require__(2950);class gn{setFlyoutCoordinates(e,t,n,a){if(Qt.d(e)||Qt.d(t))return null;const i=new pn.a;let o,r;const s=a.x,l=a.y,c=a.width,d=a.height;let u=gn.dictToInt(t,"flyoutWidth");const p=gn.dictToInt(t,"flyoutRealHeight"),g=gn.dictToInt(t,"viewportWidth"),h=gn.dictToInt(t,"viewportHeight"),m=gn.dictToInt(t,"viewableLeft"),_=gn.dictToInt(t,"viewableTop"),S=this._textDirectionLtr;let f=!1,C=!1;const y=1===n,A=4===n,b=this._isAppDivSyndicated;if(e.style.maxHeight="none",e.style.top="0px",e.style.overflowY="visible",e.style.width="auto",u=this.measureWidth(e),i.viewPortHeight=h,i.viewPortWidth=g,y)S?o=s+c:(o=s-u,i.launchedLeft=!0),r=l;else{let t="";c>u&&(u=c,t=(u-2*un.a.menuBorderPx).toString()),S?o=s:(o=s+c-u,i.launchedLeft=!0),r=l+d,""!==t&&(e.style.minWidth=t+"px")}b&&(r+=_,o+=m),e.style.top=r+"px",e.style.left=o+"px";let T=!1,v=!1;u<=g?o+u>m+g?(y&&S&&s-u>m||A&&s-u>m?(o=s-u,b&&(o+=m),i.launchedLeft=!0,v=!0):(o=m+g-u,f=!0),T=!0):o<m&&(y&&!S&&s+c+u<m+g?(o=s+c,b&&(o+=m),i.launchedLeft=!1,v=!0):(o=m,C=!0,i.launchedLeft=!0),T=!0):S?(o=m,T=!0,i.launchedLeft=!0):(o=m+g-u,T=!0,i.launchedLeft=!1),T&&(e.style.left=o+"px");const w=r+p<=_+h;if(i.flyoutTop=r,!w||3===n){i.launchedUp=!0;const{newFlyoutTop:t,flyoutMaxHeight:a,isFixedToBottom:o,isScrollable:d}=this.fitFlyoutVertically(n,r,p,l,_,h);r!==t&&(e.style.top=t+"px",i.flyoutTop=t),a>-1&&(e.style.maxHeight=a+"px"),o&&(e.style.bottom="0px",e.style.height="auto"),d&&this.makeFlyoutScrollable(e,S,y,v,C,f,g,s,c)}return i.flyoutLeft=o,i.flyoutWidth=u,i.flyoutHeight=p,i}fitFlyoutVertically(e,t,n,a,i,o){let r,s,l,c;r=t,s=-1,l=!1,c=!1;const d=t,u=i+o-t;t=a-n;const p=this._isAppDivSyndicated;let g=!1;t<0&&(t=i);let h=a;p||(h-=i);if(!(n<=h)||1===e){if(4===e||1===e){n<o?(t=o-n,l=!0):(t=i,l=!0,c=!0,g=!0)}else{h<u&&3!==e?(t=d,l=!0):s=h,c=!0}}return p&&(l=!1,g?s=o:t+=i),r=t,{newFlyoutTop:r,flyoutMaxHeight:s,isFixedToBottom:l,isScrollable:c}}makeFlyoutScrollable(e,t,n,a,i,o,r,s,l){if(e.style.overflowY="scroll",e.style.width="auto",t){if(o||a){const t=o?0:r-s;e.style.left="",e.style.right=t+"px"}}else if(!i&&!a){const t=n?r-s:r-s-l;e.style.left="",e.style.right=t+"px"}}getDimensionsForMenu(e){const t={};if(Qt.d(e))return t;t.viewportWidth=Ke.a.getViewPortWidth(),t.viewportHeight=Ke.a.getViewPortHeight(),Qt.d(t.viewportWidth)&&(t.viewportWidth=document.documentElement.clientWidth,t.viewportHeight=document.documentElement.clientHeight),Qt.d(t.viewportWidth)&&(t.viewportWidth=document.body.clientWidth,t.viewportHeight=document.body.clientHeight),t.viewableTop=window.pageYOffset,t.viewableLeft=window.pageXOffset,Qt.d(t.viewableTop)&&(t.viewableTop=document.documentElement.scrollTop,t.viewableLeft=document.documentElement.scrollLeft),Qt.d(t.viewableTop)&&(t.viewableTop=document.body.scrollTop,t.viewableLeft=document.body.scrollLeft),e.scrollHeight!==e.offsetHeight?t.flyoutRealHeight=e.scrollHeight+2*un.a.menuBorderPx:t.flyoutRealHeight=e.scrollHeight;const n=e.style.overflowY;return e.style.overflowY="visible",t.flyoutWidth=this.measureWidth(e),e.style.overflowY=n,t}measureWidth(e){return e.offsetWidth}static dictToInt(e,t){return Qt.d(e)?0:e[t]}constructor(e,t){this._textDirectionLtr=e,this._isAppDivSyndicated=t}}(0,s.a)(gn,"MenuPositioner",null,[]);var hn=__webpack_require__(5755),mn=__webpack_require__(8002),_n=__webpack_require__(4773),Sn=__webpack_require__(6161),fn=__webpack_require__(1827),Cn=__webpack_require__(6728),yn=__webpack_require__(143);class An extends zt{get menuPositioner(){return this._menuPositioner}get menuLauncher(){return this.control}get properties(){return this.control.controlProperties}get menu(){return this.menuLauncher.menu}set menu(e){this.menuLauncher.menu=e}get menuLaunched(){return this.menuLauncher.menuLaunched}set menuLaunched(e){this.menuLauncher.menuLaunched=e}get backFrame(){return Qt.d(this._elmBackFrame)&&(this._elmBackFrame=An.createHiddenIframeElement()),this._elmBackFrame}get shouldRestoreFocusToApp(){return!this.root.inModalMode}doDefaultAction(e,t,n){this.menuLauncher.launchMenu(t)}launchMenu(e){if(!this.menuLauncher.enabled||this.menuLaunched)return;const t=on.a.instance.startActivity(Ae.a.launchMenu);t.properties.add("Id",this.menuLauncher.controlProperties.Id),t.properties.add("InputMethod",an.a[e]),t.end(),be.b("LaunchMenu",!0,0,[{name:"MenuId",string:this.menuLauncher.controlProperties.Id}]),ln.a.mark(10326),Ce.a.measureTimeToNextFrame(this.menuLauncher.controlProperties.Id,"MenuOpen"),this.menuLauncher.focusableElement&&(this.menuLauncher.elmHadFocus=Ce.a.getActiveElement(this.menuLauncher.focusableElement.ownerDocument)),this._menuInvocationMethod=e,this.populateAndPositionMenu(e),this.sendNotifyAsyncMenuTrigger(),this.menuLauncher.updateAriaMenuLauncherAttributes(this.menuLauncher.focusableElement,!0)}sendNotifyAsyncMenuTrigger(){Qt.d(this.properties.PopulateAsyncTriggerCommand)||this._hasAsyncCallbackBeenSentToHandler||(this.notifyAsyncMenuTrigger(),this._hasAsyncCallbackBeenSentToHandler=!0)}notifyAsyncMenuTrigger(){const e={};e[sn.Callback]=(0,Ee.a)(this,this.refreshMenuCallback,"refreshMenuCallback"),this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,e,this.displayedComponent,0,!1)}refreshMenuCallback(){this.menuLauncher.refreshMenu()}refreshMenu(){this.menuLaunched&&this.populateAndPositionMenu(this._menuInvocationMethod,!0)}populateAndPositionMenu(e,t=!1){let n=!0;if(Kt.a.isTrue(this.properties.PopulateDynamically)){let a=!1;const i=this.pollForDynamicMenu(e);i!==this._lastDynamicPopulationXml&&(a=this.populateMenuFromXml(i,t)),n=a||!this.menuLaunched}if(n){const t=A.AFrameworkApplication.activeFrame.theStopwatchBuilder;let n=null;t&&(n=t.makeAndStartStopwatch("LoadResource","Menu Initialization")),this.initializeMenu(e),n&&n.stop(),this.onMenuChanged()}}addDarkModeClassToMenu(){if("HeaderToolbarSectionsFlyout"===this.menuLauncher.id||"HeaderToolbarOptions"===this.menuLauncher.id){const e="FishbowlManualColors";Kt.a.ensureCSSClassOnElement(this.menu.elementInternal,"ThemedFishbowl");const t=appChrome.api.isSharedUXDarkModeOn();Kt.a.toggleCSSClassOnElement(this.menu.elementInternal,e,t)}}initializeMenu(e){if(Qt.d(this.menu))return void ln.a.mark(10327);if(this.menuLauncher.parentKeytipsIds){const e=this.menuLauncher.displayedComponent;if(e&&e.keytip){const t=e.keytip.key.toLocaleLowerCase();this.menu.setParentKeytipsIdsForMenuItems(String.format("{0} {1}",this.menuLauncher.parentKeytipsIds,e.keytip.elementId),this.menuLauncher.parentKeytipsKeys&&""!==this.menuLauncher.parentKeytipsKeys?String.format("{0}-{1}",this.menuLauncher.parentKeytipsKeys,t):t)}}if(this.menu.ensureRefreshed(),Kt.a.ensureCSSClassOnElement(this.menu.elementInternal,this.menuLauncher.additionalMenuCssClass),A.AFrameworkApplication.appSettingsManager.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.HeaderFooterOverlayDarkMode")){"Word"===A.AFrameworkApplication.sessionStartInfoSettings.Application&&this.addDarkModeClassToMenu()}const t=3===e||this.root.touchModeForcedOn;if(Kt.a.toggleCSSClassOnElement(this.menu.elementInternal,"cui-touch",t),!this.menu.hasItems())return void ln.a.mark(10327);this.menu.attachEvents();const n=this.displayedComponent;n.ensureChildren(),n.ignoreDirtyingEvents=!0,n.addChild(this.menu),n.ignoreDirtyingEvents=!1,this.menu.pollIfRootPolledSinceLastPoll();const a=(0,i.a)(yn.a,this.root);let o=null,r=!1;a&&(o=this.root,r=o.shouldHandleElementResize,o.shouldHandleElementResize=!1);const s=this.menu.elementInternal;s.style.visibility="hidden",s.style.position="absolute",s.style.top="0px",s.style.left="0px",document.body.appendChild(s),this.adjustMenuLayout(),this.positionMenu(s),Kt.a.ensureCSSClassOnElement(this.menuLauncher.launcher,Gt.a.menuDroppedClassName);const l=this.root.menuStackDepth;this.shouldGoModal&&this.root.beginModal(this.control,!0),s.style.zIndex=String(A.AFrameworkApplication.activeFrame.activeModalUIZIndex),this.root.addMenuLauncherToStack(this.menuLauncher),this.menu.stackIndex=l,s.style.visibility="visible";const c=this.getChildElementsToAnimate();if((0,i.a)(fn.a,this.menu)){s.style.position="fixed";const e=this.root.menuLauncherStack[0];e&&e.menu&&e.menu.elementInternal?100!==Ce.a.getOpacity(this.root.menuLauncherStack[0].menu.elementInternal)&&rn.a.showMenu(s,c,this.afterShowMenu):rn.a.showMenu(s,c,this.afterShowMenu)}else rn.a.showMenu(s,c,this.afterShowMenu);this.menuLaunched=!0,this.menu.launched=!0,!it.a.isIPad&&this.menuLauncher.sendFocusToMenuDrop&&this.menu.setFocus(e),a&&(o.shouldHandleElementResize=r);const d=this.properties.CommandMenuOpen;Qt.b(d)||this.root.executeCommand(d,null,n,e,!1),ln.a.mark(10327)}onMenuChanged(){}addAndPositionBackFrame(){this._pendingBackFrameTimeoutId=Kt.a.cancelPendingTimeout(this._pendingBackFrameTimeoutId),this._pendingBackFrameTimeoutId=window.setTimeout(this.addAndPositionBackFrameInternal,50)}positionBackFrame(){const e=this.backFrame,t=this.menu.elementInternal;e.style.position="absolute",e.style.visibility="hidden",e.style.left=t.style.left,e.style.right=t.style.right,e.style.top=t.style.top,e.style.bottom=t.style.bottom,e.style.width=t.offsetWidth+"px",e.style.height=t.offsetHeight+"px",e.style.visibility="visible"}get shouldGoModal(){return!this.root.menuStackDepth}getChildElementsToAnimate(){const e=this.menu.children,t=[];if((0,i.a)(Sn.a,this.menu))for(let n=0;n<e.count;n++){const a=e.get_item(n);Array.add(t,a.separator);for(let e=0;e<a.children.count;e++){const n=a.children.get_item(e);Array.add(t,n.elementInternal)}}return t}adjustMenuLayout(){const e=this.menu.children;for(let t=0;t<e.count;t++){const n=e.get_item(t).children;for(let e=0;e<n.count;e++){const t=n.get_item(e);if((0,i.a)(Vt.a,t)){const e=t;if("Menu32"===e.displayMode||"Menu48"===e.displayMode){const e=t.control;e.behavior&&((0,i.a)(mn.a,e)||(0,i.a)(_n.a,e))&&e.behavior.adjustLayoutForLargeMenu()}}}}if(e.count>0){const t=e.get_item(0);Qt.d(t.separator)||(t.separator.style.display="none"),Qt.d(t.titleElement)||Kt.a.ensureCSSClassOnElement(t.titleElement,"cui-menusection-titleAtTop")}}positionMenu(e){if(Qt.d(e))return void 0;e.style.top="0px",e.style.left="0px",e.style.bottom="",e.style.right="",e.style.width="",e.style.minWidth="";const t=dn.create();try{const t=this.menuPositioner.getDimensionsForMenu(e),n=this.getLauncherBounds();let a=this.root.setFlyoutCoordinates(e,t,this.menuLauncher.menuDirection,n);a||(a=this.menuPositioner.setFlyoutCoordinates(e,t,this.menuLauncher.menuDirection,n)),this.root.menuPositioningInfo=a}finally{t&&t.dispose()}}getLauncherBounds(){const e=Ce.a.getElementBounds(this.menuLauncher.launcher),t=this.parentMenu;if(!Qt.d(t)&&!Qt.d(t.elementInternal)){const n=Ce.a.getElementBounds(t.elementInternal);e.x=n.x+un.a.menuBorderPx,e.width=n.width-2*un.a.menuBorderPx}return e}closeMenu(){if(!this.menuLauncher.menuLaunched)return;U.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{Id:this.menuLauncher.controlProperties.Id}),this.menu.onMenuClosed(),this.removeMenuFromHierarchy(),this.menuLaunched=!1,this.menu.launched=!1,this.root.endModal(this.control,!0),this.shouldRestoreFocusToApp?A.AFrameworkApplication.activeFrame.restoreFocusAfterDismissingPopup(this.menuLauncher.elmHadFocus,this._menuInvocationMethod):this.restoreFocusToElmHadFocus(),this.menuLauncher.elmHadFocus=null;const e=this.menuLauncher.launcher;Kt.a.removeCSSClassFromElement(e,Gt.a.menuDroppedClassName),this.menuLauncher.updateAriaMenuLauncherAttributes(this.menuLauncher.focusableElement,!1),Kt.a.removeCSSClassFromElement(e,"cui-ctl-menu-hovered-without-focus"),this.menu.resetFocusedIndex();const t=this.properties.CommandMenuClose;Qt.b(t)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.displayedComponent,0,!1),this.removeMenuFromDom()}restoreFocusToElmHadFocus(){const e=this.menuLauncher.elmHadFocus;if(e)try{e.focus()}catch(e){0}else 0}removeMenuFromDom(){Ke.a.removeElement(this.menu.elementInternal),Ke.a.removeElement(this._elmBackFrame),Kt.a.unregisterAllHandlers(this.menu.elementInternal)}pollForDynamicMenu(e){if(this.polledOnce&&Kt.a.isTrue(this.properties.PopulateOnlyOnce))return null;if(Qt.d(this.properties.PopulateQueryCommand))return null;null==e&&(e=0);const t=this.menuLauncher.getCommandPopulateProperties();return(1&this.root.pollForCommandState(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,t,e))>0?t.PopulationXML:null}populateMenuFromXml(e,t=!1){if(this.polledOnce&&Kt.a.isTrue(this.properties.PopulateOnlyOnce))return!0;let n=null;if(this._lastDynamicPopulationXml=e,Qt.d(e)||(n=this.createMenuFromXml(e)),Qt.d(n)||(this.polledOnce=!0),t){if(this.root.clearMenuStack(this.menuLauncher),Qt.d(n)||!n.hasItems())return this.closeMenu(),!1;this.removeMenuFromHierarchy(),this.removeMenuFromDom()}return this.setMenu(n),!0}onDynamicMenuPopulated(){}createMenuFromXml(e){const t=hn.a.convertXMLStringToJSON(e);if(!Qt.d(t)){const e=new Cn.a;e.cloneControlsForMenu=!0,e.parentId=this.control.id;let n=!1;return this.root.builder.buildMenu(t,e,n)}return null}setMenu(e){Qt.d(e)||(Qt.d(this.menu)||this.menu.dispose(),this.menu=e,this.onDynamicMenuPopulated())}removeMenuFromHierarchy(){const e=this.menu.parent;e?(e.ignoreDirtyingEvents=!0,e.removeChild(this.menu.id),e.ignoreDirtyingEvents=!1):U.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(e){let t=!1;if(!Qt.d(e.innerEvent)&&!Qt.d(e.innerEvent.rawEvent)&&!(0,i.a)(Vt.a,this.displayedComponent)){e.innerEvent.rawEvent.altKey&&e.innerEvent.keyCode===Sys.UI.Key.down&&(this.doDefaultAction(e.sourceElement,1,e.innerEvent),t=!0)}return t||(t=super.onKeyDown(e)),t}onPointerDown(e){return this.commitRootPendingChanges(),2===e.inputSource&&e.mouseButton!==Sys.UI.MouseButton.leftButton||this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),e.innerEvent.preventDefault(),!1}handleDefaultActionWithKeytips(e){return!!(this.parentMenu&&this.parentMenu.inKeytipMode&&this.menuLauncher.onMenuLaunchCallback)&&(this.menuLauncher.onMenuLaunchCallback(this.displayedComponent,e),!0)}static createHiddenIframeElement(){const e=Kt.a.createElement("iframe");return e.style.position="absolute",e.style.visibility="hidden",e.style.borderWidth="0px",e}constructor(e){super(e),this._menuInvocationMethod=0,this._lastDynamicPopulationXml=null,this._pendingBackFrameTimeoutId=-1,this._elmBackFrame=null,this._hasAsyncCallbackBeenSentToHandler=!1,this.polledOnce=!1,this.addAndPositionBackFrameInternal=()=>{this.menu&&this.menu.elementInternal&&(document.body.appendChild(this.backFrame),this.positionBackFrame())},this.afterShowMenu=e=>{e.element&&(e.element.style.filter="",e.element.style.opacity="",this.menu&&this.menu.elementInternal===e.element&&(0,i.a)(Sn.a,this.menu)&&rn.a.animateJewelMenuContents(this.menu.elementInternal,this.getChildElementsToAnimate()))},this._menuPositioner=new gn(0===this.root.textDirection,Kt.a.isTrue(this.root.properties.DivSyndicated))}}(0,s.a)(An,"MenuLauncherBehavior",zt,[551,472]);var bn=__webpack_require__(6990);class Tn extends An{get properties$2(){return this.dropDown.properties}get dropDown(){return this.control}get dropDownDom(){return this.dropDown.dropDownDom}attachEvents(e){Ut.a.instance.registerHandler(ce.a.pointerDown,this.dropDownDom.elmControl,(0,Ee.a)(this,this.onPointerDown,"onPointerDown")),Lt.a.instance.registerHandler(ce.a.keyDown,this.dropDownDom.elmControl,(0,Ee.a)(this,this.onKeyDown,"onKeyDown")),Lt.a.instance.registerHandler(ce.a.keyUp,this.dropDownDom.elmControl,(0,Ee.a)(this,this.onKeyUp,"onKeyUp"))}pollForStateAndUpdate(){const e=this.stateProperties[bn.a.SelectedItemId];if((2&this.pollForStateAndUpdateInternal(this.properties$2.Command,this.properties$2.QueryCommand,this.stateProperties))>0){const t=this.stateProperties[bn.a.SelectedItemId];Qt.d(t)||e===t||this.dropDown.selectDropdownItemById(t)||(this.stateProperties[bn.a.SelectedItemId]=null)}}constructor(e){super(e)}}(0,s.a)(Tn,"DropDownBehavior",An,[]);var vn=__webpack_require__(2217),wn=__webpack_require__(9858),Fn=__webpack_require__(1892);class In extends Tn{get comboBox(){return this.control}get comboBoxDom(){return this.comboBox.comboBoxDom}get cbProperties(){return this.comboBox.cbProperties}get isFreeForm(){return this.stateProperties[Fn.a.IsFreeForm]}set isFreeForm(e){this.stateProperties[Fn.a.IsFreeForm]=e}attachEvents(e){const t=e;Ut.a.instance.registerHandler(ce.a.pointerDown,t.elmControl,(0,Ee.a)(this,this.onPointerDown,"onPointerDown"));const n=t.elmInput;le.a.instance.registerHandler(ce.a.focus,n,(0,Ee.a)(this,this.onInputFocus,"onInputFocus")),le.a.instance.registerHandler(ce.a.blur,n,(0,Ee.a)(this,this.onInputBlur,"onInputBlur")),Lt.a.instance.registerHandler(ce.a.keyDown,n,this.onInputKeyDown),Lt.a.instance.registerHandler(ce.a.keyPress,n,this.onInputKeyPress),vn.a.instance.registerHandler(ce.a.mouseUp,n,this.onInputMouseUp),Ut.a.instance.registerHandler(ce.a.pointerDown,n,(0,Ee.a)(this,this.onInputPointerDown,"onInputPointerDown")),Ut.a.instance.registerHandler(ce.a.pointerDown,t.elmBtnA,this.onMenuButtonPointerDown)}pollForStateAndUpdate(){(2&this.pollForStateAndUpdateInternal(this.cbProperties.Command,this.cbProperties.QueryCommand,this.stateProperties))>0&&(this._inputFocused||this.updateValueAndSelectedControl(),this.updateFontStyle())}onDynamicMenuPopulated(){this.comboBox.menuItems=null;let e=null,t=null,n=null,a=null,o=null,r=null;if(!Qt.d(this.menu)){this.setAriaOwnsAttributeWithMenuId();for(const s of this.menu.children)for(const l of s.children)(0,i.a)(Vt.a,l)&&(e=l,t=e.control,(0,i.a)(172,t)&&(n=t,o=n.getMenuItemId()),(0,i.a)(167,t)&&(a=t,r=a.getTextValue()),Qt.d(o)||Qt.d(r)||(this.comboBox.menuItems[r]=o,r=null,o=null))}}onInputPointerDown(e){return!1}onPointerDown(e){this.commitRootPendingChanges();let t=!1;return 3===e.inputSource&&(t=super.onPointerDown(e),this.setAriaOwnsAttributeWithMenuId()),t&&e.innerEvent.preventDefault(),!1}executeAutoComplete(){this._pendingAutoCompleteTimeoutId=-1;const e=this.comboBoxDom.elmInput,t=e.value,n=this.getFirstMenuItemThatBeginsWith(t);if(n){if(e.value=n.key,e.setSelectionRange)e.setSelectionRange(t.length,e.value.length);else if(e.createTextRange){const n=e.createTextRange();n.moveStart("character",t.length),n.moveEnd("character",e.value.length),n.select()}else 0;this._pendingDropdownItemId=n.value}else this._pendingDropdownItemId=null}getFirstMenuItemThatBeginsWith(e){const t=this.comboBox.menuItems;for(const n in t){const a={key:n,value:t[n]};if(a.key.toLowerCase().startsWith(e.toLowerCase()))return a}return null}delayAutoComplete(){Kt.a.isTrue(this.cbProperties.AutoComplete)&&-1===this._pendingAutoCompleteTimeoutId&&(this._needMenuContentsForAutocomplete&&(this.pollForDynamicMenu(0),this._needMenuContentsForAutocomplete=!1),this._pendingAutoCompleteTimeoutId=window.setTimeout((0,Ee.a)(this,this.executeAutoComplete,"executeAutoComplete"),this.comboBox.autoCompleteDelay))}cancelPendingAutoComplete(){Kt.a.isTrue(this.cbProperties.AutoComplete)&&(this._pendingAutoCompleteTimeoutId=Kt.a.cancelPendingTimeout(this._pendingAutoCompleteTimeoutId))}onInputFocus(e){return this.menuLaunched?(this.menu.setFocus(0),!0):(this.onFocus(e),this._inputFocused=!0,Kt.a.ensureCSSClassOnElement(this.comboBoxDom.elmControl,"cui-cb-focus"),Kt.a.isTrue(this.cbProperties.PopulateDynamically)&&(this._needMenuContentsForAutocomplete=!0),Ce.a.selectAllTextInInput(this.comboBoxDom.elmInput),Qt.d(this.menu)||this.menu.refreshInternal(),this._mouseupOnTextboxSinceFocus=!1,!1)}onInputBlur(e){return this._inputFocused=!1,this.commitPendingChange(),Kt.a.removeCSSClassFromElement(this.comboBoxDom.elmControl,"cui-cb-focus"),!1}restoreFocusFromFloatie(){0}commitPendingChange(){if(this.control.enabled){this.cancelPendingAutoComplete();const e=this.comboBoxDom.elmInput;if(void 0!==this.stateProperties[Fn.a.Value]&&null!==this.stateProperties[Fn.a.Value]&&e.value===this.stateProperties[Fn.a.Value].toString())return;if(this.comboBox.selectDropdownItemById(this._pendingDropdownItemId)){this.isFreeForm=!1,this.stateProperties[Fn.a.Value]=e.value;const t={IsFreeForm:!1,CommandValueId:this.comboBox.selectedControl.getCommandValueId(),MenuItemId:this.comboBox.selectedControl.getMenuItemId()};this.root.executeCommand(this.cbProperties.Command,t,this.displayedComponent,0,!1)}else{if(!Kt.a.isTrue(this.cbProperties.AutoComplete)){const t=this.comboBox.menuItems[e.value];if(!Qt.b(t)&&this.comboBox.selectDropdownItemById(t)){this.isFreeForm=!1,this.stateProperties[Fn.a.Value]=e.value;const n={IsFreeForm:!1,CommandValueId:this.comboBox.selectedControl.getCommandValueId(),MenuItemId:t};return void this.root.executeCommand(this.cbProperties.Command,n,this.displayedComponent,0,!1)}}const t=!Qt.b(e.value)&&""!==wn.a.removeAllWhitespace(e.value);if(!this.comboBox.allowFreeForm||!t)return void this.restoreToKnownValue();{this.isFreeForm=!0,this.stateProperties[Fn.a.Value]=e.value;const t={IsFreeForm:!0,Value:e.value};this.root.executeCommand(this.cbProperties.Command,t,this.displayedComponent,0,!1)}}}else this.restoreToKnownValue()}restoreToKnownValue(){this.cancelPendingAutoComplete(),this._pendingDropdownItemId=null,this.updateValueAndSelectedControl()}updateValueAndSelectedControl(){const e=this.stateProperties[Fn.a.Value]||"";e!==this.comboBoxDom.elmInput.value&&(this.comboBoxDom.elmInput.value=e),this.comboBox.selectDropdownItemById(this.comboBox.menuItems[e])}updateFontStyle(){const e=this.stateProperties[Fn.a.FontStyle]||"normal";e!==this.comboBoxDom.elmInput.style.fontStyle&&(this.comboBoxDom.elmInput.style.fontStyle=e)}setAriaOwnsAttributeWithMenuId(){this.control.focusableElement&&this.menu&&this.control.focusableElement.setAttribute(qe.a.ariaOwnsAttribute,this.menu.id)}constructor(e){super(e),this._elmHadFocus=null,this._mouseupOnTextboxSinceFocus=!1,this._inputFocused=!1,this._needMenuContentsForAutocomplete=!1,this._pendingDropdownItemId=null,this._pendingAutoCompleteTimeoutId=-1,this.onMenuButtonPointerDown=e=>{let t=!1;return 2===e.inputSource&&e.mouseButton!==Sys.UI.MouseButton.leftButton||(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),this.setAriaOwnsAttributeWithMenuId(),t=!0),t&&e.innerEvent.preventDefault(),!1},this.onInputKeyDown=e=>{let t=!1;if(!Qt.d(e.innerEvent)&&!Qt.d(e.innerEvent.rawEvent)){const n=e.innerEvent.rawEvent,a=e.innerEvent.keyCode;n.shiftKey,n.altKey,Kt.a.isTrue(this.cbProperties.AutoComplete);a===Sys.UI.Key.enter?(this.commitPendingChange(),this.restoreFocusFromFloatie(),t=!0):a===Sys.UI.Key.tab?(this.commitPendingChange(),this.restoreFocusFromFloatie()):a===Sys.UI.Key.backspace||a===Sys.UI.Key.del?this.control.enabled?(this.cancelPendingAutoComplete(),this._pendingDropdownItemId=null):t=!0:a===Sys.UI.Key.esc?(this.restoreToKnownValue(),this.restoreFocusFromFloatie(),t=!0):a===Sys.UI.Key.down&&(this.launchMenu(1),this.setAriaOwnsAttributeWithMenuId(),t=!0)}return t},this.onInputKeyPress=e=>!this.control.enabled||(!Qt.d(e.innerEvent)&&e.innerEvent.charCode&&this.delayAutoComplete(),!1),this.onInputMouseUp=e=>!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0)}}(0,s.a)(In,"ComboBoxBehavior",Tn,[]);class En extends An{get contextMenuLauncher(){return this.control}getLauncherBounds(){let e=0;return this.menu&&this.menu.elementInternal&&2===this.menu.horizontalAlignment&&(e=this.menu.elementInternal.clientWidth),new Sys.UI.Bounds(this.contextMenuLauncher.x-e,this.contextMenuLauncher.y,this.contextMenuLauncher.launcherWidth,this.contextMenuLauncher.launcherHeight)}constructor(e){super(e)}}(0,s.a)(En,"ContextMenuLauncherBehavior",An,[]);class Mn extends An{get dialogMenuLauncher(){return this.control}getLauncherBounds(){return new Sys.UI.Bounds(this.dialogMenuLauncher.x,this.dialogMenuLauncher.y,this.dialogMenuLauncher.launcherWidth,this.dialogMenuLauncher.launcherHeight)}constructor(e){super(e)}}(0,s.a)(Mn,"DialogMenuLauncherBehavior",An,[]);var kn=__webpack_require__(1091);class Pn extends An{get flyoutAnchor(){return this.control}get properties$2(){return this.control.controlProperties}attachEvents(e){const t=e.elmControl;Qt.d(t)||(le.a.instance.registerHandler(ce.a.focus,t,(0,Ee.a)(this,this.onFocus,"onFocus")),le.a.instance.registerHandler(ce.a.blur,t,(0,Ee.a)(this,this.onBlur,"onBlur")),Ut.a.instance.registerHandler(ce.a.pointerOver,t,(0,Ee.a)(this,this.onPointerOver,"onPointerOver")),Lt.a.instance.registerHandler(ce.a.keyDown,t,(0,Ee.a)(this,this.onKeyDown,"onKeyDown")),Lt.a.instance.registerHandler(ce.a.keyUp,t,(0,Ee.a)(this,this.onKeyUp,"onKeyUp")),Ut.a.instance.registerHandler(ce.a.pointerDown,t,(0,Ee.a)(this,this.onPointerDown,"onPointerDown")))}pollForStateAndUpdate(){if(Qt.d(this.control.controlProperties.Command))return;if(this.flyoutAnchor.menuLaunched&&!this._shouldRefreshWhenDropped)return void(this._needToRefreshAfterMenuClose=!0);if((2&this.pollForStateAndUpdateInternal(this.properties$2.Command,this.properties$2.QueryCommand,this.stateProperties))>0){this.updateVisibility()&&this.updateHtml()}Kt.a.isTrue(this.properties$2.RefreshableMenu)&&this.menuLaunched&&this.menu.pollMenuState()}updateHtml(){this.updateFlyoutLabelText(),this.updateImage(),this.updateImageBackgroundColor(),this.flyoutAnchor.imageIsVisible=this.stateProperties[kn.a.ImageIsVisible]}updateFlyoutLabelText(){const e=Kt.a.validateStringProperty(this.stateProperties[kn.a.LabelText],this.properties$2.LabelText),t=this.stateProperties[kn.a.LabelTextUserGeneratedPlaceholderReplacements];this.control.labelText===e&&this.properties$2.LabelTextUserGeneratedPlaceholderReplacements===t||(this.controlComponentDomCache.medium&&this.updateFlyoutLabelTextDom(this.controlComponentDomCache.medium.elmLabel,e,t),this.controlComponentDomCache.large,this.root.needScaling=!0,this.control.labelText=e,this.properties$2.LabelTextUserGeneratedPlaceholderReplacements=t)}updateFlyoutLabelTextDom(e,t,n){const a=e.lastChild;Kt.a.setControlText(e,t+" ",n);const i=Qt.d(a);U.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",i?"":a.nodeType.toString()),i||e.appendChild(a)}updateImageBackgroundColor(){const e=this.stateProperties[kn.a.ImageBackColor];this.controlComponentDomCache.forEach((t=>{Pn.applyColorToImage(t.elmImage,e)}))}launchMenu(e){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&A.AFrameworkApplication.theActionManager.processAction(Ae.a.digitalPrintToSwaySlabClicked,2),"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||A.AFrameworkApplication.theActionManager.processAction(Ae.a.digitalPrintToSwaySlabClicked,2),(0,i.a)(Vt.a,this.displayedComponent)&&(this.menuLaunched||this.closeChildMenus(!0),this.control.enabled&&this.setFocusOnControl()),super.launchMenu(e)}closeMenu(){super.closeMenu(),this._needToRefreshAfterMenuClose&&(this._needToRefreshAfterMenuClose=!1,this.pollForStateAndUpdate())}onPointerOver(e){return this.control.isStandardMenuItem()?(this.flyoutAnchor.menuLaunched?(this.root.cancelPendingCloseMenuStack(),Kt.a.ensureCSSClassOnElement(this.flyoutAnchor.launcher,Gt.a.menuDroppedClassName),this.flyoutAnchor.elmHadFocus=this.control.focusableElement):(super.onPointerOver(e),this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent)),!1):super.onPointerOver(e)}onKeyDown(e){let t=!1;if(!Qt.d(e.innerEvent)&&!Qt.d(e.innerEvent.rawEvent)){if((0,i.a)(Vt.a,this.displayedComponent)){const n=e.innerEvent.rawEvent,a=e.innerEvent.keyCode,i=0===this.root.textDirection;n.shiftKey||n.ctrlKey||!(a===Sys.UI.Key.right&&i||a===Sys.UI.Key.left&&!i)||(t=this.handleDefaultActionWithKeytips(e),t||(this.doDefaultAction(e.sourceElement,1,e.innerEvent),t=!0))}t||(t=super.onKeyDown(e))}return t}static applyColorToImage(e,t){Qt.d(e)||Qt.d(t)||e.style.backgroundColor===t||(e.style.backgroundColor=t)}constructor(e){super(e),this._needToRefreshAfterMenuClose=!1,this._shouldRefreshWhenDropped=!Kt.a.isFalse(this.properties$2.ShouldRefreshWhenDropped)}}(0,s.a)(Pn,"FlyoutAnchorBehavior",An,[]);var Dn=__webpack_require__(5503);class Rn extends zt{get galleryButton(){return this.control}get properties(){return this.galleryButton.properties}get componentDom(){return this.galleryButton.componentDom}attachEvents(e){const t=e.elmA;le.a.instance.registerHandler(ce.a.focus,t,(0,Ee.a)(this,this.onFocus,"onFocus")),le.a.instance.registerHandler(ce.a.blur,t,(0,Ee.a)(this,this.onBlur,"onBlur")),Ut.a.instance.registerHandler(ce.a.pointerOver,t,(0,Ee.a)(this,this.onPointerOver,"onPointerOver")),Ut.a.instance.registerHandler(ce.a.pointerOut,t,(0,Ee.a)(this,this.onPointerOut,"onPointerOut")),Lt.a.instance.registerHandler(ce.a.keyDown,t,(0,Ee.a)(this,this.onKeyDown,"onKeyDown")),Lt.a.instance.registerHandler(ce.a.keyUp,t,(0,Ee.a)(this,this.onKeyUp,"onKeyUp")),Ut.a.instance.registerHandler(ce.a.pointerDown,t,(0,Ee.a)(this,this.onPointerDown,"onPointerDown")),Ut.a.instance.registerHandler(ce.a.pointerUp,t,(0,Ee.a)(this,this.onPointerUp,"onPointerUp")),Zt.a.instance.registerHandler(ce.a.touchMove,t,(0,Ee.a)(this,this.onTouchMove,"onTouchMove")),Zt.a.instance.registerHandler(ce.a.touchEnd,t,(0,Ee.a)(this,this.onTouchEnd,"onTouchEnd"))}pollForStateAndUpdate(){const e=this.stateProperties[Dn.a.On],t=this.stateProperties[Dn.a.IsRtl];this.updateStateProperties();if((2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0){const n=!Qt.d(this.stateProperties[Dn.a.InnerHTML])||!Qt.d(this.properties.InnerHTML),a=!Qt.d(this.properties.Image);n||a||(this.control.enabled=!1);const i=this.componentDom.elmA;if(!Qt.d(i)){if(n){const e=Kt.a.validateStringProperty(this.stateProperties[Dn.a.InnerHTML],this.properties.InnerHTML);null!==i.innerHTML&&null!==e&&wn.a.toLower(i.innerHTML)===wn.a.toLower(e)||(i.innerHTML=e),""===e&&(this.control.enabled=!1)}const e=i.title,t=Kt.a.validateStringProperty(this.stateProperties[Dn.a.Alt],this.properties.Alt);t===e||this.control.shouldIgnoreTitle||(i.title=t)}const o=this.stateProperties[Dn.a.On],r=this.stateProperties[Dn.a.IsRtl];e===o&&t===r||this.control.onStateChanged()}}updateStateProperties(){const e=this.stateProperties;e[Dn.a.CommandValueId]=this.control.getCommandValueId(),e.MenuItemId=this.control.getMenuItemId(),e.SourceControlId=this.properties.Id}doDefaultAction(e,t,n){const a=this.displayedComponent;if(a&&this.control.enabled){const e=this.root;if(A.AFrameworkApplication.appSettingsManager&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelBorderMenuCompactionEnabled")&&a.isMenuItem()&&this.parentMenu){const t=this.parentMenu.stackIndex,n=e.menuLauncherStack[t];n?n.selectDropdownItem(this.galleryButton):U.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.updateStateProperties(),this.stateProperties[Dn.a.On]||(this.stateProperties[Dn.a.On]=!0,this.control.onStateChanged()),"Menu"===a.displayMode&&Kt.a.removeCSSClassFromElement(this.componentDom.elmControl,"cui-gallerybutton-focused"),e.executeCommand(this.properties.Command,this.stateProperties,a,t,!0,null,this.getTelemetryData(n))}}onFocus(e){return super.onFocus(e),Kt.a.ensureCSSClassOnElement(this.componentDom.elmControl,"cui-gallerybutton-focused"),!1}onBlur(e){return super.onBlur(e),Kt.a.removeCSSClassFromElement(this.componentDom.elmControl,"cui-gallerybutton-focused"),!1}constructor(e){super(e)}}(0,s.a)(Rn,"GalleryButtonBehavior",zt,[]);var xn=__webpack_require__(6522),Ln=__webpack_require__(6244),Un=__webpack_require__(8268);class On extends zt{get insertTableControl(){return this.control}get properties(){return this.insertTableControl.controlProperties}get commandProperties(){return this.insertTableControl.commandProperties}get hostMenuSection(){let e=null;if(this.displayedComponent){const t=this.displayedComponent.parent;if(!(0,i.a)(Un.a,t))throw Error.create("InsertTable must live inside of a MenuSection.");e=t}return e}get innerDivs(){return this.insertTableControl.insertTableDom.innerDivs}get outerDivs(){return this.insertTableControl.insertTableDom.outerDivs}doDefaultAction(e,t,n){if(this.control.enabled){0;const a=this.getIndexFromElement(this.getCellOuterDiv(e)),i=this.getColFromIndex(a),o=this.getRowFromIndex(a);this.commandProperties[Ln.a.Rows]=o+1,this.commandProperties[Ln.a.Columns]=i+1,this.root.executeCommand(this.properties.Command,this.commandProperties,this.displayedComponent,t,!0,null,this.getTelemetryData(n))}}attachEvents(e){const t=e,n=t.elmControl,a=t.cellATags,i=t.cells;Ut.a.instance.registerHandler(ce.a.pointerOut,n,(0,Ee.a)(this,this.onControlPointerOut,"onControlPointerOut")),Zt.a.instance.registerHandler(ce.a.touchMove,n,(0,Ee.a)(this,this.onControlTouchMove,"onControlTouchMove")),Zt.a.instance.registerHandler(ce.a.touchEnd,n,(0,Ee.a)(this,this.onControlTouchEnd,"onControlTouchEnd"));for(let e=0;e<i.length;++e)this.attachCellEvents(a[e],i[e])}attachCellEvents(e,t){le.a.instance.registerHandler(ce.a.focus,e,(0,Ee.a)(this,this.onCellFocus,"onCellFocus")),Ut.a.instance.registerHandler(ce.a.pointerOver,t,(0,Ee.a)(this,this.onCellPointerOver,"onCellPointerOver")),Ut.a.instance.registerHandler(ce.a.pointerUp,t,(0,Ee.a)(this,this.onCellPointerUp,"onCellPointerUp")),Lt.a.instance.registerHandler(ce.a.keyDown,t,(0,Ee.a)(this,this.onKeyDown,"onKeyDown")),Lt.a.instance.registerHandler(ce.a.keyUp,t,(0,Ee.a)(this,this.onKeyUp,"onKeyUp")),Zt.a.instance.registerHandler(ce.a.touchStart,t,(0,Ee.a)(this,this.onCellTouchStart,"onCellTouchStart"))}getIndexFromElement(e){return parseInt(e.id.substr(this.insertTableControl.id.length+1))}handleHighlightingTitle(e){this.handleHighlightingAndTitleForIndex(this.getIndexFromElement(e))}getRowFromIndex(e){return Math.floor(e/xn.a.numCols)}getColFromIndex(e){return e%xn.a.numCols}handleHighlightingAndTitleForIndex(e){if(e!==this._oldIdx){const t=this.getColFromIndex(e),n=this.getRowFromIndex(e);let a=-1,i=-1;for(-1!==this._oldIdx&&(a=this.getRowFromIndex(this._oldIdx),i=this.getColFromIndex(this._oldIdx));a!==n||i!==t;)a<n?this.setRowHighlighting(++a,i,!0):a>n?(this.setRowHighlighting(a,i,!1),a--):i<t?this.setColHighlighting(++i,a,!0):i>t&&(this.setColHighlighting(i,a,!1),i--);if(this.hostMenuSection)this.hostMenuSection.setTitleImmediate(this.getCellTitle(n+1,t+1));else{const e=this.control.components,t=e&&e.length>0?e[0]:null,n=this.displayedComponent;U.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{CtrlComps:!!e,FirstComp:!!t,FirstCompPar:!!t&&!!t.parent,DispComp:!!n,DispCompPar:!!n&&!!n.parent})}this._oldIdx=e}}setRowHighlighting(e,t,n){for(let a=0;a<=t;a++)this.setCellHighlighting(e,a,n)}setColHighlighting(e,t,n){for(let a=0;a<=t;a++)this.setCellHighlighting(a,e,n)}setCellHighlighting(e,t,n){const a=e*xn.a.numCols+t,i=this.innerDivs[a],o=this.outerDivs[a];n?(i.className="cui-it-activeCell",o.className="cui-it-activeCellOuter"):(i.className="cui-it-inactiveCell",o.className="cui-it-inactiveCellOuter")}onCellPointerUp(e){return this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),!0}getCellOuterDiv(e){for(;e.hasChildNodes();)e=e.childNodes[0];return Qt.d(e.tagName)||"a"!==e.tagName.toLowerCase()?null:e.parentNode.parentNode}setTitleOnAnchor(e){const t=e.childNodes[0].childNodes[0],n=this.getIndexFromElement(e);t.title=this.getCellTitle(this.getRowFromIndex(n)+1,this.getColFromIndex(n)+1)}getCellTitle(e,t){let n=this.properties.Alt;return Qt.d(n)&&(n=this.properties.MenuSectionTitle),n=String.format(n,t.toString(),e.toString()),n}resetAll(){if(this.displayedComponent){for(let e=0;e<xn.a.numCells;e++)this.innerDivs[e].className="cui-it-inactiveCell",this.outerDivs[e].className="cui-it-inactiveCellOuter";this._oldIdx=-1;let e=this.properties.MenuSectionInitialTitle;Qt.d(e)&&(e=""),this.hostMenuSection.setTitleImmediate(e)}}onCellPointerOver(e){if(this.control.enabled){const t=this.getCellOuterDiv(e.sourceElement);this.setFocusOnCell(t),this.doCellHover(t)}return!1}doCellHover(e){this.setTitleOnAnchor(e),this.handleHighlightingTitle(e)}onCellFocus(e){if(!this.control.enabled)return!1;const t=this.getCellOuterDiv(e.sourceElement);return this.setTitleOnAnchor(t),this.handleHighlightingTitle(t),!1}onControlPointerOut(e){return Ce.a.isPointInElement(this.insertTableControl.insertTableDom.elmControl,e.clientPoint)||this.resetAll(),!1}onCellTouchStart(e){if(!this.control.enabled)return!1;const t=this.getCellOuterDiv(e.sourceElement);return this.doCellHover(t),!0}onControlTouchMove(e){if(!this.control.enabled)return!1;const t=e.clientPoint,n=Ce.a.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return!1;const a=this.getCellOuterDiv(n);return a?this.doCellHover(a):this.resetAll(),!0}onControlTouchEnd(e){if(!this.control.enabled)return!1;const t=e.clientPoint,n=Ce.a.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return this.resetAll(),!0;const a=this.getCellOuterDiv(n);return a?this.doDefaultAction(a,3,e.innerEvent):this.resetAll(),!0}focusNext(e){const t=$t.a.focusNextIndexInGrid(this._oldIdx,xn.a.numCols,xn.a.numCells,e);return t!==this._oldIdx?(this.innerDivs[t].firstChild.focus(),this.handleHighlightingAndTitleForIndex(t),!0):(this.resetAll(),this._oldIdx=-1,!1)}setFocusOnControl(){const e=this.innerDivs[0];return!Qt.d(e)&&(e.firstChild.focus(),!0)}setFocusOnCell(e){return!Qt.d(e)&&(e.firstChild.firstChild.focus(),!0)}onMenuClosed(){this.resetAll()}constructor(e){super(e),this._oldIdx=-1}}(0,s.a)(On,"InsertTableBehavior",zt,[]);class Bn extends An{pollForStateAndUpdate(){this.control.enabled=!!this.menu}doDefaultAction(e,t,n){A.AFrameworkApplication.theActionManager.processActionWithData(Ae.a.launchFileMenu,2,t,this.getTelemetryData(n))}constructor(e){super(e)}}(0,s.a)(Bn,"JewelMenuLauncherBehavior",An,[]);var Nn=__webpack_require__(3823);class Wn extends zt{get properties(){return this.control.controlProperties}pollForStateAndUpdate(){if((2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0){this.updateVisibility()&&this.updateHtml()}}updateHtml(){this.updateTextForLabelControl(),this.updateImage(),this.updateTooltip()}updateTextForLabelControl(){const e=this.control.labelText;let t=this.stateProperties[Nn.a.Value];Qt.d(t)&&(t=this.properties.LabelText,Qt.d(t)&&(t="")),t!==e&&this.setLabelText(t)}attachEvents(e){const t=e.elmControl;Qt.d(t)||(Ut.a.instance.registerHandler(ce.a.pointerDown,t,(0,Ee.a)(this,this.onPointerDown,"onPointerDown")),Ut.a.instance.registerHandler(ce.a.pointerOver,t,(0,Ee.a)(this,this.onPointerOver,"onPointerOver")),Ut.a.instance.registerHandler(ce.a.pointerOut,t,(0,Ee.a)(this,this.onPointerOut,"onPointerOut")))}constructor(e){super(e)}}(0,s.a)(Wn,"LabelBehavior",zt,[]);var Hn=__webpack_require__(5401),Vn=__webpack_require__(3180);class Gn extends An{get searchBox(){return this.control}notifyCommandExecuted(e,t,n,a){if(t&&(this.searchBox.elmHadFocus=n,A.AFrameworkApplication.activeFrame.setFocusOnDocument()),(0,i.a)(Vn.a,e)&&a){const n=new Hn.a;n.CommandLocation=this.root.rootType,n.InvocationMethod=0;const i={},o=e.control;if(o&&o.controlProperties){if(i.CommandId=o.controlProperties.Command,i.ControlId=o.controlProperties.Id,i.CloseAllMenus=t,o.parentMenu&&o.parentMenu.parent&&o.parentMenu.parent.id){const e=o.parentMenu.parent.id;i.ParentControlId=e.split("-")[0]}this.root.rootUser&&this.root.rootUser.executeRootCommand(a,i,n)}}}closeMenu(){this.searchBox.elmHadFocus||(this.searchBox.elmHadFocus=this.searchBox.inputField),this.searchBox.mouseIsOver||this._isRedesignFlightEnabled&&(Kt.a.removeCSSClassFromElement(this.searchBox.inputField,"cui-sb-focus"),Kt.a.removeCSSClassFromElement(this.searchBox.topLevelElement,"cui-sb-focus"),Kt.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._activeIconClass),Kt.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._inactiveIconClass)),this._closingMenu=!0,super.closeMenu(),this._closingMenu=!1,this.raiseInteractionEnd()}get shouldRestoreFocusToApp(){return!this.searchBox.processingKeystroke}onMenuChanged(){this.searchBox.onMenuChanged()}raiseInteractionBegin(){this._inActiveInteraction||this._closingMenu||(this._inActiveInteraction=!0,this.searchBox.raiseEvent("InteractionBegin",null))}raiseInteractionEnd(){this.menuLaunched||this.searchBox.inputHasFocus||(this._inActiveInteraction=!1,this.searchBox.raiseEvent("InteractionEnd",null))}onInputBoxBlur(e){return Kt.a.removeCSSClassFromElement(this.searchBox.inputField,"cui-sb-focus"),Kt.a.removeCSSClassFromElement(this.searchBox.topLevelElement,"cui-sb-focus"),this._isRedesignFlightEnabled&&!this.searchBox.menuLaunched&&(Kt.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._activeIconClass),Kt.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._inactiveIconClass)),this.searchBox.raiseEvent("Blur",e),this.raiseInteractionEnd(),this.searchBox.elmHadFocus=this.searchBox.inputField,!1}onInputBoxFocus(e){return Kt.a.ensureCSSClassOnElement(this.searchBox.inputField,"cui-sb-focus"),Kt.a.ensureCSSClassOnElement(this.searchBox.topLevelElement,"cui-sb-focus"),this._isRedesignFlightEnabled&&(Kt.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._inactiveIconClass),Kt.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._activeIconClass)),this.searchBox.raiseEvent("Focus",e),this.raiseInteractionBegin(),!1}onSearchContainerMouseOver(e){return this._isRedesignFlightEnabled&&(Kt.a.ensureCSSClassOnElement(this.searchBox.topLevelElement,"cui-sb-hover"),Kt.a.ensureCSSClassOnElement(this.searchBox.inputField,"cui-sb-hover"),Kt.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._inactiveIconClass),Kt.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._activeIconClass)),!1}onSearchContainerMouseOut(e){return this._isRedesignFlightEnabled&&(Kt.a.removeCSSClassFromElement(this.searchBox.topLevelElement,"cui-sb-hover"),Kt.a.removeCSSClassFromElement(this.searchBox.inputField,"cui-sb-hover"),this.searchBox.menuLaunched||this.searchBox.inputHasFocus||(Kt.a.removeCSSClassFromElement(this.searchBox.searchIcon,this._activeIconClass),Kt.a.ensureCSSClassOnElement(this.searchBox.searchIcon,this._inactiveIconClass))),!1}constructor(e){super(e),this._closingMenu=!1,this._inActiveInteraction=!1,this._activeIconClass=null,this._inactiveIconClass=null,this._isRedesignFlightEnabled=A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMeRedesignIsEnabled"),this._isRedesignFlightEnabled&&(this._activeIconClass=this.searchBox.sbProperties.LightImage16by16Class,this._inactiveIconClass=this.searchBox.sbProperties.DarkImage16by16Class)}}(0,s.a)(Gn,"SearchBoxBehavior",An,[473,472]);var Qn=__webpack_require__(10);const qn="cui-sldr-onfocus";class Kn extends zt{get slider(){return this.control}get sliderDom(){return this.slider.sliderDom}get properties(){return this.control.controlProperties}initialize(){}doDefaultAction(e,t,n){}attachEvents(e){const t=e.elmInput;le.a.instance.registerHandler(ce.a.focus,t,(0,Ee.a)(this,this.onFocus,"onFocus")),le.a.instance.registerHandler(ce.a.blur,t,(0,Ee.a)(this,this.onBlur,"onBlur")),le.a.instance.registerHandler(ce.a.change,t,this.onChange),le.a.instance.registerHandler(ce.a.input,t,this.onChange)}onFocus(e){return this.sliderDom.elmControl&&Sys.UI.DomElement.addCssClass(this.sliderDom.elmControl,qn),super.onFocus(e)}onBlur(e){return this.sliderDom.elmControl&&Sys.UI.DomElement.removeCssClass(this.sliderDom.elmControl,qn),super.onBlur(e)}commitValue(e){this.stateProperties[Qn.a.Value]=parseFloat(e),this.root.executeCommand(this.properties.Command,this.stateProperties,this.displayedComponent,0,!1)}pollForStateAndUpdate(){const e=this.stateProperties[Qn.a.Value],t=this.stateProperties[Qn.a.MaxValue],n=this.stateProperties[Qn.a.Text],a=this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties);if(this.sliderDom&&this.sliderDom.elmInput&&(this.sliderDom.elmInput.disabled=!this.control.enabled),(2&a)>0){const a=this.stateProperties[Qn.a.Value],i=this.stateProperties[Qn.a.MaxValue],o=this.stateProperties[Qn.a.Text];i===t&&a===e&&n===o||this.sliderDom&&this.sliderDom.elmInput&&(this.sliderDom.elmInput.setAttribute(qe.a.ariaValueMaxAttribute,String.format("{0}",i)),this.sliderDom.elmInput.setAttribute("max",String.format("{0}",i)),this.sliderDom.elmInput.value=a,this.sliderDom.elmLabel.innerText=this.stateProperties[Qn.a.Text])}}constructor(e){super(e),this.onChange=e=>(this.commitValue(this.sliderDom.elmInput.value),!0)}}(0,s.a)(Kn,"SliderBehavior",zt,[]);var zn=__webpack_require__(8870);class jn extends zt{get spinner(){return this.control}get spinnerDom(){return this.spinner.spinnerDom}get properties(){return this.control.controlProperties}initialize(){const e=this.spinner.validUnits;this._validUnitTypes=this.unitTypeArrayFromUnitArray(e),this._numericalValue=e[0].min,this._unit=e[0],this._isSpecialText=!1}doDefaultAction(e,t,n){}attachEvents(e){const t=e,n=t.elmInput,a=t.elmUpArrow,i=t.elmDownArrow;le.a.instance.registerHandler(ce.a.focus,n,(0,Ee.a)(this,this.onFocus,"onFocus")),le.a.instance.registerHandler(ce.a.blur,n,(0,Ee.a)(this,this.onBlur,"onBlur")),Lt.a.instance.registerHandler(ce.a.keyDown,n,(0,Ee.a)(this,this.onKeyDown,"onKeyDown")),Lt.a.instance.registerHandler(ce.a.keyPress,n,this.onKeyPress),Lt.a.instance.registerHandler(ce.a.keyUp,n,(0,Ee.a)(this,this.onKeyUp,"onKeyUp")),le.a.instance.registerHandler(ce.a.change,n,this.onChange),vn.a.instance.registerHandler(ce.a.mouseUp,n,this.onInputMouseUp),Ut.a.instance.registerHandler(ce.a.pointerDown,a,this.onArrowPointerDown),Ut.a.instance.registerHandler(ce.a.pointerDown,i,this.onArrowPointerDown),Ut.a.instance.registerHandler(ce.a.pointerUp,a,this.onArrowPointerUp),Ut.a.instance.registerHandler(ce.a.pointerUp,i,this.onArrowPointerUp),Zt.a.instance.registerHandler(ce.a.touchMove,a,(0,Ee.a)(this,this.onArrowTouchMove,"onArrowTouchMove")),Zt.a.instance.registerHandler(ce.a.touchMove,i,(0,Ee.a)(this,this.onArrowTouchMove,"onArrowTouchMove")),Zt.a.instance.registerHandler(ce.a.touchEnd,a,(0,Ee.a)(this,this.onArrowTouchEnd,"onArrowTouchEnd")),Zt.a.instance.registerHandler(ce.a.touchEnd,i,(0,Ee.a)(this,this.onArrowTouchEnd,"onArrowTouchEnd"))}onFocus(e){return super.onFocus(e),Kt.a.ensureCSSClassOnElement(this.spinnerDom.elmControl,"cui-spn-focus"),this.control.enabled&&Ce.a.selectAllTextInInput(this.spinnerDom.elmInput),this._mouseupOnTextboxSinceFocus=!1,!1}onBlur(e){return super.onBlur(e),Kt.a.removeCSSClassFromElement(this.spinnerDom.elmControl,"cui-spn-focus"),!1}onKeyDown(e){let t=!1;if(!Qt.d(e.innerEvent)&&!Qt.d(e.innerEvent.rawEvent)){const n=e.innerEvent.rawEvent,a=e.innerEvent.keyCode;n.shiftKey;a===Sys.UI.Key.up||a===Sys.UI.Key.down?(this.root.isCurrentModalController(this.control)||this.startSpin(a===Sys.UI.Key.up,e.inputSource),t=!0):a===Sys.UI.Key.enter?(this.commitPendingChange(),t=!0):a===Sys.UI.Key.tab?this.commitPendingChange():a===Sys.UI.Key.esc?(this.resetInputToPreviousValue(),t=!0):a!==Sys.UI.Key.backspace&&a!==Sys.UI.Key.del||(t=!this.control.enabled)}return t}onKeyUp(e){return this.deactivateElementFromKeyboard(),!1}onArrowTouchMove(e){return this.onActivePointerMove(e)}onArrowTouchEnd(e){return this.deactivateElement(e)}incDecValue(e){if(this.control.enabled){let t=!1;if(!this._isSpecialText){const n=this.getIncDecStartingValue(e);let a=e?n+this._unit.step:n-this._unit.step;a=Math.min(a,this._unit.max),a=Math.max(a,this._unit.min),a!==this._numericalValue&&(this.commitNumericalValue(a,this._unit),this.root.executeCommand(this.properties.Command,this.stateProperties,this.displayedComponent,0,!1),t=!0)}if(!t){const t=this.properties.SpinCommand,n=this.stateProperties;n.Increment=e,Qt.d(t)||this.root.executeCommand(t,n,this.displayedComponent,0,!1)}}}getIncDecStartingValue(e){const t=Math.pow(10,A.AFrameworkApplication.numberFormat.numberDecimalDigits),n=Math.round(this._numericalValue*t),a=Math.round(this._unit.step*t);let i=n/a;return i=e?Math.floor(i):Math.ceil(i),i*a/t}startSpin(e,t){if(this.control.enabled){this.commitPendingChange();const n=e?this.spinnerDom.elmUpArrow:this.spinnerDom.elmDownArrow;switch(t){case 2:case 3:this._spinningUp=e,this.activateElement(n);break;case 1:this._spinningUp=e,this.activateElementFromKeyboard(n)}}}stopSpin(){this.cancelPendingDelaySpin(),this.cancelRepeatSpin()}delaySpin(){-1===this._pendingDelaySpinTimeoutId&&(this._pendingDelaySpinTimeoutId=window.setTimeout(this.repeatSpin,500))}cancelPendingDelaySpin(){this._pendingDelaySpinTimeoutId=Kt.a.cancelPendingTimeout(this._pendingDelaySpinTimeoutId)}cancelRepeatSpin(){this._repeatSpinIntervalId=Kt.a.cancelInterval(this._repeatSpinIntervalId)}spin(){this.incDecValue(this._spinningUp)}activateElementFromKeyboard(e){this.root.beginModal(this.control,!1),Kt.a.ensureCSSClassOnElement(e,Nt.a.activeClassName),this.spin(),this.delaySpin()}deactivateElementFromKeyboard(){this.root.endModal(this.control,!1),this.stopSpin(),Kt.a.removeCSSClassFromElement(this.spinnerDom.elmUpArrow,Nt.a.activeClassName),Kt.a.removeCSSClassFromElement(this.spinnerDom.elmDownArrow,Nt.a.activeClassName)}setInputValue(e){this.spinnerDom.elmInput.value!==e&&(this.spinnerDom.elmInput.value=e)}resetInputToPreviousValue(){this.setInputValue(this.stateProperties[zn.a.Text])}setCurrentValueToSpecialText(e){this.setInputValue(e),this.stateProperties[zn.a.Text]=e,this._isSpecialText=!0}setCurrentValueToNumber(e,t,n){this.setInputValue(n),this.stateProperties[zn.a.Text]=n,this.stateProperties[zn.a.Number]=e,this.stateProperties[zn.a.UnitType]=t.type,this._numericalValue=e,this._unit=t,this.spinnerDom.elmInput.setAttribute(qe.a.ariaValueNowAttribute,n),this.spinnerDom.elmInput.setAttribute(qe.a.ariaValueMinAttribute,String.format("{0}",t.min)),this.spinnerDom.elmInput.setAttribute(qe.a.ariaValueMaxAttribute,String.format("{0}",t.max)),this._isSpecialText=!1}commitTextValue(e){let t;if(({normalizedValue:t}=this.isSpecialText(e)).returnValue)this.setCurrentValueToSpecialText(t);else{let t=0,n=0;({number:t,unitType:n}=wn.a.parseNumberAndUnitsFromString(e,this._validUnitTypes,A.AFrameworkApplication.numberFormat));let a=this.unitFromUnitType(n);0===n&&Qt.d(a)&&(a=this.unitFromUnitType(this.stateProperties[zn.a.UnitType])),this.commitNumericalValue(t,a)}}commitNumericalValue(e,t){if(e=this.normalizeNumber(e,t),isNaN(e)||Qt.d(t))this.resetInputToPreviousValue();else{const n=A.AFrameworkApplication.numberFormat;let a="";a=wn.a.formatNumberToString(e,t.type,n);const i=6===t.type?n.numberGroupSeparator:n.percentGroupSeparator;a=a.replace(i,""),this.setCurrentValueToNumber(e,t,a)}}isSpecialText(e){let t,n=!1;t="",e=e.trim();const a=this.spinner.validSpecialStrings;if(!Qt.d(a))for(let i=0;i<a.length;i++)if(a[i].toLowerCase()===e.toLowerCase()){t=a[i],n=!0;break}return{returnValue:n,normalizedValue:t}}normalizeNumber(e,t){return isNaN(e)||Qt.d(t)?Number.NaN:t.normalizeNumber(e)}unitFromUnitType(e){let t=null;const n=this.spinner.validUnits;for(let a=0;a<n.length;a++)if(n[a].type===e){t=n[a];break}return t}unitTypeArrayFromUnitArray(e){const t=e.length,n=new Array(t);for(let a=0;a<t;a++)n[a]=e[a].type;return n}commitPendingChange(){if(this.control.enabled){const e=this.stateProperties[zn.a.Text],t=this.spinnerDom.elmInput.value;if(t!==e){this.commitTextValue(t);this.stateProperties[zn.a.Text]!==e&&this.root.executeCommand(this.properties.Command,this.stateProperties,this.displayedComponent,0,!1)}}else this.resetInputToPreviousValue()}pollForStateAndUpdate(){const e=this.stateProperties[zn.a.Text],t=this.stateProperties[zn.a.Number],n=this.stateProperties[zn.a.UnitType],a=this.stateProperties[zn.a.MaxValue];if((2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0){const i=this.stateProperties[zn.a.Text],o=this.stateProperties[zn.a.Number],r=this.stateProperties[zn.a.UnitType],s=this.stateProperties[zn.a.MaxValue];s!==a&&(this.unitFromUnitType(r).max=s,this.spinnerDom.elmInput.setAttribute(qe.a.ariaValueMaxAttribute,String.format("{0}",s))),i!==e?""===i?this.setCurrentValueToSpecialText(i):this.commitTextValue(i):isNaN(o)||o===t&&r===n||this.commitNumericalValue(o,this.unitFromUnitType(r));const l=this.spinnerDom.elmControl.title,c=Kt.a.validateStringProperty(this.stateProperties[zn.a.Alt],this.properties.Alt);c!==l&&(this.spinnerDom.elmInput.title=c,this.spinnerDom.elmUpArrow.title=c,this.spinnerDom.elmDownArrow.title=c)}}activeElementStateChanged(e){super.activeElementStateChanged(e),e?(this.spin(),this.delaySpin()):this.stopSpin()}constructor(e){super(e),this._numericalValue=0,this._unit=null,this._isSpecialText=!1,this._validUnitTypes=null,this._spinningUp=!1,this._pendingDelaySpinTimeoutId=-1,this._repeatSpinIntervalId=-1,this._mouseupOnTextboxSinceFocus=!1,this.onKeyPress=e=>!this.control.enabled,this.onChange=e=>(this.commitPendingChange(),!1),this.onInputMouseUp=e=>!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0),this.onArrowPointerDown=e=>{let t=!1,n=!0;if(2===e.inputSource&&(n=e.mouseButton===Sys.UI.MouseButton.leftButton),n){const n=e.sourceElement,a=n===this.spinnerDom.elmUpArrow||n===this.spinnerDom.elmUpArrowImageContainer||n===this.spinnerDom.elmUpArrowImage;this.startSpin(a,e.inputSource),t=!0}return t},this.onArrowPointerUp=e=>this.deactivateElement(e),this.repeatSpin=()=>{this.cancelPendingDelaySpin(),-1===this._repeatSpinIntervalId&&(this.spin(),this._repeatSpinIntervalId=window.setInterval((0,Ee.a)(this,this.spin,"spin"),50))}}}(0,s.a)(jn,"SpinnerBehavior",zt,[475,472]);var Zn=__webpack_require__(5837);const Xn="cui-ctl-split-hovered-primary",Jn="cui-ctl-split-hovered-secondary",Yn="title";class $n extends An{get splitButton(){return this.control}get properties$2(){return this.splitButton.properties}attachEvents(e){const t=e,n=t.elmControl,a=t.elmButtonPart,i=t.elmMenuLauncherPart;le.a.instance.registerHandler(ce.a.focus,n,(0,Ee.a)(this,this.onFocus,"onFocus")),le.a.instance.registerHandler(ce.a.blur,n,(0,Ee.a)(this,this.onBlur,"onBlur")),Lt.a.instance.registerHandler(ce.a.keyDown,n,(0,Ee.a)(this,this.onKeyDown,"onKeyDown")),Lt.a.instance.registerHandler(ce.a.keyUp,n,(0,Ee.a)(this,this.onKeyUp,"onKeyUp")),Ut.a.instance.registerHandler(ce.a.pointerOver,a,(0,Ee.a)(this,this.onButtonPointerOver,"onButtonPointerOver")),Ut.a.instance.registerHandler(ce.a.pointerOut,a,(0,Ee.a)(this,this.onButtonPointerOut,"onButtonPointerOut")),Ut.a.instance.registerHandler(ce.a.pointerDown,a,(0,Ee.a)(this,this.onButtonPointerDown,"onButtonPointerDown")),Ut.a.instance.registerHandler(ce.a.pointerUp,a,(0,Ee.a)(this,this.onButtonPointerUp,"onButtonPointerUp")),Zt.a.instance.registerHandler(ce.a.touchMove,a,(0,Ee.a)(this,this.onButtonTouchMove,"onButtonTouchMove")),Zt.a.instance.registerHandler(ce.a.touchEnd,a,(0,Ee.a)(this,this.onButtonTouchEnd,"onButtonTouchEnd")),Ut.a.instance.registerHandler(ce.a.pointerDown,i,(0,Ee.a)(this,this.onMenuButtonPointerDown,"onMenuButtonPointerDown")),Ut.a.instance.registerHandler(ce.a.pointerOver,i,(0,Ee.a)(this,this.onMenuButtonPointerOver,"onMenuButtonPointerOver")),Ut.a.instance.registerHandler(ce.a.pointerOut,i,(0,Ee.a)(this,this.onMenuButtonPointerOut,"onMenuButtonPointerOut"))}doDefaultAction(e,t,n){if(Sys.UI.DomElement.containsCssClass(e,"cui-ctl-a1")){if(this._buttonEnabled){this.splitButton.on=!this.splitButton.on;const e=this.stateProperties;e.CommandValueId=this.control.getCommandValueId(),this.root.executeCommand(this.properties$2.Command,e,this.displayedComponent,t,!0,null,this.getTelemetryData(n))}}else this._menuButtonEnabled&&super.doDefaultAction(e,t,n)}onKeyUp(e){const t=e.innerEvent.keyCode;if(t===Sys.UI.Key.enter||t===Sys.UI.Key.space){const e=this.stateProperties;return e.CommandValueId=this.control.getCommandValueId(),this.root.executeCommand(this.properties$2.Command,e,this.displayedComponent,1,!0),!0}return super.onKeyUp(e)}pollForStateAndUpdate(){const e=this.root.pollForCommandState(this.properties$2.Command,this.properties$2.QueryCommand,this.stateProperties),t=(1&e)>0;let n=!0;if(Qt.d(this.properties$2.CommandMenuOpen))n=t;else{n=(1&this.root.pollForCommandState(this.properties$2.CommandMenuOpen,null,null))>0}if(n===this._menuButtonEnabled&&t===this._buttonEnabled&&(n||t)===this.control.enabled||(this.control.enabled=n||t,t!==this._buttonEnabled&&this.onEnabledChangedForButton(t),n!==this._menuButtonEnabled&&this.onEnabledChangedForMenu(n),this._menuButtonEnabled=n,this._buttonEnabled=t),(2&e)>0){this.updateImage();const e=Kt.a.validateStringProperty(this.stateProperties[Zn.a.LabelText],this.properties$2.LabelText);if(this.stateProperties[Zn.a.ApplyLabelTextToControlOnly]?this.splitButton.forEachSplitButtonComponentDom((t=>{t.elmControl.title=e,t.elmButtonPart.removeAttribute(Yn),t.elmMenuLauncherPart.removeAttribute(Yn)})):this.splitButton.forEachSplitButtonComponentDom((t=>{t.elmButtonPart.title=e})),this.stateProperties[Zn.a.EnsureControlRoleIsButton]&&this.splitButton.forEachSplitButtonComponentDom((e=>{qe.a.setAriaAttribute(e.elmControl,qe.a.ariaRoleAttribute,qe.a.ariaButtonRole)})),!Qt.d(this.stateProperties[Zn.a.Visible])){this.updateVisibility()&&this.updateHtml()}}this.splitButton.setState(this.splitButton.on&&t)}updateHtml(){this.updateLabelText(),this.updateTooltip(),this.updateImage()}onEnabledChangedForMenu(e){this.splitButton.forEachSplitButtonComponentDom((t=>{Kt.a.setEnabledOnElement(t.elmMenuLauncherPart,e)})),this.removeControlHighlight(),this._menuButtonEnabled=e}onEnabledChangedForButton(e){this.splitButton.forEachSplitButtonComponentDom((t=>{Kt.a.setEnabledOnElement(t.elmButtonPart,e)})),this.removeControlHighlight(),this._buttonEnabled=e}removeControlHighlight(){const e=this.splitButton.getDisplayedComponentElement();Qt.d(e)||(Kt.a.removeCSSClassFromElement(e.childNodes[0],Xn),Kt.a.removeCSSClassFromElement(e.childNodes[0],Jn),Kt.a.removeCSSClassFromElement(e.childNodes[1],Xn),Kt.a.removeCSSClassFromElement(e.childNodes[1],Jn))}onButtonPointerDown(e){let t=!1;const n=e.inputSource;switch(n){case 3:this.shouldUseFlyoutBehaviorOnTouch()?(this.doDefaultAction(this.displayedComponent.elementInternal,n,e.innerEvent),t=!0):(this.activateElement(this.splitButton.displayedButtonElement),t=!0);break;case 2:e.mouseButton===Sys.UI.MouseButton.leftButton&&(this.activateElement(this.splitButton.displayedButtonElement),t=!0)}return t&&e.innerEvent.preventDefault(),!1}shouldUseFlyoutBehaviorOnTouch(){const e=this.displayedComponent.displayMode;return"Small"===e||"Medium"===e||"Menu16"===e||"MenuTellMe"===e}onButtonPointerUp(e){return this.deactivateElement(e)}onButtonTouchMove(e){return this.onActivePointerMove(e)}onButtonTouchEnd(e){return this.deactivateElement(e)}onFocus(e){return super.onFocus(e),this.highlightControl(!0,!0),!1}onBlur(e){return super.onFocus(e),this.removeControlHighlight(),!1}onButtonPointerOver(e){return this.control.enabled&&this._buttonEnabled&&this.highlightControl(!0,this.splitButton.on),!1}onButtonPointerOut(e){return this.control.enabled&&this._buttonEnabled&&this.removeControlHighlight(),!1}onMenuButtonPointerDown(e){let t=!1;return 2===e.inputSource&&e.mouseButton!==Sys.UI.MouseButton.leftButton||(this.doDefaultAction(e.sourceElement,e.inputSource,e.innerEvent),t=!0),t&&e.innerEvent.preventDefault(),!1}onMenuButtonPointerOver(e){return this.control.enabled&&this._menuButtonEnabled&&this.highlightControl(this.splitButton.on,!0),!1}onMenuButtonPointerOut(e){return this.removeControlHighlight(),!1}highlightControl(e,t){const n=this.control.getDisplayedComponentElement();Qt.d(n)||(Kt.a.ensureCSSClassOnElement(n.childNodes[0],e?Xn:Jn),Kt.a.ensureCSSClassOnElement(n.childNodes[1],t?Xn:Jn))}constructor(e){super(e),this._menuButtonEnabled=!0,this._buttonEnabled=!1}}(0,s.a)($n,"SplitButtonBehavior",An,[]);var ea=__webpack_require__(3497);class ta extends zt{get textBox(){return this.control}get textBoxDom(){return this.textBox.textBoxDom}get tbProperties(){return this.textBox.controlProperties}attachEvents(e){const t=e.elmInput;le.a.instance.registerHandler(ce.a.focus,t,(0,Ee.a)(this,this.onFocus,"onFocus")),le.a.instance.registerHandler(ce.a.blur,t,(0,Ee.a)(this,this.onBlur,"onBlur")),Lt.a.instance.registerHandler(ce.a.keyDown,t,(0,Ee.a)(this,this.onKeyDown,"onKeyDown")),Lt.a.instance.registerHandler(ce.a.keyPress,t,this.onKeyPress),Lt.a.instance.registerHandler(ce.a.keyUp,t,(0,Ee.a)(this,this.onKeyUp,"onKeyUp")),le.a.instance.registerHandler(ce.a.change,t,this.onChange),vn.a.instance.registerHandler(ce.a.mouseUp,t,this.onMouseUp)}onFocus(e){return super.onFocus(e),this._inputFocused=!0,Kt.a.ensureCSSClassOnElement(this.textBoxDom.elmControl,"cui-tb-focus"),this.control.enabled&&Ce.a.selectAllTextInInput(this.textBoxDom.elmInput),this._mouseupOnTextboxSinceFocus=!1,!1}onBlur(e){return this._inputFocused=!1,super.onBlur(e),Kt.a.removeCSSClassFromElement(this.textBoxDom.elmControl,"cui-tb-focus"),!1}onKeyDown(e){let t=super.onKeyDown(e);if(!Qt.d(e.innerEvent)&&!Qt.d(e.innerEvent.rawEvent)){const n=e.innerEvent.rawEvent,a=e.innerEvent.keyCode;n.shiftKey;a===Sys.UI.Key.tab?this.commitPendingChange():a===Sys.UI.Key.enter?this._excelTableRenameEnabled&&(this.commitPendingChange(),t=!0):a===Sys.UI.Key.esc?(this.resetInputToPreviousValue(),t=!0):a===Sys.UI.Key.backspace||a===Sys.UI.Key.del?t=!this.control.enabled:e.commandKey}return t}onKeyUp(e){return!1}setInputValue(e){this.textBoxDom.elmInput.value!==e&&(this.textBoxDom.elmInput.value=e)}resetInputToPreviousValue(){this.setInputValue(this.stateProperties[ea.a.Text])}commitPendingChange(){if(this.control.enabled&&this.textBoxDom.isEditable){const e=this.stateProperties[ea.a.Text],t=this.textBoxDom.elmInput.value;t!==e&&(this.stateProperties[ea.a.Text]=t,this.root.executeCommand(this.tbProperties.Command,this.stateProperties,this.displayedComponent,0,!1))}else this.resetInputToPreviousValue()}pollForStateAndUpdate(){const e=this.stateProperties[ea.a.Text];if((2&this.pollForStateAndUpdateInternal(this.tbProperties.Command,this.tbProperties.QueryCommand,this.stateProperties))>0&&!this._inputFocused){const t=this.stateProperties[ea.a.Text];t!==e&&this.setInputValue(t)}}constructor(e){super(e),this._mouseupOnTextboxSinceFocus=!1,this._inputFocused=!1,this._excelTableRenameEnabled=!!A.AFrameworkApplication.appSettingsManager&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelTableRenameEnabled"),this.onKeyPress=e=>!this.control.enabled,this.onChange=e=>(this.commitPendingChange(),!1),this.onMouseUp=e=>this.textBoxDom.isEditable?!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0):(Ce.a.selectAllTextInInput(this.textBoxDom.elmInput),!0)}}(0,s.a)(ta,"TextBoxBehavior",zt,[474,472]);var na=__webpack_require__(5474);class aa extends zt{get toggleButton(){return this.control}get properties(){return this.control.controlProperties}doDefaultAction(e,t,n){this.control.enabled&&(Kt.a.isFalse(this.properties.TogglesWhenExecuted)||this.toggle(),this.stateProperties.CommandValueId=this.toggleButton.getCommandValueId(),this.stateProperties.MenuItemId=this.toggleButton.getMenuItemId(),this.stateProperties.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.stateProperties,this.displayedComponent,t,!Kt.a.isFalse(this.properties.CloseMenuWhenExecuted),(e=>{Kt.a.isTrue(this.properties.UpdateHtmlPostToggle)&&(32===e?this.toggleUx():this.toggleState())}),this.getTelemetryData(n)))}toggleState(){const e=!this.stateProperties[Ht.a.On];this.stateProperties[Ht.a.On]=e}toggleUx(){const e=this.stateProperties[Ht.a.On];this.toggleButton.setState(e),(this.toggleButton.useCheckMark&&this.toggleButton.useUncheckedImage||Kt.a.isTrue(this.properties.UpdateHtmlPostToggle))&&this.updateHtml()}toggle(){this.toggleState(),Kt.a.isTrue(this.properties.UpdateHtmlPostToggle)||this.toggleUx()}onKeyDown(e){const t=super.onKeyDown(e);if(!t&&!Qt.d(e.innerEvent)&&this.parentMenu){const t=e.innerEvent.keyCode;t!==Sys.UI.Key.enter&&t!==Sys.UI.Key.space||e.innerEvent.preventDefault()}return t}pollForStateAndUpdate(){Qt.d(this.properties.MenuItemId)||(this.stateProperties.MenuItemId=this.properties.MenuItemId);if((2&this.pollForStateAndUpdateInternal(this.properties.Command,this.properties.QueryCommand,this.stateProperties))>0){this.updateVisibility()&&this.updateHtml()}}updateHtml(){this.toggleButton.setState(this.stateProperties[Ht.a.On]),this.updateDisplayMode(Kt.a.validateStringProperty(this.stateProperties[Ht.a.DisplayMode],"")),this.updateLabelText(),this.updateImage(),this.updateLargeMenu(),Ht.a.Alt in this.stateProperties&&this.updateTooltip()}updateLargeMenu(){const e=this.controlComponentDomCache.largeMenu;if(e&&e.elmDescription){const t=Kt.a.validateStringProperty(this.stateProperties[Ht.a.Description],this.properties.Description);if(t!==e.elmDescription.innerText&&(e.elmDescription.innerText=t,e.elmLabel&&!(0,i.a)(na.a,this.root))){const n=!Qt.b(t);Kt.a.toggleCSSClassOnElement(e.elmLabel,"UIFontBold",n),Kt.a.toggleCSSClassOnElement(e.elmLabel,"cui-ctl-mediumlabel-nodescription",!n)}}}attachEvents(e){const t=e.elmControl;le.a.instance.registerHandler(ce.a.focus,t,(0,Ee.a)(this,this.onFocus,"onFocus")),le.a.instance.registerHandler(ce.a.blur,t,(0,Ee.a)(this,this.onBlur,"onBlur")),Ut.a.instance.registerHandler(ce.a.pointerOver,t,(0,Ee.a)(this,this.onPointerOver,"onPointerOver")),Ut.a.instance.registerHandler(ce.a.pointerOut,t,(0,Ee.a)(this,this.onPointerOut,"onPointerOut")),Lt.a.instance.registerHandler(ce.a.keyDown,t,(0,Ee.a)(this,this.onKeyDown,"onKeyDown")),Lt.a.instance.registerHandler(ce.a.keyUp,t,(0,Ee.a)(this,this.onKeyUp,"onKeyUp")),Ut.a.instance.registerHandler(ce.a.pointerDown,t,(0,Ee.a)(this,this.onPointerDown,"onPointerDown")),Ut.a.instance.registerHandler(ce.a.pointerUp,t,(0,Ee.a)(this,this.onPointerUp,"onPointerUp")),jt.a.instance.registerHandler(ce.a.click,t,(0,Ee.a)(this,this.onClick,"onClick")),Zt.a.instance.registerHandler(ce.a.touchMove,t,(0,Ee.a)(this,this.onTouchMove,"onTouchMove")),Zt.a.instance.registerHandler(ce.a.touchEnd,t,(0,Ee.a)(this,this.onTouchEnd,"onTouchEnd"))}constructor(e){super(e)}}(0,s.a)(aa,"ToggleButtonBehavior",zt,[]);class ia{enableInsertTable(){this._factoryMethods[Nt.a.insertTableControlType]=e=>new On(e)}enableSlider(){this._factoryMethods[Nt.a.sliderControlType]=e=>new Kn(e)}enableSpinner(){this._factoryMethods[Nt.a.spinnerControlType]=e=>new jn(e)}getBehaviorForControl(e){const t=this._factoryMethods[e.controlType],n=t?t(e):null;return n&&this._commitChangeFixEnabled&&n.enableCommitChangeFix(),n}static get instance(){return ia._instance||(ia._instance=new ia(!!A.AFrameworkApplication.appSettingsManager&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CUICommitChangeFixIsEnabled")))}constructor(e){this._commitChangeFixEnabled=e,this._factoryMethods={Button:e=>new Xt(e),FileMenuButton:e=>new Xt(e),ColorPicker:e=>new nn(e),ComboBox:e=>new In(e),ContextMenuControl:e=>new En(e),ContextMenuLauncher:e=>new En(e),DialogMenuLauncher:e=>new Mn(e),DropDown:e=>new Tn(e),FlyoutAnchor:e=>new Pn(e),GalleryButton:e=>new Rn(e),StatefulColorFlyoutAnchor:e=>new Pn(e),JewelMenuLauncher:e=>new Bn(e),Label:e=>new Wn(e),Placeholder:e=>new zt(e),SearchBox:e=>new Gn(e),Separator:e=>new zt(e),SplitButton:e=>new $n(e),StatefulColorSplitButton:e=>new $n(e),StatefulImageSplitButton:e=>new $n(e),TextBox:e=>new ta(e),ToggleButton:e=>new aa(e)}}}ia._instance=null,(0,s.a)(ia,"ControlBehaviorFactory",null,[204]);class oa{get name(){return"CUI.Behavior"}configure(e){A.AFrameworkApplication.appSettingsManager&&A.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AccessibleMovingDialogsEnabled")&&e.registerOnDemandResolveToken(Ot,[kt.a]),e.registerOnDemandResolveToken(Mt,[It])}async initializeAsync(){Bt.a.controlBehaviorFactory=ia.instance;const e=Et.a.instance.roots;for(let t=0;t<e.length;++t){const n=(0,_e.a)(30,e[t]);n&&n.ensureBehaviorAttached()}M.a.get_instance().setAppInitializationStatus(6)}dispose(){}static main(){Z.a.instance.registerAsyncPackage(new oa,5)}}(0,s.a)(oa,"CuiBehaviorPackage",null,[24,1]);var ra=__webpack_require__(4153);const sa=(0,te.b)("Common.App.IWACAppFeedbackParameters"),la=(0,te.e)(sa);var ca=__webpack_require__(3332);class da{getAppData(e){return null}getNPSBrsForApp(){return"WordNPSFloodgateEnabled"}getNPSDelayInMsBrsForApp(){return"WordNPSDelayInMilliseconds"}getNPSUsageActivityName(){return"AppUsageNPS"}getNPSFollowupActivityName(){return"AppUsageTimeSatisfiedNPS"}getCampaignDefinitions(){return N.c(window.WordAppCampaignsObj)}getUserInitiatedSurvey(e){return ca.a.getUserInitiatedSurvey(e,"WordUserInitiatedSurveysDictionary")}}(0,s.a)(da,"WordFeedbackAppData",null,[6]);var ua=__webpack_require__(2280);class pa{get useCustomizedAppFloodgateStartStop(){return!1}getAppSpecificFeedbackData(){return ua.a.instance.tryResolve(ra.a)}}(0,s.a)(pa,"WordFeedbackParameters",null,[26]);class ga{get name(){return"WordShared.WordFeedback"}configure(e){this._container=e,this._container.registerFactory("WordShared.WordFeedback.WordFeedbackParameters",(()=>new pa)).as(la.identifier).singleInstance(),e.resolve(la),e.register(6,"Common.App.IAppSpecificFeedbackData").singleInstance().usingFactory((()=>new da))}init(){this._container.tryResolve(ra.a)}dispose(){}static main(){Z.a.instance.registerPackage(new ga,0,!0)}constructor(){this._container=null}}(0,s.a)(ga,"PackageManager",null,[7,1]);a(Error),Type.registerNamespace("CommandUI"),Type.registerNamespace("CommandUI.Controls"),Type.registerNamespace("CommandUI.Controls.SearchBoxComponents"),Type.registerNamespace("CommandUI.React"),Type.registerNamespace("Box4"),Type.registerNamespace("Wac.Common"),Type.registerNamespace("Wac.Common.Utils"),Type.registerNamespace("WordShared"),Type.registerNamespace("WordViewer"),Type.registerNamespace("WordViewer.Comments"),Type.registerNamespace("WordViewer.Controls"),Type.registerNamespace("WordViewer.DisplayManager"),Type.registerNamespace("WordViewer.DocumentData"),Type.registerNamespace("WordViewer.DynamicScriptLoader"),Type.registerNamespace("WordViewer.PageInfo"),Type.registerNamespace("WordViewer.Search"),Type.registerNamespace("WordViewer.Selection"),Type.registerNamespace("WordShared.WordFeedback"),Type.registerNamespace("Sys"),window.IEnumerator=4,window.IEnumerable=5,Type.registerNamespace("$$sc"),window.$$ct=o,window.$$as=function(e,t){return e.isInstanceOfType(t)?t:null},r.Task._factory=new d,c.a._default=new u,c.a._current=c.a._default,Type.registerNamespace("Common.Collections"),Type.registerNamespace("System.Collections.Generic"),Type.registerNamespace("Common"),Type.registerNamespace("Common.Utils"),Type.registerNamespace("System"),window.isUndefined=function(e){return void 0===e},window.isNull=function(e){return null===e},window.isNullOrUndefined=function(e){return null==e},Type.registerNamespace("Common"),window.Common.AsynchronousXMLHttpExecutor=p.a,window.Common.SynchronousXMLHttpExecutor=g.a,window.Common.FetchKeepAliveExecutor=h.a,(()=>{Type.registerNamespace("Otel");var t=e;window.otel=t})(),Type.registerNamespace("Common"),Type.registerNamespace("Diag"),Type.registerNamespace("DiagUse"),(()=>{Type.registerNamespace("AppRealtimeChannel"),Type.registerNamespace("CommandUI"),Type.registerNamespace("Common"),Type.registerNamespace("Common.AdaptiveLayout"),Type.registerNamespace("Common.App"),Type.registerNamespace("Common.App.AccountSwitching"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),Type.registerNamespace("Common.App.BasicChat"),Type.registerNamespace("Common.App.CatchUpActivity"),Type.registerNamespace("Common.App.CoauthTelemetry"),Type.registerNamespace("Common.App.ConsentNoticeDialog"),Type.registerNamespace("Common.App.LiveMeeting"),Type.registerNamespace("Common.App.NetworkConnectivity"),Type.registerNamespace("Common.App.O365Shell"),Type.registerNamespace("Common.App.OAuth"),Type.registerNamespace("Common.App.RtcHostNotificationSubscription"),Type.registerNamespace("Common.App.SaveStatus"),Type.registerNamespace("Common.App.SearchCommon"),Type.registerNamespace("Common.App.SensitiveLogging"),Type.registerNamespace("Common.App.SharedFilePicker"),Type.registerNamespace("Common.App.SkypeChat"),Type.registerNamespace("Common.App.Throttling"),Type.registerNamespace("Common.App.VNext"),Type.registerNamespace("Common.App.VisibilityManagement"),Type.registerNamespace("Common.App.WopiIdentity"),Type.registerNamespace("Common.AppResourceLoader"),Type.registerNamespace("Common.Comments"),Type.registerNamespace("Common.CustomEvents"),Type.registerNamespace("Common.Interface"),Type.registerNamespace("Common.MruV2"),Type.registerNamespace("Common.NetworkTiming"),Type.registerNamespace("Common.UI"),Type.registerNamespace("Common.Utils"),Type.registerNamespace("Common.Utils.Aggregators"),Type.registerNamespace("Common.Utils.System"),Type.registerNamespace("Common.Utils.Telemetry"),Type.registerNamespace("CommonUI"),Type.registerNamespace("System"),Type.registerNamespace("common"),window.healthSmall={Health:x.a},window.Common.AFrameworkApplication=A.AFrameworkApplication,window.hardSigninCompleted=T,window.Common.TestHarnessInterface=v.a,window.Common.ActionDataContainer=w,window.Common.CrossDomainRequestExecutor=F.a,window.Common.UISurfaces=I.a,window.Common.ObjectModelUtils=E.a,window.Common.App.AppLifecycleManager=M.a,R.prototype.toString=D.prototype.toString;var e=t;window.qosWac=e})(),Type.registerNamespace("Common"),Type.registerNamespace("Common.App.OtelLibraryLoader"),J.main(),Type.registerNamespace("CommonUI"),Type.registerNamespace("Common.App.BrowserInfoLogger"),$.main(),Type.registerNamespace("Common"),Type.registerNamespace("Common.App.Diagnostics"),ee.main(),Type.registerNamespace("Common.App.AccessibilityHelpDialog"),Type.registerNamespace("Common.App.ContentSecurityPolicy"),se.main(),Type.registerNamespace("Common"),Fe.main(),Type.registerNamespace("Common"),Type.registerNamespace("Common"),Z.a.instance.registerAsyncPackage(new Ue),Type.registerNamespace("CAUI"),Oe.a.main(),Type.registerNamespace("CADWLTR"),Be.main(),Type.registerNamespace("Common.App.Zoom"),Ne.main(),Type.registerNamespace("DiagUse"),Type.registerNamespace("Common.App.DirectPrint"),Z.a.instance.registerAsyncPackage(new ct),Type.registerNamespace("DiagUse"),Type.registerNamespace("Common.App.SafeLinks"),Type.registerNamespace("Common.App.Policy.Contracts"),window.dynamicScriptLoaderDependencies=dt,Z.a.instance.registerPackage(new Tt),Type.registerNamespace("Fdbk"),Type.registerNamespace("Common.App.CustomerFeedback"),__webpack_require__(2328).a.main(),window.g_jsLT=new Date,window.MSOJS=vt,window.WordViewer&&(window.WordViewer.App=wt.App),window.WordAppCampaignsObj=[{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2018-11-26T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in Word on the web.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2025-03-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2026-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordWebCommitNewCommentActivity",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"WordComment_FloodgatePromptTitle",Question:"WordComment_FloodgatePromptQuestion",YesLabel:"WordComment_FloodgatePrompt_YesLabel",NoLabel:"WordComment_FloodgatePrompt_NoLabel"},Rating:{Question:"WordComment_FloodgateRatingQuestion",RatingValuesAscending:["WordComment_FloodgateRating_1","WordComment_FloodgateRating_2","WordComment_FloodgateRating_3","WordComment_FloodgateRating_4","WordComment_FloodgateRating_5"]},Question:{Question:"WordComment_FloodgateWhyQuestion"}}}},{CampaignId:"f7a40541-26ec-4d83-b733-c62dafb28717",StartTimeUtc:"2020-05-07T07:00:00Z",EndTimeUtc:"2024-01-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"TextPredictionsSeen",IsAggregate:!0,Count:20},Content:{Prompt:{Title:"TextPredictions_FloodgatePromptTitle",Question:"TextPredictions_FloodgatePromptQuestion",YesLabel:"TextPredictions_FloodgatePrompt_YesLabel",NoLabel:"TextPredictions_FloodgatePrompt_NoLabel"},Rating:{Question:"TextPredictions_FloodgateRatingQuestion",RatingValuesAscending:["TextPredictions_FloodgateRating_1","TextPredictions_FloodgateRating_2","TextPredictions_FloodgateRating_3","TextPredictions_FloodgateRating_4","TextPredictions_FloodgateRating_5"]},Question:{Question:"TextPredictions_FloodgateQuestion"}}}},{CampaignId:"afe40876-4bfc-4bf5-8954-6cbec6f57171",StartTimeUtc:"2021-03-22T07:00:00Z",EndTimeUtc:"2025-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AutocorrectStringMatch",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"WordAutoCorrect_FloodgatePromptTitle",Question:"WordAutoCorrect_FloodgatePromptQuestion",YesLabel:"WordAutoCorrect_FloodgatePrompt_YesLabel",NoLabel:"WordAutoCorrect_FloodgatePrompt_NoLabel"},Rating:{Question:"WordAutoCorrect_FloodgateRatingQuestion",RatingValuesAscending:["WordAutoCorrect_FloodgateRating_1","WordAutoCorrect_FloodgateRating_2","WordAutoCorrect_FloodgateRating_3","WordAutoCorrect_FloodgateRating_4","WordAutoCorrect_FloodgateRating_5"]},Question:{Question:"WordAutoCorrect_FloodgateWhyQuestion"}}}},{CampaignId:"f09ecdb8-4df4-4b13-856b-b1dceaf46d42",StartTimeUtc:"2025-01-24T00:00:00Z",EndTimeUtc:"2025-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TrackChangesUsed",IsAggregate:!1,Count:2}]},Content:{Prompt:{Title:"WordTrackChanges_FloodgatePromptTitle",Question:"WordTrackChanges_FloodgatePromptQuestion",YesLabel:"WordTrackChanges_FloodgatePrompt_YesLabel",NoLabel:"WordTrackChanges_FloodgatePrompt_NoLabel"},Rating:{Question:"WordTrackChanges_FloodgateRatingQuestion",RatingValuesAscending:["WordTrackChanges_FloodgateRating_1","WordTrackChanges_FloodgateRating_2","WordTrackChanges_FloodgateRating_3","WordTrackChanges_FloodgateRating_4","WordTrackChanges_FloodgateRating_5"]},Question:{Question:"WordTrackChanges_FloodgateWhyQuestion"}}}},{CampaignId:"234ed236-e260-4bc7-b578-9aa6fdf8a542",StartTimeUtc:"2020-11-26T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PremiumPreviewSurveyNomination",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"PremiumPreviewFloodgateTitle",Question:"PremiumPreviewFloodgatePrompt",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"PremiumPreviewFloodgateRatingQuestion",RatingValuesAscending:["PremiumPreviewFloodgateMinRating","2","3","4","PremiumPreviewFloodgateMaxRating"]},Question:{Question:"PremiumPreviewFloodgateQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},{Type:0,Value:"fr-FR"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},{Type:0,Value:"it-IT"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"ar-SA"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IL"},{Type:0,Value:"he-IN"},{Type:0,Value:"hr-HR"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ko-KR"},{Type:0,Value:"ku-Arab-IQ"},{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184e3},CooldownPeriod:{Type:0,IntervalSeconds:15552e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"fe4e1e8c-baa1-4b67-a834-5785f17834bc",StartTimeUtc:"2024-04-01T00:00:00Z",EndTimeUtc:"2024-05-15T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"NavPaneUsed",IsAggregate:!0,Count:2},Content:{Prompt:{Title:"NavPaneExperience_FloodgatePromptTitle",Question:"NavPaneExperience_FloodgatePromptQuestion",YesLabel:"NavPaneExperience_FloodgatePrompt_YesLabel",NoLabel:"NavPaneExperience_FloodgatePrompt_NoLabel"},Rating:{Question:"NavPaneExperience_FloodgateRatingQuestion",RatingValuesAscending:["NavPaneExperience_FloodgateRating_1","NavPaneExperience_FloodgateRating_2","NavPaneExperience_FloodgateRating_3","NavPaneExperience_FloodgateRating_4","NavPaneExperience_FloodgateRating_5"]},Question:{Question:"NavPaneExperience_FloodgateWhyQuestion"}}}},{CampaignId:"ac69a7b0-7b64-4c10-b343-05b520354465",StartTimeUtc:"2020-08-01T00:00:00Z",EndTimeUtc:"2025-08-07T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:5,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"EditorInterceptNomination",Count:1,IsAggregate:!1}]},Content:{Intercept:{Title:"Talk to a Microsoft engineer to improve this experience",Question:"See available times",Url:"https://go.microsoft.com/fwlink/?linkid=2167286"}}}},{CampaignId:"219db704-c099-4c1b-8dae-9e2fbc9c0c07",StartTimeUtc:"2021-06-23T18:30:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:7776e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"WordListsExperience",IsAggregate:!0,Count:6},Content:{Prompt:{Title:"WordListsExperience_FloodgatePromptTitle",Question:"WordListsExperience_FloodgatePromptQuestion",YesLabel:"WordListsExperience_FloodgatePrompt_YesLabel",NoLabel:"WordListsExperience_FloodgatePrompt_NoLabel"},Rating:{Question:"WordListsExperience_FloodgateRatingQuestion",RatingValuesAscending:["WordListsExperience_FloodgateRating_1","2","3","4","WordListsExperience_FloodgateRating_5"]},Question:{Question:"WordListsExperience_FloodgateAdditionalThoughts"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2023-1-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4","FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},{CampaignId:"741df5be-ce8c-4592-b4fa-64b2009c3b94",StartTimeUtc:"2021-09-20T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordWebEditorSeen",IsAggregate:!1,Count:3}]},Content:{Prompt:{Title:"WordWebEditorSeen_FloodgatePromptTitle",Question:"WordWebEditorSeen_FloodgatePromptQuestion",YesLabel:"WordWebEditorSeen_FloodgatePrompt_YesLabel",NoLabel:"WordWebEditorSeen_FloodgatePrompt_NoLabel"},Rating:{Question:"WordWebEditorSeen_FloodgateRatingQuestion",RatingValuesAscending:["WordWebEditorSeen_FloodgateRating_1","WordWebEditorSeen_FloodgateRating_2","WordWebEditorSeen_FloodgateRating_3","WordWebEditorSeen_FloodgateRating_4","WordWebEditorSeen_FloodgateRating_5"]},Question:{Question:"WordWebEditorSeen_FloodgateWhyQuestion"}}}},{CampaignId:"78460ddc-73c6-469d-ba2e-6ba273770571",StartTimeUtc:"2021-10-10T18:30:00Z",EndTimeUtc:"2023-06-12T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ConsumerExperimentRetention",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"ConsumerExperiment_PromptTitle",Question:"ConsumerExperiment_PromptQuestion",YesLabel:"ConsumerExperiment_Sure",NoLabel:"ConsumerExperiment_NotNow"},Rating:{Question:"ConsumerExperiment_RatingQuestion",RatingValuesAscending:["ConsumerExperiment_RatingValue5","ConsumerExperiment_RatingValue4","ConsumerExperiment_RatingValue3","ConsumerExperiment_RatingValue2","ConsumerExperiment_RatingValue1"]},Question:{Question:"ConsumerExperiment_VerbatimQuestion"}}}},{CampaignId:"995e6f92-ce91-419d-92f1-9393efdbefbf",StartTimeUtc:"2023-02-07T18:30:00Z",EndTimeUtc:"2023-03-31T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"BookmarksUsage",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"BookmarksExperience_FloodgatePromptTitle",Question:"BookmarksExperience_FloodgatePromptQuestion",YesLabel:"BookmarksExperience_FloodgatePrompt_YesLabel",NoLabel:"BookmarksExperience_FloodgatePrompt_NoLabel"},Rating:{Question:"BookmarksExperience_FloodgateRatingQuestion",RatingValuesAscending:["BookmarksExperience_FloodgateRating_1","BookmarksExperience_FloodgateRating_2","BookmarksExperience_FloodgateRating_3","BookmarksExperience_FloodgateRating_4","BookmarksExperience_FloodgateRating_5"]},Question:{Question:"BookmarksExperience_FloodgateWhyQuestion"}}}},{CampaignId:"dffadbd8-8a05-4746-8f77-c5ee529a0b87",StartTimeUtc:"2021-11-05T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:30,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"DocumentModeSwitcherUsed",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"WordDocumentModes_FloodgatePromptTitle",Question:"WordDocumentModes_FloodgatePromptQuestion",YesLabel:"WordDocumentModes_FloodgatePrompt_YesLabel",NoLabel:"WordTDocumentMods_FloodgatePrompt_NoLabel"},Rating:{Question:"WordDocumentModes_FloodgateRatingQuestion",RatingValuesAscending:["WordDocumentModes_FloodgateRating_1","2","3","4","WordDocumentModes_FloodgateRating_5"]},Question:{Question:"WordDocumentModes_FloodgateWhyQuestion"}}}},{CampaignId:"80a4fe0a-3a9b-42ca-9388-dbd4e1ded5f4",StartTimeUtc:"2022-06-20T18:30:00Z",EndTimeUtc:"2024-09-30T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"FileBackedLoopComponentsSurvey",IsAggregate:!0,Count:2},Content:{Prompt:{Title:"FileBackedLoopComponents_FloodgatePromptTitle",Question:"FileBackedLoopComponents_FloodgatePromptQuestion",YesLabel:"FileBackedLoopComponents_FloodgatePromptAnswer_Sure",NoLabel:"FileBackedLoopComponents_FloodgatePromptAnswer_NotNow"},Rating:{Question:"FileBackedLoopComponents_FloodgateRatingQuestion",RatingValuesAscending:["FileBackedLoopComponents_FloodgateRatingValue_1","FileBackedLoopComponents_FloodgateRatingValue_2","FileBackedLoopComponents_FloodgateRatingValue_3","FileBackedLoopComponents_FloodgateRatingValue_4","FileBackedLoopComponents_FloodgateRatingValue_5"]},Question:{Question:"FileBackedLoopComponents_FloodgateWhyQuestion"}}}},{CampaignId:"a39f9642-7ab2-441f-a76c-47475a9dfcd0",StartTimeUtc:"2022-06-20T18:30:00Z",EndTimeUtc:"2024-09-30T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"PollLoopComponentSurvey",IsAggregate:!0,Count:2},Content:{Prompt:{Title:"PollLoopComponent_FloodgatePromptTitle",Question:"PollLoopComponent_FloodgatePromptQuestion",YesLabel:"PollLoopComponent_FloodgatePromptAnswer_Sure",NoLabel:"PollLoopComponent_FloodgatePromptAnswer_NotNow"},Rating:{Question:"PollLoopComponent_FloodgateRatingQuestion",RatingValuesAscending:["PollLoopComponent_FloodgateRatingValue_1","PollLoopComponent_FloodgateRatingValue_2","PollLoopComponent_FloodgateRatingValue_3","PollLoopComponent_FloodgateRatingValue_4","PollLoopComponent_FloodgateRatingValue_5"]},Question:{Question:"PollLoopComponent_FloodgateWhyQuestion"}}}},{CampaignId:"be44a820-34d0-4dae-8ddb-748c5cd80d41",StartTimeUtc:"2023-04-03T18:30:00Z",EndTimeUtc:"2023-09-30T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"RemoveLoopComponentsSurvey",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"RemoveLoopComponents_FloodgatePromptTitle",Question:"RemoveLoopComponents_FloodgatePromptQuestion",YesLabel:"RemoveLoopComponents_FloodgatePromptAnswer_Sure",NoLabel:"RemoveLoopComponents_FloodgatePromptAnswer_NotNow"},Rating:{Question:"RemoveLoopComponents_FloodgateRatingQuestion",RatingValuesAscending:["RemoveLoopComponents_FloodgateRatingValue_1","RemoveLoopComponents_FloodgateRatingValue_2","RemoveLoopComponents_FloodgateRatingValue_3","RemoveLoopComponents_FloodgateRatingValue_4","RemoveLoopComponents_FloodgateRatingValue_5"]},Question:{Question:"RemoveLoopComponents_FloodgateWhyQuestion"}}}},{CampaignId:"4cf8830e-9226-4f99-8c66-6facc79a6ece",StartTimeUtc:"2022-09-15T18:30:00Z",EndTimeUtc:"2023-01-30T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ShortcutDiscoveryUsageTreatment",IsAggregate:!0,Count:6},Content:{Prompt:{Title:"ShortcutDiscovery_PromptTitle",Question:"ShortcutDiscovery_PromptQuestion",YesLabel:"ShortcutDiscovery_PromptAnswer_Sure",NoLabel:"ShortcutDiscovery_PromptAnswer_NotNow"},Rating:{Question:"ShortcutDiscovery_RatingQuestion",RatingValuesAscending:["ShortcutDiscovery_RatingValue_1","ShortcutDiscovery_RatingValue_2","ShortcutDiscovery_RatingValue_3","ShortcutDiscovery_RatingValue_4","ShortcutDiscovery_RatingValue_5"]},Question:{Question:"ShortcutDiscovery_WhyQuestion"}}}},{CampaignId:"f83ef3db-a1ef-4151-888e-da0aa0bc4ec7",StartTimeUtc:"2023-02-10T18:30:00Z",EndTimeUtc:"2023-05-30T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"FontsSurveyActivity",IsAggregate:!0,Count:4},Content:{Prompt:{Title:"Fonts_PromptTitle",Question:"Fonts_PromptQuestion",YesLabel:"Fonts_PromptAnswer_Sure",NoLabel:"Fonts_PromptAnswer_NotNow"},Rating:{Question:"Fonts_RatingQuestion",RatingValuesAscending:["Fonts_RatingValue_1","Fonts_RatingValue_2","Fonts_RatingValue_3","Fonts_RatingValue_4","Fonts_RatingValue_5"]},Question:{Question:"Fonts_WhyQuestion"}}}},{CampaignId:"7fd10d06-c432-4295-81e2-85c1e7181f10",StartTimeUtc:"2024-01-17T18:30:00Z",EndTimeUtc:"2024-05-30T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"TableBorderUxFloodgateSurvey",IsAggregate:!0,Count:10},Content:{Prompt:{Title:"TableBorderUxSurvey_Title",Question:"TableBorderUxSurvey_Question",YesLabel:"TableBorderUxSurvey_YesLabel",NoLabel:"TableBorderUxSurvey_NoLabel"},Rating:{Question:"TableBorderUxSurvey_RatingQuestion",RatingValuesAscending:["TableBorderUxSurvey_RatingValue_1","TableBorderUxSurvey_RatingValue_2","TableBorderUxSurvey_RatingValue_3","TableBorderUxSurvey_RatingValue_4","TableBorderUxSurvey_RatingValue_5"]},Question:{Question:"TableBorderUxSurvey_WhyQuestion"}}}},{CampaignId:"9652de90-e5e0-40d1-95f3-35b37b92c281",StartTimeUtc:"2024-02-26T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:15,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordFluentIconsSurvey",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"WordFluentIcons_Prompt",Question:"WordFluentIcons_PromptQuestion",YesLabel:"WordFluentIcons_YesLabel",NoLabel:"WordFluentIcons_NoLabel"},Rating:{Question:"WordFluentIcons_RatingQuestion",RatingValuesAscending:["WordFluentIcons_RatingValue_1","WordFluentIcons_RatingValue_2","WordFluentIcons_RatingValue_3","WordFluentIcons_RatingValue_4","WordFluentIcons_RatingValue_5"]},Question:{Question:"WordFluentIcons_WhyQuestion"}}}},{CampaignId:"5830b334-b1e2-4c0b-90da-48c96d9dc2cf",StartTimeUtc:"2024-05-06T18:30:00Z",EndTimeUtc:"2024-10-06T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"FileMenuFloodgateSurveyActivity",IsAggregate:!0,Count:3},Content:{Prompt:{Title:"FileMenuSurvey_Title",Question:"FileMenuSurvey_Question",YesLabel:"FileMenuSurvey_YesLabel",NoLabel:"FileMenuSurvey_NoLabel"},Rating:{Question:"FileMenuSurvey_RatingQuestion",RatingValuesAscending:["FileMenuSurvey_RatingValue_1","FileMenuSurvey_RatingValue_2","FileMenuSurvey_RatingValue_3","FileMenuSurvey_RatingValue_4","FileMenuSurvey_RatingValue_5"]},Question:{Question:"FileMenuSurvey_WhyQuestion"}}}},{CampaignId:"452d469d-c62c-4683-a566-5f81d304dc07",StartTimeUtc:"2021-11-10T00:00:00Z",EndTimeUtc:"2023-08-04T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordDesignerSurveyNomination",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"WordDesignerFloodgateTitle",Question:"WordDesignerFloodgatePrompt",YesLabel:"WordDesignerFloodgatePromptYesLabel",NoLabel:"WordDesignerFloodgatePromptNoLabel"},Rating:{Question:"WordDesignerFloodgateRatingQuestion",RatingValuesAscending:["WordDesignerFloodgateMinRating","2","3","4","WordDesignerFloodgateMaxRating"]},Question:{Question:"WordDesignerFloodgateQuestion"}}}},{CampaignId:"405d306a-cc22-4be2-998e-7704700f6e9c",StartTimeUtc:"2021-11-16T00:00:00Z",EndTimeUtc:"2023-11-16T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:5}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"InDocSearchExecuted",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"FpsInDocSearch_FloodgatePromptTitle",Question:"FpsInDocSearch_FloodgatePromptQuestion",YesLabel:"FpsInDocSearch_FloodgatePrompt_YesLabel",NoLabel:"FpsInDocSearch_FloodgatePrompt_NoLabel"},Rating:{Question:"FpsInDocSearch_FloodgateRatingQuestion",RatingValuesAscending:["FpsInDocSearch_FloodgateRating_1","FpsInDocSearch_FloodgateRating_2","FpsInDocSearch_FloodgateRating_3","FpsInDocSearch_FloodgateRating_4","FpsInDocSearch_FloodgateRating_5"]},Question:{Question:"FpsInDocSearch_FloodgateWhyQuestion"}}}},{CampaignId:"afba8676-f67e-4698-b4f7-f83a85fcf690",StartTimeUtc:"2022-01-10T00:00:00Z",EndTimeUtc:"2023-08-04T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordDesignerT2ISurveyActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"WordDesignerFloodgateTitle",Question:"WordDesignerFloodgatePrompt",YesLabel:"WordDesignerFloodgatePromptYesLabel",NoLabel:"WordDesignerFloodgatePromptNoLabel"},Rating:{Question:"WordDesignerT2ISurveyQuestion",RatingValuesAscending:["WordDesignerFloodgateMinRating","2","3","4","WordDesignerFloodgateMaxRating"]},Question:{Question:"WordDesignerFloodgateQuestion"}}}},{CampaignId:"eae99dbb-440d-4054-be21-ad9b6747be79",StartTimeUtc:"2022-01-12T00:00:00Z",EndTimeUtc:"2023-08-04T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordDesignerPQSurveyActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"WordDesignerFloodgateTitle",Question:"WordDesignerFloodgatePrompt",YesLabel:"WordDesignerFloodgatePromptYesLabel",NoLabel:"WordDesignerFloodgatePromptNoLabel"},Rating:{Question:"WordDesignerPQSurveyQuestion",RatingValuesAscending:["WordDesignerFloodgateMinRating","2","3","4","WordDesignerFloodgateMaxRating"]},Question:{Question:"WordDesignerFloodgateQuestion"}}}},{CampaignId:"3860c018-2665-4854-a10b-30d165301e9a",StartTimeUtc:"2022-01-12T00:00:00Z",EndTimeUtc:"2023-08-04T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordDesignerFormattingSuggestionSurveyActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"WordDesignerFloodgateTitle",Question:"WordDesignerFloodgatePrompt",YesLabel:"WordDesignerFloodgatePromptYesLabel",NoLabel:"WordDesignerFloodgatePromptNoLabel"},Rating:{Question:"WordDesignerFormattingSuggestionsSurveyQuestion",RatingValuesAscending:["WordDesignerFloodgateMinRating","2","3","4","WordDesignerFloodgateMaxRating"]},Question:{Question:"WordDesignerFloodgateQuestion"}}}},{CampaignId:"9a44f06b-5caa-459f-8651-389215796056",StartTimeUtc:"2022-03-10T00:00:00Z",EndTimeUtc:"2026-04-10T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"WordDesignerHideAllSurveyActivity",IsAggregate:!1,Count:1},Content:{Prompt:{Title:"WordDesignerFloodgateTitle",Question:"WordDesignerFloodgatePrompt",YesLabel:"WordDesignerFloodgatePromptYesLabel",NoLabel:"WordDesignerFloodgatePromptNoLabel"},Rating:{Question:"WordDesignerHideSuggestionsQuestion",RatingValuesAscending:["WordDesignerHideSuggestionsAnswer4","WordDesignerHideSuggestionsAnswer3","WordDesignerHideSuggestionsAnswer2","WordDesignerHideSuggestionsAnswer1"]},Question:{Question:"WordDesignerFloodgateQuestion"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"282ai507",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"282ai507",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"ec93287e-c9bf-46eb-97b7-affce93091a5",LauncherType:"coachingux",StartTimeUtc:"2022-05-02T23:59:59Z",EndTimeUtc:"2022-10-31T23:59:59Z",Tags:["ShowTeachingUIForMathType"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForMathType",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lppr-id='MathTypeAddin']\"]",title:"Write math equations easily",description:"Math related add-in lets you quickly create more math formulas in your documents, already installed by you or your organization. Give it a try.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinMathType",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissMathTypeCallout",closeButtonAction:"event:CloseMathTypeCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"40fcb9ba-b513-4af8-b7ac-2441e4a63f46",StartTimeUtc:"2022-02-01T00:00:00Z",EndTimeUtc:"2024-03-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:40,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CIQ_AtInvoke",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CIQAtInvokeFPS_Title",Question:"CIQAtInvokeFPS_Question",YesLabel:"CIQAtInvokeFPS_YesLabel",NoLabel:"CIQAtInvokeFPS_NoLabel"},Rating:{Question:"CIQAtInvokeFPS_RatingQuestion",RatingValuesAscending:["CIQAtInvokeFPS_RatingValue_1","CIQAtInvokeFPS_RatingValue_2","CIQAtInvokeFPS_RatingValue_3","CIQAtInvokeFPS_RatingValue_4","CIQAtInvokeFPS_RatingValue_5"]},Question:{Question:"CIQAtInvokeFPS_WhyQuestion"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2023-06-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f37323",LauncherType:"coachingux",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2082-08-20T00:00:00Z",Tags:["ShowTeachingCalloutForAddinSharingButton"],PrimaryPriority:5,GovernedChannelType:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingCalloutForAddinSharingButton",Count:2,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='addInTaskPaneShareButton']\"]",title:"Like this add-in? Share it with others!",description:"You can share helpful add-ins here.",secondaryButtonText:"Not now"}}}},{CampaignId:"01c79522-214b-4f2f-8c71-c98a5b0327f7",StartTimeUtc:"2022-05-30T18:30:00Z",EndTimeUtc:"2022-07-14T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CtrlClickUsage",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CtrlClickExperience_FloodgatePromptTitle",Question:"CtrlClickExperience_FloodgatePromptQuestion",YesLabel:"CtrlClickExperience_FloodgatePrompt_YesLabel",NoLabel:"CtrlClickExperience_FloodgatePrompt_NoLabel"},Rating:{Question:"CtrlClickExperience_FloodgateRatingQuestion",RatingValuesAscending:["CtrlClickExperience_FloodgateRating_1","CtrlClickExperience_FloodgateRating_2","CtrlClickExperience_FloodgateRating_3","CtrlClickExperience_FloodgateRating_4","CtrlClickExperience_FloodgateRating_5"]},Question:{Question:"CtrlClickExperience_FloodgateWhyQuestion"}}}},{CampaignId:"6447e9c0-be46-4429-a8a9-de11f83c92e7",StartTimeUtc:"2022-02-25T00:00:00Z",EndTimeUtc:"2024-01-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"WordWebTypingResponsivenessSurveyTrigger",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"WordTypingResponsiveness_FloodgatePromptTitle",Question:"WordTypingResponsiveness_FloodgatePromptQuestion",YesLabel:"WordTypingResponsiveness_FloodgatePrompt_YesLabel",NoLabel:"WordTypingResponsiveness_FloodgatePrompt_NoLabel"},Rating:{Question:"WordTypingResponsiveness_FloodgateRatingQuestion",RatingValuesAscending:["WordTypingResponsiveness_FloodgateRating_1","WordTypingResponsiveness_FloodgateRating_2","WordTypingResponsiveness_FloodgateRating_3","WordTypingResponsiveness_FloodgateRating_4","WordTypingResponsiveness_FloodgateRating_5"]},Question:{Question:"WordTypingResponsiveness_FloodgateWhyQuestion"}}}},{CampaignId:"996382e4-abc1-444f-bb93-73194f96f672",StartTimeUtc:"2022-05-25T00:00:00Z",EndTimeUtc:"2023-08-04T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordDesignerAllContextualSuggestionsSurveyNominationActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"WordDesignerFloodgateTitle",Question:"WordDesignerFloodgatePrompt",YesLabel:"WordDesignerFloodgatePromptYesLabel",NoLabel:"WordDesignerFloodgatePromptNoLabel"},Rating:{Question:"WordDesignerFloodgateRatingQuestion",RatingValuesAscending:["WordDesignerFloodgateMinRating","2","3","4","WordDesignerFloodgateMaxRating"]},Question:{Question:"WordDesignerAllContextualSuggestionsFeedbackRatingQuestion"}}}},{CampaignId:"d4e894fd-bdf6-4a2c-a203-1cac6337de83",StartTimeUtc:"2022-07-31T22:00:00Z",EndTimeUtc:"2023-08-04T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordDesignerDesignerPasteSurveyActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"WordDesignerFloodgateTitle",Question:"WordDesignerFloodgatePrompt",YesLabel:"WordDesignerFloodgatePromptYesLabel",NoLabel:"WordDesignerFloodgatePromptNoLabel"},Rating:{Question:"WordDesignerDesignerPasteFeedbackRatingQuestion",RatingValuesAscending:["WordDesignerFloodgateMinRating","2","3","4","WordDesignerFloodgateMaxRating"]},Question:{Question:"WordDesignerFloodgateQuestion"}}}},{CampaignId:"adf41ad9-4c07-4ac0-9b70-04e4a2963244",StartTimeUtc:"2022-06-23T00:00:00Z",EndTimeUtc:"2022-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"EaseOfDiscoveringCommandSurvey",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"EaseOfDiscoveringCommand_Floodgate_PromptTitle",Question:"EaseOfDiscoveringCommand_Floodgate_PromptQuestion",YesLabel:"EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",NoLabel:"EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow"},Rating:{Question:"EaseOfDiscoveringCommand_Floodgate_RatingQuestion",RatingValuesAscending:["EaseOfDiscoveringCommand_Floodgate_RatingValue_1","EaseOfDiscoveringCommand_Floodgate_RatingValue_2","EaseOfDiscoveringCommand_Floodgate_RatingValue_3","EaseOfDiscoveringCommand_Floodgate_RatingValue_4","EaseOfDiscoveringCommand_Floodgate_RatingValue_5"]},Question:{Question:"EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion"}}}},{CampaignId:"8207f815-db2b-4634-ac3c-2396dc8d5665",StartTimeUtc:"2022-06-23T00:00:00Z",EndTimeUtc:"2022-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"EaseOfEditingAndFormattingSurvey",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"EaseOfEditingAndFormatting_Floodgate_PromptQuestion",Question:"EaseOfEditingAndFormatting_Floodgate_PromptQuestion",YesLabel:"EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",NoLabel:"EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow"},Rating:{Question:"EaseOfEditingAndFormatting_Floodgate_RatingQuestion",RatingValuesAscending:["EaseOfEditingAndFormatting_Floodgate_RatingValue_1","EaseOfEditingAndFormatting_Floodgate_RatingValue_2","EaseOfEditingAndFormatting_Floodgate_RatingValue_3","EaseOfEditingAndFormatting_Floodgate_RatingValue_4","EaseOfEditingAndFormatting_Floodgate_RatingValue_5"]},Question:{Question:"EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion"}}}},{CampaignId:"6ed0062e-a1c5-4aa6-8873-6610ef140ca5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2022-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"DarkModeOptInFPS",IsAggregate:!0,Count:10}]},Content:{Prompt:{Title:"DarkModeSurvey_Title",Question:"DarkModeSurvey_Question",YesLabel:"DarkModeSurvey_YesLabel",NoLabel:"DarkModeSurvey_NoLabel"},Rating:{Question:"DarkModeSurvey_RatingQuestion",RatingValuesAscending:["DarkModeSurvey_RatingValue_1","DarkModeSurvey_RatingValue_2","DarkModeSurvey_RatingValue_3","DarkModeSurvey_RatingValue_4","DarkModeSurvey_RatingValue_5"]},Question:{Question:"DarkModeSurvey_WhyQuestion"}}}},{CampaignId:"1a86c4c1-2bab-49c0-82cb-7eb38919f547",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2022-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"DarkModeDefaultOnFPS",IsAggregate:!0,Count:10}]},Content:{Prompt:{Title:"DarkModeSurvey_Title",Question:"DarkModeSurvey_Question",YesLabel:"DarkModeSurvey_YesLabel",NoLabel:"DarkModeSurvey_NoLabel"},Rating:{Question:"DarkModeSurvey_RatingQuestion",RatingValuesAscending:["DarkModeSurvey_RatingValue_1","DarkModeSurvey_RatingValue_2","DarkModeSurvey_RatingValue_3","DarkModeSurvey_RatingValue_4","DarkModeSurvey_RatingValue_5"]},Question:{Question:"DarkModeSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"WordPenNsatSurvey",IsAggregate:!0,Count:3},Content:{Prompt:{Title:"WordPenNSAT_FloodgatePromptTitle",Question:"WordPenNSAT_FloodgatePromptQuestion",YesLabel:"WordPenNSAT_FloodgatePrompt_YesLabel",NoLabel:"WordPenNSAT_FloodgatePrompt_NoLabel"},Rating:{Question:"WordPenNSAT_FloodgateRatingQuestion",RatingValuesAscending:["WordPenNSAT_FloodgateRating_1","WordPenNSAT_FloodgateRating_2","WordPenNSAT_FloodgateRating_3","WordPenNSAT_FloodgateRating_4","WordPenNSAT_FloodgateRating_5"]},Question:{Question:"WordPenNSAT_FloodgateWhyQuestion"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2024-01-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1","Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"1cfa6092-1ea8-41c5-9855-1441ae3e835a",StartTimeUtc:"2022-11-08T00:00:00Z",EndTimeUtc:"2024-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AIMakerProactiveSurveyActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"AIMakerSurvey_Title",Question:"AIMakerSurvey_Question",YesLabel:"AIMakerSurvey_YesLabel",NoLabel:"AIMakerSurvey_NoLabel"},Rating:{Question:"AIMakerSurvey_RatingQuestion",RatingValuesAscending:["AIMakerSurvey_MinRating","2","3","4","AIMakerSurvey_MaxRating"]},Question:{Question:"AIMakerSurvey_CommentQuestion"}}}},{CampaignId:"cba9b80d-87af-4640-94be-10241d0e001d",StartTimeUtc:"2024-08-21T18:30:00Z",EndTimeUtc:"2025-03-30T18:30:00Z",PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CCPUsage",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"CCPExperience_FloodgatePromptTitle",Question:"CCPExperience_FloodgatePromptQuestion",YesLabel:"CCPExperience_FloodgatePrompt_YesLabel",NoLabel:"CCPExperience_FloodgatePrompt_NoLabel"},Rating:{Question:"CCPExperience_FloodgateRatingQuestion",RatingValuesAscending:["CCPExperience_FloodgateRating_1","CCPExperience_FloodgateRating_2","CCPExperience_FloodgateRating_3","CCPExperience_FloodgateRating_4","CCPExperience_FloodgateRating_5"]},Question:{Question:"CCPExperience_FloodgateWhyQuestion"}}}},{CampaignId:"852984f2-1193-4eb3-aa14-8d7eea73f469",StartTimeUtc:"2023-02-01T00:00:00Z",EndTimeUtc:"2024-02-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CIQ_SeenNotKept",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"CIQSeenNotKeptFPS_Title",Question:"CIQSeenNotKeptFPS_Question",YesLabel:"CIQSeenNotKeptFPS_YesLabel",NoLabel:"CIQSeenNotKeptFPS_NoLabel"},Rating:{Question:"CIQAtInvokeFPS_RatingQuestion",RatingValuesAscending:["CIQSeenNotKeptFPS_RatingValue_No","CIQSeenNotKeptFPS_RatingValue_Yes"]},Question:{Question:"CIQSeenNotKeptFPS_WhyQuestion"}}}},{CampaignId:"887d99e6-4bcf-4175-984e-e926e0ec8ebc",StartTimeUtc:"2023-04-05T00:00:00Z",EndTimeUtc:"2025-04-05T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"WordWebColumnsActivity",IsAggregate:!0,Count:3},Content:{Prompt:{Title:"MultiColumnsSurvey_Title",Question:"MultiColumnsSurvey_Question",YesLabel:"MultiColumnsSurvey_YesLabel",NoLabel:"MultiColumnsSurvey_NoLabel"},Rating:{Question:"MultiColumnsSurvey_RatingQuestion",RatingValuesAscending:["MultiColumnsSurvey_RatingValue_1","2","3","4","MultiColumnsSurvey_RatingValue_5"]},Question:{Question:"MultiColumnsSurvey_ImproveQuestion"}}}},{CampaignId:"45f045b2-3824-42a5-b44b-1c33cbb2b81e",StartTimeUtc:"2023-04-25T00:00:00Z",EndTimeUtc:"2023-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"SingleLineToolBarOptOut",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"ToolbarOptOut_Floodgate_Prompt_Line1",Question:"ToolbarOptOut_Floodgate_Prompt_Line2",YesLabel:"ToolbarOptOut_Floodgate_Prompt_Affirmative_Answer",NoLabel:"ToolbarOptOut_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"ToolbarOptOut_Floodgate_Rating_Question",RatingValuesAscending:["ToolbarOptOut_Floodgate_Rating_Scale_1","ToolbarOptOut_Floodgate_Rating_Scale_2"]},Question:{Question:"ToolbarOptOut_Floodgate_Comment_Question"}}}},{CampaignId:"27aeaf9b-55e2-481c-8fc6-4bc7c9ab4d48",StartTimeUtc:"2022-04-25T00:00:00Z",EndTimeUtc:"2024-08-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"FluidOnWebCoauthSentimentSurvey",IsAggregate:!0,Count:2},Content:{Prompt:{Title:"FluidOnWebCoauthSentimentSurvey_FloodgatePromptTitle",Question:"FluidOnWebCoauthSentimentSurvey_FloodgatePromptQuestion",YesLabel:"FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_YesLabel",NoLabel:"FluidOnWebCoauthSentimentSurvey_FloodgatePrompt_NoLabel"},Rating:{Question:"FluidOnWebCoauthSentimentSurvey_FloodgateRatingQuestion",RatingValuesAscending:["FluidOnWebCoauthSentimentSurvey_FloodgateRating_1","FluidOnWebCoauthSentimentSurvey_FloodgateRating_2","FluidOnWebCoauthSentimentSurvey_FloodgateRating_3","FluidOnWebCoauthSentimentSurvey_FloodgateRating_4","FluidOnWebCoauthSentimentSurvey_FloodgateRating_5"]},Question:{Question:"FluidOnWebCoauthSentimentSurvey_FloodgateWhyQuestion"}}}},{CampaignId:"fe3d8f8c-d3f1-45f0-a943-910002021efe",StartTimeUtc:"2023-05-08T00:00:00Z",EndTimeUtc:"2024-05-08T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:15,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordWebOnlineShareActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"WordOnlineShare_FloodgatePromptTitle",Question:"WordOnlineShare_FloodgatePromptQuestion",YesLabel:"WordOnlineShare_FloodgatePrompt_YesLabel",NoLabel:"WordOnlineShare_FloodgatePrompt_NoLabel"},Rating:{Question:"WordOnlineShare_FloodgateRatingQuestion",RatingValuesAscending:["WordOnlineShare_FloodgateRating_1","WordOnlineShare_FloodgateRating_2","WordOnlineShare_FloodgateRating_3","WordOnlineShare_FloodgateRating_4","WordOnlineShare_FloodgateRating_5"]},Question:{Question:"WordOnlineShare_FloodgateWhyQuestion"}}}},{CampaignId:"0e88a8b7-8edd-4396-84ae-22f369a3d4e0",StartTimeUtc:"2023-05-24T18:30:00Z",EndTimeUtc:"2023-11-24T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"UploadFileFeatureSurvey",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"UploadFileSurvey_PromptLine1",Question:"UploadFileSurvey_PromptLine2",YesLabel:"UploadFileSurvey_YesLabel",NoLabel:"UploadFileSurvey_NoLabel"},Rating:{Question:"UploadFileSurvey_RatingQuestion",RatingValuesAscending:["UploadFileSurvey_RatingValue1","UploadFileSurvey_RatingValue2","UploadFileSurvey_RatingValue3","UploadFileSurvey_RatingValue4","UploadFileSurvey_RatingValue5"]},Question:{Question:"UploadFileSurvey_CommentQuestion"}}}},{CampaignId:"15c0699c-d484-439d-9d8c-d01362e639c0",StartTimeUtc:"2023-06-25T07:00:00Z",EndTimeUtc:"2023-10-24T07:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:30,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AutoRenameSentimentSurvey",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"WordDocumentAutoRename_FloodgatePromptTitle",Question:"WordDocumentAutoRename_FloodgatePromptQuestion",YesLabel:"WordDocumentAutoRename_FloodgatePrompt_YesLabel",NoLabel:"WordDocumentAutoRename_FloodgatePrompt_NoLabel"},Rating:{Question:"WordDocumentAutoRename_FloodgateRatingQuestion",RatingValuesAscending:["WordDocumentAutoRename_FloodgateRating_1","WordDocumentAutoRename_FloodgateRating_2","WordDocumentAutoRename_FloodgateRating_3","WordDocumentAutoRename_FloodgateRating_4","WordDocumentAutoRename_FloodgateRating_5"]},Question:{Question:"WordDocumentAutoRename_FloodgateWhyQuestion"}}}},{CampaignId:"4e7ff77e-5397-4d27-b379-f1c6462ae461",StartTimeUtc:"2023-05-27T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordWebCommentFilterActivity",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"WordCommentFiltering_FloodgatePromptTitle",Question:"WordCommentFiltering_FloodgatePromptQuestion",YesLabel:"WordCommentFiltering_FloodgatePrompt_YesLabel",NoLabel:"WordCommentFiltering_FloodgatePrompt_NoLabel"},Rating:{Question:"WordCommentFiltering_FloodgateRatingQuestion",RatingValuesAscending:["WordCommentFiltering_FloodgateRating_1","WordCommentFiltering_FloodgateRating_2","WordCommentFiltering_FloodgateRating_3","WordCommentFiltering_FloodgateRating_4","WordCommentFiltering_FloodgateRating_5"]},Question:{Question:"WordCommentFiltering_FloodgateWhyQuestion"}}}},{CampaignId:"e4c983c8-ac64-4e93-85b4-b5d51d50f96c",StartTimeUtc:"2024-04-11T07:00:00Z",EndTimeUtc:"2024-05-25T07:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"FindReplaceExperienceSurvey",IsAggregate:!0,Count:2},Content:{Prompt:{Title:"WordDocumentFindReplace_FloodgatePromptTitle",Question:"WordDocumentFindReplace_FloodgatePromptQuestion",YesLabel:"WordDocumentFindReplace_FloodgatePrompt_YesLabel",NoLabel:"WordDocumentFindReplace_FloodgatePrompt_NoLabel"},Rating:{Question:"WordDocumentFindReplace_FloodgateRatingQuestion",RatingValuesAscending:["WordDocumentFindReplace_FloodgateRating_1","WordDocumentFindReplace_FloodgateRating_2","WordDocumentFindReplace_FloodgateRating_3","WordDocumentFindReplace_FloodgateRating_4","WordDocumentFindReplace_FloodgateRating_5"]},Question:{Question:"WordDocumentFindReplace_FloodgateWhyQuestion"}}}},{CampaignId:"d639f236-4cc7-4953-b418-289e83ef0ffd",StartTimeUtc:"2023-10-19T00:00:00Z",EndTimeUtc:"2024-10-19T00:00:00Z",GovernedChannelType:1,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office.Word.Copilot.CopilotUsageAskMTE",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"WordCopilot_Ask_FeelingsSurvey_FloodgatePromptTitle",Question:"WordCopilot_Ask_FeelingsSurvey_FloodgatePromptQuestion",YesLabel:"WordCopilot_Ask_FeelingsSurvey_FloodgatePrompt_YesLabel",NoLabel:"WordCopilot_Ask_FeelingsSurvey_FloodgatePrompt_NoLabel"},Rating:{Question:"WordCopilot_Ask_FeelingsSurvey_FloodgateRatingQuestion",RatingValuesAscending:["WordCopilot_Ask_FeelingsSurvey_FloodgateRating_0","WordCopilot_Ask_FeelingsSurvey_FloodgateRating_1","WordCopilot_Ask_FeelingsSurvey_FloodgateRating_2","WordCopilot_Ask_FeelingsSurvey_FloodgateRating_3","WordCopilot_Ask_FeelingsSurvey_FloodgateRating_4","WordCopilot_Ask_FeelingsSurvey_FloodgateRating_5"]},Question:{Question:"WordCopilot_Ask_FeelingsSurvey_FloodgateWhyQuestion"}}}},{CampaignId:"a0546b04-464b-411d-a364-eea9665d38c8",StartTimeUtc:"2023-10-19T00:00:00Z",EndTimeUtc:"2024-10-19T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office.Word.Copilot.CopilotUsageAskMTE",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"WordCopilot_Ask_TimeSavedSurvey_FloodgatePromptTitle",Question:"WordCopilot_Ask_TimeSavedSurvey_FloodgatePromptQuestion",YesLabel:"WordCopilot_Ask_TimeSavedSurvey_FloodgatePrompt_YesLabel",NoLabel:"WordCopilot_Ask_TimeSavedSurvey_FloodgatePrompt_NoLabel"},Rating:{Question:"WordCopilot_Ask_TimeSavedSurvey_FloodgateRatingQuestion",RatingValuesAscending:["WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_0","WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_1","WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_2","WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_3","WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_4","WordCopilot_Ask_TimeSavedSurvey_FloodgateRating_5"]},Question:{Question:"WordCopilot_Ask_TimeSavedSurvey_FloodgateWhyQuestion"}}}},{CampaignId:"72319e5d-e1f5-47ab-95ac-a1e8affb5083",StartTimeUtc:"2023-10-19T00:00:00Z",EndTimeUtc:"2024-10-19T00:00:00Z",GovernedChannelType:1,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office.Word.Copilot.CopilotUsageCommandMTE",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"WordCopilot_Command_FeelingsSurvey_FloodgatePromptTitle",Question:"WordCopilot_Command_FeelingsSurvey_FloodgatePromptQuestion",YesLabel:"WordCopilot_Command_FeelingsSurvey_FloodgatePrompt_YesLabel",NoLabel:"WordCopilot_Command_FeelingsSurvey_FloodgatePrompt_NoLabel"},Rating:{Question:"WordCopilot_Command_FeelingsSurvey_FloodgateRatingQuestion",RatingValuesAscending:["WordCopilot_Command_FeelingsSurvey_FloodgateRating_0","WordCopilot_Command_FeelingsSurvey_FloodgateRating_1","WordCopilot_Command_FeelingsSurvey_FloodgateRating_2","WordCopilot_Command_FeelingsSurvey_FloodgateRating_3","WordCopilot_Command_FeelingsSurvey_FloodgateRating_4","WordCopilot_Command_FeelingsSurvey_FloodgateRating_5"]},Question:{Question:"WordCopilot_Command_FeelingsSurvey_FloodgateWhyQuestion"}}}},{CampaignId:"02d3a2eb-9e65-486a-9165-b84d0092734d",StartTimeUtc:"2023-10-19T00:00:00Z",EndTimeUtc:"2024-10-19T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office.Word.Copilot.CopilotUsageCommandMTE",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"WordCopilot_Command_TimeSavedSurvey_FloodgatePromptTitle",Question:"WordCopilot_Command_TimeSavedSurvey_FloodgatePromptQuestion",YesLabel:"WordCopilot_Command_TimeSavedSurvey_FloodgatePrompt_YesLabel",NoLabel:"WordCopilot_Command_TimeSavedSurvey_FloodgatePrompt_NoLabel"},Rating:{Question:"WordCopilot_Command_TimeSavedSurvey_FloodgateRatingQuestion",RatingValuesAscending:["WordCopilot_Command_TimeSavedSurvey_FloodgateRating_0","WordCopilot_Command_TimeSavedSurvey_FloodgateRating_1","WordCopilot_Command_TimeSavedSurvey_FloodgateRating_2","WordCopilot_Command_TimeSavedSurvey_FloodgateRating_3","WordCopilot_Command_TimeSavedSurvey_FloodgateRating_4","WordCopilot_Command_TimeSavedSurvey_FloodgateRating_5"]},Question:{Question:"WordCopilot_Command_TimeSavedSurvey_FloodgateWhyQuestion"}}}},{CampaignId:"e3b72755-e749-41a5-9e48-06bfc9ed9250",StartTimeUtc:"2023-10-01T00:00:00Z",EndTimeUtc:"2024-10-01T00:00:00Z",GovernedChannelType:1,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office.Word.Copilot.CopilotUsageCreateMTE",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"WordCopilotCreateFeelings_FloodgatePromptTitle",Question:"WordCopilotCreateFeelings_FloodgatePromptQuestion",YesLabel:"WordCopilotCreateFeelings_FloodgatePrompt_YesLabel",NoLabel:"WordCopilotCreateFeelings_FloodgatePrompt_NoLabel"},Rating:{Question:"WordCopilotCreateFeelings_FloodgateRatingQuestion",RatingValuesAscending:["WordCopilotCreateFeelings_FloodgateRating_0","WordCopilotCreateFeelings_FloodgateRating_1","WordCopilotCreateFeelings_FloodgateRating_2","WordCopilotCreateFeelings_FloodgateRating_3","WordCopilotCreateFeelings_FloodgateRating_4","WordCopilotCreateFeelings_FloodgateRating_5"]},Question:{Question:"WordCopilotCreateFeelings_FloodgateWhyQuestion"}}}},{CampaignId:"7e71abb8-d6e4-4137-b88f-7b2e91b6f48a",StartTimeUtc:"2023-10-01T00:00:00Z",EndTimeUtc:"2024-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office.Word.Copilot.CopilotUsageCreateMTE",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"WordCopilotCreateTimeSaved_FloodgatePromptTitle",Question:"WordCopilotCreateTimeSaved_FloodgatePromptQuestion",YesLabel:"WordCopilotCreateTimeSaved_FloodgatePrompt_YesLabel",NoLabel:"WordCopilotCreateTimeSaved_FloodgatePrompt_NoLabel"},Rating:{Question:"WordCopilotCreateTimeSaved_FloodgateRatingQuestion",RatingValuesAscending:["WordCopilotCreateTimeSaved_FloodgateRating_0","WordCopilotCreateTimeSaved_FloodgateRating_1","WordCopilotCreateTimeSaved_FloodgateRating_2","WordCopilotCreateTimeSaved_FloodgateRating_3","WordCopilotCreateTimeSaved_FloodgateRating_4","WordCopilotCreateTimeSaved_FloodgateRating_5"]},Question:{Question:"WordCopilotCreateTimeSaved_FloodgateWhyQuestion"}}}},{CampaignId:"bce6cb21-4e25-4d9e-9af0-63d89800b4f1",StartTimeUtc:"2023-10-19T00:00:00Z",EndTimeUtc:"2024-10-19T00:00:00Z",GovernedChannelType:1,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office.Word.Copilot.CopilotUsageSummarizeMTE",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"WordCopilot_Summarize_FeelingsSurvey_FloodgatePromptTitle",Question:"WordCopilot_Summarize_FeelingsSurvey_FloodgatePromptQuestion",YesLabel:"WordCopilot_Summarize_FeelingsSurvey_FloodgatePrompt_YesLabel",NoLabel:"WordCopilot_Summarize_FeelingsSurvey_FloodgatePrompt_NoLabel"},Rating:{Question:"WordCopilot_Summarize_FeelingsSurvey_FloodgateRatingQuestion",RatingValuesAscending:["WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_0","WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_1","WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_2","WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_3","WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_4","WordCopilot_Summarize_FeelingsSurvey_FloodgateRating_5"]},Question:{Question:"WordCopilot_Summarize_FeelingsSurvey_FloodgateWhyQuestion"}}}},{CampaignId:"ed109c8a-a89e-446b-9ed4-5b8e04fb8413",StartTimeUtc:"2023-10-19T00:00:00Z",EndTimeUtc:"2024-10-19T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office.Word.Copilot.CopilotUsageSummarizeMTE",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"WordCopilot_Summarize_TimeSavedSurvey_FloodgatePromptTitle",Question:"WordCopilot_Summarize_TimeSavedSurvey_FloodgatePromptQuestion",YesLabel:"WordCopilot_Summarize_TimeSavedSurvey_FloodgatePrompt_YesLabel",NoLabel:"WordCopilot_Summarize_TimeSavedSurvey_FloodgatePrompt_NoLabel"},Rating:{Question:"WordCopilot_Summarize_TimeSavedSurvey_FloodgateRatingQuestion",RatingValuesAscending:["WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_0","WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_1","WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_2","WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_3","WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_4","WordCopilot_Summarize_TimeSavedSurvey_FloodgateRating_5"]},Question:{Question:"WordCopilot_Summarize_TimeSavedSurvey_FloodgateWhyQuestion"}}}},{CampaignId:"be61deb0-1021-4abd-9d8e-2a9f25584b80",StartTimeUtc:"2023-09-25T00:00:00Z",EndTimeUtc:"2024-09-25T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"TableCellResizeFromRibbonFPS",IsAggregate:!0,Count:2},Content:{Prompt:{Title:"TableCellResizeSurvey_PromptLine1",Question:"TableCellResizeSurvey_PromptLine2",YesLabel:"TableCellResizeSurvey_YesLabel",NoLabel:"TableCellResizeSurvey_NoLabel"},Rating:{Question:"TableCellResizeSurvey_RatingQuestion",RatingValuesAscending:["TableCellResizeSurvey_RatingValue1","TableCellResizeSurvey_RatingValue2","TableCellResizeSurvey_RatingValue3","TableCellResizeSurvey_RatingValue4","TableCellResizeSurvey_RatingValue5"]},Question:{Question:"TableCellResizeSurvey_CommentQuestion"}}}},{CampaignId:"e9e29c99-adb5-4ecf-ab71-f4336f987cd9",StartTimeUtc:"2024-04-08T18:30:00Z",EndTimeUtc:"2024-06-08T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ParagraphBordersFloodgateSurvey",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"ParagraphBordersSurvey_Title",Question:"ParagraphBordersSurvey_Question",YesLabel:"ParagraphBordersSurvey_YesLabel",NoLabel:"ParagraphBordersSurvey_NoLabel"},Rating:{Question:"ParagraphBordersSurvey_RatingQuestion",RatingValuesAscending:["ParagraphBordersSurvey_RatingValue_1","ParagraphBordersSurvey_RatingValue_2","ParagraphBordersSurvey_RatingValue_3","ParagraphBordersSurvey_RatingValue_4","ParagraphBordersSurvey_RatingValue_5"]},Question:{Question:"ParagraphBordersSurvey_WhyQuestion"}}}},{CampaignId:"14819a3e-1897-40ef-ba07-4373569e8780",StartTimeUtc:"2024-04-08T18:30:00Z",EndTimeUtc:"2024-06-08T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ParagraphShadingFloodgateSurvey",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"ParagraphShadingSurvey_Title",Question:"ParagraphShadingSurvey_Question",YesLabel:"ParagraphShadingSurvey_YesLabel",NoLabel:"ParagraphShadingSurvey_NoLabel"},Rating:{Question:"ParagraphShadingSurvey_RatingQuestion",RatingValuesAscending:["ParagraphShadingSurvey_RatingValue_1","ParagraphShadingSurvey_RatingValue_2","ParagraphShadingSurvey_RatingValue_3","ParagraphShadingSurvey_RatingValue_4","ParagraphShadingSurvey_RatingValue_5"]},Question:{Question:"ParagraphShadingSurvey_WhyQuestion"}}}},{CampaignId:"9f59cd9e-4140-405c-9f4c-9e8778733c19",StartTimeUtc:"2024-01-16T18:30:00Z",EndTimeUtc:"2024-06-15T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordChecklistFloodgateSurvey",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"WordChecklist_PromptLine1",Question:"WordChecklist_PromptLine2",YesLabel:"WordChecklist_YesLabel",NoLabel:"WordChecklist_NoLabel"},Rating:{Question:"WordChecklist_RatingQuestion",RatingValuesAscending:["WordChecklist_RatingValue_1","WordChecklist_RatingValue_2","WordChecklist_RatingValue_3","WordChecklist_RatingValue_4","WordChecklist_RatingValue_5"]},Question:{Question:"WordChecklist_CommentQuestion"}}}},{CampaignId:"8f1667b1-f428-4845-8aee-88424c2589d8",StartTimeUtc:"2024-04-03T18:30:00Z",EndTimeUtc:"2024-07-03T18:30:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordCitationsFloodgateSurvey",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"WordCitations_PromptLine1",Question:"WordCitations_PromptLine2",YesLabel:"WordCitations_YesLabel",NoLabel:"WordCitations_NoLabel"},Rating:{Question:"WordCitations_RatingQuestion",RatingValuesAscending:["WordCitations_RatingValue_1","WordCitations_RatingValue_2","WordCitations_RatingValue_3","WordCitations_RatingValue_4","WordCitations_RatingValue_5"]},Question:{Question:"WordCitations_CommentQuestion"}}}},{CampaignId:"dce66a0f-e7e1-4de5-8c85-87eab751e103",StartTimeUtc:"2024-03-18T18:30:00Z",EndTimeUtc:"2024-05-31T18:30:00Z",PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PinHeaderRowUsage",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Word_Generic_FloodgatePromptTitle",Question:"Word_Generic_FloodgatePromptQuestion",YesLabel:"Word_Generic_FloodgatePrompt_SureLabel",NoLabel:"Word_Generic_FloodgatePrompt_NotNowLabel"},Rating:{Question:"WordPinRowsFeature_FloodgateRatingQuestion",RatingValuesAscending:["Word_Generic_FloodgateRating_VeryDissatisfied_Scale_1","Word_Generic_FloodgateRating_SomewhatDissatisfied_Scale_2","Word_Generic_FloodgateRating_Neutral_Scale_3","Word_Generic_FloodgateRating_SomewhatSatisfied_Scale_4","Word_Generic_FloodgateRating_VerySatisfied_Scale_5"]},Question:{Question:"Word_Generic_FloodgateWhyQuestion"}}}},{CampaignId:"f88fc705-13d0-473a-8f33-30fda5b97be6",StartTimeUtc:"2024-04-10T00:00:00Z",EndTimeUtc:"2024-06-10T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ExpandCollapseHeadingsSurvey",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"ExpandCollapseFPS_Title",Question:"ExpandCollapseFPS_Question",YesLabel:"ExpandCollapseFPS_YesLabel",NoLabel:"ExpandCollapseFPS_NoLabel"},Rating:{Question:"ExpandCollapseFPS_RatingQuestion",RatingValuesAscending:["ExpandCollapseFPS_RatingValue_1","ExpandCollapseFPS_RatingValue_2","ExpandCollapseFPS_RatingValue_3","ExpandCollapseFPS_RatingValue_4","ExpandCollapseFPS_RatingValue_5"]},Question:{Question:"ExpandCollapseFPS_WhyQuestion"}}}},{CampaignId:"0c879b22-a8c1-4b8b-b610-036cd19606a8",LauncherType:"dialog",StartTimeUtc:"2024-09-12T00:00:00Z",EndTimeUtc:"2025-09-12T00:00:00Z",GovernedChannelType:8,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:24,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CopilotFREActivity",IsAggregate:!0,Count:1}]},Metadata:{ContentMetadata:{dialogType:"Copilot",customSurveyName:"CopilotFRECustomSurvey",telemetryEventName:"CopilotFRETelemetryEvent"}}}},{CampaignId:"5b886159-5e77-4553-a4be-6b63577ebcd3",StartTimeUtc:"2024-10-01T00:00:00Z",EndTimeUtc:"2025-02-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"}]},AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"OcdiUrlBusinessBarPreviouslyDismissed",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"OcdiUrlFloodgate_Word_PromptTitle",Question:"OcdiUrlFloodgate_WXP_PromptQuestion",YesLabel:"OcdiUrlFloodgate_WXP_PromptQuestion_Yes",NoLabel:"OcdiUrlFloodgate_WXP_PromptQuestion_No"},Rating:{Question:"OcdiUrlFloodgate_Word_RatingQuestion",RatingValuesAscending:["OcdiUrlFloodgate_WXP_Rating1","OcdiUrlFloodgate_WXP_Rating2","OcdiUrlFloodgate_WXP_Rating3","OcdiUrlFloodgate_WXP_Rating4","OcdiUrlFloodgate_WXP_Rating5"]},Question:{Question:"OcdiUrlFloodgate_WXP_WhyQuestion"}}}}],ga.main(),window.g_wordViewerJsDownloaded=!0,window.g_appSettingsDownloaded&&(Sys.Application.get_isInitialized()?window.g_wordViewerAppConstructed||pageInit():(Sys.Application.add_init(pageInit),Sys.Application.initialize())),Type.registerNamespace("Diag"),window.Diag.UULS=Ft,Type.registerNamespace("CUIB"),oa.main(),window.loadObjectModel=()=>__webpack_require__.e(5).then(__webpack_require__.bind(__webpack_require__,6151))}();var __webpack_export_target__=window;for(var i in __webpack_exports__)__webpack_export_target__[i]=__webpack_exports__[i];__webpack_exports__.__esModule&&Object.defineProperty(__webpack_export_target__,"__esModule",{value:!0})})();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/WordViewerDS.js.map/deb88af45430ed8a2f735e9e1876299d/WordViewerDS.js.map