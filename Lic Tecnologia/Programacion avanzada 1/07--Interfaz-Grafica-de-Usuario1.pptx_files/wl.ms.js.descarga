(function(){if(!window.WL&&!window.OneDrive){window.OneDrive={};OneDrive.Constants={WebViewLink:Z,DownloadLink:xb};OneDrive.open=function(c){var b=i(c),a=new f(b,ue);try{a.initialize();a.validateOpenParameters();a.executeOpenOperation()}catch(d){a.processError(d,W)}};OneDrive.save=function(c){var b=i(c),a=new f(b,ve);try{a.initialize();a.validateSaveParameters();a.executeSaveOperation()}catch(d){a.processError(d,W)}};OneDrive.createOpenButton=function(d){var c=i(d),a=new f(c,hc);try{a.initialize();a.validateOpenParameters();a.validateButtonParameters();var b=a.createButtonElement();e(b,O,function(){a.executeOpenOperation()});return b}catch(g){a.processError(g,W);return null}};OneDrive.createSaveButton=function(d){var c=i(d),a=new f(c,Ad);try{a.initialize();a.validateSaveParameters();a.validateButtonParameters();var b=a.createButtonElement();e(b,O,function(){a.executeSaveOperation()});return b}catch(g){a.processError(g,W);return null}};function f(d,e){var b=this,c=d[fe];b._internalApp=WL.UnitTests&&typeof c===G?c:a;b._options=d;b._method=e}f.onloadInit=function(){ib(function(){var c=document.querySelectorAll(Ed);for(var b=0;b<c.length;b++){var a=c[b];f.createButtonElement(a,ab,gb);var g=a.href,d=new f({file:g},td);a.href="#";e(a,O,function(){d.initialize();d.executeSaveOperation();return false})}})};f.createButtonElement=function(a,e,d){var b={};b[k]=e;b[E]=d;var c=fc(b,true);a.innerHTML=c.innerHTML;a.id=c.buttonId;a.title=c.buttonTitle;jc(b,a);return a};f.prototype={initialize:function(){var a=this;if(a._internalApp._status!==Fb){var b=Me();if(!b)throw new Error(Hd.replace(j,a._method));a._internalApp.appInit({client_id:b,interface_method:a._method});Gf("Picker SDK initialized with client_id: "+b,mb)}},executeOpenOperation:function(){var b=this,f=b._internalApp,d=b._method,a=b._options,c=a[xc],g=a[db],i=a[eb],e={mode:I,resourceType:Y,select:a[Fc]?zb:z,linkType:c,interface_method:d};f.fileDialog(e).then(function(k){var a=k.apiResponse,e=c===xb,n={link:e?null:a.webUrl,values:[]},f=e?a.value:a.children&&a.children.length>0?a.children:[a];if(!f)throw new Error(x(dc,d,JSON.stringify(k)));for(var i=0;i<f.length;i++){var b=f[i],m=[],o=e?b["@content.downloadUrl"]:b.webUrl,l=b.thumbnails&&b.thumbnails[0];if(l)for(var j=0;j<Hc.length;j++)m.push(l[Hc[j]].url);n.values.push({fileName:b.name,link:o,linkType:c,size:b.size,thumbnails:m})}h(g,n)},function(a){a.error===Lc?h(i):b.processError(a,lc)})},executeSaveOperation:function(){var a=this,b=a._internalApp,f=a._options,c=a._method,g=f[Nc],e=f[Eb],d=ed;if(Xb(g)){d=Wb;e=e||Ne(g)}else if(pf(g)){d=Jb;if(!e)throw Db(Eb,c)}var i=f[db],k=f[yc],m=f[eb],l={mode:H,resourceType:X,select:z,interface_method:c,save_scenario:true};b.fileDialog(l).then(function(n){var t=n.pickerResponse,l=n.apiResponse,m=b._browser.ie9,f;if(m)f=l.data&&l.data[0].id;else{f=l.value&&l.value[0]&&l.value[0].id;if(!f||l.value.length!==1)throw new Error(x(dc,c,JSON.stringify(n)))}var o=b.getAccessTokenForApi();switch(d){case Jb:case Wb:if(m){var q=f.split(".");f=q.length>2?q[2]:"root"}var s={path:"drives/"+t.owner_cid+"/items/"+f+"/children",method:Zc,use_vroom_api:true,request_headers:[{name:We,value:Wd},{name:ff,value:"bearer "+o},{name:Bc,value:b._appId},{name:qc,value:x("{0}={1}",Cc,b._settings.sdk_version)}],response_headers:[Kb],json_body:{"@content.sourceUrl":g,"name":e,"file":{}},interface_method:c};b.api(s).then(function(b){var c=b[Gb];if(d===Jb&&(c===Xd||c===Pc))h(i);else if(d===Wb&&c===rc)a.beginPolling(i,k,b[Kb],o);else a.processErrorCallback(b,Ab)},function(b){a.processErrorCallback(b,Ab)});break;case ed:var p;if(m)p=f;else{var u=Yc(true)+"drive/items/"+f+"/children/{0}/content?"+pe;p=L(u,{access_token:o})}var r={path:p,element:g,use_vroom_api:!m,overwrite:Kd,file_name:e,interface_method:c};b.upload(r).then(function(){h(i)},function(b){a.processErrorCallback(b,Ab)},function(a){h(k,a.progressPercentage)});break;default:throw new Error(wd.replace(j,c))}},function(b){b.error===Lc?h(m):a.processError(b,lc)})},beginPolling:function(j,e,i,g){var a=this,b=Ze,d=dd,f={path:L(i,{access_token:g}),method:Sb,use_vroom_api:true,response_headers:[Kb],interface_method:a._method},c=function(){a._internalApp.api(f).then(function(f){switch(f[Gb]){case rc:h(e,f[Ld]);if(!d--){b*=2;d=dd}F(c,b);break;case Pc:h(e,100);h(j);break;default:a.processErrorCallback(f,gc)}},function(b){a.processErrorCallback(b,gc)})};F(c,b)},validateOpenParameters:function(){n(this._options,[{name:xc,type:b,optional:true,defaultValue:Z,allowedValues:[xb,Z]},{name:Fc,type:Yb,optional:true,defaultValue:false},{name:db,type:c,optional:false},{name:eb,type:c,optional:true}],this._method)},validateSaveParameters:function(){n(this._options,[{name:Eb,type:b,optional:true},{name:Nc,type:b,optional:false},{name:db,type:c,optional:true},{name:yc,type:c,optional:true},{name:eb,type:c,optional:true},{name:Ic,type:c,optional:true}],this._method)},validateButtonParameters:function(){n(this._options,[{name:Jc,type:b,optional:true,defaultValue:Bb,allowedValues:[Bb,Md]}],this._method)},createButtonElement:function(){var a=document.createElement("button"),c=this._method===hc?A:ab,b=this._options[Jc]===Bb?gb:fb;return f.createButtonElement(a,c,b)},processError:function(c,b){var a=x(Je,this._method,b,JSON.stringify(c));l(a,mb);return a},processErrorCallback:function(b,a){h(this._options[Ic],this.processError(b,a))}};var Jh="download",d="interface_method",yd="WL.Internal.jsonp.",De=2000,Bc="Application",ff="Authorization",fd="body",Dg="json_body",C="callback",pb="code",og="Content-Type",ah="element",ad="error",vg="error_description",Og="file_name",Eg="file_input",wg="file_output",Nd="request_headers",Wf="response_headers",Kb="Location",Sc="logging",kb="message",Ob="method",Fg="overwrite",Kd="rename",Q="path",Ld="percentageComplete",We="Prefer",Xe="pretty",Wd="respond-async",jh="result",he="save_scenario",Cc="SDK-Version",kh="status",Gb="http_status",qe="return_ssl_resources",pg="stream_input",bh="tracing",Lb="use_vroom_api",qc="X-RequestStats",lh="error",rc=202,Xd=201,Pc=200,Sf=500,Pg="success",ie="suppress_redirects",Tf="suppress_response_codes",J="x_http_live_library",bd=0,Fb=1,o="access_token",Nh="appstate",wf="authentication_key";AK_AUTH_TOKEN="authentication_token",(AK_CLIENT_ID="client_id",(AK_DISPLAY="display",(AK_CODE="code",(AK_ERROR="error",(AK_ERROR_DESC="error_description",(AK_EXPIRES="expires",(AK_EXPIRES_IN="expires_in",(AK_ITEMID="item_id",(AK_LOCALE="locale",(AK_OWNER_CID="owner_cid",(AK_REDIRECT_URI="redirect_uri",(AK_RESPONSE="response",(AK_RESPONSE_TYPE="response_type",(AK_REQUEST_TS="request_ts",(AK_RESOURCEID="resource_id",(AK_SCOPE="scope",(AK_SESSION="session",(AK_SECURE_COOKIE="secure_cookie",(AK_STATE="state",AK_STATUS="status")))))))))))))))))));var zh=[o,AK_AUTH_TOKEN,AK_SCOPE,AK_EXPIRES_IN,AK_EXPIRES],rf="connected",th="notConnected",Kh="unchecked",Rh="unknown",xf="expiring",Qh="expired",uh="live-sdk-upload",dh="live-sdk-download",Cf="appId",Dh="channelUrl",Oh="wl_auth",Eh="wl_upload",Mh="page",Fh="touch",Lh="none",Wc="none",mh="auth.login",eh="auth.logout",uc="auth.sessionChange",fg="auth.statusChange",Bf="wl.log",Lc="access_denied",be="connection_failed",Sg="invalid_cookie",se="invalid_request",Xc="request_canceled",K="request_failed",hf="timed_out",Ug="unknown_user",Gg="user_canceled",bg="METHOD: Failed to get the required user permission to perform this operation.",Td="The request could not be completed due to browser issues.",sc="The request could not be completed due to browser limitations.",Of="The request could not be completed since the browser or browser version is not supported.",Fd="Callback has thrown an exception. Exception message: MESSAGE",Uc="METHOD: The operation has been canceled.",Yf="The 'wl_auth' cookie is not valid.",Uf="The 'wl_auth' cookie has been modified incorrectly. Ensure that the redirect URI only modifies sub-keys for values received from the OAuth endpoint.",Mf="The 'wl_auth' cookie has multiple values. Ensure that the redirect URI specifies a cookie domain and path when setting cookies.",je="METHOD: The input property 'PARAM' does not reference a valid DOM element.",ze="METHOD: An exception was received for EVENT. Detail: MESSAGE",ke="METHOD: The WL object must be initialized with WL.init() prior to invoking this method.",wc="A connection to the server could not be established.",Rf="The user could not be identified.",jg="METHOD: Failed to get upload_location of the resource.",eg="The pending login request has been canceled.",Pf="Logging out the user is not supported in current session because the user is logged in with a Microsoft account on this computer. To logout, the user may quit the app or log out from the computer.",tc="METHOD: The input value for parameter/property 'PARAM' is not valid.",Ud="METHOD: The input parameter/property 'PARAM' must be included.",Gd="METHOD: The type of the provided value for the input parameter/property 'PARAM' is not valid.",wb="METHOD: There is a pending METHOD request, the current call will be ignored.",Kf=wb.replace(/METHOD/g,Ye),ud=wb.replace(/METHOD/g,M),Lf=wb.replace(/METHOD/g,Ue),Qf="METHOD: The input property 'redirect_uri' is required if the value of the 'response_type' property is 'code'.",Jf="WL.init: The redirect_uri value should be the same as the value of 'Redirect Domain' of your registered app. It must begin with 'http://' or 'https://'.",Nf="METHOD: The api call is not supported on this platform.",If="WL.init: The response_type value 'code' is not supported on this platform.",Tg="METHOD: The input property 'redirect_uri' must use https: to match the scheme of the current page.",dg="The auth request is timed out.",kg="The popup is closed without receiving consent.",Nb=0,Rd=1,vc=2,Le=3,Sb="GET",Zc="POST",wh="PUT",Wg="DELETE",nh="COPY",oh="MOVE",M="WL.fileDialog",hd="WL.api",Ig="WL.download",cd="WL.init",Ye="WL.login",rb="WL.ui",Ue="WL.upload",gg=30000,j="METHOD",V="PARAM",s="onSuccess",t="onError",B="onProgress",Gh="redirect_type",Xg="auth",xg="upload",Yg="code",Kg="token",sb="https:",ld="http:",tf="wl.signin",lf="wl.skydrive",we="wl.skydrive_update",hh=/\s|,/,Yb="boolean",rd="dom",c="function",md="number",G="object",nb="properties",b="string",Oe="string_or_array",qb="undefined",Df="url",qf="name",Pb="element",Bh="brand",Ih="type",sg="sign_in_text",mg="sign_out_text",E="theme",Lg="onloggedin",Ag="onloggedout",Qb="onerror",Zg="messenger",qh="hotmail",ih="skydrive",rh="windows",zg="windowslive",Hh="none",qd="signin",ug=qd,Bg="login",ng="connect",tg="custom",gb="blue",fb="white",yh="id",ob="onedrive_api",nf="auth_server",N="apiservice_uri",P="skydrive_uri",y="sdk_root",Ef="wl_trace",g={subscribe:function(a,b){ub("Subscribe "+a);var c=g.getHandlers(a);c.push(b)},unsubscribe:function(c,e){ub("Unsubscribe "+c);var b=g.getHandlers(c),d=[];if(e!=null){var f=false;for(var a=0;a<b.length;a++)if(f||b[a]!=e)d.push(b[a]);else f=true}g._eHandlers[c]=d},getHandlers:function(b){if(!g._eHandlers)g._eHandlers={};var a=g._eHandlers[b];if(a==null)g._eHandlers[b]=a=[];return a},notify:function(c,d){ub("Notify "+c);var b=g.getHandlers(c);for(var a=0;a<b.length;a++)b[a](d)}},a={_status:bd,_statusRequests:[],_rpsAuth:false};a.appInit=function(b){var f=b[d]||cd;if(a._status==Fb){var g=a._session.getNormalStatus();return Dc(f,true,b.callback,g)}var c=WL[y];if(c){if(c.charAt(c.length-1)!=="/")c+="/";a[y]=c}var e=b[Sc];if(e===false)a._logEnabled=e;if(a.testInit)a.testInit(b);a._status=Fb;return Yd(b)};a.onloadInit=function(){gf();kf()};function Rb(b){if(a._status===bd)throw new Error(ke.replace(j,b))}function Af(){return WL.Internal.tApp||a}a.api=function(a){Rb(hd);var c=a[fd];if(c){a=i(Ub(c),a);delete a[fd]}var b=a[Ob];a[Ob]=(b!=null?bc(b):Sb).toUpperCase();return (new nd(a)).execute()};a.getAccessTokenForApi=function(){var c=null;if(!a._rpsAuth){var b=Af()._session.getStatus();if(b.status===xf||b.status===rf)c=b.session[o]}return c};var Be=function(){var b=a.api.lastId,c;b=b===undefined?1:b+1;c="WLAPI_REQ_"+b+"_"+(new Date).getTime();a.api.lastId=b;return c},nd=function(b){var c=this;c._properties=b;c._completed=false;c._id=Be();b[Xe]=false;b[qe]=a._isHttps;b[J]=a[J];var d=b[Q],e=b[Lb];c._url=Xb(d)?d:Yc(e)+(d.charAt(0)==="/"?d.substring(1):d);c._promise=new q(hd,null,null)};nd.prototype={execute:function(){Te(this);return this._promise},onCompleted:function(a){if(this._completed)return;this._completed=true;D(this._properties.callback,a,true);if(a[AK_ERROR])this._promise[t](a);else this._promise[s](a)}};function Rc(f,c,b,e,d){b=b?bc(b):"";var a=b!==""?af(b):null;if(a===null){a={};if(Math.floor(c/100)!==2)a[ad]=Qe(c,e)}if(d)d.forEach(function(b){a[b.name]=b.value});a[Gb]=c;f.onCompleted(a)}function Qe(c,b){var a={};a[pb]=K;a[kb]=b||wc;return a}function Ub(i){var c={};for(var b in i){var a=i[b],j=typeof a;if(a instanceof Array)for(var d=0;d<a.length;d++){var f=a[d],l=typeof f;if(j==G&&!(a instanceof Date)){var h=Ub(f);for(var e in h)c[b+"."+d+"."+e]=h[e]}else c[b+"."+d]=f}else if(j==G&&!(a instanceof Date)){var k=Ub(a);for(var g in k)c[b+"."+g]=k[g]}else c[b]=a}return c}function le(c,b){l(b.message);var a=c[Qb];if(a)F(function(){error=Cb(rb,rb,b),a(error)})}function gd(){return a[y]}function sf(){return gd()+"images"}var yg=new RegExp("^\\w+\\.\\w+:\\w+[\\|\\w+]+:([\\w]+\\!\\d+)(?:\\!(.+))*");function bc(a){return a.replace(/^\s+|\s+$/g,"")}function pc(a,b){return a&&b?a.toLowerCase()===b.toLowerCase():a===b}function Oc(a){return a==null||a===""}function x(){var a=arguments,c=a[0];function b(b){return a[parseInt(b.replace(/[\{\}]/g,""))+1]||""}return c.replace(/\{\d+\}/g,b)}var od="0000000000000000";function ac(b){var a={c:0,s:-1};return b.replace(/[^\w .,-]/g,function(d,b,c){if(Ke(c,b,a))return ["&#",a.c,";"].join("");return ""})}function Ke(f,b,a){var d=a.s===b;if(!d){b=b||0;var c=f.charCodeAt(b),g,e;a.s=-1;if(c<55296||c>57343)a.c=c;else if(c<=56319){g=c;e=f.charCodeAt(b+1);a.c=(g-55296)*1024+(e-56320)+65536;a.s=b+1}else{a.c=-1;d=true}}return !d}function i(b,d){var c=d||{};if(b!=null)for(var a in b)c[a]=b[a];return c}function Pe(e,d,b){var c=i(e,d);for(var a=0;a<b.length;a++)delete c[b[a]];return c}function pd(a){return Array.prototype.slice.call(a)}function w(b,a){return function(){if(typeof a===c)return a.apply(b,arguments)}}function sd(a,g,d){d=d||"[WL]";a=d+a;var c=window;if(c.debugLogger)c.debugLogger.push(a);var b=c.console;if(b&&b.log)switch(g){case "warning":b.warn(a);break;case "error":b.error(a);break;default:b.log(a)}var f=c.opera;if(f)f.postError(a);var e=c.debugService;if(e)e.trace(a)}function Xb(a){return a.indexOf("https://")===0||a.indexOf("http://")===0}function pf(a){return a.indexOf("data:")===0}function ub(b){if(a._traceEnabled)sd(b)}function vb(b,d,c){if(a._logEnabled||a._traceEnabled)sd(b,d,c);g.notify(Bf,b)}if(window.WL&&WL.Internal){WL.Internal.trace=ub;WL.Internal.log=vb}function Gf(b,a){vb(b,"text",a)}function l(b,a){vb(b,"error",a)}function Kc(b){var a=document.createElement(b);a.style.position="absolute";a.style.top="-1000px";a.style.width="300px";a.style.height="300px";a.style.visibility="hidden";return a}function re(){var a=null;while(a==null){a="wl_"+Math.floor(Math.random()*1024*1024);if(R(a)!=null)a=null}return a}function R(a){return document.getElementById(a)}function Hf(a){i(cc(a),this)}Hf.prototype={toString:function(){var a=this,b=(a.scheme!=""?a.scheme+"//":"")+a.host+(a.port!=""?":"+a.port:"")+a.path;return b},resolve:function(){var a=this;if(a.scheme==""){var b=window.location.port,c=window.location.host;a.scheme=window.location.protocol;a.host=c.split(":")[0];a.port=b!=null?b:"";if(a.path.charAt(0)!="/")a.path=Ee(a.host,window.location.href,a.path)}}};function cc(c){var e=c.indexOf(sb)==0?sb:c.indexOf(ld)==0?ld:"",l="",m="",f;if(e!="")var a=c.substring(e.length+2),h=jb(a.indexOf("/")),j=jb(a.indexOf("\\")),i=jb(a.indexOf("?")),k=jb(a.indexOf("#")),b=Ie(Math.min(h,j,i,k)),g=b>0?a.substring(0,b):a,d=g.split(":"),l=d[0],m=d.length>1?d[1]:"",f=b>0?a.substring(b):"";else f=c;return {scheme:e,host:l,port:m,path:f}}function jb(a){if(a==-1)return Number.POSITIVE_INFINITY;return a}function Ie(a){if(a==Number.POSITIVE_INFINITY)return -1;return a}function of(a){return cc(a.toLowerCase()).host}function Ee(e,b,h){var d=function(a,c){charIdx=b.indexOf(c);a=charIdx>0?a.substring(0,charIdx):a;return a};b=d(d(b,"?"),"#");var f=b.indexOf(e),a=b.substring(f+e.length),g=a.indexOf("/"),c=a.lastIndexOf("/");a=c>=0?a.substring(g,c):a;return a+"/"+h}function vf(a){var b=a.indexOf("?");if(b>0)a=a.substring(0,b);b=a.indexOf("#");if(b>0)a=a.substring(0,b);return a}function Ne(c){var a=vf(c),b=a.lastIndexOf("/")+1;return a.substr(b)}function h(a,b){D(a,b,true)}function D(a,d,e){function b(){try{d!==undefined?a(d):a()}catch(b){l(Fd.replace("MESSAGE",b.message));throw b}}if(typeof a==c)if(e)b();else F(function(){b()})}function af(a){return JSON.parse(a)}function Ff(b,c){var d=b.length;for(var a=0;a<d;a++)c(b[a])}function v(d,c){var a={},b={};a[pb]=d,a[kb]=c;b[ad]=a;return b}function Cb(a,b,c){return v(K,ze.replace("METHOD",a).replace("EVENT",b).replace("MESSAGE",c.message))}function oe(b){var a=b.split(".");return a[0]+"."+a[1]}function F(a,b){window.wlUnitTests?wlUnitTests.delayInvoke(a):window.setTimeout(a,b||1)}function gf(){var b=jf(navigator.userAgent,document.documentMode),c=a[J];a._browser=b;a[J]=c.replace("DEVICE",b.device)}function jf(a,e){a=a.toLowerCase();var c="other",b={"firefox":/firefox/.test(a),"firefox1.5":/firefox\/1\.5/.test(a),"firefox2":/firefox\/2/.test(a),"firefox3":/firefox\/3/.test(a),"firefox4":/firefox\/4/.test(a),"ie":(/msie/.test(a)||/trident/.test(a))&&!/opera/.test(a),"ie6":false,"ie7":false,"ie8":false,"ie9":false,"ie10":false,"ie11":false,"opera":/opera/.test(a),"webkit":/webkit/.test(a),"chrome":/chrome/.test(a),"mobile":/mobile/.test(a)||/phone/.test(a)};if(b["ie"]){var d=0;if(e)d=e;else if(/msie 7/.test(a))d=7;d=Math.min(11,Math.max(d,6));c="ie"+d;b[c]=true}else if(b.firefox)c="firefox";else if(b.chrome)c="chrome";else if(b.webkit)c="webkit";else if(b.opera)c="opera";if(b.mobile)c+="mobile";b.device=c;return b}function Ec(e,c){var f=c!=null?c:{};if(e!=null){var d=e.split("&");for(var b=0;b<d.length;b++){var a=d[b].split("=");if(a.length==2)f[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}}return f}function Fe(a){var c="";if(a!=null)for(var b in a)if(a.hasOwnProperty(b)){var d=c.length?"&":"",e=a[b];c+=d+encodeURIComponent(b)+"="+encodeURIComponent(Ge(e))}return c}function Ge(a){if(a instanceof Date){var b=function(a,b){switch(b){case 2:return a<10?"0"+a:a;case 3:return (a<10?"00":a<100?"0":"")+a}};return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1,2)+"-"+b(a.getUTCDate(),2)+"T"+b(a.getUTCHours(),2)+":"+b(a.getUTCMinutes(),2)+":"+b(a.getUTCSeconds(),2)+"."+b(a.getUTCMilliseconds(),3)+"Z"}return ""+a}function Ve(b){var d=b.indexOf("?")+1,c=b.indexOf("#")+1,a={};if(d>0){var e=c>d?c-1:b.length;a=Ec(b.substring(d,e),a)}if(c>0)a=Ec(b.substring(c),a);return a}function L(a,b){return a+(a.indexOf("?")<0?"?":"&")+Fe(b)}var oc={name:C,type:c,optional:true},Zf={name:C,type:c,optional:false};function mf(a,c,d){if(a instanceof Array)for(var b=0;b<a.length;b++)id(a[b],c[b],d);else id(a,c,d)}function id(c,a,b){Vc(c,a,b);if(a.type===nb)n(c,a.properties,b)}function Vc(g,f,d,h){var e=f.name,a=typeof g,i=f.type;if(a===qb||g==null)if(f.optional){h&&h();return}else throw Db(e,d);switch(i){case b:if(a!=b)throw u(e,d);if(!f.optional&&bc(g)==="")throw Db(e,d);break;case Df:if(a!=b||!Xb(g))throw u(a,d);break;case nb:if(a!=G)throw u(e,d);break;case c:if(a!=c)throw u(a,d);break;case rd:if(a==b){if(R(g)==null)throw new Error(je.replace(j,d).replace(V,e))}else if(a!=G)throw u(e,d);break;case Oe:if(a!=b&&!(g instanceof Array))throw u(a,d);break;default:if(a!=i)throw u(e,d)}if(f.allowedValues!=null)Ce(g,f.allowedValues,f.caseSensitive,e,d)}function n(g,d,f){var b=g||{};for(var c=0;c<d.length;c++){var a=d[c],e=b[a.name]||b[a.altName];Vc(e,a,f,function(){if(typeof a.defaultValue!=qb)b[a.name]=a.defaultValue})}}function Ce(d,a,e,f,h){var g=typeof a[0]===b;for(var c=0;c<a.length;c++)if(g&&!e){if(d.toLowerCase()===a[c].toLowerCase())return}else if(d===a[c])return;throw ae(f,h)}function u(a,b){return new Error(Gd.replace(j,b).replace(V,a))}function Db(a,b){return new Error(Ud.replace(j,b).replace(V,a))}function ae(c,d,a){var b=tc.replace(j,d).replace(V,c);if(typeof a!==qb)b+=" "+a;return new Error(b)}function Mb(k,j){var g=pd(k),a=null,b=null;for(var f=0;f<g.length;f++){var e=g[f],h=typeof e;if(h===G&&a===null)a=i(e);else if(h===c&&b===null)b=e}a=a||{};if(b)a.callback=b;a[d]=j;return a}function ee(a,b){var c=Cb(a,a,b);l(b.message);return Dc(a,false,null,c)}var q=function(b,c,a){this._name=b;this._op=c;this._uplinkPromise=a;this._isCompleted=false;this._listeners=[]};q.prototype={then:function(d,e,c){var b=new q(null,null,this),a={};a[s]=d;a[t]=e;a[B]=c;a.chainedPromise=b;this._listeners.push(a);return b},cancel:function(){if(this._isCompleted)return;if(this._uplinkPromise&&!this._uplinkPromise._isCompleted)this._uplinkPromise.cancel();else{var a=this._op?this._op.cancel:null;if(typeof a===c)this._op.cancel();else this.onError(v(Xc,Uc.replace("METHOD",this._getName())))}},_getName:function(){if(this._name)return this._name;if(this._op&&typeof this._op._getName===c)return this._op._getName();if(this._uplinkPromise)return this._uplinkPromise._getName();return ""},_onEvent:function(b,a){if(this._isCompleted)return;this._isCompleted=a!==B;this._notify(b,a)},_notify:function(b,a){var c=this;Ff(this._listeners,function(g){var h=g[a],d=g.chainedPromise,f=a!==B;if(h)try{var e=h.apply(g,b);if(f&&e&&e.then){d._op=e;e.then(function(a){d[s](a)},function(a){d[t](a)},function(a){d[B](a)})}}catch(i){if(f)d.onError(Cb(c._getName(),a,i))}else if(f)d[a].apply(d,b)})}};q.prototype[s]=function(){this._onEvent(arguments,s)};q.prototype[t]=function(){this._onEvent(arguments,t)};q.prototype[B]=function(){this._onEvent(arguments,B)};function Dc(f,e,b,g){var a=new q(f,null,null),d=e?s:t;if(typeof b===c)a.then(function(a){b(a)});F(function(){a[d](g)});return a}var zh=[o,AK_AUTH_TOKEN,AK_SCOPE,AK_EXPIRES_IN,AK_EXPIRES,AK_REQUEST_TS,AK_ERROR,AK_ERROR_DESC],sh="refresh_type",Cg="app",Mg="ms",Ng="response_method",hg="url",Xf="cookie",hb="onanalytics",Qg="login",ag="loginstatus",Zd="file_dialog",Hg="auth.response",Tc="client-id",Ed=".OneDriveSaveButton",Uh="file",O="click",Zb="onedrive-js",zc="2px",nc="0px",Mc="4px",Hd="METHOD: Failed to initialize due to missing 'client-id'.",Od="Loading OneDrive picker is timed out.",k="mode",A="open",ab="save",I="read",H="readwrite",cb="linkType",kc="resourceType",Y="file",X="folder",r="select",z="single",zb="multi",Jd="permission",zd="onetime",bb="lightbox",Dd="grey",ec="transparent",yb="white",ic="loading_timeout",mc="onselected",eb="cancel",Ic="error",Nc="file",Eb="fileName",fe="internal_app",xc=cb,xb="downloadLink",Z="webViewLink",yc="progress",Fc="multiSelect",db="success",Jc="theme",Bb="blue",Md="white",Wb="content_url",Jb="data_url",ed="form",wd="METHOD: This upload method is not implemented.",Je="{0}: Operation: '{1}' Error message: {2}",dc="{0}: Invalid response from the file picker. Response: {1}",cg="API call",lc="invoke picker",W="unhandled exception",Ab="upload",gc="upload: poll for completion",ue="OneDrive.open",ve="OneDrive.save",hc="OneDrive.createOpenButton",Ad="OneDrive.createSaveButton",td="OneDriveApp.onloadInit",Vf="OneDriveApp.initialize",te="auth",Pd="rps",Id="oauth",Qd="v",vd="1",xd="2",ce="domain",Vd="livesdk",Ae="mkt";FILEDIALOG_PARAM_PICKER_SCRIPT="pickerscript";FILEDIALOG_CHCMD_ONCOMPLETE="onPickerComplete",FILEDIALOG_CHCMD_UPDATETOKEN="updateToken";var lg=104857600,zf=27,Ze=1000,dd=5,mb="[OneDrive]",lb="skydrivepicker",pe="@name.conflictBehavior=rename",ge="select=id,@content.downloadUrl,name,size&expand=thumbnails",Bd="select=id,webUrl,name,size&expand=thumbnails,children(select=id,webUrl,name,size;expand=thumbnails)",ef="select=id",Hc=["large","medium","small"];window.WL={};WL.Internal={};WL.init=function(d){try{var c=i(d);mf(c,{name:nb,type:nb,optional:false,properties:[{name:AK_CLIENT_ID,altName:Cf,type:b,optional:false},{name:Sc,type:Yb,optional:true}]},cd);a.appInit(c)}catch(e){l(e.message)}};WL.ui=function(){try{var c=Mb(arguments);n(c,[{name:qf,type:b,allowedValues:[lb],optional:false},oc],rb);a.ui(c)}catch(f){le(c,f)}};WL.fileDialog=function(){try{var b=M,c=Mb(arguments,b);Ac(c,b);return a.fileDialog(c)}catch(f){return ee(b,f)}};function Ac(e,d){n(e,[{name:k,type:b,allowedValues:[A,ab,I,H],optional:false},{name:kc,type:b,allowedValues:[Y,X],optional:true},{name:r,type:b,allowedValues:[z,zb],optional:true},{name:bb,type:b,allowedValues:[Dd,ec,yb],optional:true},{name:ic,type:md,optional:true},{name:Jd,type:b,allowedValues:[zd],optional:true},oc],d);if(d!==M)n(e,[{name:E,allowedValues:[gb,fb],type:b,optional:true},{name:mc,type:c,optional:false},{name:Qb,type:c,optional:true}],d);if(!Tb.isSupported()||!window.JSON||a._browser.mobile)throw new Error(sc)}function Yd(b){a._rpsAuth=true;a._appId=b[AK_CLIENT_ID]}function kf(){a._logEnabled=true;a._urlParams=Ve(window.location.href);a._traceEnabled=a._urlParams[Ef];var b=window.wlAsyncInit;if(b&&typeof b===c)b.call()}function Te(a){if(!a._properties[Lb]&&ne(a))return;if(sendAPIRequestViaXHR(a))return;if(me(a))return;var b={};b[pb]=K;b[kb]=sc;a.onCompleted(b)}function Yc(b){return b?a[ob]:a[N]}a.jsonp={};WL.Internal.jsonp=a.jsonp;function ne(c){var h=document.getElementsByTagName("HEAD")[0],b=document.createElement("SCRIPT"),d=Pe(c._properties,d,[C,Q]),e=c._id,f=a.getAccessTokenForApi();if(f!=null)d[o]=f;d[C]=yd+e;d[ie]="true";var g=L(c._url,d);if(g.length>De)return false;c.scriptTag=b;a.jsonp[e]=function(a){Hb(e,b);c.onCompleted(a)};He(b,c);b.setAttribute("async","async");b.type="text/javascript";b.src=g;h.appendChild(b);window.setTimeout(function(){if(c._completed)return;Hb(e,b)},30000);return true}function He(b,c){if(a._browser.ie&&b.attachEvent)b.attachEvent("onreadystatechange",function(a){Vb(a,c)});else{b.readyState="complete";b.addEventListener("load",function(a){Vb(a,c)},false);b.addEventListener("error",function(a){Vb(a,c)},false)}}function Vb(d,c){if(c._completed)return;var b=d.srcElement||d.currentTarget;if(!b.readyState)b=d.currentTarget;if(b.readyState!="complete"&&b.readyState!="loaded")return;var f=c._id;failure=d.type=="error"||a.jsonp[f]!=null;if(failure){Hb(f,c.scriptTag);var e={};e[pb]=be;e[kb]=wc;c.onCompleted({error:e})}}function Hb(b,c){delete a.jsonp[b];document.getElementsByTagName("HEAD")[0].removeChild(c)}function me(b){yf();if(a._browser.flashVersion<9)return false;a.xdrFlash.send(b);return true}a.xdrFlash={_id:"",_status:Nb,_flashObject:null,_requests:{},_pending:[],init:function(){if(this._status!=Nb)return;this._status=Rd;var c=Kc("div");c.id="wl_xdr_container";document.body.appendChild(c);this._id=re();var b=de,d=a[y]+"XDR.swf";b=b.replace(/{url}/g,d);b=b.replace(/{id}/g,this._id);b=b.replace(/{variables}/g,"domain="+document.domain);c.innerHTML=b},onReady:function(b){if(b){if(a._browser.firefox)this._flashObject=document.embeds[this._id];else this._flashObject=R(this._id);this._status=vc}else this._status=Le;while(this._pending.length>0)this.send(this._pending.shift())},onRequestCompleted:function(b,e,c,f){var d=a.xdrFlash._requests[b];delete a.xdrFlash._requests[b];Rc(d,e,bf(c),f)},send:function(a){if(this._status<vc){this._pending.push(a);if(this._status==Nb)ib(w(this,this.init));return}if(this._flashObject!=null){this._requests[a._id]=a;var b=prepareXDRRequest(a);this.invoke("send",[a._id,b.url,b.method,b.body])}else Rc(a,0,null,Td)},invoke:function(d,a){a=a||[];var c=window.__flash__argumentsToXML(a,0),e='<invoke name="'+d+'" returntype="javascript">'+c+"</invoke>",b=this._flashObject.CallFunction(e);if(b==null)return null;return eval(b)}};WL.Internal.xdrFlash=a.xdrFlash;function bf(a){return a?a.replace(/\r/g," ").replace(/\n/g," "):a}var de="<object classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000' codebase='https://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0' width='300' height='300' id='{id}' name='{id}' type='application/x-shockwave-flash' data='{url}'>"+"<param name='movie' value='{url}'></param>"+"<param name='allowScriptAccess' value='always'></param>"+"<param name='FlashVars' value='{variables}'></param>"+"<embed play='true' menu='false' swLiveConnect='true' allowScriptAccess='always' type='application/x-shockwave-flash' FlashVars='{variables}' src='{url}' width='300' height='300' name='{id}'></embed>"+"</object>",Ib=null;(function(){a.fileDialog=function(b){Rb(b[d]);if(a._pendingPickerOp!=null)throw new Error(ud);return (new Ib(b)).execute()};var h=0,b=1,f=2,c=3;Ib=function(c){var b=this;b._props=c;b._startTs=(new Date).getTime();c[bb]=c[bb]||yb;c[r]=c[r]||z;b._state=h;b._authDelegate=w(b,b._onAuthResp);a._pendingPickerOp=b};Ib.prototype={execute:function(){var a=this,b=new q(a._props[d],a,null);a._promise=b;a._process();return b},cancel:function(a){var b=this;if(b._state===c)return;if(!a)a=v(Xc,Uc.replace(j,b._props[d]));b._onComplete(a)},_process:function(){var a=this;switch(a._state){case h:a._validateAuth();break;case b:a._initPicker();break;case f:a._complete()}},_changeState:function(d,b){var a=this;if(a._state!==c&&a._state!==d){a._state=d;if(b)a._result=b;a._process()}},_onComplete:function(a){this._changeState(f,a)},_validateAuth:function(){var c=this,f=false;if(a._rpsAuth)c._changeState(b);else{var e;switch(c._props[k]){case A:e=lf;break;case ab:e=we;break;case I:case H:e=c._buildExternalScope();f=true;break;default:var i=tc.replace(j,M).replace(V,k);c._onComplete(v(se,i));return}var h=c._props[d],g=650;if(f)a.login({scope:e,external_consent:true}).then(function(a){c._onExternalConsentComplete(a)},function(a){c._onComplete(a)});else{e+=" "+tf;a.ensurePermission(e,g,h,c._authDelegate)}}},_buildExternalScope:function(){var b=this,a="onedrive_onetime.access:";switch(b._props[k]){case I:a+=I;break;case H:a+=H}switch(b._props[kc]){case Y:a+="file|";break;case X:a+="folder|";break;default:a+="file|"}a+=b._props[r]===z?z:zb;if(b._props[cb])a+="|"+b._props[cb];return a},_onAuthResp:function(c){var a=this;if(c.error){if(!a._channel)a._onComplete(c)}else{var d=c.session[o];a._props[o]=d;if(a._channel)a._channel.send(FILEDIALOG_CHCMD_UPDATETOKEN,d);else a._changeState(b)}},_initPicker:function(){var b=this,c=b._props;m(c);b._channel=a.channel.registerOuterChannel(Zd,cc(c.url).host,c.frame.contentWindow,c.url,w(b,b._onMessage));g.subscribe(uc,b._authDelegate);var d=function(a){if(a.keyCode===zf)b.cancel()};c.keydownHandler=d;e(window,"keydown",d);b._initTimeout()},_initTimeout:function(){var a=this;timeoutSeconds=a._props[ic];if(timeoutSeconds&&timeoutSeconds>0)a._timeout=window.setTimeout(w(a,a._onTimeout),timeoutSeconds*1000)},_onTimeout:function(){var a=this,b=a._channel._connected;if(!b)a.cancel(v(hf,Od));a._clearTimeout()},_clearTimeout:function(){var a=this;if(a._timeout){window.clearTimeout(a._timeout);a._timeout=undefined}},_complete:function(){var b=this,e=b._result,f=e.error?t:s;b._state=c;b._cleanup();b._normalizeResp();if(b._props[d]===M)D(b._props[C],e,true);else if(e.data)D(b._props[mc],e,true);else D(b._props[Qb],e,true);b._promise[f](e);if(!a._rpsAuth)F(function(){b._report()})},_report:function(){var f=this._props,b=this._result,l=((new Date).getTime()-this._startTs)/1000,i="none",c=0,e=0;if(b.data){if(b.data.folders!=null)c=b.data.folders.length;if(b.data.files!=null)e=b.data.files.length}i=c>0&&e>0?"both":c>0?X:e>0?Y:"none";var j=c+e,h={client:lb,api:f[d],mode:f[k],select:f[r],result:b.error?b.error.code:"success",duration:l,object_selected:i,selected_count:j},g=a[hb];a.api({path:"web_analytics",method:Zc,body:h});if(g)g(h)},_onExternalConsentComplete:function(c){var b=this,h=b._props[cb]===Z;if(c.error){b._onComplete(c);return}var m=c[AK_OWNER_CID],j=c[AK_RESOURCEID],l=c[AK_ITEMID],k=c[wf];if(!j){b._onComplete(v(K,"Did not get expected resource id."));return}if(!k&&h){b._onComplete(v(K,"Did not get expected auth key for the resource."));return}var n=a._browser.ie9,i=b._props[he],e={method:Sb,interface_method:b._props[d]};if(n&&i)e[Q]=j+"/files";else{e[Lb]=true;e[Nd]=[{name:Bc,value:a._appId},{name:qc,value:x("{0}={1}",Cc,a._settings.sdk_version)}];var g,f;if(h){g="drives/"+m+"/items/"+l+"?"+Bd;f={authKey:k}}else{g="drive/items/"+l+"/children?"+(i?ef:ge);f={access_token:a.getAccessTokenForApi()}}e[Q]=L(g,f)}a.api(e).then(function(d){var a={pickerResponse:c,apiResponse:d};b._onComplete(a)},function(a){b._onComplete(a)})},_onMessage:function(a,b){vb(a);switch(a){case FILEDIALOG_CHCMD_ONCOMPLETE:this._onComplete(b)}},_normalizeResp:function(){var f=this,b=f._result.data,e=f._result.error,g=function(c){var b=c.upload_location;if(b)c.upload_location=b.replace("WL_APISERVICE_URL",a[N])};if(b){if(b.folders)for(var c=0;c<b.folders.length;c++)g(b.folders[c]);if(b.files)for(var c=0;c<b.files.length;c++)g(b.files[c])}if(e&&e.message)e.message=e.message.replace(j,f._props[d])},_cleanup:function(){var c=this,b=c._props,f=c._channel,e=b.resizeHandler,d=b.keydownHandler;c._clearTimeout();g.unsubscribe(uc,c._authDelegate);if(b.lightBox){b.frame.style.display=Wc;b.lightBox.style.display=Wc;document.body.removeChild(b.frame);document.body.removeChild(b.lightBox);delete b.lightBox;delete b.frame}if(f){f.dispose();delete c._channel}if(e)p(window,"resize",e);if(d)p(window,"keydown",d);delete a._pendingPickerOp}};function m(c){var g=c[k]===A,f=g?800:500,d=g?600:450,h=c[bb],p=h===ec,m=p?0:60,q=h===yb?"white":"rgb(0,0,0)",n=m/100,j=i(f,d),o=l(c),b=document.createElement("div");b.style.top="0px";b.style.left="0px";b.style.position="fixed";b.style.width="100%";b.style.height="100%";b.style.display="block";b.style.backgroundColor=q;b.style.opacity=n;b.style.MozOpacity=n;b.style.filter="alpha(opacity="+m+")";b.style.zIndex="2600000";var a=document.createElement("iframe");a.id="picker"+(new Date).getTime();a.style.top=j.top;a.style.left=j.left;a.style.position="fixed";a.style.width=f+"px";a.style.height=d+"px";a.style.display="block";a.style.zIndex="2600001";a.style.borderWidth="1px";a.style.borderColor="gray";a.style.maxHeight="100%";a.style.maxWidth="100%";a.src=o;a.setAttribute("sutra","picker");document.body.appendChild(a);document.body.appendChild(b);c.resizeHandler=function(){var b=i(f,d);a.style.top=b.top;a.style.left=b.left};e(window,"resize",c.resizeHandler);c.lightBox=b;c.frame=a;c.url=o}function l(d){var e=d[k]===A,f=e?xd:vd,b={},c=gd()+a[FILEDIALOG_PARAM_PICKER_SCRIPT];if(c.charAt(0)==="/")c=sb+c;b[Qd]=f;b[te]=a._rpsAuth?Pd:Id;b[ce]=window.location.hostname.toLowerCase();b[Vd]=c;b[AK_CLIENT_ID]=a._appId;b[AK_REQUEST_TS]=(new Date).getTime();b[Ae]=a._locale;if(!a._rpsAuth)b[o]=d[o];if(e)b[r]=d[r];return L(a[P],b)}function i(f,e){var b,c;if(a._browser.ie){var d=document.documentElement;b=(d.clientWidth-f)/2;c=(d.clientHeight-e)/2}else{b=(window.innerWidth-f)/2;c=(window.innerHeight-e)/2}b=b<10?10:b;c=c<10?10:c;return {left:b+"px",top:c+"px"}}})();a.ui=function(a){Rb(rb);switch(a.name){case qd:new SignInControl(a);break;case lb:new Gc(a)}};var Gc=function(b){Ac(b);var a=this;a._props=b;ib(w(a,a.init))};Gc.prototype={init:function(){var a=this;if(a._inited===true)return;a._inited=true;try{var c=a._props,e=c[Pb],f=c[C];c[d]="WL.ui-"+lb;a.validate();c[E]=c[E]||fb;e=typeof e===b?R(c[Pb]):e;a._element=e;var g=Cd(c);uf(e,g);Sd(e,w(a,a.onClick),w(a,a.onRender));a.onRender(false,false);D(f,c,false)}catch(h){l(h.message)}},validate:function(){var a=this._props;n(a,[{name:Pb,type:rd,optional:false}],a[d])},onClick:function(){try{return a.fileDialog(this._props)}catch(b){l(b.message)}return false},onRender:function(){jc(this._props,this._element.childNodes[0])}};function jc(k,d){var h=k[E]===fb,j=a._locale,f=j.indexOf("ar")>-1||j.indexOf("he")>-1,l=f?"RTL":"LTR",n=d.childNodes[0],m=d.childNodes[1],e="#094AB2",i="#ffffff",b=d.style,g=n.style,c=m.style;b.direction=l;b.backgroundColor=h?i:e;b.border="solid 1px";b.borderColor=e;b.height="20px";b.paddingLeft=Mc;b.paddingRight=Mc;b.textAlign="center";b.cursor="pointer";if(d instanceof HTMLAnchorElement){b.lineHeight="20px";b.display="inline-block";b.textDecoration="none"}g.verticalAlign="middle";g.height="16px";c.fontFamily="'Segoe UI', 'Segoe UI Web Regular', 'Helvetica Neue', 'BBAlpha Sans', 'S60 Sans', Arial, 'sans-serif'";c.fontSize="12px";c.fontWeight="bold";c.color=h?e:i;c.textAlign="center";c.verticalAlign="middle";c.marginLeft=f?nc:zc;c.marginRight=f?zc:nc}function Cd(b){var a=fc(b,false);return "<button id='"+ac(a.buttonId)+"' title='"+ac(a.buttonTitle)+"'>"+a.innerHTML+"</button>"}function fc(b,c){var n=b[k],m=b[E],a=n===A,e=a?tb.skyDriveOpenPickerButtonText:tb.skyDriveSavePickerButtonText,i=m===gb?"SkyDriveIcon_white.png":"SkyDriveIcon_blue.png",h="<img alt='' src='"+sf()+"/SkyDrivePicker/"+i+"'>",g="<span>"+ac(e)+"</span>",d=a?tb.skyDriveOpenPickerButtonTooltip:tb.skyDriveSavePickerButtonTooltip,j=c?"onedriveopenpickerbutton":"skydriveopenpickerbutton",l=c?"onedrivesavepickerbutton":"skydrivesavepickerbutton",f=a?j:l;return {innerHTML:h+g,buttonTitle:d,buttonId:f}}function Sd(c,m,l){var a=c.childNodes[0];if(m){var g=function(b){if(c.childNodes.length==0){p(a,O,g);return}m(b)};e(a,O,g)}if(l){var d=false,f=false,h=function(a){f=true;b(a)},i=function(a){f=false;b(a)},j=function(a){d=true;b(a)},k=function(a){d=false;b(a)},b=function(){if(c.childNodes.length==0){p(a,"mouseenter",h);p(a,"mouseleave",i);p(document,"mousedown",j);p(document,"mouseup",k);return}l(d,f)};e(a,"mouseenter",h);e(a,"mouseleave",i);e(document,"mousedown",j);e(document,"mouseup",k)}}function yf(){if(a._browser.flash!==undefined)return;var b=0;try{if(a._browser.ie){var k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),f=k.GetVariable("$version"),i=f.split(" "),g=i[1],d=g.split(",");b=d[0]}else if(navigator.plugins&&navigator.plugins.length>0)if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var j=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",e=navigator.plugins["Shockwave Flash"+j].description,h=e.split(" "),c=h[2].split(".");b=c[0]}}catch(l){}a._browser.flashVersion=b;a._browser.flash=b>=8}function ib(b){if(document.body)switch(document.readyState){case "complete":b();return;case "loaded":if(a._browser.webkit){b();return}break;case "interactive":case undefined:if(a._browser.firefox||a._browser.webkit){b();return}}if(document.addEventListener){document.addEventListener("DOMContentLoaded",b,false);document.addEventListener("load",b,false)}else if(window.attachEvent)window.attachEvent("onload",b);if(a._browser.ie&&document.attachEvent)document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);b()}})}function uf(b,a){b.innerHTML=a}function e(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else if(a.attachEvent)a.attachEvent("on"+b,c)}function p(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,false);else if(a.detachEvent)a.detachEvent("on"+b,c)}function Me(){var a=R(Zb);if(a){var b=a.getAttribute(Tc);!b&&l(x("Could not find attribute '{0}' on element with id '{1}'.",Tc,Zb),mb);return b}else{l(x("Could not find element with id '{0}'.",Zb),mb);return null}}var Tb={registerOuterChannel:function(e,b,c,d,a){return m.registerChannel(e,b,c,d,a)},registerInnerChannel:function(c,b,a){return m.registerChannel(c,b,null,null,a)},isSupported:function(){return m.isSupported()}},m={_channels:[],isSupported:function(){return window.postMessage!=null},registerChannel:function(i,f,g,h,d){var b=m,c=b._channels,a=null;if(b.isSupported()){a=new Qc(i,f,g,h,d);if(c.length===0)e(window,"message",b._onMessage);c.push(a)}return a},unregisterChannel:function(d){var c=m,a=c._channels;for(var b=0;b<a.length;b++)if(a[b]==d){a.splice(b,1);break}if(a.length===0)p(window,"message",c._onMessage)},_onMessage:function(a){var d=m,a=a||window.event,c=df(a);if(c!=null){var b=d._findChannel(a,c);if(b!=null)switch(c.text){case kd:b._onConnectReq(a.source,a.origin);break;case jd:b._onConnectAck(a.source);break;default:b._onMessage(c.text)}}},_findChannel:function(g,f){var d=m,c=d._channels,e=of(g.origin);for(var b=0;b<c.length;b++){var a=c[b];if(pc(a._name,f.name)&&pc(a._allowedDomain,e))return a}return null}},kd="@ConnectReq",jd="@ConnectAck";function Qc(f,d,b,e,c){var a=this;a._name=f;a._allowedDomain=d;a._msgHandler=c;if(b){a._targetWindow=b;a._targetUrl=cf(e);a._connect()}}Qc.prototype={_disposed:false,_connected:false,_allowedDomain:null,_targetWindow:null,_targetUrl:null,_msgHandler:null,_connectSchedule:-1,_pendingQueue:[],_recvQueue:[],dispose:function(){var a=this;if(!a._disposed){a._disposed=true;a._cancelConnect();m.unregisterChannel(a)}},send:function(c,d){var a=this;if(a._disposed)return;var b=ye(c,d);if(a._connected)a._post(b);else a._pendingQueue.push(b)},_connect:function(){var a=this;if(a._disposed||a._connected)return;var b=function(){a._post(kd)};if(a._connectSchedule===-1){a._connectSchedule=window.setInterval(b,500);b()}},_post:function(b){var a=this,c=Se(a._name,b);a._targetWindow.postMessage(c,a._targetUrl)},_onConnectReq:function(c,b){var a=this;if(!a._connected){a._connected=true;a._targetWindow=c;a._targetUrl=b;a._post(jd);a._onConnected()}},_onConnectAck:function(b){var a=this;if(!a._connected){a._targetWindow=b;a._onConnected()}},_onConnected:function(){var a=this,c=a._pendingQueue;a._connected=true;for(var b=0;b<c.length;b++)a._post(c[b]);a._pendingQueue=[];a._cancelConnect()},_cancelConnect:function(){var a=this;if(a._connectSchedule!=-1){window.clearInterval(a._connectSchedule);a._connectSchedule=-1}},_onMessage:function(b){if(this._msgHandler){var a=xe(b);this._msgHandler(a.cmd,a.args)}}};function cf(b){var a=b.indexOf("://");if(a>=0){a=b.indexOf("/",a+3);if(a>=0)b=b.substring(0,a)}return b}function df(a){var b=null;if(!Oc(a.origin)&&!Oc(a.data)&&a.source!=null)b=Re(a.data);return b}function Se(a,b){return "<"+a+">"+b}function Re(a){var c=null;if(a.charAt(0)=="<"){var b=a.indexOf(">");if(b>0){var d=a.substring(1,b),e=a.substr(b+1);c={name:d,text:e}}}return c}function ye(a,c){var b={cmd:a,args:c};return JSON.stringify(b)}function xe(b){var a=JSON.parse(b);return a}if(window.WL)a.channel=Tb;else window.WL={channel:Tb};var tb={connect:"Connect",signIn:"Sign in",signOut:"Sign out",login:"Log in",logout:"Log out",skyDriveOpenPickerButtonText:"Open from OneDrive",skyDriveOpenPickerButtonTooltip:"Open from OneDrive",skyDriveSavePickerButtonText:"Save to OneDrive",skyDriveSavePickerButtonTooltip:"Save to OneDrive"};a._locale="en";a[J]="Web/DEVICE_"+oe("5.5.2504.3000");a.testInit=function(b){if(b.env)a._settings.init(b.env);if(b.skydrive_uri)a._settings[P]=b.skydrive_uri;if(b[hb])a[hb]=b[hb]};var S={};S[N]="https://apis.live.net/v5.0/";S[P]="https://onedrive.live.com/";S[y]="//js.live.net/v5.0/";S[ob]="https://api.onedrive.com/v1.0/";var U={};U[N]="https://apis.live.net/v5.0/";U[P]="https://onedrive.live.com/";U[y]="//df-js.live.net/v5.0/";U[ob]="https://df.api.onedrive.com/v1.0/";var T={};T[N]="https://apis.live-int.net/v5.0/";T[P]="https://onedrive.live-int.com/";T[y]="//js.live-int.net/v5.0/";T[ob]="https://newapi.storage.live-int.com/v1.0/";a._settings={PROD:S,DF:U,INT:T,init:function(b){b=b.toUpperCase();var c=this[b];if(c)i(c,a)}};a._settings.init("PROD");a[FILEDIALOG_PARAM_PICKER_SCRIPT]="wl.skydrivepicker.js";a.onloadInit();f.onloadInit()}})();